<!DOCTYPE html><html><head><meta name=generator content="Hexo 3.9.0"><meta charset=utf-8><title>从一道题到HTTP请求走私 | qwzf</title><meta name=viewport content="width=device-width, initial-scale=1, maximum-scale=1"><meta name=keywords content="qwzf,Qwzf's Blog"><meta name=description content="0x00 写在前面首发在先知社区 之前一次线上赛，遇到一道Web题，涉及了HTTP请求走私。由于之前未学习过，从而我展开了HTTP请求走私的学习之旅。 0x01 HTTP请求走私是什么HTTP请求走私是一种干扰网站处理从一个或多个用户接收的HTTP请求序列的方式的技术。使攻击者可以绕过安全控制，未经授权访问敏感数据并直接危害其他应用程序用户。 0x02 为什么会产生HTTP请求走私请求走私漏洞成因"><meta name=keywords content=HTTP,BUG,协议层><meta property=og:type content=article><meta property=og:title content=从一道题到HTTP请求走私><meta property=og:url content=https://qwzf.github.io/2019/10/27/从一道题到HTTP请求走私/index.html><meta property=og:site_name content=qwzf><meta property=og:description content="0x00 写在前面首发在先知社区 之前一次线上赛，遇到一道Web题，涉及了HTTP请求走私。由于之前未学习过，从而我展开了HTTP请求走私的学习之旅。 0x01 HTTP请求走私是什么HTTP请求走私是一种干扰网站处理从一个或多个用户接收的HTTP请求序列的方式的技术。使攻击者可以绕过安全控制，未经授权访问敏感数据并直接危害其他应用程序用户。 0x02 为什么会产生HTTP请求走私请求走私漏洞成因"><meta property=og:locale content=zh-CN><meta property=og:image content=http://img-blog.csdnimg.cn/20191024211636393.jpg><meta property=og:image content=http://img-blog.csdnimg.cn/20191024210914446.png><meta property=og:image content=http://img-blog.csdnimg.cn/20191026171523775.png><meta property=og:image content=http://img-blog.csdnimg.cn/20191027190427578.png><meta property=og:image content=http://img-blog.csdnimg.cn/20191027191218256.png><meta property=og:image content=http://img-blog.csdnimg.cn/20191027191416527.png><meta property=og:image content=http://img-blog.csdnimg.cn/20191027192244482.png><meta property=og:image content=http://img-blog.csdnimg.cn/20191027210318818.png><meta property=og:image content=http://img-blog.csdnimg.cn/20191027211030391.png><meta property=og:image content=http://img-blog.csdnimg.cn/20191027230032401.png><meta property=og:image content=http://img-blog.csdnimg.cn/20191027230520431.png><meta property=og:image content=http://img-blog.csdnimg.cn/20191027224037312.png><meta property=og:image content=http://img-blog.csdnimg.cn/20191027224312299.png><meta property=og:updated_time content=2019-11-06T16:52:47.705Z><meta name=twitter:card content=summary><meta name=twitter:title content=从一道题到HTTP请求走私><meta name=twitter:description content="0x00 写在前面首发在先知社区 之前一次线上赛，遇到一道Web题，涉及了HTTP请求走私。由于之前未学习过，从而我展开了HTTP请求走私的学习之旅。 0x01 HTTP请求走私是什么HTTP请求走私是一种干扰网站处理从一个或多个用户接收的HTTP请求序列的方式的技术。使攻击者可以绕过安全控制，未经授权访问敏感数据并直接危害其他应用程序用户。 0x02 为什么会产生HTTP请求走私请求走私漏洞成因"><meta name=twitter:image content=http://img-blog.csdnimg.cn/20191024211636393.jpg><link rel=icon href=/favicon.ico><link href=//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/css/style.css><script src=/js/pace.min.js></script></head></html><script src=https://g.joyinshare.com/hc/ribbon.min.js type=text/javascript></script><canvas class=fireworks style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;"></canvas><script type=text/javascript src=//cdn.bootcss.com/animejs/2.2.0/anime.min.js></script><script type=text/javascript src=/js/clicklove.js></script><body><div id=container><header id=header><div id=banner></div><div id=header-outer><div id=header-menu class="header-menu-pos animated"><div class=header-menu-container><a href="/" class=left><span class=site-title>Qwzf&#39;s Blog</span></a><nav id=header-menu-nav class=right><a href="/"><i class="fa fa-home"></i> <span>Home</span></a> <a target=_blank href=/archives><i class="fa fa-archive"></i> <span>Archives</span></a> <a href=/about><i class="fa fa-user"></i> <span>About</span></a></nav><a class=mobile-header-menu-button><i class="fa fa-bars"></i></a></div></div><div id=header-row><div id=logo><a href="/"><img src=/images/logo.png alt=logo></a></div><div class=header-info><div id=header-title><h2>Qwzf&#39;s Blog</h2></div><div id=header-description><h3>一个爱学习的小白</h3></div></div><nav class=header-nav><div class=social><a title=qwzf target=_blank href=//qwzf.github.io><i class="fa fa-home fa-2x"></i></a> <a title=Github target=_blank href="//github.com/"><i class="fa fa-github fa-2x"></i></a> <a title=Weibo target=_blank href="//weibo.com/"><i class="fa fa-weibo fa-2x"></i></a> <a title=Twitter target=_blank href="//twitter.com/"><i class="fa fa-twitter fa-2x"></i></a></div></nav></div></div></header><div class=outer><section id=main class=body-wrap><article id=post-从一道题到HTTP请求走私 class="article article-type-post" itemscope itemprop=blogPost><div class=article-inner><header class=article-header><h1 class=post-title itemprop=name>从一道题到HTTP请求走私</h1><div class=post-title-bar><ul><li><i class="fa fa-book"></i> <span class=post-meta-item-text>分类:</span> <span class=post-count><a href="/categories/Web/">Web</a></span></li><li><i class="fa fa-calendar"></i> <span class=post-meta-item-text>日期:</span> <span class=post-count>2019-10-27</span></li><li><i class="fa fa-eye"></i> <span class=post-meta-item-text>阅读量:</span> <span id=busuanzi_value_page_pv>次</span></li><li><span class=post-time><span class=post-meta-item-icon><i class="fa fa-keyboard-o"></i> <span class=post-meta-item-text>字数统计:</span> <span class=post-count>4.3k字</span></span></span></li><li><span class=post-time><span class=post-meta-item-icon><i class="fa fa-hourglass-half"></i> <span class=post-meta-item-text>阅读时长:</span> <span class=post-count>16分</span></span></span></li></ul></div></header><div class="article-entry post-content" itemprop=articleBody><h3 id=0x00-写在前面><a href=#0x00-写在前面 class=headerlink title="0x00 写在前面"></a>0x00 写在前面</h3><p>首发在先知社区</p><p>之前一次线上赛，遇到一道Web题，涉及了HTTP请求走私。由于之前未学习过，从而我展开了HTTP请求走私的学习之旅。</p><h3 id=0x01-HTTP请求走私是什么><a href=#0x01-HTTP请求走私是什么 class=headerlink title="0x01 HTTP请求走私是什么"></a>0x01 HTTP请求走私是什么</h3><p>HTTP请求走私是一种干扰网站处理从一个或多个用户接收的HTTP请求序列的方式的技术。使攻击者可以绕过安全控制，未经授权访问敏感数据并直接危害其他应用程序用户。</p><h3 id=0x02-为什么会产生HTTP请求走私><a href=#0x02-为什么会产生HTTP请求走私 class=headerlink title="0x02 为什么会产生HTTP请求走私"></a>0x02 为什么会产生HTTP请求走私</h3><p><strong>请求走私漏洞成因</strong></p><blockquote><p>前端服务器(CDN)和后端服务器接收数据不同步，引起对客户端传入的数据理解不一致，从而导致漏洞的产生。</p></blockquote><p>大多数HTTP请求走私漏洞的出现是因为HTTP规范提供了两种不同的方法来指定请求的结束位置：<code>Content-Length</code>标头和<code>Transfer-Encoding</code>标头。<br>同时使用两种不同的方法时，<code>Content-Length</code>无效。当使用多个服务器时，对客户端传入的数据理解不一致时，就会出现有些服务器认为<code>Content-Length</code>的长度有效，有些以<code>Transfer-Encoding</code>有效。而一般情况下，反向代理服务器与后端的源站服务器之间，会重用TCP链接。这样超出的长度就会拼接到下一次请求进行请求，从而导致HTTP请求走私漏洞。</p><p><strong>RFC2616规范</strong></p><blockquote><p>如果接收的消息同时包含传输编码头字段(Transfer-Encoding)和内容长度头(Content-Length)字段，则必须忽略后者。</p></blockquote><p>由于规范默许可以使用<code>Transfer-Encoding</code>和<code>Content-Length</code>处理请求，因此很少有服务器拒绝此类请求。每当我们找到一种方法，将<code>Transfer-Encoding</code>隐藏在服务端的一个<code>chain</code>中时，它将会回退到使用<code>Content-Length</code>去发送请求。</p><p><strong>走私攻击实现</strong><br>当向代理服务器发送一个比较模糊的HTTP请求时，由于两者服务器的实现方式不同，代理服务器可能认为这是一个HTTP请求，然后将其转发给了后端的源站服务器，但源站服务器经过解析处理后，只认为其中的一部分为正常请求，剩下的那一部分，就算是走私的请求，当该部分对正常用户的请求造成了影响之后，就实现了HTTP走私攻击。</p><h4 id=扩展：为什么会出现多次请求><a href=#扩展：为什么会出现多次请求 class=headerlink title=扩展：为什么会出现多次请求></a>扩展：为什么会出现多次请求</h4><p>这与最为广泛的HTTP 1.1的协议特性——<code>Keep-Alive&amp;Pipeline</code>有关。<br>在<code>HTTP1.0</code>之前的协议设计中，客户端每进行一次HTTP请求，需要同服务器建立一个TCP链接。<br>而现代的Web页面是由多种资源组成的，要获取一个网页的内容，不仅要请求HTML文档，还有JS、CSS、图片等各种资源，如果按照之前的协议设计，就会导致HTTP服务器的负载开销增大。于是在<code>HTTP1.1</code>中，增加了<code>Keep-Alive</code>和<code>Pipeline</code>这两个特性。</p><p><strong>Keep-Alive</strong>：在HTTP请求中增加一个特殊的请求头<code>Connection: Keep-Alive</code>，告诉服务器，接收完这次HTTP请求后，不要关闭<code>TCP链接</code>，后面对相同目标服务器的HTTP请求，重用这一个TCP链接。这样只需要进行一次TCP握手的过程，可以减少服务器的开销，节约资源，还能加快访问速度。这个特性在<code>HTTP1.1</code>中默认开启的。<br><strong>Pipeline(http管线化)</strong>：http管线化是一项实现了多个http请求但不需要等待响应就能够写进同一个socket的技术，仅有http1.1规范支持http管线化。在这里，客户端可以像流水线一样发送自己的<code>HTTP</code>请求，而不需要等待服务器的响应，服务器那边接收到请求后，需要遵循先入先出机制，将请求和响应严格对应起来，再将响应发送给客户端。</p><p>现在，浏览器默认不启用<code>Pipeline</code>的，但是一般的服务器都提供了对<code>Pipleline</code>的支持。<br>下面这是典型的CDN加速图和拓扑结构图<br>CDN加速图<br><img src=http://img-blog.csdnimg.cn/20191024211636393.jpg alt=在这里插入图片描述><br>拓扑结构图<br><img src=http://img-blog.csdnimg.cn/20191024210914446.png alt=在这里插入图片描述></p><h3 id=0x03-如何执行HTTP请求走私攻击><a href=#0x03-如何执行HTTP请求走私攻击 class=headerlink title="0x03 如何执行HTTP请求走私攻击"></a>0x03 如何执行HTTP请求走私攻击</h3><p>HTTP请求走私攻击涉及将<code>Content-Length</code>标头和<code>Transfer-Encoding</code>标头都放置在单个HTTP请求中并进行处理，以便前端服务器和后端服务器以不同的方式处理请求。完成此操作的确切方式取决于两个服务器的行为：</p><blockquote><p>CL.TE：前端服务器使用Content-Length标头，而后端服务器使用Transfer-Encoding标头。<br>TE.CL：前端服务器使用Transfer-Encoding标头，而后端服务器使用Content-Length标头。<br>TE.TE：前端服务器和后端服务器都支持Transfer-Encoding标头，但是可以通过对标头进行某种方式的混淆来诱导其中一台服务器不对其进行处理。</p></blockquote><h3 id=0x04-HTTP请求走私攻击的五种方式><a href=#0x04-HTTP请求走私攻击的五种方式 class=headerlink title="0x04 HTTP请求走私攻击的五种方式"></a>0x04 HTTP请求走私攻击的五种方式</h3><h4 id=CL不为0><a href=#CL不为0 class=headerlink title=CL不为0></a>CL不为0</h4><p>所有不携带请求体的HTTP请求都有可能受此影响。这里用GET请求举例。<br>前端代理服务器允许GET请求携带请求体；后端服务器不允许GET请求携带请求体，它会直接忽略掉GET请求中的<code>Content-Length</code>头，不进行处理。这就有可能导致请求走私。</p><p><strong>构造请求示例</strong>：</p><figure class="highlight bash"><table><tr><td class=code><pre><span class=line>GET / HTTP/1.1\r\n</span><br><span class=line>Host: test.com\r\n</span><br><span class=line>Content-Length: 44\r\n</span><br><span class=line></span><br><span class=line>GET / secret HTTP/1.1\r\n</span><br><span class=line>Host: test.com\r\n</span><br><span class=line>\r\n</span><br></pre></td></tr></table></figure><blockquote><p><code>\r\n</code>是换行的意思，windows的换行是<code>\r\n</code>，unix的是<code>\n</code>，mac的是<code>\r</code></p></blockquote><p><strong>攻击流程</strong>：<br>前端服务器收到该请求，读取<code>Content-Length</code>，判断这是一个完整的请求。<br>然后转发给后端服务器，后端服务器收到后，因为它不对<code>Content-Length</code>进行处理，由于<code>Pipeline</code>的存在，后端服务器就认为这是收到了两个请求，分别是：</p><p>第一个：</p><figure class="highlight bash"><table><tr><td class=code><pre><span class=line>GET / HTTP/1.1\r\n</span><br><span class=line>Host: test.com\r\n</span><br></pre></td></tr></table></figure><p>第二个：</p><figure class="highlight bash"><table><tr><td class=code><pre><span class=line>GET / secret HTTP/1.1\r\n</span><br><span class=line>Host: test.com\r\n</span><br></pre></td></tr></table></figure><p>所以造成了请求走私。</p><h4 id=CL-CL><a href=#CL-CL class=headerlink title=CL-CL></a>CL-CL</h4><p><strong>RFC7230规范</strong></p><blockquote><p>在RFC7230的第3.3.3节中的第四条中，规定当服务器收到的请求中包含两个<code>Content-Length</code>，而且两者的值不同时，需要返回400错误。</p></blockquote><p>有些服务器不会严格的实现该规范，假设中间的代理服务器和后端的源站服务器在收到类似的请求时，都不会返回400错误。<br>但是中间代理服务器按照第一个<code>Content-Length</code>的值对请求进行处理，而后端源站服务器按照第二个<code>Content-Length</code>的值进行处理。<br><strong>构造请求示例</strong>：</p><figure class="highlight bash"><table><tr><td class=code><pre><span class=line>POST / HTTP/1.1\r\n</span><br><span class=line>Host: test.com\r\n</span><br><span class=line>Content-Length: 8\r\n</span><br><span class=line>Content-Length: 7\r\n</span><br><span class=line></span><br><span class=line>12345\r\n</span><br><span class=line>a</span><br></pre></td></tr></table></figure><p><strong>攻击流程</strong>：<br>中间代理服务器获取到的数据包的长度为8，将上述整个数据包原封不动的转发给后端的源站服务器。<br>而后端服务器获取到的数据包长度为7。当读取完前7个字符后，后端服务器认为已经读取完毕，然后生成对应的响应，发送出去。而此时的缓冲区去还剩余一个字母<code>a</code>，对于后端服务器来说，这个<code>a</code>是下一个请求的一部分，但是还没有传输完毕。<br>如果此时有一个其他的正常用户对服务器进行了请求：</p><figure class="highlight bash"><table><tr><td class=code><pre><span class=line>GET /index.html HTTP/1.1\r\n</span><br><span class=line>Host: test.com\r\n</span><br></pre></td></tr></table></figure><p>因为代理服务器与源站服务器之间一般会重用TCP连接。所以正常用户的请求就拼接到了字母<code>a</code>的后面，当后端服务器接收完毕后，它实际处理的请求其实是：</p><figure class="highlight bash"><table><tr><td class=code><pre><span class=line>aGET /index.html HTTP/1.1\r\n</span><br><span class=line>Host: test.com\r\n</span><br></pre></td></tr></table></figure><p>这时，用户就会收到一个类似于<code>aGET request method not found</code>的报错。这样就实现了一次HTTP走私攻击，而且还对正常用户的行为造成了影响，而且还可以扩展成类似于CSRF的攻击方式。</p><p>但是一般的服务器都不会接受这种存在两个请求头的请求包。该怎么办呢？<br>所以想到前面所说的<br><strong>RFC2616规范</strong></p><blockquote><p>如果收到同时存在<code>Content-Length</code>和<code>Transfer-Encoding</code>这两个请求头的请求包时，在处理的时候必须忽略<code>Content-Length</code>。</p></blockquote><p>所以请求包中同时包含这两个请求头并不算违规，服务器也不需要返回400错误。导致服务器在这里的实现更容易出问题。</p><h4 id=CL-TE><a href=#CL-TE class=headerlink title=CL-TE></a>CL-TE</h4><p>CL-TE，就是当收到存在两个请求头的请求包时，前端代理服务器只处理<code>Content-Length</code>请求头，而后端服务器会遵守<code>RFC2616</code>的规定，忽略掉<code>Content-Length</code>，处理<code>Transfer-Encoding</code>请求头。</p><p><strong>chunk传输数据(size的值由16进制表示)</strong></p><figure class="highlight bash"><table><tr><td class=code><pre><span class=line>[chunk size][\r\n][chunk data][\r\n][chunk size][\r\n][chunk data][\r\n][chunk size = 0][\r\n][\r\n]</span><br></pre></td></tr></table></figure><p><strong>chunked编码</strong><br>参考：<a href=https://blog.csdn.net/yankai0219/article/details/8269922 target=_blank rel=noopener>http协议中content-length 以及chunked编码分析</a><br><strong>构造请求示例</strong>：</p><figure class="highlight bash"><table><tr><td class=code><pre><span class=line>POST / HTTP/1.1\r\n</span><br><span class=line>Host: test.com\r\n</span><br><span class=line>......</span><br><span class=line>Connection: keep-alive\r\n</span><br><span class=line>Content-Length: 6\r\n</span><br><span class=line>Transfer-Encoding: chunked\r\n</span><br><span class=line>\r\n</span><br><span class=line>0\r\n</span><br><span class=line>\r\n</span><br><span class=line>a</span><br></pre></td></tr></table></figure><p>连续发送几次请求就可以获得响应。<br><strong>攻击流程</strong>：<br>由于前端服务器处理<code>Content-Length</code>，所以这个请求对于它来说是一个完整的请求，请求体的长度为6，也就是</p><figure class="highlight bash"><table><tr><td class=code><pre><span class=line>0\r\n</span><br><span class=line>\r\n</span><br><span class=line>a</span><br></pre></td></tr></table></figure><p>当请求包经过代理服务器转发给后端服务器时，后端服务器处理<code>Transfer-Encoding</code>，当它读取到</p><figure class="highlight bash"><table><tr><td class=code><pre><span class=line>0\r\n</span><br><span class=line>\r\n</span><br></pre></td></tr></table></figure><p>认为已经读取到结尾了。<br>但剩下的字母<code>a</code>就被留在了缓冲区中，等待下一次请求。当我们重复发送请求后，发送的请求在后端服务器拼接成了类似下面这种请求：</p><figure class="highlight bash"><table><tr><td class=code><pre><span class=line>aPOST / HTTP/1.1\r\n</span><br><span class=line>Host: test.com\r\n</span><br><span class=line>......</span><br></pre></td></tr></table></figure><p>服务器在解析时就会产生报错了，从而造成HTTP请求走私。</p><h4 id=TE-CL><a href=#TE-CL class=headerlink title=TE-CL></a>TE-CL</h4><p>TE-CL，就是当收到存在两个请求头的请求包时，前端代理服务器处理<code>Transfer-Encoding</code>请求头，后端服务器处理<code>Content-Length</code>请求头。<br><strong>构造请求示例</strong>：</p><figure class="highlight bash"><table><tr><td class=code><pre><span class=line>POST / HTTP/1.1\r\n</span><br><span class=line>Host: test.com\r\n</span><br><span class=line>......</span><br><span class=line>Content-Length: 4\r\n</span><br><span class=line>Transfer-Encoding: chunked\r\n</span><br><span class=line>\r\n</span><br><span class=line>12\r\n</span><br><span class=line>aPOST / HTTP/1.1\r\n</span><br><span class=line>\r\n</span><br><span class=line>0\r\n</span><br><span class=line>\r\n</span><br></pre></td></tr></table></figure><p><strong>攻击流程</strong>：<br>前端服务器处理<code>Transfer-Encoding</code>，当其读取到</p><figure class="highlight bash"><table><tr><td class=code><pre><span class=line>0\r\n</span><br><span class=line>\r\n</span><br></pre></td></tr></table></figure><p>认为是读取完毕了。<br>此时这个请求对代理服务器来说是一个完整的请求，然后转发给后端服务器，后端服务器处理<code>Content-Length</code>请求头，因为请求体的长度为<code>4</code>.也就是当它读取完</p><figure class="highlight bash"><table><tr><td class=code><pre><span class=line>12\r\n</span><br></pre></td></tr></table></figure><p>就认为这个请求已经结束了。后面的数据就认为是另一个请求：</p><figure class="highlight bash"><table><tr><td class=code><pre><span class=line>aPOST / HTTP/1.1\r\n</span><br><span class=line>\r\n</span><br><span class=line>0\r\n</span><br><span class=line>\r\n</span><br></pre></td></tr></table></figure><p>成功报错，造成HTTP请求走私。</p><h4 id=TE-TE><a href=#TE-TE class=headerlink title=TE-TE></a>TE-TE</h4><p>TE-TE，当收到存在两个请求头的请求包时，前后端服务器都处理<code>Transfer-Encoding</code>请求头，确实是实现了RFC的标准。不过前后端服务器不是同一种。这就有了一种方法，我们可以对发送的请求包中的<code>Transfer-Encoding</code>进行某种混淆操作(如某个字符改变大小写)，从而使其中一个服务器不处理<code>Transfer-Encoding</code>请求头。在某种意义上这还是<code>CL-TE</code>或者<code>TE-CL</code>。<br><strong>构造请求示例</strong>：</p><figure class="highlight bash"><table><tr><td class=code><pre><span class=line>POST / HTTP/1.1\r\n</span><br><span class=line>Host: test.com\r\n</span><br><span class=line>......</span><br><span class=line>Content-length: 4\r\n</span><br><span class=line>Transfer-Encoding: chunked\r\n</span><br><span class=line>Transfer-encoding: cow\r\n</span><br><span class=line>\r\n</span><br><span class=line>5c\r\n</span><br><span class=line>aPOST / HTTP/1.1\r\n</span><br><span class=line>Content-Type: application/x-www-form-urlencoded\r\n</span><br><span class=line>Content-Length: 15\r\n</span><br><span class=line>\r\n</span><br><span class=line>x=1\r\n</span><br><span class=line>0\r\n</span><br><span class=line>\r\n</span><br></pre></td></tr></table></figure><p><strong>攻击流程</strong>：<br>前端服务器处理<code>Transfer-Encoding</code>，当其读取到</p><figure class="highlight bash"><table><tr><td class=code><pre><span class=line>0\r\n</span><br><span class=line>\r\n</span><br></pre></td></tr></table></figure><p>认为是读取结束。<br>此时这个请求对代理服务器来说是一个完整的请求，然后转发给后端服务器处理<code>Transfer-encoding</code>请求头，将<code>Transfer-Encoding</code>隐藏在服务端的一个<code>chain</code>中时，它将会回退到使用<code>Content-Length</code>去发送请求。读取到</p><figure class="highlight bash"><table><tr><td class=code><pre><span class=line>5c\r\n</span><br></pre></td></tr></table></figure><p>认为是读取完毕了。后面的数据就认为是另一个请求：</p><figure class="highlight bash"><table><tr><td class=code><pre><span class=line>aPOST / HTTP/1.1\r\n</span><br><span class=line>Content-Type: application/x-www-form-urlencoded\r\n</span><br><span class=line>Content-Length: 15\r\n</span><br><span class=line>\r\n</span><br><span class=line>x=1\r\n</span><br><span class=line>0\r\n</span><br><span class=line>\r\n</span><br></pre></td></tr></table></figure><p>成功报错，造成HTTP请求走私。</p><h3 id=0x05-HTTP请求走私实战><a href=#0x05-HTTP请求走私实战 class=headerlink title="0x05 HTTP请求走私实战"></a>0x05 HTTP请求走私实战</h3><p>在我学HTTP请求走私之前，正是因为碰到一道Web题要使用HTTP请求走私。现在复现一下</p><h4 id=RoarCTF2019-Web：easy-calc><a href=#RoarCTF2019-Web：easy-calc class=headerlink title=RoarCTF2019-Web：easy_calc></a>RoarCTF2019-Web：easy_calc</h4><p>进去发现是个计算器<br><img src=http://img-blog.csdnimg.cn/20191026171523775.png alt=在这里插入图片描述><br>这道题是国赛的love_math的修改版。国赛题<code>love_math</code>参考Smi1e师傅的Writeup：<a href="https://www.smi1e.top/%E5%9B%BD%E8%B5%9Blove_math%E9%A2%98%E8%A7%A3/" target=_blank rel=noopener>国赛love_math题解</a><br>输入<code>calc.php</code>，发现了网站源码<br><img src=http://img-blog.csdnimg.cn/20191027190427578.png alt=在这里插入图片描述><br>这道题除去了长度限制，payload中不能包含</p><blockquote><p>‘ ‘, ‘\t’, ‘\r’, ‘\n’,’’’, ‘“‘, ‘`‘, ‘[‘, ‘]’等字符</p></blockquote><p>师傅的Writeup还说网站加了waf，需要绕过waf。所以还需要绕过waf，测试发现当我们提交一些字符时，会直接<code>403</code>。<code>403</code>？！应该就是走私报错了，经测试发现的确存在服务器存在http走私漏洞，可以用来绕waf。</p><p>因禁了一些字符，所以不能直接getflag，需要继续分析payload构造。</p><h5 id=相关PHP函数><a href=#相关PHP函数 class=headerlink title=相关PHP函数></a>相关PHP函数</h5><p><strong>scandir() 函数</strong><br>返回指定目录中的文件和目录的数组。<br><img src=http://img-blog.csdnimg.cn/20191027191218256.png alt=在这里插入图片描述><br><strong>base_convert() 函数</strong><br>在任意进制之间转换数字。<br><img src=http://img-blog.csdnimg.cn/20191027191416527.png alt=在这里插入图片描述><br><strong>dechex() 函数</strong>：把十进制转换为十六进制。<br><strong>hex2bin() 函数</strong>：把十六进制值的字符串转换为 ASCII 字符。<br><strong>readfile() 函数</strong><br>输出一个文件。<br>该函数读入一个文件并写入到输出缓冲。若成功，则返回从文件中读入的字节数。若失败，则返回 false。您可以通过 @readfile() 形式调用该函数，来隐藏错误信息。<br><img src=http://img-blog.csdnimg.cn/20191027192244482.png alt=在这里插入图片描述></p><h5 id=HTTP走私绕过WAF><a href=#HTTP走私绕过WAF class=headerlink title=HTTP走私绕过WAF></a>HTTP走私绕过WAF</h5><p><strong>测试示例</strong><br><em>1、HTTP请求走私测试2(CL-CL漏洞)</em><br>两个CL直接导致前端转发的服务器400，而且完整转发了post包给后端。<br><img src=http://img-blog.csdnimg.cn/20191027210318818.png alt=在这里插入图片描述><br><em>2、HTTP请求走私测试1(CL-TE漏洞)</em><br>CL和TE直接导致前端转发的服务器400，而且完整转发了post包给后端。<br><img src=http://img-blog.csdnimg.cn/20191027211030391.png alt=在这里插入图片描述><br>其它几种请求走私依旧可以，就不测试了。</p><p><strong>构造payload获得Flag</strong><br>使用<code>scandir()函数</code>、<code>readfile()函数</code>、<code>base_convert()函数</code>、<code>dechex() 函数</code>、<code>hex2bin() 函数</code>（<code>chr()函数</code>）<br>36进制<code>scandir</code>-&gt;10进制61693386291<br>36进制<code>readfile</code>-&gt;10进制2146934604002<br>ascii码<code>/</code>-&gt;16进制2f-&gt;10进制47<br>36进制f1agg-&gt;10进制25254448(读取根目录得到的)<br><em>1、列目录</em><br>首先要使用<code>scandir()函数</code>，尝试构造payload列举根目录下的文件。<br><code>scandir()</code>可以用<code>base_convert()函数</code>构造，但是利用<code>base_convert()</code>只能解决<code>a~z</code>的利用。<br>因为根目录需要<code>/</code>符号，且不在<code>a~z</code>,所以需要<code>hex2bin(dechex(47))</code>这种构造方式，<code>dechex() 函数</code>把十进制数转换为十六进制数。<code>hex2bin() 函数</code>把十六进制值的字符串转换为 ASCII 字符。当然，也可以直接用<code>chr()函数</code></p><p>payload</p><figure class="highlight bash"><table><tr><td class=code><pre><span class=line>var_dump(base_convert(61693386291,10,36)(chr(47)))</span><br></pre></td></tr></table></figure><p><img src=http://img-blog.csdnimg.cn/20191027230032401.png alt=在这里插入图片描述><br><em>2、读取flag</em></p><p>payload</p><figure class="highlight bash"><table><tr><td class=code><pre><span class=line>var_dump(base_convert(2146934604002,10,36)(chr(47).base_convert(25254448,10,36)))</span><br></pre></td></tr></table></figure><p><img src=http://img-blog.csdnimg.cn/20191027230520431.png alt=在这里插入图片描述></p><h5 id=PHP字符串解析特性绕过WAF><a href=#PHP字符串解析特性绕过WAF class=headerlink title=PHP字符串解析特性绕过WAF></a>PHP字符串解析特性绕过WAF</h5><p>输入时发现num只能输入数字，输入字符无法解析。<br>这里可以利用php的字符串解析特性绕过bypass：<a href=http://www.freebuf.com/articles/web/213359.html target=_blank rel=noopener>利用PHP的字符串解析特性Bypass</a></p><blockquote><p>PHP需要将所有参数转换为有效的变量名，因此在解析查询字符串时，它会做两件事：<br>1.删除空白符<br>2.将某些字符转换为下划线（包括空格）</p></blockquote><p>所以我们可以在num前加个空格绕过waf</p><figure class="highlight php"><table><tr><td class=code><pre><span class=line>http:<span class=comment>//www.xxx.com/index.php? num=aaaa</span></span><br></pre></td></tr></table></figure><p>现在的变量叫“ num”，而不是“num”。但php在解析的时候，会先把空格给去掉，这样代码还能正常运行，还上传了非法字符。<br>然后再利用<code>scandir()</code>函数，列出 <code>参数目录</code> 中的文件和目录。<br>首先，要先扫根目录下的所有文件，也就是是<code>scandir(&quot;/&quot;)</code>,因为<code>/</code>被过滤了，所以直接用<code>chr(“47”)</code>绕过,发现<code>flagg文件</code><br><img src=http://img-blog.csdnimg.cn/20191027224037312.png alt=在这里插入图片描述><br>然后再去读取这个文件就行了。payload：</p><figure class="highlight php"><table><tr><td class=code><pre><span class=line>calc.php? num=<span class=number>1</span>;var_dump(readfile(chr(<span class=number>47</span>).chr(<span class=number>102</span>).chr(<span class=number>49</span>).chr(<span class=number>97</span>).chr(<span class=number>103</span>).chr(<span class=number>103</span>)))</span><br></pre></td></tr></table></figure><p><img src=http://img-blog.csdnimg.cn/20191027224312299.png alt=在这里插入图片描述></p><h3 id=0x06-漏洞修复><a href=#0x06-漏洞修复 class=headerlink title="0x06 漏洞修复"></a>0x06 漏洞修复</h3><p>1、将前端服务器配置为只使用HTTP/2与后端系统通信<br>2、完全禁用后端连接重用来解决此漏洞的所有变体<br>3、确保连接中的所有服务器运行具有相同配置的相同web服务器软件。<br>4、彻底拒绝模糊的请求，并删除关联的连接。<br>5、在Burp Suite中，你可以使用Repeater菜单禁用此行为，确保你选择的工具具有相同的功能。<br>6、通过Squid之类的代理来测试他们的测试人员的流量以进行监控。破坏测试人员发起的任何走私攻击请求，确保对此漏洞做到全面杜绝。</p><h3 id=0x07-写在后面><a href=#0x07-写在后面 class=headerlink title="0x07 写在后面"></a>0x07 写在后面</h3><p>这次又学到了新的知识-HTTP请求走私。了解了HTTP请求走私的五种方式，以及一些PHP函数的使用。HTTP请求走私属于协议层攻击，是服务器漏洞的一种，应予以注意。</p><div class=post-copyright><div class=content><p>最后更新： 2019年11月07日 00:52</p><p>原始链接： <a class=post-url href="/2019/10/27/从一道题到HTTP请求走私/" title=从一道题到HTTP请求走私>https://qwzf.github.io/2019/10/27/从一道题到HTTP请求走私/</a></p><footer><a href=https://qwzf.github.io><img src=/images/logo.png alt=qwzf> qwzf</a></footer></div></div><div class=page-reward><a id=rewardBtn href=javascript:;>赏</a></div><div id=reward class="post-modal reward-lay"><a class=close href=javascript:; id=reward-close>×</a> <span class=reward-title><i class="icon icon-quote-left"></i> 请我吃糖~ <i class="icon icon-quote-right"></i></span><div class=reward-content><div class=reward-code><img id=rewardCode src=/images/wechat_code.jpg alt=打赏二维码></div><div class=reward-select><label class="reward-select-item checked" data-id=wechat data-wechat=/images/wechat_code.jpg><img class=reward-select-item-wechat src=/images/wechat.png alt=微信></label> <label class=reward-select-item data-id=alipay data-alipay=/images/alipay_code.jpg><img class=reward-select-item-alipay src=/images/alipay.png alt=支付宝></label></div></div></div></div><footer class=article-footer><div class=post-share><a href=javascript:; id=share-sub class=post-share-fab><i class="fa fa-share-alt"></i></a><div class=post-share-list id=share-list><ul class=share-icons><li><a class="weibo share-sns" target=_blank href="http://service.weibo.com/share/share.php?url=https://qwzf.github.io/2019/10/27/从一道题到HTTP请求走私/&title=《从一道题到HTTP请求走私》 — qwzf&pic=http://img-blog.csdnimg.cn/20191027232207505.png" data-title=微博><i class="fa fa-weibo"></i></a></li><li><a class="weixin share-sns" id=wxFab href=javascript:; data-title=微信><i class="fa fa-weixin"></i></a></li><li><a class="qq share-sns" target=_blank href="http://connect.qq.com/widget/shareqq/index.html?url=https://qwzf.github.io/2019/10/27/从一道题到HTTP请求走私/&title=《从一道题到HTTP请求走私》 — qwzf&source=" data-title=QQ><i class="fa fa-qq"></i></a></li><li><a class="facebook share-sns" target=_blank href="https://www.facebook.com/sharer/sharer.php?u=https://qwzf.github.io/2019/10/27/从一道题到HTTP请求走私/" data-title=Facebook><i class="fa fa-facebook"></i></a></li><li><a class="twitter share-sns" target=_blank href="https://twitter.com/intent/tweet?text=《从一道题到HTTP请求走私》 — qwzf&url=https://qwzf.github.io/2019/10/27/从一道题到HTTP请求走私/&via=https://qwzf.github.io" data-title=Twitter><i class="fa fa-twitter"></i></a></li><li><a class="google share-sns" target=_blank href="https://plus.google.com/share?url=https://qwzf.github.io/2019/10/27/从一道题到HTTP请求走私/" data-title=Google+><i class="fa fa-google-plus"></i></a></li></ul></div></div><div class="post-modal wx-share" id=wxShare><a class=close href=javascript:; id=wxShare-close>×</a><p>扫一扫，分享到微信</p><img src="//api.qrserver.com/v1/create-qr-code/?data=https://qwzf.github.io/2019/10/27/从一道题到HTTP请求走私/" alt=微信分享二维码></div><div class=mask></div><ul class=article-footer-menu><li class=article-footer-tags><i class="fa fa-tags"></i> <a href="/tags/HTTP/" class=color5>HTTP</a> <a href="/tags/BUG/" class=color4>BUG</a> <a href="/tags/协议层/" class=color4>协议层</a></li></ul></footer></div></article><aside class="post-toc-pos post-toc-top" id=post-toc><nav class=post-toc-wrap><ol class=post-toc><li class="post-toc-item post-toc-level-3"><a class=post-toc-link href=#0x00-写在前面><span class=post-toc-text>0x00 写在前面</span></a></li><li class="post-toc-item post-toc-level-3"><a class=post-toc-link href=#0x01-HTTP请求走私是什么><span class=post-toc-text>0x01 HTTP请求走私是什么</span></a></li><li class="post-toc-item post-toc-level-3"><a class=post-toc-link href=#0x02-为什么会产生HTTP请求走私><span class=post-toc-text>0x02 为什么会产生HTTP请求走私</span></a><ol class=post-toc-child><li class="post-toc-item post-toc-level-4"><a class=post-toc-link href=#扩展：为什么会出现多次请求><span class=post-toc-text>扩展：为什么会出现多次请求</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class=post-toc-link href=#0x03-如何执行HTTP请求走私攻击><span class=post-toc-text>0x03 如何执行HTTP请求走私攻击</span></a></li><li class="post-toc-item post-toc-level-3"><a class=post-toc-link href=#0x04-HTTP请求走私攻击的五种方式><span class=post-toc-text>0x04 HTTP请求走私攻击的五种方式</span></a><ol class=post-toc-child><li class="post-toc-item post-toc-level-4"><a class=post-toc-link href=#CL不为0><span class=post-toc-text>CL不为0</span></a></li><li class="post-toc-item post-toc-level-4"><a class=post-toc-link href=#CL-CL><span class=post-toc-text>CL-CL</span></a></li><li class="post-toc-item post-toc-level-4"><a class=post-toc-link href=#CL-TE><span class=post-toc-text>CL-TE</span></a></li><li class="post-toc-item post-toc-level-4"><a class=post-toc-link href=#TE-CL><span class=post-toc-text>TE-CL</span></a></li><li class="post-toc-item post-toc-level-4"><a class=post-toc-link href=#TE-TE><span class=post-toc-text>TE-TE</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class=post-toc-link href=#0x05-HTTP请求走私实战><span class=post-toc-text>0x05 HTTP请求走私实战</span></a><ol class=post-toc-child><li class="post-toc-item post-toc-level-4"><a class=post-toc-link href=#RoarCTF2019-Web：easy-calc><span class=post-toc-text>RoarCTF2019-Web：easy_calc</span></a><ol class=post-toc-child><li class="post-toc-item post-toc-level-5"><a class=post-toc-link href=#相关PHP函数><span class=post-toc-text>相关PHP函数</span></a></li><li class="post-toc-item post-toc-level-5"><a class=post-toc-link href=#HTTP走私绕过WAF><span class=post-toc-text>HTTP走私绕过WAF</span></a></li><li class="post-toc-item post-toc-level-5"><a class=post-toc-link href=#PHP字符串解析特性绕过WAF><span class=post-toc-text>PHP字符串解析特性绕过WAF</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-3"><a class=post-toc-link href=#0x06-漏洞修复><span class=post-toc-text>0x06 漏洞修复</span></a></li><li class="post-toc-item post-toc-level-3"><a class=post-toc-link href=#0x07-写在后面><span class=post-toc-text>0x07 写在后面</span></a></li></ol></nav></aside><nav id=article-nav><a href="/2019/11/06/sqli-labs攻关3(Less-11-Less-22)/" id=article-nav-newer class=article-nav-link-wrap><span class=article-nav-title><i class="fa fa-hand-o-left" aria-hidden=true></i> sqli-labs攻关3(Less-11_Less-22)</span></a> <a href="/2019/10/19/任意文件读取与下载漏洞/" id=article-nav-older class=article-nav-link-wrap><span class=article-nav-title>任意文件读取与下载漏洞</span> <i class="fa fa-hand-o-right" aria-hidden=true></i></a></nav><section id=comments class=comments><style>
            margin-top:40px;padding:1px 15px 1px 10px;background-color:rgba(255,255,255,0.7);box-shadow: 0px 0px 20px #bbbbbb;border-radius: 5px;
            .comments{margin:30px;padding:10px;background:#fff}
            @media screen and (max-width:800px){.comments{margin:auto;padding:10px;background:#fff}}
        </style><div id=vcomment class=comment></div><script src=//cdn1.lncld.net/static/js/3.0.4/av-min.js></script><script src=//unpkg.com/valine/dist/Valine.min.js></script><script src=/js/Valine.min.js></script><script>
   var notify = 'true' == true ? true : false;
   var verify = 'true' == true ? true : false;
    window.onload = function() {
        new Valine({
            av: AV,
            el: '.comment',
            emoticon_url: 'https://cloud.panjunwen.com/alu',
            emoticon_list: ["吐.png","期待.png","高兴.png","吐血倒地.png","哭泣.png","欢呼.png"],
            notify: notify,
            verify: verify,
            app_id: "5cXOwuHg0Yrf8teE1lzRCjHi-gzGzoHsz",
            app_key: "ToPzd33a36q3VXf83omuntVV",
            lang:"zh-cn",
            placeholder: "说点什么吧！",
            avatar:"mp",
            pageSize: "10",
            highlight:"true",
            recordIP:"true"
        });
    }
</script></section></section></div><footer id=footer><div class=outer><div id=footer-info class=inner><p><span id=busuanzi_container_site_uv style=display:none>总访客数：<span id=busuanzi_value_site_uv></span></span> <span id=busuanzi_container_site_pv style=display:none>总访问量：<span id=busuanzi_value_site_pv></span></span></p><p><a href="https://qwzf.github.io/" target=_blank>Q子枫</a> <a href=https://blog.csdn.net/qq_43625917 target=_blank>我的CSDN</a> &copy; 2020 qwzf<br></p></div></div></footer><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><script src=//cdn.bootcss.com/jquery/3.2.1/jquery.min.js></script><script>
  var mihoConfig = {
      root: "https://qwzf.github.io",
      animate: true,
      isHome: false,
      share: true,
      reward: 1
  }
</script><div class=sidebar><div id=sidebar-search title=Search><i class="fa fa-search"></i></div><div id=sidebar-category title=Categories><i class="fa fa-book"></i></div><div id=sidebar-tag title=Tags><i class="fa fa-tags"></i></div><div id=sidebar-top><span class=sidebar-top-icon><i class="fa fa-angle-up"></i></span></div></div><div class=sidebar-menu-box id=sidebar-menu-box><div class=sidebar-menu-box-container><div id=sidebar-menu-box-categories><a class=category-link href="/categories/AWD/">AWD</a><a class=category-link href="/categories/CTF/">CTF</a><a class=category-link href="/categories/Databases/">Databases</a><a class=category-link href="/categories/Docker/">Docker</a><a class=category-link href="/categories/First/">First</a><a class=category-link href="/categories/HTTP/">HTTP</a><a class=category-link href="/categories/Linux/">Linux</a><a class=category-link href="/categories/Python/">Python</a><a class=category-link href="/categories/Web/">Web</a></div><div id=sidebar-menu-box-tags><a href="/tags/AWD/" style="font-size: 10px;">AWD</a> <a href="/tags/BUG/" style="font-size: 20px;">BUG</a> <a href="/tags/BUGKU/" style="font-size: 10px;">BUGKU</a> <a href="/tags/CSS/" style="font-size: 10px;">CSS</a> <a href="/tags/CTF/" style="font-size: 18.57px;">CTF</a> <a href="/tags/Crypto/" style="font-size: 14.29px;">Crypto</a> <a href="/tags/Databases/" style="font-size: 10px;">Databases</a> <a href="/tags/GET型双查询注入/" style="font-size: 10px;">GET型双查询注入</a> <a href="/tags/GET型盲注/" style="font-size: 10px;">GET型盲注</a> <a href="/tags/GET型错误型注入/" style="font-size: 10px;">GET型错误型注入</a> <a href="/tags/Github/" style="font-size: 10px;">Github</a> <a href="/tags/HTML/" style="font-size: 10px;">HTML</a> <a href="/tags/HTTP/" style="font-size: 11.43px;">HTTP</a> <a href="/tags/Hexo/" style="font-size: 11.43px;">Hexo</a> <a href="/tags/ISCC/" style="font-size: 11.43px;">ISCC</a> <a href="/tags/LAMP与LNMP/" style="font-size: 10px;">LAMP与LNMP</a> <a href="/tags/Linux/" style="font-size: 11.43px;">Linux</a> <a href="/tags/MISC/" style="font-size: 17.14px;">MISC</a> <a href="/tags/MySQL/" style="font-size: 12.86px;">MySQL</a> <a href="/tags/PHP/" style="font-size: 15.71px;">PHP</a> <a href="/tags/POST型报错注入/" style="font-size: 10px;">POST型报错注入</a> <a href="/tags/POST型盲注/" style="font-size: 10px;">POST型盲注</a> <a href="/tags/POST型联合查询注入/" style="font-size: 10px;">POST型联合查询注入</a> <a href="/tags/Python/" style="font-size: 15.71px;">Python</a> <a href="/tags/RSA/" style="font-size: 10px;">RSA</a> <a href="/tags/Reverse/" style="font-size: 10px;">Reverse</a> <a href="/tags/SQL/" style="font-size: 17.14px;">SQL</a> <a href="/tags/SQL注入/" style="font-size: 10px;">SQL注入</a> <a href="/tags/Web/" style="font-size: 18.57px;">Web</a> <a href="/tags/XML/" style="font-size: 10px;">XML</a> <a href="/tags/XML注入/" style="font-size: 10px;">XML注入</a> <a href="/tags/XSS/" style="font-size: 11.43px;">XSS</a> <a href="/tags/XXE漏洞/" style="font-size: 10px;">XXE漏洞</a> <a href="/tags/Xpath注入/" style="font-size: 10px;">Xpath注入</a> <a href="/tags/ZIP/" style="font-size: 10px;">ZIP</a> <a href="/tags/css/" style="font-size: 10px;">css</a> <a href="/tags/html/" style="font-size: 10px;">html</a> <a href="/tags/i春秋/" style="font-size: 10px;">i春秋</a> <a href="/tags/order-by排序注入/" style="font-size: 10px;">order by排序注入</a> <a href="/tags/php/" style="font-size: 10px;">php</a> <a href="/tags/phpstudy/" style="font-size: 10px;">phpstudy</a> <a href="/tags/requests库/" style="font-size: 10px;">requests库</a> <a href="/tags/urllib库/" style="font-size: 10px;">urllib库</a> <a href="/tags/二次注入/" style="font-size: 10px;">二次注入</a> <a href="/tags/任意文件读取与下载漏洞/" style="font-size: 10px;">任意文件读取与下载漏洞</a> <a href="/tags/函数/" style="font-size: 10px;">函数</a> <a href="/tags/前端/" style="font-size: 12.86px;">前端</a> <a href="/tags/协议层/" style="font-size: 10px;">协议层</a> <a href="/tags/南邮/" style="font-size: 11.43px;">南邮</a> <a href="/tags/反序列化漏洞/" style="font-size: 10px;">反序列化漏洞</a> <a href="/tags/命令执行与代码执行/" style="font-size: 10px;">命令执行与代码执行</a> <a href="/tags/基本语法/" style="font-size: 10px;">基本语法</a> <a href="/tags/堆叠注入/" style="font-size: 10px;">堆叠注入</a> <a href="/tags/字符串及正则表达式/" style="font-size: 10px;">字符串及正则表达式</a> <a href="/tags/安恒/" style="font-size: 10px;">安恒</a> <a href="/tags/容器/" style="font-size: 10px;">容器</a> <a href="/tags/宽字节注入/" style="font-size: 10px;">宽字节注入</a> <a href="/tags/导出文件注入/" style="font-size: 10px;">导出文件注入</a> <a href="/tags/序列的应用/" style="font-size: 10px;">序列的应用</a> <a href="/tags/开发/" style="font-size: 14.29px;">开发</a> <a href="/tags/开发工具/" style="font-size: 10px;">开发工具</a> <a href="/tags/异常处理及程序调试/" style="font-size: 10px;">异常处理及程序调试</a> <a href="/tags/抓包/" style="font-size: 10px;">抓包</a> <a href="/tags/报错注入/" style="font-size: 10px;">报错注入</a> <a href="/tags/操作数据库/" style="font-size: 10px;">操作数据库</a> <a href="/tags/攻防世界/" style="font-size: 11.43px;">攻防世界</a> <a href="/tags/数据库/" style="font-size: 10px;">数据库</a> <a href="/tags/文件上传漏洞/" style="font-size: 11.43px;">文件上传漏洞</a> <a href="/tags/文件包含漏洞/" style="font-size: 10px;">文件包含漏洞</a> <a href="/tags/文件及目录操作/" style="font-size: 10px;">文件及目录操作</a> <a href="/tags/期末复习/" style="font-size: 10px;">期末复习</a> <a href="/tags/模块/" style="font-size: 10px;">模块</a> <a href="/tags/河南高校网安联赛/" style="font-size: 10px;">河南高校网安联赛</a> <a href="/tags/流程控制/" style="font-size: 10px;">流程控制</a> <a href="/tags/源码泄露/" style="font-size: 10px;">源码泄露</a> <a href="/tags/盲注/" style="font-size: 10px;">盲注</a> <a href="/tags/移位编码/" style="font-size: 10px;">移位编码</a> <a href="/tags/简单加密/" style="font-size: 10px;">简单加密</a> <a href="/tags/线下/" style="font-size: 11.43px;">线下</a> <a href="/tags/网络爬虫/" style="font-size: 10px;">网络爬虫</a> <a href="/tags/过滤敏感关键字与WAF绕过/" style="font-size: 10px;">过滤敏感关键字与WAF绕过</a> <a href="/tags/镜像/" style="font-size: 10px;">镜像</a> <a href="/tags/问题整理/" style="font-size: 10px;">问题整理</a> <a href="/tags/隐写/" style="font-size: 11.43px;">隐写</a></div></div><a href=javascript:; class=sidebar-menu-box-close>&times;</a></div><div class=mobile-header-menu-nav id=mobile-header-menu-nav><div class=mobile-header-menu-container><span class=title>Menus</span><ul class=mobile-header-menu-navbar><li><a href="/"><i class="fa fa-home"></i><span>Home</span></a></li><li><a target=_blank href=/archives><i class="fa fa-archive"></i><span>Archives</span></a></li><li><a href=/about><i class="fa fa-user"></i><span>About</span></a></li></ul></div><div class=mobile-header-tag-container><span class=title>Tags</span><div id=mobile-header-container-tags><a href="/tags/AWD/" style="font-size: 10px;">AWD</a> <a href="/tags/BUG/" style="font-size: 20px;">BUG</a> <a href="/tags/BUGKU/" style="font-size: 10px;">BUGKU</a> <a href="/tags/CSS/" style="font-size: 10px;">CSS</a> <a href="/tags/CTF/" style="font-size: 18.57px;">CTF</a> <a href="/tags/Crypto/" style="font-size: 14.29px;">Crypto</a> <a href="/tags/Databases/" style="font-size: 10px;">Databases</a> <a href="/tags/GET型双查询注入/" style="font-size: 10px;">GET型双查询注入</a> <a href="/tags/GET型盲注/" style="font-size: 10px;">GET型盲注</a> <a href="/tags/GET型错误型注入/" style="font-size: 10px;">GET型错误型注入</a> <a href="/tags/Github/" style="font-size: 10px;">Github</a> <a href="/tags/HTML/" style="font-size: 10px;">HTML</a> <a href="/tags/HTTP/" style="font-size: 11.43px;">HTTP</a> <a href="/tags/Hexo/" style="font-size: 11.43px;">Hexo</a> <a href="/tags/ISCC/" style="font-size: 11.43px;">ISCC</a> <a href="/tags/LAMP与LNMP/" style="font-size: 10px;">LAMP与LNMP</a> <a href="/tags/Linux/" style="font-size: 11.43px;">Linux</a> <a href="/tags/MISC/" style="font-size: 17.14px;">MISC</a> <a href="/tags/MySQL/" style="font-size: 12.86px;">MySQL</a> <a href="/tags/PHP/" style="font-size: 15.71px;">PHP</a> <a href="/tags/POST型报错注入/" style="font-size: 10px;">POST型报错注入</a> <a href="/tags/POST型盲注/" style="font-size: 10px;">POST型盲注</a> <a href="/tags/POST型联合查询注入/" style="font-size: 10px;">POST型联合查询注入</a> <a href="/tags/Python/" style="font-size: 15.71px;">Python</a> <a href="/tags/RSA/" style="font-size: 10px;">RSA</a> <a href="/tags/Reverse/" style="font-size: 10px;">Reverse</a> <a href="/tags/SQL/" style="font-size: 17.14px;">SQL</a> <a href="/tags/SQL注入/" style="font-size: 10px;">SQL注入</a> <a href="/tags/Web/" style="font-size: 18.57px;">Web</a> <a href="/tags/XML/" style="font-size: 10px;">XML</a> <a href="/tags/XML注入/" style="font-size: 10px;">XML注入</a> <a href="/tags/XSS/" style="font-size: 11.43px;">XSS</a> <a href="/tags/XXE漏洞/" style="font-size: 10px;">XXE漏洞</a> <a href="/tags/Xpath注入/" style="font-size: 10px;">Xpath注入</a> <a href="/tags/ZIP/" style="font-size: 10px;">ZIP</a> <a href="/tags/css/" style="font-size: 10px;">css</a> <a href="/tags/html/" style="font-size: 10px;">html</a> <a href="/tags/i春秋/" style="font-size: 10px;">i春秋</a> <a href="/tags/order-by排序注入/" style="font-size: 10px;">order by排序注入</a> <a href="/tags/php/" style="font-size: 10px;">php</a> <a href="/tags/phpstudy/" style="font-size: 10px;">phpstudy</a> <a href="/tags/requests库/" style="font-size: 10px;">requests库</a> <a href="/tags/urllib库/" style="font-size: 10px;">urllib库</a> <a href="/tags/二次注入/" style="font-size: 10px;">二次注入</a> <a href="/tags/任意文件读取与下载漏洞/" style="font-size: 10px;">任意文件读取与下载漏洞</a> <a href="/tags/函数/" style="font-size: 10px;">函数</a> <a href="/tags/前端/" style="font-size: 12.86px;">前端</a> <a href="/tags/协议层/" style="font-size: 10px;">协议层</a> <a href="/tags/南邮/" style="font-size: 11.43px;">南邮</a> <a href="/tags/反序列化漏洞/" style="font-size: 10px;">反序列化漏洞</a> <a href="/tags/命令执行与代码执行/" style="font-size: 10px;">命令执行与代码执行</a> <a href="/tags/基本语法/" style="font-size: 10px;">基本语法</a> <a href="/tags/堆叠注入/" style="font-size: 10px;">堆叠注入</a> <a href="/tags/字符串及正则表达式/" style="font-size: 10px;">字符串及正则表达式</a> <a href="/tags/安恒/" style="font-size: 10px;">安恒</a> <a href="/tags/容器/" style="font-size: 10px;">容器</a> <a href="/tags/宽字节注入/" style="font-size: 10px;">宽字节注入</a> <a href="/tags/导出文件注入/" style="font-size: 10px;">导出文件注入</a> <a href="/tags/序列的应用/" style="font-size: 10px;">序列的应用</a> <a href="/tags/开发/" style="font-size: 14.29px;">开发</a> <a href="/tags/开发工具/" style="font-size: 10px;">开发工具</a> <a href="/tags/异常处理及程序调试/" style="font-size: 10px;">异常处理及程序调试</a> <a href="/tags/抓包/" style="font-size: 10px;">抓包</a> <a href="/tags/报错注入/" style="font-size: 10px;">报错注入</a> <a href="/tags/操作数据库/" style="font-size: 10px;">操作数据库</a> <a href="/tags/攻防世界/" style="font-size: 11.43px;">攻防世界</a> <a href="/tags/数据库/" style="font-size: 10px;">数据库</a> <a href="/tags/文件上传漏洞/" style="font-size: 11.43px;">文件上传漏洞</a> <a href="/tags/文件包含漏洞/" style="font-size: 10px;">文件包含漏洞</a> <a href="/tags/文件及目录操作/" style="font-size: 10px;">文件及目录操作</a> <a href="/tags/期末复习/" style="font-size: 10px;">期末复习</a> <a href="/tags/模块/" style="font-size: 10px;">模块</a> <a href="/tags/河南高校网安联赛/" style="font-size: 10px;">河南高校网安联赛</a> <a href="/tags/流程控制/" style="font-size: 10px;">流程控制</a> <a href="/tags/源码泄露/" style="font-size: 10px;">源码泄露</a> <a href="/tags/盲注/" style="font-size: 10px;">盲注</a> <a href="/tags/移位编码/" style="font-size: 10px;">移位编码</a> <a href="/tags/简单加密/" style="font-size: 10px;">简单加密</a> <a href="/tags/线下/" style="font-size: 11.43px;">线下</a> <a href="/tags/网络爬虫/" style="font-size: 10px;">网络爬虫</a> <a href="/tags/过滤敏感关键字与WAF绕过/" style="font-size: 10px;">过滤敏感关键字与WAF绕过</a> <a href="/tags/镜像/" style="font-size: 10px;">镜像</a> <a href="/tags/问题整理/" style="font-size: 10px;">问题整理</a> <a href="/tags/隐写/" style="font-size: 11.43px;">隐写</a></div></div></div><div class=search-wrap><span class=search-close>&times;</span> <a href=javascript:; class="header-icon waves-effect waves-circle waves-light" id=back><i class="icon icon-lg icon-chevron-left"></i></a> <input class=search-field placeholder=Search... id=keywords> <a id=search-submit href=javascript:;><i class="fa fa-search"></i></a><div class=search-container id=search-container><ul class=search-result id=search-result></ul></div></div><div id=search-tpl><li class=search-result-item><a href={url} class=search-item-li><span class=search-item-li-title title={title}>{title}</span></a></li></div><script src=/js/search.js></script><script src=/js/main.js></script><script src=//cdn.bootcss.com/particles.js/2.0.0/particles.min.js></script><div id=particles></div><script src=/js/particles.js></script><link rel=stylesheet href=//cdn.bootcss.com/animate.css/3.5.0/animate.min.css><script src=//cdn.bootcss.com/scrollReveal.js/3.0.5/scrollreveal.js></script><script src=/js/animate.js></script><script src=/js/pop-img.js></script><script>
     $(".article-entry p img").popImg();
  </script><script type=text/javascript src=/js/clicklove.js></script></div><script src=/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/haruto.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>